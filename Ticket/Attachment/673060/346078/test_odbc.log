Z:\Perl>test_odbc.pl
    DBI 1.609-ithread default trace level set to 0x6000000/15 (pid 948) at test_odbc.pl line 9
    -> DBI->connect(DBI:ODBC:driver={SQL Server};Server=avm01;Database=test, , ****)
    -> DBI->install_driver(ODBC) for MSWin32 perl=5.010001 pid=948 ruid=0 euid=0
       install_driver: DBD::ODBC version 1.23 loaded from C:/Perl/site/lib/DBD/ODBC.pm
    New 'DBI::dr' (for DBD::ODBC::dr, parent='', id=undef)
    dbih_setup_handle(DBI::dr=HASH(0x2691cc4)=>DBI::dr=HASH(0x2691d24), DBD::ODBC::dr, 0, Null!)
    dbih_make_com(Null!, 0, DBD::ODBC::dr, 92, 0) thr#392c64
    dbih_setup_attrib(DBI::dr=HASH(0x2691d24), Err, Null!) SCALAR(0x2218634) (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x2691d24), State, Null!) SCALAR(0x22185d4) (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x2691d24), Errstr, Null!) SCALAR(0x2218604) (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x2691d24), TraceLevel, Null!) 0 (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x2691d24), FetchHashKeyName, Null!) 'NAME' (already defined)
    <- install_driver= DBI::dr=HASH(0x2691cc4)
    >> default_user DISPATCH (DBI::dr=HASH(0x2691cc4) rc1/3 @4 g1 ima1 pid#948) at C:/Perl/site/lib/DBI.pm line 641 via  at Z:\Perl\test_odbc.pl line 12
    !! warn: 0 CLEARED by call to default_user method
    -> default_user in DBD::_::dr for DBD::ODBC::dr (DBI::dr=HASH(0x2691cc4)~0x2691d24 undef undef HASH(0x221992c)) thr#392c64
    <- default_user= ( undef undef ) [2 items] at C:/Perl/site/lib/DBI.pm line 641 via  at Z:\Perl\test_odbc.pl line 12
    >> connect     DISPATCH (DBI::dr=HASH(0x2691cc4) rc2/3 @5 g0 ima8001 pid#948) at C:/Perl/site/lib/DBI.pm line 653
    -> connect for DBD::ODBC::dr (DBI::dr=HASH(0x2691cc4)~0x2691d24 'driver={SQL Server};Server=avm01;Database=test' undef **** HASH(0x221992c)) thr#392c64
    New 'DBI::db' (for DBD::ODBC::db, parent=DBI::dr=HASH(0x2691d24), id=undef)
    dbih_setup_handle(DBI::db=HASH(0x269224c)=>DBI::db=HASH(0x269219c), DBD::ODBC::db, 2681364, Null!)
    dbih_make_com(DBI::dr=HASH(0x2691d24), 214e37c, DBD::ODBC::db, 508, 0) thr#392c64
    dbih_setup_attrib(DBI::db=HASH(0x269219c), Err, DBI::dr=HASH(0x2691d24)) SCALAR(0x2681574) (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), State, DBI::dr=HASH(0x2691d24)) SCALAR(0x26815f4) (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), Errstr, DBI::dr=HASH(0x2691d24)) SCALAR(0x26815b4) (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), TraceLevel, DBI::dr=HASH(0x2691d24)) 0 (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), FetchHashKeyName, DBI::dr=HASH(0x2691d24)) 'NAME' (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), HandleSetErr, DBI::dr=HASH(0x2691d24)) undef (not defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), HandleError, DBI::dr=HASH(0x2691d24)) undef (not defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), ReadOnly, DBI::dr=HASH(0x2691d24)) undef (not defined)
    dbih_setup_attrib(DBI::db=HASH(0x269219c), Profile, DBI::dr=HASH(0x2691d24)) undef (not defined)
Unicode login6
dbname=driver={SQL Server};Server=avm01;Database=test, uid=undef, pwd=xxxxx
Now using dbname = driver={SQL Server};Server=avm01;Database=test;
    SQLDriverConnect 'driver={SQL Server};Server=avm01;Database=test;', 'undef', 'xxxx'
Out connection string: DRIVER=SQL Server;SERVER=avm01;UID=;Trusted_Connection=Yes;APP=ActivePerl;WSID=PC039716;DATABASE=test
    !!dbd_error2(err_rc=1, what=db_login6sv/SQLConnectW, handles=(2145720,2525410,0)
    !SQLError(2145720,2525410,0) = (01000, 5701, [Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'.)
    !SQLError(2145720,2525410,0) = (01000, 5703, [Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english.)
Turning autocommit on
DRIVER_ODBC_VER = 03.52
DRIVER_NAME = SQLSRV32.DLL
DRIVER_VERSION = 06.01.7600
MAX_COLUMN_NAME_LEN = 128
DBD::ODBC is unicode built : YES
Deferring Binding
SQL_DBMS_NAME = Microsoft SQL Server
SQLMoreResults supported: 1
SQLDescribeParam supported: 1
SQLDescribeParam supported: 1
    <- connect= DBI::db=HASH(0x269224c) at C:/Perl/site/lib/DBI.pm line 653
    >> STORE       DISPATCH (DBI::db=HASH(0x269219c) rc2/1 @3 g0 ima41c pid#948) at C:/Perl/site/lib/DBI.pm line 705
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x269219c)~INNER 'PrintError' 1) thr#392c64
    !!DBD::ODBC unsupported attribute passed (PrintError)
    STORE DBI::db=HASH(0x269219c) 'PrintError' => 1
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 705
    >> STORE       DISPATCH (DBI::db=HASH(0x269219c) rc2/1 @3 g0 ima41c pid#948) at C:/Perl/site/lib/DBI.pm line 705
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x269219c)~INNER 'AutoCommit' 1) thr#392c64
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 705
    >> STORE       DISPATCH (DBI::db=HASH(0x269219c) rc2/1 @3 g0 ima41c pid#948) at C:/Perl/site/lib/DBI.pm line 708 via  at Z:\Perl\test_odbc.pl line 12
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x269219c)~INNER 'Username' undef) thr#392c64
    !!DBD::ODBC unsupported attribute passed (Username)
    STORE DBI::db=HASH(0x269219c) 'Username' => undef
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 708 via  at Z:\Perl\test_odbc.pl line 12
    >> FETCH       DISPATCH (DBI::db=HASH(0x269219c) rc2/1 @2 g0 ima404 pid#948) at C:/Perl/site/lib/DBI.pm line 708
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <> FETCH= undef ('Username' from cache) at C:/Perl/site/lib/DBI.pm line 708
    >> connected   DISPATCH (DBI::db=HASH(0x269224c) rc1/1 @2 g0 ima5 pid#948) at C:/Perl/site/lib/DBI.pm line 714
    -> connected in DBD::_::db for DBD::ODBC::db (DBI::db=HASH(0x269224c)~0x269219c 'DBI:ODBC:driver={SQL Server};Server=avm01;Database=test') thr#392c64
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- connected= undef at C:/Perl/site/lib/DBI.pm line 714
    <- connect= DBI::db=HASH(0x269224c)
    >> STORE       DISPATCH (DBI::db=HASH(0x269219c) rc2/1 @3 g0 ima41c pid#948) at C:/Perl/site/lib/DBI.pm line 723 via  at Z:\Perl\test_odbc.pl line 12
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x269219c)~INNER 'dbi_connect_closure' CODE(0x2691be4)) thr#392c64
    !!DBD::ODBC unsupported attribute passed (dbi_connect_closure)
    STORE DBI::db=HASH(0x269219c) 'dbi_connect_closure' => CODE(0x2691be4)
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 723 via  at Z:\Perl\test_odbc.pl line 12
    >> prepare     DISPATCH (DBI::db=HASH(0x269224c) rc1/1 @2 g0 imaa201 pid#948) at Z:\Perl\test_odbc.pl line 36
    !! info: '' CLEARED by call to prepare method
    -> prepare for DBD::ODBC::db (DBI::db=HASH(0x269224c)~0x269219c '    SELECT
        (SELECT XLATSHORTNAME FROM PSXLATITEM X
            WHERE FIELDNAME = 'ENRL_REQ_DETL_STAT'
            AND FIELDVALUE = D.ENRL_REQ_DETL_STAT
            AND X.EFF_STATUS = 'A'
            AND EFFDT = (
                SELECT MAX(X2.EFFDT) FROM PSXLATITEM X2
                WHERE X.FIELDNAME = X2.FIELDNAME
                AND X.FIELDVALUE = X2.FIELDVALUE
                AND X2.EFF_STATUS = 'A'
                )
        )
    FROM
        PS_ENRL_REQ_DETAIL AS D
    WHERE
        D.STRM = ?
') thr#392c64
    New 'DBI::st' (for DBD::ODBC::st, parent=DBI::db=HASH(0x269219c), id=undef)
    dbih_setup_handle(DBI::st=HASH(0x26923bc)=>DBI::st=HASH(0x269233c), DBD::ODBC::st, 2681654, Null!)
    dbih_make_com(DBI::db=HASH(0x269219c), 2525204, DBD::ODBC::st, 220, 0) thr#392c64
    dbih_setup_attrib(DBI::st=HASH(0x269233c), Err, DBI::db=HASH(0x269219c)) SCALAR(0x2681574) (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), State, DBI::db=HASH(0x269219c)) SCALAR(0x26815f4) (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), Errstr, DBI::db=HASH(0x269219c)) SCALAR(0x26815b4) (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), TraceLevel, DBI::db=HASH(0x269219c)) 0 (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), FetchHashKeyName, DBI::db=HASH(0x269219c)) 'NAME' (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), HandleSetErr, DBI::db=HASH(0x269219c)) undef (not defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), HandleError, DBI::db=HASH(0x269219c)) undef (not defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), ReadOnly, DBI::db=HASH(0x269219c)) undef (not defined)
    dbih_setup_attrib(DBI::st=HASH(0x269233c), Profile, DBI::db=HASH(0x269219c)) undef (not defined)
    initializing sth query timeout to -1
    ignore named placeholders = 0
    creating new parameter key 1
    dbd_preparse scanned 1 distinct placeholders
    SQLPrepare     SELECT
        (SELECT XLATSHORTNAME FROM PSXLATITEM X
            WHERE FIELDNAME = 'ENRL_REQ_DETL_STAT'
            AND FIELDVALUE = D.ENRL_REQ_DETL_STAT
            AND X.EFF_STATUS = 'A'
            AND EFFDT = (
                SELECT MAX(X2.EFFDT) FROM PSXLATITEM X2
                WHERE X.FIELDNAME = X2.FIELDNAME
                AND X.FIELDVALUE = X2.FIELDVALUE
                AND X2.EFF_STATUS = 'A'
                )
        )
    FROM
        PS_ENRL_REQ_DETAIL AS D
    WHERE
        D.STRM = ?

    Processing non-utf8 sql in unicode mode
    SQLPrepare = 0
    <- prepare= DBI::st=HASH(0x26923bc) at Z:\Perl\test_odbc.pl line 36
Execute DBI = 1.609, DBD::ODBC = 1.23
    >> execute     DISPATCH (DBI::st=HASH(0x26923bc) rc1/1 @2 g0 ima1041 pid#948) at Z:\Perl\test_odbc.pl line 39
    -> execute for DBD::ODBC::st (DBI::st=HASH(0x26923bc)~0x269233c 1099) thr#392c64
+dbd_bind_ph(2681674, name=1, value='1099', attribs=, sql_type=0(unknown), is_inout=0, maxlen=0
    +get_param_type(2681674,1)
      SQLDescribeParam failed reverting to default SQL bind type -9
07009 [Microsoft][ODBC SQL Server Driver]Invalid Descriptor Index
42000 [Microsoft][ODBC SQL Server Driver]Syntax error or access violation
      get_param_type: modified value type to SQL_C_WCHAR
    -get_param_type
-dbd_bind_ph=1
+dbd_st_execute(2681674)
    dbd_st_finish(2681674)
    outparams = 0
    +rebind_param 1 '1099' (size svCUR=4/SvLEN=8/max=0) svtype 6, value type:-8 sql type:-9
    +get_param_type(2681674,1)
      SQLDescribeParam already run and returned rc=-1
      get_param_type: modified value type to SQL_C_WCHAR
    -get_param_type
      Need to modify phs->sv in place: old length = 4
      Need to modify phs->sv in place: new length = 8
      bind 1 '1' value_len=8 maxlen=10 null=0)
      bind 1 value_type:-8 UNICODE VARCHAR cs=8 dd=0 bl=8
    SQLBindParameter: idx=1: param_type=1, name=1, value_type=-8, SQL_Type=-9, column_size=0, d_digits=0, value_ptr=2618104, buffer_length=8, cbValue=8, param_size=0
    !!dbd_error2(err_rc=-1, what=rebind_param/SQLBindParameter, handles=(2145720,2525410,26d4578)
    !SQLError(2145720,2525410,26d4578) = (HY104, 0, [Microsoft][ODBC SQL Server Driver]Invalid precision value)
    !! ERROR: 1 '[Microsoft][ODBC SQL Server Driver]Invalid precision value (SQL-HY104)' (err#1)
    <- execute= undef at Z:\Perl\test_odbc.pl line 39
DBD::ODBC::st execute failed: [Microsoft][ODBC SQL Server Driver]Invalid precision value (SQL-HY104) at Z:\Perl\test_odbc.pl line 39.
    >> DESTROY     DISPATCH (DBI::st=HASH(0x26923bc) rc1/1 @1 g0 ima10004 pid#948)
    <> DESTROY(DBI::st=HASH(0x26923bc)) ignored for outer handle (inner DBI::st=HASH(0x269233c) has ref cnt 1)
    >> DESTROY     DISPATCH (DBI::st=HASH(0x269233c) rc1/1 @1 g0 ima10004 pid#948)
    -> DESTROY for DBD::ODBC::st (DBI::st=HASH(0x269233c)~INNER) thr#392c64
   SQLFreeStmt=0.
       ERROR: 1 '[Microsoft][ODBC SQL Server Driver]Invalid precision value (SQL-HY104)' (err#1)
    <- DESTROY= undef
    DESTROY (dbih_clearcom) (sth 0x269233c, com 0x26e1fd4, imp DBD::ODBC::st):
       FLAGS 0x180111: COMSET Warn PrintError PrintWarn
       ERR 1
       ERRSTR '[Microsoft][ODBC SQL Server Driver]Invalid precision value (SQL-HY104)'
       PARENT DBI::db=HASH(0x269219c)
       KIDS 0 (0 Active)
       NUM_OF_FIELDS -1
       NUM_OF_PARAMS 1
    dbih_clearcom 0x269233c (com 0x26e1fd4, type 3) done.

    >> DESTROY     DISPATCH (DBI::db=HASH(0x269224c) rc1/1 @1 g0 ima10004 pid#948)
    <> DESTROY(DBI::db=HASH(0x269224c)) ignored for outer handle (inner DBI::db=HASH(0x269219c) has ref cnt 1)
    >> DESTROY     DISPATCH (DBI::db=HASH(0x269219c) rc1/1 @1 g0 ima10004 pid#948)
    -> DESTROY for DBD::ODBC::db (DBI::db=HASH(0x269219c)~INNER) thr#392c64
SQLDisconnect=0
    DBD::ODBC Disconnected!
       ERROR: 1 '[Microsoft][ODBC SQL Server Driver]Invalid precision value (SQL-HY104)' (err#0)
    <- DESTROY= undef
    DESTROY (dbih_clearcom) (dbh 0x269219c, com 0x2525204, imp DBD::ODBC::db):
       FLAGS 0x180311: COMSET Warn PrintError PrintWarn AutoCommit
       ERR 1
       ERRSTR '[Microsoft][ODBC SQL Server Driver]Invalid precision value (SQL-HY104)'
       PARENT DBI::dr=HASH(0x2691d24)
       KIDS 0 (0 Active)
    dbih_clearcom 0x269219c (com 0x2525204, type 2) done.

    -- DBI::END ($@: , $!: )
    >> disconnect_all DISPATCH (DBI::dr=HASH(0x2691cc4) rc1/3 @1 g0 ima801 pid#948) at C:/Perl/site/lib/DBI.pm line 731 via  at Z:\Perl\test_odbc.pl line 0
    !! ERROR: 1 CLEARED by call to disconnect_all method
    -> disconnect_all for DBD::ODBC::dr (DBI::dr=HASH(0x2691cc4)~0x2691d24) thr#392c64
    <- disconnect_all= '' at C:/Perl/site/lib/DBI.pm line 731 via  at Z:\Perl\test_odbc.pl line 0
!   >> DESTROY     DISPATCH (DBI::dr=HASH(0x2691d24) rc1/1 @1 g0 ima10004 pid#948) during global destruction
!   -> DESTROY in DBD::_::common for DBD::ODBC::dr (DBI::dr=HASH(0x2691d24)~INNER) thr#392c64
!   <- DESTROY= undef during global destruction
    DESTROY (dbih_clearcom) (drh 0x2691cc4, com 0x214e37c, imp global destruction):
       FLAGS 0x100215: COMSET Active Warn PrintWarn AutoCommit
       PARENT undef
       KIDS 0 (0 Active)
    dbih_clearcom 0x2691cc4 (com 0x214e37c, type 1) done.

!   >> DESTROY     DISPATCH (DBI::dr=HASH(0x2691cc4) rc1/1 @1 g0 ima10004 pid#948) during global destruction
!   <> DESTROY for DBI::dr=HASH(0x2691cc4) ignored (inner handle gone)


























