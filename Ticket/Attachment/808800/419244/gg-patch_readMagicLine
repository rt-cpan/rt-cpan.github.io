--- MMagic.pm.orig	Thu Jul 22 18:14:42 2010
+++ MMagic.pm	Thu Jul 22 18:15:31 2010
@@ -1256,7 +1256,7 @@ sub readMagicLine {
 	$testval = $line;
 
 	# do octal/hex conversion
-	$testval =~ s/\\([x0-7][0-7]?[0-7]?)/chr(oct($1))/eg;
+	$testval =~ s/\\([x0-7][[:xdigit:]]?[[:xdigit:]]?)/chr(oct($1))/eg;
 
 	# do single char escapes
 	$testval =~ s/\\(.)/$ESC{$1}||$1/eg;
