#!/usr/bin/perl
use warnings;
use strict;
use Net::DNS;
use Net::DNS::Header;

my $inc_id = 0;

for (1 .. 10) {
    if (my $pid = fork()) {
        waitpid($pid, 0);
        sleep(3);
    } else {
        print "--------------------------------\n";
        print "pid: $$\n";
        print "\n";
        if ($inc_id) {
            srand();
            for (0 .. rand(65536)) {
                Net::DNS::Header::nextid();
            }
        }
        my $res = Net::DNS::Resolver->new;
        my $answer = $res->query('wsr.ac.at', 'MX');
        #$answer->print;
        $answer->header->print;
        sleep(1);
        $answer = $res->query('hjp.at', 'MX');
        #$answer->print;
        $answer->header->print;
        print "\n";
        print "\n";
        exit(0);
    }
}
