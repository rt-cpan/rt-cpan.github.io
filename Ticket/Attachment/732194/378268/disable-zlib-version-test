Description: Disable zlib version if TEST_SKIP_VERSION_CHECK is set
Author: Maximilian Gass <mxey@cloudconnected.org>
--- a/t/cz-01version.t
+++ b/t/cz-01version.t
@@ -25,18 +25,20 @@
 
 # Check zlib_version and ZLIB_VERSION are the same.
 
-my $zlib_h = ZLIB_VERSION ;
-my $libz   = Compress::Zlib::zlib_version;
+SKIP: {
+    skip "TEST_SKIP_VERSION_CHECK is set", 1 if $ENV{TEST_SKIP_VERSION_CHECK};
+    my $zlib_h = ZLIB_VERSION ;
+    my $libz   = Compress::Zlib::zlib_version;
 
-is($zlib_h, $libz, "ZLIB_VERSION ($zlib_h) matches Compress::Zlib::zlib_version")
-    or diag <<EOM;
+    is($zlib_h, $libz, "ZLIB_VERSION ($zlib_h) matches Compress::Zlib::zlib_version")
+        or diag <<EOM;
 
 The version of zlib.h does not match the version of libz
  
 You have zlib.h version $zlib_h
-     and libz   version $libz
+	 and libz   version $libz
  
 You probably have two versions of zlib installed on your system.
 Try removing the one you don't want to use and rebuild.
 EOM
-
+}
--- a/t/cz-03zlib-v1.t
+++ b/t/cz-03zlib-v1.t
@@ -47,8 +47,11 @@
 my $len   = length $hello ;
 
 # Check zlib_version and ZLIB_VERSION are the same.
-is Compress::Zlib::zlib_version, ZLIB_VERSION, 
-    "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+SKIP: {
+    skip "TEST_SKIP_VERSION_CHECK is set", 1 if $ENV{TEST_SKIP_VERSION_CHECK};
+    is Compress::Zlib::zlib_version, ZLIB_VERSION, 
+        "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+}
 
 # generate a long random string
 my $contents = '' ;
--- a/t/cz-06gzsetp.t
+++ b/t/cz-06gzsetp.t
@@ -42,8 +42,11 @@
 plan tests => 51 + $extra ;
 
 # Check zlib_version and ZLIB_VERSION are the same.
-is Compress::Zlib::zlib_version, ZLIB_VERSION,
-    "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+SKIP: {
+    skip "TEST_SKIP_VERSION_CHECK is set", 1 if $ENV{TEST_SKIP_VERSION_CHECK};
+    is Compress::Zlib::zlib_version, ZLIB_VERSION,
+        "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+}
  
 {
     # gzsetparams
--- a/t/cz-08encoding.t
+++ b/t/cz-08encoding.t
@@ -37,8 +37,11 @@
 
 
 # Check zlib_version and ZLIB_VERSION are the same.
-is Compress::Zlib::zlib_version, ZLIB_VERSION, 
-    "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+SKIP: {
+    skip "TEST_SKIP_VERSION_CHECK is set", 1 if $ENV{TEST_SKIP_VERSION_CHECK};
+    is Compress::Zlib::zlib_version, ZLIB_VERSION, 
+        "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+}
 
 
 {
--- a/t/cz-14gzopen.t
+++ b/t/cz-14gzopen.t
@@ -27,9 +27,12 @@
 }
 
 {
-    # Check zlib_version and ZLIB_VERSION are the same.
-    is Compress::Zlib::zlib_version, ZLIB_VERSION,
-        "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+    SKIP: {
+        skip "TEST_SKIP_VERSION_CHECK is set", 1 if $ENV{TEST_SKIP_VERSION_CHECK};
+        # Check zlib_version and ZLIB_VERSION are the same.
+        is Compress::Zlib::zlib_version, ZLIB_VERSION,
+            "ZLIB_VERSION matches Compress::Zlib::zlib_version" ;
+    }
 }
  
 {
