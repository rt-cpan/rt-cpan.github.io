diff --git a/CGI.pm b/CGI.pm
index 0cba881..54c1008 100644
--- a/CGI.pm
+++ b/CGI.pm
@@ -515,16 +515,20 @@ sub init {

   my $is_xforms;

-  my $initializer = shift;  # for backward compatibility
+  my ($initializer, $config) = @_;  # for backward compatibility
+  $config = {} if !$config;
   local($/) = "\n";

+  # set client handle
+  $self->{'.client_handle'} = $config->{client_handle} || \*STDIN;
+
     # set autoescaping on by default
     $self->{'escape'} = 1;

     # if we get called more than once, we want to initialize
     # ourselves from the original query (which may be gone
-    # if it was read from STDIN originally.)
-    if (defined(@QUERY_PARAM) && !defined($initializer)) {
+    # if it was read from the client handle originally.)
+    if (defined(@QUERY_PARAM) && !defined($initializer) && !exists $config->{client_handle}) {
         for my $name (@QUERY_PARAM) {
             my $val = $QUERY_PARAM{$name}; # always an arrayref;
             $self->param('-name'=>$name,'-value'=> $val);
@@ -538,6 +542,7 @@ sub init {
         $self->charset($QUERY_CHARSET);
         $self->{'.fieldnames'} = {%QUERY_FIELDNAMES};
         $self->{'.tmpfiles'}   = {%QUERY_TMPFILES};
+        $self->init_cleanup();
         return;
     }

@@ -734,6 +739,13 @@ sub init {
     $self->delete('.cgifields');

     $self->save_request unless defined $initializer;
+    $self->init_cleanup();
+}
+
+sub init_cleanup {
+  my $self = shift;
+  delete $self->{'.client_handle'};
+  return;
 }

 # FUNCTIONS TO OVERRIDE:
@@ -1019,7 +1031,7 @@ sub read_from_client {
     local $^W=0;                # prevent a warning
     return $MOD_PERL
         ? $self->r->read($$buff, $len, $offset)
-        : read(\*STDIN, $$buff, $len, $offset);
+        : read($self->{'.client_handle'}, $$buff, $len, $offset);
 }
 END_OF_FUNC

@@ -3966,7 +3978,8 @@ sub new {
     } else { # otherwise we find it ourselves
         my($old);
         ($old,$/) = ($/,$CRLF); # read a CRLF-delimited line
-        $boundary = <STDIN>;      # BUG: This won't work correctly under mod_perl
+        my $client_handle = $interface->{'.client_handle'};
+        $boundary = <$client_handle>;   # BUG: This won't work correctly under mod_perl
         $length -= length($boundary);
         chomp($boundary);               # remove the CRLF
         $/ = $old;                      # restore old line separator

