$ perl /tmp/ssh2bug.pl
hello from remote host
-rw------- 1 salva salva 1766 2011-03-29 10:24 /home/salva/.ssh/id_rsa
-rw-r--r-- 1 salva salva  392 2011-03-29 10:24 /home/salva/.ssh/id_rsa.pub
before ctor at /tmp/ssh2bug.pl line 18.
before connect at /tmp/ssh2bug.pl line 21.
before auth at /tmp/ssh2bug.pl line 24.
connection failed at /tmp/ssh2bug.pl line 25.
the end at /tmp/ssh2bug.pl line 31.
*** glibc detected *** perl: double free or corruption (fasttop): 0x0000000000e62fc0 ***
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(+0x78a9f)[0x7f15a902ca9f]
/lib/x86_64-linux-gnu/libc.so.6(cfree+0x73)[0x7f15a90308f3]
/usr/lib/libssh2.so.1(libssh2_session_free+0x24e)[0x7f15a770183e]
/usr/local/lib/perl/5.12.4/auto/Net/SSH2/SSH2.so(XS_Net__SSH2_DESTROY+0x178)[0x7f15a792df18]
/usr/lib/libperl.so.5.12(Perl_pp_entersub+0x54d)[0x7f15a9409f1d]
/usr/lib/libperl.so.5.12(Perl_call_sv+0x632)[0x7f15a93a5de2]
/usr/lib/libperl.so.5.12(Perl_sv_clear+0x27a)[0x7f15a940f69a]
/usr/lib/libperl.so.5.12(Perl_sv_free2+0x52)[0x7f15a940feb2]
/usr/lib/libperl.so.5.12(Perl_leave_scope+0x120f)[0x7f15a9436d6f]
/usr/lib/libperl.so.5.12(Perl_pp_leave+0xec)[0x7f15a9406d4c]
/usr/lib/libperl.so.5.12(Perl_runops_standard+0x20)[0x7f15a94016c0]
/usr/lib/libperl.so.5.12(perl_run+0x35e)[0x7f15a93ab78e]
perl(main+0x149)[0x400d49]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xff)[0x7f15a8fd2e1f]
perl[0x400d81]
======= Memory map: ========
00400000-00402000 r-xp 00000000 08:11 6200                               /usr/bin/perl
00601000-00602000 r--p 00001000 08:11 6200                               /usr/bin/perl
00602000-00603000 rw-p 00002000 08:11 6200                               /usr/bin/perl
00b9c000-00e93000 rw-p 00000000 00:00 0                                  [heap]
7f15a0000000-7f15a0021000 rw-p 00000000 00:00 0 
7f15a0021000-7f15a4000000 ---p 00000000 00:00 0 
7f15a6c38000-7f15a6c4d000 r-xp 00000000 08:11 390993                     /lib/x86_64-linux-gnu/libgcc_s.so.1
7f15a6c4d000-7f15a6e4c000 ---p 00015000 08:11 390993                     /lib/x86_64-linux-gnu/libgcc_s.so.1
7f15a6e4c000-7f15a6e4d000 r--p 00014000 08:11 390993                     /lib/x86_64-linux-gnu/libgcc_s.so.1
7f15a6e4d000-7f15a6e4e000 rw-p 00015000 08:11 390993                     /lib/x86_64-linux-gnu/libgcc_s.so.1
7f15a6e4e000-7f15a6e5a000 r-xp 00000000 08:11 440036                     /lib/x86_64-linux-gnu/libnss_files-2.13.so
7f15a6e5a000-7f15a7059000 ---p 0000c000 08:11 440036                     /lib/x86_64-linux-gnu/libnss_files-2.13.so
7f15a7059000-7f15a705a000 r--p 0000b000 08:11 440036                     /lib/x86_64-linux-gnu/libnss_files-2.13.so
7f15a705a000-7f15a705b000 rw-p 0000c000 08:11 440036                     /lib/x86_64-linux-gnu/libnss_files-2.13.so
7f15a705b000-7f15a705e000 r-xp 00000000 08:11 512799                     /lib/x86_64-linux-gnu/libgpg-error.so.0.8.0
7f15a705e000-7f15a725d000 ---p 00003000 08:11 512799                     /lib/x86_64-linux-gnu/libgpg-error.so.0.8.0
7f15a725d000-7f15a725e000 r--p 00002000 08:11 512799                     /lib/x86_64-linux-gnu/libgpg-error.so.0.8.0
7f15a725e000-7f15a725f000 rw-p 00003000 08:11 512799                     /lib/x86_64-linux-gnu/libgpg-error.so.0.8.0
7f15a725f000-7f15a7276000 r-xp 00000000 08:11 394592                     /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7f15a7276000-7f15a7475000 ---p 00017000 08:11 394592                     /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7f15a7475000-7f15a7476000 r--p 00016000 08:11 394592                     /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7f15a7476000-7f15a7477000 rw-p 00017000 08:11 394592                     /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7f15a7477000-7f15a74ed000 r-xp 00000000 08:11 512796                     /lib/x86_64-linux-gnu/libgcrypt.so.11.6.0
7f15a74ed000-7f15a76ec000 ---p 00076000 08:11 512796                     /lib/x86_64-linux-gnu/libgcrypt.so.11.6.0
7f15a76ec000-7f15a76ed000 r--p 00075000 08:11 512796                     /lib/x86_64-linux-gnu/libgcrypt.so.11.6.0
7f15a76ed000-7f15a76f0000 rw-p 00076000 08:11 512796                     /lib/x86_64-linux-gnu/libgcrypt.so.11.6.0
7f15a76f0000-7f15a7715000 r-xp 00000000 08:11 58807                      /usr/lib/libssh2.so.1.0.1
7f15a7715000-7f15a7915000 ---p 00025000 08:11 58807                      /usr/lib/libssh2.so.1.0.1
7f15a7915000-7f15a7916000 r--p 00025000 08:11 58807                      /usr/lib/libssh2.so.1.0.1
7f15a7916000-7f15a7917000 rw-p 00026000 08:11 58807                      /usr/lib/libssh2.so.1.0.1
7f15a7917000-7f15a793c000 r-xp 00000000 08:11 838561                     /usr/local/lib/perl/5.12.4/auto/Net/SSH2/SSH2.so
7f15a793c000-7f15a7b3b000 ---p 00025000 08:11 838561                     /usr/local/lib/perl/5.12.4/auto/Net/SSH2/SSH2.so
7f15a7b3b000-7f15a7b3c000 r--p 00024000 08:11 838561                     /usr/local/lib/perl/5.12.4/auto/Net/SSH2/SSH2.so
7f15a7b3c000-7f15a7b3d000 rw-p 00025000 08:11 838561                     /usr/local/lib/perl/5.12.4/auto/Net/SSH2/SSH2.so
7f15a7b3d000-7f15a7b40000 r-xp 00000000 08:11 772584                     /usr/lib/perl/5.12.4/auto/Fcntl/Fcntl.so
7f15a7b40000-7f15a7d40000 ---p 00003000 08:11 772584                     /usr/lib/perl/5.12.4/auto/Fcntl/Fcntl.so
7f15a7d40000-7f15a7d41000 r--p 00003000 08:11 772584                     /usr/lib/perl/5.12.4/auto/Fcntl/Fcntl.so
7f15a7d41000-7f15a7d42000 rw-p 00004000 08:11 772584                     /usr/lib/perl/5.12.4/auto/Fcntl/Fcntl.so
7f15a7d42000-7f15a7d47000 r-xp 00000000 08:11 772589                     /usr/lib/perl/5.12.4/auto/IO/IO.so
7f15a7d47000-7f15a7f46000 ---p 00005000 08:11 772589                     /usr/lib/perl/5.12.4/auto/IO/IO.so
7f15a7f46000-7f15a7f47000 r--p 00004000 08:11 772589                     /usr/lib/perl/5.12.4/auto/IO/IO.so
7f15a7f47000-7f15a7f48000 rw-p 00005000 08:11 772589                     /usr/lib/perl/5.12.4/auto/IO/IO.so
7f15a7f48000-7f15a7f4e000 r-xp 00000000 08:11 772594                     /usr/lib/perl/5.12.4/auto/Socket/Socket.so
7f15a7f4e000-7f15a814e000 ---p 00006000 08:11 772594                     /usr/lib/perl/5.12.4/auto/Socket/Socket.so
7f15a814e000-7f15a814f000 r--p 00006000 08:11 772594                     /usr/lib/perl/5.12.4/auto/Socket/Socket.so
7f15a814f000-7f15a8150000 rw-p 00007000 08:11 772594                     /usr/lib/perl/5.12.4/auto/Socket/Socket.so
7f15a8150000-7f15a86d4000 r--p 00000000 08:11 131598                     /usr/lib/locale/locale-archive
7f15a86d4000-7f15a86dd000 r-xp 00000000 08:11 392358                     /lib/x86_64-linux-gnu/libcrypt-2.13.so
7f15a86dd000-7f15a88dd000 ---p 00009000 08:11 392358                     /lib/x86_64-linux-gnu/libcrypt-2.13.so
7f15a88dd000-7f15a88de000 r--p 00009000 08:11 392358                     /lib/x86_64-linux-gnu/libcrypt-2.13.so
7f15a88de000-7f15a88df000 rw-p 0000a000 08:11 392358                     /lib/x86_64-linux-gnu/libcrypt-2.13.so
7f15a88df000-7f15a890d000 rw-p 00000000 00:00 0 
7f15a890d000-7f15a8925000 r-xp 00000000 08:11 440048                     /lib/x86_64-linux-gnu/libpthread-2.13.so
7f15a8925000-7f15a8b25000 ---p 00018000 08:11 440048                     /lib/x86_64-linux-gnu/libpthread-2.13.soAborted (core dumped)
