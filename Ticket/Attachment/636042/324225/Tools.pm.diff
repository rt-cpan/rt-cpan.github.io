--- Tools.pm 2004-04-18 17:26:11.000000000 -0400
+++ Tools.pm.new       2009-07-21 14:47:35.000000000 -0400
@@ -402,9 +402,17 @@
     foreach my $column_name (@column_names) {
       $args_hash{$column_name} = $element_fields[$j++];
     }
+    our $parentnode=undef;
+    $self->allProcess( sub {
+                        my ($self,$parent) = @_;
+                               our $parentnode;
+                               $_ = $self->getserial ;
+                        $parentnode = $self if $_ == $parent ; 
+                        },
+       $parent );
 
     # Add current node to its parent
-    my $node = $self->getSubTree($parent);
+    my $node = $parentnode ;
     $node = $node->append(%args_hash);
 
   }