From 079898d941daec04fe277f850fe571a3b8b18fde Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Petr=20P=C3=ADsa=C5=99?= <ppisar@redhat.com>
Date: Tue, 11 Nov 2014 14:30:08 +0100
Subject: [PATCH] Write UTF-8-encoded chunk if Locale::Encode is not available
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

CPAN RT#100268

Signed-off-by: Petr Písař <ppisar@redhat.com>
---
 lib/ExtUtils/MakeMaker.pm | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/lib/ExtUtils/MakeMaker.pm b/lib/ExtUtils/MakeMaker.pm
index 028925b..8dfdc47 100644
--- a/lib/ExtUtils/MakeMaker.pm
+++ b/lib/ExtUtils/MakeMaker.pm
@@ -1175,11 +1175,11 @@ sub flush {
     binmode $fh, ':encoding(locale)' if $CAN_DECODE;
 
     for my $chunk (@{$self->{RESULT}}) {
-        my $to_write = "$chunk\n";
+        my $to_write = "$chunk";
         if (!$CAN_DECODE && $] > 5.008) {
             utf8::encode $to_write;
         }
-        print $fh "$chunk\n"
+        print $fh "$to_write\n"
             or die "Can't write to MakeMaker.tmp: $!";
     }
 
-- 
1.9.3

