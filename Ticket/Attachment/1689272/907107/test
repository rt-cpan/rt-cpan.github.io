#!/usr/bin/perl

use strict;

#use Spreadsheet::XLSX;
use Spreadsheet::XLSX13;

my $basedir  = '/mnt/btsfile1/ProductionServices/ServerTeam/Unix_Linux/activity';

my @excels;

@excels = <$basedir/Book1.xlsx>; # real program has more than one

foreach my $excel ( @excels ) {
  print "excel file being parsed:$excel\n";

  my $this_excel = Spreadsheet::XLSX -> new ($excel);
 
  foreach my $sheet (@{$this_excel -> {Worksheet}}) {
    printf("Sheet: %s\n", $sheet->{Name});

    $sheet -> {MaxRow} ||= $sheet -> {MinRow};

    foreach my $row ($sheet->{MinRow} .. $sheet->{MaxRow} ) {
      $sheet -> {MaxCol} ||= $sheet -> {MinCol};
                
      foreach my $col ($sheet->{MinCol} ..  $sheet->{MaxCol}) {
        my $cell = $sheet -> {Cells} [$row] [$col];

        if ($cell) {
          printf("( %s , %s ) => %s\n", $row, $col, $cell -> {Val});
        }

      } # cols
    } # rows
  } # sheets
} # files
