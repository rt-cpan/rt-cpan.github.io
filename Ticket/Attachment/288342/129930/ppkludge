#!/bin/sh

# This is a tweaked version of a script written by Marc Lehmann. Thanks
# for sharing this solution; I would have never figured this out!
#
# The original can be found at: http://data.plan9.de/ppwin
# Here is Marc Lehmann's original comment:
#  Convert a gtk2-perl program to a standalone .exe, including all
#  libraries and runtime files required for running as well as required
#  datafiles. I _literaly_ sold my soul to the devil and paid with blood
#  for this. Microsoft die die die die die die die die die die die die

GTK2="/cygdrive/c/Progra~1/Common~1/Gtk/2.0"

(
   cat <<EOF
c:\Perl\site\lib\auto\Cairo\Cairo.dll;root/Cairo.dll
c:\Perl\site\lib\auto\Glib\Glib.dll;root/Glib.dll
c:\Perl\site\lib\auto\Gtk2\Gtk2.dll;root/Gtk2.dll
# Here down, needed for systems w/o gtk
`cygpath -w $GTK2/etc`;root/etc
`cygpath -w $GTK2/lib/pango`;root/lib/pango
`cygpath -w $GTK2/lib/gtk-2.0`;root/lib/gtk-2.0
`cygpath -w $GTK2/share/themes/MS-Windows/gtk-2.0`;root/share/themes/MS-Windows/gtk-2.0
EOF

   cd "$GTK2/bin" || exit
   for dll in *.dll; do
      echo "`cygpath -w $GTK2/bin/$dll`;root/$dll"
   done
) >addlist

trap "/cygwin/bin/rm addlist" 0

PATH=/cygdrive/c/WINDOWS/system32:/cygdrive/c/WINDOWS:/cygdrive/c/perl/bin
/cygdrive/c/perl/bin/perl /perl/bin/pp -o test.exe -I lib -A addlist test.pl


