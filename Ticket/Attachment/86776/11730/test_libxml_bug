#!/usr/bin/perl -w
use strict;

use Test::More qw(no_plan);

use XML::LibXML;

my $xmldecl=qq{<?xml version="1.0"?>\n};

{
my $doc= XML::LibXML->new()->parse_string( '<doc>text</doc>');
my $prefix= $doc->createTextNode( "prefix ");
my $root= $doc->documentElement;
$root->insertBefore( $prefix, undef);
is( $doc->toString, "$xmldecl<doc>prefix text</doc>\n", "insertBefore an undef text");
}

print "\n";

{
print "insertBefore an undef element (bug):\n";
my $doc= XML::LibXML->new()->parse_string( '<doc><elt>text</elt><elt>text2</elt></doc>');
my $prefix= $doc->createTextNode( "prefix ");
my $root= $doc->documentElement;
$root->insertBefore( $prefix, undef);
is( $doc->toString, "$xmldecl<doc>prefix text<elt>text</elt><elt>text2</elt></doc>\n", "insertBefore an undef element");
}

print "\n";

{
my $doc= XML::LibXML->new()->parse_string( '<doc>text</doc>');
my $prefix= $doc->createTextNode( "prefix ");
my $root= $doc->documentElement;
my $text= $root->getFirstChild;
$root->insertBefore( $prefix, $text);
is( $doc->toString, "$xmldecl<doc>prefix text</doc>\n", "insertBefore a defined text");
}

print "\n";

{
my $doc= XML::LibXML->new()->parse_string( '<doc><elt>text</elt></doc>');
my $prefix= $doc->createTextNode( "prefix ");
my $root= $doc->documentElement;
my $text= $root->getFirstChild;
$root->insertBefore( $prefix, $text);
is( $doc->toString, "$xmldecl<doc>prefix <elt>text</elt></doc>\n", "insertBefore a defined element") ;
}

print "\n";

{
my $doc= XML::LibXML->new()->parse_string( '<doc>text</doc>');
my $prefix= $doc->createTextNode( " suffix");
my $root= $doc->documentElement;
$root->insertAfter( $prefix, undef);
is( $doc->toString, "$xmldecl<doc>text suffix</doc>\n", 'insertAfter an undef text');
}


