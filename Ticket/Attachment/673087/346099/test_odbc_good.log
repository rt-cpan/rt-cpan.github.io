Z:\Perl>test_odbc.pl
    DBI 1.609-ithread default trace level set to 0x6000000/15 (pid 7960) at test_odbc.pl line 9
    -> DBI->connect(DBI:ODBC:driver={SQL Server};Server=avm01;Database=test, , ****)
    -> DBI->install_driver(ODBC) for MSWin32 perl=5.010001 pid=7960 ruid=0 euid=0
       install_driver: DBD::ODBC version 1.22 loaded from C:/Perl/lib/DBD/ODBC.pm
    New 'DBI::dr' (for DBD::ODBC::dr, parent='', id=undef)
    dbih_setup_handle(DBI::dr=HASH(0x25e5cbc)=>DBI::dr=HASH(0x25e5d1c), DBD::ODBC::dr, 0, Null!)
    dbih_make_com(Null!, 0, DBD::ODBC::dr, 92, 0) thr#1562644
    dbih_setup_attrib(DBI::dr=HASH(0x25e5d1c), Err, Null!) SCALAR(0x1505b64) (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x25e5d1c), State, Null!) SCALAR(0x1505b04) (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x25e5d1c), Errstr, Null!) SCALAR(0x1505b34) (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x25e5d1c), TraceLevel, Null!) 0 (already defined)
    dbih_setup_attrib(DBI::dr=HASH(0x25e5d1c), FetchHashKeyName, Null!) 'NAME' (already defined)
    <- install_driver= DBI::dr=HASH(0x25e5cbc)
    >> default_user DISPATCH (DBI::dr=HASH(0x25e5cbc) rc1/3 @4 g1 ima1 pid#7960) at C:/Perl/site/lib/DBI.pm line 641 via  at Z:\Perl\test_odbc.pl line 12
    !! warn: 0 CLEARED by call to default_user method
    -> default_user in DBD::_::dr for DBD::ODBC::dr (DBI::dr=HASH(0x25e5cbc)~0x25e5d1c undef undef HASH(0x1506e5c)) thr#1562644
    <- default_user= ( undef undef ) [2 items] at C:/Perl/site/lib/DBI.pm line 641 via  at Z:\Perl\test_odbc.pl line 12
    >> connect     DISPATCH (DBI::dr=HASH(0x25e5cbc) rc2/3 @5 g0 ima8001 pid#7960) at C:/Perl/site/lib/DBI.pm line 653
    -> connect for DBD::ODBC::dr (DBI::dr=HASH(0x25e5cbc)~0x25e5d1c 'driver={SQL Server};Server=avm01;Database=test' undef **** HASH(0x1506e5c)) thr#1562644
    New 'DBI::db' (for DBD::ODBC::db, parent=DBI::dr=HASH(0x25e5d1c), id=undef)
    dbih_setup_handle(DBI::db=HASH(0x25e621c)=>DBI::db=HASH(0x25e616c), DBD::ODBC::db, 25d5104, Null!)
    dbih_make_com(DBI::dr=HASH(0x25e5d1c), 143ce5c, DBD::ODBC::db, 348, 0) thr#1562644
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), Err, DBI::dr=HASH(0x25e5d1c)) SCALAR(0x25d5314) (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), State, DBI::dr=HASH(0x25e5d1c)) SCALAR(0x25d5394) (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), Errstr, DBI::dr=HASH(0x25e5d1c)) SCALAR(0x25d5354) (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), TraceLevel, DBI::dr=HASH(0x25e5d1c)) 0 (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), FetchHashKeyName, DBI::dr=HASH(0x25e5d1c)) 'NAME' (already defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), HandleSetErr, DBI::dr=HASH(0x25e5d1c)) undef (not defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), HandleError, DBI::dr=HASH(0x25e5d1c)) undef (not defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), ReadOnly, DBI::dr=HASH(0x25e5d1c)) undef (not defined)
    dbih_setup_attrib(DBI::db=HASH(0x25e616c), Profile, DBI::dr=HASH(0x25e5d1c)) undef (not defined)
dbd_db_login6
    SQLDriverConnect 'driver={SQL Server};Server=avm01;Database=test;UID=;PWD=;', '', 'xxxx'
Out connection string: DRIVER=SQL Server;SERVER=avm01;UID=tanner;PWD=;Trusted_Connection=Yes;APP=ActivePerl;WSID=PC039716;DATABASE=test
    !!dbd_error2(err_rc=1, what=db_login/SQLConnect, handles=(2507970,1436488,0)
    !SQLError(2507970,1436488,0) = (01000, 5701, [Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'.)
    !SQLError(2507970,1436488,0) = (01000, 5703, [Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english.)
Turning autocommit on
DRIVER_ODBC_VER = 03.52
DRIVER_NAME = SQLSRV32.DLL
DRIVER_VERSION = 06.01.7600
MAX_COLUMN_NAME_LEN = 128
DBD::ODBC is unicode built : YES
Deferring Binding
SQL_DBMS_NAME = Microsoft SQL Server
SQLMoreResults supported: 1
SQLDescribeParam supported: 1
SQLDescribeParam supported: 1
    <- connect= DBI::db=HASH(0x25e621c) at C:/Perl/site/lib/DBI.pm line 653
    >> STORE       DISPATCH (DBI::db=HASH(0x25e616c) rc2/1 @3 g0 ima41c pid#7960) at C:/Perl/site/lib/DBI.pm line 705
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x25e616c)~INNER 'PrintError' 1) thr#1562644
    !!DBD::ODBC unsupported attribute passed (PrintError)
    STORE DBI::db=HASH(0x25e616c) 'PrintError' => 1
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 705
    >> STORE       DISPATCH (DBI::db=HASH(0x25e616c) rc2/1 @3 g0 ima41c pid#7960) at C:/Perl/site/lib/DBI.pm line 705
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x25e616c)~INNER 'AutoCommit' 1) thr#1562644
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 705
    >> STORE       DISPATCH (DBI::db=HASH(0x25e616c) rc2/1 @3 g0 ima41c pid#7960) at C:/Perl/site/lib/DBI.pm line 708 via  at Z:\Perl\test_odbc.pl line 12
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x25e616c)~INNER 'Username' undef) thr#1562644
    !!DBD::ODBC unsupported attribute passed (Username)
    STORE DBI::db=HASH(0x25e616c) 'Username' => undef
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 708 via  at Z:\Perl\test_odbc.pl line 12
    >> FETCH       DISPATCH (DBI::db=HASH(0x25e616c) rc2/1 @2 g0 ima404 pid#7960) at C:/Perl/site/lib/DBI.pm line 708
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <> FETCH= undef ('Username' from cache) at C:/Perl/site/lib/DBI.pm line 708
    >> connected   DISPATCH (DBI::db=HASH(0x25e621c) rc1/1 @2 g0 ima5 pid#7960) at C:/Perl/site/lib/DBI.pm line 714
    -> connected in DBD::_::db for DBD::ODBC::db (DBI::db=HASH(0x25e621c)~0x25e616c 'DBI:ODBC:driver={SQL Server};Server=avm01;Database=test') thr#1562644
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- connected= undef at C:/Perl/site/lib/DBI.pm line 714
    <- connect= DBI::db=HASH(0x25e621c)
    >> STORE       DISPATCH (DBI::db=HASH(0x25e616c) rc2/1 @3 g0 ima41c pid#7960) at C:/Perl/site/lib/DBI.pm line 723 via  at Z:\Perl\test_odbc.pl line 12
    -> STORE for DBD::ODBC::db (DBI::db=HASH(0x25e616c)~INNER 'dbi_connect_closure' CODE(0x25e5bdc)) thr#1562644
    !!DBD::ODBC unsupported attribute passed (dbi_connect_closure)
    STORE DBI::db=HASH(0x25e616c) 'dbi_connect_closure' => CODE(0x25e5bdc)
       info: '' '[Microsoft][ODBC SQL Server Driver][SQL Server]Changed database context to 'test'. (SQL-01000)
[Microsoft][ODBC SQL Server Driver][SQL Server]Changed language setting to us_english. (SQL-01000)' (err#0)
    <- STORE= 1 at C:/Perl/site/lib/DBI.pm line 723 via  at Z:\Perl\test_odbc.pl line 12
    >> prepare     DISPATCH (DBI::db=HASH(0x25e621c) rc1/1 @2 g0 imaa201 pid#7960) at Z:\Perl\test_odbc.pl line 36
    !! info: '' CLEARED by call to prepare method
    -> prepare for DBD::ODBC::db (DBI::db=HASH(0x25e621c)~0x25e616c '    SELECT
        (SELECT XLATSHORTNAME FROM PSXLATITEM X
            WHERE FIELDNAME = 'ENRL_REQ_DETL_STAT'
            AND FIELDVALUE = D.ENRL_REQ_DETL_STAT
            AND X.EFF_STATUS = 'A'
            AND EFFDT = (
                SELECT MAX(X2.EFFDT) FROM PSXLATITEM X2
                WHERE X.FIELDNAME = X2.FIELDNAME
                AND X.FIELDVALUE = X2.FIELDVALUE
                AND X2.EFF_STATUS = 'A'
                )
        )
    FROM
        PS_ENRL_REQ_DETAIL AS D
    WHERE
        D.STRM = ?
') thr#1562644
    New 'DBI::st' (for DBD::ODBC::st, parent=DBI::db=HASH(0x25e616c), id=undef)
    dbih_setup_handle(DBI::st=HASH(0x25e638c)=>DBI::st=HASH(0x25e630c), DBD::ODBC::st, 25d53f4, Null!)
    dbih_make_com(DBI::db=HASH(0x25e616c), 1439544, DBD::ODBC::st, 220, 0) thr#1562644
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), Err, DBI::db=HASH(0x25e616c)) SCALAR(0x25d5314) (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), State, DBI::db=HASH(0x25e616c)) SCALAR(0x25d5394) (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), Errstr, DBI::db=HASH(0x25e616c)) SCALAR(0x25d5354) (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), TraceLevel, DBI::db=HASH(0x25e616c)) 0 (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), FetchHashKeyName, DBI::db=HASH(0x25e616c)) 'NAME' (already defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), HandleSetErr, DBI::db=HASH(0x25e616c)) undef (not defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), HandleError, DBI::db=HASH(0x25e616c)) undef (not defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), ReadOnly, DBI::db=HASH(0x25e616c)) undef (not defined)
    dbih_setup_attrib(DBI::st=HASH(0x25e630c), Profile, DBI::db=HASH(0x25e616c)) undef (not defined)
    initializing sth query timeout to -1
    ignore named placeholders = 0
    creating new parameter key 1
    dbd_preparse scanned 1 distinct placeholders
    SQLPrepare     SELECT
        (SELECT XLATSHORTNAME FROM PSXLATITEM X
            WHERE FIELDNAME = 'ENRL_REQ_DETL_STAT'
            AND FIELDVALUE = D.ENRL_REQ_DETL_STAT
            AND X.EFF_STATUS = 'A'
            AND EFFDT = (
                SELECT MAX(X2.EFFDT) FROM PSXLATITEM X2
                WHERE X.FIELDNAME = X2.FIELDNAME
                AND X.FIELDVALUE = X2.FIELDVALUE
                AND X2.EFF_STATUS = 'A'
                )
        )
    FROM
        PS_ENRL_REQ_DETAIL AS D
    WHERE
        D.STRM = ?

    Processing non-utf8 sql in unicode mode
    SQLPrepare = 0
    <- prepare= DBI::st=HASH(0x25e638c) at Z:\Perl\test_odbc.pl line 36
Execute DBI = 1.609, DBD::ODBC = 1.22
    >> execute     DISPATCH (DBI::st=HASH(0x25e638c) rc1/1 @2 g0 ima1041 pid#7960) at Z:\Perl\test_odbc.pl line 39
    -> execute for DBD::ODBC::st (DBI::st=HASH(0x25e638c)~0x25e630c 1099) thr#1562644
+dbd_bind_ph(25d5414, name=1, value='1099', attribs=, sql_type=0(unknown), is_inout=0, maxlen=0
    +get_param_type(25d5414,1)
      SQLDescribeParam failed reverting to default SQL bind type -9
07009 [Microsoft][ODBC SQL Server Driver]Invalid Descriptor Index
42000 [Microsoft][ODBC SQL Server Driver]Syntax error or access violation
      get_param_type: modified value type to SQL_C_WCHAR
    -get_param_type
-dbd_bind_ph=1
+dbd_st_execute(25d5414)
    dbd_st_finish(25d5414)
    outparams = 0
    +rebind_param 1 '1099' (size svCUR=4/SvLEN=8/max=0) svtype 6, value type:-8 sql type:-9
    +get_param_type(25d5414,1)
      SQLDescribeParam already run and returned rc=-1
      get_param_type: modified value type to SQL_C_WCHAR
    -get_param_type
      Need to modify phs->sv in place: old length = 4
      Need to modify phs->sv in place: new length = 8
      bind 1 '1' value_len=8 maxlen=10 null=0)
      bind 1 value_type:-8 UNICODE VARCHAR cs=8 dd=0 bl=8
    SQLBindParameter: idx=1: param_type=1, name=1, value_type=-8, SQL_Type=-9, column_size=8, d_digits=0, value_ptr=255f50c, buffer_length=8, cbValue=8, param_size=0
    -rebind_param
    SQLExecute/SQLExecDirect(262d588)=0
    SQLRowCount=0 (rows=0)
    dbd_describe done_desc=0
    dbd_describe SQLNumResultCols=0 (columns=1)
   DescribeCol column = 1, name = , namelen = 0, type = VARCHAR(12), precision/column size = 10, scale = 0, nullable = 1
     display size = 10
     column length = 10
     now using col 1: type = VARCHAR (12), len = 11, display size = 11, prec = 10, scale = 0
    Bind 1: type = CHAR(1), buf=26244ac, buflen=11
    have 1 fields
-dbd_st_execute(25d5414)=0
    <- execute= '0E0' at Z:\Perl\test_odbc.pl line 39
    >> DESTROY     DISPATCH (DBI::st=HASH(0x25e638c) rc1/1 @1 g0 ima10004 pid#7960)
    <> DESTROY(DBI::st=HASH(0x25e638c)) ignored for outer handle (inner DBI::st=HASH(0x25e630c) has ref cnt 1)
    >> DESTROY     DISPATCH (DBI::st=HASH(0x25e630c) rc1/1 @1 g0 ima10004 pid#7960)
    -> DESTROY for DBD::ODBC::st (DBI::st=HASH(0x25e630c)~INNER) thr#1562644
    dbd_st_finish(25e63dc)
    dbd_st_finish closed query:
   SQLFreeStmt=0.
    <- DESTROY= undef
    DESTROY (dbih_clearcom) (sth 0x25e630c, com 0x262aefc, imp DBD::ODBC::st):
       FLAGS 0x180111: COMSET Warn PrintError PrintWarn
       PARENT DBI::db=HASH(0x25e616c)
       KIDS 0 (0 Active)
       NUM_OF_FIELDS 1
       NUM_OF_PARAMS 1
    dbih_clearcom 0x25e630c (com 0x262aefc, type 3) done.

    >> DESTROY     DISPATCH (DBI::db=HASH(0x25e621c) rc1/1 @1 g0 ima10004 pid#7960)
    <> DESTROY(DBI::db=HASH(0x25e621c)) ignored for outer handle (inner DBI::db=HASH(0x25e616c) has ref cnt 1)
    >> DESTROY     DISPATCH (DBI::db=HASH(0x25e616c) rc1/1 @1 g0 ima10004 pid#7960)
    -> DESTROY for DBD::ODBC::db (DBI::db=HASH(0x25e616c)~INNER) thr#1562644
SQLDisconnect=0
    DBD::ODBC Disconnected!
    <- DESTROY= undef
    DESTROY (dbih_clearcom) (dbh 0x25e616c, com 0x1439544, imp DBD::ODBC::db):
       FLAGS 0x180311: COMSET Warn PrintError PrintWarn AutoCommit
       PARENT DBI::dr=HASH(0x25e5d1c)
       KIDS 0 (0 Active)
    dbih_clearcom 0x25e616c (com 0x1439544, type 2) done.

    -- DBI::END ($@: , $!: )
    >> disconnect_all DISPATCH (DBI::dr=HASH(0x25e5cbc) rc1/3 @1 g0 ima801 pid#7960) at C:/Perl/site/lib/DBI.pm line 731 via  at Z:\Perl\test_odbc.pl line 0
    !! info: '' CLEARED by call to disconnect_all method
    -> disconnect_all for DBD::ODBC::dr (DBI::dr=HASH(0x25e5cbc)~0x25e5d1c) thr#1562644
    <- disconnect_all= '' at C:/Perl/site/lib/DBI.pm line 731 via  at Z:\Perl\test_odbc.pl line 0
!   >> DESTROY     DISPATCH (DBI::dr=HASH(0x25e5d1c) rc1/1 @1 g0 ima10004 pid#7960) during global destruction
!   -> DESTROY in DBD::_::common for DBD::ODBC::dr (DBI::dr=HASH(0x25e5d1c)~INNER) thr#1562644
!   <- DESTROY= undef during global destruction
    DESTROY (dbih_clearcom) (drh 0x25e5cbc, com 0x143ce5c, imp global destruction):
       FLAGS 0x100215: COMSET Active Warn PrintWarn AutoCommit
       PARENT undef
       KIDS 0 (0 Active)
    dbih_clearcom 0x25e5cbc (com 0x143ce5c, type 1) done.

!   >> DESTROY     DISPATCH (DBI::dr=HASH(0x25e5cbc) rc1/1 @1 g0 ima10004 pid#7960) during global destruction
!   <> DESTROY for DBI::dr=HASH(0x25e5cbc) ignored (inner handle gone)
















































































