<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #2925 for Spreadsheet-WriteExcel: Writing a long formula &#40;&gt;255 chars&#41; to the same cell twice causes Excel crash</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #2925 for Spreadsheet-WriteExcel: Writing a long formula &#40;&gt;255 chars&#41; to the same cell twice causes Excel crash</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-WriteExcel/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-WriteExcel/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-WriteExcel/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Spreadsheet-WriteExcel/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-WriteExcel">Spreadsheet-WriteExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::WriteExcel here are some pointers</b>
<p>

1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>

2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>

3) Upgrade to the latest version of Spreadsheet::WriteExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.

<p>
4) <b>Create a small but complete example program that demonstrates your problem.</b> The program should be as small as possible. At the same time it should be a complete program that generates an Excel file. If the Spreadsheet::WriteExcel section is part of a much larger program then simplify it down to the essentials. Simulate any DB reads with an array.
<p>

5) Say if you tested with Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>

6) If you are submitting a patch you should check with the author whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-writeexcel">Spreadsheet::WriteExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">2925</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Spreadsheet-WriteExcel/Active/">Spreadsheet-WriteExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">jmcnamara [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jon.daniel [...] intercity-comms.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Unimportant    </td>
  </tr>
  <tr id="CF-29480-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.37    </td>
  </tr>
  <tr id="CF-29481-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;10&nbsp;06:22:55&nbsp;2003</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Writing a long formula &#40;&gt;255 chars&#41; to the same cell twice causes
    Excel crash</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">$ perl -v
This is perl, version 5.005_03 built for aix
$ uname -a
AIX 59H 3 4 0009388AA100
$ oslevel
4.3.3.0

Hi, I currently use the Spreadsheet::WriteExcel module to convert some manually produced HTML reports into Excel format - I&#39;ve come across a problem when trying to write long strings to a cell repeatedly.

e.g.

$test = $worksheet-&gt;write&#40;1,1,long_string&#40;$str&#41;&#41;;
$test = $worksheet-&gt;write&#40;1,1,long_string&#40;$str&#41;&#41;;

When trying to load the produced spreadsheet using Excel, I consistently get a memory error, and a prompt crash of Excel &#40;with &#34;The instruction at 0x301ee91e referenced memory at 0x00000000.  The memory could not be read&#34;&#41;.
I&#39;ve attached a test perl script which should show this in more detail.

I&#39;m attempting to create a workaround &#40;i.e. Make sure I only write long strings once!&#41;, but this may be tricky considering my source information.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w

# Converts a HTML file into Excel format. &#40;badly&#41;
# Author: Jonathan Daniel - jon.daniel@intercity-comms.com
# Version: 1.0
# Date: 30/08/02
# Description:
#   Takes a html file, and converts it into an excel file.
#	Designed for where I have good control over the html file being produced,
#	and if your data is not organised into tables &#40;or the tables are nested&#41; 
#	then it&#39;ll produce rather unsatisfactory results.
#
# Version 1.1,  07/05/03
# &#34;use strict&#34;.
# Occasionally HTML::Parser would decide it was only going to spit out half 
# of the detail between &lt;td&gt; tags, so I&#39;ve had to buffer to prevent data loss.
# Now recognises the th tag, and handles hr better.
# Space stripping on number columns improved.
#

use strict;
use Spreadsheet::WriteExcel;

# define variables:
my $outputfile = &#34;&#34;;

# Parse arguments
if&#40;@ARGV &lt; 1&#41;
{
	print &#34;test.pl outputfile&#34;;
	exit&#40;1&#41;;
}
$outputfile = $ARGV[0];

# Define variables

# Setup spreadsheet
my $workbook = Spreadsheet::WriteExcel-&gt;new&#40;$outputfile&#41;;
my $prevtext = &#34;&#34;;
my $worksheet = $workbook-&gt;addworksheet&#40;&#41;;
$worksheet-&gt;hide_gridlines&#40;2&#41;;

# Initialise very long string...
$prevtext = &#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE&#34;;

# Attempt to write
my $test = 0;
$test = $worksheet-&gt;write_string&#40;1,1,$prevtext&#41;;
if&#40;$test == -3&#41;
{
	# string was too long to be written use long string instead to write as a formula...
	$test = $worksheet-&gt;write&#40;1,1,long_string&#40;$prevtext&#41;&#41;;
}
# Ok, now try writing to the same cell again, with the same long string
# Excel will now crash when trying to load this spreadsheet
$test = $worksheet-&gt;write&#40;1,1,long_string&#40;$prevtext&#41;&#41;;

# Note that my source sometimes splits large strings up, so I have to rewrite a
# cell occasionally - rewriting works fine, but not for long strings - I think
# most formulas are OK though, though I don&#39;t tend to use them except for
# long_string&#40;&#41;

# Also fails, just attempting to write a long string twice - e.g.
#$test = $worksheet-&gt;write&#40;1,1,long_string&#40;$prevtext&#41;&#41;;
#$test = $worksheet-&gt;write&#40;1,1,long_string&#40;$prevtext&#41;&#41;;

# Note the following double write does not crash Excel!
#$test = $worksheet-&gt;write&#40;2,2,&#34;=A1&#34;&#41;;
#$test = $worksheet-&gt;write&#40;2,2,&#34;=A1&#34;&#41;;

#----------------------------------------

#sub tag
#{
#   my&#40;$tag, $num, $attr&#41; = @_;
#   $inside{$tag} += $num;
#   if&#40;@_ eq &#34;table&#34;&#41;
#   {
#    $intable++;
#   }
#   if&#40;@_ eq &#34;/table&#34;&#41;
#   {
#    $intable++;
#   }
#   if&#40;$tag eq &#34;td&#34;&#41;
#   {
#	if&#40;$tdcheck == 0&#41;
#	{
#		$col++;
#		if&#40; $col &gt; $maxcol&#41;
#		{
#			$maxcol = $col;
#		}
#		$tdcheck++;
#	}
#	else
#	{
#		$tdcheck--;
#	}
#   }
#   if&#40;$tag eq &#34;br&#34;&#41;
#   {
#	$row++;
#    $col=0;
#   }
#   if&#40;$tag eq &#34;tr&#34;&#41;
#   {
#	if&#40;$col &gt;= 1&#41;
#	{
#		$row++;
#		$col = 0;
#	}
#   }
#   if&#40;$tag eq &#34;th&#34;&#41;
#   {
#	if&#40;$col &gt;= 1&#41;
#	{
#		$row++;
#		$col = 0;
#	}
#   }
#
#   if&#40;$tag eq &#34;hr&#34;&#41;
#   {
#   	$row++;
#    $col = 0;
## apply changes to column using format11
#	$worksheet-&gt;set_row&#40;$row, undef, $format11&#41;;
#    $row++;
#   }
#
#
#   if&#40;$tag eq &#34;b&#34;&#41;
#   {
#	return;
#   }
#
#   if&#40;$tag eq &#34;td&#34;&#41;
#   {
#	   $prevtext = &#34;&#34;;
#	   if&#40;$attr&#41;{
#		  $fieldtype = 0;
#		  if&#40;exists&#40;$attr-&gt;{style}&#41;&#41;
#		  {
#			  if&#40;$attr-&gt;{style} eq &#34;vnd.ms-excel.numberformat:@&#34;&#41;
#			  {
#				$fieldtype = 1;
#			  }
#			  if&#40;$attr-&gt;{style} eq &#34;vnd.ms-excel.numberformat:0&#34;&#41;
#			  {
#				$fieldtype = 2;
#			  }
#			  if&#40;$attr-&gt;{style} eq &#34;vnd.ms-excel.numberformat:0.00&#34;&#41;
#			  {
#				$fieldtype = 3;
#			  }
#			  if&#40;$attr-&gt;{style} eq &#34;vnd.ms-excel.numberformat:dd/mm/yy&#34;&#41;
#			  {
#				$fieldtype = 4;
#			  }
#		  }
#	   }
#	}
#}
#
#sub text
#{
#    return if&#40;substr&#40;$_[0],0,9&#41; eq &#34;&lt;!DOCTYPE&#34;&#41;;
#    return if $inside{script} || $inside{style} || $inside{title};
#	return if &#40;$_[0] !~ /\S/&#41;;
#	my $subs = &#34;&#34;;
#	my $test = 0;
#	my $test2 = 0;
#
#    if &#40; $inside{table} &#41;
#    {
#	    $prevtext = $prevtext . $_[0];
#		if&#40; $inside{b} &#41;
#		{
#			if&#40;$fieldtype == 0&#41;
#			{
#				$worksheet-&gt;write&#40;$row,$col,$prevtext, $format1&#41;;
#			}
#			if&#40;$fieldtype == 1&#41;
#			{
#				$worksheet-&gt;write&#40;$row,$col,$prevtext, $format1&#41;;
#			}
#			if&#40;$fieldtype == 2&#41;
#			{
#				$prevtext =~ s/ //g;
#				$worksheet-&gt;write&#40;$row,$col,$prevtext, $format8&#41;;
#			}
#			if&#40;$fieldtype == 3&#41;
#			{
#				$prevtext =~ s/ //g;
#				$worksheet-&gt;write&#40;$row,$col,$prevtext,$format9&#41;;
#			}
#			if&#40;$fieldtype == 4&#41;
#			{
#				$worksheet-&gt;write&#40;$row,$col,$prevtext,$format10&#41;;
#			}
#
#			if &#40;$colarray[$col] &lt; length&#40;$prevtext&#41;&#41;
#			{
#				$colarray[$col] = length&#40;$prevtext&#41;;
#			}
#		}
#		else
#		{
#		    if&#40;$fieldtype == 1&#41;
#		    {
#				$test = $worksheet-&gt;write_string&#40;$row,$col,$prevtext&#41;;
#				if&#40;$test == -3&#41;
#				{
#					print &#34;string too long - &#34;;
#					$test = $worksheet-&gt;write&#40;$row,$col,long_string&#40;$prevtext&#41;&#41;;
#					print $test . &#34; &#34; . long_string&#40;$prevtext&#41;;
#				}
#		    }
#			if&#40;$fieldtype == 0&#41;
#		    {
#				$worksheet-&gt;write&#40;$row,$col,$prevtext&#41;;
#			}
#		    if&#40;$fieldtype == 2&#41;
#			{
#				$prevtext =~ s/ //g;
#				$worksheet-&gt;write&#40;$row,$col,$prevtext,$format5&#41;;
#			}
#		    if&#40;$fieldtype == 3&#41;
#			{
#				$prevtext =~ s/ //g;
#				$worksheet-&gt;write&#40;$row,$col,$prevtext,$format6&#41;;
#			}
#		    if&#40;$fieldtype == 4&#41;
#			{
#				$prevtext =~ s/ //g;
#				$worksheet-&gt;write&#40;$row,$col,$prevtext,$format7&#41;;
#			}
#			if &#40;$colarray[$col] &lt; length&#40;$prevtext&#41;&#41;
#			{
#				$colarray[$col] = length&#40;$prevtext&#41;;
#			}
#		}
#    }
#    else
#    {
#		$subs = $_[0];
#		$subs =~ s/\n//g;
#		if&#40; $inside{h1} || $inside{h2} || $inside{h3} || $inside{h4} &#41;
#		{
#			if&#40; $inside{h1} &#41;
#			{
#				$col = 0;
#				$worksheet-&gt;write&#40;$row,$col,$subs, $format2&#41;;
#				$row+=2;
#			}
#			if&#40; $inside{h2} &#41;
#			{
#				$col=0;
#				$worksheet-&gt;write&#40;$row,$col,$subs, $format3&#41;;
#				$row+=2;
#			}
#		}
#		else
#		{
#			$col = 0;
#			$worksheet-&gt;write&#40;$row,$col,$subs&#41;;
#			$row++;
#		}
#    }
#}

######################################################################
#
# long_string&#40;$str&#41;
#
# Converts long strings into an Excel string concatenation formula.
# The concatenation is inserted between words to improve legibility.
#
# returns: An Excel formula if string is longer than 255 chars.
#          The unmodified string otherwise.
#
sub long_string {

    my $str   = shift;
    my $limit = 255;

    # Return short strings
    return $str if length $str &lt;= $limit;

    # Split the line at word boundaries where possible
    my @segments = $str =~ m[.{1,$limit}$|.{1,$limit}\b|.{1,$limit}]sog;

    # Join the string back together with quotes and Excel concatenation
    $str = join &#39;&#34;&#38;&#34;&#39;, @segments;

    # Add formatting to convert the string to a formula string
    return $str = qq&#40;=&#34;$str&#34;&#41;;
}

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;22&nbsp;17:55:17&nbsp;2003</span>
    <span class="description">jmcnamara [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;25&nbsp;18:53:53&nbsp;2003</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
I cannot say why Excel crashes when you write two formulas to the same
cell. As a guess I would say that it is probably due to an incorrect
interpretation of the data as an internal Excel optimisation called a
&#34;shared formula&#34;.

They way to avoid this is to not write more than one formula to the same
cell. I appreciate that this may be difficult in your case but if I
modified Spreadsheet::WriteExcel to keep track of every cell that is
written it would incur a potentially large memory overhead.

However, since you are only using formulas to workaround the 255
character string limit you could avoid this problem altogether by moving
to the Excel 97 beta version of the module. See:

    <span class="clickylink"><a target="new" rel="nofollow" href="http://freshmeat.net/projects/writeexcel/#comment-24916">http://freshmeat.net/projects/writeexcel/#comment-24916</a></span>

This will eventually become the official CPAN version.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;25&nbsp;18:53:55&nbsp;2003</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
