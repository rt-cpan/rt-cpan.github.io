<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #24286 for Win32-Process-Info: Win32::Process::Info clashes with windows fork</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #24286 for Win32-Process-Info: Win32::Process::Info clashes with windows fork</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Win32-Process-Info/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Win32-Process-Info/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Win32-Process-Info/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Win32-Process-Info/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-Process-Info">Win32-Process-Info CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">24286</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Win32-Process-Info/Active/">Win32-Process-Info</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
m.nooning [...] comcast.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35702-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35703-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;11:08:47&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 09 Jan 2007 11:08:16 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> wyant [...] cpan.org,  bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

This email is the same as the last, except that I now included my OS and 
and other information.
 
I have a code snippet, pasted further below, that always crashes the 
perl interpreter.

I do not know if the problem is a fork bug or a Win32::Process::Info 
bug, so I am sending this email to both the fork&#40;&#41; and the 
Win32::Process::Info listed maintainers, just in case the problem is a 
combination of the two together and needs coordination to resolve.  
Unfortunately, the email address for Gurusamy Sarathy 
&lt;gsar@activestate.com&gt;  does not work, so I am trying 
bug-Win32-Process-Info@rt.cpan.org as a wild guess. 

I am using  ActiveState Perl v5.8.8 Binary build 819 [267479]
and I am using Win32::Process::Info version 1.0006.
on an AMD Athlon 64 based Windows XP SP2 machine.

Commenting out the &#34;use&#34; statement will make fork work.  Commenting out 
the fork will make the &#34;use&#34; statement work.

I could not find a report on this on the web.  Any help would be 
appreciated.

Thanks
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;11:17:54&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #24286]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 09 Jan 2007 11:17:41 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#---------- This code always crashes the perl interpreter
#!/usr/bin/perl -w
# file: test_crash_windows_fork.pl

use Win32::Process::Info;

if &#40;my $pid = fork&#40;&#41;&#41; {
  print &#34;Parent\n&#34;;
}
elsif&#40;defined $pid&#41; {
  print &#34;Child&#34;;
  exit;
} else {
  print &#34;Failed to fork:$!:\n&#34;;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;16:06:56&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">M. Nooning -

Thank you very much for your bug report.

Unfortunately I have no Wintel equipment at my disposal at the moment.
Would you be willing to execute the attached Perl script and let me know
the results? I have tried to make sure it has DOS newlines, but the
proof is in the execution.

What this is is a blatant attempt to pass the buck, but there may be
some logic in it. Your test script works as expected on my machine &#40;Mac
OS 10.3.9&#41;. You may say this is not suprising, but it may narrow things
down some, since you say that &#34;use Win32::Process::Info;&#34; is enough to
cause the script to fail, and there is some eval&#39;ed code that doesn&#39;t
get executed &#40;at least not much&#41; on my system. What the attached file is
is your script, but with &#39;use&#39; statements representing the modules
included in the &#39;eval&#39; code, and with &#39;use Win32::Process::Info;&#39;
commented out. If it still blows up, maybe the &#34;blowup&#34; can be isolated
to one of the modules I use, in which case the buck gets passed to the
author of that module.

If it doesn&#39;t blow up, I may pass you the eval&#39;ed code verbatim to see
if that tells us anything.

If it turns out to be me versus ActiveState, I don&#39;t know how much I can
promise, unless maybe a workaround. They have nothing to do with
Win32::Process::Info, and I have nothing to do with them, except that I
have found that they don&#39;t answer their mail very well. At any rate the
first step if I can&#39;t pass the buck is to find a Wintel machine I can use.

Tom Wyant
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w
# file: test_crash_windows_fork.pl

## use Win32::Process::Info;

use Win32::API;
use Win32API::Registry;

use Win32::OLE;
use Win32::OLE::Const;
use Win32::OLE::Variant;

if &#40;my $pid = fork&#40;&#41;&#41; {
  print &#34;Parent\n&#34;;
}
elsif&#40;defined $pid&#41; {
  print &#34;Child\n&#34;;
  exit;
} else {
  print &#34;Failed to fork:$!:\n&#34;;
}

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;16:07:02&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;16:32:39&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 09 Jan 2007 16:29:35 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I ran your test file verbatim.  I have the same results.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt;commented out
</div>The &#34;use Win32::Process::Info;&#34; was something I tried instead of what is 
in the eval statement.  I tried a lot of things with it and I kept 
getting the same problem.  I then commented it out and started trying 
the eval statement.  Different variations with the eval resulted in the 
same problem so I gave up and reported the bug.

#use Win32::API;  --&gt; Uncommenting this by itself does NOT cause the crash.

#use Win32API::Registry;--&gt; Uncommenting this by itself does NOT cause 
the crash.

#use Win32::OLE;--&gt; Uncommenting this by itself DOES cause the crash.

#use Win32::OLE::Const;--&gt; Uncommenting this by itself DOES cause the crash.

#use Win32::OLE::Variant;--&gt; Uncommenting this by itself DOES cause the 
crash.


I would be pleased to try other things.  What else can I try?

Thanks

 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; M. Nooning -
&gt;
&gt; Thank you very much for your bug report.
&gt;
&gt; Unfortunately I have no Wintel equipment at my disposal at the moment.
&gt; Would you be willing to execute the attached Perl script and let me know
&gt; the results? I have tried to make sure it has DOS newlines, but the
&gt; proof is in the execution.
&gt;
&gt; What this is is a blatant attempt to pass the buck, but there may be
&gt; some logic in it. Your test script works as expected on my machine &#40;Mac
&gt; OS 10.3.9&#41;. You may say this is not suprising, but it may narrow things
&gt; down some, since you say that &#34;use Win32::Process::Info;&#34; is enough to
&gt; cause the script to fail, and there is some eval&#39;ed code that doesn&#39;t
&gt; get executed &#40;at least not much&#41; on my system. What the attached file is
&gt; is your script, but with &#39;use&#39; statements representing the modules
&gt; included in the &#39;eval&#39; code, and with &#39;use Win32::Process::Info;&#39;
&gt; commented out. If it still blows up, maybe the &#34;blowup&#34; can be isolated
&gt; to one of the modules I use, in which case the buck gets passed to the
&gt; author of that module.
&gt;
&gt; If it doesn&#39;t blow up, I may pass you the eval&#39;ed code verbatim to see
&gt; if that tells us anything.
&gt;
&gt; If it turns out to be me versus ActiveState, I don&#39;t know how much I can
&gt; promise, unless maybe a workaround. They have nothing to do with
&gt; Win32::Process::Info, and I have nothing to do with them, except that I
&gt; have found that they don&#39;t answer their mail very well. At any rate the
&gt; first step if I can&#39;t pass the buck is to find a Wintel machine I can use.
&gt;
&gt; Tom Wyant
&gt;   
&gt; ------------------------------------------------------------------------
&gt;
&gt; #!/usr/bin/perl -w
&gt;
&gt; # file: test_crash_windows_fork.pl
&gt;
&gt;
&gt;
&gt; ## use Win32::Process::Info;
&gt;
&gt;
&gt;
&gt; use Win32::API;
&gt;
&gt; use Win32API::Registry;
&gt;
&gt;
&gt;
&gt; use Win32::OLE;
&gt;
&gt; use Win32::OLE::Const;
&gt;
&gt; use Win32::OLE::Variant;
&gt;
&gt;
&gt;
&gt; if &#40;my $pid = fork&#40;&#41;&#41; {
&gt;
&gt;   print &#34;Parent\n&#34;;
&gt;
&gt; }
&gt;
&gt; elsif&#40;defined $pid&#41; {
&gt;
&gt;   print &#34;Child\n&#34;;
&gt;
&gt;   exit;
&gt;
&gt; } else {
&gt;
&gt;   print &#34;Failed to fork:$!:\n&#34;;
&gt;
&gt; }
&gt;
&gt;
&gt;
&gt;   
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;16:44:38&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 09 Jan 2007 16:44:06 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I should add that, in desperation, I uninstalled Perl, went into regedit 
and removed all mention of perl &#40;but not things like &#34;hyperlink&#34;, of 
course&#41;, and then downloaded and installed the Windows &#40;x86&#41; perl, 
v5.8.8 built for MSWin32-x86-multi-thread, which is what I originally had.

I have the same interpreter crashes.

BTW: When I say &#34;crashes&#34;, I mean that a pop up window opens with the 
title &#34;Perl Command Line Interpreter&#34; and the following verbiage.

Perl Command Line Interpreter has encountered a
problem and needs to close.  We are sorry for the
inconvenience.

If you were in the moddle of something, the information you were working on
might be lost.

Please tell Microsoft about this problem.
We have created an error report that you can send to us.  We will treat
this report as confidential and anonymous.


Malcolm Nooning wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I ran your test file verbatim.  I have the same results.
&gt;
<div class="message-stanza open">&gt; &gt;commented out
</div>&gt; The &#34;use Win32::Process::Info;&#34; was something I tried instead of what 
&gt; is in the eval statement.  I tried a lot of things with it and I kept 
&gt; getting the same problem.  I then commented it out and started trying 
&gt; the eval statement.  Different variations with the eval resulted in 
&gt; the same problem so I gave up and reported the bug.
&gt;
&gt; #use Win32::API;  --&gt; Uncommenting this by itself does NOT cause the 
&gt; crash.
&gt;
&gt; #use Win32API::Registry;--&gt; Uncommenting this by itself does NOT cause 
&gt; the crash.
&gt;
&gt; #use Win32::OLE;--&gt; Uncommenting this by itself DOES cause the crash.
&gt;
&gt; #use Win32::OLE::Const;--&gt; Uncommenting this by itself DOES cause the 
&gt; crash.
&gt;
&gt; #use Win32::OLE::Variant;--&gt; Uncommenting this by itself DOES cause 
&gt; the crash.
&gt;
&gt;
&gt; I would be pleased to try other things.  What else can I try?
&gt;
&gt; Thanks
&gt;
&gt;  via RT wrote:
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;&gt;
&gt;&gt; M. Nooning -
&gt;&gt;
&gt;&gt; Thank you very much for your bug report.
&gt;&gt;
&gt;&gt; Unfortunately I have no Wintel equipment at my disposal at the moment.
&gt;&gt; Would you be willing to execute the attached Perl script and let me know
&gt;&gt; the results? I have tried to make sure it has DOS newlines, but the
&gt;&gt; proof is in the execution.
&gt;&gt;
&gt;&gt; What this is is a blatant attempt to pass the buck, but there may be
&gt;&gt; some logic in it. Your test script works as expected on my machine &#40;Mac
&gt;&gt; OS 10.3.9&#41;. You may say this is not suprising, but it may narrow things
&gt;&gt; down some, since you say that &#34;use Win32::Process::Info;&#34; is enough to
&gt;&gt; cause the script to fail, and there is some eval&#39;ed code that doesn&#39;t
&gt;&gt; get executed &#40;at least not much&#41; on my system. What the attached file is
&gt;&gt; is your script, but with &#39;use&#39; statements representing the modules
&gt;&gt; included in the &#39;eval&#39; code, and with &#39;use Win32::Process::Info;&#39;
&gt;&gt; commented out. If it still blows up, maybe the &#34;blowup&#34; can be isolated
&gt;&gt; to one of the modules I use, in which case the buck gets passed to the
&gt;&gt; author of that module.
&gt;&gt;
&gt;&gt; If it doesn&#39;t blow up, I may pass you the eval&#39;ed code verbatim to see
&gt;&gt; if that tells us anything.
&gt;&gt;
&gt;&gt; If it turns out to be me versus ActiveState, I don&#39;t know how much I can
&gt;&gt; promise, unless maybe a workaround. They have nothing to do with
&gt;&gt; Win32::Process::Info, and I have nothing to do with them, except that I
&gt;&gt; have found that they don&#39;t answer their mail very well. At any rate the
&gt;&gt; first step if I can&#39;t pass the buck is to find a Wintel machine I can use.
&gt;&gt;
&gt;&gt; Tom Wyant
&gt;&gt;   
&gt;&gt; ------------------------------------------------------------------------
&gt;&gt;
&gt;&gt; #!/usr/bin/perl -w
&gt;&gt;
&gt;&gt; # file: test_crash_windows_fork.pl
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; ## use Win32::Process::Info;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; use Win32::API;
&gt;&gt;
&gt;&gt; use Win32API::Registry;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; use Win32::OLE;
&gt;&gt;
&gt;&gt; use Win32::OLE::Const;
&gt;&gt;
&gt;&gt; use Win32::OLE::Variant;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; if &#40;my $pid = fork&#40;&#41;&#41; {
&gt;&gt;
&gt;&gt;   print &#34;Parent\n&#34;;
&gt;&gt;
&gt;&gt; }
&gt;&gt;
&gt;&gt; elsif&#40;defined $pid&#41; {
&gt;&gt;
&gt;&gt;   print &#34;Child\n&#34;;
&gt;&gt;
&gt;&gt;   exit;
&gt;&gt;
&gt;&gt; } else {
&gt;&gt;
&gt;&gt;   print &#34;Failed to fork:$!:\n&#34;;
&gt;&gt;
&gt;&gt; }
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;   
</div></div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;06:34:38&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Jan 2007 06:32:41 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

This is to add that Jan Dubois jand at ActiveState dot com  wrote me 
about this.  I will paste it below.
---------------- paste
I don&#39;t know about Win32::Process::Info, but you definitely cannot use
Win32::OLE in a program that uses &#40;pseudo-&#41;fork.  It is a long
outstanding issue, and not trivial to implement.  Maybe I&#39;ll get around
to it sometime this year, but I&#39;ve been saying this for a while now...

Cheers,
-Jan
-------------end paste

I see that  Win32::Process::Info uses Win32::OLE for WMI.pm, but not for 
NT.pm.  I am using only Windows2000 and above, so I sought to remove all 
references to Win32::OLE by stubbing out Win32::Process::Info::WMI like 
this:

----------paste
package Win32::Process::Info::WMI;
1;
---------end paste

and also, in Info.pm, I added the pound signs below

------------------paste
    WMI =&gt; {
#    make =&gt; sub {
#        require Win32::Process::Info::WMI;
#        Win32::Process::Info::WMI-&gt;new &#40;@_&#41;;
#        },
#    unsupported =&gt; eval {
#        return &#34;I can not find Win32::OLE&#34;
#            unless require Win32::OLE;
#        return 0;
#        },
    },
--------------end paste

and yet the fork_fail.pl you posted still has the same crash.  Is there 
something else I could try?

Thanks
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;07:17:43&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Jan 2007 07:17:23 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have the work around for Windows XP, and probably Windows 2000.  
Namely, what I wrote previously.  I simply missed commenting out a line.

It is not necessary to Stub out Win32::Process::Info::WMI.  It is only 
necessary to comment out the section of Info.pm that I show below.

------------------paste
   WMI =&gt; {
#    make =&gt; sub {
#        require Win32::Process::Info::WMI;
#        Win32::Process::Info::WMI-&gt;new &#40;@_&#41;;
#        },
#    unsupported =&gt; eval {
#        return &#34;I can not find Win32::OLE&#34;
#            unless require Win32::OLE;
#        return 0;
#        },
   },
--------------end paste
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;09:44:42&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Win32::OLE again, huh? I have already had to recommend against the WMI
variant because of memory leaks.

Another workaround is just to find Win32\Process\Info\WMI.pm and rename
it to something else. Both this and the commenting-out have the problem
that they disable the WMI variant for the entire installation.

That entire eval mess was created when Aldo Calpini updated Win32::API,
and it had to be loaded by &#39;use&#39;, by &#39;require&#39; in a BEGIN block, or not
at all.

It sounds like what I need to do is one of two things:

- Create some way to forbid the use of a given variant, probably using
the import&#40;&#41; hooks, or

- Have the &#39;sanity check&#39; code run at load time for the NT variant, but
at execution time for the WMI variant.

The latter is the minimal change in the user interface, and probably
easier, but the former would provide a way to forbid the use of the WMI
variant for the whole script, and I&#39;m leaning toward it if I can make it
work.

If I were to cold-code something up, would you be willing to test it?
Would you take a CPAN-style distribution &#40;which requires you to install
nmake, or to hand-move the .pm files to their proper places&#41;? I _may_ be
able to make a PPM package you can use &#40;I just discovered the existence
of PPM::Make yesterday, though I could attempt it anyway&#41;, but I can&#39;t
guarantee that I can.

Thanks for the checking, and for sharing the definitive response from
ActiveState.

Tom Wyant
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;09:48:42&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Jan 2007 09:48:20 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I would be glad to test whatever you send.  I will make it a high priority.
Thank you for doing what you do.

 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; Win32::OLE again, huh? I have already had to recommend against the WMI
&gt; variant because of memory leaks.
&gt;
&gt; Another workaround is just to find Win32\Process\Info\WMI.pm and rename
&gt; it to something else. Both this and the commenting-out have the problem
&gt; that they disable the WMI variant for the entire installation.
&gt;
&gt; That entire eval mess was created when Aldo Calpini updated Win32::API,
&gt; and it had to be loaded by &#39;use&#39;, by &#39;require&#39; in a BEGIN block, or not
&gt; at all.
&gt;
&gt; It sounds like what I need to do is one of two things:
&gt;
&gt; - Create some way to forbid the use of a given variant, probably using
&gt; the import&#40;&#41; hooks, or
&gt;
&gt; - Have the &#39;sanity check&#39; code run at load time for the NT variant, but
&gt; at execution time for the WMI variant.
&gt;
&gt; The latter is the minimal change in the user interface, and probably
&gt; easier, but the former would provide a way to forbid the use of the WMI
&gt; variant for the whole script, and I&#39;m leaning toward it if I can make it
&gt; work.
&gt;
&gt; If I were to cold-code something up, would you be willing to test it?
&gt; Would you take a CPAN-style distribution &#40;which requires you to install
&gt; nmake, or to hand-move the .pm files to their proper places&#41;? I _may_ be
&gt; able to make a PPM package you can use &#40;I just discovered the existence
&gt; of PPM::Make yesterday, though I could attempt it anyway&#41;, but I can&#39;t
&gt; guarantee that I can.
&gt;
&gt; Thanks for the checking, and for sharing the definitive response from
&gt; ActiveState.
&gt;
&gt; Tom Wyant
&gt;
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;12:42:45&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 10 09:48:42 2007, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I would be glad to test whatever you send.  I will make it a high
</div>priority.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thank you for doing what you do.
&gt; 
</div>
Thank you. I hope to have something today or tomorrow.

What I intend is if you want to completely disable the WMI variant, you

use Win32::Process::Info qw{NT};

This will prevent the script from loading Win32::OLE while trying to
figure out if the WMI variant can be used. At the same time it will be
available to other scripts that &#40;e.g.&#41; don&#39;t use fork&#40;&#41;.

Tom Wyant
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;20:50:39&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Malcolm,

Could you give the attached a try? I _believe_ all the files have DOS
line endings except for META.yml, which gets regenerated as part of the
build process. I believe WINZIP will handle the .tar.gz.

If you have &#39;nmake&#39; installed you can do the usual incantation from the
directory the tarball expanded into:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl Makefile.PL
&gt; nmake
&gt; nmake test
&gt; nmake install
</div>
Or, you can just take the files Info.pm, Info\NT.pm, and Info\WMI.pm
from the kit &#40;they&#39;re under lib\Win32\Process&#41; and drop them the right
place in your @INC directories &#40;saving the old ones in case I screwed
something up badly&#41;.

Please let me know what happens.

Thanks,
Tom
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;21:05:17&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Jan 2007 21:04:49 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

I have a test error.  Is there a command line switch or something I can 
run that will help show up the error better?  I tried -d, as shown, and 
it showed a little more information, but not much.

--------------------paste
C:\temp\Win32-Process-Info-1.006_01&gt;nmake test -d

Microsoft &#40;R&#41; Program Maintenance Utility Version 7.00.9466
Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.

            Makefile.PL         Wed Jan 10 19:50:37 2007
            C:\Perl\lib\Config.pm      Tue Jan 09 15:30:31 2007
            C:\Perl\lib\CORE\config.h      Tue Jan 09 15:30:31 2007
          Makefile              Wed Jan 10 20:59:45 2007
            C:\Perl\lib\CORE\perl.h      Wed Mar 15 13:23:04 2006
            C:\Perl\lib\CORE\perl.h      Wed Mar 15 13:23:04 2006
            C:\Perl\lib\CORE\perl.h      Wed Mar 15 13:23:04 2006
            C:\Perl\lib\CORE\perl.h      Wed Mar 15 13:23:04 2006
          lib/Win32/Process/Info.pm        Wed Jan 10 19:50:37 2007
          lib/Win32/Process/Info/NT.pm        Wed Jan 10 19:50:37 2007
          lib/Win32/Process/Info/WMI.pm        Wed Jan 10 19:50:37 2007
        pm_to_blib              Wed Jan 10 20:59:48 2007
            Makefile            Wed Jan 10 20:59:45 2007
        C:\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; 
&#34;test_harness&#40;0, &#39;blib\lib&#39;, &#39;blib\arch&#39;&#41;&#34; t\basic.t t\pod.t 
t\pod_coverage.t
t\basic...........ok
t\pod.............ok
t\pod_coverage....
t\pod_coverage....NOK 1#   Failed test &#39;Pod coverage on Encode::RAD50&#39;
#   in t\pod_coverage.t at line 14.
# Encode::RAD50: couldn&#39;t find pod
# Looks like you failed 1 test of 1.
t\pod_coverage....dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 1
        Failed 1/1 tests, 0.00% okay
Failed Test      Stat Wstat Total Fail  Failed  List of Failed
-------------------------------------------------------------------------------
t\pod_coverage.t    1   256     1    1 100.00%  1
Failed 1/3 test scripts, 66.67% okay. 1/20 subtests failed, 95.00% okay.
NMAKE : fatal error U1077: &#39;C:\perl\bin\perl.exe&#39; : return code &#39;0x1&#39;
Stop.


 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; Malcolm,
&gt;
&gt; Could you give the attached a try? I _believe_ all the files have DOS
&gt; line endings except for META.yml, which gets regenerated as part of the
&gt; build process. I believe WINZIP will handle the .tar.gz.
&gt;
&gt; If you have &#39;nmake&#39; installed you can do the usual incantation from the
&gt; directory the tarball expanded into:
&gt;
&gt;   
<div class="message-stanza open">&gt;&gt; perl Makefile.PL
&gt;&gt; nmake
&gt;&gt; nmake test
&gt;&gt; nmake install
&gt;&gt;     
</div>&gt;
&gt; Or, you can just take the files Info.pm, Info\NT.pm, and Info\WMI.pm
&gt; from the kit &#40;they&#39;re under lib\Win32\Process&#41; and drop them the right
&gt; place in your @INC directories &#40;saving the old ones in case I screwed
&gt; something up badly&#41;.
&gt;
&gt; Please let me know what happens.
&gt;
&gt; Thanks,
&gt; Tom
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;21:28:21&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Jan 2007 21:28:01 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I copied over the files manually.  They made no difference.  I still get 
the same crash.


 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; Malcolm,
&gt;
&gt; Could you give the attached a try? I _believe_ all the files have DOS
&gt; line endings except for META.yml, which gets regenerated as part of the
&gt; build process. I believe WINZIP will handle the .tar.gz.
&gt;
&gt; If you have &#39;nmake&#39; installed you can do the usual incantation from the
&gt; directory the tarball expanded into:
&gt;
&gt;   
<div class="message-stanza open">&gt;&gt; perl Makefile.PL
&gt;&gt; nmake
&gt;&gt; nmake test
&gt;&gt; nmake install
&gt;&gt;     
</div>&gt;
&gt; Or, you can just take the files Info.pm, Info\NT.pm, and Info\WMI.pm
&gt; from the kit &#40;they&#39;re under lib\Win32\Process&#41; and drop them the right
&gt; place in your @INC directories &#40;saving the old ones in case I screwed
&gt; something up badly&#41;.
&gt;
&gt; Please let me know what happens.
&gt;
&gt; Thanks,
&gt; Tom
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;10&nbsp;21:34:40&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Jan 2007 21:34:16 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It works.

I forgot to do
      use Win32::Process::Info qw{NT};
instead of
      use Win32::Process::Info;
in my test file.

Sorry about that.

Excellent

 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; Malcolm,
&gt;
&gt; Could you give the attached a try? I _believe_ all the files have DOS
&gt; line endings except for META.yml, which gets regenerated as part of the
&gt; build process. I believe WINZIP will handle the .tar.gz.
&gt;
&gt; If you have &#39;nmake&#39; installed you can do the usual incantation from the
&gt; directory the tarball expanded into:
&gt;
&gt;   
<div class="message-stanza open">&gt;&gt; perl Makefile.PL
&gt;&gt; nmake
&gt;&gt; nmake test
&gt;&gt; nmake install
&gt;&gt;     
</div>&gt;
&gt; Or, you can just take the files Info.pm, Info\NT.pm, and Info\WMI.pm
&gt; from the kit &#40;they&#39;re under lib\Win32\Process&#41; and drop them the right
&gt; place in your @INC directories &#40;saving the old ones in case I screwed
&gt; something up badly&#41;.
&gt;
&gt; Please let me know what happens.
&gt;
&gt; Thanks,
&gt; Tom
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;11&nbsp;09:29:04&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you very much for running the tests. As it turns out, the
information you gave was plenty to resolve the test failure, which was
the result of copying test files from another distribution and not
making all the needed changes.

The command you were looking for is the rather verbose and clumsy

nmake test TEST_VERBOSE=1 TEST_FILES=t/pod_coverage.t

though for my purposes

perl -Mblib t/pod_coverage.t

would have been sufficient and much easier. As it turns out, though, I
do not at the moment need the output of either.

In fixing this one up I made some internal changes to
Win32::Process::Info. Would you be so good as to both &#39;nmake test&#39; the
attached and try the new Info.pm &#40;etc&#41; files in your application?

I have put some weasel words in about the &#39;use Win32::Process::Info
qw{NT}&#39; mechanism maybe changing. There are two issues here, but I think
the only real show-stopper would be if the CPAN distribution failed to
make it into ActiveState&#39;s PPM repository. I had a problem once with
using Exporter &#40;the class that normally supplies the import&#40;&#41; method&#41; in
a non-standard way. Here I am not using Exporter at all, merely
supplying my own import&#40;&#41; method; I do not know if this will trigger the
behaviour I saw before, or if it was a fluke.

The other issue &#40;probably not a show-stopper&#41; is that I seem to recall
that there was a CPAN module that used Win32::Process::Info as a
prerequisite. Unfortunately the only easy source I have for
prerequisites is <span class="clickylink"><a target="new" rel="nofollow" href="http://cpants.perl.org/">http://cpants.perl.org/</a></span> and that is currently being
rebuilt. The only other thing I can think of is to download all of CPAN
and paw through the prerequisites of each. I was hoping to avoid this.
At any event, users of the &#34;other&#34; module can do &#39;use
Win32::Process::Info qw{NT};&#39; first, and then load the other module.

Sorry for the long note, and thanks again for your assistance. Please
let me know how the new kit works.

Tom Wyant
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;11&nbsp;09:46:39&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 11 Jan 2007 09:46:16 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The tests fail

-----------------------------paste first attempt
C:\temp\Win32-Process-Info-1.006_02&gt;nmake test

Microsoft &#40;R&#41; Program Maintenance Utility Version 7.00.9466
Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.

        C:\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; 
&#34;test_harness&#40;0, &#39;blib\lib&#39;, &#39;blib\arch&#39;&#41;&#34; t\basic
.t t\pod.t t\pod_coverage.t
t\basic...........ok
t\pod.............ok
t\pod_coverage....ok 1/3Too late to run INIT block at 
C:/perl/site/lib/Win32/API/Type.pm line 71.

t\pod_coverage....NOK 2#   Failed test &#39;Pod coverage on 
Win32::Process::Info::NT&#39;
#   in C:/perl/site/lib/Test/Pod/Coverage.pm at line 126.
# Coverage for Win32::Process::Info::NT is 60.0%, with 2 naked subroutines:
#       TokenOwner
#       TokenUser
# Looks like you failed 1 test of 3.
t\pod_coverage....dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 2
        Failed 1/3 tests, 66.67% okay
Failed Test      Stat Wstat Total Fail  Failed  List of Failed
-------------------------------------------------------------------------------
t\pod_coverage.t    1   256     3    1  33.33%  2
Failed 1/3 test scripts, 66.67% okay. 1/22 subtests failed, 95.45% okay.
NMAKE : fatal error U1077: &#39;C:\perl\bin\perl.exe&#39; : return code &#39;0x1&#39;
Stop.
-------------------end paste

------------------------------------paste second attempt
C:\temp\Win32-Process-Info-1.006_02&gt;nmake test TEST_VERBOSE=1 
TEST_FILES=t/pod_coverage.t

Microsoft &#40;R&#41; Program Maintenance Utility Version 7.00.9466
Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.

        C:\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; 
&#34;test_harness&#40;1, &#39;blib\lib&#39;, &#39;blib\arch&#39;&#41;&#34; t/pod_c
overage.t
t/pod_coverage....1..3
ok 1 - Pod coverage on Win32::Process::Info
Too late to run INIT block at C:/perl/site/lib/Win32/API/Type.pm line 71.

not ok 2 - Pod coverage on Win32::Process::Info::NT
#   Failed test &#39;Pod coverage on Win32::Process::Info::NT&#39;
#   in C:/perl/site/lib/Test/Pod/Coverage.pm at line 126.
# Coverage for Win32::Process::Info::NT is 60.0%, with 2 naked subroutines:
#       TokenOwner
#       TokenUser
# Looks like you failed 1 test of 3.
ok 3 - Pod coverage on Win32::Process::Info::WMI
dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 2
        Failed 1/3 tests, 66.67% okay
Failed Test      Stat Wstat Total Fail  Failed  List of Failed
-------------------------------------------------------------------------------
t/pod_coverage.t    1   256     3    1  33.33%  2
Failed 1/1 test scripts, 0.00% okay. 1/3 subtests failed, 66.67% okay.
NMAKE : fatal error U1077: &#39;C:\perl\bin\perl.exe&#39; : return code &#39;0x1&#39;
Stop.

C:\temp\Win32-Process-Info-1.006_02&gt;

------------------------end paste


---------------------ah, I now see how the perl -Mblib ... line works. 
----paste

C:\temp\Win32-Process-Info-1.006_02&gt;perl -Mblib t/pod_coverage.t
1..3
ok 1 - Pod coverage on Win32::Process::Info
not ok 2 - Pod coverage on Win32::Process::Info::NT
#   Failed test &#39;Pod coverage on Win32::Process::Info::NT&#39;
#   in C:/perl/site/lib/Test/Pod/Coverage.pm at line 126.
# Coverage for Win32::Process::Info::NT is 60.0%, with 2 naked subroutines:
#       TokenOwner
#       TokenUser
ok 3 - Pod coverage on Win32::Process::Info::WMI
# Looks like you failed 1 test of 3.

C:\temp\Win32-Process-Info-1.006_02&gt;

------------------end paste


 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; Thank you very much for running the tests. As it turns out, the
&gt; information you gave was plenty to resolve the test failure, which was
&gt; the result of copying test files from another distribution and not
&gt; making all the needed changes.
&gt;
&gt; The command you were looking for is the rather verbose and clumsy
&gt;
&gt; nmake test TEST_VERBOSE=1 TEST_FILES=t/pod_coverage.t
&gt;
&gt; though for my purposes
&gt;
&gt; perl -Mblib t/pod_coverage.t
&gt;
&gt; would have been sufficient and much easier. As it turns out, though, I
&gt; do not at the moment need the output of either.
&gt;
&gt; In fixing this one up I made some internal changes to
&gt; Win32::Process::Info. Would you be so good as to both &#39;nmake test&#39; the
&gt; attached and try the new Info.pm &#40;etc&#41; files in your application?
&gt;
&gt; I have put some weasel words in about the &#39;use Win32::Process::Info
&gt; qw{NT}&#39; mechanism maybe changing. There are two issues here, but I think
&gt; the only real show-stopper would be if the CPAN distribution failed to
&gt; make it into ActiveState&#39;s PPM repository. I had a problem once with
&gt; using Exporter &#40;the class that normally supplies the import&#40;&#41; method&#41; in
&gt; a non-standard way. Here I am not using Exporter at all, merely
&gt; supplying my own import&#40;&#41; method; I do not know if this will trigger the
&gt; behaviour I saw before, or if it was a fluke.
&gt;
&gt; The other issue &#40;probably not a show-stopper&#41; is that I seem to recall
&gt; that there was a CPAN module that used Win32::Process::Info as a
&gt; prerequisite. Unfortunately the only easy source I have for
&gt; prerequisites is <span class="clickylink"><a target="new" rel="nofollow" href="http://cpants.perl.org/">http://cpants.perl.org/</a></span> and that is currently being
&gt; rebuilt. The only other thing I can think of is to download all of CPAN
&gt; and paw through the prerequisites of each. I was hoping to avoid this.
&gt; At any event, users of the &#34;other&#34; module can do &#39;use
&gt; Win32::Process::Info qw{NT};&#39; first, and then load the other module.
&gt;
&gt; Sorry for the long note, and thanks again for your assistance. Please
&gt; let me know how the new kit works.
&gt;
&gt; Tom Wyant
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;11&nbsp;13:47:11&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 11 09:46:39 2007, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The tests fail
&gt; 
&gt; -----------------------------paste first attempt
&gt; C:\temp\Win32-Process-Info-1.006_02&gt;nmake test
&gt; 
&gt; Microsoft &#40;R&#41; Program Maintenance Utility Version 7.00.9466
&gt; Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.
&gt; 
&gt;         C:\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&gt; &#34;test_harness&#40;0, &#39;blib\lib&#39;, &#39;blib\arch&#39;&#41;&#34; t\basic
&gt; .t t\pod.t t\pod_coverage.t
&gt; t\basic...........ok
&gt; t\pod.............ok
&gt; t\pod_coverage....ok 1/3Too late to run INIT block at
&gt; C:/perl/site/lib/Win32/API/Type.pm line 71.
&gt; 
&gt; t\pod_coverage....NOK 2#   Failed test &#39;Pod coverage on
&gt; Win32::Process::Info::NT&#39;
&gt; #   in C:/perl/site/lib/Test/Pod/Coverage.pm at line 126.
&gt; # Coverage for Win32::Process::Info::NT is 60.0%, with 2 naked
&gt; subroutines:
&gt; #       TokenOwner
&gt; #       TokenUser
&gt; # Looks like you failed 1 test of 3.
&gt; t\pod_coverage....dubious
&gt;         Test returned status 1 &#40;wstat 256, 0x100&#41;
&gt; DIED. FAILED test 2
&gt;         Failed 1/3 tests, 66.67% okay
&gt; Failed Test      Stat Wstat Total Fail  Failed  List of Failed
&gt;
</div>-------------------------------------------------------------------------------
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; t\pod_coverage.t    1   256     3    1  33.33%  2
&gt; Failed 1/3 test scripts, 66.67% okay. 1/22 subtests failed, 95.45%
&gt; okay.
&gt; NMAKE : fatal error U1077: &#39;C:\perl\bin\perl.exe&#39; : return code &#39;0x1&#39;
&gt; Stop.
</div>

Well, expletive deleted.

This is getting to be a pain. I _think_ the &#34;Too late to execute INIT
block&#34; is not fatal. If it is, I&#39;ll have to retract the test completely,
since it&#39;s a consequence of the way Win32::API is coded.

Are you game for one more try? You are invited to review the
documentation, as well, since I have thrown in a bunch of words on the
consequences of the change.

Thank you very much for your willingness to help me sort this mess out.

Tom Wyant
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;11&nbsp;14:34:19&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 11 Jan 2007 14:33:50 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">SUCCESS!
No errors, no warnings.

BTW: in the fork_fail.pm, if you remove the &#34; -w&#34; from &#34;#!/usr/bin/perl 
-w&#34; then the
      &#34;too late to run INIT block ... &#34;
message goes away.  I kept it in, and it still went away.  Whatever you 
did seems to have fixed everything.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt;willingness to help
</div>I am just gald you are doing it.

--------------------------------------------------------------------paste 
from command line
C:\temp\Win32-Process-Info-1.006_03&gt;nmake test

Microsoft &#40;R&#41; Program Maintenance Utility Version 7.00.9466
Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.

        C:\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; 
&#34;test_harness&#40;0, &#39;blib\lib&#39;, &#39;blib\arch&#39;&#41;&#34; t\basic
.t t\pod.t t\pod_coverage.t
t\basic...........ok
t\pod.............ok
t\pod_coverage....ok
All tests successful.
Files=3, Tests=20, 10 wallclock secs &#40; 0.00 cusr +  0.00 csys =  0.00 CPU&#41;

C:\temp\Win32-Process-Info-1.006_03&gt;nmake install

Microsoft &#40;R&#41; Program Maintenance Utility Version 7.00.9466
Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.

Installing C:\Perl\site\lib\Win32\Process\Info.pm
Skipping C:\Perl\site\lib\Win32\Process\Info\NT.pm &#40;unchanged&#41;
Skipping C:\Perl\site\lib\Win32\Process\Info\WMI.pm &#40;unchanged&#41;
Writing C:\Perl\site\lib\auto\Win32\Process\Info\.packlist
Appending installation info to C:\Perl\site\lib/perllocal.pod

C:\temp\Win32-Process-Info-1.006_03&gt;



cd c:\temp


C:\temp&gt;fork_fail.pl
Parent
Child

C:\temp&gt;type fork_fail.pl
#!/usr/bin/perl -w

#use Win32::API;
#use Win32API::Registry;
#use Win32::OLE;
#use Win32::OLE::Const;
#use Win32::OLE::Variant;

#use Win32::Process::List;
use Win32::Process::Info qw{NT};

if &#40;my $pid = fork&#40;&#41;&#41; {
  print &#34;Parent\n&#34;;
}
elsif&#40;defined $pid&#41; {
  print &#34;Child\n&#34;;
  exit;
} else {
  print &#34;Failed to fork:$!:\n&#34;;
}

C:\temp&gt;

-------------------------------------------------------------------- end 
paste from command line


 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; On Thu Jan 11 09:46:39 2007, m.nooning@comcast.net wrote:
&gt;   
<div class="message-stanza open">&gt;&gt; The tests fail
&gt;&gt;
&gt;&gt; -----------------------------paste first attempt
&gt;&gt; C:\temp\Win32-Process-Info-1.006_02&gt;nmake test
&gt;&gt;
&gt;&gt; Microsoft &#40;R&#41; Program Maintenance Utility Version 7.00.9466
&gt;&gt; Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.
&gt;&gt;
&gt;&gt;         C:\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&gt;&gt; &#34;test_harness&#40;0, &#39;blib\lib&#39;, &#39;blib\arch&#39;&#41;&#34; t\basic
&gt;&gt; .t t\pod.t t\pod_coverage.t
&gt;&gt; t\basic...........ok
&gt;&gt; t\pod.............ok
&gt;&gt; t\pod_coverage....ok 1/3Too late to run INIT block at
&gt;&gt; C:/perl/site/lib/Win32/API/Type.pm line 71.
&gt;&gt;
&gt;&gt; t\pod_coverage....NOK 2#   Failed test &#39;Pod coverage on
&gt;&gt; Win32::Process::Info::NT&#39;
&gt;&gt; #   in C:/perl/site/lib/Test/Pod/Coverage.pm at line 126.
&gt;&gt; # Coverage for Win32::Process::Info::NT is 60.0%, with 2 naked
&gt;&gt; subroutines:
&gt;&gt; #       TokenOwner
&gt;&gt; #       TokenUser
&gt;&gt; # Looks like you failed 1 test of 3.
&gt;&gt; t\pod_coverage....dubious
&gt;&gt;         Test returned status 1 &#40;wstat 256, 0x100&#41;
&gt;&gt; DIED. FAILED test 2
&gt;&gt;         Failed 1/3 tests, 66.67% okay
&gt;&gt; Failed Test      Stat Wstat Total Fail  Failed  List of Failed
&gt;&gt;
&gt;&gt;     
</div>&gt; -------------------------------------------------------------------------------
&gt;   
<div class="message-stanza open">&gt;&gt; t\pod_coverage.t    1   256     3    1  33.33%  2
&gt;&gt; Failed 1/3 test scripts, 66.67% okay. 1/22 subtests failed, 95.45%
&gt;&gt; okay.
&gt;&gt; NMAKE : fatal error U1077: &#39;C:\perl\bin\perl.exe&#39; : return code &#39;0x1&#39;
&gt;&gt; Stop.
&gt;&gt;     
</div>&gt;
&gt;
&gt; Well, expletive deleted.
&gt;
&gt; This is getting to be a pain. I _think_ the &#34;Too late to execute INIT
&gt; block&#34; is not fatal. If it is, I&#39;ll have to retract the test completely,
&gt; since it&#39;s a consequence of the way Win32::API is coded.
&gt;
&gt; Are you game for one more try? You are invited to review the
&gt; documentation, as well, since I have thrown in a bunch of words on the
&gt; consequences of the change.
&gt;
&gt; Thank you very much for your willingness to help me sort this mess out.
&gt;
&gt; Tom Wyant
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;11&nbsp;15:42:14&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 11 14:34:19 2007, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; SUCCESS!
&gt; No errors, no warnings.
&gt; 
&gt; BTW: in the fork_fail.pm, if you remove the &#34; -w&#34; from
&gt; &#34;#!/usr/bin/perl
&gt; -w&#34; then the
&gt;       &#34;too late to run INIT block ... &#34;
&gt; message goes away.  I kept it in, and it still went away.  Whatever
&gt; you
&gt; did seems to have fixed everything.
</div>
WONDERFUL!

I&#39;m sure there&#39;s a way to control this even in the presence of -w, but
it is not obvious to me what the &#39;use warnings&#39; option is that controls
this. There does not seem to be a &#39;no warnings qw{toolate};&#39;.

I have just submitted version 1.007 to CPAN. It is the same as 1.006_03,
except for the version number. It will probably appear on CPAN mirrors
in the next day or so, but it may take another couple weeks for it to
hit the ActiveState PPM repository. I&#39;ll try to keep an eye on it.

At the moment I believe that this is resolved, but I will leave the
ticket open until the code arrives at ActiveState &#40;or until I get tired
of waiting for them -- a couple weeks, anyway&#41;.

Thanks again for your help.

Tom Wyant
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;19&nbsp;10:47:44&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Well, I said I would leave the bug open until the new package made the
ActivePerl PPM repository. It failed to do so sometime overnight. The
only output I have is

Makefile out-of-date with respect to Makefile.PL
Cleaning current config before rebuilding Makefile...
        nmake -f Makefile.old cle
Microsof        D:\cpanrun\build\5-8-0\bin\perl.exe Makefile.PL
Checking if your kit is complete...
Looks good
Writing Makefile for WNMAKE : fatal error U1077: &#39;false&#39; : return code &#39;0x1&#39;
Stop.
=&gt; Please rerun the nmake command.  &lt;==
        false

I find most of this monumentally unhelpful, but the first line sounds to
me like something flaky on ActiveState&#39;s end, since the Makefile was
_not_ in the tarball. So I&#39;m sending it through again. The docs have
been tweaked a bit - or considerably in the case of include&#40;&#41;, where it
looks like my proofreading was far less than adequate.

Tom Wyant
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;19&nbsp;19:11:04&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24286] Win32::Process::Info clashes with windows fork</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 19 Jan 2007 19:10:31 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Process-Info [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">1.008 worked fine for me.

I downloaded Win32-Process-Info-1.008.tar.gz 
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/W/WY/WYANT/Win32-Process-Info-1.008.tar.gz">http://search.cpan.org/CPAN/authors/id/W/WY/WYANT/Win32-Process-Info-1.008.tar.gz</a></span>&gt;  
from
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~wyant/Win32-Process-Info-1.008/lib/Win32/Process/Info.pm">http://search.cpan.org/~wyant/Win32-Process-Info-1.008/lib/Win32/Process/Info.pm</a></span> 

into a fresh directory.

Then I did
     Perl Makefile.PL
     nmake
     nmake test
     nmake install
and then ran fork_fail.pl again.  As before, it works fine on Windows XP 
Home, ActiveState Perl 5.8.8

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt;Makefile out-of-date with respect to Makefile.PL
</div>Try running
     nmake clean
and then rerun &#34;Perl Makefile.PL&#34;, etcetera.

BTW:
 I just went to 
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~wyant/Win32-Process-Info-1.008/lib/Win32/Process/Info.pm">http://search.cpan.org/~wyant/Win32-Process-Info-1.008/lib/Win32/Process/Info.pm</a></span> 
to double check the address where I downloaded it from, and now I get 
&#34;Not Found&#34;.  I guess the web site is still in transition.





 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=24286">http://rt.cpan.org/Ticket/Display.html?id=24286</a></span> &gt;
&gt;
&gt; Well, I said I would leave the bug open until the new package made the
&gt; ActivePerl PPM repository. It failed to do so sometime overnight. The
&gt; only output I have is
&gt;
&gt; Makefile out-of-date with respect to Makefile.PL
&gt; Cleaning current config before rebuilding Makefile...
&gt;       nmake -f Makefile.old cle
&gt; Microsof      D:\cpanrun\build\5-8-0\bin\perl.exe Makefile.PL
&gt; Checking if your kit is complete...
&gt; Looks good
&gt; Writing Makefile for WNMAKE : fatal error U1077: &#39;false&#39; : return code &#39;0x1&#39;
&gt; Stop.
&gt; =&gt; Please rerun the nmake command.  &lt;==
&gt;       false
&gt;
&gt; I find most of this monumentally unhelpful, but the first line sounds to
&gt; me like something flaky on ActiveState&#39;s end, since the Makefile was
&gt; _not_ in the tarball. So I&#39;m sending it through again. The docs have
&gt; been tweaked a bit - or considerably in the case of include&#40;&#41;, where it
&gt; looks like my proofreading was far less than adequate.
&gt;
&gt; Tom Wyant
&gt;
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;28&nbsp;11:14:43&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Well, 1.008 appears to have made it to the ActivePerl repository
successfully, so I&#39;m going to close the ticket. Thanks again for the
report, and for the work done to get this resolved.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;28&nbsp;11:18:46&nbsp;2007</span>
    <span class="description">wyant [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
