<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #54426 for DBD-Informix: NUM_OF_FIELDS &gt; 0 test is broken</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #54426 for DBD-Informix: NUM_OF_FIELDS &gt; 0 test is broken</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBD-Informix/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBD-Informix/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBD-Informix/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBD-Informix/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-Informix">DBD-Informix CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">54426</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBD-Informix/Active/">DBD-Informix</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
chrissalch [...] letu.edu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10124-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10125-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;08&nbsp;19:29:14&nbsp;2010</span>
    <span class="description">chrissalch [...] letu.edu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> NUM_OF_FIELDS &gt; 0 test is broken</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 8 Feb 2010 18:28:09 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-DBD-Informix [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chris Salch &lt;ChrisSalch [...] letu.edu&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have a small DAO module that attempts to use the following test as a
means of determining if a statement handle should be expected to return
results or not &#40;Direct quote from the perldoc&#41;:

You can tell whether the statement is just executable or whether it is a
cursory &#40;fetchable&#41; statement by testing the Informix-specific attribute
ix_Fetchable. The approved, canonical DBI method of doing this check is
&#34;$sth-&gt;{NUM_OF_FIELDS} &gt; 0&#34;.

Unfortunately, this seems to return the a number greater than 0 on the
test system that I have available.  A look at the code shows that there
are different checks for NUM_OF_FIELDS and ix_Fetchable which is
expectecd.  What is not expected is that the suggested test fails.

The attached patch appears to fix this issue by doing the same check as
is used by ix_Fetchable and returning 0 if the statement is not
fetchable or the number of columns if it is.  I&#39;m not sure if there is a
better way to do this or not.


-- 
--------------------------------------------
Chris Salch
Programmer/Analyst
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;09&nbsp;10:52:43&nbsp;2010</span>
    <span class="description">chrissalch [...] letu.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> chrissalch [...] letu.edu</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve tested this on:

Perl Version 5.008008
DBI Version 1.609
DBD::Informix Version 2008.0513
IBM Informix CSDK Version 3.00, IBM Informix-ESQL Version 3.00.FC3DE

and 

Perl Version 5.010000
DBI Version 1.607
DBD::Informix Version 2008.0513
IBM Informix CSDK Version 3.50, IBM Informix-ESQL Version 3.50.FC3DE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;09&nbsp;13:49:35&nbsp;2010</span>
    <span class="description">chrissalch [...] letu.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Guardian of DBD::Informix&#34; &lt;dbd.informix [...] gmail.com&gt;, bug-DBD-Informix &lt;bug-DBD-Informix [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54426] NUM_OF_FIELDS &gt; 0 test is broken</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 9 Feb 2010 12:48:28 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Jonathan Leffler &lt;jonathan.leffler [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chris Salch &lt;ChrisSalch [...] letu.edu&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 2010-02-09 at 11:16 -0600, Jonathan Leffler wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks, Chris, for both the basic bug report along with the patch and
&gt; this extra information.
&gt; 
&gt; I am looking at the test code, and there&#39;s very little that checks on
&gt; NUM_OF_FIELDS.
&gt; 
&gt; Do you recall what statement&#40;s&#41; are returning NUM_OF_FIELDS &gt; 0?  It
&gt; is far from critical; I can probably find out easily enough.  My
&gt; suspicion is INSERT - if there&#39;s anything else, it would be helpful.
&gt; 
&gt; Thanks,
</div>

Well, it turns out this is beautifully esoteric.  I spent the last hour
or so trying to duplicate my results.  It turns out that the INSERT
statement appears to be the only one affected and it appears to *only*
be affected when using parameterized statements.  I build a small test
script to attempt to duplicate my results.  It should be attached.  I&#39;ve
the patch I submitted *appears* to work in the on the systems I&#39;m
working with but has in no way been exhaustively tested.

Run Without Patch:

-&gt; GOOD                                                                 
Check Insert &#40;With Params&#41;2:0                                           
-&gt; FAIL                                                                 
Check Select 3:1                                                        
-&gt; GOOD                                                                 
Check Select &#40;With Params&#41;3:1                                           
-&gt; GOOD                                                                 
Check Update &#40;happens&#41; 0:0                                              
-&gt; GOOD                                                                 
Check Update &#40;nothing to do&#41; 0:0                                        
-&gt; GOOD                                                                 
Check Update &#40;happens, With Params&#41; 0:0                                 
-&gt; GOOD                                                                 
Check Update &#40;nothing to do, With Params&#41; 0:0                           
-&gt; GOOD                                                                 
Check Delete &#40;nothing to do&#41; 0:0                                        
-&gt; GOOD                                                                 
Check Delete &#40;happens&#41; 0:0                                              
-&gt; GOOD                                                                 
Check Delete &#40;nothing to do, With Params&#41; 0:0                           
-&gt; GOOD                                                                 
Check Execute Function 1:1                                              
-&gt; GOOD                                                                 
Check Execute Function &#40;With Params&#41;1:1                                 
-&gt; GOOD                                                                 
Check Execute Procedure 0:0
-&gt; GOOD
Check Execute Procedure &#40;With Params&#41;0:0
-&gt; GOOD


Run with Patch:

Check Insert0:0
-&gt; GOOD
Check Insert &#40;With Params&#41;0:0
-&gt; GOOD
Check Select 3:1
-&gt; GOOD
Check Select &#40;With Params&#41;3:1
-&gt; GOOD
Check Update &#40;happens&#41; 0:0
-&gt; GOOD
Check Update &#40;nothing to do&#41; 0:0
-&gt; GOOD
Check Update &#40;happens, With Params&#41; 0:0
-&gt; GOOD
Check Update &#40;nothing to do, With Params&#41; 0:0
-&gt; GOOD
Check Delete &#40;nothing to do&#41; 0:0
-&gt; GOOD
Check Delete &#40;happens&#41; 0:0
-&gt; GOOD
Check Delete &#40;nothing to do, With Params&#41; 0:0
-&gt; GOOD
Check Execute Function 1:1
-&gt; GOOD
Check Execute Function &#40;With Params&#41;1:1
-&gt; GOOD
Check Execute Procedure 0:0
-&gt; GOOD
Check Execute Procedure &#40;With Params&#41;0:0
-&gt; GOOD


Thank you for your quick response.  I was a little worried that this
driver wasn&#39;t being maintained.


-- 
--------------------------------------------
Chris Salch
Programmer/Analyst
LeTourneau University
903-233-3537
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;09&nbsp;14:14:37&nbsp;2010</span>
    <span class="description">jonathan.leffler [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Guardian of DBD::Informix&#34; &lt;dbd.informix [...] gmail.com&gt;, bug-DBD-Informix &lt;bug-DBD-Informix [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54426] NUM_OF_FIELDS &gt; 0 test is broken</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 9 Feb 2010 11:13:22 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Chris Salch &lt;ChrisSalch [...] letu.edu&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jonathan Leffler &lt;jonathan.leffler [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Feb 9, 2010 at 10:48 AM, Chris Salch &lt;ChrisSalch@letu.edu&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Well, it turns out this is beautifully esoteric.  I spent the last hour
&gt; or so trying to duplicate my results.  It turns out that the INSERT
&gt; statement appears to be the only one affected and it appears to *only*
&gt; be affected when using parameterized statements.  I build a small test
&gt; script to attempt to duplicate my results.  It should be attached.  I&#39;ve
&gt; the patch I submitted *appears* to work in the on the systems I&#39;m
&gt; working with but has in no way been exhaustively tested.
&gt;
</div>
I&#39;ll get to look at this soon - thanks.  And INSERT is something of a
special case in the way it behaves with Informix.  Things have moved on to
the point where supported servers &#40;as in, versions of IDS supported by
IBM/Informix&#41; probably all have the stuff I need to improve this code.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thank you for your quick response.  I was a little worried that this
&gt; driver wasn&#39;t being maintained.
&gt;
</div>
Not actually unmaintained - just not needing much maintenance.

I was expecting to have to make a release to allow for a new version of CSDK
later this year; they&#39;ve changed their minds about the versioning and the
next version is already handled by the code &#40;unless they do something else
with the format of the messaging - which is always possible&#41;.

There are a few issues that should ideally be dealt with - but they are all
pretty minor, hence the absence of a bug fix since May 2008.

I will make a release - 2010.0xyy - just to  show that there is still life
around.  I just haven&#39;t formally decided on a month x, let alone a date
within the month yy.

-- 
Jonathan Leffler &lt;jonathan.leffler@gmail.com&gt;  #include &lt;disclaimer.h&gt;
Guardian of DBD::Informix - v2008.0513 - <span class="clickylink"><a target="new" rel="nofollow" href="http://dbi.perl.org">http://dbi.perl.org</a></span>
&#34;Blessed are we who can laugh at ourselves, for we shall never cease to be
amused.&#34;
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;09&nbsp;14:14:39&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
