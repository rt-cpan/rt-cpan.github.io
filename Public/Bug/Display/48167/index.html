<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #48167 for OpenOffice-OODoc: Colums missing if fetched with getCellValue</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #48167 for OpenOffice-OODoc: Colums missing if fetched with getCellValue</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/OpenOffice-OODoc">OpenOffice-OODoc CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">48167</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/OpenOffice-OODoc/Active/">OpenOffice-OODoc</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
info [...] gwendragon.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-24242-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24243-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




oo.ods<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/637859/325278/oo.ods">
Fri Jul 24 14:17:04 2009 (10.3k) by info [...] gwendragon.de
</a>
</font></li>
</ul>


OO.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/637859/325281/OO.pl">
Fri Jul 24 14:17:04 2009 (1.6k) by info [...] gwendragon.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;13:49:55&nbsp;2009</span>
    <span class="description">info [...] gwendragon.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Colums missing if fetched with getCellValue</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">OpenOffice::OOdoc does ignore &#40;adjacent&#41; colums if the contents are the 
same.


Testcase:
=========

1. Put script OO.pl and OpenOffice Calc file oo.ods into one folder
2. Start Linux konsole or DOS Shell
3. Goto folder
4. Start script OO.pl
5. Recognize that the first column is missing in output!


Scripts output is:

Open &#39;./OO.ods&#39; ...
Name of Sheet: Tabelle1
Auto;1;;;;;;;;;;;;;;
Auto;2;;;;;;;;;;;;;;
Auto;3;;;;;;;;;;;;;;
Auto;4;;;;;;;;;;;;;;
Auto;5;;;;;;;;;;;;;;
Auto;6;;;;;;;;;;;;;;
Auto;7;;;;;;;;;;;;;;
Auto;8;;;;;;;;;;;;;;
Auto;9;;;;;;;;;;;;;;
Auto;10;;;;;;;;;;;;;;
Auto;11;;;;;;;;;;;;;;
Auto;12;;;;;;;;;;;;;;
Auto;13;;;;;;;;;;;;;;
Auto;14;;;;;;;;;;;;;;
Auto;15;;;;;;;;;;;;;;

This is incorrect!

It should be:

Open &#39;./OO.ods&#39; ...
Name of Sheet: Tabelle1
Auto;Auto;1;;;;;;;;;;;;;;
Auto;Auto;2;;;;;;;;;;;;;;
Auto;Auto;3;;;;;;;;;;;;;;
Auto;Auto;4;;;;;;;;;;;;;;
Auto;Auto;5;;;;;;;;;;;;;;
Auto;Auto;6;;;;;;;;;;;;;;
Auto;Auto;7;;;;;;;;;;;;;;
Auto;Auto;8;;;;;;;;;;;;;;
Auto;Auto;9;;;;;;;;;;;;;;
Auto;Auto;10;;;;;;;;;;;;;;
Auto;Auto;11;;;;;;;;;;;;;;
Auto;Auto;12;;;;;;;;;;;;;;
Auto;Auto;13;;;;;;;;;;;;;;
Auto;Auto;14;;;;;;;;;;;;;;
Auto;Auto;15;;;;;;;;;;;;;;



===

After analyzing the OpenOffice &#40;OO&#41; file, it seems OO does concatenate 
two cells with same content into one.

This excerpt of the extracted XML code of the file does show it:

&lt;table:table-row table:style-name=&#34;ro1&#34;&gt;
&lt;table:table-cell table:number-columns-repeated=&#34;2&#34; office:value-
type=&#34;string&#34;&gt;&lt;text:p&gt;Auto&lt;/text:p&gt;&lt;/table:table-cell&gt;
&lt;table:table-cell office:value-type=&#34;float&#34; office:value=&#34;1&#34;&gt;&lt;text:p&gt;1&lt;/
text:p&gt;&lt;/table:table-cell&gt;
&lt;/table:table-row&gt;

Just look at  table:number-columns-repeated=&#34;2&#34;

====

This sems to be a bug in a module in OpenOffice::OODoc. Or a feature is 
missing in OpenOffice::OODoc to read such cells.

Can you fix this?

--
Kind regards from
Lilo von Hanffstengel aka GwenDragon
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;14:10:28&nbsp;2009</span>
    <span class="description">info [...] gwendragon.de -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;14:12:47&nbsp;2009</span>
    <span class="description">info [...] gwendragon.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oh, sorry.
It is not a bug.

After finding this request <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html">https://rt.cpan.org/Public/Bug/Display.html</a></span>?
id=21695 and adding normalizeSheet&#40;$tbl, &#39;full&#39;&#41; the script works fine 
now.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;14:12:47&nbsp;2009</span>
    <span class="description">info [...] gwendragon.de -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;14:17:04&nbsp;2009</span>
    <span class="description">info [...] gwendragon.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fr. 24. Jul. 2009, 13:49:55, info@gwendragon.de wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Testcase:
&gt; =========
&gt; 
&gt; 1. Put script OO.pl and OpenOffice Calc file oo.ods into one folder
</div>
I uploaded two files here in Bugtracker but they disappeared. Now 
appended them once more.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/637859/325278/oo.ods">Download oo.ods</a><br />
<span class="downloadcontenttype">application/vnd.oasis.opendocument.spreadsheet 10.3k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl

$| = 1;

use strict;
use warnings;

use OpenOffice::OODoc;

Read_ods_file&#40;&#39;./OO.ods&#39;&#41;;

sub Read_ods_file {
     my&#40;$file&#41; = @_;
     print &#34;Open &#39;$file&#39; ...\n&#34;;
     my $doc = odfDocument&#40;file =&gt; $file&#41;;

     for &#40;my $i=0; $i&lt;$doc-&gt;getTableList&#40;&#41;;$i++&#41; {
          my $tbl = $doc-&gt;getTable&#40;$i&#41;;          
          print &#34;Name of Sheet: &#34;.$doc-&gt;tableName&#40;$tbl&#41;.&#34;\n&#34;;
          for &#40;my $row=0; $row&lt;15; $row++&#41; {
               my $found = 0; 
               for &#40;my $col=0; $col&lt;15; $col++&#41; {
                    my $v = $doc-&gt;getCellValue&#40;$tbl, $row, $col&#41;;
                    $v = &#39;&#39; if !defined&#40;$v&#41;;
                    print &#34;$v;&#34;;
                    $found++;
                } # for
                print &#34;\n&#34; if $found;
          } # for
     } # for
} # 

=pod

Output should be:

Open &#39;./OO.ods&#39; ...
Name of Sheet: Tabelle1
Auto;Auto;1;;;;;;;;;;;;;;
Auto;Auto;2;;;;;;;;;;;;;;
Auto;Auto;3;;;;;;;;;;;;;;
Auto;Auto;4;;;;;;;;;;;;;;
Auto;Auto;5;;;;;;;;;;;;;;
Auto;Auto;6;;;;;;;;;;;;;;
Auto;Auto;7;;;;;;;;;;;;;;
Auto;Auto;8;;;;;;;;;;;;;;
Auto;Auto;9;;;;;;;;;;;;;;
Auto;Auto;10;;;;;;;;;;;;;;
Auto;Auto;11;;;;;;;;;;;;;;
Auto;Auto;12;;;;;;;;;;;;;;
Auto;Auto;13;;;;;;;;;;;;;;
Auto;Auto;14;;;;;;;;;;;;;;
Auto;Auto;15;;;;;;;;;;;;;;

But scripts output is:

Open &#39;./OO.ods&#39; ...
Name of Sheet: Tabelle1
Auto;1;;;;;;;;;;;;;;
Auto;2;;;;;;;;;;;;;;
Auto;3;;;;;;;;;;;;;;
Auto;4;;;;;;;;;;;;;;
Auto;5;;;;;;;;;;;;;;
Auto;6;;;;;;;;;;;;;;
Auto;7;;;;;;;;;;;;;;
Auto;8;;;;;;;;;;;;;;
Auto;9;;;;;;;;;;;;;;
Auto;10;;;;;;;;;;;;;;
Auto;11;;;;;;;;;;;;;;
Auto;12;;;;;;;;;;;;;;
Auto;13;;;;;;;;;;;;;;
Auto;14;;;;;;;;;;;;;;
Auto;15;;;;;;;;;;;;;;

This is wrong!
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;14:17:06&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;18:32:57&nbsp;2009</span>
    <span class="description">jmgdoc [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Ven. Jul. 24 14:17:04 2009, info@gwendragon.de a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fr. 24. Jul. 2009, 13:49:55, info@gwendragon.de wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; Testcase:
&gt; &gt; =========
&gt; &gt; 
&gt; &gt; 1. Put script OO.pl and OpenOffice Calc file oo.ods into one folder
</div>&gt; 
&gt; I uploaded two files here in Bugtracker but they disappeared. Now 
&gt; appended them once more.
</div>
OK, the files are present...
But the issue is resolved !
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;18:32:58&nbsp;2009</span>
    <span class="description">jmgdoc [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;18:36:06&nbsp;2009</span>
    <span class="description">jmgdoc [...] cpan.org -  Broken in 2.108 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
