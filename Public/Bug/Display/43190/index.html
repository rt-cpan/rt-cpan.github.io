<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #43190 for Net-DNS: Net::DNS::RR.pm breaks quoted strings with semicolon +FIX</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #43190 for Net-DNS: Net::DNS::RR.pm breaks quoted strings with semicolon +FIX</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-DNS/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">43190</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-DNS/Active/">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rad [...] twig.com

<br />
torsten [...] archesoft.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;17:48:38&nbsp;2009</span>
    <span class="description">torsten [...] archesoft.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Creating a TXT record for DKIM / Escaping the ;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,
my Perl: see perlversion.txt
Net::DNS 0.65
bind 9.5.0-P2

I am trying to create a TXT record for use with the domainkey system.
An example of the data part would be
&#34;v=DKIM1\; k=rsa\; t=y\;
p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#34;

If i send the update &#40;see and use the dnsupdate.pl [contains real data]&#41;,
the data part is escaped twice again.
i.e.
&#34;v=DKIM1\\\; k=rsa\\\; t=y\\\;
p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#34;

If i put the TXT record manually into a zone file, the server returns
the expected result, so i assume, the escaping is a &#34;bug&#34; in Net::DNS

Probably it&#39;s only an error on my side, if so, apologize and please tell
me, what i did wrong.

Thanks Torsten
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dnsupdate.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl
use Net::DNS;
use Digest::MD5&#40;&#34;md5_hex&#34;&#41;;

$t = &#39;v=DKIM1\; k=rsa\; t=y\; p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#39;;
$rt = &#34;porgy._domainkey.test3.com. IN TXT &#39;$t&#39;&#34;;
upd&#40;$rt&#41;;
exit;

sub upd {
my $ru = shift;
my $update = Net::DNS::Update-&gt;new&#40;&#34;test3.com&#34;&#41;;
$update-&gt;push&#40;&#34;update&#34;, rr_del&#40;&#34;porgy._domainkey.test3.com. IN TXT&#34;&#41;&#41;;
$update-&gt;push&#40;&#34;update&#34;, rr_add&#40;$ru&#41;&#41;;
$update-&gt;sign_tsig&#40;&#34;test3.com&#34;, &#34;Yl1CRVlIQiZVLUldT08wSEEidm0jcFJ8aCJIWz0oZXI=&#34;&#41;;
my $res = Net::DNS::Resolver-&gt;new;
$res-&gt;nameservers&#40;&#39;ns0.xtremeweb.de&#39;&#41;;
my $reply = $res-&gt;send&#40;$update&#41;;
print &#34;\n------------------------- update:\n$ru\n&#34;;
# Did it work?
if &#40;$reply&#41; {
    if &#40;$reply-&gt;header-&gt;rcode eq &#39;NOERROR&#39;&#41; {
	print &#34;Update succeeded\nNow make a &#39;host -a porgy._domainkey.test3.com. ns0.xtremeweb.de&#39;\n&#34;;
    } else {
	print &#39;Update failed: &#39;, $reply-&gt;header-&gt;rcode, &#34;\n&#34;;
    }
} else {
    print &#39;Update failed: &#39;, $res-&gt;errorstring, &#34;\n&#34;;
}

}

</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> perlversion.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Summary of my perl5 &#40;revision 5 version 10 subversion 0&#41; configuration:
  Platform:
    osname=linux, osvers=2.6.25, archname=i586-linux-thread-multi
    uname=&#39;linux bach 2.6.25 #1 smp preempt rt 2008-06-04 00:52:17 +0200 i686 i686 i386 gnulinux &#39;
    config_args=&#39;-ds -e -Dprefix=/usr -Dvendorprefix=/usr -Dinstallusrbinperl -Dusethreads -Di_db -Di_dbm -Di_ndbm -Di_gdbm -Duseshrplib=true -Doptimize=-O2 -march=i586 -mtune=i686 -fmessage-length=0 -Wall -D_FORTIFY_SOURCE=2 -fstack-protector -g -Wall -pipe -Accflags=-DPERL_USE_SAFE_PUTENV&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=define, usemultiplicity=define
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=undef, use64bitall=undef, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -DPERL_USE_SAFE_PUTENV -DDEBUGGING -fno-strict-aliasing -pipe -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-O2 -march=i586 -mtune=i686 -fmessage-length=0 -Wall -D_FORTIFY_SOURCE=2 -fstack-protector -g -Wall -pipe&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -DPERL_USE_SAFE_PUTENV -DDEBUGGING -fno-strict-aliasing -pipe&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.3.1 20080507 &#40;prerelease&#41; [gcc-4_3-branch revision 135036]&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=4, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39;&#39;
    libpth=/lib /usr/lib /usr/local/lib
    libs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
    perllibs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
    libc=/lib/libc-2.8.so, so=so, useshrplib=true, libperl=libperl.so
    gnulibc_version=&#39;2.8&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E -Wl,-rpath,/usr/lib/perl5/5.10.0/i586-linux-thread-multi/CORE&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -O2 -march=i586 -mtune=i686 -fmessage-length=0 -Wall -D_FORTIFY_SOURCE=2 -fstack-protector -g -Wall -pipe&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: DEBUGGING MULTIPLICITY PERL_DONT_CREATE_GVSV
                        PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP
                        PERL_TRACK_MEMPOOL PERL_USE_SAFE_PUTENV USE_ITHREADS
                        USE_LARGE_FILES USE_PERLIO USE_REENTRANT_API
  Built under linux
  Compiled at Jun  6 2008 18:39:56
  @INC:
    /usr/lib/perl5/5.10.0/i586-linux-thread-multi
    /usr/lib/perl5/5.10.0
    /usr/lib/perl5/site_perl/5.10.0/i586-linux-thread-multi
    /usr/lib/perl5/site_perl/5.10.0
    /usr/lib/perl5/vendor_perl/5.10.0/i586-linux-thread-multi
    /usr/lib/perl5/vendor_perl/5.10.0
    /usr/lib/perl5/vendor_perl
    .
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;17:57:09&nbsp;2009</span>
    <span class="description">olaf [...] dacht.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43190] Creating a TXT record for DKIM / Escaping the ; </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 10 Feb 2009 23:56:48 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Olaf Kolkman &lt;olaf [...] dacht.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Within the enclosing quotes of the character string I don&#39;t think the  
backslash escapes are needed.

Could you try without those backslashes?

I would have to go back to the RFCs to double check the specs, and or  
test interoperability with other parsers. Will do that later.


--Olaf


On 10 feb 2009, at 23:48, torsten@archesoft.de via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue Feb 10 17:48:38 2009: Request 43190 was acted upon.
&gt; Transaction: Ticket created by torsten@archesoft.de
&gt;       Queue: Net-DNS
&gt;     Subject: Creating a TXT record for DKIM / Escaping the ;
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: Normal
&gt;       Owner: Nobody
&gt;  Requestors: torsten@archesoft.de
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43190">https://rt.cpan.org/Ticket/Display.html?id=43190</a></span> &gt;
&gt;
&gt;
&gt; Hello,
&gt; my Perl: see perlversion.txt
&gt; Net::DNS 0.65
&gt; bind 9.5.0-P2
&gt;
&gt; I am trying to create a TXT record for use with the domainkey system.
&gt; An example of the data part would be
&gt; &#34;v=DKIM1\; k=rsa\; t=y\;
&gt; p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#34;
&gt;
&gt; If i send the update &#40;see and use the dnsupdate.pl [contains real  
&gt; data]&#41;,
&gt; the data part is escaped twice again.
&gt; i.e.
&gt; &#34;v=DKIM1\\\; k=rsa\\\; t=y\\\;
&gt; p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#34;
&gt;
&gt; If i put the TXT record manually into a zone file, the server returns
&gt; the expected result, so i assume, the escaping is a &#34;bug&#34; in Net::DNS
&gt;
&gt; Probably it&#39;s only an error on my side, if so, apologize and please  
&gt; tell
&gt; me, what i did wrong.
&gt;
&gt; Thanks Torsten
&gt;
&gt; &lt;dnsupdate.pl&gt;Summary of my perl5 &#40;revision 5 version 10 subversion  
&gt; 0&#41; configuration:
&gt;  Platform:
&gt;    osname=linux, osvers=2.6.25, archname=i586-linux-thread-multi
&gt;    uname=&#39;linux bach 2.6.25 #1 smp preempt rt 2008-06-04 00:52:17  
&gt; +0200 i686 i686 i386 gnulinux &#39;
&gt;    config_args=&#39;-ds -e -Dprefix=/usr -Dvendorprefix=/usr - 
&gt; Dinstallusrbinperl -Dusethreads -Di_db -Di_dbm -Di_ndbm -Di_gdbm - 
&gt; Duseshrplib=true -Doptimize=-O2 -march=i586 -mtune=i686 -fmessage- 
&gt; length=0 -Wall -D_FORTIFY_SOURCE=2 -fstack-protector -g -Wall -pipe - 
&gt; Accflags=-DPERL_USE_SAFE_PUTENV&#39;
&gt;    hint=recommended, useposix=true, d_sigaction=define
&gt;    useithreads=define, usemultiplicity=define
&gt;    useperlio=define, d_sfio=undef, uselargefiles=define,  
&gt; usesocks=undef
&gt;    use64bitint=undef, use64bitall=undef, uselongdouble=undef
&gt;    usemymalloc=n, bincompat5005=undef
&gt;  Compiler:
&gt;    cc=&#39;cc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE - 
&gt; DPERL_USE_SAFE_PUTENV -DDEBUGGING -fno-strict-aliasing -pipe - 
&gt; D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
&gt;    optimize=&#39;-O2 -march=i586 -mtune=i686 -fmessage-length=0 -Wall - 
&gt; D_FORTIFY_SOURCE=2 -fstack-protector -g -Wall -pipe&#39;,
&gt;    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -DPERL_USE_SAFE_PUTENV - 
&gt; DDEBUGGING -fno-strict-aliasing -pipe&#39;
&gt;    ccversion=&#39;&#39;, gccversion=&#39;4.3.1 20080507 &#40;prerelease&#41; [gcc-4_3- 
&gt; branch revision 135036]&#39;, gccosandvers=&#39;&#39;
&gt;    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
&gt;    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
&gt;    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8,  
&gt; Off_t=&#39;off_t&#39;, lseeksize=8
&gt;    alignbytes=4, prototype=define
&gt;  Linker and Libraries:
&gt;    ld=&#39;cc&#39;, ldflags =&#39;&#39;
&gt;    libpth=/lib /usr/lib /usr/local/lib
&gt;    libs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
&gt;    perllibs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
&gt;    libc=/lib/libc-2.8.so, so=so, useshrplib=true, libperl=libperl.so
&gt;    gnulibc_version=&#39;2.8&#39;
&gt;  Dynamic Linking:
&gt;    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E - 
&gt; Wl,-rpath,/usr/lib/perl5/5.10.0/i586-linux-thread-multi/CORE&#39;
&gt;    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -O2 -march=i586 - 
&gt; mtune=i686 -fmessage-length=0 -Wall -D_FORTIFY_SOURCE=2 -fstack- 
&gt; protector -g -Wall -pipe&#39;
&gt;
&gt;
&gt; Characteristics of this binary &#40;from libperl&#41;:
&gt;  Compile-time options: DEBUGGING MULTIPLICITY PERL_DONT_CREATE_GVSV
&gt;                        PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP
&gt;                        PERL_TRACK_MEMPOOL PERL_USE_SAFE_PUTENV  
&gt; USE_ITHREADS
&gt;                        USE_LARGE_FILES USE_PERLIO USE_REENTRANT_API
&gt;  Built under linux
&gt;  Compiled at Jun  6 2008 18:39:56
&gt;  @INC:
&gt;    /usr/lib/perl5/5.10.0/i586-linux-thread-multi
&gt;    /usr/lib/perl5/5.10.0
&gt;    /usr/lib/perl5/site_perl/5.10.0/i586-linux-thread-multi
&gt;    /usr/lib/perl5/site_perl/5.10.0
&gt;    /usr/lib/perl5/vendor_perl/5.10.0/i586-linux-thread-multi
&gt;    /usr/lib/perl5/vendor_perl/5.10.0
&gt;    /usr/lib/perl5/vendor_perl
&gt;    .
</div></div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;17:57:10&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;18:31:36&nbsp;2009</span>
    <span class="description">torsten [...] archesoft.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Olaf,

thanks for your response.

On Di. 10. Feb. 2009, 17:57:09, olaf@dacht.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Within the enclosing quotes of the character string I don&#39;t think the  
&gt; backslash escapes are needed.
&gt; 
&gt; Could you try without those backslashes?
</div>
I already tried with 
$t = &#39;v=DKIM1; k=rsa; t=y;
p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#39;;
instead of 
$t = &#39;v=DKIM1\; k=rsa\; t=y\;
p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#39;;

but this gave &#34;Update failed: FORMERR&#34;

If you like, i can try to look with &#34;Data::Dumper&#34; what Net::DNS tries
to send in case of the &#34;FORMERR&#34;

Greetings Torsten
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;19:33:14&nbsp;2009</span>
    <span class="description">torsten [...] archesoft.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43190] Creating a TXT record for DKIM / Escaping the ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Feb 2009 01:32:47 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Torsten Mueller &lt;torsten [...] archesoft.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Olaf M. Kolkman via RT schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=43190">http://rt.cpan.org/Ticket/Display.html?id=43190</a></span> &gt;
&gt; 
&gt; 
&gt; Within the enclosing quotes of the character string I don&#39;t think the  
&gt; backslash escapes are needed.
&gt; 
&gt; Could you try without those backslashes?
</div>
I already tried with
$t = &#39;v=DKIM1; k=rsa; t=y;
p=DEFfMA074X/SR+BW8yd4RaXMk+pSDwnr/SjT/b+HTNoZmxfkrYqk5eN5jnUewIDAQAB&#39;;

but this gave &#34;Update failed: FORMERR&#34;

I uploaded the miniscript dnsupdate.pl.
If you like you can use it against my live nameserver to see what
i mean / to test.

Greetings Torsten
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;24&nbsp;18:27:09&nbsp;2009</span>
    <span class="description">rad [...] twig.com - Ticket #45407:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net::DNS::RR.pm breaks quoted strings with semicolon +FIX</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 24 Apr 2009 22:26:31 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-net-dns [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rad [...] twig.com &#40;Richard Doty&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The new_from_string function in RR.pm strips comments:

     19 $VERSION = &#40;qw$LastChangedRevision: 705 $&#41;[1];

    317         # strip out comments
    318         # Test for non escaped &#34;;&#34; by means of the look-behind assertion
    319         # &#40;the backslash is escaped&#41;
    320         $rrstring   =~ s/&#40;?&lt;!\\&#41;;.*//og;

This breaks quoted strings that contain semicolons.  The enclosed patch
adds a test for an enclosing quote.  I think this will fix bug 43190 as well.

Richard


*** RR.pm       Fri Apr 24 21:46:51 2009
--- RR.pm.new   Fri Apr 24 22:14:32 2009
***************
*** 317,323 ****
        # strip out comments
        # Test for non escaped &#34;;&#34; by means of the look-behind assertion
        # &#40;the backslash is escaped&#41;
!       $rrstring   =~ s/&#40;?&lt;!\\&#41;;.*//og;
        
        &#40;$rrstring =~ m/$RR_REGEX/xso&#41; || 
                confess qq|qInternal Error: &#34;$rrstring&#34; did not match RR pat.\nPlease report this to the author!\n|;
--- 317,323 ----
        # strip out comments
        # Test for non escaped &#34;;&#34; by means of the look-behind assertion
        # &#40;the backslash is escaped&#41;
!       $rrstring   =~ s/&#40;?&lt;!\\&#41;;[^&#34;]*$//og;
        
        &#40;$rrstring =~ m/$RR_REGEX/xso&#41; || 
                confess qq|qInternal Error: &#34;$rrstring&#34; did not match RR pat.\nPlease report this to the author!\n|;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:02:42&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org - Ticket #45407:  Merged into ticket #43190</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:02:42&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Merged into ticket #43190</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:02:42&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Subject changed from &#39;Creating a TXT record for DKIM / Escaping the ;&#39; to &#39;Net::DNS::RR.pm breaks quoted strings with semicolon +FIX&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:05:52&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The comment parsing logic has improved. Fully functional on the trunk as of 812

Note that for consistency the rdatastr method &#40;TXT and SPF&#41; will return escaped strings. 

char_str_list will continue to return unescaped values. as is reflected in the test cases below
t/05-rr-txt.t

my $TXTrr=Net::DNS::RR-&gt;new&#40;&#39;txt2.t.net-dns.org.        60      IN
        TXT  &#34;Test1 \&#34; \; more stuff&#34;  &#34;Test2&#34;&#39;&#41;;

is &#40; &#40;$TXTrr-&gt;char_str_list&#40;&#41;&#41;[0], &#39;Test1 &#34; ; more stuff&#39;, &#34;char_str_list[0] returns unescaped ;&#34;&#41;;
is &#40; $TXTrr-&gt;rdatastr,&#39;&#34;Test1 \&#34; \; more stuff&#34; &#34;Test2&#34;&#39;, &#34;string method returns escaped ;&#34;&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:05:55&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The comment parsing logic has improved. Fully functional on the trunk as of 812

Note that for consistency the rdatastr method &#40;TXT and SPF&#41; will return escaped strings. 

char_str_list will continue to return unescaped values. as is reflected in the test cases below
t/05-rr-txt.t

my $TXTrr=Net::DNS::RR-&gt;new&#40;&#39;txt2.t.net-dns.org.        60      IN
        TXT  &#34;Test1 \&#34; \; more stuff&#34;  &#34;Test2&#34;&#39;&#41;;

is &#40; &#40;$TXTrr-&gt;char_str_list&#40;&#41;&#41;[0], &#39;Test1 &#34; ; more stuff&#39;, &#34;char_str_list[0] returns unescaped ;&#34;&#41;;
is &#40; $TXTrr-&gt;rdatastr,&#39;&#34;Test1 \&#34; \; more stuff&#34; &#34;Test2&#34;&#39;, &#34;string method returns escaped ;&#34;&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;11:22:17&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
