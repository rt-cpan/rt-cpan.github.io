<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #131615 for CPAN: t/31sessions.t fails  with YAML-1.30</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #131615 for CPAN: t/31sessions.t fails  with YAML-1.30</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CPAN/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CPAN/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CPAN/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CPAN/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CPAN">CPAN CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">131615</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CPAN/Active/">CPAN</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ppisar [...] redhat.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
gregoa [...] cpan.org

<br />
TINITA [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8164-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.27    </td>
  </tr>
  <tr id="CF-8165-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;07:11:07&nbsp;2020</span>
    <span class="description">ppisar [...] redhat.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> t/31sessions.t fails  with YAML-1.30</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">After upgrading YAML 1.29 to 1.30, t/31sessions.t test fails like this:

ok 50 - opening new session &#39;the historically second&#39;
# error while running &#39;&#34;/usr/bin/perl&#34; &#34;-I/home/test/fedora/perl-CPAN/CPAN-2.27/t&#34; &#34;-Mblib&#34; &#34;-MCPAN::MyConfig_46610&#34; &#34;-Mlocal_utils&#34; &#34;-MCPAN&#34; &#34;-e&#34; &#34;local_utils::dup_pid_inc&#40;46610&#41;;&#34; &#34;-e&#34; &#34;@CPAN::Defaultsites = &#40;&#41;; shell&#34; &gt; test-46610.out&#39; on &#39;the historically second&#39;:
not ok 51 - cmd[get CPAN::Test::Dummy::Perl5::Make]
#   Failed test &#39;cmd[get CPAN::Test::Dummy::Perl5::Make]&#39;
#   at t/31sessions.t line 562.
#                   &#39;CPAN: LWP::UserAgent loaded ok &#40;v6.43&#41;
# CPAN: URI::URL loaded ok &#40;v5.04&#41;
# CPAN: YAML loaded ok &#40;v1.30&#41;
# Reading &#39;/home/test/fedora/perl-CPAN/CPAN-2.27/t/CPAN/authors/01mailrc.txt&#39;
# Reading 11 yaml files from /home/test/fedora/perl-CPAN/CPAN-2.27/t/dot-cpan-46610/build/
# &#39;
#     doesn&#39;t match &#39;/Has already been unwrapped/&#39;
##9&#40;the historically second&#41;/0:{q[&#39;get CPAN::Test::Dummy::Perl5::Make&#39;]=&gt;q[&#39;CPAN: LWP::UserAgent loaded ok &#40;v6.43&#41;
CPAN: URI::URL loaded ok &#40;v5.04&#41;
CPAN: YAML loaded ok &#40;v1.30&#41;
Reading \&#39;/home/test/fedora/perl-CPAN/CPAN-2.27/t/CPAN/authors/01mailrc.txt\&#39;
Reading 11 yaml files from /home/test/fedora/perl-CPAN/CPAN-2.27/t/dot-cpan-46610/build/
&#39;]}
not ok 52 - cmd[make CPAN/Test/Dummy/Perl5/Make.pm]
#   Failed test &#39;cmd[make CPAN/Test/Dummy/Perl5/Make.pm]&#39;
#   at t/31sessions.t line 562.
#                   &#39;Reading &#39;/home/test/fedora/perl-CPAN/CPAN-2.27/t/CPAN/authors/01mailrc.txt&#39;
# ............................................................................DONE
[...]
Test Summary Report
-------------------
t/31sessions.t              &#40;Wstat: 7168 Tests: 92 Failed: 28&#41;
  Failed tests:  51-61, 63-66, 68, 71, 74, 77-82, 84, 89-91
  Non-zero exit status: 28

This is probably triggered by this &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/ingydotnet/yaml-pm/commit/7736f38bd02e4f9f77d5468721e3be3d7b34a8ec">https://github.com/ingydotnet/yaml-pm/commit/7736f38bd02e4f9f77d5468721e3be3d7b34a8ec</a></span>&gt; YAML change.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;07:40:08&nbsp;2020</span>
    <span class="description">TINITA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 30 13:11:07 2020, ppisar wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; After upgrading YAML 1.29 to 1.30, t/31sessions.t test fails like
&gt; this:
</div>
I tried to fix it by adding `$YAML::LoadBlessed = 1` but so far failed to find the right position in the test to do that...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;07:40:08&nbsp;2020</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;11:10:10&nbsp;2020</span>
    <span class="description">jkeenan [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 30 07:11:07 2020, ppisar wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; After upgrading YAML 1.29 to 1.30, t/31sessions.t test fails like
&gt; this:
&gt; 
&gt; ok 50 - opening new session &#39;the historically second&#39;
&gt; # error while running &#39;&#34;/usr/bin/perl&#34; &#34;-I/home/test/fedora/perl-
&gt; CPAN/CPAN-2.27/t&#34; &#34;-Mblib&#34; &#34;-MCPAN::MyConfig_46610&#34; &#34;-Mlocal_utils&#34; &#34;-
&gt; MCPAN&#34; &#34;-e&#34; &#34;local_utils::dup_pid_inc&#40;46610&#41;;&#34; &#34;-e&#34;
&gt; &#34;@CPAN::Defaultsites = &#40;&#41;; shell&#34; &gt; test-46610.out&#39; on &#39;the
&gt; historically second&#39;:
&gt; not ok 51 - cmd[get CPAN::Test::Dummy::Perl5::Make]
&gt; #   Failed test &#39;cmd[get CPAN::Test::Dummy::Perl5::Make]&#39;
&gt; #   at t/31sessions.t line 562.
&gt; #                   &#39;CPAN: LWP::UserAgent loaded ok &#40;v6.43&#41;
&gt; # CPAN: URI::URL loaded ok &#40;v5.04&#41;
&gt; # CPAN: YAML loaded ok &#40;v1.30&#41;
&gt; # Reading &#39;/home/test/fedora/perl-CPAN/CPAN-
&gt; 2.27/t/CPAN/authors/01mailrc.txt&#39;
&gt; # Reading 11 yaml files from /home/test/fedora/perl-CPAN/CPAN-
&gt; 2.27/t/dot-cpan-46610/build/
&gt; # &#39;
&gt; #     doesn&#39;t match &#39;/Has already been unwrapped/&#39;
&gt; ##9&#40;the historically second&#41;/0:{q[&#39;get
&gt; CPAN::Test::Dummy::Perl5::Make&#39;]=&gt;q[&#39;CPAN: LWP::UserAgent loaded ok
&gt; &#40;v6.43&#41;
&gt; CPAN: URI::URL loaded ok &#40;v5.04&#41;
&gt; CPAN: YAML loaded ok &#40;v1.30&#41;
&gt; Reading \&#39;/home/test/fedora/perl-CPAN/CPAN-
&gt; 2.27/t/CPAN/authors/01mailrc.txt\&#39;
&gt; Reading 11 yaml files from /home/test/fedora/perl-CPAN/CPAN-
&gt; 2.27/t/dot-cpan-46610/build/
&gt; &#39;]}
&gt; not ok 52 - cmd[make CPAN/Test/Dummy/Perl5/Make.pm]
&gt; #   Failed test &#39;cmd[make CPAN/Test/Dummy/Perl5/Make.pm]&#39;
&gt; #   at t/31sessions.t line 562.
&gt; #                   &#39;Reading &#39;/home/test/fedora/perl-CPAN/CPAN-
&gt; 2.27/t/CPAN/authors/01mailrc.txt&#39;
&gt; #
&gt; ............................................................................DONE
&gt; [...]
&gt; Test Summary Report
&gt; -------------------
&gt; t/31sessions.t              &#40;Wstat: 7168 Tests: 92 Failed: 28&#41;
&gt;   Failed tests:  51-61, 63-66, 68, 71, 74, 77-82, 84, 89-91
&gt;   Non-zero exit status: 28
&gt; 
&gt; This is probably triggered by this
&gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/ingydotnet/yaml-">https://github.com/ingydotnet/yaml-</a></span>
&gt; pm/commit/7736f38bd02e4f9f77d5468721e3be3d7b34a8ec&gt; YAML change.
</div>
I get these failures as well with perl-5.30.1 &#40;actually, perl built at tag v5.30.1&#41; and YAML-1.30.

Unlike the failures in t/12cpan.t being discussed in <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131602">https://rt.cpan.org/Ticket/Display.html?id=131602</a></span>, YAML::Syck has no bearing on these failures.  I first installed YAML, built CPAN, and called &#39;prove&#39; on t/31sessions.t.  Test failures.  I then uninstalled YAML, installed YAML::Syck, built and tested.  No test failures.

So the failures can be diagrammed as follows:

#####
t/12cpan.t -&gt; fails with YAML::Syck
t/31sessions.t -&gt; fails with YAML
#####

Is this diagnosis correct?

Thank you very much.
Jim Keenan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;11:21:46&nbsp;2020</span>
    <span class="description">jkeenan [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 30 11:10:10 2020, JKEENAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Jan 30 07:11:07 2020, ppisar wrote:
<div class="message-stanza open">&gt; &gt; After upgrading YAML 1.29 to 1.30, t/31sessions.t test fails like
&gt; &gt; this:
&gt; &gt;
&gt; &gt; ok 50 - opening new session &#39;the historically second&#39;
&gt; &gt; # error while running &#39;&#34;/usr/bin/perl&#34; &#34;-I/home/test/fedora/perl-
&gt; &gt; CPAN/CPAN-2.27/t&#34; &#34;-Mblib&#34; &#34;-MCPAN::MyConfig_46610&#34; &#34;-Mlocal_utils&#34;
&gt; &gt; &#34;-
&gt; &gt; MCPAN&#34; &#34;-e&#34; &#34;local_utils::dup_pid_inc&#40;46610&#41;;&#34; &#34;-e&#34;
&gt; &gt; &#34;@CPAN::Defaultsites = &#40;&#41;; shell&#34; &gt; test-46610.out&#39; on &#39;the
&gt; &gt; historically second&#39;:
&gt; &gt; not ok 51 - cmd[get CPAN::Test::Dummy::Perl5::Make]
&gt; &gt; #   Failed test &#39;cmd[get CPAN::Test::Dummy::Perl5::Make]&#39;
&gt; &gt; #   at t/31sessions.t line 562.
&gt; &gt; #                   &#39;CPAN: LWP::UserAgent loaded ok &#40;v6.43&#41;
&gt; &gt; # CPAN: URI::URL loaded ok &#40;v5.04&#41;
&gt; &gt; # CPAN: YAML loaded ok &#40;v1.30&#41;
&gt; &gt; # Reading &#39;/home/test/fedora/perl-CPAN/CPAN-
&gt; &gt; 2.27/t/CPAN/authors/01mailrc.txt&#39;
&gt; &gt; # Reading 11 yaml files from /home/test/fedora/perl-CPAN/CPAN-
&gt; &gt; 2.27/t/dot-cpan-46610/build/
&gt; &gt; # &#39;
&gt; &gt; #     doesn&#39;t match &#39;/Has already been unwrapped/&#39;
&gt; &gt; ##9&#40;the historically second&#41;/0:{q[&#39;get
&gt; &gt; CPAN::Test::Dummy::Perl5::Make&#39;]=&gt;q[&#39;CPAN: LWP::UserAgent loaded ok
&gt; &gt; &#40;v6.43&#41;
&gt; &gt; CPAN: URI::URL loaded ok &#40;v5.04&#41;
&gt; &gt; CPAN: YAML loaded ok &#40;v1.30&#41;
&gt; &gt; Reading \&#39;/home/test/fedora/perl-CPAN/CPAN-
&gt; &gt; 2.27/t/CPAN/authors/01mailrc.txt\&#39;
&gt; &gt; Reading 11 yaml files from /home/test/fedora/perl-CPAN/CPAN-
&gt; &gt; 2.27/t/dot-cpan-46610/build/
&gt; &gt; &#39;]}
&gt; &gt; not ok 52 - cmd[make CPAN/Test/Dummy/Perl5/Make.pm]
&gt; &gt; #   Failed test &#39;cmd[make CPAN/Test/Dummy/Perl5/Make.pm]&#39;
&gt; &gt; #   at t/31sessions.t line 562.
&gt; &gt; #                   &#39;Reading &#39;/home/test/fedora/perl-CPAN/CPAN-
&gt; &gt; 2.27/t/CPAN/authors/01mailrc.txt&#39;
&gt; &gt; #
&gt; &gt; ............................................................................DONE
&gt; &gt; [...]
&gt; &gt; Test Summary Report
&gt; &gt; -------------------
&gt; &gt; t/31sessions.t              &#40;Wstat: 7168 Tests: 92 Failed: 28&#41;
&gt; &gt;   Failed tests:  51-61, 63-66, 68, 71, 74, 77-82, 84, 89-91
&gt; &gt;   Non-zero exit status: 28
&gt; &gt;
&gt; &gt; This is probably triggered by this
&gt; &gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/ingydotnet/yaml-">https://github.com/ingydotnet/yaml-</a></span>
&gt; &gt; pm/commit/7736f38bd02e4f9f77d5468721e3be3d7b34a8ec&gt; YAML change.
</div>&gt; 
&gt; I get these failures as well with perl-5.30.1 &#40;actually, perl built at
&gt; tag v5.30.1&#41; and YAML-1.30.
&gt; 
&gt; Unlike the failures in t/12cpan.t being discussed in
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131602">https://rt.cpan.org/Ticket/Display.html?id=131602</a></span>, YAML::Syck has no
&gt; bearing on these failures.  I first installed YAML, built CPAN, and
&gt; called &#39;prove&#39; on t/31sessions.t.  Test failures.  I then uninstalled
&gt; YAML, installed YAML::Syck, built and tested.  No test failures.
&gt; 
</div>
I was partially wrong there.  When I de-installed YAML and installed YAML::Syck, then built CPAN and called &#39;prove&#39; on t/31-sessions.t, the file was graded NOTESTS because all unit tests were skipped due to absence of YAML.

#####
$ thisprove -vb t/31sessions.t 
t/31sessions.t .. 
1..0 # SKIP Yaml module [YAML] not installed
skipped: Yaml module [YAML] not installed
Files=1, Tests=0,  0 wallclock secs &#40; 0.01 usr  0.00 sys +  0.20 cusr  0.00 csys =  0.21 CPU&#41;
Result: NOTESTS
#####


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So the failures can be diagrammed as follows:
&gt; 
&gt; #####
&gt; t/12cpan.t -&gt; fails with YAML::Syck
&gt; t/31sessions.t -&gt; fails with YAML
&gt; #####
&gt; 
&gt; Is this diagnosis correct?
&gt; 
&gt; Thank you very much.
&gt; Jim Keenan
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;11:54:20&nbsp;2020</span>
    <span class="description">TINITA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Since I uploaded the new YAML.pm, I would like to help. I tried to add things like

    ${ &#34;$yaml_module\::LoadBlessed&#34; } = 1;

in several places in the modules, and even hardcoded

    $YAML::LoadBlessed = 1;

but the tests are still failing.
Since that was the only change in YAML.pm, it must be that change, but the code is apparently too complicated for me to fix, and it&#39;s hard to see from the test failures, what&#39;s going wrong.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;11:59:34&nbsp;2020</span>
    <span class="description">TINITA [...] cpan.org -  Cc TINITA added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;12:02:20&nbsp;2020</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #131615] t/31sessions.t fails  with YAML-1.30</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Jan 2020 17:55:42 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> James E Keenan via RT &lt;bug-CPAN [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Petr Pisar &lt;ppisar [...] redhat.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Jan 30, 2020 at 11:10:11AM -0500, James E Keenan via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I get these failures as well with perl-5.30.1 &#40;actually, perl built at tag
&gt; v5.30.1&#41; and YAML-1.30.
&gt; 
&gt; Unlike the failures in t/12cpan.t being discussed in
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131602">https://rt.cpan.org/Ticket/Display.html?id=131602</a></span>, YAML::Syck has no bearing
&gt; on these failures.  I first installed YAML, built CPAN, and called &#39;prove&#39;
&gt; on t/31sessions.t.  Test failures.  I then uninstalled YAML, installed
&gt; YAML::Syck, built and tested.  No test failures.
&gt; 
&gt; So the failures can be diagrammed as follows:
&gt; 
&gt; #####
&gt; t/12cpan.t -&gt; fails with YAML::Syck
&gt; t/31sessions.t -&gt; fails with YAML
&gt; #####
&gt; 
&gt; Is this diagnosis correct?
&gt; 
</div>That&#39;s what I observed.

I also tried setting $YAML::LoadBlessed at various places, but also was unable
to make the test passing. Maybe I do not undestand the tests enough. I suspect
that &#34;the historically second&#34; subtest of t/31sessions.t loads YAML files
created with the previous &#34;the historically first&#34; subtest. But then I don&#39;t
understand how &#34;perl -Ilib t/31sessions.t --session=&#39;the historically second&#39;&#34;
is supposed to work since in that case there shouldn&#39;t be any pregenerated
YAML file. The tests also seems to ignore changes in ./lib. I had to run
&#34;make&#34; to update ./blib. That&#39;s maybe because the YAML.pm is actually loaded
twice. Once from t/31sessions.t and then from a forked CPAN under the test.

-- Petr
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;12:06:57&nbsp;2020</span>
    <span class="description">TINITA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 30 18:02:20 2020, ppisar wrote:


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; YAML file. The tests also seems to ignore changes in ./lib. I had to
&gt; run
&gt; &#34;make&#34; to update ./blib. That&#39;s maybe because the YAML.pm is actually
&gt; loaded
&gt; twice. Once from t/31sessions.t and then from a forked CPAN under the
&gt; test.
</div>
That was a good hint!
I ran make, and the test is passing now, although I explicitly run

    prove -l t/31sessions.t

and the test itself is actually putting lib in @INC...

So, some of my changes fixed it, and I will try to find out which one.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;30&nbsp;14:06:15&nbsp;2020</span>
    <span class="description">TINITA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/andk/cpanpm/pull/133">https://github.com/andk/cpanpm/pull/133</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;31&nbsp;04:06:12&nbsp;2020</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dne ÄŒt 30.led.2020 14:06:15, TINITA napsal&#40;a&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/andk/cpanpm/pull/133">https://github.com/andk/cpanpm/pull/133</a></span>
&gt; 
</div>
Thanks. It works for me.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;11&nbsp;10:43:34&nbsp;2020</span>
    <span class="description">gregoa [...] cpan.org -  Cc GREGOA added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
