<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #87756 for Log-Log4perl: Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #87756 for Log-Log4perl: Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Log-Log4perl">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Log-Log4perl">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Log-Log4perl">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Log-Log4perl">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Log-Log4perl">Log-Log4perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">87756</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Log-Log4perl">Log-Log4perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
nooneofconsequence [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19484-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19485-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




multiline_color_unset_escape.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1247809/660139/multiline_color_unset_escape.patch">
Sat Aug 10 02:36:56 2013 (340b) by nooneofconsequence [...] gmail.com
</a>
</font></li>
</ul>


smime.p7s<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1249769/661236/smime.p7s">
Thu Aug 15 14:15:33 2013 (4k) by nooneofconsequence [...] gmail.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/1247809/660141/smime.p7s">
Sat Aug 10 02:36:56 2013 (4k) by nooneofconsequence [...] gmail.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/1247735/660088/smime.p7s">
Fri Aug 09 19:02:14 2013 (4k) by nooneofconsequence [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=87756">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1247735" href="/Public/Bug/Display.html?id=87756#txn-1247735">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;09&nbsp;19:02:14&nbsp;2013</span>
    <span class="description">nooneofconsequence [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 9 Aug 2013 16:01:55 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Log-Log4perl [...] rt.cpan.org, bug-Term-ANSIColor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Hicks &lt;nooneofconsequence [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1247735/660087/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660087">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think this is possibly due to a bug in Term::ANSIColor but I&#39;m not sure.


I&#39;ve noticed that if I&#39;m using Log::Log4perl::Appender::ScreenColoredLevels as my appended and have normal perl print statements following a log4perl logger invocation, whatever color setting was used for the last log4perl print gets used for my standard print statement as well.


I see that in the patch from issue 30899 which replaced the prior way of using Term::ANSIColor qw&#40;:constants&#41; and actually specifying the RESET in the formatting like:
return GREEN . $message . RESET;

with the new way of using the Term::ANSIColor colored function like:
$msg = Term::ANSIColor::colored&#40; $msg, $color &#41;;

from the documentation on Term::ANSIColor here:    <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm">http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm</a></span>
it seems colored&#40;&#41; is supposed to add the reset for you.
&#34;As an aid in resetting colors, colored&#40;&#41; takes a scalar as the first argument and any number of attribute strings as the second argument and returns the scalar wrapped in escape codes so that the attributes will be set as requested before the string and reset to normal after the string.&#34;



I am currently working around this problem by importing the constants interface to my script 
use Term::ANSIColor qw&#40;:constants&#41;;


and then adding
print RESET;
between any log4perl lines and plain ol print statements I want to use which restores the behavior I think I&#39;m used to.

I&#39;m seeing this on Debian 7 with  liblog-log4perl-perl   1.29-1 which has the version string
our $VERSION = &#39;1.29&#39;;
in the /usr/share/perl5/Log/Log4perl.pm   file

and Term::ANSIColor;
$VERSION = &#39;3.00&#39;;


Michael Hicks
nooneofconsequence@gmail.com


Sometimes being wrong in interesting ways about interesting things is quite good for starting discussions.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1247735/660088/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/pkcs7-signature 4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1247809" href="/Public/Bug/Display.html?id=87756#txn-1247809">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;10&nbsp;02:36:56&nbsp;2013</span>
    <span class="description">nooneofconsequence [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87756] AutoReply: Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 9 Aug 2013 23:36:43 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Log-Log4perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Hicks &lt;nooneofconsequence [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1247809/660138/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660138">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 952b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">After conferring with the maintainer of Term-ANSIColor and some more troubleshooting I&#39;ve come to the conclusion that this is a phenomenon that only occurs for me when using Data::Dumper with logger invocations.

It seems that using Data::Dumper-ized objects in the output colored by Term-ANSIColor inside log4perl results in the terminal not handling the escapes correctly due to the objects being strings that have newline chars in them.

When I ran my program with log4perl set to a logging level that didn&#39;t dump any objects, the phenomenon didn&#39;t occur.  So I tried setting 

$Term::ANSIColor::EACHLINE = &#34;\n&#34;;
which tells Term::ANCIColor to add the colorizing and resets at each newline boundary in my parent program and the phenomenon ceased even at the logging level which was dumping objects.

Similarly, setting
$Term::ANSIColor::EACHLINE = &#34;\n&#34;;
in ScreenColoredLevels.pm solves the problem for me too.

I&#39;ve attached a patch for this bug.  
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1247809/660139/multiline_color_unset_escape.patch">Download multiline_color_unset_escape.patch</a><br />
<span class="downloadcontenttype">text/x-diff 340b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1247809/660140/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660140">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">

I also tested this with and without %n being set in my layout settings and it properly resets both ways.

Thanks for the fantastic log4perl!

Michael Hicks
nooneofconsequence@gmail.com


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -------------------------------------------------------------------------
&gt; I think this is possibly due to a bug in Term::ANSIColor but I&#39;m not sure.
&gt; 
&gt; 
&gt; I&#39;ve noticed that if I&#39;m using Log::Log4perl::Appender::ScreenColoredLevels as my appended and have normal perl print statements following a log4perl logger invocation, whatever color setting was used for the last log4perl print gets used for my standard print statement as well.
&gt; 
&gt; 
&gt; I see that in the patch from issue 30899 which replaced the prior way of using Term::ANSIColor qw&#40;:constants&#41; and actually specifying the RESET in the formatting like:
&gt; return GREEN . $message . RESET;
&gt; 
&gt; with the new way of using the Term::ANSIColor colored function like:
&gt; $msg = Term::ANSIColor::colored&#40; $msg, $color &#41;;
&gt; 
&gt; from the documentation on Term::ANSIColor here:    <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm">http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm</a></span>
&gt; it seems colored&#40;&#41; is supposed to add the reset for you.
&gt; &#34;As an aid in resetting colors, colored&#40;&#41; takes a scalar as the first argument and any number of attribute strings as the second argument and returns the scalar wrapped in escape codes so that the attributes will be set as requested before the string and reset to normal after the string.&#34;
&gt; 
&gt; 
&gt; 
&gt; I am currently working around this problem by importing the constants interface to my script 
&gt; use Term::ANSIColor qw&#40;:constants&#41;;
&gt; 
&gt; 
&gt; and then adding
&gt; print RESET;
&gt; between any log4perl lines and plain ol print statements I want to use which restores the behavior I think I&#39;m used to.
&gt; 
&gt; I&#39;m seeing this on Debian 7 with  liblog-log4perl-perl   1.29-1 which has the version string
&gt; our $VERSION = &#39;1.29&#39;;
&gt; in the /usr/share/perl5/Log/Log4perl.pm   file
&gt; 
&gt; and Term::ANSIColor;
&gt; $VERSION = &#39;3.00&#39;;
&gt; 
&gt; 
&gt; Michael Hicks
&gt; nooneofconsequence@gmail.com
&gt; 
&gt; 
&gt; Sometimes being wrong in interesting ways about interesting things is quite good for starting discussions.
&gt; 
</div></div></div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1247809/660141/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/pkcs7-signature 4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248632" href="/Public/Bug/Display.html?id=87756#txn-1248632">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;12&nbsp;23:49:10&nbsp;2013</span>
    <span class="description">MSCHILLI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1248632/660568/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660568">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 905b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Aug 10 02:36:56 2013, nooneofconsequence@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It seems that using Data::Dumper-ized objects in the output colored by
&gt; Term-ANSIColor inside log4perl results in the terminal not handling
&gt; the escapes correctly due to the objects being strings that have
&gt; newline chars in them.
</div>
Interesting, do you have a snippet of code that reproduces the problem? When I tried to reproduce it with multi-line strings, the coloring worked as expected:

#!/usr/local/bin/perl -w
use strict;

use Log::Log4perl qw&#40;:easy&#41;;

my $conf = q&#40;
    log4perl.category= WARN, Screen
    log4perl.appender.Screen = Log::Log4perl::Appender::ScreenColoredLevels
    log4perl.appender.Screen.layout = \
        Log::Log4perl::Layout::PatternLayout
    log4perl.appender.Screen.layout.ConversionPattern = %d %m%n
&#41;;

Log::Log4perl-&gt;init&#40; \$conf &#41;;
WARN &#34;this is\na multiline\nmessage&#34;;
ERROR &#34;blah blah\nfoo foo&#34;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248633" href="/Public/Bug/Display.html?id=87756#txn-1248633">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;12&nbsp;23:49:11&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1249769" href="/Public/Bug/Display.html?id=87756#txn-1249769">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;15&nbsp;14:15:33&nbsp;2013</span>
    <span class="description">nooneofconsequence [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87756] Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 15 Aug 2013 11:15:06 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Log-Log4perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Hicks &lt;nooneofconsequence [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1249769/661235/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/661235">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I had the same problem.  I played around with creating a toy version that exhibited the problem but couldn&#39;t get it to happen.  I&#39;ll see if I can get something like that hammered out soon to be able to demo it properly.  Thanks for the help,

Michael Hicks
nooneofconsequence@gmail.com


Sometimes being wrong in interesting ways about interesting things is quite good for starting discussions.

On Aug 12, 2013, at 8:49 PM, Michael_Schilli via RT &lt;bug-Log-Log4perl@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87756">https://rt.cpan.org/Ticket/Display.html?id=87756</a></span> &gt;
&gt; 
&gt; On Sat Aug 10 02:36:56 2013, nooneofconsequence@gmail.com wrote:
<div class="message-stanza open">&gt;&gt; It seems that using Data::Dumper-ized objects in the output colored by
&gt;&gt; Term-ANSIColor inside log4perl results in the terminal not handling
&gt;&gt; the escapes correctly due to the objects being strings that have
&gt;&gt; newline chars in them.
</div>&gt; 
&gt; Interesting, do you have a snippet of code that reproduces the problem? When I tried to reproduce it with multi-line strings, the coloring worked as expected:
&gt; 
&gt; #!/usr/local/bin/perl -w
&gt; use strict;
&gt; 
&gt; use Log::Log4perl qw&#40;:easy&#41;;
&gt; 
&gt; my $conf = q&#40;
&gt;    log4perl.category= WARN, Screen
&gt;    log4perl.appender.Screen = Log::Log4perl::Appender::ScreenColoredLevels
&gt;    log4perl.appender.Screen.layout = \
&gt;        Log::Log4perl::Layout::PatternLayout
&gt;    log4perl.appender.Screen.layout.ConversionPattern = %d %m%n
&gt; &#41;;
&gt; 
&gt; Log::Log4perl-&gt;init&#40; \$conf &#41;;
&gt; WARN &#34;this is\na multiline\nmessage&#34;;
&gt; ERROR &#34;blah blah\nfoo foo&#34;;
&gt; 
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1249769/661236/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/pkcs7-signature 4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1910734" href="/Public/Bug/Display.html?id=87756#txn-1910734">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;06&nbsp;20:52:54&nbsp;2020</span>
    <span class="description">ETJ [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.460982</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
