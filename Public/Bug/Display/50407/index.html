<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #50407 for CGI: tmp files not being cleaned up. </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #50407 for CGI: tmp files not being cleaned up. </h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CGI">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CGI">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CGI">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CGI">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/leejo/CGI.pm/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI">CGI CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">50407</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CGI">CGI</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MARKSTOS [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
buuuzi [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-230860-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-230861-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=50407">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675297" href="/Public/Bug/Display.html?id=50407#txn-675297">#</a>      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;11&nbsp;19:24:06&nbsp;2009</span>
    <span class="description">buuuzi [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/675297/347367/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/347367">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 231b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">CGI.pm does not delete temporary file after processing file upload under
mod_perl as promised in documentation. I have discovered a lot of files
CGItemp***** in /var/tmp eating space.

Perl 5.10
OpenSUSE 11.1
Latest apache/mod_perl
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675466" href="/Public/Bug/Display.html?id=50407#txn-675466">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;08:47:46&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675467" href="/Public/Bug/Display.html?id=50407#txn-675467">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;08:49:17&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> CGI.pm not cleaning up temp files under mod_perl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/675467/347443/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/347443">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 487b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Oct 11 19:24:06 2009, raveland wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; CGI.pm does not delete temporary file after processing file upload 
</div>under
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; mod_perl as promised in documentation. I have discovered a lot of 
</div>files
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; CGItemp***** in /var/tmp eating space.
&gt; 
&gt; Perl 5.10
&gt; OpenSUSE 11.1
&gt; Latest apache/mod_perl
</div>
I use CGI.pm with mod_perl and don&#39;t have a bunch of temp files lying 
around. Are you able to reproduce this with a simple test case:

1. Upload a file
2. Observe that a temp file persists
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675468" href="/Public/Bug/Display.html?id=50407#txn-675468">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;08:49:18&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675472" href="/Public/Bug/Display.html?id=50407#txn-675472">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;08:49:34&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675473" href="/Public/Bug/Display.html?id=50407#txn-675473">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;08:49:34&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Severity Important changed to Normal</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675520" href="/Public/Bug/Display.html?id=50407#txn-675520">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;11:21:13&nbsp;2009</span>
    <span class="description">buuuzi [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Temporary file uplaods</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/675520/347473/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/347473">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 918b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 12 08:49:17 2009, MARKSTOS wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I use CGI.pm with mod_perl and don&#39;t have a bunch of temp files lying 
&gt; around. Are you able to reproduce this with a simple test case:
&gt; 
&gt; 1. Upload a file
&gt; 2. Observe that a temp file persists
</div>
I have made some test, and yes, in fact, there is no error when loading
cgi object into one script and using it from there.

But this causes to leave temporary files:

--- script.pl ---
#!/usr/bin/perl
use strict;
use warnings;
no warnings &#39;once&#39;;
use MyTest;
my $obj = MyTest-&gt;new;
print &#34;Content-type: text/html\n\n&#34;;
my $filename = $MyTest::cgi-&gt;param&#40;&#39;picture&#39;&#41;;
print $MyTest::cgi-&gt;tmpFileName&#40;$filename&#41;;
# my own stuff with $obj-&gt;...
--- end of script.pl --

--- MyTest.pm ---
package MyTest;
our &#40;$cgi&#41;;
sub new {
   my $class = shift;
   my %opts = @_;
   my $self = {};
   $cgi = new CGI;
   bless &#40;$self, $class&#41;;
   return $self;
}
1;
--- end of MyTest.pm ---
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675521" href="/Public/Bug/Display.html?id=50407#txn-675521">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;11:21:15&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675534" href="/Public/Bug/Display.html?id=50407#txn-675534">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;12:00:32&nbsp;2009</span>
    <span class="description">mark [...] summersault.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50407] Temporary file uplaods</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 12 Oct 2009 12:00:05 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI.pm [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Stosberg &lt;mark [...] summersault.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/675534/347483/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/347483">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But this causes to leave temporary files:
&gt; 
&gt; our &#40;$cgi&#41;;
</div>
That&#39;s because the use of &#34;our&#34; makes the object persisent beyond one
request, which is generally considered a bug in the application code:

<span class="clickylink"><a target="new" rel="nofollow" href="http://perl.apache.org/docs/1.0/guide/porting.html#Global_Variables_Persistence">http://perl.apache.org/docs/1.0/guide/porting.html#Global_Variables_Persistence</a></span>

I think you will find that that the web server is restarted or the
process is killed, the temp files may be cleaned up then, because that&#39;s
when the CGI object will be destroyed.

If you are using the same CGI object across multiple requests, I
consider that a bug in your code. I wouldn&#39;t be surprised if you 
you can now set a value on page and read it on the next &#40;assuming you
are in single server mode&#41;, which could be a significant bug, if not a
security problem.

According to the CGI.pm source code, this clean up happens when the
object goes out of scope. 

Another reason that the object might be going out of scope is because
your code has a circular reference to the object, so it can&#39;t be cleaned
up automatically. That&#39;s also not a bug in CGI.pm.

    Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675538" href="/Public/Bug/Display.html?id=50407#txn-675538">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;12:00:59&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Subject changed from &#40;no value&#41; to &#39;tmp files not being cleaned up. &#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-675539" href="/Public/Bug/Display.html?id=50407#txn-675539">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;12&nbsp;12:01:20&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-709038" href="/Public/Bug/Display.html?id=50407#txn-709038">#</a>      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;20&nbsp;20:02:19&nbsp;2009</span>
    <span class="description">buuuzi [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/709038/365838/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365838">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

 I understood my mistakes and beg to be forgiven.

 Now I observe different situation with the same problem. On machines
with details above everything is fine - when the cgi object goes out of
scope - it removes temp files.

 I have a problem with my new machine. Here&#39;s info:

perl -v:
This is perl, v5.10.0 built for x86_64-linux-thread-multi

uname -a:
Linux production-2 2.6.31.5-0.1-default #1 SMP 2009-10-26 15:49:03 +0100
x86_64 x86_64 x86_64 GNU/Linux

Apache info:
Apache/2.2.13 &#40;Linux/SUSE&#41; mod_perl/2.0.4 Perl/v5.10.0

The script which is run under mod_perl env, is simple:
-------------------
#!/usr/bin/perl

use strict;
use warnings;
no warnings &#39;once&#39;;

use CGI;

my $cgi = CGI-&gt;new;

print &#34;Content-type: text/html\n\n&#34;;
print &#34;Hello&#34;;
-------------------

However, it does not delete temporary files as all my other machines do.
I have put some warning lines into your CGI.pm and discovered that main
CGI object gets destroyed, but CGITempFile object never do.

Could you please explain why some parts of module destroy fine, but some
don&#39;t?

Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-709039" href="/Public/Bug/Display.html?id=50407#txn-709039">#</a>      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;20&nbsp;20:02:20&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-709172" href="/Public/Bug/Display.html?id=50407#txn-709172">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;21&nbsp;09:48:17&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/709172/365917/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365917">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 878b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The script which is run under mod_perl env, is simple:
&gt; -------------------
&gt; #!/usr/bin/perl
&gt; 
&gt; use strict;
&gt; use warnings;
&gt; no warnings &#39;once&#39;;
&gt; 
&gt; use CGI;
&gt; 
&gt; my $cgi = CGI-&gt;new;
&gt; 
&gt; print &#34;Content-type: text/html\n\n&#34;;
&gt; print &#34;Hello&#34;;
&gt; -------------------
</div>
I don&#39;t see how why script would create any tmp files. Does it for you?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Could you please explain why some parts of module destroy fine, but 
</div>some don&#39;t?

One reason is due to circular references. Is every module version of 
every other module in your project the same across all your machines? I 
suspect not. 

One of them could have a circular reference involving the &#34;CGITempFile&#34; 
name space but perhaps not the &#34;CGI&#34; name space for example. 

I am just guessing, but since CGI.pm did not change between your 
machines, there is a good chance that the source of the bug is 
elsewhere. 

    Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-709176" href="/Public/Bug/Display.html?id=50407#txn-709176">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;21&nbsp;09:48:18&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-709410" href="/Public/Bug/Display.html?id=50407#txn-709410">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;21&nbsp;18:25:50&nbsp;2009</span>
    <span class="description">buuuzi [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> buuuzi [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/709410/366022/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/366022">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 795b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

 As far as I understand - my script never creates itself temporary
files. It is done by CGI module when it gets specific form parameters.
But it&#39;s not the point.

 I have created a simple multipart form in html file, which points to
that simple script. If I provide file &#40;i.e. upload it&#41; then CGI is
responsible for this. So my example should work, it works &#40;removes
temporary files&#41; on almost all systems, except this new one. This is
what I am trying to figure out.

 Also my mod_perl startup script is default. For this test I am not
using ANY modules except these come with default apache installation. I
have removed all my work from this test machine. I rule out fact
something was made by me except for that simple script.

 How can we debug this why CGITempFile does not destroy?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-709411" href="/Public/Bug/Display.html?id=50407#txn-709411">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;21&nbsp;18:25:51&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-719202" href="/Public/Bug/Display.html?id=50407#txn-719202">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;12&nbsp;22:18:19&nbsp;2010</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/719202/371310/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/371310">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Dec 21 18:25:50 2009, raveland wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello,
&gt; 
&gt;  As far as I understand - my script never creates itself temporary
&gt; files. It is done by CGI module when it gets specific form parameters.
&gt; But it&#39;s not the point.
&gt; 
&gt;  I have created a simple multipart form in html file, which points to
&gt; that simple script. If I provide file &#40;i.e. upload it&#41; then CGI is
&gt; responsible for this. So my example should work, it works &#40;removes
&gt; temporary files&#41; on almost all systems, except this new one. This is
&gt; what I am trying to figure out.
&gt; 
&gt;  Also my mod_perl startup script is default. For this test I am not
&gt; using ANY modules except these come with default apache installation. 
</div>I
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; have removed all my work from this test machine. I rule out fact
&gt; something was made by me except for that simple script.
&gt; 
&gt;  How can we debug this why CGITempFile does not destroy?
</div>
I think you&#39;ve run into classic mod_perl perl issues:

Search for &#34;CGI-&gt;new&#34; from here:

<span class="clickylink"><a target="new" rel="nofollow" href="http://perl.apache.org/docs/1.0/guide/porting.html#The_First_Mystery">http://perl.apache.org/docs/1.0/guide/porting.html#The_First_Mystery</a></span>

If you want to re-open a ticket for a bug you are experiencing in 
mod_perl, please submit a script which follows the recommendations 
outlined here. 

    Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-719206" href="/Public/Bug/Display.html?id=50407#txn-719206">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;12&nbsp;22:18:20&nbsp;2010</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-724437" href="/Public/Bug/Display.html?id=50407#txn-724437">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;25&nbsp;10:38:34&nbsp;2010</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/724437/374140/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/374140">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 845b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">A follow-up sent to me directly, stored here for reference:

###

Hello, Mark!

Â Sorry I am writing to your email instead of Cpan bugtracking system, 
but this email is just information on how I managed to find the problem.

Â If you remember it was about not destroying cgi object properly.

Â Finally it was combination of factors. Apache was running with mpm-itk 
module and was behind nginx front-end. Interesting thing is that if 
uploading file directly to backend apache &#40;without frondend&#41; objects got 
destroyed properly, but with frontend they don&#39;t. I have changed from 
mpm-itk to regular, and problems disappeared.

Â It seems to be my current newest distribution offered by default this 
mpm-itk for apache for x64 platforms, which is buggy or something.

Â Just thought it would be interesting to share this information.

Ben

###
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-724440" href="/Public/Bug/Display.html?id=50407#txn-724440">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;25&nbsp;10:38:36&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-998792" href="/Public/Bug/Display.html?id=50407#txn-998792">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;11&nbsp;20:46:08&nbsp;2011</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/998792/520204/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/520204">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 36b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Rejecting as apparent bug in mpm-itk
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-998796" href="/Public/Bug/Display.html?id=50407#txn-998796">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;11&nbsp;20:46:10&nbsp;2011</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1367033" href="/Public/Bug/Display.html?id=50407#txn-1367033">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;May&nbsp;23&nbsp;14:28:18&nbsp;2014</span>
    <span class="description">The RT System itself -  Queue changed from CGI.pm to CGI</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.672707</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
