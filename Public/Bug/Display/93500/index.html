<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #93500 for Spreadsheet-ParseExcel: Fwd: Unexpected [RE] included in Cell Contents</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #93500 for Spreadsheet-ParseExcel: Fwd: Unexpected [RE] included in Cell Contents</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">93500</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
sleighton [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.61    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




testcase.xls<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1333213/707285/testcase.xls">
Mon Mar 03 18:55:00 2014 (43.5k) by sleighton [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;03&nbsp;18:55:00&nbsp;2014</span>
    <span class="description">sleighton [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fwd: Unexpected [RE] included in Cell Contents</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 3 Mar 2014 15:54:47 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Scott Leighton &lt;sleighton [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"> Current Setup



    Perl version   : 5.008006

    OS name        : linux

    Module versions: &#40;not all are required&#41;

                     Spreadsheet::ParseExcel    0.60

                     Scalar::Util               1.14

                     Unicode::Map               0.112

                     Spreadsheet::WriteExcel    2.40

                     Parse::RecDescent          1.80

                     File::Temp                 0.22

                     OLE::Storage_Lite          0.19

                     IO::Stringy                2.109



Excel  2010 Version 14.0.7113.5005 &#40;32-bit&#41;



Origin of Sheet: Unknown, originally created with much earlier version of
Excel.



Issue:



Note sure if this is a bug or just user error/misunderstanding.



I have a spreadsheet I am parsing that has certain cells in it that contain
numeric data and when viewed in excel look just like any other numeric cell
in the sheet, yet the Value returned by Spreadsheet::ParseExcel is mangled
with the text [RE] &#40;see example below&#41;. I have checked the formatting of
these cells in Excel and they appear to be the same as cells that do not
return the mangled text.



Note that the [RE] sometimes has the minus sign before the ending brace
[RE-] and sometimes includes the very first digit of the number in the cell
before the ending brace  [RE-1]. No clue why this pattern happens. When
viewed in Excel the [RE] is not in the cell and not in the format for the
cell.



I am stumped about where the unwanted characters are coming from and would
appreciate any help figuring it out.



Example:



testcase.xls sheet is attached. Running this simple script copied from an
earlier bug report produces the output shown below.



[SCRIPT]

#!/usr/bin/perl



use strict;

use Spreadsheet::ParseExcel;

my $oExcel = new Spreadsheet::ParseExcel;

my $oBook = $oExcel-&gt;Parse&#40;$ARGV[0]&#41;;

my&#40;$iR, $iC,$oWkS, $oWkC&#41;;

print &#34;=========================================\n&#34;;

print &#34;FILE :&#34;, $oBook-&gt;{File} , &#34;\n&#34;;

print &#34;COUNT :&#34;, $oBook-&gt;{SheetCount} , &#34;\n&#34;;

print &#34;AUTHOR:&#34;, $oBook-&gt;{Author} , &#34;\n&#34;;

foreach my $oWkS &#40;@{$oBook-&gt;{Worksheet}}&#41; {

  print &#34;--------- SHEET:&#34;, $oWkS-&gt;{Name}, &#34;\n&#34;;

  for&#40;my $iR = $oWkS-&gt;{MinRow} ; defined $oWkS-&gt;{MaxRow} &#38;&#38; $iR &lt;= $oWkS-&gt;{
MaxRow} ; $iR++&#41; {

    for&#40;my $iC = $oWkS-&gt;{MinCol} ; defined $oWkS-&gt;{MaxCol} &#38;&#38; $iC &lt;= $oWkS-&gt;
{MaxCol} ; $iC++&#41; {

       $oWkC = $oWkS-&gt;{Cells}[$iR][$iC];

       print &#34;&#40; $iR , $iC &#41; =&gt;&#34;, $oWkC-&gt;Value, &#34;\n&#34; if&#40;$oWkC&#41;;

    }

  }

}



[OUTPUT]

=========================================

FILE :testcase.xls

COUNT :1

AUTHOR:Scott Leighton

--------- SHEET:COS difference

&#40; 0 , 0 &#41; =&gt;5110-01

&#40; 0 , 1 &#41; =&gt;Computed 1

&#40; 0 , 3 &#41; =&gt;[RE]-539

&#40; 0 , 4 &#41; =&gt;[RE]-568

&#40; 0 , 5 &#41; =&gt;[RE-]1,457

&#40; 0 , 6 &#41; =&gt;[RE-]1,704

&#40; 0 , 7 &#41; =&gt;[RE-]2,868

&#40; 0 , 8 &#41; =&gt;[RE-]5,485

&#40; 0 , 9 &#41; =&gt;[RE-]6,513

&#40; 0 , 10 &#41; =&gt;[RE-]9,096

&#40; 0 , 11 &#41; =&gt;[RE-1]4,302

&#40; 0 , 12 &#41; =&gt;[RE-1]4,897

&#40; 0 , 13 &#41; =&gt;[RE-1]7,320

&#40; 0 , 14 &#41; =&gt;[RE-1]9,984

&#40; 0 , 15 &#41; =&gt;-94,733

&#40; 1 , 3 &#41; =&gt;

&#40; 1 , 4 &#41; =&gt;

&#40; 1 , 5 &#41; =&gt;

&#40; 1 , 6 &#41; =&gt;

&#40; 1 , 7 &#41; =&gt;

&#40; 1 , 8 &#41; =&gt;

&#40; 1 , 9 &#41; =&gt;

&#40; 1 , 10 &#41; =&gt;

&#40; 1 , 11 &#41; =&gt;

&#40; 1 , 12 &#41; =&gt;

&#40; 1 , 13 &#41; =&gt;

&#40; 1 , 14 &#41; =&gt;

&#40; 1 , 15 &#41; =&gt;

&#40; 2 , 0 &#41; =&gt;5120-01

&#40; 2 , 1 &#41; =&gt;Computed 2

&#40; 2 , 3 &#41; =&gt;[RE]-11

&#40; 2 , 4 &#41; =&gt;[RE]-11

&#40; 2 , 5 &#41; =&gt;[RE]-28

&#40; 2 , 6 &#41; =&gt;[RE]-33

&#40; 2 , 7 &#41; =&gt;[RE]-64

&#40; 2 , 8 &#41; =&gt;[RE]-128

&#40; 2 , 9 &#41; =&gt;[RE]-152

&#40; 2 , 10 &#41; =&gt;[RE]-222

&#40; 2 , 11 &#41; =&gt;[RE]-354

&#40; 2 , 12 &#41; =&gt;[RE]-377

&#40; 2 , 13 &#41; =&gt;[RE]-452

&#40; 2 , 14 &#41; =&gt;[RE]-522

&#40; 2 , 15 &#41; =&gt;-2,354

&#40; 3 , 0 &#41; =&gt;5120-01

&#40; 3 , 1 &#41; =&gt;Computed 3

&#40; 3 , 3 &#41; =&gt;1

&#40; 3 , 4 &#41; =&gt;40

&#40; 3 , 5 &#41; =&gt;33

&#40; 3 , 6 &#41; =&gt;29

&#40; 3 , 7 &#41; =&gt;8

&#40; 3 , 8 &#41; =&gt;[RE]-27

&#40; 3 , 9 &#41; =&gt;[RE]-19

&#40; 3 , 10 &#41; =&gt;[RE]-60

&#40; 3 , 11 &#41; =&gt;[RE]-149

&#40; 3 , 12 &#41; =&gt;[RE]-155

&#40; 3 , 13 &#41; =&gt;[RE]-249

&#40; 3 , 14 &#41; =&gt;[RE]-197

&#40; 3 , 15 &#41; =&gt;-745

&#40; 4 , 0 &#41; =&gt;5140-01

&#40; 4 , 1 &#41; =&gt;Computed 4

&#40; 4 , 3 &#41; =&gt;[RE]-8

&#40; 4 , 4 &#41; =&gt;[RE]-9

&#40; 4 , 5 &#41; =&gt;[RE]-22

&#40; 4 , 6 &#41; =&gt;[RE]-26

&#40; 4 , 7 &#41; =&gt;[RE]-44

&#40; 4 , 8 &#41; =&gt;[RE]-83

&#40; 4 , 9 &#41; =&gt;[RE]-99

&#40; 4 , 10 &#41; =&gt;[RE]-138

&#40; 4 , 11 &#41; =&gt;[RE]-217

&#40; 4 , 12 &#41; =&gt;[RE]-226

&#40; 4 , 13 &#41; =&gt;[RE]-263

&#40; 4 , 14 &#41; =&gt;[RE]-303

&#40; 4 , 15 &#41; =&gt;-1,438

&#40; 5 , 0 &#41; =&gt;5151-01

&#40; 5 , 1 &#41; =&gt;Computed 5

&#40; 5 , 3 &#41; =&gt;[RE]-1

&#40; 5 , 4 &#41; =&gt;[RE]-1

&#40; 5 , 5 &#41; =&gt;[RE]-2

&#40; 5 , 6 &#41; =&gt;[RE]-3

&#40; 5 , 7 &#41; =&gt;[RE]-5

&#40; 5 , 8 &#41; =&gt;[RE]-8

&#40; 5 , 9 &#41; =&gt;[RE]-11

&#40; 5 , 10 &#41; =&gt;[RE]-14

&#40; 5 , 11 &#41; =&gt;[RE]-22

&#40; 5 , 12 &#41; =&gt;[RE]-24

&#40; 5 , 13 &#41; =&gt;[RE]-27

&#40; 5 , 14 &#41; =&gt;[RE]-32

&#40; 5 , 15 &#41; =&gt;-150

&#40; 6 , 0 &#41; =&gt;5150-01

&#40; 6 , 1 &#41; =&gt;Computed 6

&#40; 6 , 3 &#41; =&gt;[RE]-3

&#40; 6 , 4 &#41; =&gt;[RE]-3

&#40; 6 , 5 &#41; =&gt;[RE]-8

&#40; 6 , 6 &#41; =&gt;[RE]-9

&#40; 6 , 7 &#41; =&gt;[RE]-16

&#40; 6 , 8 &#41; =&gt;[RE]-31

&#40; 6 , 9 &#41; =&gt;[RE]-36

&#40; 6 , 10 &#41; =&gt;[RE]-51

&#40; 6 , 11 &#41; =&gt;[RE]-81

&#40; 6 , 12 &#41; =&gt;[RE]-84

&#40; 6 , 13 &#41; =&gt;[RE]-99

&#40; 6 , 14 &#41; =&gt;[RE]-113

&#40; 6 , 15 &#41; =&gt;-534

&#40; 7 , 3 &#41; =&gt;

&#40; 7 , 4 &#41; =&gt;

&#40; 7 , 5 &#41; =&gt;

&#40; 7 , 6 &#41; =&gt;

&#40; 7 , 7 &#41; =&gt;

&#40; 7 , 8 &#41; =&gt;

&#40; 7 , 9 &#41; =&gt;

&#40; 7 , 10 &#41; =&gt;

&#40; 7 , 11 &#41; =&gt;

&#40; 7 , 12 &#41; =&gt;

&#40; 7 , 13 &#41; =&gt;

&#40; 7 , 14 &#41; =&gt;

&#40; 7 , 15 &#41; =&gt;







Thanks,



Scott Leighton

  ­­



-- 
G+ &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://www.google.com/+ScottLeighton_GPlus">https://www.google.com/+ScottLeighton_GPlus</a></span>&gt;  |
LinkedIn&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.linkedin.com/in/scottleighton">http://www.linkedin.com/in/scottleighton</a></span>&gt;
|  Facebook &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.facebook.com/sleighton">http://www.facebook.com/sleighton</a></span>&gt;  |
@NotSsoFAQs&lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://twitter.com/NotSoFAQs">https://twitter.com/NotSoFAQs</a></span>&gt; |
About Me &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://about.me/sleighton">http://about.me/sleighton</a></span>&gt;
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1333213/707285/testcase.xls">Download testcase.xls</a><br />
<span class="downloadcontenttype">application/vnd.ms-excel 43.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;03&nbsp;21:25:32&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
It all comes down to this case:

use Spreadsheet::ParseExcel::Utility qw&#40;ExcelFmt&#41;;
print ExcelFmt&#40;&#39;&#40;#,##0_&#41;;[RED]&#40;#,##0&#41;&#39;, -539, 0, &#39;Numeric&#39;&#41;, &#34;\n&#34;;

Now that&#39;s a nasty function, so I don&#39;t know when I can take a closer look at it. And maybe it has something partly to do with the %hFmtDefault hash in FmtDefault.pm. I copied the fmt string as displayed in Excel, and ExcelFmt still didn&#39;t work &#40; &#39;#,##0_&#41;;[Red]&#40;#,##0&#41;&#39; &#41;.

Feel free to look closer yourself :-&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;03&nbsp;21:25:32&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;00:27:53&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 03 21:25:32 2014, DOUGW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; &#39;#,##0_&#41;;[Red]&#40;#,##0&#41;&#39;
</div>
Actually, if the format in the global array is replaced by that, then the numbers come out as normal negative &#40;commafied&#41; integers. I&#39;m don&#39;t think ExcelFmt is supposed to put parens around negative numbers even if the format says so. The docs on ExcelFmt are not helpful here, as it only mentions usage for date values. I&#39;m a little confused here, so if John or someone pipes up on what is supposed to happen, that would be great.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;08:59:16&nbsp;2014</span>
    <span class="description">sleighton [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93500] Fwd: Unexpected [RE] included in Cell Contents</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 4 Mar 2014 05:59:05 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Scott Leighton &lt;sleighton [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for the explanation!

I control the sheets so it is easy enough to change the format of the
problem cells as a workaround. To anyone else encountering this problem, a
second workaround is to save the sheets in xlsx file format and use
Spreadsheet::ParseXLSX as the parser &#40;it is a wrapper for this module, so a
drop in to your code&#41;. That worked too &#40;my guess is that Excel makes some
subtle change to the format when it changes to the xlsx file format&#41;.


On Mon, Mar 3, 2014 at 6:25 PM, Douglas Wilson via RT &lt;
bug-Spreadsheet-ParseExcel@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93500">https://rt.cpan.org/Ticket/Display.html?id=93500</a></span> &gt;
&gt;
&gt;
&gt; It all comes down to this case:
&gt;
&gt; use Spreadsheet::ParseExcel::Utility qw&#40;ExcelFmt&#41;;
&gt; print ExcelFmt&#40;&#39;&#40;#,##0_&#41;;[RED]&#40;#,##0&#41;&#39;, -539, 0, &#39;Numeric&#39;&#41;, &#34;\n&#34;;
&gt;
&gt; Now that&#39;s a nasty function, so I don&#39;t know when I can take a closer look
&gt; at it. And maybe it has something partly to do with the %hFmtDefault hash
&gt; in FmtDefault.pm. I copied the fmt string as displayed in Excel, and
&gt; ExcelFmt still didn&#39;t work &#40; &#39;#,##0_&#41;;[Red]&#40;#,##0&#41;&#39; &#41;.
&gt;
&gt; Feel free to look closer yourself :-&#41;
&gt;
</div>


-- 
G+ &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://www.google.com/+ScottLeighton_GPlus">https://www.google.com/+ScottLeighton_GPlus</a></span>&gt;  |
LinkedIn&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.linkedin.com/in/scottleighton">http://www.linkedin.com/in/scottleighton</a></span>&gt;
|  Facebook &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.facebook.com/sleighton">http://www.facebook.com/sleighton</a></span>&gt;  |
@NotSsoFAQs&lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://twitter.com/NotSoFAQs">https://twitter.com/NotSoFAQs</a></span>&gt; |
About Me &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://about.me/sleighton">http://about.me/sleighton</a></span>&gt;
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;11:20:32&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 03 18:55:00 2014, sleighton@gmail.com wrote:

Hi Scott,

The issue is that the cell format contain a format with &#34;[RED]&#34; in it. While Excel accepts that, it should strictly be &#34;[Red]&#34; &#40;Sentence case&#41;.

If you changed that in your input file it should be parsed correctly.

Alternatively, in Spreadsheet::ParseExcel::Utility.pm you can change the parse from:


    my $color = &#39;&#39;;
    if &#40; $format =~ s/^&#40;\[[A-Z][a-z]{2,}&#40;\d{1,2}&#41;?\]&#41;// &#41; {
        $color = $1;
    }

To:

    my $color = &#39;&#39;;
    if &#40; $format =~ s/^&#40;\[[A-Za-z]{3,}&#40;\d{1,2}&#41;?\]&#41;// &#41; {
        $color = $1;
    }

Then it will handle either format.

Doug, that may be a change worth making.

John
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;11:23:40&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 04 00:27:53 2014, DOUGW wrote:
The docs on ExcelFmt are not helpful here,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; as it only mentions usage for date values. I&#39;m a little confused here,
&gt; so if John or someone pipes up on what is supposed to happen, that
&gt; would be great.
</div>
Hi Doug,

You should have seen it before I clean it up. :-&#41;

<span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/KWITKNR/Spreadsheet-ParseExcel-0.25/ParseExcel/Utility.pm">http://cpansearch.perl.org/src/KWITKNR/Spreadsheet-ParseExcel-0.25/ParseExcel/Utility.pm</a></span>

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;12:06:19&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 04 11:20:32 2014, JMCNAMARA wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Mar 03 18:55:00 2014, sleighton@gmail.com wrote:
&gt; 
&gt; If you changed that in your input file it should be parsed correctly.
&gt; 
</div>
Actually, I don&#39;t think he has that choice, as the value comes from the global %hFmtDefault &#40;index 0x26&#41; which has a few &#39;RED&#39; entries. Those should probably be changed to &#39;Red&#39; I guess, and your other suggested change is probably worth making also.

Scott: as for a workaround, you should probably be using the unformatted value anyway, unless you really need the commafied formatted number.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;12:22:49&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 04 12:06:19 2014, DOUGW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Actually, I don&#39;t think he has that choice, as the value comes from
&gt; the global %hFmtDefault &#40;index 0x26&#41; which has a few &#39;RED&#39; entries.
&gt; Those should probably be changed to &#39;Red&#39; I guess, and your other
&gt; suggested change is probably worth making also.
</div>
Hi Doug,

Good point, I missed that.

In that case it is probably worth changing %hFmtDefault.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Scott: as for a workaround, you should probably be using the
&gt; unformatted value anyway, unless you really need the commafied
&gt; formatted number.
</div>
Agreed. Overall that is the safest approach.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;13:56:15&nbsp;2014</span>
    <span class="description">sleighton [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93500] Fwd: Unexpected [RE] included in Cell Contents</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 4 Mar 2014 09:50:47 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Scott Leighton &lt;sleighton [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks guys. Took your advice and switched to using the unformatted value
and all is well. Again, I really appreciate your help solving this, I am in
awe of you guys ;&#41;

Scott


On Tue, Mar 4, 2014 at 9:22 AM, John McNamara via RT &lt;
bug-Spreadsheet-ParseExcel@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93500">https://rt.cpan.org/Ticket/Display.html?id=93500</a></span> &gt;
&gt;
&gt; On Tue Mar 04 12:06:19 2014, DOUGW wrote:
<div class="message-stanza open">&gt; &gt; Actually, I don&#39;t think he has that choice, as the value comes from
&gt; &gt; the global %hFmtDefault &#40;index 0x26&#41; which has a few &#39;RED&#39; entries.
&gt; &gt; Those should probably be changed to &#39;Red&#39; I guess, and your other
&gt; &gt; suggested change is probably worth making also.
</div>&gt;
&gt; Hi Doug,
&gt;
&gt; Good point, I missed that.
&gt;
&gt; In that case it is probably worth changing %hFmtDefault.
&gt;
&gt;
<div class="message-stanza open">&gt; &gt; Scott: as for a workaround, you should probably be using the
&gt; &gt; unformatted value anyway, unless you really need the commafied
&gt; &gt; formatted number.
</div>&gt;
&gt; Agreed. Overall that is the safest approach.
&gt;
&gt; John.
&gt; --
&gt;
&gt;
&gt;
&gt;
&gt;
</div>

-- 
G+ &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://www.google.com/+ScottLeighton_GPlus">https://www.google.com/+ScottLeighton_GPlus</a></span>&gt;  |
LinkedIn&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.linkedin.com/in/scottleighton">http://www.linkedin.com/in/scottleighton</a></span>&gt;
|  Facebook &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.facebook.com/sleighton">http://www.facebook.com/sleighton</a></span>&gt;  |
@NotSsoFAQs&lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://twitter.com/NotSoFAQs">https://twitter.com/NotSoFAQs</a></span>&gt; |
About Me &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://about.me/sleighton">http://about.me/sleighton</a></span>&gt;
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;18:58:25&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 04 13:56:15 2014, sleighton@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks guys. Took your advice and switched to using the unformatted value
</div>
Fixed in 0.61 anyway :-&#41;
closing this ticket.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;18:58:26&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;18:58:26&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Fixed in 0.61 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
