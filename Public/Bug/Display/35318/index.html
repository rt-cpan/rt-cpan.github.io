<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #35318 for CGI: CGI hidden values within form appearing on link</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #35318 for CGI: CGI hidden values within form appearing on link</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CGI/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CGI/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CGI/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CGI/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/leejo/CGI.pm/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI">CGI CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">35318</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CGI/Active/">CGI</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MARKSTOS [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MV5492 [...] att.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-230860-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-230861-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;22&nbsp;17:09:14&nbsp;2008</span>
    <span class="description">MV5492 [...] att.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> CGI hidden values within form appearing on link</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 22 Apr 2008 16:08:45 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-CGI.pm [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Vanole, Mike&#34; &lt;MV5492 [...] att.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, 

I reported this as a webserver7 problem, but playing around with CGI
versions revealed CGI.pm was causing odd behavior.

Problem noticed at CGI.pm-3.33
Problem still there at CGI.pm-3.35

Downgraded to version CGI.pm-3.15 and the problem goes away.

Here is the code for a test cgi that replicates the problem to see
exactly what I&#39;m talking about. At 3.33 and above clicking the buttons
as directed reveals the values in the URL at the second button click
when we expect them to remain hidden. The second form submission somehow
gets transformed from a POST to a GET. The same cgi running under 3.15
and lower keeps the values hidden. 

perl 5.8.8 on Solaris 9

#!/usr/local/bin/perl
use CGI;
use CGI::Carp qw&#40;fatalsToBrowser&#41;;
$q = new CGI;
print $q-&gt;header;
print $q-&gt;start_html&#40;&#34;test&#34;&#41;;
$ASCS1chk = $q-&gt;param&#40;&#39;ASCS1&#39;&#41;;
$ASCS2chk = $q-&gt;param&#40;&#39;ASCS2&#39;&#41;;
print &#34;&lt;CENTER&gt;&#34;;
if &#40;length&#40;$ASCS1chk&#41; != 0&#41;
{
&#38;ASC_2&#40;&#41;;
}
elsif &#40;length&#40;$ASCS2chk&#41; != 0&#41;
{
&#38;junk&#40;&#41;;
}
else
{
&#38;ASC_1&#40;&#41;;
}
sub ASC_1
{
$USERID = &#39;jj&#39;;
print $q-&gt;start_form&#40;&#41;;
print &#34;&lt;table border=0 width=400 cellspacing=2 cellpadding=0&gt;&#34;;
print &#34;&lt;tr&gt;&lt;td align=left class=ctm&gt; &lt;/td&gt;&#34;;
undef @ATempArray;
push&#40;@ATempArray,&#39;Account ET - CARE History&#39;&#41;;
push&#40;@ATempArray,&#39;Audits&#39;&#41;;
if &#40;$#ATempArray != -1&#41;
{
print &#34;&lt;tr&gt;&lt;td align=left width=30% class=ctm&gt; &lt;/td&gt;&#34;;
print &#34;&lt;tr&gt;&lt;td&gt;&lt;td align=right class=ctf colspan=6&gt;&#34;;
print $q-&gt;hidden&#40;-name=&gt;&#39;USER_IN&#39;,-value=&gt;$USERID,-force=&gt;1&#41;;
print $q-&gt;submit&#40;-style=&gt;&#39;font-family:arial; font-size:
11;&#39;,-name=&gt;&#39;ASCS1&#39;,-value=&gt;&#39;Click this button&#39;&#41;;
print $q-&gt;end_form;
}
print &#34;&lt;/table&gt;&#34;;
}
sub ASC_2
{
$USERID1 = $q-&gt;param&#40;&#39;USER_IN&#39;&#41;;
$ASCUPD_CHK = $q-&gt;param&#40;&#39;ASCUPD&#39;&#41;;
print &#34;&lt;table border=0 width=400 cellspacing=2 cellpadding=0&gt;&#34;;
print $q-&gt;start_form&#40;-name=&gt;&#39;OV2&#39;&#41;;
print &#34;&lt;tr&gt;&lt;td align=left class=ctf nowrap valign=top&gt;&#34;;
print $q-&gt;hidden&#40;-name=&gt;&#39;ORIGASC&#39;,-value=&gt;$ASCUPD_CHK,-force=&gt;1&#41;;
print $q-&gt;hidden&#40;-name=&gt;&#39;USER_IN2&#39;,-value=&gt;$USERID1,-force=&gt;1&#41;;
print $q-&gt;hidden&#40;-name=&gt;&#39;DFHR&#39;,-value=&gt;$DefHR,-force=&gt;1&#41;;
print $q-&gt;hidden&#40;-name=&gt;&#39;DFHM&#39;,-value=&gt;$DefMN,-force=&gt;1&#41;;
print $q-&gt;hidden&#40;-name=&gt;&#39;ACTDT&#39;,-value=&gt;$OVDate,-force=&gt;1&#41;;
print &#34;&lt;tr&gt;&lt;td align=center valign=top&gt; &#34;;
print &#34;&lt;tr&gt;&lt;td align=center valign=top&gt; &#34;;
print &#34;&lt;tr&gt;&lt;td align=right valign=top colspan=2&gt;&#34;;
print $q-&gt;submit&#40;-style=&gt;&#39;font-family:arial; font-size:
11;&#39;,-name=&gt;&#39;ASCS2&#39;,-value=&gt;&#39;Now Click this button&#39;&#41;;
print $q-&gt;end_form&#40;&#41;;
print &#34;&lt;tr&gt;&lt;td align=right valign=top colspan=6&gt;&#34;;
print &#34;&lt;/table&gt;&#34;;
}
sub junk
{
print &#34;The values you see in the address line are hidden values within a
form. We are not expecting them to be displayed here. Usually they are
not displayed in this line. There are no alink refs within this cgi&#34;;
}

Please let me know if there is more I can provide.
Thanks for a great perl module!
Mike
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;23&nbsp;06:18:31&nbsp;2008</span>
    <span class="description">MV5492 [...] att.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #35318] AutoReply: CGI hidden values within form appearing on link </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 23 Apr 2008 05:18:10 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-CGI.pm [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Vanole, Mike&#34; &lt;MV5492 [...] att.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here is a little more information from someone else who was looking at a
workaround:
---------
FYI - I updated to CGI.pm 3.29. I&#39;m now getting the same behavior you
reported. I was able to code around the behavior with:

print $q-&gt;start_form&#40;-name=&gt;&#39;OV2&#39;,-action =&gt; $ENV{SCRIPT_NAME}&#41;;

This forces CGI.pm to pull the SCRIPT_NAME environment variable from the
information passed to it by the server at request time, and use that as
the action rather than the default value &#40;which is supposed to be &#34;this
script,&#34; but is clearly now picking up data from the prior POST and
appending it to &#34;this script&#34; as query data&#41;.

I also notice that smart_form&#40;&#41; appears to be using multipart/form-data
despite the docs indicating that it will use
application/x-www-form-urlencoded, and that start_multipart_form&#40;&#41; needs
to be used if a multipart form is desired. I get the impression that the
docs for CGI.pm no longer accurately reflect the state of the software.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;25&nbsp;17:52:50&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;25&nbsp;17:56:49&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Apr 23 06:18:31 2008, MV5492@att.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here is a little more information from someone else who was looking at a
&gt; workaround:
&gt; ---------
&gt; FYI - I updated to CGI.pm 3.29. I&#39;m now getting the same behavior you
&gt; reported. I was able to code around the behavior with:
&gt; 
&gt; print $q-&gt;start_form&#40;-name=&gt;&#39;OV2&#39;,-action =&gt; $ENV{SCRIPT_NAME}&#41;;
&gt; 
&gt; This forces CGI.pm to pull the SCRIPT_NAME environment variable from the
&gt; information passed to it by the server at request time, and use that as
&gt; the action rather than the default value &#40;which is supposed to be &#34;this
&gt; script,&#34; but is clearly now picking up data from the prior POST and
&gt; appending it to &#34;this script&#34; as query data&#41;.
</div>
I think what you experienced in the upgrade may have been a fix rather
than a bug. Including the query params in the query string is a way to
save state. If you don&#39;t want that behavior, then explicitly stating the
&#34;action&#34; you want is the recommended path. The recommendation above to
use &#34;$ENV{SCRIPT_NAME}&#34; is reasonable. 

I&#39;m marking this bug as &#34;rejected&#34; for now. 

Regarding the start_form&#40;&#41; behavior and documentation, see this bug:

 <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=22046">https://rt.cpan.org/Ticket/Display.html?id=22046</a></span>

    Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;25&nbsp;17:56:50&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;25&nbsp;17:56:51&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;25&nbsp;17:57:09&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Reference to ticket #22046 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;May&nbsp;23&nbsp;14:28:17&nbsp;2014</span>
    <span class="description">The RT System itself -  Queue changed from CGI.pm to CGI</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
