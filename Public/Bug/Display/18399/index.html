<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #18399 for WWW-Mechanize: value doesn&#39;t support multiple checkboxes with the same name.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #18399 for WWW-Mechanize: value doesn&#39;t support multiple checkboxes with the same name.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/WWW-Mechanize/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/WWW-Mechanize/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/WWW-Mechanize/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/WWW-Mechanize/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/libwww-perl/WWW-Mechanize/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/WWW-Mechanize">WWW-Mechanize CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">18399</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/WWW-Mechanize/Active/">WWW-Mechanize</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jarich [...] perltraining.com.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-36214-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.12    </td>
  </tr>
  <tr id="CF-36215-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;28&nbsp;02:01:36&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> value doesn&#39;t support multiple checkboxes with the same name.</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I appear to be having difficulty attaching files, so I&#39;ll include some
cut and paste here as well.

I&#39;m attempting to walk through a tick every checkbox with a given name.
 I don&#39;t care what the value is, I want to tick all of them.  I thought
I&#39;d start by getting the value, so that I could pass the name and value
to tick.  The HTML is pretty straight forward:

&lt;form method=&#34;POST&#34; action=&#34;test.cgi&#34;&gt;
&lt;input type=&#34;checkbox&#34; name=&#34;check&#34; value=&#34;1111&#34; &gt;1111
&lt;input type=&#34;checkbox&#34; name=&#34;check&#34; value=&#34;2222&#34; &gt;2222
&lt;input type=&#34;checkbox&#34; name=&#34;check&#34; value=&#34;3333&#34; &gt;3333
&lt;input type=&#34;checkbox&#34; name=&#34;check&#34; value=&#34;4444&#34; &gt;4444
&lt;input type=&#34;checkbox&#34; name=&#34;check&#34; value=&#34;5555&#34; &gt;5555
&lt;/form&gt;

And the code is as well:

#!/usr/bin/perl -w
use strict;
use WWW::Mechanize;
use Data::Dumper;

my $mech = WWW::Mechanize-&gt;new&#40;&#41;;
$mech-&gt;get&#40;&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/~jarich/abc.html">http://localhost/~jarich/abc.html</a></span>&#34;&#41;;

print Dumper $mech-&gt;forms&#40;&#41;;
print scalar $mech-&gt;value&#40;&#34;check&#34;, 1&#41;;

Unfortunately for all field numbers I pass to value I get a undefined
value, when I expected to receive &#34;1111&#34; or &#34;2222&#34;.  Interestingly, if I
edit the HTML to say that the field is &#34;checked&#34; then value returns the
expected value &#34;1111&#34; etc.

The data dump for each unchecked data dump looks like:

                    bless&#40; {
                              &#39;current&#39; =&gt; 0,
                              &#39;menu&#39; =&gt; [
                                         {
                                            &#39;seen&#39; =&gt; 1,
                                            &#39;value&#39; =&gt; undef,
                                            &#39;name&#39; =&gt; &#39;off&#39;
                                         },
                                         {
                                            &#39;value&#39; =&gt; &#39;1111&#39;,
                                            &#39;name&#39; =&gt; &#39;1111&#39;
                                         }
                                                  ],
                               &#39;name&#39; =&gt; &#39;check&#39;,
                               &#39;type&#39; =&gt; &#39;checkbox&#39;
                            }, &#39;HTML::Form::ListInput&#39; &#41;,

If the checkbox is checked however it looks like:

                    bless&#40; {
                              &#39;current&#39; =&gt; 1,
                              &#39;menu&#39; =&gt; [
                                          {
                                            &#39;value&#39; =&gt; undef,
                                            &#39;name&#39; =&gt; &#39;off&#39;
                                          },
                                          {
                                            &#39;seen&#39; =&gt; 1,
                                            &#39;value&#39; =&gt; &#39;3333&#39;,
                                            &#39;name&#39; =&gt; &#39;3333&#39;
                                          }
                                        ],
                               &#39;name&#39; =&gt; &#39;check&#39;,
                               &#39;type&#39; =&gt; &#39;checkbox&#39;
                            }, &#39;HTML::Form::ListInput&#39; &#41;,

where the value of current and the hash with the &#34;seen&#34; value appears to
map to whether the checkbox is checked upon loading.

I&#39;m hoping a work around will be to walk through the structure and set
current =&gt; 1 for each element with the name &#34;check&#34;.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w
use strict;

use WWW::Mechanize;

my $mech = WWW::Mechanize-&gt;new&#40;&#41;;

$mech-&gt;get&#40;&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/~jarich/abc.html">http://localhost/~jarich/abc.html</a></span>&#34;&#41;;

use Data::Dumper;

print Dumper $mech-&gt;forms&#40;&#41;;
print scalar $mech-&gt;value&#40;&#34;check&#34;, 1&#41;;


</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;28&nbsp;04:23:38&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 28 02:01:36 2006, guest wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m hoping a work around will be to walk through the structure and set
&gt; current =&gt; 1 for each element with the name &#34;check&#34;.
</div>
For the curious this work around seemed to do all I needed it to do.

&lt;pre&gt;
# Grab the first form out.
my @forms = $mech-&gt;forms&#40;&#41;;
my $form = $forms[0];

# Check all the boxes
foreach my $input &#40; @{$form-&gt;{inputs}} &#41; {
      next unless $input-&gt;{name} eq &#34;check&#34;;

      $input-&gt;{current} = 1;
}
&lt;/pre&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;28&nbsp;04:23:39&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;28&nbsp;21:52:38&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; # Grab the first form out.
&gt; my @forms = $mech-&gt;forms&#40;&#41;;
&gt; my $form = $forms[0];
&gt; 
&gt; # Check all the boxes
&gt; foreach my $input &#40; @{$form-&gt;{inputs}} &#41; {
&gt;       next unless $input-&gt;{name} eq &#34;check&#34;;
&gt; 
&gt;       $input-&gt;{current} = 1;
&gt; }
</div>
A better solution is to use the HTML::Form interface:

# Grab the first form out.
my &#40;$form&#41; = $mech-&gt;forms;

# Check all the boxes
foreach my $input &#40;$form-&gt;inputs&#41; {
      my $name = $input-&gt;name || next;
      next unless $input-&gt;type eq &#39;checkbox&#39;;
      next unless $name eq &#34;check&#34;;
      $input-&gt;check;
}

I&#39;ve been thinking about whether this is a problem with value&#40;&#41; not
working as expected, or whether this is a problem with the word value
having two meanings.

On one hand it makes sense for the value&#40;&#41; method to return undef if the
checkbox is unchecked, as that&#39;s what will will be passed through to the
web server when the form is submitted.  On the other hand, in the HTML
the keyword value is used to specify the value that would be passed
through if the check box was checked.  value&#40;&#41; appears to act as the
former suggests; returning undef for all unchecked check boxes and
returning the value for all checked check boxes.

Unfortunately I&#39;m still unclear as to how &#40;using Mech&#41; to get the value
I need to pass into tick&#40;&#41;.

I think essentially that this is really a documentation bug regarding
the purpose of value&#40;&#41; &#40;and maybe regarding the use of tick&#41; than a code
bug.  Assuming that value is supposed to behave the way it does.  ;&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;09&nbsp;22:17:16&nbsp;2007</span>
    <span class="description">PETDANCE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Moved over to <span class="clickylink"><a target="new" rel="nofollow" href="http://code.google.com/p/www-mechanize/issues/detail?id=26">http://code.google.com/p/www-mechanize/issues/detail?id=26</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;09&nbsp;22:17:18&nbsp;2007</span>
    <span class="description">PETDANCE [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
