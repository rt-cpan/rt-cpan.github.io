<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #71372 for Net-ISC-DHCPd: Groups in dhcpd.conf</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #71372 for Net-ISC-DHCPd: Groups in dhcpd.conf</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-ISC-DHCPd/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-ISC-DHCPd/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-ISC-DHCPd/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-ISC-DHCPd/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/jhthorsen/net-isc-dhcpd/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-ISC-DHCPd">Net-ISC-DHCPd CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">71372</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-ISC-DHCPd/Active/">Net-ISC-DHCPd</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">JHTHORSEN [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
itsrath [...] itsm.uni-stuttgart.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-227682-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-227683-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.15    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;30&nbsp;13:32:26&nbsp;2011</span>
    <span class="description">itsrath [...] itsm.uni-stuttgart.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Groups in dhcpd.conf</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Sep 2011 19:32:10 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> jhthorsen [...] cpan.org, bug-net-isc-dhcpd [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Rath &lt;itsrath [...] itsm.uni-stuttgart.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jan Henning,

I am about to write a script that makes the generation of a dhcpd.conf 
file easier. Therefore I&#39;d like to parse the file, add new host entries 
and save it back with a script.

I gladly found your Perl class Net::ISC::DHCPd:Config that should help 
me a lot. Unfortunately I first found no way to retain host groups. 
There seemed to be a class for it, but it doesn&#39;t show up as a member of 
Config.

Without nearly any knowledge of Perl ;-&#41; I tried inserting the line

Net::ISC::DHCPd::Config::Group

under

__PACKAGE__-&gt;create_children&#40;qw/

in line 107 in the file 
&#34;/usr/lib/perl5/site_perl/5.8.8/Net/ISC/DHCPd/Config.pm&#34; and wow! the 
groups are there...

So you probably should patch that?!?

But there are some problems remaining:

The pools are lost and so are the keys and the classes.

I send you a copy of the first part of my dhcpd.conf. If you try it with

------------------------------------------------

#!/usr/bin/perl
use Net::ISC::DHCPd::Config;

my $config = Net::ISC::DHCPd::Config-&gt;new&#40;
                  file =&gt; &#39;/etc/dhcpd3/dhcpd.conf&#39;,
              &#41;;

# parse the config
  $config-&gt;parse;

# parsing includes are lazy
for my $include &#40;$config-&gt;includes&#41; {
     $include-&gt;parse;
}

print $config-&gt;generate;

------------------------------------------------

and compare the output with the original you will see what the problems 
are...

Regards

Michael
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;03&nbsp;12:52:06&nbsp;2011</span>
    <span class="description">JHTHORSEN [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;03&nbsp;15:22:52&nbsp;2011</span>
    <span class="description">JHTHORSEN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I just released 0.11 to cpan:

0.11     Mon Oct  3 21:17:46 CEST 2011
       - [RT71372] Add missing ::Config::Group to children
       - [RT71372] Quick fix to missing blocks
       - [RT71372] Fix parsing of &#34;next-server&#34; inside subnet
       - [RT71372] Add parsing of key{} blocks
       - Add support for logging with ISC_DHCPD_TRACE=1

The &#34;quick fix&#34; is not bad, but it&#39;s far from perfect. The problem is 
that I&#39;m not sure when I will have enough time to make a proper parser 
for class{}, subclass{}, and friends.

Let me know if this is an issue for you.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;03&nbsp;15:22:53&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;03&nbsp;15:22:53&nbsp;2011</span>
    <span class="description">JHTHORSEN [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;04&nbsp;06:38:47&nbsp;2011</span>
    <span class="description">itsrath [...] itsm.uni-stuttgart.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #71372] Groups in dhcpd.conf</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 04 Oct 2011 12:38:34 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-ISC-DHCPd [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Rath &lt;itsrath [...] itsm.uni-stuttgart.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jan Henning,

Am 03.10.2011 21:22, schrieb Jan Henning Thorsen via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=71372">https://rt.cpan.org/Ticket/Display.html?id=71372</a></span>&gt;
&gt;
&gt; I just released 0.11 to cpan:
&gt;
&gt; 0.11     Mon Oct  3 21:17:46 CEST 2011
&gt;         - [RT71372] Add missing ::Config::Group to children
&gt;         - [RT71372] Quick fix to missing blocks
&gt;         - [RT71372] Fix parsing of &#34;next-server&#34; inside subnet
&gt;         - [RT71372] Add parsing of key{} blocks
&gt;         - Add support for logging with ISC_DHCPD_TRACE=1
</div>
thank you very much for this quick response.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The &#34;quick fix&#34; is not bad, but it&#39;s far from perfect. The problem is
&gt; that I&#39;m not sure when I will have enough time to make a proper parser
&gt; for class{}, subclass{}, and friends.
&gt;
&gt; Let me know if this is an issue for you.
</div>
not as long as it is put out by &#34;generate&#34; as it was in the input.

The fix is nearly perfect as it now generates all the missing lines. But 
there are still some problems:

- The main problem that keeps me from being able to use your class is: 
the sequence of commands is mixed up in the output of &#34;generate&#34;. This 
leads to the daemon not accepting the generated dhcpd.conf file. The 
subnet sections with the class definitions and the option statements 
defining the user options have to be in front of the host and host group 
definitions or the deamon will produce many error messages.

- You don&#39;t output a trailing &#39;;&#39; after the &#39;}&#39; of the key section. Most 
examples show that but it doesn&#39;t seem to be required by the daemon. But 
very easy to fix ;-&#41; ...

- When specifying the keyname in double quotes the name contains the 
last double quote leading to two double quotes at the end in the output 
of generate which messes up the daemons parsing. That&#39;s perhaps because 
the regex matching when parsing the name in your key class is not 
greedy. This is a very minor issue as most examples don&#39;t use double 
quotes around the key name. But it is accepted by the DHCP daemon.

- And I personally have a very special problem: I need comments to be 
retained &#40;at least the &#34;# monitor: 3 4 Y Studenten_DHCP&#34; comment in the 
pool definition&#41;. That is because of the nagios plugin dhcp-pool &#40; 
<span class="clickylink"><a target="new" rel="nofollow" href="http://folk.uio.no/trondham/software/dhcpd-pool.html">http://folk.uio.no/trondham/software/dhcpd-pool.html</a></span> &#41; needing these 
comments to work correctly. That&#39;s of minor priority as I can easily 
write a script that inserts those after generating the dhcpd.conf.

I already worked around the problem of the disappearing comments by 
defining the user options which now contain the comments &#40;I hope they 
have no side effects as I don&#39;t fully understand the concept of user 
options...&#41;. But that won&#39;t work with this plugin unless I change the 
source code &#40;might be easy, but a bit of a hassle in case of updates of 
that plugin&#41;.

Regards

Michael
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;04&nbsp;06:38:49&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;04&nbsp;09:10:56&nbsp;2011</span>
    <span class="description">JHTHORSEN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have pushed a new release to CPAN now. Please check it out.

0.12     Tue Oct  4 15:06:11 CEST 2011
       - [RT71372] Contributor: Michael Rath
       - Change child nodes has the same order as input
       - Config::Block has _body &#40;ArrayRef&#41; instead of body &#40;Str&#41;
       - Config::Block body text is indented as expected
       - Config::Key-&gt;_build_regex handle quotes
       - Add trailing &#34;;&#34; to Config::Key block &#40;not sure why though...&#41;
       - Add support for comments before elements. Generated output will
         also have comments

See Net::ISC::DHCPd::Config::Role/comments for new attribute containing 
comments.

t/40-rt71372-group.t now takes your input file and checks for the same 
output from generate&#40;&#41; so I think it is OK now, even though I have made 
some changes to the input. The changes I made is adding whitespace in 
front of comments and config lines.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;04&nbsp;09:10:57&nbsp;2011</span>
    <span class="description">JHTHORSEN [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;04&nbsp;13:16:33&nbsp;2011</span>
    <span class="description">itsrath [...] itsm.uni-stuttgart.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #71372] Groups in dhcpd.conf</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 04 Oct 2011 19:16:09 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-ISC-DHCPd [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Rath &lt;itsrath [...] itsm.uni-stuttgart.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jan Henning,

calm down - relax...

I&#39;m not used to &#34;turn around&#34; times of less than 3 hours for bug reports 
;-&#41; - is this standard on CPAN or do you want to break any records?

Anyway - thank you very much for your fast response. I never thought it 
might be possible to implement all my whishes &#40;especially the last&#41; in 
such a short time.

Though I could perfectly live with that version there are a few 
inconsistencies remaining:

Am 04.10.2011 15:10, schrieb Jan Henning Thorsen via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         - Config::Block body text is indented as expected
</div>
I have two files appended where the indentation is not as I would have 
expected it to be.

In the output generated from dhcpd.conf there is even an error because 
the first host statement is ignored &#40;whyever&#41;. I admit that it is not a 
beauty of a DHCP configuration file &#40;it&#39;s a cutout from our DHCP 
configuration here at the institute which grew over the years without me 
having much knowledge about DHCP config files ;-&#41; &#41;. But it was 
recognized by the DHCP daemon as valid an worked as expected.

In the other example &#40;example1_dhcpd.conf&#41; I would have expected an 
indentation of the parameters and host blocks within the group block. 
But that&#39;s just a cosmetic change and I don&#39;t know if it was on purpose.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         - Add support for comments before elements. Generated output will
&gt;           also have comments
&gt;
&gt; See Net::ISC::DHCPd::Config::Role/comments for new attribute containing
&gt; comments.
</div>
OK. Comments before lines work. But comments after lines &#40;at the end of 
a block&#41; or inline &#40;at the end of the line&#41; don&#39;t. Again no big deal. 
But if you want to retain all information possibly given in a config 
file these cases should be covered too &#40;you see - I#m sort of a 
erfectionist... ;-&#41; &#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; t/40-rt71372-group.t now takes your input file and checks for the same
&gt; output from generate&#40;&#41; so I think it is OK now, even though I have made
&gt; some changes to the input. The changes I made is adding whitespace in
&gt; front of comments and config lines.
</div>
Adding or deleting whitespace and empty lines is not bad. On the 
contrary: it&#39;s beautifying my mess ;-&#41; ...

Thanks again!

Regards

Michael
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;04&nbsp;13:16:34&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;04&nbsp;14:04:21&nbsp;2011</span>
    <span class="description">JHTHORSEN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I had some spare time, so I thought that it was better to do it now, 
than later :-&#41;

My module is indeed limited, since it parses one line at a time, and the 
regular expressions used may be a bit too strict. That means that it may 
not be able to read &#34;ugly&#34; dhcpd.config files. Too help understand it&#39;s 
limits I add support for the ISC_DHCPD_TRACE environment, which will 
print what could NOT be parsed to STDERR. Very much like perl&#39;s warnings 
would do. Please set the variable to see what lines it fails on... 
&#40;ISC_DHCPD_TRACE should probably be set to 1 by default?&#41;

The comment &#34;Config::Block body text is indented as expected&#34; is really, 
really bad. What I discovered is that the indentation was *better* after 
my latest commit, but i *knew* it was probably not perfect, since I&#39;m 
removing the first four whitespaces... Patches are welcome :-&#41;

My goal was not to make really pretty config-files, but rather to be 
able to print something that was readable and parsable again by the 
module. Not sure if I will focus on this cosmetic change. Reason for 
that is I don&#39;t use ISC DHCPd myself, so I only fix bugs that are fatal 
because I feel that is the responsibility of module author...

Comments at the end of block will be attached to the config line 
afterwards. The only comments which is not parsed, is the one at the end 
of file and &#34;trailing&#34; comments. Example:

 # this comment will be attached to the &#34;host&#34; object
 host foo { # this comment will be stripped away
 ...
 }
 # this comment will be attached to &#34;option&#34; object below
 option foo 42;
 # the last comment in the file will be ignored

&#40;Should probably add that to the documentation...&#41;

I do not want to retain all details. I just want to retain enough 
details. I think it is acceptable to require a format on the input 
text...

So to sum up... Was there anything I needed to fix - except cosmetic 
bugs?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;05&nbsp;05:11:52&nbsp;2011</span>
    <span class="description">itsrath [...] itsm.uni-stuttgart.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #71372] Groups in dhcpd.conf</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 05 Oct 2011 11:11:40 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-ISC-DHCPd [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Rath &lt;itsrath [...] itsm.uni-stuttgart.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jan Henning,

Am 04.10.2011 20:04, schrieb Jan Henning Thorsen via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; limits I add support for the ISC_DHCPD_TRACE environment, which will
&gt; print what could NOT be parsed to STDERR. Very much like perl&#39;s warnings
&gt; would do. Please set the variable to see what lines it fails on...
</div>
OK, I tried that. With my dhcpd.conf sent to you it gives 3 errors:

Could not parse &#34;    host itsm-dhcptest1 {&#34; at dhcpd.conf line 95
Could not parse &#34;key &#34;itsm-key&#34; {&#34; at dhcpd.conf line 1
Could not parse &#34;};&#34; at dhcpd.conf line 4

The first is the problem why it messes up the resulting config file, but 
I see no reason why as it is valid for the daemon in the source.

The other two come from the line

include &#34;/etc/itsm.key&#34;;

I don&#39;t know either why this should be a problem as /etc/itsm.key 
contains only:

key &#34;itsm-key&#34; {
         algorithm hmac-md5;
         secret &#34;xxxxxxxxxxxxxxxxxxxxxxxxx&#34;;
};

which should be perfectly valid and is indeed parsed by your class 
without error if fed directly to the parser.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The comment &#34;Config::Block body text is indented as expected&#34; is really,
&gt; really bad. What I discovered is that the indentation was *better* after
&gt; my latest commit, but i *knew* it was probably not perfect, since I&#39;m
&gt; removing the first four whitespaces... Patches are welcome :-&#41;
</div>
I think it should be easy: increase the indentation level with every 
found &#39;{&#39; and decrease it with every &#39;}&#39;. But it&#39;s not so important...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Comments at the end of block will be attached to the config line
&gt; afterwards. The only comments which is not parsed, is the one at the end
&gt; of file and &#34;trailing&#34; comments.
</div>
No, the comments directly in front of a closing &#39;}&#39; are not parsed 
either. Example:

     host ITSM-RAID {
       hardware ethernet 00:1b:f1:20:83:c1;
       fixed-address 129.69.62.222;
       # this is a comment at the end of a block
     }
         # ITSM-EYB2
     host itsm-tyb2 {
       hardware ethernet 4a:19:66:41:c5:4d;
       fixed-address itsm-tyb2.itsm.uni-stuttgart.de; # 129.69.62.132
     }

generates

    host ITSM-RAID {
         hardware ethernet 00:1b:f1:20:83:c1;
         fixed-address 129.69.62.222;
     }
     # ITSM-EYB2
     host itsm-tyb2 {
         hardware ethernet 4a:19:66:41:c5:4d;
         fixed-address itsm-tyb2.itsm.uni-stuttgart.de;
     }

with the line

       # this is a comment at the end of a block

completely missing. If it&#39;s easy to fix that, it would be good. 
Otherwise put that in the docu too ;-&#41; .

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So to sum up... Was there anything I needed to fix - except cosmetic
&gt; bugs?
</div>
Yes, I think the errors produced by my last sent dhcpd.conf file are 
somewhat troublesome.

Regards

Michael
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;05&nbsp;07:56:46&nbsp;2011</span>
    <span class="description">JHTHORSEN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The reason was that Pool and Include had missing child elements. I just 
added the missing elements and created a new release to CPAN. Hope I 
haven&#39;t forgotten about anything...

If you like, you&#39;re more than welcome to look over the list of childrens 
in each Config:: package to see if it makes sense. Look for:

 __PACKAGE__-&gt;create_children&#40;qw/ ... /&#41;;

&#40;as you probably already know&#41;.


0.13     Wed Oct  5 12:43:42 CEST 2011
       - Add custom warnings group for Role-&gt;parse&#40;&#41; warnings. This can 
be
         silenced with &#40;no warnings &#39;net_isc_dhcpd_config_parse&#39;;&#41;
       - Add example config parser script
       - Add more child nodes to Config::Include
         * Net::ISC::DHCPd::Config::Key
         * Net::ISC::DHCPd::Config::Group
         * Net::ISC::DHCPd::Config::Block
       - Add more child nodes to Config::Pool
         * Net::ISC::DHCPd::Config::Host
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;12&nbsp;00:02:08&nbsp;2014</span>
    <span class="description">RDRAKE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 05 07:56:46 2011, JHTHORSEN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The reason was that Pool and Include had missing child elements. I just 
&gt; added the missing elements and created a new release to CPAN. Hope I 
&gt; haven&#39;t forgotten about anything...
&gt; 
&gt; If you like, you&#39;re more than welcome to look over the list of childrens 
&gt; in each Config:: package to see if it makes sense. Look for:
&gt; 
&gt;  __PACKAGE__-&gt;create_children&#40;qw/ ... /&#41;;
&gt; 
&gt; &#40;as you probably already know&#41;.
&gt; 
&gt; 
&gt; 0.13     Wed Oct  5 12:43:42 CEST 2011
&gt;        - Add custom warnings group for Role-&gt;parse&#40;&#41; warnings. This can 
&gt; be
&gt;          silenced with &#40;no warnings &#39;net_isc_dhcpd_config_parse&#39;;&#41;
&gt;        - Add example config parser script
&gt;        - Add more child nodes to Config::Include
&gt;          * Net::ISC::DHCPd::Config::Key
&gt;          * Net::ISC::DHCPd::Config::Group
&gt;          * Net::ISC::DHCPd::Config::Block
&gt;        - Add more child nodes to Config::Pool
&gt;          * Net::ISC::DHCPd::Config::Host
</div>

I think this is safe to mark as resolved.  
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;12&nbsp;00:02:08&nbsp;2014</span>
    <span class="description">RDRAKE [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;May&nbsp;12&nbsp;00:02:09&nbsp;2014</span>
    <span class="description">RDRAKE [...] cpan.org -  Fixed in 0.15 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
