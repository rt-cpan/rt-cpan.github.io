<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #131773 for SQL-Statement: Unable to process complex SQL statement with bracket before IN clause</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #131773 for SQL-Statement: Unable to process complex SQL statement with bracket before IN clause</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=SQL-Statement">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=SQL-Statement">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=SQL-Statement">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=SQL-Statement">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/SQL-Statement">SQL-Statement CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">131773</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=SQL-Statement">SQL-Statement</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mark_robbins1 [...] hotmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29588-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29589-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=131773">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884652" href="/Public/Bug/Display.html?id=131773#txn-1884652">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;10:19:53&nbsp;2020</span>
    <span class="description">mark_robbins1 [...] hotmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Unable to process complex SQL statement with bracket before IN clause</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 13 Feb 2020 15:19:41 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-SQL-Statement [at] rt.cpan.org.&#34; &lt;&#34;bug-SQL-Statement [at] rt.cpan.org.&#34; [...] xx1.develooper.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark R &lt;mark_robbins1 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884652/1011233/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011233">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

could you please investigate this problem.
It looks like the parser can&#39;t handle certain types of complex SQL statements.

SQL statement:
select * from docs where &#40;sourcetable = &#39;AA&#39; and recid = 11111 &#41; or &#40; sourcetable=&#39;AA&#39; and sourceid in &#40;select infouid from aa where aaid= &#39;&#39; and class= &#39;&#39; &#41;&#41; or &#40; sourcetable=&#39;BB&#39; and sourceid in &#40;select infouid from bb where bbid= &#39;&#39; and class= &#39;&#39; &#41;&#41;

This was adapted from an ORACLE database. the table/column names and values have been substituted for the real values.

code sample
====
#### this is an example of the full SQL but a shorter example is included below
###my $sqlStmtStr = &#34;select * from docs where &#40;sourcetable = &#39;AA&#39; and recid = 11111 &#41; or &#40; sourcetable=&#39;AA&#39; and sourceid in &#40;select infouid from aa where aaid= &#39;&#39; and class= &#39;&#39; &#41;&#41; or &#40; sourcetable=&#39;BB&#39; and sourceid in &#40;select infouid from bb where bbid= &#39;&#39; and class= &#39;&#39; &#41;&#41; &#34;;

my $sqlStmtStr = &#34;select * from docs where &#40; sourceid in &#40;select infouid from aa where aaid= &#39;&#39; &#41;&#41; &#34;;


my $sqlParser = SQL::Parser-&gt;new&#40;&#41;;
$sqlParser-&gt;{RaiseError} = 0;
$sqlParser-&gt;{PrintError} = 1;

print STDERR &#34;about to process: $sqlStmtStr\n&#34;;
my $sqlStmt = SQL::Statement-&gt;new&#40;$sqlStmtStr,$sqlParser&#41;;

Error messages/warnings
=====
about to process: select * from docs where &#40; sourceid in &#40;select infouid from aa where aaid= &#39;&#39; &#41;&#41;
Bad table or column name: &#39;sourceid in select infouid from aa where aaid&#39; has chars not alphanumeric or underscore! at /home/xxxxx/perl5/lib/site_perl/5.26.1/SQL/Statement.pm line 90.
Couldn&#39;t find predicate! at /home/xxxxx/perl5/lib/site_perl/5.26.1/SQL/Statement.pm line 90.


version info
====
Perl version:
This is perl 5, version 26, subversion 1 &#40;v5.26.1&#41; built for i686-linux

[xxxxx@localhost outputArchive]$ uname -a
Linux localhost.localdomain 2.6.32-358.11.1.el6.i686 #1 SMP Wed Jun 12 01:01:27 UTC 2013 i686 i686 i386 GNU/Linux

cpan[4]&gt; i SQL::Parser
Module id = SQL::Parser
    CPAN_USERID  REHSACK &#40;Jens Rehsack &lt;rehsack@cpan.org&gt;&#41;
    CPAN_VERSION 1.412
    CPAN_FILE    R/RE/REHSACK/SQL-Statement-1.412.tar.gz
    UPLOAD_DATE  2017-04-06
    MANPAGE      SQL::Parser -- validate and parse SQL strings
    INST_FILE    /home/xxxxx/perl5/lib/site_perl/5.26.1/SQL/Parser.pm
    INST_VERSION 1.412


cpan[5]&gt; i SQL::Statement
Module id = SQL::Statement
    CPAN_USERID  REHSACK &#40;Jens Rehsack &lt;rehsack@cpan.org&gt;&#41;
    CPAN_VERSION 1.412
    CPAN_FILE    R/RE/REHSACK/SQL-Statement-1.412.tar.gz
    UPLOAD_DATE  2017-04-06
    MANPAGE      SQL::Statement - SQL parsing and processing engine
    INST_FILE    /home/xxxxx/perl5/lib/site_perl/5.26.1/SQL/Statement.pm
    INST_VERSION 1.412

thanks.
mark
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884652/1011234/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011234">with headers</a>
<br />
<span class="downloadcontenttype">text/html 4.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884673" href="/Public/Bug/Display.html?id=131773#txn-1884673">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;11:32:38&nbsp;2020</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884673/1011244/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011244">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 54b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Would you please read the documentation first? Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884674" href="/Public/Bug/Display.html?id=131773#txn-1884674">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;11:32:39&nbsp;2020</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884677" href="/Public/Bug/Display.html?id=131773#txn-1884677">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;11:32:39&nbsp;2020</span>
    <span class="description">REHSACK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884678" href="/Public/Bug/Display.html?id=131773#txn-1884678">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;11:41:13&nbsp;2020</span>
    <span class="description">mark_robbins1 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Dan [...] DWright.Org&#34; &lt;Dan [...] DWright.Org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #131773] Unable to process complex SQL statement with bracket before IN clause</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 13 Feb 2020 16:41:00 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-SQL-Statement [...] rt.cpan.org&#34; &lt;bug-SQL-Statement [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark R &lt;mark_robbins1 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884678/1011248/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011248">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 873b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

thanks for the prompt reply.
could you please highlight which part of the documentation I have misunderstood or missed.

I thought I had gone through everything in detail.
I have got the code working with other pieces of SQL.

I have a second piece of SQL that has a similar problem.
if you can point me at the relevant part then I will happily do what I can to use this.

I have tried the AnyData and Ansi dialects.

thanks,
Mark


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: Jens Rehsack via RT &lt;bug-SQL-Statement@rt.cpan.org&gt;
Sent: 13 February 2020 16:32
To: mark_robbins1@hotmail.com &lt;mark_robbins1@hotmail.com&gt;
Cc: Dan@DWright.Org &lt;Dan@DWright.Org&gt;
Subject: [rt.cpan.org #131773] Unable to process complex SQL statement with bracket before IN clause

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131773">https://rt.cpan.org/Ticket/Display.html?id=131773</a></span> &gt;

Would you please read the documentation first? Thanks!
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884678/1011249/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011249">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884681" href="/Public/Bug/Display.html?id=131773#txn-1884681">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;11:44:29&nbsp;2020</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884681/1011252/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011252">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 228b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sure: <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/SQL::Statement#BUGS-AND-LIMITATIONS">https://metacpan.org/pod/SQL::Statement#BUGS-AND-LIMITATIONS</a></span>

5th item from top.

I agree, the reported error is misleading, but when sub-selects were detected correctly by the broken parser, executing them will be easy :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884684" href="/Public/Bug/Display.html?id=131773#txn-1884684">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;11:56:00&nbsp;2020</span>
    <span class="description">mark_robbins1 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Dan [...] DWright.Org&#34; &lt;Dan [...] DWright.Org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #131773] Unable to process complex SQL statement with bracket before IN clause</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 13 Feb 2020 16:55:52 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-SQL-Statement [...] rt.cpan.org&#34; &lt;bug-SQL-Statement [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark R &lt;mark_robbins1 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884684/1011256/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011256">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jens,

thanks for the reply. I was caught out by the error message and I didn&#39;t appreciate that the sub select was actually the problem.

I saw there were references to developing version 2 which relied on a BNF structure.

I&#39;m guessing from the lack of releases that this is still on the back burner.

Are there any plans to bring this work forward?
Do you have an estimate for how long it would take to write/complete it?
I know that working with BNF isn&#39;t a quick task - I studied it&#39;s use for programming languages quite a long time ago.

I ask because I may have some funding available. If I can&#39;t get this working then I would have to use a commercial solution and the current commercial option is not implemented in Perl and it is potentally very expensive.

I&#39;m happy to talk privately.

best regards,
Mark

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: Jens Rehsack via RT &lt;bug-SQL-Statement@rt.cpan.org&gt;
Sent: 13 February 2020 16:44
To: mark_robbins1@hotmail.com &lt;mark_robbins1@hotmail.com&gt;
Cc: Dan@DWright.Org &lt;Dan@DWright.Org&gt;
Subject: [rt.cpan.org #131773] Unable to process complex SQL statement with bracket before IN clause

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131773">https://rt.cpan.org/Ticket/Display.html?id=131773</a></span> &gt;

Sure: <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/SQL::Statement#BUGS-AND-LIMITATIONS">https://metacpan.org/pod/SQL::Statement#BUGS-AND-LIMITATIONS</a></span>

5th item from top.

I agree, the reported error is misleading, but when sub-selects were detected correctly by the broken parser, executing them will be easy :&#41;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884684/1011257/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011257">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884687" href="/Public/Bug/Display.html?id=131773#txn-1884687">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;12:02:47&nbsp;2020</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884687/1011260/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011260">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Feb 13 11:56:00 2020, mark_robbins1@hotmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Jens,
&gt; 
&gt; thanks for the reply. I was caught out by the error message and I
&gt; didn&#39;t appreciate that the sub select was actually the problem.
</div>
Honestly - I don&#39;t know whether it&#39;s really the problem but it smells
heavily for it :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I saw there were references to developing version 2 which relied on a
&gt; BNF structure.
</div>
But - even if - not for Perl5. The future belongs to Raku.
If you would investigate and provide patches &#40;with tests!&#41;, I try to
find tuit to review and merge.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m guessing from the lack of releases that this is still on the back
&gt; burner.
&gt; 
&gt; Are there any plans to bring this work forward?
&gt; Do you have an estimate for how long it would take to write/complete
&gt; it?
</div>
It&#39;s not a tiny thing. And there is no project visible which could fund
such a development.

As a quick workaround, I suggest using temporary tables.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I know that working with BNF isn&#39;t a quick task - I studied it&#39;s use
&gt; for programming languages quite a long time ago.
&gt; 
&gt; I ask because I may have some funding available. If I can&#39;t get this
&gt; working then I would have to use a commercial solution and the current
&gt; commercial option is not implemented in Perl and it is potentally very
&gt; expensive.
</div>
I suggest ask on dbi-users@ when a temporary table isn&#39;t satisfying.

Best regards,
Jens
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884690" href="/Public/Bug/Display.html?id=131773#txn-1884690">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;12:24:17&nbsp;2020</span>
    <span class="description">mark_robbins1 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Dan [...] DWright.Org&#34; &lt;Dan [...] DWright.Org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #131773] Unable to process complex SQL statement with bracket before IN clause</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 13 Feb 2020 17:24:09 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-SQL-Statement [...] rt.cpan.org&#34; &lt;bug-SQL-Statement [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark R &lt;mark_robbins1 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884690/1011264/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011264">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 591b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jens,

Thanks for taking the time to have the conversation.
I work for a commercial organisation. we might have had money available to fund the development if it was closer to completion.

I wasn&#39;t able to use my work email because my competitors google for references to my company.

Thanks for the suggestion about the temporary tables. I can&#39;t do that because I am analysing code generated from a 3rd party system.

My aim was to use the code to check the SQL statement and identify the where clauses/tables. I could then use it to check the available indexes etc.

best regards,
Mark
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884690/1011265/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011265">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1884693" href="/Public/Bug/Display.html?id=131773#txn-1884693">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;12:31:38&nbsp;2020</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1884693/1011268/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1011268">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Feb 13 12:24:17 2020, mark_robbins1@hotmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Jens,
&gt; 
&gt; Thanks for taking the time to have the conversation.
&gt; I work for a commercial organisation. we might have had money
&gt; available to fund the development if it was closer to completion.
</div>
From time to time I have contracts where such a further development
is possible. It always requires a business case.
My current contract allows me to dig a bit deeper into Raku, so maybe
time will come ;&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I wasn&#39;t able to use my work email because my competitors google for
&gt; references to my company.
</div>
No worries ;&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for the suggestion about the temporary tables. I can&#39;t do that
&gt; because I am analysing code generated from a 3rd party system.
</div>
You could try to s,&#40;\&#40;select[^&#41;]*&#41;,subs1, and put $1 into a prepended
statement doing &#34;create temp table subs1 as $1&#34;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; My aim was to use the code to check the SQL statement and identify the
&gt; where clauses/tables. I could then use it to check the available
&gt; indexes etc.
&gt;
</div>
You just have to &#34;extract&#34; the sub-selects first.

Best regards,
Jens
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.478045</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
