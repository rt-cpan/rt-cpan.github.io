<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #17184 for CGI: Needs Test, Patch: file upload: param&#40;&#39;upfile&#39;&#41; returns file content instead of file name where there are quotes in the file name. </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #17184 for CGI: Needs Test, Patch: file upload: param&#40;&#39;upfile&#39;&#41; returns file content instead of file name where there are quotes in the file name. </h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CGI/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CGI/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CGI/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CGI/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/leejo/CGI.pm/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI">CGI CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">17184</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CGI/Active/">CGI</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
frank.fbi [...] web.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-230860-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-230861-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;20&nbsp;07:15:37&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> CGI.pm file upload: param&#40;&#39;upfile&#39;&#41; returns file content instead
 of file name</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I found the following:

If I try to upload a file that has a SEMICOLON [;] in its name,

- the upload fails
- the complete file content is returned via the param&#40;&#39;upfile&#39;&#41; call!!
  &#40;and tends to end up in a scalar that should usually hold the
   filename and serve as a filehandle&#41; 

I&#39;m using CGI.pm version 3.05 with Perl v5.8.6 and Apache 1.33 &#40;Darwin&#41;
under Mac OS X 10.4 on the server. Server and client are the same
machine. The problem does not occur with CGI.pm version 2.81 on a Linux
server and slightly different Apache version &#40;I don&#39;t know the exact
versions&#41; I also found the bug on the web! &#40;See below&#41;

It does not seem to be a browser or client os issue. Mozilla 1.7, IE for
Mac, and Safari all show the same effect. Same effect from a Windows
client with mozilla.

Here&#39;s the code - derived from <span class="clickylink"><a target="new" rel="nofollow" href="http://www.cgi101.com/book/ch14/upload.html">http://www.cgi101.com/book/ch14/upload.html</a></span>
Try to upload a small text file that has a semicolon in its name!

#################
#!/usr/bin/perl -wT
use CGI qw&#40;:standard&#41;;
use CGI::Carp qw&#40;fatalsToBrowser warningsToBrowser&#41;;
use strict;

print header;
print start_html&#40;&#34;Upload File&#34;&#41;;
print &#34;Using CGI.pm version: &#34;, $CGI::VERSION;
print h2&#40;&#34;Upload Results&#34;&#41;;

my $file = param&#40;&#39;upfile&#39;&#41;;
unless &#40; $file &#41; {
    # Build a simple file upload form
    print &#34;Nothing yet uploaded?&lt;p&gt;\n&#34;;
    print start_multipart_form;
    print &#39;Hint: Try a &#39;, strong&#40;&#39;small&#39;&#41;, &#39; file that as a semicolon
[;] in its name&#39;, br;
    print filefield&#40;&#39;upfile&#39;, &#39;&#39;, 45&#41;, br;
    print reset, submit&#40;&#39;submit&#39;,&#39;Start Upload&#39;&#41;;
    print endform;

} else {
    # Print infos
    # This might print the complete file content, without any html
encoding, to the browser!!
    print &#34;Filename: $file&lt;br&gt;\n&#34;;

    # CGI.pm saves a temporary file for us - check its name
    my $tmpfile=tmpFileName&#40;$file&#41;;
    print &#34;TempFile : $tmpfile&lt;br&gt;\n&#34;;

    # Using the &#34;filehandle&#34; that CGI.pm gave us: try to find filesize
    my $fsize = &#40;-s $file&#41; || 0;
    print &#34;File Size: $fsize Bytes&lt;br&gt;\n&#34;;

    # print the uploadInfo associative array
    my $finfo_ref;
    if &#40;defined &#40;$finfo_ref = uploadInfo&#40;$file&#41;&#41;&#41; {
        my $key;
        foreach $key &#40;keys %$finfo_ref&#41; {
            print $key, &#39; : &#39;, %{$finfo_ref}-&gt;{$key}, br, &#34;\n&#34;;
        }
    }
    
    print &#34;File saved!&lt;p&gt;\n&#34;;
}

print end_html;
#################


Other places to look at:

- The bug does NOT show up here:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.apache-asp.org/eg/file_upload.asp">http://www.apache-asp.org/eg/file_upload.asp</a></span>


- but it does here [2006/01/19]:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.cgi101.com/book/ch14/upload.html">http://www.cgi101.com/book/ch14/upload.html</a></span>

Good luck - and thanks anyway!!

Frank
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;01&nbsp;05:58:46&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 20 07:15:37 2006, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; I found the following:
&gt; 
&gt; If I try to upload a file that has a SEMICOLON [;] in its name,
&gt; 
&gt; - the upload fails
&gt; - the complete file content is returned via the param&#40;&#39;upfile&#39;&#41; 
</div>call!!
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   &#40;and tends to end up in a scalar that should usually hold the
&gt;    filename and serve as a filehandle&#41; 
&gt; 
&gt; I&#39;m using CGI.pm version 3.05 with Perl v5.8.6 and Apache 1.33 
</div>&#40;Darwin&#41;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; under Mac OS X 10.4 on the server. Server and client are the same
&gt; machine. The problem does not occur with CGI.pm version 2.81 on a 
</div>Linux
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; server and slightly different Apache version &#40;I don&#39;t know the exact
&gt; versions&#41; I also found the bug on the web! &#40;See below&#41;
&gt; 
&gt; It does not seem to be a browser or client os issue. Mozilla 1.7, IE 
</div>for
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Mac, and Safari all show the same effect. Same effect from a Windows
&gt; client with mozilla.
&gt; 
&gt; Here&#39;s the code - derived from 
</div><span class="clickylink"><a target="new" rel="nofollow" href="http://www.cgi101.com/book/ch14/upload.html">http://www.cgi101.com/book/ch14/upload.html</a></span>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Try to upload a small text file that has a semicolon in its name!
&gt; 
&gt; #################
&gt; #!/usr/bin/perl -wT
&gt; use CGI qw&#40;:standard&#41;;
&gt; use CGI::Carp qw&#40;fatalsToBrowser warningsToBrowser&#41;;
&gt; use strict;
&gt; 
&gt; print header;
&gt; print start_html&#40;&#34;Upload File&#34;&#41;;
&gt; print &#34;Using CGI.pm version: &#34;, $CGI::VERSION;
&gt; print h2&#40;&#34;Upload Results&#34;&#41;;
&gt; 
&gt; my $file = param&#40;&#39;upfile&#39;&#41;;
&gt; unless &#40; $file &#41; {
&gt;     # Build a simple file upload form
&gt;     print &#34;Nothing yet uploaded?&lt;p&gt;\n&#34;;
&gt;     print start_multipart_form;
&gt;     print &#39;Hint: Try a &#39;, strong&#40;&#39;small&#39;&#41;, &#39; file that as a semicolon
&gt; [;] in its name&#39;, br;
&gt;     print filefield&#40;&#39;upfile&#39;, &#39;&#39;, 45&#41;, br;
&gt;     print reset, submit&#40;&#39;submit&#39;,&#39;Start Upload&#39;&#41;;
&gt;     print endform;
&gt; 
&gt; } else {
&gt;     # Print infos
&gt;     # This might print the complete file content, without any html
&gt; encoding, to the browser!!
&gt;     print &#34;Filename: $file&lt;br&gt;\n&#34;;
&gt; 
&gt;     # CGI.pm saves a temporary file for us - check its name
&gt;     my $tmpfile=tmpFileName&#40;$file&#41;;
&gt;     print &#34;TempFile : $tmpfile&lt;br&gt;\n&#34;;
&gt; 
&gt;     # Using the &#34;filehandle&#34; that CGI.pm gave us: try to find 
</div>filesize
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     my $fsize = &#40;-s $file&#41; || 0;
&gt;     print &#34;File Size: $fsize Bytes&lt;br&gt;\n&#34;;
&gt; 
&gt;     # print the uploadInfo associative array
&gt;     my $finfo_ref;
&gt;     if &#40;defined &#40;$finfo_ref = uploadInfo&#40;$file&#41;&#41;&#41; {
&gt;       my $key;
&gt;       foreach $key &#40;keys %$finfo_ref&#41; {
&gt;           print $key, &#39; : &#39;, %{$finfo_ref}-&gt;{$key}, br, &#34;\n&#34;;
&gt;       }
&gt;     }
&gt;     
&gt;     print &#34;File saved!&lt;p&gt;\n&#34;;
&gt; }
&gt; 
&gt; print end_html;
&gt; #################
&gt; 
&gt; 
&gt; Other places to look at:
&gt; 
&gt; - The bug does NOT show up here:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.apache-asp.org/eg/file_upload.asp">http://www.apache-asp.org/eg/file_upload.asp</a></span>
&gt; 
&gt; 
&gt; - but it does here [2006/01/19]:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.cgi101.com/book/ch14/upload.html">http://www.cgi101.com/book/ch14/upload.html</a></span>
&gt; 
&gt; Good luck - and thanks anyway!!
&gt; 
&gt; Frank
&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;01&nbsp;05:58:47&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;11&nbsp;11:47:20&nbsp;2006</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 20 07:15:37 2006, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; I found the following:
&gt; 
&gt; If I try to upload a file that has a SEMICOLON [;] in its name,
&gt; 
&gt; - the upload fails
&gt; - the complete file content is returned via the param&#40;&#39;upfile&#39;&#41; call!!
&gt;   &#40;and tends to end up in a scalar that should usually hold the
&gt;    filename and serve as a filehandle&#41; 
&gt; 
&gt; I&#39;m using CGI.pm version 3.05 with Perl v5.8.6 and Apache 1.33 &#40;Darwin&#41;
&gt; under Mac OS X 10.4 on the server. Server and client are the same
&gt; machine. The problem does not occur with CGI.pm version 2.81 on a Linux
&gt; server and slightly different Apache version &#40;I don&#39;t know the exact
&gt; versions&#41; I also found the bug on the web! &#40;See below&#41;
&gt; 
&gt; It does not seem to be a browser or client os issue. Mozilla 1.7, IE for
&gt; Mac, and Safari all show the same effect. Same effect from a Windows
&gt; client with mozilla.
&gt; 
&gt; Here&#39;s the code - derived from <span class="clickylink"><a target="new" rel="nofollow" href="http://www.cgi101.com/book/ch14/upload.html">http://www.cgi101.com/book/ch14/upload.html</a></span>
&gt; Try to upload a small text file that has a semicolon in its name!
&gt; 
&gt; #################
&gt; #!/usr/bin/perl -wT
&gt; use CGI qw&#40;:standard&#41;;
&gt; use CGI::Carp qw&#40;fatalsToBrowser warningsToBrowser&#41;;
&gt; use strict;
&gt; 
&gt; print header;
&gt; print start_html&#40;&#34;Upload File&#34;&#41;;
&gt; print &#34;Using CGI.pm version: &#34;, $CGI::VERSION;
&gt; print h2&#40;&#34;Upload Results&#34;&#41;;
&gt; 
&gt; my $file = param&#40;&#39;upfile&#39;&#41;;
&gt; unless &#40; $file &#41; {
&gt;     # Build a simple file upload form
&gt;     print &#34;Nothing yet uploaded?&lt;p&gt;\n&#34;;
&gt;     print start_multipart_form;
&gt;     print &#39;Hint: Try a &#39;, strong&#40;&#39;small&#39;&#41;, &#39; file that as a semicolon
&gt; [;] in its name&#39;, br;
&gt;     print filefield&#40;&#39;upfile&#39;, &#39;&#39;, 45&#41;, br;
&gt;     print reset, submit&#40;&#39;submit&#39;,&#39;Start Upload&#39;&#41;;
&gt;     print endform;
&gt; 
&gt; } else {
&gt;     # Print infos
&gt;     # This might print the complete file content, without any html
&gt; encoding, to the browser!!
&gt;     print &#34;Filename: $file&lt;br&gt;\n&#34;;
&gt; 
&gt;     # CGI.pm saves a temporary file for us - check its name
&gt;     my $tmpfile=tmpFileName&#40;$file&#41;;
&gt;     print &#34;TempFile : $tmpfile&lt;br&gt;\n&#34;;
&gt; 
&gt;     # Using the &#34;filehandle&#34; that CGI.pm gave us: try to find filesize
&gt;     my $fsize = &#40;-s $file&#41; || 0;
&gt;     print &#34;File Size: $fsize Bytes&lt;br&gt;\n&#34;;
&gt; 
&gt;     # print the uploadInfo associative array
&gt;     my $finfo_ref;
&gt;     if &#40;defined &#40;$finfo_ref = uploadInfo&#40;$file&#41;&#41;&#41; {
&gt;       my $key;
&gt;       foreach $key &#40;keys %$finfo_ref&#41; {
&gt;           print $key, &#39; : &#39;, %{$finfo_ref}-&gt;{$key}, br, &#34;\n&#34;;
&gt;       }
&gt;     }
&gt;     
&gt;     print &#34;File saved!&lt;p&gt;\n&#34;;
&gt; }
&gt; 
&gt; print end_html;
&gt; #################
&gt; 
&gt; 
&gt; Other places to look at:
&gt; 
&gt; - The bug does NOT show up here:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.apache-asp.org/eg/file_upload.asp">http://www.apache-asp.org/eg/file_upload.asp</a></span>
&gt; 
&gt; 
&gt; - but it does here [2006/01/19]:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.cgi101.com/book/ch14/upload.html">http://www.cgi101.com/book/ch14/upload.html</a></span>
&gt; 
&gt; Good luck - and thanks anyway!!
</div>
I&#39;ll be submitting a test for this shortly that goes in &#34;t/upload.t&#34;.
The test passes with CGI.pm 3.25. 

Unless another test can be provided which reproduces this bug, I believe
this report can be marked as &#34;resolved&#34;. 

   Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;18&nbsp;06:45:47&nbsp;2006</span>
    <span class="description">bitcard [...] aithal.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] aithal.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ll be submitting a test for this shortly that goes in &#34;t/upload.t&#34;.
&gt; The test passes with CGI.pm 3.25. 
&gt; 
&gt; Unless another test can be provided which reproduces this bug, I believe
&gt; this report can be marked as &#34;resolved&#34;. 
&gt; 
</div>
I am seeing a very similar behaviour with upload&#40;&#41; not returning a
filehandle for the upload, and param&#40;&lt;filename&gt;&#41; returning the file
content. I&#39;m seeing it on:

  SuSE 9.3
  Apache 2.0.55
  mod_perl 2.0.2-1.1.20060119
  CGI 3.25

and

  CentOS 4
  mod_perl 2.0.3
  CGI 3.25

This doesn&#39;t seem to relate to the filename. The script is running under
mod_perl, with the following options:

  PerlOptions -ParseHeaders +GlobalRequest
  PerlResponseHandler ModPerl::Registry


Cheers
vittal
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;18&nbsp;10:26:53&nbsp;2006</span>
    <span class="description">bitcard [...] aithal.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] aithal.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Dec 18 06:45:47 2006, vittala wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &gt; I&#39;ll be submitting a test for this shortly that goes in &#34;t/upload.t&#34;.
&gt; &gt; The test passes with CGI.pm 3.25. 
&gt; &gt; 
&gt; &gt; Unless another test can be provided which reproduces this bug, I believe
&gt; &gt; this report can be marked as &#34;resolved&#34;. 
&gt; &gt; 
</div>
A bit more information. Downgrading to CGI 3.20 results in the expected
behaviour. 3.21 and 3.22 both fail due to the upload typo. 3.23 did not
return the upload filehandle.

cheers
vittal
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;17&nbsp;13:57:58&nbsp;2008</span>
    <span class="description">idallen [...] idallen.ca -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> idallen [...] idallen.ca</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">In CGI.pm-3.35 the semicolon problem is fixed for Web use and broken
for command-line use.  Semicolon characters used on the command line,
like this:

   $ ./cgipm filename=&#34;/abc;def&#34;

cause the filename parameter returned to be &#34;abc&#34; &#40;not &#34;abc;def&#34;&#41; and
create a spurious extra CGI paramater named &#34;def&#34;.  The script below
shows this.

The web parsing of filenames is still broken for filenames that contain
double-quote characters, e.g. names such as:   xx&#34;     &#34;yy&#34;      &#34;zz
If the files actually exist and contain content, the content will often
be returned instead of any parts of the file name.

Here&#39;s the sample script:

#!/usr/bin/perl -w
#
# CGI.pm-3.35
#
# If you run this script from a web browser &#40;Firefox&#41; and give file names
# with double-quote characters in them, CGI.pm mis-parses the names.  If the
# file doesn&#39;t exist, CGI.pm usually returns an empty name.  If the file
# exists and has content, CGI.pm may return the *content* as the file name!
#
# Running the script from the shell command line and passing in strings
# via filename=&#39;string&#39; also misbehaves.  A semicolon in the file name
# will create new CGI parameters instead of being part of the file name.
#
# Some names to enter into the filefield box, showing the problems:
#
#     /tmp/xx&#34;
#     /tmp/&#34;yy&#34;
#     /tmp/&#34;zz
#     /tmp/abc;def           # broken at the command line only

use strict;

use CGI qw/:standard/;

print header,
    start_html&#40;&#39;Bug parsing file names&#39;&#41;,
    h1&#40;&#39;Bug parsing file names&#39;&#41;,
    start_multipart_form&#40;&#41;,
    &#34;filename? &#34;,filefield&#40; &#39;-name&#39; =&gt; &#39;filename&#39;&#41;,
    submit,
    end_form,
    hr;

if &#40;param&#40;&#41;&#41; {
    my @a = param&#40;&#41;;
    print &#34;&lt;br&gt;params are: @a&#34;;
    my $filename = param&#40;&#39;filename&#39;&#41;;
    print &#34;&lt;br&gt;filename is: &#34;,escapeHTML&#40;$filename&#41;;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;25&nbsp;17:33:31&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Apr 17 13:57:58 2008, idallen@idallen.ca wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In CGI.pm-3.35 the semicolon problem is fixed for Web use and broken
&gt; for command-line use.  Semicolon characters used on the command line,
&gt; like this:
&gt; 
&gt;    $ ./cgipm filename=&#34;/abc;def&#34;
</div>
This is not a CGI.pm bug: The shell is terminating your command after
the semicolon. I&#39;ll bet you&#39;ll find that this works as expected:

$ ./cgipm &#39;filename=&#34;/abc;def&#34;&#39;

Regarding the file names with quotes in them. It would be great to have
an automated test for that, and I agree it should be patched. If you
would like to submit such a patch, that would be great. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;25&nbsp;17:34:23&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Subject changed from &#39;CGI.pm file upload: param&#40;&#39;upfile&#39;&#41; returns file content instead of file name&#39; to &#39;Needs Test, Patch: file upload: param&#40;&#39;upfile&#39;&#41; returns file content instead of file name where there are quotes in the file name. &#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;21:25:21&nbsp;2013</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Resolving due to lack of activity since 2009.

If you have a Test::More-style test case that reproduces the issue, or 
otherwise can still confirm it exists, feel free to re-open it. 

   Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;21:25:24&nbsp;2013</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;May&nbsp;23&nbsp;14:28:35&nbsp;2014</span>
    <span class="description">The RT System itself -  Queue changed from CGI.pm to CGI</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
