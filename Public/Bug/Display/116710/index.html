<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #116710 for Perl-PrereqScanner-NotQuiteLite: criteria for suggests vs requires?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #116710 for Perl-PrereqScanner-NotQuiteLite: criteria for suggests vs requires?</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Perl-PrereqScanner-NotQuiteLite">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Perl-PrereqScanner-NotQuiteLite">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Perl-PrereqScanner-NotQuiteLite">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Perl-PrereqScanner-NotQuiteLite">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-PrereqScanner-NotQuiteLite">Perl-PrereqScanner-NotQuiteLite CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">116710</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Perl-PrereqScanner-NotQuiteLite">Perl-PrereqScanner-NotQuiteLite</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
PERLANCAR [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Unimportant    </td>
  </tr>
  <tr id="CF-260362-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-260363-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=116710">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1655652" href="/Public/Bug/Display.html?id=116710#txn-1655652">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;04&nbsp;04:00:08&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> criteria for suggests vs requires?</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1655652/888566/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/888566">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 604b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I haven&#39;t looked at the code, but scanning against the lib/ of my repo <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-App-LintPrereqs">https://github.com/perlancar/perl-App-LintPrereqs</a></span> results in these requirements as being &#39;suggests&#39;:

    Perl::PrereqScanner
    Perl::PrereqScanner::Lite
    Perl::PrereqScanner::NotQuiteLite

While it is true that these modules are &#39;require&#39;d inside an if block, Perl::PrereqScanner is actually a requires because it is the default choice in the application.

So, what is the criteria for a module being in the &#39;suggests&#39; requirements vs in &#39;requires&#39;? It looks like anything inside an if block is categorized as &#39;suggests&#39;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1655874" href="/Public/Bug/Display.html?id=116710#txn-1655874">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;05&nbsp;00:36:13&nbsp;2016</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1655874/888689/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/888689">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Aug 04 17:00:08 2016, PERLANCAR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; I haven&#39;t looked at the code, but scanning against the lib/ of my repo
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-App-LintPrereqs">https://github.com/perlancar/perl-App-LintPrereqs</a></span> results in these
&gt; requirements as being &#39;suggests&#39;:
&gt; 
&gt; Perl::PrereqScanner
&gt; Perl::PrereqScanner::Lite
&gt; Perl::PrereqScanner::NotQuiteLite
&gt; 
&gt; While it is true that these modules are &#39;require&#39;d inside an if block,
&gt; Perl::PrereqScanner is actually a requires because it is the default
&gt; choice in the application.
&gt; 
&gt; So, what is the criteria for a module being in the &#39;suggests&#39;
&gt; requirements vs in &#39;requires&#39;? It looks like anything inside an if
&gt; block is categorized as &#39;suggests&#39;.
</div>
Hi. I&#39;m supposing you&#39;re using one of the recent versions of Perl::PrereqScanner::NotQuiteLite. If not, ignore most of the following.

As CPAN::Meta::Spec says, &#34;requires&#34; is for modules that *must* be installed for proper completion of the phase. In your case, none of the Perl::PrereqScanner&#40;::*&#41; modules are necessary. So, they are not for &#34;requires&#34;, but &#34;recommends&#34;. In other words, &#34;requires&#34; is for modules that are &#34;use&#34;d &#40;or &#34;no&#34;ed&#41; outside &#34;eval&#34;.

&#34;suggests&#34; is mainly for modules that are &#34;use&#34;d &#40;or &#34;require&#34;d or &#34;no&#34;ed&#41; inside &#34;eval&#34;. They are optional, and nothing should break if they are not installed.

&#34;recommends&#34; is mainly for modules that are &#34;require&#34;d somewhere in a block. It is not always necessary &#40;because the block may not be executed, depending on conditions&#41;, but if the block is executed, those modules are necessary, so we recommend to install them beforehand &#40;if they are installable&#41;.

Modules that are &#34;require&#34;d outside a block should *probably* be considered &#34;requires&#34;, because they will always be required, if there&#39;s no &#34;exit&#34; or equivalents before them. If &#34;exit&#34; is found, those modules should be considered &#34;recommends&#34;. &#40;However, this last bit is not implemented yet, and 0.49_01/02 didn&#39;t have &#34;recommends&#34; and merged all the optional requirements into &#34;suggests&#34;.&#41;

So, back to your case. Because all the Perl::PrereqScanner modules are &#34;require&#34;d in a block, they are considered &#34;recommends&#34;, at least from the scanner&#39;s point of view. You can upgrade some of them to &#34;requires&#34; manually, even if your app actually runs without them &#40;by passing an option&#41;.

Is there anything that I have overlooked?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1655875" href="/Public/Bug/Display.html?id=116710#txn-1655875">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;05&nbsp;00:36:13&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1656555" href="/Public/Bug/Display.html?id=116710#txn-1656555">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;07&nbsp;12:35:41&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1656555/889078/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/889078">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 5 Aug 2016 04:36:13 GMT, ISHIGAKI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Aug 04 17:00:08 2016, PERLANCAR wrote:
<div class="message-stanza open">&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I haven&#39;t looked at the code, but scanning against the lib/ of my
&gt; &gt; repo
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-App-LintPrereqs">https://github.com/perlancar/perl-App-LintPrereqs</a></span> results in these
&gt; &gt; requirements as being &#39;suggests&#39;:
&gt; &gt;
&gt; &gt; Perl::PrereqScanner
&gt; &gt; Perl::PrereqScanner::Lite
&gt; &gt; Perl::PrereqScanner::NotQuiteLite
&gt; &gt;
&gt; &gt; While it is true that these modules are &#39;require&#39;d inside an if
&gt; &gt; block,
&gt; &gt; Perl::PrereqScanner is actually a requires because it is the default
&gt; &gt; choice in the application.
&gt; &gt;
&gt; &gt; So, what is the criteria for a module being in the &#39;suggests&#39;
&gt; &gt; requirements vs in &#39;requires&#39;? It looks like anything inside an if
&gt; &gt; block is categorized as &#39;suggests&#39;.
</div>&gt; 
&gt; Hi. I&#39;m supposing you&#39;re using one of the recent versions of
&gt; Perl::PrereqScanner::NotQuiteLite. If not, ignore most of the
&gt; following.
&gt; 
&gt; As CPAN::Meta::Spec says, &#34;requires&#34; is for modules that *must* be
&gt; installed for proper completion of the phase. In your case, none of
&gt; the Perl::PrereqScanner&#40;::*&#41; modules are necessary. So, they are not
&gt; for &#34;requires&#34;, but &#34;recommends&#34;. In other words, &#34;requires&#34; is for
&gt; modules that are &#34;use&#34;d &#40;or &#34;no&#34;ed&#41; outside &#34;eval&#34;.
&gt; 
&gt; &#34;suggests&#34; is mainly for modules that are &#34;use&#34;d &#40;or &#34;require&#34;d or
&gt; &#34;no&#34;ed&#41; inside &#34;eval&#34;. They are optional, and nothing should break if
&gt; they are not installed.
&gt; 
&gt; &#34;recommends&#34; is mainly for modules that are &#34;require&#34;d somewhere in a
&gt; block. It is not always necessary &#40;because the block may not be
&gt; executed, depending on conditions&#41;, but if the block is executed,
&gt; those modules are necessary, so we recommend to install them
&gt; beforehand &#40;if they are installable&#41;.
&gt; 
&gt; Modules that are &#34;require&#34;d outside a block should *probably* be
&gt; considered &#34;requires&#34;, because they will always be required, if
&gt; there&#39;s no &#34;exit&#34; or equivalents before them. If &#34;exit&#34; is found,
&gt; those modules should be considered &#34;recommends&#34;. &#40;However, this last
&gt; bit is not implemented yet, and 0.49_01/02 didn&#39;t have &#34;recommends&#34;
&gt; and merged all the optional requirements into &#34;suggests&#34;.&#41;
&gt; 
&gt; So, back to your case. Because all the Perl::PrereqScanner modules are
&gt; &#34;require&#34;d in a block, they are considered &#34;recommends&#34;, at least from
&gt; the scanner&#39;s point of view. You can upgrade some of them to
&gt; &#34;requires&#34; manually, even if your app actually runs without them &#40;by
&gt; passing an option&#41;.
&gt; 
&gt; Is there anything that I have overlooked?
</div>
Yes, I tried 0.49_02.

When I read CPAN::Meta::Spec, I don&#39;t see any of the above statements about &#34;suggests == inside eval&#34;, &#34;recommends == inside block&#34;. It only says:

    requires
               These dependencies must be installed for proper completion of the phase.

           recommends
               Recommended dependencies are strongly encouraged and should be satisfied except in resource constrained environments.

           suggests
               These dependencies are optional, but are suggested for enhanced operation of the described distribution.

Anyway, you are of course free to interpret this anyway you want. But consider my case:

    $option{scanner} //= &#39;regular&#39;; # the default scanner, if user doesn&#39;t specify --scanner option
    if &#40;$option{scanner} eq &#39;lite&#39;&#41; {
        require Perl::PrereqScanner::Lite;
        $scanner = Perl::PrereqScanner::Lite-&gt;new&#40;...&#41;;
    } elsif &#40;$option{scanner} eq &#39;nqlite&#39;&#41; {
        require Perl::PrereqScanner::NotQuiteLite;
        $scanner = Perl::PrereqScanner::NotQuiteLite-&gt;new&#40;...&#41;;
    } else {
        require Perl::PrereqScanner;
        $scanner = Perl::PrereqScanner-&gt;new&#40;...&#41;;
    }

In this case, *at least one* of the scanner modules is required. The application needs a scanner to function. And in this case, I would argue that Perl::PrereqScanner is a requires. 

Perhaps, you can make modules required inside an else block as requires? But I also think this assumes a bit much and might fail in weird cases.

All in all, I think it&#39;s nice that you try to guess requires vs recommends vs suggests, but I suspect this will a non-negligible rate of false positives/negatives. In my App::LintPrereqs BTW, I currently lump the results from requires/suggests &#40;and recommends&#41; as simply requires/prereqs &#40;the categorization comes manually from dist.ini&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1656558" href="/Public/Bug/Display.html?id=116710#txn-1656558">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;07&nbsp;12:36:01&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1656558/889081/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/889081">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 5 Aug 2016 04:36:13 GMT, ISHIGAKI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Aug 04 17:00:08 2016, PERLANCAR wrote:
<div class="message-stanza open">&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I haven&#39;t looked at the code, but scanning against the lib/ of my
&gt; &gt; repo
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-App-LintPrereqs">https://github.com/perlancar/perl-App-LintPrereqs</a></span> results in these
&gt; &gt; requirements as being &#39;suggests&#39;:
&gt; &gt;
&gt; &gt; Perl::PrereqScanner
&gt; &gt; Perl::PrereqScanner::Lite
&gt; &gt; Perl::PrereqScanner::NotQuiteLite
&gt; &gt;
&gt; &gt; While it is true that these modules are &#39;require&#39;d inside an if
&gt; &gt; block,
&gt; &gt; Perl::PrereqScanner is actually a requires because it is the default
&gt; &gt; choice in the application.
&gt; &gt;
&gt; &gt; So, what is the criteria for a module being in the &#39;suggests&#39;
&gt; &gt; requirements vs in &#39;requires&#39;? It looks like anything inside an if
&gt; &gt; block is categorized as &#39;suggests&#39;.
</div>&gt; 
&gt; Hi. I&#39;m supposing you&#39;re using one of the recent versions of
&gt; Perl::PrereqScanner::NotQuiteLite. If not, ignore most of the
&gt; following.
&gt; 
&gt; As CPAN::Meta::Spec says, &#34;requires&#34; is for modules that *must* be
&gt; installed for proper completion of the phase. In your case, none of
&gt; the Perl::PrereqScanner&#40;::*&#41; modules are necessary. So, they are not
&gt; for &#34;requires&#34;, but &#34;recommends&#34;. In other words, &#34;requires&#34; is for
&gt; modules that are &#34;use&#34;d &#40;or &#34;no&#34;ed&#41; outside &#34;eval&#34;.
&gt; 
&gt; &#34;suggests&#34; is mainly for modules that are &#34;use&#34;d &#40;or &#34;require&#34;d or
&gt; &#34;no&#34;ed&#41; inside &#34;eval&#34;. They are optional, and nothing should break if
&gt; they are not installed.
&gt; 
&gt; &#34;recommends&#34; is mainly for modules that are &#34;require&#34;d somewhere in a
&gt; block. It is not always necessary &#40;because the block may not be
&gt; executed, depending on conditions&#41;, but if the block is executed,
&gt; those modules are necessary, so we recommend to install them
&gt; beforehand &#40;if they are installable&#41;.
&gt; 
&gt; Modules that are &#34;require&#34;d outside a block should *probably* be
&gt; considered &#34;requires&#34;, because they will always be required, if
&gt; there&#39;s no &#34;exit&#34; or equivalents before them. If &#34;exit&#34; is found,
&gt; those modules should be considered &#34;recommends&#34;. &#40;However, this last
&gt; bit is not implemented yet, and 0.49_01/02 didn&#39;t have &#34;recommends&#34;
&gt; and merged all the optional requirements into &#34;suggests&#34;.&#41;
&gt; 
&gt; So, back to your case. Because all the Perl::PrereqScanner modules are
&gt; &#34;require&#34;d in a block, they are considered &#34;recommends&#34;, at least from
&gt; the scanner&#39;s point of view. You can upgrade some of them to
&gt; &#34;requires&#34; manually, even if your app actually runs without them &#40;by
&gt; passing an option&#41;.
&gt; 
&gt; Is there anything that I have overlooked?
</div>
Yes, I tried 0.49_02.

When I read CPAN::Meta::Spec, I don&#39;t see any of the above statements about &#34;suggests == inside eval&#34;, &#34;recommends == inside block&#34;. It only says:

    requires
               These dependencies must be installed for proper completion of the phase.

           recommends
               Recommended dependencies are strongly encouraged and should be satisfied except in resource constrained environments.

           suggests
               These dependencies are optional, but are suggested for enhanced operation of the described distribution.

Anyway, you are of course free to interpret this anyway you want. But consider my case:

    $option{scanner} //= &#39;regular&#39;; # the default scanner, if user doesn&#39;t specify --scanner option
    if &#40;$option{scanner} eq &#39;lite&#39;&#41; {
        require Perl::PrereqScanner::Lite;
        $scanner = Perl::PrereqScanner::Lite-&gt;new&#40;...&#41;;
    } elsif &#40;$option{scanner} eq &#39;nqlite&#39;&#41; {
        require Perl::PrereqScanner::NotQuiteLite;
        $scanner = Perl::PrereqScanner::NotQuiteLite-&gt;new&#40;...&#41;;
    } else {
        require Perl::PrereqScanner;
        $scanner = Perl::PrereqScanner-&gt;new&#40;...&#41;;
    }

In this case, *at least one* of the scanner modules is required. The application needs a scanner to function. And in this case, I would argue that Perl::PrereqScanner is a requires. 

Perhaps, you can make modules required inside an else block as requires? But I also think this assumes a bit much and might fail in weird cases.

All in all, I think it&#39;s nice that you try to guess requires vs recommends vs suggests, but I suspect this will a non-negligible rate of false positives/negatives. In my App::LintPrereqs BTW, I currently lump the results from requires/suggests &#40;and recommends&#41; as simply requires/prereqs &#40;the categorization comes manually from dist.ini&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1656612" href="/Public/Bug/Display.html?id=116710#txn-1656612">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;07&nbsp;15:17:49&nbsp;2016</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1656612/889110/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/889110">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 08 01:36:01 2016, PERLANCAR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri, 5 Aug 2016 04:36:13 GMT, ISHIGAKI wrote:
<div class="message-stanza open">&gt; &gt; On Thu Aug 04 17:00:08 2016, PERLANCAR wrote:
<div class="message-stanza open">&gt; &gt; &gt; Hi,
&gt; &gt; &gt;
&gt; &gt; &gt; I haven&#39;t looked at the code, but scanning against the lib/ of my
&gt; &gt; &gt; repo
&gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-App-LintPrereqs">https://github.com/perlancar/perl-App-LintPrereqs</a></span> results in these
&gt; &gt; &gt; requirements as being &#39;suggests&#39;:
&gt; &gt; &gt;
&gt; &gt; &gt; Perl::PrereqScanner
&gt; &gt; &gt; Perl::PrereqScanner::Lite
&gt; &gt; &gt; Perl::PrereqScanner::NotQuiteLite
&gt; &gt; &gt;
&gt; &gt; &gt; While it is true that these modules are &#39;require&#39;d inside an if
&gt; &gt; &gt; block,
&gt; &gt; &gt; Perl::PrereqScanner is actually a requires because it is the
&gt; &gt; &gt; default
&gt; &gt; &gt; choice in the application.
&gt; &gt; &gt;
&gt; &gt; &gt; So, what is the criteria for a module being in the &#39;suggests&#39;
&gt; &gt; &gt; requirements vs in &#39;requires&#39;? It looks like anything inside an if
&gt; &gt; &gt; block is categorized as &#39;suggests&#39;.
</div>&gt; &gt;
&gt; &gt; Hi. I&#39;m supposing you&#39;re using one of the recent versions of
&gt; &gt; Perl::PrereqScanner::NotQuiteLite. If not, ignore most of the
&gt; &gt; following.
&gt; &gt;
&gt; &gt; As CPAN::Meta::Spec says, &#34;requires&#34; is for modules that *must* be
&gt; &gt; installed for proper completion of the phase. In your case, none of
&gt; &gt; the Perl::PrereqScanner&#40;::*&#41; modules are necessary. So, they are not
&gt; &gt; for &#34;requires&#34;, but &#34;recommends&#34;. In other words, &#34;requires&#34; is for
&gt; &gt; modules that are &#34;use&#34;d &#40;or &#34;no&#34;ed&#41; outside &#34;eval&#34;.
&gt; &gt;
&gt; &gt; &#34;suggests&#34; is mainly for modules that are &#34;use&#34;d &#40;or &#34;require&#34;d or
&gt; &gt; &#34;no&#34;ed&#41; inside &#34;eval&#34;. They are optional, and nothing should break if
&gt; &gt; they are not installed.
&gt; &gt;
&gt; &gt; &#34;recommends&#34; is mainly for modules that are &#34;require&#34;d somewhere in a
&gt; &gt; block. It is not always necessary &#40;because the block may not be
&gt; &gt; executed, depending on conditions&#41;, but if the block is executed,
&gt; &gt; those modules are necessary, so we recommend to install them
&gt; &gt; beforehand &#40;if they are installable&#41;.
&gt; &gt;
&gt; &gt; Modules that are &#34;require&#34;d outside a block should *probably* be
&gt; &gt; considered &#34;requires&#34;, because they will always be required, if
&gt; &gt; there&#39;s no &#34;exit&#34; or equivalents before them. If &#34;exit&#34; is found,
&gt; &gt; those modules should be considered &#34;recommends&#34;. &#40;However, this last
&gt; &gt; bit is not implemented yet, and 0.49_01/02 didn&#39;t have &#34;recommends&#34;
&gt; &gt; and merged all the optional requirements into &#34;suggests&#34;.&#41;
&gt; &gt;
&gt; &gt; So, back to your case. Because all the Perl::PrereqScanner modules
&gt; &gt; are
&gt; &gt; &#34;require&#34;d in a block, they are considered &#34;recommends&#34;, at least
&gt; &gt; from
&gt; &gt; the scanner&#39;s point of view. You can upgrade some of them to
&gt; &gt; &#34;requires&#34; manually, even if your app actually runs without them &#40;by
&gt; &gt; passing an option&#41;.
&gt; &gt;
&gt; &gt; Is there anything that I have overlooked?
</div>&gt; 
&gt; Yes, I tried 0.49_02.
&gt; 
&gt; When I read CPAN::Meta::Spec, I don&#39;t see any of the above statements
&gt; about &#34;suggests == inside eval&#34;, &#34;recommends == inside block&#34;. It only
&gt; says:
&gt; 
&gt; requires
&gt;            These dependencies must be installed for proper completion
&gt; of the phase.
&gt; 
&gt; recommends
&gt;     Recommended dependencies are strongly encouraged and should be
&gt; satisfied except in resource constrained environments.
&gt; 
&gt; suggests
&gt;     These dependencies are optional, but are suggested for enhanced
&gt; operation of the described distribution.
&gt; 
&gt; Anyway, you are of course free to interpret this anyway you want. But
&gt; consider my case:
&gt; 
&gt; $option{scanner} //= &#39;regular&#39;; # the default scanner, if user doesn&#39;t
&gt; specify --scanner option
&gt; if &#40;$option{scanner} eq &#39;lite&#39;&#41; {
&gt;     require Perl::PrereqScanner::Lite;
&gt;     $scanner = Perl::PrereqScanner::Lite-&gt;new&#40;...&#41;;
&gt; } elsif &#40;$option{scanner} eq &#39;nqlite&#39;&#41; {
&gt;     require Perl::PrereqScanner::NotQuiteLite;
&gt;     $scanner = Perl::PrereqScanner::NotQuiteLite-&gt;new&#40;...&#41;;
&gt; } else {
&gt;     require Perl::PrereqScanner;
&gt;     $scanner = Perl::PrereqScanner-&gt;new&#40;...&#41;;
&gt; }
&gt; 
&gt; In this case, *at least one* of the scanner modules is required. The
&gt; application needs a scanner to function. And in this case, I would
&gt; argue that Perl::PrereqScanner is a requires.
&gt; 
&gt; Perhaps, you can make modules required inside an else block as
&gt; requires? But I also think this assumes a bit much and might fail in
&gt; weird cases.
</div>
No, it doesn&#39;t make sense. Consider the following case:

if &#40;$^O eq &#39;MSWin32&#39;&#41; { require &#39;Module::For::Win32&#39; }
else { require &#39;Module::For::Others::Which::Doesnt::Install::Under::Win32&#39; }

If we make the one in the else block &#34;requires&#34;, most probably Win32 users wouldn&#39;t be able to install your module. Don&#39;t call this a weird case :&#41;

Your suggestion works only in your case. So, it&#39;s you &#40;or your tool&#41; that should change the scanned result manually to reflect your opinion; not a neutral scanner which only cares if a module is loaded in a BEGIN phase or not &#40;if it&#39;s loaded in a BEGIN phase, it won&#39;t be affected by a normal &#39;if&#39;s, thus it&#39;ll be unconditionally loaded = &#34;requires&#34;; otherwise, it should be &#34;recommends&#34; or &#34;suggests&#34;&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; All in all, I think it&#39;s nice that you try to guess requires vs
&gt; recommends vs suggests, but I suspect this will a non-negligible rate
&gt; of false positives/negatives. In my App::LintPrereqs BTW, I currently
&gt; lump the results from requires/suggests &#40;and recommends&#41; as simply
&gt; requires/prereqs &#40;the categorization comes manually from dist.ini&#41;.
</div>
Your tool is written from a different point of view, so it&#39;s fine if your tool changes the phase/severity to your taste. More is better for you, but less is better for this module, whose main purpose is to test prereqs that may or may not be generated by other tools like yours.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1701162" href="/Public/Bug/Display.html?id=116710#txn-1701162">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;28&nbsp;01:36:26&nbsp;2017</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1701162/913628/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/913628">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 15b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Closed. Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1701164" href="/Public/Bug/Display.html?id=116710#txn-1701164">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;28&nbsp;01:36:27&nbsp;2017</span>
    <span class="description">ishigaki [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.428306</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
