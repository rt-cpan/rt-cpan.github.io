<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #84600 for Perl-Dist-Strawberry: Socket::inet_pton&#40;&#41; not implemented</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #84600 for Perl-Dist-Strawberry: Socket::inet_pton&#40;&#41; not implemented</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Perl-Dist-Strawberry">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Perl-Dist-Strawberry">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Perl-Dist-Strawberry">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Perl-Dist-Strawberry">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Dist-Strawberry">Perl-Dist-Strawberry CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">84600</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Perl-Dist-Strawberry">Perl-Dist-Strawberry</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
leonerd-cpan [...] leonerd.org.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40214-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40215-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




socket.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1874862/1006352/socket.patch">
Sat Dec 14 12:11:54 2019 (1k) by DiablosOffens [...] gmx.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=84600">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1201375" href="/Public/Bug/Display.html?id=84600#txn-1201375">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;12&nbsp;15:58:30&nbsp;2013</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Socket::inet_pton&#40;&#41; not implemented</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1201375/634278/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634278">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 697b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It appears that Socket on Strawberry does not implement inet_pton. As evidenced by

  <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=83485">https://rt.cpan.org/Ticket/Display.html?id=83485</a></span>

Specifically:

  t\04local-client-v6.t ............... Socket::inet_pton not implemented on this architecture at t\04local-client-v6.t line 26.

I expect this will be resolved by something in Socket.xs, for which I am the current maintainer, but as I lack any real MSWin32 experience I&#39;ve no idea really what sort of trickery might be required.

Oddly, while inet_pton&#40;&#41; is missing, the fact that the rest of the test suite runs OK means that getaddrinfo&#40;&#41; and getnameinfo&#40;&#41; are both present. So I find this ommission a little hard to work out.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1201382" href="/Public/Bug/Display.html?id=84600#txn-1201382">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;12&nbsp;16:22:25&nbsp;2013</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1201382/634285/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634285">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 179b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Actually I believe the answer may lie in:

$ perl -MConfig -E &#39;say $Config{d_inetpton}&#39;
define

Strawberry ought to claim &#39;define&#39; there too, rather than &#39;undef&#39;.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1201388" href="/Public/Bug/Display.html?id=84600#txn-1201388">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;12&nbsp;16:50:36&nbsp;2013</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1201388/634289/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634289">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 331b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I believe the lines are

  <span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l271">http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l271</a></span>
  <span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l272">http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l272</a></span>
  <span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l273">http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l273</a></span>

I think they should just be set to &#34;define&#34; and hopefully all will come out well.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1204236" href="/Public/Bug/Display.html?id=84600#txn-1204236">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;21&nbsp;17:45:41&nbsp;2013</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84600] Socket::inet_pton&#40;&#41; not implemented</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 21 Apr 2013 23:45:14 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1204236/635856/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/635856">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 795b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 12.4.2013 22:50, Paul Evans via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         Queue: Perl-Dist-Strawberry
&gt;   Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=84600">https://rt.cpan.org/Ticket/Display.html?id=84600</a></span> &gt;
&gt;
&gt; I believe the lines are
&gt;
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l271">http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l271</a></span>
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l272">http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l272</a></span>
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l273">http://perl5.git.perl.org/perl.git/blob/HEAD:/win32/config.gc#l273</a></span>
&gt;
&gt; I think they should just be set to &#34;define&#34; and hopefully all will come out well.
&gt;
</div>
OK, I will set

d_inetaton=&#39;define&#39;
d_inetntop=&#39;define&#39;
d_inetpton=&#39;define&#39;

but keep in mind that these values are simply hardcoded &#40;not a result of 
any detection&#41;. I am not sure how will Socket handle older platforms 
&#40;Windows XP&#41; without inet_pton &#40;which is available afaik since Windows Vista&#41;.

--
kmx
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1204237" href="/Public/Bug/Display.html?id=84600#txn-1204237">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;21&nbsp;17:45:41&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1211003" href="/Public/Bug/Display.html?id=84600#txn-1211003">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;12&nbsp;11:35:56&nbsp;2013</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1211003/639524/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/639524">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza">unfortunately after setting:<br>

<br>

d_inetaton=&#39;define&#39;<br>

d_inetntop=&#39;define&#39;<br>

d_inetpton=&#39;define&#39;<br>

<br>

I was not able to build perl-5.18.0.-RC1<br>

<br>

Making all in cpan/Socket<br>

&nbsp;dmake -S all PERL_CORE=1<br>

cp Socket.pm ..\..\lib\Socket.pm<br>

..\..\miniperl.exe &quot;-I..\..\lib&quot; &quot;-I..\..\lib&quot; ..\..\lib\ExtUtils\xsubpp -noprototypes -typemap ..\..\lib\ExtUtils\typemap -typemap typemap&nbsp; Socket.xs &gt; Socket.<br>

xsc &amp;&amp; C:\strawberry_build\build\perl_core\perl-5.18.0-RC1\miniperl.exe &quot;-I..\..\lib&quot; &quot;-I..\..\lib&quot; -MExtUtils::Command -e mv -- Socket.xsc Socket.c<br>

gcc -c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fno-strict-aliasing -mms<br>

-bitfields -s -O2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DVERSION=\&quot;2.009\&quot;&nbsp;&nbsp; -DXS_VERSION=\&quot;2.009\&quot;&nbsp; &quot;-I..\..\lib\CORE&quot;&nbsp;&nbsp; Socket.c<br>

Socket.xs: In function &#39;XS_Socket_pack_sockaddr_un&#39;:<br>

Socket.xs:702:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]<br>

Socket.xs: In function &#39;XS_Socket_unpack_sockaddr_un&#39;:<br>

Socket.xs:748:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]<br>

Socket.xs: In function &#39;XS_Socket_pack_sockaddr_in6&#39;:<br>

Socket.xs:850:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]<br>

Socket.xs: In function &#39;XS_Socket_unpack_sockaddr_in6&#39;:<br>

Socket.xs:888:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]<br>

Running Mkbootstrap for Socket ()<br>

C:\strawberry_build\build\perl_core\perl-5.18.0-RC1\miniperl.exe &quot;-I..\..\lib&quot; &quot;-I..\..\lib&quot; -MExtUtils::Command -e chmod -- 644 Socket.bs<br>

..\..\miniperl.exe &quot;-I..\..\lib&quot; &quot;-I..\..\lib&quot; -MExtUtils::Mksymlists \<br>

&nbsp;&nbsp;&nbsp;&nbsp; -e &quot;Mksymlists(&#39;NAME&#39;=&gt;\&quot;Socket\&quot;, &#39;DLBASE&#39; =&gt; &#39;Socket&#39;, &#39;DL_FUNCS&#39; =&gt; {&nbsp; }, &#39;FUNCLIST&#39; =&gt; [], &#39;IMPORTS&#39; =&gt; {&nbsp; }, &#39;DL_VARS&#39; =&gt; []);&quot;<br>

dlltool --def Socket.def --output-exp dll.exp<br>

g++ -o ..\..\lib\auto\Socket\Socket.dll -Wl,--base-file -Wl,dll.base -mdll -s -L&quot;C:\strawberry\perl\lib\CORE&quot; -L&quot;C:\strawberry\c\lib&quot; Socket.o&nbsp;&nbsp; ..\..\lib\CORE\<br>

libperl518.a -lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lver<br>

sion -lodbc32 -lodbccp32 -lcomctl32 dll.exp<br>

Socket.o:Socket.c:(.text+0x1109): undefined reference to `inet_aton&#39;<br>

collect2: ld returned 1 exit status<br>

dmake:&nbsp; Error code 129, while making &#39;..\..\lib\auto\Socket\Socket.dll&#39;<br>

Unsuccessful make(cpan/Socket): code=65280 at ..\make_ext.pl line 490.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1276150" href="/Public/Bug/Display.html?id=84600#txn-1276150">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;17&nbsp;10:06:56&nbsp;2013</span>
    <span class="description">WolfSage [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1276150/676049/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/676049">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Apr 12 15:58:30 2013, PEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It appears that Socket on Strawberry does not implement inet_pton. As
&gt; evidenced by
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=83485">https://rt.cpan.org/Ticket/Display.html?id=83485</a></span>
&gt; 
&gt; Specifically:
&gt; 
&gt; t\04local-client-v6.t ............... Socket::inet_pton not
&gt; implemented on this architecture at t\04local-client-v6.t line 26.
&gt; 
&gt; I expect this will be resolved by something in Socket.xs, for which I
&gt; am the current maintainer, but as I lack any real MSWin32 experience
&gt; I&#39;ve no idea really what sort of trickery might be required.
&gt; 
&gt; Oddly, while inet_pton&#40;&#41; is missing, the fact that the rest of the
&gt; test suite runs OK means that getaddrinfo&#40;&#41; and getnameinfo&#40;&#41; are both
&gt; present. So I find this ommission a little hard to work out.
</div>
So the fun thing is, that getaddrinfo&#40;&#41; and getnameinfo&#40;&#41; are implemented as you&#39;d expect:

<span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms738520%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms738520%28v=vs.85%29.aspx</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms738532%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/ms738532%28v=vs.85%29.aspx</a></span>

But inet_pton is implemented as InetPton:

<span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc805844%28v=vs.85%29.aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/cc805844%28v=vs.85%29.aspx</a></span>

Though it&#39;s only available in Windows Vista and later.

So it sounds like for greater compatibility we could do two things:

 * Detect availability of InetPton on Windows and use it, barring that
 * Include our own implementation of inet_pton &#40;like my_inet_aton&#41;

-- Matthew Horsfall &#40;alh&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1276243" href="/Public/Bug/Display.html?id=84600#txn-1276243">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;17&nbsp;17:41:24&nbsp;2013</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1276243/676095/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/676095">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 833b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Oct 17 10:06:56 2013, WOLFSAGE wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But inet_pton is implemented as InetPton:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-">http://msdn.microsoft.com/en-</a></span>
&gt; us/library/windows/desktop/cc805844%28v=vs.85%29.aspx
</div>
I&#39;m not quite sure I follow what that page is saying. It briefly mentions:

  The ANSI version of this function is inet_pton.

  Unicode and ANSI names
        InetPtonW &#40;Unicode&#41; and InetPtonA or inet_pton &#40;ANSI&#41;

But I don&#39;t truely follow the implications of those comments. Does that mean that the function is available under that name, or simply that &#34;ANSI says this function this this name but we&#39;ve decided to name it differently&#34;?

If it&#39;s the former, then surely it should work? If it&#39;s the latter, then maybe just a #define or similar should bring it into line?

What happens if we simply

  #define inet_pton  InetPtonA

on Windows?

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1437445" href="/Public/Bug/Display.html?id=84600#txn-1437445">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;29&nbsp;11:16:50&nbsp;2014</span>
    <span class="description">shay [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1437445/764160/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/764160">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have a similar issue, but with inet_ntop&#40;&#41;. On Windows my perl &#40;built myself with VC++ 2010&#41; reports &#34;Socket::inet_ntop not implemented on this architecture&#34;, which is breaking HTTP::Server::Simple &#40;and therefore Dancer too&#41;.

There are several things going on here...

Firstly, I noticed that Socket&#39;s Makefile.PL spits out lots of errors from test programs:

test-0.obj : error LNK2019: unresolved external symbol __imp__getaddrinfo@16 referenced in function _main
test-0.exe : fatal error LNK1120: 1 unresolved externals
test-1.obj : error LNK2019: unresolved external symbol __imp__getnameinfo@28 referenced in function _main
test-1.exe : fatal error LNK1120: 1 unresolved externals
test-2.obj : error LNK2019: unresolved external symbol _inet_ntop@16 referenced in function _main
test-2.exe : fatal error LNK1120: 1 unresolved externals
test-3.obj : error LNK2019: unresolved external symbol __imp__inet_pton@12 referenced in function _main
test-3.exe : fatal error LNK1120: 1 unresolved externals
test-4.c&#40;17&#41; : error C2065: &#39;inet_aton&#39; : undeclared identifier
test-5.c&#40;17&#41; : error C2039: &#39;sa_len&#39; : is not a member of &#39;sockaddr&#39;
test-10.c&#40;12&#41; : fatal error C1083: Cannot open include file: &#39;netinet/ip.h&#39;: No such file or directory

The unresolved symbol errors result from the link_executable&#40;&#41; call not including the necessary libs. Specifically, ws2_32.lib is missing.

Changing the link_executable&#40;&#41; call to this &#40;obviously hacked specifically for Windows VC++&#41;:

    my $file_exe = eval { $cb-&gt;link_executable&#40; objects =&gt; $file_obj, extra_linker_flags =&gt; &#39;ws2_32.lib&#39; &#41; };

reduces the errors to:

test-4.c&#40;17&#41; : error C2065: &#39;inet_aton&#39; : undeclared identifier
test-5.c&#40;17&#41; : error C2039: &#39;sa_len&#39; : is not a member of &#39;sockaddr&#39;
test-10.c&#40;12&#41; : fatal error C1083: Cannot open include file: &#39;netinet/ip.h&#39;: No such file or directory

inet_aton&#40;&#41; really isn&#39;t on Windows, but that&#39;s ok since Socket provides its own version in Socket.xs.

So inet_pton&#40;&#41; and inet_ntop&#40;&#41; are indeed present &#40;with those names, as well as InetPton&#40;&#41; and InetNtop&#40;&#41;&#41;...

However, even with the above Makefile.PL hack in place, Socket.xs still fails to build:

Socket.xs&#40;973&#41; : warning C4013: &#39;inet_ntop&#39; undefined; assuming extern returning int
Socket.xs&#40;1012&#41; : warning C4013: &#39;inet_pton&#39; undefined; assuming extern returning int
Socket.obj : error LNK2019: unresolved external symbol _inet_ntop referenced in function _XS_Socket_inet_ntop
Socket.obj : error LNK2019: unresolved external symbol _inet_pton referenced in function _XS_Socket_inet_pton

For some reason the compiler isn&#39;t seeing a declaration of inet_ntop/inet_pton, so assumes they are &#39;int&#39; functions -- which the linker then obviously can&#39;t find a definition of, despite ws2_32.lib being in the link command this time, since ws2_32.lib only has the correct definitions in it!

Why are the declarations missing when compiling Socket.xs, but were clearly present when Makefile.PL compiled some test programs?

The reason is that including perl.h before ws2tcpip.h hides them. I haven&#39;t yet figured out why this is, but it&#39;s easy to reproduce:

This builds fine:

#include &lt;EXTERN.h&gt;
#include &lt;ws2tcpip.h&gt;
#include &lt;perl.h&gt;
void main&#40;void&#41; {
    IN_ADDR addr;
    char str[16];
    inet_ntop&#40;AF_INET, &#38;addr, str, sizeof&#40;str&#41;&#41;;
}

but this fails:

#include &lt;EXTERN.h&gt;
#include &lt;perl.h&gt;
#include &lt;ws2tcpip.h&gt;
void main&#40;void&#41; {
    IN_ADDR addr;
    char str[16];
    inet_ntop&#40;AF_INET, &#38;addr, str, sizeof&#40;str&#41;&#41;;
}

Therefore, moving this:

#if defined&#40;WIN32&#41; &#38;&#38; !defined&#40;UNDER_CE&#41;
# include &lt;ws2tcpip.h&gt;
#endif

higher up in Socket.xs, to just above the #include of perl.h, fixes the Socket.xs build.

I now have Socket::inet_ntop and Socket::inet_pton :-&#41;

For people on older Windows that really don&#39;t have inet_ntop&#40;&#41; and inet_pton&#40;&#41; I guess you will have to provide your own definitions, as is done with inet_aton&#40;&#41;, but testing HAS_INET_NTOP and HAS_INET_PTON might not be ideal since they will currently be &#39;undef&#39; even for users that do have them :-/ I will look into fixing that up in perl itself soon, but that will clearly only benefit users of whatever new version of perl it finds its way into...

I found an inet_ntop&#40;&#41; here:

<span class="clickylink"><a target="new" rel="nofollow" href="http://memset.wordpress.com/2010/10/09/inet_ntop-for-win32/">http://memset.wordpress.com/2010/10/09/inet_ntop-for-win32/</a></span>

I dare say inet_pton&#40;&#41; is easy enough too, using WSAStringToAddress&#40;&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1874862" href="/Public/Bug/Display.html?id=84600#txn-1874862">#</a>      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;14&nbsp;12:11:54&nbsp;2019</span>
    <span class="description">DiablosOffens [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1874862/1006351/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1006351">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Do 17. Okt 2013, 17:41:24, PEVANS schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Oct 17 10:06:56 2013, WOLFSAGE wrote:
<div class="message-stanza open">&gt; &gt; But inet_pton is implemented as InetPton:
&gt; &gt;
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-">http://msdn.microsoft.com/en-</a></span>
&gt; &gt; us/library/windows/desktop/cc805844%28v=vs.85%29.aspx
</div>&gt; 
&gt; I&#39;m not quite sure I follow what that page is saying. It briefly
&gt; mentions:
&gt; 
&gt; The ANSI version of this function is inet_pton.
&gt; 
&gt; Unicode and ANSI names
&gt;       InetPtonW &#40;Unicode&#41; and InetPtonA or inet_pton &#40;ANSI&#41;
&gt; 
&gt; But I don&#39;t truely follow the implications of those comments. Does
&gt; that mean that the function is available under that name, or simply
&gt; that &#34;ANSI says this function this this name but we&#39;ve decided to name
&gt; it differently&#34;?
&gt; 
&gt; If it&#39;s the former, then surely it should work? If it&#39;s the latter,
&gt; then maybe just a #define or similar should bring it into line?
&gt; 
&gt; What happens if we simply
&gt; 
&gt; #define inet_pton  InetPtonA
&gt; 
&gt; on Windows?
</div>

It means that it is available under all these names. ANSI means that it is the name of the ANSI version of this API.

There is already a define in the original and mingw headers:

#define InetPtonA       inet_pton
#define InetNtopA       inet_ntop

So the real exported name of this API in the libraries is the ANSI version.
To get access to all these defines and prototypes, you need to define _WIN32_WINNT to at least 0x0600 &#40;Vista&#41;.

I&#39;ve attached a patch for Socket module version 2.029 .
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> socket.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1874862/1006352/socket.patch">Download socket.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ur a/Socket-2.029-0/Makefile.PL b/Socket-2.029-0/Makefile.PL
--- a/Socket-2.029-0/Makefile.PL	2019-02-21 20:39:31.000000000 +0100
+++ b/Socket-2.029-0/Makefile.PL	2019-12-13 23:36:59.545721000 +0100
@@ -31,6 +31,9 @@
     {
 	open&#40; my $file_source_fh, &#34;&gt;&#34;, $file_source &#41; or die &#34;Cannot write $file_source - $!&#34;;
 	print $file_source_fh &lt;&lt;&#34;EOF&#34;;
+#ifdef WIN32
+# define _WIN32_WINNT 0x0600
+#endif
 #include &lt;stddef.h&gt;
 #include &lt;sys/types.h&gt;
 #ifdef WIN32
diff -ur a/Socket-2.029-0/Socket.xs b/Socket-2.029-0/Socket.xs
--- a/Socket-2.029-0/Socket.xs	2019-02-20 20:06:25.000000000 +0100
+++ b/Socket-2.029-0/Socket.xs	2019-12-13 23:46:31.063648800 +0100
@@ -1,4 +1,7 @@
 #define PERL_NO_GET_CONTEXT
+#ifdef WIN32
+#  define _WIN32_WINNT 0x0600
+#endif
 #include &#34;EXTERN.h&#34;
 #include &#34;perl.h&#34;
 #include &#34;XSUB.h&#34;
@@ -98,6 +101,8 @@
 
 #endif
 
+#if &#40;_WIN32_WINNT &lt; 0x0600&#41;
+
 static int inet_pton&#40;int af, const char *src, void *dst&#41;
 {
   struct sockaddr_storage ss;
@@ -148,6 +153,8 @@
 
 #define HAS_INETPTON
 #define HAS_INETNTOP
+#endif /* _WIN32_WINNT &lt; 0x0600 */
+
 #endif
 
 #ifdef NETWARE
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.553032</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
