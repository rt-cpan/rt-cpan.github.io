<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #130488 for JSON-Path: Indeterministic result ordering for some selectors</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #130488 for JSON-Path: Indeterministic result ordering for some selectors</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/JSON-Path/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/JSON-Path/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/JSON-Path/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/JSON-Path/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/JSON-Path">JSON-Path CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">130488</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/JSON-Path/Active/">JSON-Path</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">popefelix [...] gmail.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
christoph.burgmer [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-234486-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.420    </td>
  </tr>
  <tr id="CF-234487-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;10&nbsp;17:38:27&nbsp;2019</span>
    <span class="description">christoph.burgmer [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Indeterministic result ordering for some selectors</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">For the given selectors and documents I can reproduce differently ordered results on re-runs:

## Exhibit A

Selector: $[*]
Document:
{
    &#34;some&#34;: &#34;string&#34;,
    &#34;int&#34;: 42,
    &#34;object&#34;: {
        &#34;key&#34;: &#34;value&#34;
    },
    &#34;array&#34;: [0, 1]
}

Outcome #1:
[
  42,
  [
    0,
    1
  ],
  &#34;string&#34;,
  {
    &#34;key&#34;: &#34;value&#34;
  }
]

Outcome #2:
[
  {
    &#34;key&#34;: &#34;value&#34;
  },
  42,
  [
    0,
    1
  ],
  &#34;string&#34;
]


## Exhibit B

Selector: $.store..price
Document:
See <span class="clickylink"><a target="new" rel="nofollow" href="https://cburgmer.github.io/json-path-comparison/results/recursive_on_nested_object.html">https://cburgmer.github.io/json-path-comparison/results/recursive_on_nested_object.html</a></span>

Outcome #1:
[
  19.95,
  8.95,
  12.99,
  8.99,
  22.99
]

Outcome #2:
[
  8.95,
  12.99,
  8.99,
  22.99,
  19.95
]



Expected:

Deterministic ordering to reduce flakiness in output. 

Rationale:

This is a blocker for this implementation to be added to the comparison of aforementioned project, see <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/4">https://github.com/cburgmer/json-path-comparison/issues/4</a></span> .

I believe the nondeterminism comes from Perl&#39;s hashes not guaranteeing order. It&#39;s debatable however whether JSONPath should even guarantee order, see e.g. <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/3">https://github.com/cburgmer/json-path-comparison/issues/3</a></span> .
I&#39;m happy to find other means for now to introduce a deterministic response but am limited by my knowledge of Perl. Happy for pointers. Looked at Tie::IxHash but can&#39;t figure out how to bring it in after JSON decoding.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;10&nbsp;18:10:54&nbsp;2019</span>
    <span class="description">popefelix [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 10 Sep 2019 17:10:27 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kit Peters &lt;popefelix [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">You are correct - the nondeterminism does come from Perl&#39;s hashes not
guaranteeing order.

How do other JSONPath implementations handle this? Is there a spec that
dictates this?

On Tue, Sep 10, 2019 at 4:38 PM Christoph Burgmer via RT &lt;
bug-JSON-Path@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue Sep 10 17:38:27 2019: Request 130488 was acted upon.
&gt; Transaction: Ticket created by christoph.burgmer@gmail.com
&gt;        Queue: JSON-Path
&gt;      Subject: Indeterministic result ordering for some selectors
&gt;    Broken in: 0.420
&gt;     Severity: Normal
&gt;        Owner: popefelix
&gt;   Requestors: christoph.burgmer@gmail.com
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt;
&gt;
&gt; For the given selectors and documents I can reproduce differently ordered
&gt; results on re-runs:
&gt;
&gt; ## Exhibit A
&gt;
&gt; Selector: $[*]
&gt; Document:
&gt; {
&gt;     &#34;some&#34;: &#34;string&#34;,
&gt;     &#34;int&#34;: 42,
&gt;     &#34;object&#34;: {
&gt;         &#34;key&#34;: &#34;value&#34;
&gt;     },
&gt;     &#34;array&#34;: [0, 1]
&gt; }
&gt;
&gt; Outcome #1:
&gt; [
&gt;   42,
&gt;   [
&gt;     0,
&gt;     1
&gt;   ],
&gt;   &#34;string&#34;,
&gt;   {
&gt;     &#34;key&#34;: &#34;value&#34;
&gt;   }
&gt; ]
&gt;
&gt; Outcome #2:
&gt; [
&gt;   {
&gt;     &#34;key&#34;: &#34;value&#34;
&gt;   },
&gt;   42,
&gt;   [
&gt;     0,
&gt;     1
&gt;   ],
&gt;   &#34;string&#34;
&gt; ]
&gt;
&gt;
&gt; ## Exhibit B
&gt;
&gt; Selector: $.store..price
&gt; Document:
&gt; See
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://cburgmer.github.io/json-path-comparison/results/recursive_on_nested_object.html">https://cburgmer.github.io/json-path-comparison/results/recursive_on_nested_object.html</a></span>
&gt;
&gt; Outcome #1:
&gt; [
&gt;   19.95,
&gt;   8.95,
&gt;   12.99,
&gt;   8.99,
&gt;   22.99
&gt; ]
&gt;
&gt; Outcome #2:
&gt; [
&gt;   8.95,
&gt;   12.99,
&gt;   8.99,
&gt;   22.99,
&gt;   19.95
&gt; ]
&gt;
&gt;
&gt;
&gt; Expected:
&gt;
&gt; Deterministic ordering to reduce flakiness in output.
&gt;
&gt; Rationale:
&gt;
&gt; This is a blocker for this implementation to be added to the comparison of
&gt; aforementioned project, see
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/4">https://github.com/cburgmer/json-path-comparison/issues/4</a></span> .
&gt;
&gt; I believe the nondeterminism comes from Perl&#39;s hashes not guaranteeing
&gt; order. It&#39;s debatable however whether JSONPath should even guarantee order,
&gt; see e.g. <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/3">https://github.com/cburgmer/json-path-comparison/issues/3</a></span> .
&gt; I&#39;m happy to find other means for now to introduce a deterministic
&gt; response but am limited by my knowledge of Perl. Happy for pointers. Looked
&gt; at Tie::IxHash but can&#39;t figure out how to bring it in after JSON decoding.
&gt;
</div>

-- 
Kit Peters, W0KEH
GPG public key fingerpint: D4FF AA62 AFEA 83D6 CC98 ACE5 6FAE 7E74 7F56 ED1D
Hello to any and all NSA, DEA, or other government or non-government agents
reading this email.  Tell me about your life; I&#39;ll tell you about mine.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;10&nbsp;18:10:54&nbsp;2019</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;11&nbsp;03:08:25&nbsp;2019</span>
    <span class="description">christoph.burgmer [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">With all the other implementations I&#39;ve tried &#40;Java, PHP, Python, Ruby, ...&#41; they at least provide a stable response &#40;possibly due to the underlying guarantees of the language&#41;.
Compare e.g. row &#34;Wildcard dot notation on array&#34; in the table under <span class="clickylink"><a target="new" rel="nofollow" href="https://cburgmer.github.io/json-path-comparison/">https://cburgmer.github.io/json-path-comparison/</a></span>.

The JSONPath &#34;spec&#34; doesn&#39;t seem to say anything about this, whereas for the actual JSON spec I&#39;ve read conflicting interpretations - many discussions claim that order is not guaranteed, but I have to yet find this in any spec.

What I&#39;ve done with Python when I wanted to maintain order is use an OrderedDict: <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/master/src/oneliner_json.py">https://github.com/cburgmer/json-path-comparison/blob/master/src/oneliner_json.py</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;11&nbsp;10:14:56&nbsp;2019</span>
    <span class="description">popefelix [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Sep 2019 09:14:37 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kit Peters &lt;popefelix [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">So the JSON spec says that objects are unordered. In your Exhibit A, you&#39;re
passing in an object, so there&#39;s no guarantee of how things will be ordered
coming out. Exhibit B is similar - you&#39;ll note that 19.95 is either the
first or the last element in the list, but never in the middle.

I&#39;d be willing to work on a &#34;canonical&#34; flag similar to the flag used by
Storable &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/Storable#CANONICAL-REPRESENTATION&#41;">https://metacpan.org/pod/Storable#CANONICAL-REPRESENTATION&#41;</a></span>.
Would that be sufficient?

On Wed, Sep 11, 2019 at 2:08 AM Christoph Burgmer via RT &lt;
bug-JSON-Path@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: JSON-Path
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt;
&gt; With all the other implementations I&#39;ve tried &#40;Java, PHP, Python, Ruby,
&gt; ...&#41; they at least provide a stable response &#40;possibly due to the
&gt; underlying guarantees of the language&#41;.
&gt; Compare e.g. row &#34;Wildcard dot notation on array&#34; in the table under
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://cburgmer.github.io/json-path-comparison/">https://cburgmer.github.io/json-path-comparison/</a></span>.
&gt;
&gt; The JSONPath &#34;spec&#34; doesn&#39;t seem to say anything about this, whereas for
&gt; the actual JSON spec I&#39;ve read conflicting interpretations - many
&gt; discussions claim that order is not guaranteed, but I have to yet find this
&gt; in any spec.
&gt;
&gt; What I&#39;ve done with Python when I wanted to maintain order is use an
&gt; OrderedDict:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/master/src/oneliner_json.py">https://github.com/cburgmer/json-path-comparison/blob/master/src/oneliner_json.py</a></span>
&gt;
</div>

-- 
Kit Peters, W0KEH
GPG public key fingerpint: D4FF AA62 AFEA 83D6 CC98 ACE5 6FAE 7E74 7F56 ED1D
Hello to any and all NSA, DEA, or other government or non-government agents
reading this email.  Tell me about your life; I&#39;ll tell you about mine.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;12&nbsp;11:24:55&nbsp;2019</span>
    <span class="description">christoph.burgmer [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 12 Sep 2019 17:24:27 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christoph Burgmer &lt;christoph.burgmer [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I needed some time to think on this.

What&#39;s currently making the outcome hard to compare is that a query like
`$[*]` on an object doesn&#39;t yield a stable representation. If there is a,
say, simple way of achieving that, it would help, yes.
The ordering has to already be preserved when parsing the JSON document
though &#40;see
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9&#41;">https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9&#41;</a></span>,
as this already introduces indeterminism in Perl I believe &#40;as
decode_json returns
a hash I believe&#41;. Python for example does allow that.

Kit, my goal with the comparison project is to seek clarification on what
&#34;good&#34; JSONPath is &#40;including I guess when a certain order can be
guaranteed&#41;, but I&#39;m trying to keep my on personal opinion out of it, hence
the whole approach of comparing via consensus.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;12&nbsp;11:38:36&nbsp;2019</span>
    <span class="description">christoph.burgmer [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 12 Sep 2019 17:38:12 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christoph Burgmer &lt;christoph.burgmer [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Just for reference, I&#39;ve tried looking for a source on the much quoted JSON
standard as it came up in other discussions as well, and so far only found

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The JSON syntax does not impose any restrictions on the strings used  as
</div> names,  does  not  require  that  name strings be  unique,  and  does  not
 assign  any significance to the ordering of name/value pairs. These are
all semantic considerations that may be defined by JSON processors or in
specifications defining specific uses of JSON for data interchange.

I&#39;ve mentioned this in
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/3">https://github.com/cburgmer/json-path-comparison/issues/3</a></span> where I&#39;d try to
focus the general discussion on ordering for JSONPath, but wanted to call
this out here once.

Am Do., 12. Sept. 2019 um 17:24 Uhr schrieb Christoph Burgmer &lt;
christoph.burgmer@gmail.com&gt;:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I needed some time to think on this.
&gt;
&gt; What&#39;s currently making the outcome hard to compare is that a query like
&gt; `$[*]` on an object doesn&#39;t yield a stable representation. If there is a,
&gt; say, simple way of achieving that, it would help, yes.
&gt; The ordering has to already be preserved when parsing the JSON document
&gt; though &#40;see
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9&#41;">https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9&#41;</a></span>,
&gt; as this already introduces indeterminism in Perl I believe &#40;as decode_json
&gt; returns a hash I believe&#41;. Python for example does allow that.
&gt;
&gt; Kit, my goal with the comparison project is to seek clarification on what
&gt; &#34;good&#34; JSONPath is &#40;including I guess when a certain order can be
&gt; guaranteed&#41;, but I&#39;m trying to keep my on personal opinion out of it, hence
&gt; the whole approach of comparing via consensus.
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;12&nbsp;12:01:13&nbsp;2019</span>
    <span class="description">popefelix [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 12 Sep 2019 11:00:48 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kit Peters &lt;popefelix [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Just for reference, I&#39;ve tried looking for a source on the much quoted JSON
standard&#34;

Ah, that&#39;s an easy one! :&#41;

RFC 7159 &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.rfc-editor.org/rfc/rfc7159.txt&#41;">http://www.rfc-editor.org/rfc/rfc7159.txt&#41;</a></span> states &#34;An object is
an *unordered* collection of zero or more name/value pairs&#34; &#40;emphasis mine&#41;

On Thu, Sep 12, 2019, 10:38 Christoph Burgmer via RT &lt;
bug-JSON-Path@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: JSON-Path
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt;
&gt; Just for reference, I&#39;ve tried looking for a source on the much quoted JSON
&gt; standard as it came up in other discussions as well, and so far only found
&gt;
<div class="message-stanza open">&gt; &gt; The JSON syntax does not impose any restrictions on the strings used  as
</div>&gt;  names,  does  not  require  that  name strings be  unique,  and  does  not
&gt;  assign  any significance to the ordering of name/value pairs. These are
&gt; all semantic considerations that may be defined by JSON processors or in
&gt; specifications defining specific uses of JSON for data interchange.
&gt;
&gt; I&#39;ve mentioned this in
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/3">https://github.com/cburgmer/json-path-comparison/issues/3</a></span> where I&#39;d try to
&gt; focus the general discussion on ordering for JSONPath, but wanted to call
&gt; this out here once.
&gt;
&gt; Am Do., 12. Sept. 2019 um 17:24 Uhr schrieb Christoph Burgmer &lt;
&gt; christoph.burgmer@gmail.com&gt;:
&gt;
<div class="message-stanza open">&gt; &gt; I needed some time to think on this.
&gt; &gt;
&gt; &gt; What&#39;s currently making the outcome hard to compare is that a query like
&gt; &gt; `$[*]` on an object doesn&#39;t yield a stable representation. If there is a,
&gt; &gt; say, simple way of achieving that, it would help, yes.
&gt; &gt; The ordering has to already be preserved when parsing the JSON document
&gt; &gt; though &#40;see
&gt; &gt;
</div>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9">https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9</a></span>
&gt; &#41;,
<div class="message-stanza open">&gt; &gt; as this already introduces indeterminism in Perl I believe &#40;as
</div>&gt; decode_json
<div class="message-stanza open">&gt; &gt; returns a hash I believe&#41;. Python for example does allow that.
&gt; &gt;
&gt; &gt; Kit, my goal with the comparison project is to seek clarification on what
&gt; &gt; &#34;good&#34; JSONPath is &#40;including I guess when a certain order can be
&gt; &gt; guaranteed&#41;, but I&#39;m trying to keep my on personal opinion out of it,
</div>&gt; hence
<div class="message-stanza open">&gt; &gt; the whole approach of comparing via consensus.
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;12&nbsp;12:54:15&nbsp;2019</span>
    <span class="description">popefelix [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 12 Sep 2019 11:53:35 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kit Peters &lt;popefelix [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry - I quoted an obsolete RFC. The correct one is RFC8259 &#40;
<span class="clickylink"><a target="new" rel="nofollow" href="https://datatracker.ietf.org/doc/rfc8259/?include_text=1&#41;">https://datatracker.ietf.org/doc/rfc8259/?include_text=1&#41;</a></span>, which again
defines an object to be &#34;an unordered collection of zero or more name/value
pairs&#34;.

To your question above of what constitutes &#34;good&#34; JSONPath, I would say
that good JSONPath produces results that a reasonable person would expect
having read Goessner&#39;s definition and RFC 8159. Thus, to put the question
in the context of this issue, if a JSONPath implementation imposes an order
on the keys of an object, that implementation is out of compliance with the
spec, consensus or no.



On Thu, Sep 12, 2019 at 11:00 AM Kit Peters &lt;popefelix@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#34;Just for reference, I&#39;ve tried looking for a source on the much quoted
&gt; JSON
&gt; standard&#34;
&gt;
&gt; Ah, that&#39;s an easy one! :&#41;
&gt;
&gt; RFC 7159 &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.rfc-editor.org/rfc/rfc7159.txt&#41;">http://www.rfc-editor.org/rfc/rfc7159.txt&#41;</a></span> states &#34;An object is
&gt; an *unordered* collection of zero or more name/value pairs&#34; &#40;emphasis
&gt; mine&#41;
&gt;
&gt; On Thu, Sep 12, 2019, 10:38 Christoph Burgmer via RT &lt;
&gt; bug-JSON-Path@rt.cpan.org&gt; wrote:
&gt;
<div class="message-stanza open">&gt;&gt;        Queue: JSON-Path
&gt;&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt;&gt;
&gt;&gt; Just for reference, I&#39;ve tried looking for a source on the much quoted
&gt;&gt; JSON
&gt;&gt; standard as it came up in other discussions as well, and so far only found
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt; The JSON syntax does not impose any restrictions on the strings used  as
</div>&gt;&gt;  names,  does  not  require  that  name strings be  unique,  and  does
&gt;&gt; not
&gt;&gt;  assign  any significance to the ordering of name/value pairs. These are
&gt;&gt; all semantic considerations that may be defined by JSON processors or in
&gt;&gt; specifications defining specific uses of JSON for data interchange.
&gt;&gt;
&gt;&gt; I&#39;ve mentioned this in
&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/3">https://github.com/cburgmer/json-path-comparison/issues/3</a></span> where I&#39;d try
&gt;&gt; to
&gt;&gt; focus the general discussion on ordering for JSONPath, but wanted to call
&gt;&gt; this out here once.
&gt;&gt;
&gt;&gt; Am Do., 12. Sept. 2019 um 17:24 Uhr schrieb Christoph Burgmer &lt;
&gt;&gt; christoph.burgmer@gmail.com&gt;:
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt; I needed some time to think on this.
&gt;&gt; &gt;
&gt;&gt; &gt; What&#39;s currently making the outcome hard to compare is that a query like
&gt;&gt; &gt; `$[*]` on an object doesn&#39;t yield a stable representation. If there is
</div>&gt;&gt; a,
<div class="message-stanza open">&gt;&gt; &gt; say, simple way of achieving that, it would help, yes.
&gt;&gt; &gt; The ordering has to already be preserved when parsing the JSON document
&gt;&gt; &gt; though &#40;see
&gt;&gt; &gt;
</div>&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9">https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9</a></span>
&gt;&gt; &#41;,
<div class="message-stanza open">&gt;&gt; &gt; as this already introduces indeterminism in Perl I believe &#40;as
</div>&gt;&gt; decode_json
<div class="message-stanza open">&gt;&gt; &gt; returns a hash I believe&#41;. Python for example does allow that.
&gt;&gt; &gt;
&gt;&gt; &gt; Kit, my goal with the comparison project is to seek clarification on
</div>&gt;&gt; what
<div class="message-stanza open">&gt;&gt; &gt; &#34;good&#34; JSONPath is &#40;including I guess when a certain order can be
&gt;&gt; &gt; guaranteed&#41;, but I&#39;m trying to keep my on personal opinion out of it,
</div>&gt;&gt; hence
<div class="message-stanza open">&gt;&gt; &gt; the whole approach of comparing via consensus.
&gt;&gt; &gt;
&gt;&gt; &gt;
</div>&gt;&gt;
&gt;&gt;
</div></div>
-- 
Kit Peters, W0KEH
GPG public key fingerpint: D4FF AA62 AFEA 83D6 CC98 ACE5 6FAE 7E74 7F56 ED1D
Hello to any and all NSA, DEA, or other government or non-government agents
reading this email.  Tell me about your life; I&#39;ll tell you about mine.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;12&nbsp;14:52:46&nbsp;2019</span>
    <span class="description">christoph.burgmer [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 12 Sep 2019 20:52:18 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christoph Burgmer &lt;christoph.burgmer [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fair point, but let&#39;s also call out

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; JSON parsing libraries have been observed to differ as to whether or
&gt; not they make the ordering of object members visible to calling
&gt; software.  Implementations whose behavior does not depend on member
&gt; ordering will be interoperable in the sense that they will not be
&gt; affected by these differences.
</div>
It seems some people have seen the need to somewhat pass on the order.

Anyhow, let me know what you think is reasonable for your library. Feel
free to give the json-path-comparison project a run, it&#39;s meant to help,
not enforce :&#41;

Am Do., 12. Sept. 2019 um 18:54 Uhr schrieb Kit Peters via RT &lt;
bug-JSON-Path@rt.cpan.org&gt;:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt;
&gt; Sorry - I quoted an obsolete RFC. The correct one is RFC8259 &#40;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://datatracker.ietf.org/doc/rfc8259/?include_text=1&#41;">https://datatracker.ietf.org/doc/rfc8259/?include_text=1&#41;</a></span>, which again
&gt; defines an object to be &#34;an unordered collection of zero or more name/value
&gt; pairs&#34;.
&gt;
&gt; To your question above of what constitutes &#34;good&#34; JSONPath, I would say
&gt; that good JSONPath produces results that a reasonable person would expect
&gt; having read Goessner&#39;s definition and RFC 8159. Thus, to put the question
&gt; in the context of this issue, if a JSONPath implementation imposes an order
&gt; on the keys of an object, that implementation is out of compliance with the
&gt; spec, consensus or no.
&gt;
&gt;
&gt;
&gt; On Thu, Sep 12, 2019 at 11:00 AM Kit Peters &lt;popefelix@gmail.com&gt; wrote:
&gt;
<div class="message-stanza open">&gt; &gt; &#34;Just for reference, I&#39;ve tried looking for a source on the much quoted
&gt; &gt; JSON
&gt; &gt; standard&#34;
&gt; &gt;
&gt; &gt; Ah, that&#39;s an easy one! :&#41;
&gt; &gt;
&gt; &gt; RFC 7159 &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.rfc-editor.org/rfc/rfc7159.txt&#41;">http://www.rfc-editor.org/rfc/rfc7159.txt&#41;</a></span> states &#34;An object
</div>&gt; is
<div class="message-stanza open">&gt; &gt; an *unordered* collection of zero or more name/value pairs&#34; &#40;emphasis
&gt; &gt; mine&#41;
&gt; &gt;
&gt; &gt; On Thu, Sep 12, 2019, 10:38 Christoph Burgmer via RT &lt;
&gt; &gt; bug-JSON-Path@rt.cpan.org&gt; wrote:
&gt; &gt;
<div class="message-stanza open">&gt; &gt;&gt;        Queue: JSON-Path
&gt; &gt;&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Just for reference, I&#39;ve tried looking for a source on the much quoted
&gt; &gt;&gt; JSON
&gt; &gt;&gt; standard as it came up in other discussions as well, and so far only
</div></div>&gt; found
<div class="message-stanza open">&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt; &gt; The JSON syntax does not impose any restrictions on the strings used
</div></div>&gt; as
<div class="message-stanza open">&gt; &gt;&gt;  names,  does  not  require  that  name strings be  unique,  and  does
&gt; &gt;&gt; not
&gt; &gt;&gt;  assign  any significance to the ordering of name/value pairs. These are
&gt; &gt;&gt; all semantic considerations that may be defined by JSON processors or in
&gt; &gt;&gt; specifications defining specific uses of JSON for data interchange.
&gt; &gt;&gt;
&gt; &gt;&gt; I&#39;ve mentioned this in
&gt; &gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/3">https://github.com/cburgmer/json-path-comparison/issues/3</a></span> where I&#39;d try
&gt; &gt;&gt; to
&gt; &gt;&gt; focus the general discussion on ordering for JSONPath, but wanted to
</div>&gt; call
<div class="message-stanza open">&gt; &gt;&gt; this out here once.
&gt; &gt;&gt;
&gt; &gt;&gt; Am Do., 12. Sept. 2019 um 17:24 Uhr schrieb Christoph Burgmer &lt;
&gt; &gt;&gt; christoph.burgmer@gmail.com&gt;:
&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt; &gt; I needed some time to think on this.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; What&#39;s currently making the outcome hard to compare is that a query
</div></div>&gt; like
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; &gt; `$[*]` on an object doesn&#39;t yield a stable representation. If there is
</div>&gt; &gt;&gt; a,
<div class="message-stanza open">&gt; &gt;&gt; &gt; say, simple way of achieving that, it would help, yes.
&gt; &gt;&gt; &gt; The ordering has to already be preserved when parsing the JSON
</div></div>&gt; document
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; &gt; though &#40;see
&gt; &gt;&gt; &gt;
</div>&gt; &gt;&gt;
</div>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9">https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9</a></span>
<div class="message-stanza open">&gt; &gt;&gt; &#41;,
<div class="message-stanza open">&gt; &gt;&gt; &gt; as this already introduces indeterminism in Perl I believe &#40;as
</div>&gt; &gt;&gt; decode_json
<div class="message-stanza open">&gt; &gt;&gt; &gt; returns a hash I believe&#41;. Python for example does allow that.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; Kit, my goal with the comparison project is to seek clarification on
</div>&gt; &gt;&gt; what
<div class="message-stanza open">&gt; &gt;&gt; &gt; &#34;good&#34; JSONPath is &#40;including I guess when a certain order can be
&gt; &gt;&gt; &gt; guaranteed&#41;, but I&#39;m trying to keep my on personal opinion out of it,
</div>&gt; &gt;&gt; hence
<div class="message-stanza open">&gt; &gt;&gt; &gt; the whole approach of comparing via consensus.
&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt;
</div>&gt; &gt;&gt;
&gt; &gt;&gt;
</div>&gt;
&gt; --
&gt; Kit Peters, W0KEH
&gt; GPG public key fingerpint: D4FF AA62 AFEA 83D6 CC98 ACE5 6FAE 7E74 7F56
&gt; ED1D
&gt; Hello to any and all NSA, DEA, or other government or non-government agents
&gt; reading this email.  Tell me about your life; I&#39;ll tell you about mine.
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;12&nbsp;14:58:25&nbsp;2019</span>
    <span class="description">popefelix [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130488] Indeterministic result ordering for some selectors</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 12 Sep 2019 13:57:50 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JSON-Path [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kit Peters &lt;popefelix [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">You make a fair point as well. :&#41;

I think that the best way to move forward is either for you to update your
tests to not care about object order, or for me to add the &#34;canonical&#34; flag
I mentioned above. I would prefer that you updated your tests, because
that&#39;s less work on my part, but I&#39;m OK with doing the work if need be. Or
we could split the difference and I could advise you on adding the flag
yourself. :D

Up to you.

KP

On Thu, Sep 12, 2019 at 1:52 PM Christoph Burgmer via RT &lt;
bug-JSON-Path@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: JSON-Path
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt;
&gt; Fair point, but let&#39;s also call out
&gt;
<div class="message-stanza open">&gt; &gt; JSON parsing libraries have been observed to differ as to whether or
&gt; &gt; not they make the ordering of object members visible to calling
&gt; &gt; software.  Implementations whose behavior does not depend on member
&gt; &gt; ordering will be interoperable in the sense that they will not be
&gt; &gt; affected by these differences.
</div>&gt;
&gt; It seems some people have seen the need to somewhat pass on the order.
&gt;
&gt; Anyhow, let me know what you think is reasonable for your library. Feel
&gt; free to give the json-path-comparison project a run, it&#39;s meant to help,
&gt; not enforce :&#41;
&gt;
&gt; Am Do., 12. Sept. 2019 um 18:54 Uhr schrieb Kit Peters via RT &lt;
&gt; bug-JSON-Path@rt.cpan.org&gt;:
&gt;
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt; &gt;
&gt; &gt; Sorry - I quoted an obsolete RFC. The correct one is RFC8259 &#40;
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://datatracker.ietf.org/doc/rfc8259/?include_text=1&#41;">https://datatracker.ietf.org/doc/rfc8259/?include_text=1&#41;</a></span>, which again
&gt; &gt; defines an object to be &#34;an unordered collection of zero or more
</div>&gt; name/value
<div class="message-stanza open">&gt; &gt; pairs&#34;.
&gt; &gt;
&gt; &gt; To your question above of what constitutes &#34;good&#34; JSONPath, I would say
&gt; &gt; that good JSONPath produces results that a reasonable person would expect
&gt; &gt; having read Goessner&#39;s definition and RFC 8159. Thus, to put the question
&gt; &gt; in the context of this issue, if a JSONPath implementation imposes an
</div>&gt; order
<div class="message-stanza open">&gt; &gt; on the keys of an object, that implementation is out of compliance with
</div>&gt; the
<div class="message-stanza open">&gt; &gt; spec, consensus or no.
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; On Thu, Sep 12, 2019 at 11:00 AM Kit Peters &lt;popefelix@gmail.com&gt; wrote:
&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &#34;Just for reference, I&#39;ve tried looking for a source on the much quoted
&gt; &gt; &gt; JSON
&gt; &gt; &gt; standard&#34;
&gt; &gt; &gt;
&gt; &gt; &gt; Ah, that&#39;s an easy one! :&#41;
&gt; &gt; &gt;
&gt; &gt; &gt; RFC 7159 &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.rfc-editor.org/rfc/rfc7159.txt&#41;">http://www.rfc-editor.org/rfc/rfc7159.txt&#41;</a></span> states &#34;An object
</div>&gt; &gt; is
<div class="message-stanza open">&gt; &gt; &gt; an *unordered* collection of zero or more name/value pairs&#34; &#40;emphasis
&gt; &gt; &gt; mine&#41;
&gt; &gt; &gt;
&gt; &gt; &gt; On Thu, Sep 12, 2019, 10:38 Christoph Burgmer via RT &lt;
&gt; &gt; &gt; bug-JSON-Path@rt.cpan.org&gt; wrote:
&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt;&gt;        Queue: JSON-Path
&gt; &gt; &gt;&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130488">https://rt.cpan.org/Ticket/Display.html?id=130488</a></span> &gt;
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Just for reference, I&#39;ve tried looking for a source on the much quoted
&gt; &gt; &gt;&gt; JSON
&gt; &gt; &gt;&gt; standard as it came up in other discussions as well, and so far only
</div></div>&gt; &gt; found
<div class="message-stanza open">&gt; &gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; The JSON syntax does not impose any restrictions on the strings used
</div></div>&gt; &gt; as
<div class="message-stanza open">&gt; &gt; &gt;&gt;  names,  does  not  require  that  name strings be  unique,  and  does
&gt; &gt; &gt;&gt; not
&gt; &gt; &gt;&gt;  assign  any significance to the ordering of name/value pairs. These
</div></div>&gt; are
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;&gt; all semantic considerations that may be defined by JSON processors or
</div></div>&gt; in
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;&gt; specifications defining specific uses of JSON for data interchange.
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; I&#39;ve mentioned this in
&gt; &gt; &gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/issues/3">https://github.com/cburgmer/json-path-comparison/issues/3</a></span> where I&#39;d
</div></div>&gt; try
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;&gt; to
&gt; &gt; &gt;&gt; focus the general discussion on ordering for JSONPath, but wanted to
</div>&gt; &gt; call
<div class="message-stanza open">&gt; &gt; &gt;&gt; this out here once.
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Am Do., 12. Sept. 2019 um 17:24 Uhr schrieb Christoph Burgmer &lt;
&gt; &gt; &gt;&gt; christoph.burgmer@gmail.com&gt;:
&gt; &gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; I needed some time to think on this.
&gt; &gt; &gt;&gt; &gt;
&gt; &gt; &gt;&gt; &gt; What&#39;s currently making the outcome hard to compare is that a query
</div></div>&gt; &gt; like
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; `$[*]` on an object doesn&#39;t yield a stable representation. If there
</div></div>&gt; is
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;&gt; a,
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; say, simple way of achieving that, it would help, yes.
&gt; &gt; &gt;&gt; &gt; The ordering has to already be preserved when parsing the JSON
</div></div>&gt; &gt; document
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; though &#40;see
&gt; &gt; &gt;&gt; &gt;
</div>&gt; &gt; &gt;&gt;
</div>&gt; &gt;
</div>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9">https://github.com/cburgmer/json-path-comparison/blob/Perl_JSON-Path/implementations/Perl_JSON-Path/main.pl#L9</a></span>
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;&gt; &#41;,
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; as this already introduces indeterminism in Perl I believe &#40;as
</div>&gt; &gt; &gt;&gt; decode_json
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; returns a hash I believe&#41;. Python for example does allow that.
&gt; &gt; &gt;&gt; &gt;
&gt; &gt; &gt;&gt; &gt; Kit, my goal with the comparison project is to seek clarification on
</div>&gt; &gt; &gt;&gt; what
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; &#34;good&#34; JSONPath is &#40;including I guess when a certain order can be
&gt; &gt; &gt;&gt; &gt; guaranteed&#41;, but I&#39;m trying to keep my on personal opinion out of
</div></div></div>&gt; it,
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;&gt; hence
<div class="message-stanza open">&gt; &gt; &gt;&gt; &gt; the whole approach of comparing via consensus.
&gt; &gt; &gt;&gt; &gt;
&gt; &gt; &gt;&gt; &gt;
</div>&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt;
</div>&gt; &gt;
&gt; &gt; --
&gt; &gt; Kit Peters, W0KEH
&gt; &gt; GPG public key fingerpint: D4FF AA62 AFEA 83D6 CC98 ACE5 6FAE 7E74 7F56
&gt; &gt; ED1D
&gt; &gt; Hello to any and all NSA, DEA, or other government or non-government
</div>&gt; agents
<div class="message-stanza open">&gt; &gt; reading this email.  Tell me about your life; I&#39;ll tell you about mine.
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt;
</div>
-- 
Kit Peters, W0KEH
GPG public key fingerpint: D4FF AA62 AFEA 83D6 CC98 ACE5 6FAE 7E74 7F56 ED1D
Hello to any and all NSA, DEA, or other government or non-government agents
reading this email.  Tell me about your life; I&#39;ll tell you about mine.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
