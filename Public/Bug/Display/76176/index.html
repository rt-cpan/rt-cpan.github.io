<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76176 for MooseX-ClassCompositor: Roles which require methods cannot be composed</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76176 for MooseX-ClassCompositor: Roles which require methods cannot be composed</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=MooseX-ClassCompositor">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=MooseX-ClassCompositor">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=MooseX-ClassCompositor">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=MooseX-ClassCompositor">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/rjbs/MooseX-ClassCompositor/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/MooseX-ClassCompositor">MooseX-ClassCompositor CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76176</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=MooseX-ClassCompositor">MooseX-ClassCompositor</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
perl [...] toby.ink

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-239996-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
0.001</li>
<li>
0.002</li>
<li>
0.003</li>
<li>
0.004</li>
</ul>
    </td>
  </tr>
  <tr id="CF-239997-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




mxcc.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1056816/552917/mxcc.diff">
Fri Mar 30 17:15:40 2012 (1.7k) by perl [...] toby.ink
</a>
</font></li>
</ul>


mxcc.t<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1056816/552916/mxcc.t">
Fri Mar 30 17:15:40 2012 (457b) by perl [...] toby.ink
</a>
</font></li>
</ul>


signature.asc<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1121160/589837/signature.asc">
Tue Sep 18 07:58:40 2012 (490b) by rjbs [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=76176">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1056816" href="/Public/Bug/Display.html?id=76176#txn-1056816">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;30&nbsp;17:15:40&nbsp;2012</span>
    <span class="description">perl [...] toby.ink -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Roles which require methods cannot be composed</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1056816/552915/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/552915">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 304b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Given a role like:

{
  package MyRole;
  use Moose::Role;
  has monkeys =&gt; &#40;is =&gt; &#39;rw&#39;&#41;;
  requires &#39;bananas&#39;;
}

It will throw when you try to compose it with MXCC unless you also 
compose a role that implements bananas.

The attached patch &#40;and test case&#41; provides a simple solution for this 
problem.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> mxcc.t</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1056816/552916/mxcc.t">Download mxcc.t</a><br />
<span class="downloadcontenttype">text/x-perl 457b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">{
	package MyRole;
	use Moose::Role;
	has monkeys =&gt; &#40;is =&gt; &#39;rw&#39;&#41;;
	requires &#39;bananas&#39;;
}

use MooseX::ClassCompositor;
use Test::More tests =&gt; 3;

my $comp  = MooseX::ClassCompositor-&gt;new&#40;
	class_basename =&gt; &#39;MyClass&#39;,
	&#41;;
my $class = $comp-&gt;class_for&#40;
	{ bananas =&gt; sub { &#39;yellow ones&#39; } },
	&#39;MyRole&#39;,
	&#41;;
my $inst = $class-&gt;new&#40;monkeys =&gt; 1&#41;;

ok&#40;$inst-&gt;DOES&#40;&#39;MyRole&#39;&#41;, &#34;$class\-&gt;does&#40;&#39;MyRole&#39;&#41;&#34;&#41;;
can_ok&#40;$inst =&gt; &#39;bananas&#39;&#41;;
can_ok&#40;$inst =&gt; &#39;monkeys&#39;&#41;;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> mxcc.diff</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1056816/552917/mxcc.diff">Download mxcc.diff</a><br />
<span class="downloadcontenttype">text/x-diff 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- /usr/lib/perl5/site_perl/5.10.1/MooseX/ClassCompositor.pm	2012-02-14 21:46:00.000000000 +0000
+++ MooseX/ClassCompositor.pm	2012-03-30 21:31:20.806043797 +0100
@@ -98,11 +98,14 @@
 
   # $role_hash is a hash mapping nonce-names to role objects
   # $role_names is an array of names of more roles to add
-  my &#40;@roles, @role_class_names, @all_names&#41;;
+  my &#40;@roles, @role_class_names, @all_names, %subs&#41;;
 
   while &#40;@args&#41; {
     my $name = shift @args;
-    if &#40;ref $name&#41; {
+    if &#40;ref $name eq &#39;HASH&#39;&#41; {
+      $subs{$_} = $name-&gt;{$_} for keys %$name;
+      next;
+    } elsif &#40;ref $name eq &#39;ARRAY&#39;&#41; {
       my &#40;$role_name, $moniker, $params&#41; = @$name;
 
       my $full_name = $self-&gt;_rewrite_roles&#40;$role_name&#41;;
@@ -140,6 +143,7 @@
 
   my $class = Moose::Meta::Class-&gt;create&#40; $name =&gt; &#40;
     superclasses =&gt; [ &#39;Moose::Object&#39; ],
+    methods      =&gt; { %subs },
   &#41;&#41;;
 
   $class = Moose::Util::MetaRole::apply_metaroles&#40;
@@ -164,7 +168,11 @@
   my @k;
   while &#40;@args&#41; {
     my $arg = shift @args;
-    if &#40;ref $arg&#41; {
+    if &#40;ref $arg eq &#39;HASH&#39;&#41; {
+      push @k,
+        map { sprintf&#40;&#39;FUNC&#40;%s&#41;: { %s }&#39;, $_, refaddr&#40;$arg-&gt;{$_}&#41;&#41; }
+        sort keys %$arg;
+    } elsif &#40;ref $arg eq &#39;ARRAY&#39;&#41; {
       my &#40;$role_name, $moniker, $params&#41; = @$arg;
       push @k, &#34;$moniker : { &#34; . __hash_to_string&#40;$params&#41; . &#34; }&#34;;
     } else {
@@ -298,6 +306,14 @@
 Note that at present, passing Moose::Meta::Role objects is B&lt;not&gt; supported.
 This should change in the future.
 
+Additional methods that the class should provide may be passed as a hashref.
+This allows any methods required by the role to be implemented.
+
+  my $class = $compositor-&gt;class_for&#40;
+    &#39;Role::Name&#39;,
+    { my_method =&gt; sub { ... } },
+  &#41;;
+
 =head1 THANKS
 
 Thanks to Pobox.com for sponsoring the development of this library.
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121012" href="/Public/Bug/Display.html?id=76176#txn-1121012">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;23:08:21&nbsp;2012</span>
    <span class="description">rjbs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1121012/589748/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589748">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 844b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2012-03-30 17:15:40, TOBYINK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The attached patch &#40;and test case&#41; provides a simple solution for this 
&gt; problem.
</div>
My fundamental problem with this approach is that it breaks the reproducibility of the 
composition from the memoization table.  In the other cases, you can take the memoization 
table, save it to a file, and later reconstruct the classes that had been composed.

I&#39;d rather not bake into MXCC something that breaks that assumption.

What if, instead, you used a little role&#40;&#41; routine that built an anonymous role as needed with the 
provided methos.  It would require no changes to MXCC and might have plenty of other uses.

Thoughts?

Also, I apologize for the ridiculous delay in my reply.  I&#39;ve had this ticket flagged for reply for too 
long, and there&#39;s no excuse.  I just failed to get off my duff. :-&#40;

-- 
rjbs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121014" href="/Public/Bug/Display.html?id=76176#txn-1121014">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;23:08:22&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121015" href="/Public/Bug/Display.html?id=76176#txn-1121015">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;23:08:22&nbsp;2012</span>
    <span class="description">rjbs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121099" href="/Public/Bug/Display.html?id=76176#txn-1121099">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;18&nbsp;04:38:32&nbsp;2012</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1121099/589797/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589797">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 991b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">For some reason it&#39;s not working.

```
use strict;
use warnings;
use Moose &#40;&#41;;
use MooseX::ClassCompositor &#40;&#41;;

sub methods {
        my $r = Moose::Meta::Role-&gt;create_anon_role&#40;
                methods =&gt; &#40; ref $_[0] eq &#39;HASH&#39; ? $_[0] : +{@_} &#41;,
        &#41;;
        return $r-&gt;name;
}

my @roles = &#40;
        methods&#40; true  =&gt; sub { print &#34;true\n&#34;  } &#41;,
        methods&#40; false =&gt; sub { print &#34;false\n&#34; } &#41;,
&#41;;

my $class = MooseX::ClassCompositor-&gt;new&#40;class_basename =&gt; &#39;My&#39;&#41;-
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;class_for&#40;@roles&#41;;
</div>
my $object = $class-&gt;new;
&#40;$object-&gt;can&#40;&#39;true&#39;&#41; &#38;&#38; $object-&gt;can&#40;&#39;false&#39;&#41;&#41;
        ? $object-&gt;true
        : $object-&gt;false;
```

Class::MOP::load_class appears to be attempting to re-load the role&#39;s 
&#34;.pm&#34; file from disk &#40;which of course doesn&#39;t exist&#41;. Adding a dummy 
entry to %INC doesn&#39;t seem to fix things either.

Can&#39;t locate Moose/Meta/Role/__ANON__/SERIAL/7.pm in @INC &#40;@INC 
contains: ...&#41; at .../Module/Runtime.pm line 317.
 at moose-role.pl line 18.

I have up to date versions of Moose, MooseX::ClassCompositor and 
Class::Load. Perl is 5.16.0.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121101" href="/Public/Bug/Display.html?id=76176#txn-1121101">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;18&nbsp;04:38:33&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121102" href="/Public/Bug/Display.html?id=76176#txn-1121102">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;18&nbsp;04:48:15&nbsp;2012</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1121102/589799/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589799">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 728b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">OK, for some reason I need to create a dummy name for my role. 
Anonymous roles don&#39;t work with MooseX::ClassCompositor...

use strict;
use warnings;
use thanks &#40;&#41;;
use Moose &#40;&#41;;
use MooseX::ClassCompositor &#40;&#41;;

my $anon;
sub methods {
        my $r = Moose::Meta::Role-&gt;create&#40;
                &#40;&#39;This::Is::Not::Really::Anon::Role&#39;.++$anon&#41;,
                methods =&gt; &#40; ref $_[0] eq &#39;HASH&#39; ? $_[0] : +{@_} &#41;,
        &#41;;
        thanks-&gt;unimport&#40;$r-&gt;name&#41;;
        return $r-&gt;name;
}

my @roles = &#40;
        methods&#40; true  =&gt; sub { print &#34;true\n&#34;  } &#41;,
        methods&#40; false =&gt; sub { print &#34;false\n&#34; } &#41;,
&#41;;

Class::MOP::load_class&#40;$_&#41; for @roles;

my $class = MooseX::ClassCompositor-&gt;new&#40;class_basename =&gt; &#39;My&#39;&#41;-
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;class_for&#40;@roles&#41;;
</div>
my $object = $class-&gt;new;
1 ? $object-&gt;true : $object-&gt;false;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121160" href="/Public/Bug/Display.html?id=76176#txn-1121160">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;18&nbsp;07:58:40&nbsp;2012</span>
    <span class="description">rjbs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76176] Roles which require methods cannot be composed</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 18 Sep 2012 07:58:25 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Toby Inkster via RT &lt;bug-MooseX-ClassCompositor [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ricardo Signes &lt;rjbs [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1121160/589836/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589836">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 717b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Toby Inkster via RT &lt;bug-MooseX-ClassCompositor@rt.cpan.org&gt; [2012-09-18T04:48:15]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MooseX-ClassCompositor
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76176">https://rt.cpan.org/Ticket/Display.html?id=76176</a></span> &gt;
&gt; 
&gt; OK, for some reason I need to create a dummy name for my role. 
&gt; Anonymous roles don&#39;t work with MooseX::ClassCompositor...
</div>
Even &#34;anonymous&#34; roles have names, I think!  I&#39;ll look into figuring out what
the heck is going on, here.  It seems pretty weird to me!  My only guess is
that they don&#39;t get put into a package, so the $r object is garbage collected
when you just return the name.

What if you return the role object, then use its name while $r is still
referenced?

&#40;Also, I&#39;ll try that myself later.&#41;

-- 
rjbs
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1121160/589837/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 490b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121183" href="/Public/Bug/Display.html?id=76176#txn-1121183">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;18&nbsp;09:05:45&nbsp;2012</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1121183/589852/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589852">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 172b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; My only guess is that they don&#39;t get put into a package, 
&gt; so the $r object is garbage collected when you just return
&gt; the name.
</div>
Spot on! Class::MOP::Package::DESTROY.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1121186" href="/Public/Bug/Display.html?id=76176#txn-1121186">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;18&nbsp;11:16:37&nbsp;2012</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1121186/589854/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589854">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 182b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fork with support for Moose::Meta::Role objects, including anonymous 
roles.

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/tobyink/MooseX-ClassCompositor">https://github.com/tobyink/MooseX-ClassCompositor</a></span>

The fork includes extra test cases and documentation.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271335" href="/Public/Bug/Display.html?id=76176#txn-1271335">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;05&nbsp;09:00:41&nbsp;2013</span>
    <span class="description">rjbs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1271335/673202/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/673202">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 44b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This was merged in 0.005.

Thanks!

-- 
rjbs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271337" href="/Public/Bug/Display.html?id=76176#txn-1271337">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;05&nbsp;09:00:42&nbsp;2013</span>
    <span class="description">rjbs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.622957</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
