<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #77229 for Bread-Board: params available to all objects, not just the requested</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #77229 for Bread-Board: params available to all objects, not just the requested</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Bread-Board/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Bread-Board/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Bread-Board/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Bread-Board/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/stevan/BreadBoard/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Bread-Board">Bread-Board CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">77229</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Bread-Board/Active/">Bread-Board</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
xenoterracide [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-220110-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-220111-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;15&nbsp;18:50:43&nbsp;2012</span>
    <span class="description">xenoterracide [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> params available to all objects, not just the requested</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 15 May 2012 17:50:28 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bugs-bread-board [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Caleb Cushing &lt;xenoterracide [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The general problem is that I need to pass a parameter to an object,
that is a dependency of the one I&#39;m requesting, and in fact it&#39;s
several layers below.

<span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/questions/9917576/default-replacable-values-in-breadboard">http://stackoverflow.com/questions/9917576/default-replacable-values-in-breadboard</a></span>

an example of this problem is my Business::CyberSource module which
I&#39;m starting to use BB to reduce my test boilerplate. I want to BB
Authorization Responses. CyberSource uses predefined total values to
allow you to send tests which will give you different responses.


 It&#39;d be nice if parameters could either A&#41; be available to every
single service/container, or B I could have a way to say, this
parameter is for this service. Maybe

$c-&gt;resolve&#40; service =&gt; &#39;/response/authorization&#39;, parameters =&gt; {
&#39;/request/total&#39; =&gt;{  total =&gt; 3000.37 } } &#41;; # this particular total
will make the request return a REJECT due to expired credit card,
irregardless of whether the card actually has an expired date. This
code would only require me to have a parameter in total, that could
have a default and I&#39;d be ok with it being a block, but things that
depend on it could still be a class.

... here&#39;s my code as it stands today so you can get an idea of what
I&#39;m talking about, currently it doesn&#39;t pass any parameters at all,
because it was easier for me to leave the existing authorization that
I&#39;d created in my tests than try passing the parameter from block to
block.

package Test::Business::CyberSource;
use Moose;
use Bread::Board;

extends &#39;Bread::Board::Container&#39;;

sub BUILD {
    my $self = shift;
    return container $self =&gt; as {
        container client =&gt; as {
            service username   =&gt; &#34;$ENV{PERL_BUSINESS_CYBERSOURCE_USERNAME}&#34;;
            service password   =&gt; &#34;$ENV{PERL_BUSINESS_CYBERSOURCE_PASSWORD}&#34;;
            service production =&gt; 0;
            service object     =&gt; &#40;
                class        =&gt; &#39;Business::CyberSource::Client&#39;,
                lifecycle    =&gt; &#39;Singleton&#39;,
                dependencies =&gt; {
                    username   =&gt; depends_on&#40;&#39;username&#39;&#41;,
                    password   =&gt; depends_on&#40;&#39;password&#39;&#41;,
                    production =&gt; depends_on&#40;&#39;production&#39;&#41;,
                },
            &#41;;
        };

        container credit_card =&gt; as {
            service holder     =&gt; &#39;Caleb Cushing&#39;;
            service expiration =&gt; &#40;
                block =&gt; sub { return { month =&gt; 5, year =&gt; 2025 } },
            &#41;;
            service security_code =&gt; &#39;1111&#39;;
            service visa_test_number =&gt; &#39;4111-1111-1111-1111&#39;;
            service visa =&gt; &#40;
                class        =&gt; &#39;Business::CyberSource::CreditCard&#39;,
                lifecycle    =&gt; &#39;Singleton&#39;,
                dependencies =&gt; {
                    account_number =&gt; depends_on&#40;&#39;visa_test_number&#39;&#41;,
                    expiration     =&gt; depends_on&#40;&#39;expiration&#39;&#41;,
                    security_code  =&gt; depends_on&#40;&#39;security_code&#39;&#41;,
                    holder         =&gt; depends_on&#40;&#39;holder&#39;&#41;,
                },
            &#41;;
        };

        container request =&gt; as {
            service reference_code =&gt; &#40;
                lifecycle =&gt; &#39;Singleton&#39;,
                block     =&gt; sub { return &#39;test-&#39; . time },
            &#41;;
            service first_name     =&gt; &#39;Caleb&#39;;
            service last_name      =&gt; &#39;Cushing&#39;;
            service street         =&gt; &#39;somewhere&#39;;
            service city           =&gt; &#39;Houston&#39;;
            service state          =&gt; &#39;TX&#39;;
            service postal_code    =&gt; &#39;77064&#39;;
            service country        =&gt; &#39;USA&#39;;
            service email          =&gt; &#39;xenoterracide@gmail.com&#39;;
            service ip_address     =&gt; &#39;192.168.100.2&#39;;
            service total          =&gt; 5.00;
            service currency       =&gt; &#39;USD&#39;;
            container authorization =&gt; as {
                service visa =&gt; &#40;
                    class =&gt; &#39;Business::CyberSource::Request::Authorization&#39;,
                    dependencies =&gt; {
                        card           =&gt; depends_on&#40;&#39;/credit_card/visa&#39;&#41;,
                        reference_code =&gt; depends_on&#40;&#39;../reference_code&#39;&#41;,
                        first_name     =&gt; depends_on&#40;&#39;../first_name&#39;&#41;,
                        last_name      =&gt; depends_on&#40;&#39;../last_name&#39;&#41;,
                        street         =&gt; depends_on&#40;&#39;../street&#39;&#41;,
                        city           =&gt; depends_on&#40;&#39;../city&#39;&#41;,
                        state          =&gt; depends_on&#40;&#39;../state&#39;&#41;,
                        postal_code    =&gt; depends_on&#40;&#39;../postal_code&#39;&#41;,
                        country        =&gt; depends_on&#40;&#39;../country&#39;&#41;,
                        email          =&gt; depends_on&#40;&#39;../email&#39;&#41;,
                        ip_address     =&gt; depends_on&#40;&#39;../ip_address&#39;&#41;,
                        total          =&gt; depends_on&#40;&#39;../total&#39;&#41;,
                        currency       =&gt; depends_on&#40;&#39;../currency&#39;&#41;,
                    },
                &#41;;
            };
        };

        container response =&gt; as {
            container authorization =&gt; as {
                service visa =&gt; &#40;
                    block =&gt; sub {
                        my $s = shift;

                        return $s
                            -&gt;param&#40;&#39;client&#39;&#41;
                            -&gt;run_transaction&#40; $s-&gt;param&#40;&#39;auth&#39;&#41; &#41;;
                    },
                    dependencies =&gt; {
                        client =&gt; depends_on&#40;&#39;/client/object&#39;&#41;,
                        auth   =&gt; depends_on&#40;&#39;/request/authorization/visa&#39;&#41;,
                    },
                &#41;;
            };
        };
    };
}

has &#39;+name&#39; =&gt; &#40; default =&gt; sub { __PACKAGE__ }, &#41;;

__PACKAGE__-&gt;meta-&gt;make_immutable;
1;

-- 
Caleb Cushing

<span class="clickylink"><a target="new" rel="nofollow" href="http://xenoterracide.com">http://xenoterracide.com</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;15&nbsp;19:41:21&nbsp;2012</span>
    <span class="description">stevan.little [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77229] params available to all objects, not just the requested </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 15 May 2012 19:41:00 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Bread-Board [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stevan Little &lt;stevan.little [...] iinteractive.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Caleb,

So I see where you are going on this one, but I think the flaw in your design is in the response/authorization/visa service. You should not be doing the run_transaction inside of Bread::Board, that is application level code.

This is sometimes one of the confusion points with Bread::Board, exactly where to draw the line. The key goal of Bread::Board, and of most IoC/DI frameworks, is to construct your objects. One of my favorite descriptions of this was that DI is like &#34;the inverse of garbage collection&#34;. 

So, that said, I suggest you move the response/authorization/visa code into your application/tests and not try and do that in Bread::Board. If you do that, then your issue kind of disappears.

Additionally, a few tricks I have learned. 

- You can add defaults to parameters &#40;they accept the exact same form that MooseX::Params::Validate accepts&#41;, this would allow you to put in defaults, but make it possible to specify them when you need them.

- You can have something be an optional parameter AND be a dependency. The result of this will be that if the parameter is specified then it will use that, otherwise it will use the dependency. This is basically another way to get the default, but honestly, it is kinda a hack and leads to some level of duplication in your parameters and dependencies.

- You can pass parameters down to a lower level statically, here is an example: <span class="clickylink"><a target="new" rel="nofollow" href="https://www.metacpan.org/source/STEVAN/Bread-Board-0.25/t/045_parameters_in_dependency.t">https://www.metacpan.org/source/STEVAN/Bread-Board-0.25/t/045_parameters_in_dependency.t</a></span> this fixes the values passed in by parameter, which may or may not be helpful to you.

Not sure how much any of those tricks would help you, but I think that changing your test code from:

$c-&gt;resolve&#40; service =&gt; &#39;/response/authorization/visa&#39; &#41;;

to:

$c-&gt;resolve&#40; service =&gt; &#39;/client/object&#39; &#41;-&gt;run_transaction&#40;
    $c-&gt;resolve&#40; 
        service =&gt; &#39;/request/authorization/visa&#39;,
        parameters =&gt; { total =&gt; 500.00 }
    &#41;
&#41;;

will not be too much additional boilerplate in comparison to the flexibility it will give you.

NOTE: all this said, if you want to make deep parameter stuff, I would take a patch that supports something like:

$c-&gt;resolve&#40; service =&gt; &#39;/response/authorization/visa&#39;, parameters =&gt; { &#39;/request/authorization/visa/total&#39; =&gt; 500.00 } &#41;;

Although I am not sure this will be possible giving the build order, but hey, you are welcome to try.

Thanks,

- Stevan


On May 15, 2012, at 6:50 PM, Caleb Cushing via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue May 15 18:50:43 2012: Request 77229 was acted upon.
&gt; Transaction: Ticket created by XENO
&gt;       Queue: Bread-Board
&gt;     Subject: params available to all objects, not just the requested
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: &#40;no value&#41;
&gt;       Owner: Nobody
&gt;  Requestors: xenoterracide@gmail.com
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77229">https://rt.cpan.org/Ticket/Display.html?id=77229</a></span> &gt;
&gt; 
&gt; 
&gt; The general problem is that I need to pass a parameter to an object,
&gt; that is a dependency of the one I&#39;m requesting, and in fact it&#39;s
&gt; several layers below.
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/questions/9917576/default-replacable-values-in-breadboard">http://stackoverflow.com/questions/9917576/default-replacable-values-in-breadboard</a></span>
&gt; 
&gt; an example of this problem is my Business::CyberSource module which
&gt; I&#39;m starting to use BB to reduce my test boilerplate. I want to BB
&gt; Authorization Responses. CyberSource uses predefined total values to
&gt; allow you to send tests which will give you different responses.
&gt; 
&gt; 
&gt; It&#39;d be nice if parameters could either A&#41; be available to every
&gt; single service/container, or B I could have a way to say, this
&gt; parameter is for this service. Maybe
&gt; 
&gt; $c-&gt;resolve&#40; service =&gt; &#39;/response/authorization&#39;, parameters =&gt; {
&gt; &#39;/request/total&#39; =&gt;{  total =&gt; 3000.37 } } &#41;; # this particular total
&gt; will make the request return a REJECT due to expired credit card,
&gt; irregardless of whether the card actually has an expired date. This
&gt; code would only require me to have a parameter in total, that could
&gt; have a default and I&#39;d be ok with it being a block, but things that
&gt; depend on it could still be a class.
&gt; 
&gt; ... here&#39;s my code as it stands today so you can get an idea of what
&gt; I&#39;m talking about, currently it doesn&#39;t pass any parameters at all,
&gt; because it was easier for me to leave the existing authorization that
&gt; I&#39;d created in my tests than try passing the parameter from block to
&gt; block.
&gt; 
&gt; package Test::Business::CyberSource;
&gt; use Moose;
&gt; use Bread::Board;
&gt; 
&gt; extends &#39;Bread::Board::Container&#39;;
&gt; 
&gt; sub BUILD {
&gt;    my $self = shift;
&gt;    return container $self =&gt; as {
&gt;        container client =&gt; as {
&gt;            service username   =&gt; &#34;$ENV{PERL_BUSINESS_CYBERSOURCE_USERNAME}&#34;;
&gt;            service password   =&gt; &#34;$ENV{PERL_BUSINESS_CYBERSOURCE_PASSWORD}&#34;;
&gt;            service production =&gt; 0;
&gt;            service object     =&gt; &#40;
&gt;                class        =&gt; &#39;Business::CyberSource::Client&#39;,
&gt;                lifecycle    =&gt; &#39;Singleton&#39;,
&gt;                dependencies =&gt; {
&gt;                    username   =&gt; depends_on&#40;&#39;username&#39;&#41;,
&gt;                    password   =&gt; depends_on&#40;&#39;password&#39;&#41;,
&gt;                    production =&gt; depends_on&#40;&#39;production&#39;&#41;,
&gt;                },
&gt;            &#41;;
&gt;        };
&gt; 
&gt;        container credit_card =&gt; as {
&gt;            service holder     =&gt; &#39;Caleb Cushing&#39;;
&gt;            service expiration =&gt; &#40;
&gt;                block =&gt; sub { return { month =&gt; 5, year =&gt; 2025 } },
&gt;            &#41;;
&gt;            service security_code =&gt; &#39;1111&#39;;
&gt;            service visa_test_number =&gt; &#39;4111-1111-1111-1111&#39;;
&gt;            service visa =&gt; &#40;
&gt;                class        =&gt; &#39;Business::CyberSource::CreditCard&#39;,
&gt;                lifecycle    =&gt; &#39;Singleton&#39;,
&gt;                dependencies =&gt; {
&gt;                    account_number =&gt; depends_on&#40;&#39;visa_test_number&#39;&#41;,
&gt;                    expiration     =&gt; depends_on&#40;&#39;expiration&#39;&#41;,
&gt;                    security_code  =&gt; depends_on&#40;&#39;security_code&#39;&#41;,
&gt;                    holder         =&gt; depends_on&#40;&#39;holder&#39;&#41;,
&gt;                },
&gt;            &#41;;
&gt;        };
&gt; 
&gt;        container request =&gt; as {
&gt;            service reference_code =&gt; &#40;
&gt;                lifecycle =&gt; &#39;Singleton&#39;,
&gt;                block     =&gt; sub { return &#39;test-&#39; . time },
&gt;            &#41;;
&gt;            service first_name     =&gt; &#39;Caleb&#39;;
&gt;            service last_name      =&gt; &#39;Cushing&#39;;
&gt;            service street         =&gt; &#39;somewhere&#39;;
&gt;            service city           =&gt; &#39;Houston&#39;;
&gt;            service state          =&gt; &#39;TX&#39;;
&gt;            service postal_code    =&gt; &#39;77064&#39;;
&gt;            service country        =&gt; &#39;USA&#39;;
&gt;            service email          =&gt; &#39;xenoterracide@gmail.com&#39;;
&gt;            service ip_address     =&gt; &#39;192.168.100.2&#39;;
&gt;            service total          =&gt; 5.00;
&gt;            service currency       =&gt; &#39;USD&#39;;
&gt;            container authorization =&gt; as {
&gt;                service visa =&gt; &#40;
&gt;                    class =&gt; &#39;Business::CyberSource::Request::Authorization&#39;,
&gt;                    dependencies =&gt; {
&gt;                        card           =&gt; depends_on&#40;&#39;/credit_card/visa&#39;&#41;,
&gt;                        reference_code =&gt; depends_on&#40;&#39;../reference_code&#39;&#41;,
&gt;                        first_name     =&gt; depends_on&#40;&#39;../first_name&#39;&#41;,
&gt;                        last_name      =&gt; depends_on&#40;&#39;../last_name&#39;&#41;,
&gt;                        street         =&gt; depends_on&#40;&#39;../street&#39;&#41;,
&gt;                        city           =&gt; depends_on&#40;&#39;../city&#39;&#41;,
&gt;                        state          =&gt; depends_on&#40;&#39;../state&#39;&#41;,
&gt;                        postal_code    =&gt; depends_on&#40;&#39;../postal_code&#39;&#41;,
&gt;                        country        =&gt; depends_on&#40;&#39;../country&#39;&#41;,
&gt;                        email          =&gt; depends_on&#40;&#39;../email&#39;&#41;,
&gt;                        ip_address     =&gt; depends_on&#40;&#39;../ip_address&#39;&#41;,
&gt;                        total          =&gt; depends_on&#40;&#39;../total&#39;&#41;,
&gt;                        currency       =&gt; depends_on&#40;&#39;../currency&#39;&#41;,
&gt;                    },
&gt;                &#41;;
&gt;            };
&gt;        };
&gt; 
&gt;        container response =&gt; as {
&gt;            container authorization =&gt; as {
&gt;                service visa =&gt; &#40;
&gt;                    block =&gt; sub {
&gt;                        my $s = shift;
&gt; 
&gt;                        return $s
&gt;                            -&gt;param&#40;&#39;client&#39;&#41;
&gt;                            -&gt;run_transaction&#40; $s-&gt;param&#40;&#39;auth&#39;&#41; &#41;;
&gt;                    },
&gt;                    dependencies =&gt; {
&gt;                        client =&gt; depends_on&#40;&#39;/client/object&#39;&#41;,
&gt;                        auth   =&gt; depends_on&#40;&#39;/request/authorization/visa&#39;&#41;,
&gt;                    },
&gt;                &#41;;
&gt;            };
&gt;        };
&gt;    };
&gt; }
&gt; 
&gt; has &#39;+name&#39; =&gt; &#40; default =&gt; sub { __PACKAGE__ }, &#41;;
&gt; 
&gt; __PACKAGE__-&gt;meta-&gt;make_immutable;
&gt; 1;
&gt; 
&gt; -- 
&gt; Caleb Cushing
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://xenoterracide.com">http://xenoterracide.com</a></span>
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;15&nbsp;19:41:23&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;12&nbsp;12:25:27&nbsp;2013</span>
    <span class="description">DOY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think this can be closed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;12&nbsp;12:25:28&nbsp;2013</span>
    <span class="description">DOY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
