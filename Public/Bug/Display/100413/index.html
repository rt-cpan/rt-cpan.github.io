<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #100413 for Perl6-Form: Issues with Declarative Widh and Zero-Paddidng fields</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #100413 for Perl6-Form: Issues with Declarative Widh and Zero-Paddidng fields</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl6-Form/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl6-Form/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl6-Form/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl6-Form/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl6-Form">Perl6-Form CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">100413</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl6-Form/Active/">Perl6-Form</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
chris [...] cuberootent.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-25330-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-25331-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;17&nbsp;20:27:17&nbsp;2014</span>
    <span class="description">chris [...] cuberootent.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Issues with Declarative Widh and Zero-Paddidng fields</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Nov 2014 19:26:59 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl6-Form [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christopher Pearson &lt;chris [...] cuberootent.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perl6::Form

Perl v5.20.1 on Linux 3.16.0-25-generic #33-Ubuntu SMP x86_64 x86_64 
x86_64 GNU/Linux

The code produces the corresponding included errors.

Not sure if I&#39;m doing something wrong, or if something get off or if 
I&#39;m missing just breaking it through incorrect use.

==============================================

# Test Perl6::Form -- submitting code for Perl Monks

# zero-padded fields appears to be broken
# Declarative width fields appears to calculate the field length
# incorrectly
use strict;
use warnings;
use diagnostics;
use Perl6::Form;

my $columns = 44;

my $fID = &#34;TEST&#34;;
my $tID = &#34;003  &#34;;
my $space = &#34; &#34;;
my $fPer = &#34;Test&#34;;
my $tPer = &#34;100.0&#34;;

my $fVal = &#34;Int for Zero Pad&#34;;
my $tVal = &#34;3&#34;;
my $fFlo = &#34;Float for Zero Pad&#34;;
my $tFlo = 3.2;

# Produces error for invalid field length

  print &#34;Length = &#34; . length&#40;$tID&#41; . &#34;\n&#34;;

  print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
    &#34;{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}|{&gt;&lt;}|{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}%|&#34;,
    $fID, $tID, $space, $fPer, $tPer;



# Produces Unintialized value $whole in patter match &#40;m//&#41; error
  print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
    &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;&gt;&gt;}&#34;,
    $fVal, $tVal,
    &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;.&gt;&gt;0}&#34;,
    $fFlo, $tFlo;

==============================================

Invalid field length error:
Length = 5
Uncaught exception from user code:
        Inconsistent width for field 2.
        Specified as &#39;{&gt;&#40;5&#41;&gt;}&#39; but actual width is 7
        in call to &#38;form at test_perl6Form.pl line 33.
        Perl6::Form::fatal&#40;&#34;Inconsistent width for field 2.\x{a}&#34;, &#34;Specified 
as &#39;{&gt;&#40;5&#41;&gt;}&#39; but actual width is 7&#34;&#41; called at 
/usr/local/share/perl/5.20.1/Perl6/Form.pm line 663
        Perl6::Form::segment&#40;&#34;{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}|{&gt;&lt;}|{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}%|\x{a}&#34;, 
ARRAY&#40;0x1e676b8&#41;, HASH&#40;0x1e5d400&#41;, 0, HASH&#40;0x1e5d448&#41;&#41; called at 
/usr/local/share/perl/5.20.1/Perl6/Form.pm line 1097
        Perl6::Form::form&#40;undef, undef, &#34;TEST&#34;, &#34;003  &#34;, &#34; &#34;, &#34;Test&#34;, 100.0&#41; 
called at test_perl6Form.pl line 33

==============================================

Unintialized value $whole in patter match &#40;m//&#41; error:
Use of uninitialized value $whole in pattern match &#40;m//&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 340 &#40;#1&#41;
    &#40;W uninitialized&#41; An undefined value was used as if it were already
    defined.  It was interpreted as a &#34;&#34; or a 0, but maybe it was a 
mistake.
    To suppress this warning assign a defined value to your variables.

    To help you figure out what was undefined, perl will try to tell you
    the name of the variable &#40;if any&#41; that was undefined.  In some cases
    it cannot do this, so it also tells you what operation you used the
    undefined value in.  Note, however, that perl optimizes your program
    and the operation displayed in the warning may not necessarily 
appear
    literally in your program.  For example, &#34;that $foo&#34; is usually
    optimized into &#34;that &#34; . $foo, and the warning will refer to the
    concatenation &#40;.&#41; operator, even though there is no . in
    your program.

Use of uninitialized value $places in pattern match &#40;m//&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 341 &#40;#1&#41;
Use of uninitialized value $whole in pattern match &#40;m//&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 342 &#40;#1&#41;
Use of uninitialized value $whole in repeat &#40;x&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 359 &#40;#1&#41;
Use of uninitialized value $point in concatenation &#40;.&#41; or string at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 359 &#40;#1&#41;
Use of uninitialized value $places in repeat &#40;x&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 359 &#40;#1&#41;
Use of uninitialized value $whole in repeat &#40;x&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 360 &#40;#1&#41;
Use of uninitialized value $point in concatenation &#40;.&#41; or string at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 360 &#40;#1&#41;
Use of uninitialized value $places in repeat &#40;x&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 360 &#40;#1&#41;
Use of uninitialized value $point in string ne at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 369 &#40;#1&#41;
Use of uninitialized value $whole in numeric gt &#40;&gt;&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 399 &#40;#1&#41;
Use of uninitialized value $w in concatenation &#40;.&#41; or string at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 403 &#40;#1&#41;
Use of uninitialized value $p in concatenation &#40;.&#41; or string at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 403 &#40;#1&#41;
Use of uninitialized value $point in concatenation &#40;.&#41; or string at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 412 &#40;#1&#41;
Use of uninitialized value $whole in subtraction &#40;-&#41; at
        /usr/local/share/perl/5.20.1/Perl6/Form.pm line 413 &#40;#1&#41;
Int for Zero Pad
Float for Zero Pad       .
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;17&nbsp;21:04:29&nbsp;2014</span>
    <span class="description">DCONWAY [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;17&nbsp;21:04:40&nbsp;2014</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100413] Issues with Declarative Widh and Zero-Paddidng fields</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 18 Nov 2014 13:03:52 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl6-Form [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Chris,

These are not bugs, just incorrect usages.

In the first call to form&#40;&#41;, the format:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     &#34;{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}|{&gt;&lt;}|{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}%|&#34;,
</div>
...is invalid. A number in parens within a field is a checksum, and
specifies that the field must physically be the same number of
characters wide as the number specifies. So {&gt;&#40;5&#41;&gt;} is an error, because
it specifies a required width of 5, but the field itself is actually 7
characters wide. You probably want a declarative width specifier like:
{&gt;{5}&gt;} instead &#40;a braced number inside a field specifies how wide the
field should be treated as, regardless of its actual physical width&#41;.

In the second call to form&#40;&#41;, the format:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;&gt;&gt;}&#34;,
</div>
...is also invalid. Declarative in-field zero padding only applies to
numeric fields &#40;i.e. fields of the form {0&gt;&gt;&gt;.&lt;&lt;}&#41;.

Furthermore, the second format:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;.&gt;&gt;0}&#34;,
</div>
...is invalid too. Its second field is not a valid numeric field specifier,
which must have both sets of arrows pointing towards the decimal point.

So what you needed was:

  print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
    &#34;{&lt;&lt;{20}&lt;&lt;}{&gt;&gt;&gt;&gt;&gt;}&#34;,
     $fVal,    {lfill=&gt;0},$tVal,     # Specify $tVal to be left-filled with 0&#39;s
    &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;.&lt;&lt;&lt;}&#34;,   # Specify $tFlo field to be a numeric field
     $fFlo,   $tFlo;

I&#39;ve appended a fully corrected version of your example, which works as
I think you would wish.

Hope this helps,

Damian

-----cut-----

use strict;
use warnings;
use diagnostics;
use Perl6::Form;

my $columns = 44;

my $fID = &#34;TEST&#34;;
my $tID = &#34;003  &#34;;
my $space = &#34; &#34;;
my $fPer = &#34;Test&#34;;
my $tPer = &#34;100.0&#34;;

my $fVal = &#34;Int for Zero Pad&#34;;
my $tVal = &#34;3&#34;;
my $fFlo = &#34;Float for Zero Pad&#34;;
my $tFlo = 3.2;

# Produces error for invalid field length

  print &#34;Length = &#34; . length&#40;$tID&#41; . &#34;\n&#34;;

  print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
    &#34;{&lt;&lt;{15}&lt;&lt;}|{&gt;{5}&gt;}|{&gt;&lt;}|{&lt;&lt;{15}&lt;&lt;}|{&gt;{5}&gt;}%|&#34;,
    $fID, $tID, $space, $fPer, $tPer;



# Produces Unintialized value $whole in patter match &#40;m//&#41; error
  print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
    &#34;{&lt;&lt;{20}&lt;&lt;}{&gt;&gt;&gt;&gt;&gt;}&#34;,
    $fVal, {lfill=&gt;0},$tVal,
    &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;.&lt;&lt;0}&#34;,
    $fFlo, $tFlo;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;17&nbsp;21:34:57&nbsp;2014</span>
    <span class="description">chris [...] cuberootent.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100413] Issues with Declarative Widh and Zero-Paddidng fields</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Nov 2014 20:34:45 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl6-Form [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christopher &lt;chris [...] cuberootent.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Damian,

Thank you, it&#39;s particularly helpful with what I was hoping to use.
However, I&#39;m not sure the declarative part is exactly addressed.  The
length give by perl shows that the field is actually 5 positions.  That&#39;s
why I was wondering about it.  It seems that {&gt;&#40;5&#41;&gt;} should work if my
value is registering from perl as 5 characters.  Instead, form is calling
it 7 characters.  I&#39;m fully satisfied that the issue is resolved, but now
I&#39;m curious as to why perl would say $tID is length 5 but form would say
$tID is length 7.

My real issue was with the zero-padding, so I&#39;m satisfied with the fact
that I just wasn&#39;t paying close enough attention.

Thank you,
Christopher

On Mon, Nov 17, 2014 at 8:04 PM, damian@conway.org via RT &lt;
bug-Perl6-Form@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100413">https://rt.cpan.org/Ticket/Display.html?id=100413</a></span> &gt;
&gt;
&gt; Hi Chris,
&gt;
&gt; These are not bugs, just incorrect usages.
&gt;
&gt; In the first call to form&#40;&#41;, the format:
&gt;
<div class="message-stanza open">&gt; &gt;     &#34;{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}|{&gt;&lt;}|{&lt;&lt;{15}&lt;&lt;}|{&gt;&#40;5&#41;&gt;}%|&#34;,
</div>&gt;
&gt; ...is invalid. A number in parens within a field is a checksum, and
&gt; specifies that the field must physically be the same number of
&gt; characters wide as the number specifies. So {&gt;&#40;5&#41;&gt;} is an error, because
&gt; it specifies a required width of 5, but the field itself is actually 7
&gt; characters wide. You probably want a declarative width specifier like:
&gt; {&gt;{5}&gt;} instead &#40;a braced number inside a field specifies how wide the
&gt; field should be treated as, regardless of its actual physical width&#41;.
&gt;
&gt; In the second call to form&#40;&#41;, the format:
&gt;
<div class="message-stanza open">&gt; &gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;&gt;&gt;}&#34;,
</div>&gt;
&gt; ...is also invalid. Declarative in-field zero padding only applies to
&gt; numeric fields &#40;i.e. fields of the form {0&gt;&gt;&gt;.&lt;&lt;}&#41;.
&gt;
&gt; Furthermore, the second format:
&gt;
<div class="message-stanza open">&gt; &gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;.&gt;&gt;0}&#34;,
</div>&gt;
&gt; ...is invalid too. Its second field is not a valid numeric field specifier,
&gt; which must have both sets of arrows pointing towards the decimal point.
&gt;
&gt; So what you needed was:
&gt;
&gt;   print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
&gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{&gt;&gt;&gt;&gt;&gt;}&#34;,
&gt;      $fVal,    {lfill=&gt;0},$tVal,     # Specify $tVal to be left-filled
&gt; with 0&#39;s
&gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;.&lt;&lt;&lt;}&#34;,   # Specify $tFlo field to be a numeric field
&gt;      $fFlo,   $tFlo;
&gt;
&gt; I&#39;ve appended a fully corrected version of your example, which works as
&gt; I think you would wish.
&gt;
&gt; Hope this helps,
&gt;
&gt; Damian
&gt;
&gt; -----cut-----
&gt;
&gt; use strict;
&gt; use warnings;
&gt; use diagnostics;
&gt; use Perl6::Form;
&gt;
&gt; my $columns = 44;
&gt;
&gt; my $fID = &#34;TEST&#34;;
&gt; my $tID = &#34;003  &#34;;
&gt; my $space = &#34; &#34;;
&gt; my $fPer = &#34;Test&#34;;
&gt; my $tPer = &#34;100.0&#34;;
&gt;
&gt; my $fVal = &#34;Int for Zero Pad&#34;;
&gt; my $tVal = &#34;3&#34;;
&gt; my $fFlo = &#34;Float for Zero Pad&#34;;
&gt; my $tFlo = 3.2;
&gt;
&gt; # Produces error for invalid field length
&gt;
&gt;   print &#34;Length = &#34; . length&#40;$tID&#41; . &#34;\n&#34;;
&gt;
&gt;   print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
&gt;     &#34;{&lt;&lt;{15}&lt;&lt;}|{&gt;{5}&gt;}|{&gt;&lt;}|{&lt;&lt;{15}&lt;&lt;}|{&gt;{5}&gt;}%|&#34;,
&gt;     $fID, $tID, $space, $fPer, $tPer;
&gt;
&gt;
&gt;
&gt; # Produces Unintialized value $whole in patter match &#40;m//&#41; error
&gt;   print form  { page =&gt; { width  =&gt; &#40;$columns + 1&#41;, } },
&gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{&gt;&gt;&gt;&gt;&gt;}&#34;,
&gt;     $fVal, {lfill=&gt;0},$tVal,
&gt;     &#34;{&lt;&lt;{20}&lt;&lt;}{0&gt;&gt;&gt;.&lt;&lt;0}&#34;,
&gt;     $fFlo, $tFlo;
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;17&nbsp;23:00:32&nbsp;2014</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100413] Issues with Declarative Widh and Zero-Paddidng fields</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 18 Nov 2014 14:59:43 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl6-Form [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Chris,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The length give by perl shows that the field is actually 5 positions.
</div>
No. The length of the *data* for the field is 5. :-&#41;

The *field* is the specification &#34;{&gt;&#40;5&#41;&gt;}&#34;, which is definitely 7
characters in width &#40;and hence invalid, since the &#34;&#40;5&#41;&#34; specifies that
the surrounding field must be 5 characters wide.

In other words, declarative field widths are not about validating the data
to be interpolated; they are about checking that the field specification itself
is consistent. In practice, declarative field widths are mostly only used
for formats that have been autogenerated, as a way of checking that the
field you somehow constructed is the correct width. They are not in any
way about verifying the data to be formatted into a field.

In fact, form&#40;&#41; has no features for validating the data it formats.
It just does its best to accommodate whatever data you through at it.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m curious as to why perl would say $tID is length 5 but form would say
&gt; $tID is length 7.
</div>
That&#39;s the misunderstanding in a nutshell. form&#40;&#41; isn&#39;t saying the contents of
$tID is of length 7; it&#39;s saying that the specifier for the &#34;{&gt;&#40;5&#41;&gt;}&#34;
field into which
$tID is being formatted is of length 7.

All the best,

Damian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;18&nbsp;08:23:36&nbsp;2014</span>
    <span class="description">chris [...] cuberootent.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100413] Issues with Declarative Widh and Zero-Paddidng fields</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 18 Nov 2014 07:23:26 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl6-Form [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christopher &lt;chris [...] cuberootent.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Damian,

Thanks for the explanation -- I&#39;ll have to wrap my head around it and
hammer on it but I&#39;ll eventually comprehend it fully.  I&#39;m still learning,
and this is my first foray into using form or predefined formatting of any
kind.  And on top of it, I&#39;m still learning programming.

I appreciate the time.

Thank you,
Christopher

On Mon, Nov 17, 2014 at 10:00 PM, damian@conway.org via RT &lt;
bug-Perl6-Form@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100413">https://rt.cpan.org/Ticket/Display.html?id=100413</a></span> &gt;
&gt;
&gt; Chris,
&gt;
<div class="message-stanza open">&gt; &gt; The length give by perl shows that the field is actually 5 positions.
</div>&gt;
&gt; No. The length of the *data* for the field is 5. :-&#41;
&gt;
&gt; The *field* is the specification &#34;{&gt;&#40;5&#41;&gt;}&#34;, which is definitely 7
&gt; characters in width &#40;and hence invalid, since the &#34;&#40;5&#41;&#34; specifies that
&gt; the surrounding field must be 5 characters wide.
&gt;
&gt; In other words, declarative field widths are not about validating the data
&gt; to be interpolated; they are about checking that the field specification
&gt; itself
&gt; is consistent. In practice, declarative field widths are mostly only used
&gt; for formats that have been autogenerated, as a way of checking that the
&gt; field you somehow constructed is the correct width. They are not in any
&gt; way about verifying the data to be formatted into a field.
&gt;
&gt; In fact, form&#40;&#41; has no features for validating the data it formats.
&gt; It just does its best to accommodate whatever data you through at it.
&gt;
&gt;
<div class="message-stanza open">&gt; &gt; I&#39;m curious as to why perl would say $tID is length 5 but form would say
&gt; &gt; $tID is length 7.
</div>&gt;
&gt; That&#39;s the misunderstanding in a nutshell. form&#40;&#41; isn&#39;t saying the
&gt; contents of
&gt; $tID is of length 7; it&#39;s saying that the specifier for the &#34;{&gt;&#40;5&#41;&gt;}&#34;
&gt; field into which
&gt; $tID is being formatted is of length 7.
&gt;
&gt; All the best,
&gt;
&gt; Damian
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
