<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #92401 for File-Slurp: test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #92401 for File-Slurp: test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/File-Slurp/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/File-Slurp/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/File-Slurp/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/File-Slurp/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/File-Slurp">File-Slurp CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">92401</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/File-Slurp/Active/">File-Slurp</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">cwhitener [...] gmail.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
pause [...] tlinx.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-13126-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
9999.19    </td>
  </tr>
  <tr id="CF-13127-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;23&nbsp;00:12:31&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">t/perms.t sets umask to 027
writes a file and checks that file&#39;s mode is
0640.

This is not guaranteed to be true on file systems
with ACL&#39;s.

It is best illustrated by setting a default ACL on the direct in which you are creating the test file.  That sets the ACL on any newly created file.  Give &#39;other&#39; any access other than none &#40;like &#39;r-x&#39; instead of &#39;---&#39;&#41;.

Then any file created will give &#34;other&#34; read access for non-executables.  The defaults established by the file systems override process defaults like umask.
Ishtar:&gt; umask 027
Ishtar:&gt; touch zzz
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ll zzz
</div>-rw-rw-r--+ 1 0 Jan 22 21:01 zzz
---why?---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; lsacl zzz
</div>[u::rw-,u:law:rwx,g::rwx,g:lawgroup:rwx,m::rw-,o::r--] zzz
&#40;which it inherited from the directory&#41; -- which specifies its own ACL and a default acl for created files.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;23&nbsp;00:13:49&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">BTW, I marked this &#39;critical&#39;, as it prevents File::Slurp from installing &#40;unless done manually&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;04&nbsp;22:00:04&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;04&nbsp;22:01:13&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m not sure that I see a way to accurately test the file permissions unless I move this test to the xt/author section so that it&#39;s not tested for installs on servers where we can&#39;t guarantee there aren&#39;t ACLs in place.

Do you have any other suggestions?

Thanks,
Chase
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;04&nbsp;22:01:13&nbsp;2018</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;00:10:37&nbsp;2018</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92401] test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 04 Oct 2018 20:53:50 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-Slurp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 10/4/2018 7:01 PM, Chase Whitener via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=92401">https://rt.cpan.org/Ticket/Display.html?id=92401</a></span> &gt;
&gt;
&gt; I&#39;m not sure that I see a way to accurately test the file permissions unless I move this test to the xt/author section so that it&#39;s not tested for installs on servers where we can&#39;t guarantee there aren&#39;t ACLs in place.
&gt;
&gt; Do you have any other suggestions?
&gt;
&gt; Thanks,
&gt; Chase
&gt;
&gt;   
</div>I&#39;m running this on Win7SP1, which is a desktop/workstation/client machine.

I&#39;m not sure how this is different from installs on servers.

Not sure what the xt/author section is or how it prevents this problem
since I&#39;m not installing on a server in the first place.

What does this have to do with servers vs. clients?  &#40;sorry, I don&#39;t 
understand&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;07:48:55&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If you&#39;re concerned about building on Windows, then I&#39;m even further confused as this test never even runs on Windows. 
<span class="clickylink"><a target="new" rel="nofollow" href="https://ci.appveyor.com/project/genio/slurp/build/job/vtrmufja5wv9jf1p#L224">https://ci.appveyor.com/project/genio/slurp/build/job/vtrmufja5wv9jf1p#L224</a></span>

I&#39;ll be happy to revisit this, but I don&#39;t know what we can do since we&#39;re already skipping this entire test on the platform.

Thanks,
Chase
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;07:48:57&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;12:56:52&nbsp;2018</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92401] test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 05 Oct 2018 09:56:42 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-Slurp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 10/5/2018 4:48 AM, Chase Whitener via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=92401">https://rt.cpan.org/Ticket/Display.html?id=92401</a></span> &gt;
&gt;
&gt; If you&#39;re concerned about building on Windows, then I&#39;m even further confused as this test never even runs on Windows. 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://ci.appveyor.com/project/genio/slurp/build/job/vtrmufja5wv9jf1p#L224">https://ci.appveyor.com/project/genio/slurp/build/job/vtrmufja5wv9jf1p#L224</a></span>
&gt;
&gt; I&#39;ll be happy to revisit this, but I don&#39;t know what we can do since we&#39;re already skipping this entire test on the platform.
&gt;
&gt; Thanks,
&gt; Chase
&gt;
&gt;   
</div>When i run on windows its under cygwin. I also run on my 64bit linux box.
I don&#39;t remember which architecture this test was run  on, but if you test
doesn&#39;t run on windows, then it seems pretty obvious that it wasn&#39;t on 
windows,
right?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;13:11:02&nbsp;2018</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2018-10-05 09:56:52, LAWALSH wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When i run on windows its under cygwin. I also run on my 64bit linux
&gt; box.
&gt; I don&#39;t remember which architecture this test was run  on, but if you
&gt; test
&gt;  doesn&#39;t run on windows, then it seems pretty obvious that it wasn&#39;t
&gt; on
&gt; windows,
&gt; right?
</div>

You said: &#34;I&#39;m running this on Win7SP1&#34;, so you can hardly blame Chase for being confused and asking for more information.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;15:07:43&nbsp;2018</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92401] test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 05 Oct 2018 12:07:27 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-Slurp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 10/5/2018 10:11 AM, Karen Etheridge via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; You said: &#34;I&#39;m running this on Win7SP1&#34;, so you can hardly blame Chase 
&gt; for being confused and asking for more information.
</div>I wasn&#39;t aware I was assigning blame.  I fail to see how assigning blame
fixes the problem.  It doesn&#39;t seem related and only had the effect of 
derailing
Chase&#39;s ability to clarify what servers had to do with this.  If you aren&#39;t
trying to solve the problem, why are posting on this bug?

Looking at the original post, the output looks like what one might get 
from a linux machine.  Indeed, Ishtar is my linux devel. machine &#40;among 
other roles&#41;.

So there is still the question, outstanding, that you derailed.  So are you
going to answer the question or are you here just sough confusion and doubt?

What does this have to do with servers vs. clients?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;17:00:40&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It seems this entire conversation has been derailed over one word. Forget &#34;server&#34; vs. &#34;client&#34;. You&#39;re attempting to install the module on a machine that uses ACLs &#40;it doesn&#39;t matter if said machine is a server or a client or a workstation or a phone&#41;. That attempt to install failed because the test in question tries to set and test permissions on a file.

I said

&#34;I&#39;m not sure that I see a way to accurately test the file permissions unless I move this test to the xt/author section so that it&#39;s not tested for installs on servers where we can&#39;t guarantee there aren&#39;t ACLs in place.

Do you have any other suggestions?&#34;

Please replace the word &#34;servers&#34; with &#34;machines&#34; in that. Do you have any suggestions about _how_ we might test to see if the machine in question is using ACLs so that we can skip the tests in such a scenario? If not, I can&#39;t think of a better solution than to move that particular test into the xt/authors set of tests &#40;which do not run on end-user installs&#41;.

Thanks,
Chase

On Fri Oct 05 15:07:43 2018, LAWALSH wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 10/5/2018 10:11 AM, Karen Etheridge via RT wrote:
<div class="message-stanza open">&gt; &gt; You said: &#34;I&#39;m running this on Win7SP1&#34;, so you can hardly blame Chase 
&gt; &gt; for being confused and asking for more information.
</div>&gt; I wasn&#39;t aware I was assigning blame.  I fail to see how assigning blame
&gt; fixes the problem.  It doesn&#39;t seem related and only had the effect of 
&gt; derailing
&gt; Chase&#39;s ability to clarify what servers had to do with this.  If you aren&#39;t
&gt; trying to solve the problem, why are posting on this bug?
&gt; 
&gt; Looking at the original post, the output looks like what one might get 
&gt; from a linux machine.  Indeed, Ishtar is my linux devel. machine &#40;among 
&gt; other roles&#41;.
&gt; 
&gt; So there is still the question, outstanding, that you derailed.  So are you
&gt; going to answer the question or are you here just sough confusion and doubt?
&gt; 
&gt; What does this have to do with servers vs. clients?
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;17:00:42&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;18:21:18&nbsp;2018</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92401] test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 05 Oct 2018 15:21:00 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-Slurp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 10/5/2018 2:00 PM, Chase Whitener via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#34;I&#39;m not sure that I see a way to accurately test the file permissions unless I move this test to the xt/author section so that it&#39;s not tested for installs on servers where we can&#39;t guarantee there aren&#39;t ACLs in place.
&gt;   
</div>Ironically, the fact that you don&#39;t support windows has somewhat protected
you from running into this problem earlier &#40;not that I&#39;m suggesting you 
should
support native windows or not&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Do you have any other suggestions?&#34;
&gt;   
</div>---
    The bit of axing the test sounds best in _this_ case only because
the permissions on the file  are incidental to the prime purpose of the 
module
&#40;IMO&#41; which is to slurp them in/out. 

    &#34;Obviously&#34; &#40;ha&#41;, if permissions prevent reading or writing, you won&#39;t
be able to slurp in or out, but testing mode bits related to a umask 
setting seems very incidental to your primary objective.  Another 
failure case &#40;not tested, but suspect&#41; would be mounting FAT &#40;and maybe 
exFAT&#41; file systems
on linux.  They would not have the same types of permission bits, so 
depending
on how detailed such testing is, I could easily see failure cases there.

    What you _could_ do, is test for read access before reading and 
write access
before writing.  It may be simple, but as near as I can tell, it&#39;s all 
your module would likely need, no?  Anything else, be it permission 
bits, ACL&#39;s,
or mandatory controls like in SELinux or similar &#40;which comes installed 
by default on RedHat and Suse flavors of linux&#41; would be OS specific 
permission controls that seem beyond what you would want to test &#40;I think&#41;.

    Am I missing something?

-linda
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;21:00:29&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Oct 05 18:21:18 2018, LAWALSH wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 10/5/2018 2:00 PM, Chase Whitener via RT wrote:
<div class="message-stanza open">&gt; &gt; &#34;I&#39;m not sure that I see a way to accurately test the file
&gt; &gt; permissions unless I move this test to the xt/author section so that
&gt; &gt; it&#39;s not tested for installs on servers where we can&#39;t guarantee
&gt; &gt; there aren&#39;t ACLs in place.
&gt; &gt;
</div>&gt; Ironically, the fact that you don&#39;t support windows has somewhat
&gt; protected
&gt;  you from running into this problem earlier &#40;not that I&#39;m suggesting
&gt; you
&gt; should
&gt; support native windows or not&#41;.
</div>
We _do_ support Windows. I&#39;m not sure what&#39;s giving any impression otherwise. However, Windows cannot set file permissions in the same way that other OSes can. This particular test is for that one purpose only. The rest of the tests run on Windows just like every other OS. This in no way means we don&#39;t support Windows, just that such a test is pointless to try on Windows.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; Do you have any other suggestions?&#34;
&gt; &gt;
</div>&gt; ---
&gt; The bit of axing the test sounds best in _this_ case only because
&gt; the permissions on the file  are incidental to the prime purpose of
&gt; the
&gt; module
&gt; &#40;IMO&#41; which is to slurp them in/out.
&gt; 
&gt; &#34;Obviously&#34; &#40;ha&#41;, if permissions prevent reading or writing, you won&#39;t
&gt; be able to slurp in or out, but testing mode bits related to a umask
&gt; setting seems very incidental to your primary objective.  Another
&gt; failure case &#40;not tested, but suspect&#41; would be mounting FAT &#40;and
&gt; maybe
&gt; exFAT&#41; file systems
&gt; on linux.  They would not have the same types of permission bits, so
&gt; depending
&gt; on how detailed such testing is, I could easily see failure cases
&gt; there.
</div>
Again, this is one small detail about how this particular function operates. Testing all facets of the methods is what the test suite does. Slurping in files it tested hundreds of other ways on Windows; this one feature cannot be tested in that environment because the environment doesn&#39;t support the process.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; What you _could_ do, is test for read access before reading and
&gt; write access
&gt; before writing.  It may be simple, but as near as I can tell, it&#39;s all
&gt; your module would likely need, no?  Anything else, be it permission
&gt; bits, ACL&#39;s,
&gt; or mandatory controls like in SELinux or similar &#40;which comes
&gt; installed
&gt; by default on RedHat and Suse flavors of linux&#41; would be OS specific
&gt; permission controls that seem beyond what you would want to test &#40;I
&gt; think&#41;.
&gt; 
</div>
We do test all of these things. I&#39;m in no way suggesting that we do not testing, just that we skip this one portion of tests when we can&#39;t accurately test due to differences in how the OS operates.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Am I missing something?
&gt; 
&gt; -linda
</div>
This conversation seems to have again deviated from the original problem of how to detect when ACLs are present on the current file system that would prevent us from testing this portion of the functionality of the module.

I&#39;ll leave this open for now until our next release when we&#39;ll move this particular test to the author test suite, mitigating any possible issues from leaving it in the mix.

Thanks,
Chase
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;06&nbsp;00:51:53&nbsp;2018</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92401] test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 05 Oct 2018 21:51:37 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-Slurp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 10/5/2018 6:00 PM, Chase Whitener via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; This conversation seems to have again deviated from the original problem of how to detect when ACLs are present on the current file system that would prevent us from testing this portion of the functionality of the module.
&gt;   
</div>----
    If at first you don&#39;t succeed...

    look for binaries &#39;chacl, getfacl setfacl&#39; if on linux.  I don&#39;t know
of an OS independent way to check for acls, but solaris, cygwin linux 
are likely
to have get/set facl.

And see if they can be set or listed?


For linux, another place to look for OS support would be /proc/config.gz:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  zgrep ACL /proc/config.gz
</div>CONFIG_EXT4_FS_POSIX_ACL=y
CONFIG_XFS_POSIX_ACL=y
CONFIG_BTRFS_FS_POSIX_ACL=y
CONFIG_FS_POSIX_ACL=y
CONFIG_TMPFS_POSIX_ACL=y
CONFIG_CIFS_ACL=y
---
it shows the running kernel&#39;s ACL support

Are those the type of things you are looking for to see if ACL&#39;s
may be present?...unfortunately, linux specific.

or something like this &#40;practical test&#41;:

a directory &#40;named &#39;file&#39;&#41; with an acl:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  chacl -l file
</div>[u::rwx,g::rwx,g:Trusted\040Local\040Net\040Users:r-x,m::rwx,o::r-x/u::rwx,u:Media:rwx,g::r-x,g:Media:rwx,g:Trusted\040Local\040Net\040Users:r-x,m::rwx,o::r-x] 
file
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  cd file
&gt;  umask 777
&gt;  touch 77 &#40;should be 000, no?&#41;
&gt;  umask 000
&gt;  touch 00  &#40;should be rw+rw+rw, no?&#41;
&gt;  mkdir dir
&gt;  chacl -l dir
</div>[u::rwx,u:Media:rwx,g::r-x,g:Media:rwx,g:Trusted\040Local\040Net\040Users:r-x,m::rwx,o::r-x/u::rwx,u:Media:rwx,g::r-x,g:Media:rwx,g:Trusted\040Local\040Net\040Users:r-x,m::rwx,o::r-x] 
dir
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  llg -a
</div>total 16
drwxrwsr-x  2 Media Media   36 Oct  5 21:24 ./
drwxrwxr-x 13 Media Media 4096 Oct  5 21:25 ../
-rw-rw-r--  1 law   Media    0 Oct  5 21:23 00
-rw-rw-r--  1 law   Media    0 Oct  5 21:24 77
drwxrwsr-x  2 law   Media   10 Oct  5 21:32 dir/

file 00 doesn&#39;t have &#39;write&#39; for other &#40;o::r-x&#41;
and file 77 still has access for user &#39;law&#39; and group Media

Another gotcha -- if parent has set groupid set, that will propagate to
child dirs on xfs by default, though there are ways to change that behavior:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  ll /proc/sys/fs/xfs
</div>...
-rw-r--r-- 1 0 Oct  5 21:35 inherit_noatime
-rw-r--r-- 1 0 Oct  5 21:35 inherit_nodefrag
-rw-r--r-- 1 0 Oct  5 21:35 inherit_nodump
-rw-r--r-- 1 0 Oct  5 21:35 inherit_nosymlinks
-rw-r--r-- 1 0 Oct  5 21:35 inherit_sync
-rw-r--r-- 1 0 Oct  5 21:35 irix_sgid_inherit
-rw-r--r-- 1 0 Oct  5 21:35 irix_symlink_mode
...
&#40;specifically irix_sgid_inherit&#41;
As you can see, there are ways to change other behaviors to
inherit parent settings or not.

I think acls are on by default on most file systems
EXCEPT with ext[34] they are a mount option.

But I don&#39;t know of any OS-independent nor FS independent
way to detect them.

Some versions of &#39;cp&#39; copy them, as well as some versions of tar
and  rsync.







<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ll leave this open for now until our next release when we&#39;ll move this particular test to the author test suite, mitigating any possible issues from leaving it in the mix.
&gt;
&gt; Thanks,
&gt; Chase
&gt;
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;06&nbsp;09:16:08&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Severity Critical changed to Normal</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;06&nbsp;19:25:27&nbsp;2018</span>
    <span class="description">ARISTOTLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 5 Oct 2018 02:01:13 GMT, CAPOEIRAB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not sure that I see a way to accurately test the file permissions
&gt; unless I move this test to the xt/author section so that it&#39;s not
&gt; tested for installs on servers where we can&#39;t guarantee there aren&#39;t
&gt; ACLs in place.
&gt; 
&gt; Do you have any other suggestions?
</div>
Checking for ACLs in a portable fashion is hard, all right. But that doesn’t mean you can’t check whether your test can possibly test something useful, no? Time for some testing 101.

What do you do when you are fixing a bug, to be sure that you fixed it? First you write a test that fails. Then you fix the bug. Then you check that the test passes.

Why? Because if you fix the bug first and only then write a test, then you don’t know for sure that that particular test would have failed before the bugfix. And so when it passes, you don’t actually know for sure that *the bugfix* is the reason why the test passes. And so you don’t know for sure what your bugfix actually did.

Well… here you have a test that only checks for the outcome you expect. But there is no check that umask actually works. Therefore when the test fails, you don’t actually know that this means the code it tests isn’t working. It might have failed because umask failed instead of because your code failed.

So… what *do* you do here to check that? You set the umask to 0, create a file, and test whether getmode&#40;$file&#41;==0666. If that’s the case, then umask is doing what you thought it does. If not, you have to skip the tests, because something is interfering with your base assumptions about umask.

&#40;Further reading: look up “null hypothesis”.&#41;

&#40;Note too that you MUST NOT use write_file for the file creation here, because that is the code you want to test in the first place, and you want to test the null hypothesis outside of any possible interference from that code.&#41;

So, putting it all together, what does that look like in practice? In copy-pastable terms – you move the `plan tests =&gt; 2` line down to the `umask 027` line and put the following block above that:

umask 0 ;
unlink $file ;
{ open my $fh, &#39;&gt;&#39;, $file or die $! }
my $u0_mode = getmode&#40; $file &#41; ;
unlink $file ;
plan skip_all =&gt; &#39;umask 0 does not yield 0666 permissions&#39; if $u0_mode != 0666 ;

Linda: can you verify that doing this makes the test skip without failing?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;07&nbsp;15:44:36&nbsp;2018</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92401] test &#34;t/perms.t&#34; is invalid; umask test broken w/ACLs</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 07 Oct 2018 12:44:20 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-Slurp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 10/6/2018 4:25 PM, Aristotle Pagaltzis via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So… what *do* you do here to check that? You set the umask to 0, create a file, and test whether getmode&#40;$file&#41;==0666. If that’s the case, then umask is doing what you thought it does. If not, you have to skip the tests, because something is interfering with your base assumptions about umask.
&gt;   
</div>---
    Not necessarily.  If you run that test as I did on a local file, whether
the umask was set to &#39;0000&#39; or 0777, the permissions on the file were 
0664 in both cases.  By changing the acls I&#39;m pretty sure I can come up 
with it returning 0666 in both &#39;file&#39; cases.  For a directory, I got 
2775 with umask
set to 0000 and 0777.

    umasks are also affected by setgid bits on directories.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I.e. I don&#39;t think you test setting
&gt; &#39;umask&#39;only tests umask because you have different perms based on what user you are running and the object you are checking.
&gt;   
</div>---
    Am pretty sure you are not doing that.  If you just want to test
umask, you could do something like:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  umask 000
&gt;  if [[ $&#40;awk &#39;BEGIN {IGNORECASE=1} /umask/{print $2}&#39; /proc/$$/status&#41; 
</div>== 0000 ]]; then echo ok; fi 



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#40;Further reading: look up “null hypothesis”.&#41;
&gt;
&gt; &#40;Note too that you MUST NOT use write_file for the file creation here, because that is the code you want to test in the first place, and you want to test the null hypothesis outside of any possible interference from that code.&#41;
&gt;   
</div>---
    True, but if you feel a need to test umask, you need to do it
without using a file system as not all of them support simple unix
mode bits.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Linda: can you verify that doing this makes the test skip without failing?
&gt;   
</div>Sorry, but I can make it fail or pass.  See above for testing 
functionality of umask &#40;which sets a mask in the current process&#41;.  As 
for testing what it does on all file systems?  *cough*.

Am I missing something else &#40;again?&#41;?  :-&#41;
-l
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;09&nbsp;01:36:04&nbsp;2018</span>
    <span class="description">ARISTOTLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, 7 Oct 2018 19:44:36 GMT, LAWALSH wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you run that test as I did on a local file, whether
&gt; the umask was set to &#39;0000&#39; or 0777, the permissions on the file were
&gt; 0664 in both cases.  By changing the acls I&#39;m pretty sure I can come
&gt; up with it returning 0666 in both &#39;file&#39; cases.  For a directory, I got
&gt; 2775 with umask set to 0000 and 0777.
</div>
That doesn’t matter. The question is whether you can set ACLs in such a way that umask 0 produces 0666 *but* umask 027 does *not* produce 0640.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; umasks are also affected by setgid bits on directories.
</div>
Those *definitely* don’t matter since they just end up affecting the regular Unix permission bits which compose cleanly with umask. So in a directory with a relevant setgid, the test will be skipped, because umask 0 will not produce a 0666 file.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Linda: can you verify that doing this makes the test skip without
&gt; &gt; failing?
&gt; &gt;
</div>&gt; Sorry, but I can make it fail or pass.
</div>
Eh? How can a test with two possible outcomes neither fail nor pass…?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Am I missing something else &#40;again?&#41;?  :-&#41;
</div>
Depends on how freely you can screw up umask with ACLs, I guess.

I suppose I didn’t full apply my own logic – testing what umask 0 does and then expecting that other umasks will have corresponding effects is not a null hypothesis for what is being tested. Instead, the first test could check that umask 027 yields 0640 before testing that write_file under umask 027 also produces an 0640 file, and the second test could check that an 0777 mode yields an 0750 file before testing that that’s what write_file does.

&#40;That would also permit running the test on Windows, rather than skipping it on general principle, where it would then just end up skipping both tests individually. Basically trading agent sniffing for feature detection, in webdev terms.&#41;

Will suggest a patch later.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;15&nbsp;23:00:33&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This was resolved via <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perhunter/slurp/commit/3e93bf741e0f16698821d594a09b4983a7536fd8">https://github.com/perhunter/slurp/commit/3e93bf741e0f16698821d594a09b4983a7536fd8</a></span> and will be in a release that will be cut shortly.


Thanks,
Chase
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;15&nbsp;23:00:34&nbsp;2018</span>
    <span class="description">cwhitener [...] gmail.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
