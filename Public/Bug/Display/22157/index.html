<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #22157 for ExtUtils-Install: RE: ExtUtils::Install::_can_write_dir bug &#40;was RE: XML::Parser XML::DOM XML::XSLT&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #22157 for ExtUtils-Install: RE: ExtUtils::Install::_can_write_dir bug &#40;was RE: XML::Parser XML::DOM XML::XSLT&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/ExtUtils-Install/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/ExtUtils-Install/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/ExtUtils-Install/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/ExtUtils-Install/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/ExtUtils-Install">ExtUtils-Install CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">22157</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/ExtUtils-Install/Active/">ExtUtils-Install</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">yves [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
friedberg [...] exs.esb.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39112-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39113-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




can_write_dir.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/252684/108814/can_write_dir.patch">
Fri Oct 20 00:11:24 2006 (645b) by cberry [...] cpan.org
</a>
</font></li>
</ul>


xslt_install.log<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/251109/107903/xslt_install.log">
Wed Oct 18 01:09:50 2006 (4k) by friedberg [...] exs.esb.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;18&nbsp;01:09:50&nbsp;2006</span>
    <span class="description">friedberg [...] exs.esb.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;vmsperl [...] perl.org&gt;, &lt;bug-ExtUtils-Install [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: ExtUtils::Install::_can_write_dir bug &#40;was RE: XML::Parser XML::DOM XML::XSLT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Oct 2006 01:09:21 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;schwern [...] pobox.com&gt;, &#34;Craig A. Berry&#34; &lt;craigberry [...] mac.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Carl Friedberg&#34; &lt;friedberg [...] exs.esb.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, Sorry, I&#39;ll take responsibility for lack of reporting.

I found this when trying to install several modules after I installed
the latest version of MakeMaker. Craig figured out what the problem
might have been; but his patch did not pass all the mm tests.

This bug report refers to failed attempts to install XML::XSLT

I have not previously filed any bug reports for perl, except by
posting here on VMS Perl. I am sending a copy of this e-mail to
report the bug, as I don&#39;t care to register for a BitCard.

The big picture:

&#40;on VMS&#41;: mmk install fails, if the install script needs to
write into the top level directory perl_root:[utils]. This
happens with both 5.9.4 and 5.8.6, running on OpenVMS 7.3-2.

From my original post to VMSPerl on Mon 9/25/2006 2:27 PM:

&#34;Finally I built XML::XSLT, and all tests passed. Unfortunately, I
can not get XML::XSLT installed &#40;from the SYSTEM account&#41;, neither
with MMK, nor with MMS.

Here&#39;s the mms output:

mms /list=xlst_install.log install

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ERROR: Can&#39;t create &#39;perl_root:[utils]&#39;
Unknown Error
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 at -e line 1
%SYSTEM-F-ABORT, abort
%MMS-F-ABORT, For target PURE_SITE_INSTALL, CLI returned abort status:
%X0000002C.
-SYSTEM-F-ABORT, abort

I have attached the mms output xslt_install.log &#40;I changed the name
from the mangled typo above&#41;.

I used MMK throughout the above, and it gave the exact same error; I
now tried MMS, just in case &#40;and I knew how to log the actions&#41;.

--------------------------------------------------------------------

I have attached the log file.

Carl Friedberg
Comet &#38; Company
165 William St 9 NY NY 10038
www.comets.com
&#40;212&#41; 233-5470  

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -----Original Message-----
&gt; From: Michael G Schwern [mailto:schwern@gmail.com] 
&gt; Sent: Tuesday, October 17, 2006 11:50 PM
&gt; To: Craig A. Berry
&gt; Cc: Carl Friedberg; vmsperl@perl.org
&gt; Subject: Re: ExtUtils::Install::_can_write_dir bug &#40;was RE: 
&gt; XML::Parser XML::DOM XML::XSLT&#41;
&gt; 
&gt; Craig A. Berry wrote:
<div class="message-stanza open">&gt; &gt; At 9:02 AM -0400 9/29/06, Carl Friedberg wrote:
<div class="message-stanza open">&gt; &gt;&gt; I&#39;ve found the deadly combination: MakeMaker 6.30-2, VMS 
</div></div>&gt; 7.3-2, Perl
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; 5.8.6, and a perl module with a script &#40;which gets put 
</div></div>&gt; into perl_root:[utils].
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; The problem would happen for anything installed in the top level of
&gt; &gt; the install target.  The bug is in 
</div>&gt; ExtUtils::Install::_can_write_dir.
<div class="message-stanza open">&gt; &gt; The offending line &#40;well, the root of the trouble&#41;, is:
&gt; &gt; 
&gt; &gt; 
&gt; &gt;     my @dirs=File::Spec-&gt;splitdir&#40;File::Spec-&gt;rel2abs&#40;$dir&#41;&#41;;
&gt; &gt; 
&gt; &gt; 
&gt; &gt; splitdir, as its name implies, only operates on directories.
&gt; &gt; rel2abs, on a platform that has the notion of disk volume that is
&gt; &gt; syntactically different from a directory, includes the 
</div>&gt; volume as well
<div class="message-stanza open">&gt; &gt; as directories in its result.  The function ends up calling 
</div>&gt; catdir on
<div class="message-stanza open">&gt; &gt; the results of splitdir, and the result of 
</div>&gt; catdir&#40;splitdir&#40;&#39;disk:[dir]&#39;&#41;&#41;
<div class="message-stanza open">&gt; &gt; is undefined:
&gt; &gt; 
&gt; &gt; $ perl -&#34;MFile::Spec&#34; -e &#34;print defined 
</div>&gt; File::Spec-&gt;catdir&#40;File::Spec-&gt;splitdir&#40;&#39;disk:[dir]&#39;&#41;&#41; ? 1 : 0;&#34;
<div class="message-stanza open">&gt; &gt; 0
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Possibly just replacing splitdir/catdir in this function with
&gt; &gt; splitpath/catpath would work.  I&#39;ll try it and post again.
</div>&gt; 
&gt; ExtUtils::Install&#39;s bug tracker is here:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Dist/ExtUtils-Install/Active/">http://rt.cpan.org/Public/Dist/Display.html?Name=ExtUtils-Install</a></span>
&gt; 
&gt; I don&#39;t see this bug reported.  If you don&#39;t tell the author, 
&gt; he&#39;ll never know there&#39;s a problem.  Posting to vmsperl 
&gt; doesn&#39;t count, most CPAN authors don&#39;t read it.  And don&#39;t 
&gt; wait to have a patch to report a bug.
&gt; 
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/251109/107903/xslt_install.log">Download xslt_install.log</a><br />
<span class="downloadcontenttype">application/octet-stream 4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;20&nbsp;00:11:24&nbsp;2006</span>
    <span class="description">cberry [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> cberry [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 18 01:09:50 2006, friedberg@exs.esb.com wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I found this when trying to install several modules after I installed
&gt; the latest version of MakeMaker. Craig figured out what the problem
&gt; might have been; but his patch did not pass all the mm tests.
</div>
My original patch, which was not included in Carl&#39;s report, solved his immediate problem, but as 
he notes introduced some other failures in the ExtUtils tests.  The patch against blead@29051 
attached here resolves those problems.  All ExtUtils tests pass on VMS after application of this 
patch.  I have not tested on other platforms.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/ExtUtils/Install.pm;-0	Sun Jul  2 11:35:05 2006
+++ lib/ExtUtils/Install.pm	Thu Oct 19 22:25:29 2006
@@ -431,11 +431,12 @@ sub _can_write_dir {
     return
         unless defined $dir and length $dir;
 
-    my @dirs=File::Spec-&gt;splitdir&#40;File::Spec-&gt;rel2abs&#40;$dir&#41;&#41;;
+    my &#40;$vol, $dirs, $file&#41; = File::Spec-&gt;splitpath&#40;File::Spec-&gt;rel2abs&#40;$dir&#41;&#41;;
+    my @dirs = File::Spec-&gt;splitdir&#40;$dirs&#41;;
     my $path=&#39;&#39;;
     my @make;
     while &#40;@dirs&#41; {
-        $dir=File::Spec-&gt;catdir&#40;@dirs&#41;;
+        $dir=File::Spec-&gt;catpath&#40;$vol, @dirs, &#39;&#39;&#41;;
         next if &#40; $dir eq $path &#41;;
         if &#40; ! -e $dir &#41; {
             unshift @make,$dir;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;20&nbsp;00:11:26&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;20&nbsp;14:12:05&nbsp;2006</span>
    <span class="description">friedberg [...] exs.esb.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #22157] RE: ExtUtils::Install::_can_write_dir bug &#40;was RE: XML::Parser XML::DOM XML::XSLT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 20 Oct 2006 14:11:33 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-ExtUtils-Install [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Carl Friedberg&#34; &lt;friedberg [...] exs.esb.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Craig,

Passed all tests on 5.9.4, OpenVMS 7.3-2 on AlphaServer
Passed all tests on 5.8.6, OpenVMS 7.3-2 on AlphaServer

[to install, I had to first copy install.pm, by hand, to
perl_root:[lib.extutils]. Then, mmk install worked. Just a
bootstrap...only needed if you already installed the just
previous version, as I had done. Hmmm, that installed 
because the version before was used to do the install. gark.

Carl Friedberg
friedberg@comets.com
www.comets.com

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -----Original Message-----
&gt; From: Craig A. Berry via RT [mailto:bug-ExtUtils-Install@rt.cpan.org]
&gt; Sent: Friday, October 20, 2006 12:11 AM
&gt; To: Carl Friedberg
&gt; Subject: [rt.cpan.org #22157] RE: ExtUtils::Install::_can_write_dir
&gt; bug &#40;was RE: XML::Parser XML::DOM XML::XSLT&#41;
&gt; 
&gt; 
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=22157">http://rt.cpan.org/Ticket/Display.html?id=22157</a></span> &gt;
&gt; 
&gt; On Wed Oct 18 01:09:50 2006, friedberg@exs.esb.com wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; I found this when trying to install several modules after I
</div>&gt; installed
<div class="message-stanza open">&gt; &gt; the latest version of MakeMaker. Craig figured out what the problem
&gt; &gt; might have been; but his patch did not pass all the mm tests.
</div>&gt; 
&gt; My original patch, which was not included in Carl&#39;s report, solved
&gt; his immediate problem, but as
&gt; he notes introduced some other failures in the ExtUtils tests.  The
&gt; patch against blead@29051
&gt; attached here resolves those problems.  All ExtUtils tests pass on
&gt; VMS after application of this
&gt; patch.  I have not tested on other platforms.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;07&nbsp;13:57:41&nbsp;2007</span>
    <span class="description">cberry [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I just tried 1.41_03, which has a version of my patch in it, but not one that works.  It does a 
catdir on the directory portion, which on VMS creates a relative directory spec, and then it 
does a catpath joining a volume spec to that relative directory, so you end up with a 
nonsense path that is part absolute and part relative.  The patch below restores what I had 
originally submitted.  Perhaps there are other problems with it I&#39;m not aware of, but at least it 
keeps us from testing the writability of directories whose existence is logically impossible.

But the whole approach is in my opinion flawed for a couple of reasons.  The excessive 
splitting apart and rejoining of pieces of path names is inherently fragile and should be 
avoided if at all possible.  And the reason we are doing it is so we can second guess mkpath&#40;&#41; 
and predict what it will or won&#39;t do and why it will or won&#39;t do it.  Reproducing and 
supplementing the internal logic of mkpath&#40;&#41; is another inherently fragile process.  We are 
being given a path.  mkpath&#40;&#41; knows how to operate on paths.  If robustness is important, we 
should take the path, hand it off to mkpat&#40;&#41;, handle any errors it throws at us, and leave it at 
that.  Instead I&#39;m seeing installations that fail merely because we are trying too hard to 
predict whether they can succeed.

--- perl_root:[lib.ExtUtils]Install.pm;-1       Sat Apr  7 11:22:34 2007
+++ perl_root:[lib.ExtUtils]Install.pm  Sat Apr  7 11:41:55 2007
@@ -436,8 +436,7 @@ sub _can_write_dir {
     my $path=&#39;&#39;;
     my @make;
     while &#40;@dirs&#41; {
-        $dir = File::Spec-&gt;catdir&#40;@dirs&#41;;
-        $dir = File::Spec-&gt;catpath&#40;$vol,$dir,&#34;&#34;&#41;;
+        $dir = File::Spec-&gt;catpath&#40;$vol,@dirs,&#34;&#34;&#41;;
         next if &#40; $dir eq $path &#41;;
         if &#40; ! -e $dir &#41; {
             unshift @make,$dir;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;07&nbsp;11:16:30&nbsp;2007</span>
    <span class="description">yves [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Apr 07 13:57:41 2007, CBERRY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I just tried 1.41_03, which has a version of my patch in it, but not
&gt; one that works.  It does a
&gt; catdir on the directory portion, which on VMS creates a relative
&gt; directory spec, and then it
&gt; does a catpath joining a volume spec to that relative directory, so
&gt; you end up with a
&gt; nonsense path that is part absolute and part relative.  The patch
&gt; below restores what I had
&gt; originally submitted.  Perhaps there are other problems with it I&#39;m
&gt; not aware of, but at least it
&gt; keeps us from testing the writability of directories whose existence
&gt; is logically impossible.
&gt; 
&gt; But the whole approach is in my opinion flawed for a couple of
&gt; reasons.  The excessive
&gt; splitting apart and rejoining of pieces of path names is inherently
&gt; fragile and should be
&gt; avoided if at all possible.  And the reason we are doing it is so we
&gt; can second guess mkpath&#40;&#41;
&gt; and predict what it will or won&#39;t do and why it will or won&#39;t do it.
&gt; Reproducing and
&gt; supplementing the internal logic of mkpath&#40;&#41; is another inherently
&gt; fragile process.  We are
&gt; being given a path.  mkpath&#40;&#41; knows how to operate on paths.  If
&gt; robustness is important, we
&gt; should take the path, hand it off to mkpat&#40;&#41;, handle any errors it
&gt; throws at us, and leave it at
&gt; that.  Instead I&#39;m seeing installations that fail merely because we
&gt; are trying too hard to
&gt; predict whether they can succeed.
</div>
Can you please try 1.41_04 &#40;which I just uploaded to PAUSE&#41; and see if
it works out ok? 

BTW, the whole idea of this check is to prevent half installs clobbering
and older one due to silly permission checks. It could probably be
improved however.

Sorry for the lag on doing this...

Yves
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;07&nbsp;11:16:35&nbsp;2007</span>
    <span class="description">yves [...] cpan.org -  Given to YVES</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;13&nbsp;12:25:16&nbsp;2007</span>
    <span class="description">yves [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ive been informed this is resolved by 1.41_04 so im closing the ticket.

thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;13&nbsp;12:25:18&nbsp;2007</span>
    <span class="description">yves [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
