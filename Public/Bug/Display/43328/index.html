<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #43328 for File-Copy-Recursive: pathmk breaks if called with an UNC path-needs feedback on fix</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #43328 for File-Copy-Recursive: pathmk breaks if called with an UNC path-needs feedback on fix</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/File-Copy-Recursive/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/File-Copy-Recursive/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/File-Copy-Recursive/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/File-Copy-Recursive/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/File-Copy-Recursive">File-Copy-Recursive CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">43328</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/File-Copy-Recursive/Active/">File-Copy-Recursive</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
FischerR.External [...] infineon.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-12726-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.38    </td>
  </tr>
  <tr id="CF-12727-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;16&nbsp;03:59:40&nbsp;2009</span>
    <span class="description">ynnor [...] mm.st -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> pathmk breaks if called with an UNC path</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">File::Copy::Recursive::pathmk does not work if it is called on Windows
with an UNC path as argument. The reason for the bug is in the first
line in function pathmk, which reads like this:

my @parts = File::Spec-&gt;splitdir&#40; shift&#40;&#41; &#41;;

According to the perldoc of splitdir, the argument must NOT contain a
volume information &#40;which on Windows means: No drive letter, no UNC
share&#41;. Despite this restriction, it just happens to work by accident,
if there *IS* a drive letter, but it fails if it is an UNC path.

SOLUTION:

To solve this, it is necessary to first extract the volume part:

my &#40;$volume, $dir&#41; = File::Spec-&gt;splitpath&#40;shift&#40;&#41;&#41;;

On Unix, $volume would be &#39;&#39;. On Windows, $volume would be something
like &#39;D:&#39; or &#39;\\\\hostxy\\myshare&#39;.

Next, we can use splitdir safely:

my @parts = File::Spec-&gt;splitdir&#40;$dir&#41;;

But we have to prepend the volume later, so instead of

my $pth = $parts[0];

we have to write

my $pth = File::Spec-&gt;catdir&#40;$volume,$parts[0]&#41;;

which works on both Windows and Unix.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;20&nbsp;11:36:39&nbsp;2009</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">thank you, for some reason I didn&#39;t get notified of this. Will be addressed 
soon :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;20&nbsp;11:36:39&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;15:34:28&nbsp;2010</span>
    <span class="description">willi.weikum [...] onlinehome.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #43328] pathmk breaks if called with an UNC path</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 18 Jun 2010 21:34:18 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-File-Copy-Recursive [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Willi Weikum &lt;willi.weikum [...] onlinehome.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Big thank to Ronald for finding this bug, it drived me crazy!
But the suggested solution is still not perfect. The solution works only in case you call pathmk with a directory name ending with a path separator:

File::Copy::Recursive::pathmk&#40;&#39;C:/temp/mynewdirectory/&#39;&#41;;

If you call pathmk with a directory name without trailing path separator like this:

File::Copy::Recursive::pathmk&#40;&#39;C:/temp/mynewdirectory&#39;&#41;;

it doesn&#39;t create the directory. This is because File::Spec-&gt;splitpath assumes the last part of the string to be a filename and returns it as 3rd value if the string doesn&#39;t end with a path separator. See splitpath documentation: &gt;&gt;assumes that the last file is a path unless $no_file is true or a trailing separator or /. or /.. is present&lt;&lt;

The following solution works for both cases with and without trailing path separator. UNC paths work fine too, for create and copy.

sub pathmk {
   my &#40; $volume, @parts &#41; = File::Spec-&gt;splitpath&#40;shift&#40;&#41;&#41;;
   my $nofatal = shift;
   @parts  = File::Spec-&gt;splitdir&#40; File::Spec-&gt;catdir&#40;@parts&#41;&#41;;
   my $pth = File::Spec-&gt;catdir&#40;$volume,$parts[0]&#41;;
   my $zer = 0;
...

Now we first split the path to $volume and one or more components, then File::Spec-&gt;splitdir&#40; File::Spec-&gt;catdir&#40;@parts&#41;&#41;; joins and separates all the directory parts again.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;17:22:30&nbsp;2010</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">thank you, I&#39;ll get to this ASAP
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;25&nbsp;07:38:09&nbsp;2012</span>
    <span class="description">https://www.google.com/accounts/o8/id?id=AItOawlVEP5IYeRHpH3ZT4ELVsJ3INWz0Lpegpo -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> sferencik [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Daniel,

Have you had a chance to look at this? The solution proposed above by 
Willi works for me.

Thanks,
Sam
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;25&nbsp;08:10:24&nbsp;2012</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The solution proposed above by Willi works for me.
</div>
thanks for confirming!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;22&nbsp;04:16:20&nbsp;2016</span>
    <span class="description">Louis.Strous [...] intellimagic.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #43328] Please release version with fix proposed in 2010</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 22 Jan 2016 09:15:53 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-File-Copy-Recursive [...] rt.cpan.org&#34; &lt;bug-File-Copy-Recursive [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Louis Strous &lt;Louis.Strous [...] intellimagic.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I ran into this problem recently &#40;for version 0.38 from 2008, which is still the most recently released one&#41; and the fix proposed by willi.weikum back in 2010 works for me, too.  That fix does not break any of the unit tests associated with the package.  Please release a new version that includes the proposed fix.

Regards,
Louis Strous

IntelliMagic - Availability Intelligence
www.intellimagic.com&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.intellimagic.com">http://www.intellimagic.com</a></span>&gt;

</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;25&nbsp;09:27:47&nbsp;2016</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 22 04:16:20 2016, Louis.Strous@intellimagic.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I ran into this problem recently &#40;for version 0.38 from 2008, which is
&gt; still the most recently released one&#41; and the fix proposed by
&gt; willi.weikum back in 2010 works for me, too.  That fix does not break
&gt; any of the unit tests associated with the package.  Please release a
&gt; new version that includes the proposed fix.
&gt; 
&gt; Regards,
&gt; Louis Strous
&gt; 
&gt; IntelliMagic - Availability Intelligence
&gt; www.intellimagic.com&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.intellimagic.com">http://www.intellimagic.com</a></span>&gt;
&gt; 
</div>
Thanks! I just moved it to github so we can start fixing legacy bugs and modernizing it, I hope to do this RT soon
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;25&nbsp;09:35:13&nbsp;2016</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> sferencik [...] gmail.com, willi.weikum [...] onlinehome.de,
 Louis.Strous [...] intellimagic.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Does this fix it for you:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/drmuey/p5-File-Copy-Recursive/commit/04f5b605ac35a3ebfd051c17a3869b5356056189">https://github.com/drmuey/p5-File-Copy-Recursive/commit/04f5b605ac35a3ebfd051c17a3869b5356056189</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;25&nbsp;09:41:09&nbsp;2016</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jan 25 09:35:13 2016, DMUEY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Does this fix it for you:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/drmuey/p5-File-Copy-">https://github.com/drmuey/p5-File-Copy-</a></span>
&gt; Recursive/commit/04f5b605ac35a3ebfd051c17a3869b5356056189
</div>
Actually, try this simpler version instead:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/drmuey/p5-File-Copy-Recursive/commit/c3aff4ebec0d8009cbbea96785ba3bdf2d52e3cf">https://github.com/drmuey/p5-File-Copy-Recursive/commit/c3aff4ebec0d8009cbbea96785ba3bdf2d52e3cf</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;25&nbsp;13:12:22&nbsp;2016</span>
    <span class="description">dmuey [...] cpan.org -  Subject changed from &#39;pathmk breaks if called with an UNC path&#39; to &#39;pathmk breaks if called with an UNC path-needs feedback on fix&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;05:34:53&nbsp;2016</span>
    <span class="description">Louis.Strous [...] intellimagic.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #43328] pathmk breaks if called with an UNC path</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Jan 2016 10:34:24 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-File-Copy-Recursive [...] rt.cpan.org&#34; &lt;bug-File-Copy-Recursive [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Louis Strous &lt;Louis.Strous [...] intellimagic.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Daniel,

Thank you for responding!

Unfortunately, your solution makes the problem worse.  Now it doesn&#39;t work for many non-UNC paths anymore, either.

You replaced File::Spec::splitdir by File::Spec::splitpath.  splitdir splits a scalar at path separator characters, assuming that the path does not contain a volume part.  The resulting list may have any number of elements, depending on how many directory levels are in the path.  splitpath splits a scalar into exactly three parts: volume, combined directories, and file.  If you use only splitdir then pathmk fails for UNC paths because it treats a volume &#40;\\server\share&#41; as a directory &#40;\server\share&#41;.  If you use only splitpath then pathmk fails for paths of which more than just the last directory segment doesn&#39;t exist yet in the file system, because the directories part isn&#39;t split into separate segments.  You need to use both, like willi.weikum proposed.

You want &#39;//host/share/dir1/dir2/file&#39; to be split into [&#39;//host/share&#39;, &#39;dir1&#39;, &#39;dir2&#39;, &#39;file&#39;]
File::Spec-&gt;splitdir&#40;&#39;//host/share/dir1/dir2/file&#39;&#41; yields [ &#39;&#39;, &#39;&#39;, &#39;host&#39;, &#39;share&#39;, &#39;dir1&#39;, &#39;dir2&#39;, &#39;file&#39; ]
File::Spec-&gt;splitdir&#40;&#39;C:/dir1/dir2/file&#39;&#41; yields [ &#39;C:&#39;, &#39;dir1&#39;, &#39;dir2&#39;, &#39;file&#39; ]
File::Spec-&gt;splitpath&#40;&#39;//host/share/dir1/dir2/file&#39;&#41; yields [ &#39;//host/share&#39;, &#39;/dir1/dir2/&#39;, &#39;file&#39; ]
File::Spec-&gt;splitpath&#40;&#39;C:/dir1/dir2/file&#39;&#41; yields [ &#39;C:&#39;, &#39;/dir1/dir2/&#39;, &#39;file&#39; ]

I added a test to detect the problem, and implemented willi.weikum&#39;s solution which makes the test pass, at <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/LouisStrous/p5-File-Copy-Recursive/commit/c66221e833b47f9ee278a0f148908baf11bb7451">https://github.com/LouisStrous/p5-File-Copy-Recursive/commit/c66221e833b47f9ee278a0f148908baf11bb7451</a></span>.

Regards,

Louis Strous

IntelliMagicÂ - Availability Intelligence
T: +31 &#40;0&#41;71-579 6000
www.intellimagic.com

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Daniel Muey via RT [mailto:bug-File-Copy-Recursive@rt.cpan.org] 
Sent: 25 January 2016 15:35
Cc: sferencik@gmail.com; willi.weikum@onlinehome.de; Louis Strous &lt;Louis.Strous@intellimagic.com&gt;
Subject: [rt.cpan.org #43328] pathmk breaks if called with an UNC path

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43328">https://rt.cpan.org/Ticket/Display.html?id=43328</a></span> &gt;

Does this fix it for you:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/drmuey/p5-File-Copy-Recursive/commit/04f5b605ac35a3ebfd051c17a3869b5356056189">https://github.com/drmuey/p5-File-Copy-Recursive/commit/04f5b605ac35a3ebfd051c17a3869b5356056189</a></span>


</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;10:33:34&nbsp;2016</span>
    <span class="description">samuel.ferencik [...] barclays.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #43328] pathmk breaks if called with an UNC path</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Jan 2016 15:33:16 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-File-Copy-Recursive [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;samuel.ferencik [...] barclays.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">looks good; please go ahead

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">_______________________________________________

This message is for information purposes only, it is not a recommendation, advice, offer or solicitation to buy or sell a product or service nor an official confirmation of any transaction. It is directed at persons who are professionals and is not intended for retail customer use. Intended for recipient only. This message is subject to the terms at: www.barclays.com/emaildisclaimer.

For important disclosures, please see: www.barclays.com/salesandtradingdisclaimer regarding market commentary from Barclays Sales and/or Trading, who are active market participants; and in respect of Barclays Research, including disclosures relating to specific issuers, please see <span class="clickylink"><a target="new" rel="nofollow" href="http://publicresearch.barclays.com">http://publicresearch.barclays.com</a></span>.

<div class="message-stanza open">_______________________________________________
</div></div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;29&nbsp;17:39:21&nbsp;2016</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">cool, thanks! can you submit the change and tests as a pull request?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;19&nbsp;16:53:42&nbsp;2018</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 29 17:39:21 2016, DMUEY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; cool, thanks! can you submit the change and tests as a pull request?
&gt; 
</div>

I brought in your test and pathmk&#40;&#41; was already fixed it looks like

42280a7 rt 43328 - add ULC test to verify pathmk&#40;&#41; w/ ULC &#40;thanks willi.weikum and LouisStrous&#41;

thanks again!

Should be in the next release!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;19&nbsp;16:53:42&nbsp;2018</span>
    <span class="description">dmuey [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
