<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #69206 for Chess-PGN-EPD: small bug in parsing rare &#40;legal&#41; SAN moves</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #69206 for Chess-PGN-EPD: small bug in parsing rare &#40;legal&#41; SAN moves</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Chess-PGN-EPD/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Chess-PGN-EPD/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Chess-PGN-EPD/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Chess-PGN-EPD/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Chess-PGN-EPD">Chess-PGN-EPD CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">69206</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Chess-PGN-EPD/Active/">Chess-PGN-EPD</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ludens [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-6410-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-6411-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;30&nbsp;13:42:51&nbsp;2011</span>
    <span class="description">ludens [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> small bug in parsing rare &#40;legal&#41; SAN moves</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Jun 2011 10:42:37 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Chess-PGN-EPD [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;ludens [...] gmail.com&#34; &lt;ludens [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Chess-PGN-EPD-0.29 has a little problem parsing rare legal SAN moves.
White&#39;s move 68 in the example game &#40;Rf8f2, see below&#41; fails with 
undefined $from in epdlist because movetype returns &#34;Not yet handled&#34;. 
It looks like this &#40;non-capture&#41; case was just forgotten because it is 
already there for capturing moves.

Proposed fix: Add

    elsif &#40; $move =~ /^&#40;[RNBQK]&#41;&#40;[a-h][1-8]&#41;&#40;[a-h][1-8]&#41;&#40;?:\+|\#&#41;?$/ &#41; {
        @result = &#40; $1, $3, $2 &#41;;
    }

in line 1049 &#40;function movetype&#41;.

Also, line 706 should read

    my $debug = @_ ? &#40; $moves[-1] eq &#39;1&#39; &#41; : 0;

to make sure debug is 0 instead of undefined for empty move lists &#40;ie 
White or Black resigns on move 1&#41;.

Thank you for an extremly valuable library, it is nice to see that you 
keep improving it.

Klaus

-----------

example game

1. d4 g6 2. Bf4 Bg7 3. Nf3 d6 4. Nc3 Nf6 5. e3 O-O 6. Qd3 Nbd7 7. h4 c5 
8. dxc5 Nxc5 9. Qe2 b6 10. O-O-O Ba6 11. Qe1 Bxf1 12. Qxf1 Nce4 13. Nxe4 
Nxe4 14. g4 Rc8 15. Qd3 Nc5 16. Qe2 b5 17. h5 Qa5 18. a3 Qa4 19. c3 Nb3+ 
20. Kb1 b4 21. cxb4 a5 22. bxa5 Nxa5 23. hxg6 fxg6 24. Bh6 Bxb2 25. Bxf8 
Qxa3 26. Qxb2 Qa4 27. Qa2+ Qc4 28. Qxc4+ Rxc4 29. Bxe7 Nc6 30. Bxd6 Ra4 
31. Rd2 Rxg4 32. Ne5 Ra4 33. Nxc6 Ra6 34. Rc2 Rb6+ 35. Kc1 Kf7 36. Rxh7+ 
Ke6 37. Bf4 Kd5 38. Ne7+ Ke4 39. Rg7 Kf3 40. Rxg6 Ra6 41. Rxa6 Kg2 42. 
Kd1 Kf1 43. Rca2 Kg2 44. Bh6 Kf3 45. Re6 Kg4 46. Nc6 Kf5 47. Rd6 Kg4 48. 
Rdd2 Kf3 49. Bf8 Kg2 50. Re2 Kf3 51. e4 Kf4 52. e5 Kf3 53. e6 Kg2 54. 
Ba3 Kf1 55. e7 Kg2 56. Re1 Kf3 57. e8=R Kf4 58. Rf8+ Kg5 59. f3 Kg6 60. 
f4 Kg7 61. f5 Kh7 62. Ra8 Kg7 63. Rf1 Kf6 64. Nd4 Kf7 65. f6 Kg6 66. f7 
Kg5 67. f8=R Kg4 68. Rf8f2 Kg3 69. Rae2 Kg4 70. Rae8 Kg3 71. R8e3+ Kg4 
72. Ree1 Kg5 73. Bb2 Kg4 74. Bc3 Kg5 75. Re1e2 Kg4 76. Be1 Kg5 77. Nc2 
Kg4 78. Kd2 Kg5 79. Kd3 Kg4 80. Kd4 Kg5 81. Kc4 Kg4 82. Kd5 Kg5 83. Bd2 
Kg4 84. Ne1 Kg5 85. Rd3+ Kg4 86. Bc1 Kh5 87. Rd1 Kg6 88. Bd2 Kg7 89. Re3 
Kg6 90. Rfe2 Kg7 91. Rff3 Kg6 92. Rff2 Kg7 93. Rf1 Kg6 94. Rff2 Kg7 95. 
Rf4 Kg6 96. Rd4 Kg7 97. Rdd3 Kg6 98. Rc3 Kg7 99. Rc2 Kg6 100. Rcc1 Kg7 
101. Rcc3 Kg6 102. Rc2 Kg7 103. Rcc1 Kg6 104. Rc4 Kg7 105. Rb4 Kg6 106. Rbb3
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
