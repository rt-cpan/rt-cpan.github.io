<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #64266 for Mail-Box: Problems with overruling addresses using destinations&#40;&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #64266 for Mail-Box: Problems with overruling addresses using destinations&#40;&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Mail-Box">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Mail-Box">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Mail-Box">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Mail-Box">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Mail-Box">Mail-Box CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">64266</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Mail-Box">Mail-Box</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
andy [...] andybev.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-19874-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.096    </td>
  </tr>
  <tr id="CF-19875-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




sendmail-override.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/874171/452698/sendmail-override.patch">
Tue Dec 28 03:50:05 2010 (1k) by andy [...] andybev.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=64266">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874011" href="/Public/Bug/Display.html?id=64266#txn-874011">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;27&nbsp;14:01:05&nbsp;2010</span>
    <span class="description">andy [...] andybev.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Problems with overruling addresses using destinations&#40;&#41;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/874011/452617/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/452617">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mail-box-2.096
Perl 5.10.0
Linux 2.6.30.1-m64-mb1 #2 SMP x86_64 GNU/Linux


I am having trouble with Mail::Transport::Send-&gt;destinations&#40;&#41; which I
believe to be a bug. The following code sends an email to
&#34;andy@andybev.com&#34;, whereas I would expect it to send to &#34;mail@andybev.com&#34;


use Mail::Message;
use Mail::Transport::SMTP;
$msg = Mail::Message-&gt;build
       &#40; From     =&gt; &#39;andy@andybev.com&#39;
       , To       =&gt; &#39;andy@andybev.com&#39;
       , Subject  =&gt; &#34;Test message&#34;
       , data     =&gt; &#34;Test body&#34;
       &#41;;
my $sender = Mail::Transport::SMTP-&gt;new&#40;&#41;;
$sender-&gt;destinations&#40;$msg, &#39;mail@andybev.com&#39;&#41;;
$sender-&gt;send&#40;$msg&#41;;


I have looked at the code to try and rectify the problem, but my perl
knowledge is not good enough. However, as an additional point, I did
notice that in Sendmail.pm the code is not suitable for destinations&#40;&#41;
anyway - the sendmail binary is called with &#39;-t&#39;. I believe that
Sendmail should only be called with &#39;-t&#39; if the recipient addresses have
not been overruled.

So, there appears to be 2 related bugs: the destinations&#40;&#41; parameter
does not function as expected for *all* mailer transports, and Sendmail
should not always be called with &#39;-t&#39;.

Thanks,

Andy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874093" href="/Public/Bug/Display.html?id=64266#txn-874093">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;27&nbsp;18:50:15&nbsp;2010</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #64266] Problems with overruling addresses using destinations&#40;&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Dec 2010 00:49:57 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Andrew Beverley via RT &lt;bug-Mail-Box [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/874093/452666/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/452666">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Andrew Beverley via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [101227 19:01]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Mon Dec 27 14:01:05 2010: Request 64266 was acted upon.
&gt; my $sender = Mail::Transport::SMTP-&gt;new&#40;&#41;;
&gt; $sender-&gt;destinations&#40;$msg, &#39;mail@andybev.com&#39;&#41;;
&gt; $sender-&gt;send&#40;$msg&#41;;
&gt; 
</div>
&#34;destinations&#40;&#41;&#34; is not a setter, but a method which computes the
destination.  It is called by send&#40;&#41;.  So, what should work is

  my $sender = Mail::Transport::SMTP-&gt;new&#40;&#41;;
  $sender-&gt;send&#40;$msg, To =&gt; &#39;mail@andybev.com&#39;&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have looked at the code to try and rectify the problem, but my perl
&gt; knowledge is not good enough. However, as an additional point, I did
&gt; notice that in Sendmail.pm the code is not suitable for destinations&#40;&#41;
&gt; anyway - the sendmail binary is called with &#39;-t&#39;. I believe that
&gt; Sendmail should only be called with &#39;-t&#39; if the recipient addresses have
&gt; not been overruled.
</div>
This depends on the &#34;sendmail&#34; you have. Most people have postfixes
version, nowadays.  Its documentation says:

   -t  Extract recipients from message headers. These are added to any
       recipients specified on the command line.

       With Postfix versions prior to 2.1, this option requires that no
       recipient addresses are specified on the command line.

I remember to have added the &#39;-t&#39; later, but am not sure it is correct
&#40;in general or for your version&#41;. Probably you are right: when overruled
then the -t should disappear... Try it!
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874096" href="/Public/Bug/Display.html?id=64266#txn-874096">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;27&nbsp;18:50:16&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874171" href="/Public/Bug/Display.html?id=64266#txn-874171">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;28&nbsp;03:50:05&nbsp;2010</span>
    <span class="description">andy [...] andybev.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andy [...] andybev.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/874171/452697/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/452697">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Dec 27 18:50:15 2010, solutions@overmeer.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * Andrew Beverley via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [101227 19:01]:
<div class="message-stanza open">&gt; &gt; Mon Dec 27 14:01:05 2010: Request 64266 was acted upon.
&gt; &gt; my $sender = Mail::Transport::SMTP-&gt;new&#40;&#41;;
&gt; &gt; $sender-&gt;destinations&#40;$msg, &#39;mail@andybev.com&#39;&#41;;
&gt; &gt; $sender-&gt;send&#40;$msg&#41;;
&gt; &gt; 
</div>&gt; 
&gt; &#34;destinations&#40;&#41;&#34; is not a setter, but a method which computes the
&gt; destination.  It is called by send&#40;&#41;.  So, what should work is
&gt; 
&gt;   my $sender = Mail::Transport::SMTP-&gt;new&#40;&#41;;
&gt;   $sender-&gt;send&#40;$msg, To =&gt; &#39;mail@andybev.com&#39;&#41;;
&gt; 
</div>
Thanks for your prompt response. Yes, that works for SMTP &#40;although
using &#39;to&#39; not &#39;To&#39;&#41;. Sorry for wasting your time on that one :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; This depends on the &#34;sendmail&#34; you have. Most people have postfixes
&gt; version, nowadays.  Its documentation says:
&gt; 
</div>
I am indeed using Postfix - I should have said.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  -t  Extract recipients from message headers. These are added to any
&gt;      recipients specified on the command line.
&gt; 
&gt;      With Postfix versions prior to 2.1, this option requires that no
&gt;      recipient addresses are specified on the command line.
&gt; 
&gt; I remember to have added the &#39;-t&#39; later, but am not sure it is correct
&gt; &#40;in general or for your version&#41;. Probably you are right: when 
&gt; overruled then the -t should disappear... Try it!
</div>
I just tried it, and the override doesn&#39;t work for the Sendmail target.

I don&#39;t think that there is any need for a &#39;-t&#39; at all. I think
Sendmail.pm should be changed to be the same as Exim.pm, so that it
calculates the recipient if none have been specified, or overrides if
they have.

The attached patch Works For Me &#40;TM&#41;.

Thanks,

Andy
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> sendmail-override.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/874171/452698/sendmail-override.patch">Download sendmail-override.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">*** Sendmail.pm	2010-11-09 09:05:35.000000000 +0000
--- /usr/local/share/perl/5.10.0/Mail/Transport/Sendmail.pm	2010-12-28 08:31:27.000000000 +0000
***************
*** 36,47 ****
  sub trySend&#40;$@&#41;
  {   my &#40;$self, $message, %args&#41; = @_;
  
      my $program = $self-&gt;{MTS_program};
      if&#40;open&#40;MAILER, &#39;|-&#39;&#41;==0&#41;
      {   my $options = $args{sendmail_options} || [];
  
          # {} to avoid warning
!         { exec $program, &#39;-ti&#39;, @{$self-&gt;{MTS_opts}}, @$options; }
  
          $self-&gt;log&#40;NOTICE =&gt; &#34;Errors when opening pipe to $program: $!&#34;&#41;;
          exit 1;
--- 36,48 ----
  sub trySend&#40;$@&#41;
  {   my &#40;$self, $message, %args&#41; = @_;
  
+     my @to   = map {$_-&gt;address} $self-&gt;destinations&#40;$message, $args{to}&#41;;
      my $program = $self-&gt;{MTS_program};
      if&#40;open&#40;MAILER, &#39;|-&#39;&#41;==0&#41;
      {   my $options = $args{sendmail_options} || [];
  
          # {} to avoid warning
!         { exec $program, &#39;-i&#39;, @{$self-&gt;{MTS_opts}}, @$options, @to; }
  
          $self-&gt;log&#40;NOTICE =&gt; &#34;Errors when opening pipe to $program: $!&#34;&#41;;
          exit 1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874173" href="/Public/Bug/Display.html?id=64266#txn-874173">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;28&nbsp;04:21:45&nbsp;2010</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #64266] Problems with overruling addresses using destinations&#40;&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Dec 2010 10:21:30 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Andrew Beverley via RT &lt;bug-Mail-Box [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/874173/452700/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/452700">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 672b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Andrew Beverley via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [101228 08:50]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Mail-Box
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=64266">https://rt.cpan.org/Ticket/Display.html?id=64266</a></span> &gt;
&gt; 
&gt; The attached patch Works For Me &#40;TM&#41;.
</div>
Solid fix. Only moved @to= inside the open&#40;&#41;.
If you are in a hurry, I can release a new distribution. Otherwise, it
may take a few weeks.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874254" href="/Public/Bug/Display.html?id=64266#txn-874254">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;28&nbsp;07:25:57&nbsp;2010</span>
    <span class="description">andy [...] andybev.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andy [...] andybev.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/874254/452742/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/452742">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 599b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Dec 28 04:21:45 2010, solutions@overmeer.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * Andrew Beverley via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [101228 08:50]:
<div class="message-stanza open">&gt; &gt;        Queue: Mail-Box
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=64266">https://rt.cpan.org/Ticket/Display.html?id=64266</a></span> &gt;
&gt; &gt; 
&gt; &gt; The attached patch Works For Me &#40;TM&#41;.
</div>&gt; 
&gt; Solid fix. Only moved @to= inside the open&#40;&#41;.
&gt; If you are in a hurry, I can release a new distribution. Otherwise, it
&gt; may take a few weeks.
</div>
That&#39;s fantastic. No need for a new release as I can make the changes
myself until the new version is released.

Thanks for the brilliant support - I really appreciate it.

Andy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-922964" href="/Public/Bug/Display.html?id=64266#txn-922964">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;15&nbsp;04:24:51&nbsp;2011</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/922964/478880/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/478880">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 18b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">got fixed in 2.097
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-922966" href="/Public/Bug/Display.html?id=64266#txn-922966">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;15&nbsp;04:24:52&nbsp;2011</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.4143</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
