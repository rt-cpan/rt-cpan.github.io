<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #72660 for Perl-Critic: Exclude pragmas from Modules::RequireExplicitPackage</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #72660 for Perl-Critic: Exclude pragmas from Modules::RequireExplicitPackage</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Critic/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/Perl-Critic/Perl-Critic/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Critic">Perl-Critic CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">72660</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Critic/Active/">Perl-Critic</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dariusjokilehto [...] yahoo.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-25198-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-25199-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;23&nbsp;07:28:38&nbsp;2011</span>
    <span class="description">dariusjokilehto [...] yahoo.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 23 Nov 2011 12:28:25 +0000 &#40;GMT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Perl-Critic [...] rt.cpan.org&#34; &lt;bug-Perl-Critic [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Darius Jokilehto &lt;dariusjokilehto [...] yahoo.co.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

At work we run Perl::Critic as part of our test suite, and we have recently come across an issue with Modules::RequireExplicitPackage clashing with a new version of DBIx::Class::Schema::Loader, which we use to create our DBIC schema definitions.

As of version 0.07011 DBIC::SL adds a &#39;use utf8&#39; pragma before the package declaration for the files it creates. As pragmas are file-scoped unless they&#39;re in curlies I would suggest excluding pragmas from the rule.

I&#39;m attaching a patch - it&#39;s created from gitpan &#40;v1.105 of Perl::Critic&#41;, please review and let me know if I need to make any changes.

Thanks,
Darius
</div></div>

<div class="messagebody">
</div>
</div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;23&nbsp;14:11:43&nbsp;2011</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 23 Nov 2011 11:11:37 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I would prefer that the change be a list of exempt modules.  I don&#39;t like the idea of having a whole class of modules being exempt.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;23&nbsp;14:11:44&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;24&nbsp;00:00:31&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Nov 23 14:11:43 2011, clonezone wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I would prefer that the change be a list of exempt modules.  I don&#39;t
&gt; like the idea of having a whole class of modules being exempt.
</div>
I think this is not unreasonable, though if it&#39;s my fingers at the
keyboard the list of exempt modules would probably be empty by default.

There actually seem to me to be two issues: what the ticket asks for,
and why it was filed.

Why the ticket was filed:

The motivation for the ticket is that DBIx::Class::Schema::Loader
generates code that puts &#39;use utf8;&#39; before the package declaration. If
Unicode package names were supported by Perl, allowing &#39;use utf8&#39; would
be a no brainer. But &#39;perldoc utf8&#39; says that Unicode package names are
not supported, because a package name is, ultimately, a file name, and
Unicode file names are not portable.

This leaves me believing that it is a stylistic issue, and my feeling is
that the title of the book should come before the first chapter, not
after. Others may feel differently, but nobody makes anyone use any
particular Perl::Critic policy.

We have actually been around the &#34;Code generator X generates the code
this way so Perl::Critic should accept it&#34; merry-go-round before &#40;with
Dist::Zilla and &#39;BEGIN { require 5.010; }&#39; I believe&#41;. And it seems to
me that what code generator X does is not relevant in and of itself.
It&#39;s a question of whether what code generator X does makes sense.

What the ticket asks for:

The ticket generalizes the problem to asking for any pragma to be
accepted before a package statement, justifying this by saying that
pragmas are lexical in scope, and therefore span package boundaries.

That&#39;s fine in theory, but the devil is in the details. The fact is that
I know of no way to determine what is a pragma. Adam Kennedy solves this
by saying it&#39;s a package with an all-lowercase name, and adding all
sorts of caveats to the docs. By this definition, &#39;constant&#39; is a
pragma, but manifest constants declared with &#39;use constant&#39; are scoped
to the name space, not lexically. The only other way to recognize a
lexically-scoped pragma I can think of is an exhaustive list, which will
be out-of-date tomorrow.

My conclusion, for what it&#39;s worth:

What all this says to me is that it would be equally valid to file a
ticket against DBIx::Class::Schema::Loader to get them to put the &#39;use
utf8&#39; after the package statement. Since my only reason for this is
stylistic that does not mean that we reject the ticket. But it looks to
me like a wish list item, with the implementation Elliot suggested.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;25&nbsp;12:22:53&nbsp;2011</span>
    <span class="description">dariusjokilehto [...] yahoo.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 25 Nov 2011 17:22:41 +0000 &#40;GMT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Perl-Critic [...] rt.cpan.org&#34; &lt;bug-Perl-Critic [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Darius Jokilehto &lt;dariusjokilehto [...] yahoo.co.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;On Wed Nov 23 14:11:43 2011, clonezone wrote:
<div class="message-stanza open">&gt;&gt; I would prefer that the change be a list of exempt modules.  I don&#39;t
&gt;&gt; like the idea of having a whole class of modules being exempt.
</div>&gt;
&gt;I think this is not unreasonable, though if it&#39;s my fingers at the
&gt;keyboard the list of exempt modules would probably be empty by default.
&gt;
</div>
[...]

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;My conclusion, for what it&#39;s worth:
&gt;
&gt;What all this says to me is that it would be equally valid to file a
&gt;ticket against DBIx::Class::Schema::Loader to get them to put the &#39;use
&gt;utf8&#39; after the package statement. Since my only reason for this is
&gt;stylistic that does not mean that we reject the ticket. But it looks to
&gt;me like a wish list item, with the implementation Elliot suggested.
&gt;
&gt;
</div>

I did consider sending a patch to DBIx::Class::Schema::Loader instead of
here, but I thought there may be a general use case for the patch with this
Perl::Critic rule.

I&#39;ve gone ahead and altered the patch so as to exempt a list of modules given
by the user, so it has a new option &#40;exempt_modules&#41;.

Is this more in line with what you intended?

Thanks,
Darius
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;25&nbsp;23:24:34&nbsp;2011</span>
    <span class="description">jeff [...] imaginative-software.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 25 Nov 2011 20:24:23 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeffrey Thalhammer &lt;jeff [...] imaginative-software.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From &#34;perldoc perlmod&#34; &#40;with emphasis added&#41;:

A package statement affects only dynamic variables‐‐including those you’ve used local&#40;&#41; on‐‐but not lexical variables created with my&#40;&#41;.  Typically it would be the first declaration in a file included by the &#34;do&#34; &#34;require&#34;, or &#34;use&#34; operators.

Can anyone help me understand when/why a &#39;use&#39; statement &#40;for pragmata or otherwise&#41; before the package declaration would be a good thing?

-Jeff 
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;26&nbsp;11:37:39&nbsp;2011</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 26 Nov 2011 08:37:35 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 11/25/11 8:24 PM, Jeffrey Thalhammer via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can anyone help me understand when/why a &#39;use&#39; statement &#40;for
&gt; pragmata or otherwise&#41; before the package declaration would be a good
&gt; thing?
</div>
Actually, the case that inspired this is one.  If one did not care about portability across filesystems &#40;forget even operating systems&#41;, one could make clear that package names were Unicode via

     use utf8;
     package Some::ƒÚn::∏åçkågè;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;05&nbsp;15:08:36&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Nov 26 11:37:39 2011, clonezone wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 11/25/11 8:24 PM, Jeffrey Thalhammer via RT wrote:
<div class="message-stanza open">&gt; &gt; Can anyone help me understand when/why a &#39;use&#39; statement &#40;for
&gt; &gt; pragmata or otherwise&#41; before the package declaration would be a
</div>&gt; good
<div class="message-stanza open">&gt; &gt; thing?
</div>&gt; 
&gt; Actually, the case that inspired this is one.  If one did not care
&gt; about portability across filesystems &#40;forget even operating systems&#41;,
&gt; one could make clear that package names were Unicode via
&gt; 
&gt;      use utf8;
&gt;      package Some::ƒÚn::∏åçkågè;
</div>
Since the discussion here seems to have kind of petered out, I have
committed a patch to allow configured modules to be imported before the
package statement. The configuration option is &#39;allow_import_of&#39;, though
I&#39;m sure someone can think of a better name, and by default no imports
are allowed. The patch submitted by the requester, while appreciated,
was not used verbatim because of self-compliance concerns.

And of course, if further reflection &#40;and contemplation of the submitted
code&#41; says that we do not want this, the beauty of a source control
system is that it can always be reverted.

Oh. It&#39;s SVN revision 4098.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;05&nbsp;15:08:38&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;07&nbsp;16:46:11&nbsp;2011</span>
    <span class="description">jeff [...] imaginative-software.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 7 Dec 2011 13:45:58 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeffrey Thalhammer &lt;jeff [...] imaginative-software.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Dec 5, 2011, at 12:08 PM, Tom Wyant via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And of course, if further reflection &#40;and contemplation of the submitted
&gt; code&#41; says that we do not want this, the beauty of a source control
&gt; system is that it can always be reverted.
</div>
I find myself afflicted right now with the exact same problem as the OP.  So I&#39;m willing to bless this.

-Jeff
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;07&nbsp;16:46:12&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;08&nbsp;18:59:27&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Dec 07 16:46:11 2011, jeff@imaginative-software.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; On Dec 5, 2011, at 12:08 PM, Tom Wyant via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; And of course, if further reflection &#40;and contemplation of the
</div>&gt; submitted
<div class="message-stanza open">&gt; &gt; code&#41; says that we do not want this, the beauty of a source control
&gt; &gt; system is that it can always be reverted.
</div>&gt; 
&gt; I find myself afflicted right now with the exact same problem as the
&gt; OP.  So I&#39;m willing to bless this.
&gt; 
&gt; -Jeff
&gt; 
</div>
Well, I guess the code had better be right then.
PPI::Statement::Include-&gt;module&#40;&#41; returned undef for &#39;use 5.010;&#39;, but
in fact it returns. Corrected in SVN revision 4099.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;08&nbsp;19:04:20&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 08 18:59:27 2011, WYANT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Well, I guess the code had better be right then.
&gt; PPI::Statement::Include-&gt;module&#40;&#41; returned undef for &#39;use 5.010;&#39;, but
&gt; in fact it returns. Corrected in SVN revision 4099.
</div>
Garbled. What I meant to say was

The code committed in SVN revision 4098 assumed that
PPI::Statement::Include-&gt;module&#40;&#41; returned undef for &#39;use 5.010;&#39;, but
in fact it returns &#39;&#39;. Corrected in SVN revision 4099.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;08&nbsp;19:16:32&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 08 19:04:20 2011, WYANT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Dec 08 18:59:27 2011, WYANT wrote:
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; Well, I guess the code had better be right then.
&gt; &gt; PPI::Statement::Include-&gt;module&#40;&#41; returned undef for &#39;use 5.010;&#39;, but
&gt; &gt; in fact it returns. Corrected in SVN revision 4099.
</div>&gt; 
&gt; Garbled. What I meant to say was
&gt; 
&gt; The code committed in SVN revision 4098 assumed that
&gt; PPI::Statement::Include-&gt;module&#40;&#41; returned undef for &#39;use 5.010;&#39;, but
&gt; in fact it returns &#39;&#39;. Corrected in SVN revision 4099.
</div>
And the above was found in the throes of adding another configuration
option, &#39;allow_perl_version&#39;, to allow the aforementioned &#39;use 5.010;&#39;
before the package statement. This was committed as SVN revision 4100.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;08&nbsp;19:27:30&nbsp;2011</span>
    <span class="description">jeff [...] imaginative-software.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 8 Dec 2011 16:27:20 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeffrey Thalhammer &lt;jeff [...] imaginative-software.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Dec 8, 2011, at 4:16 PM, Tom Wyant via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And the above was found in the throes of adding another configuration
&gt; option, &#39;allow_perl_version&#39;, to allow the aforementioned &#39;use 5.010;&#39;
&gt; before the package statement. This was committed as SVN revision 4100.
</div>

Does it make sense to have that as a separate option from allow_import_of?  Would we gain anything by permitting this in the config:

[Modules::RequireExplicitPackage]
allow_import_of = 5.10 utf8 strict

-Jeff
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;08&nbsp;23:47:52&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 08 19:27:30 2011, jeff@imaginative-software.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; On Dec 8, 2011, at 4:16 PM, Tom Wyant via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; And the above was found in the throes of adding another
</div>&gt; configuration
<div class="message-stanza open">&gt; &gt; option, &#39;allow_perl_version&#39;, to allow the aforementioned &#39;use
</div>&gt; 5.010;&#39;
<div class="message-stanza open">&gt; &gt; before the package statement. This was committed as SVN revision
</div>&gt; 4100.
&gt; 
&gt; 
&gt; Does it make sense to have that as a separate option from
&gt; allow_import_of?  Would we gain anything by permitting this in the
&gt; config:
&gt; 
&gt; [Modules::RequireExplicitPackage]
&gt; allow_import_of = 5.10 utf8 strict
&gt; 
&gt; -Jeff
</div>
Well, to me it made sense for two reasons:

First, &#39;use 5.010;&#39; seems to me different semantically than &#39;use Foo;&#39;.
The first form specifies a version of Perl, the second loads a module.
ExtUtils::MakeMaker considers them different, specifying modules via
PREREQ_PM, and the minimum Perl with MIN_PERL_VERSION. Module::Build
considers them less different, but looks at &#39;use 5.010;&#39; as being more
like requiring version 5.010 of pseudo-module &#39;perl&#39;. So my read is that
the Module::Build approach would be more like

 [Modules::RequireExplicitPackage]
  allow_import_of = perl utf8 strict

Second, because though they are both represented by a
PPI::Statement::Include, if the PPI object represents a &#39;use 5.010;&#39; the
module&#40;&#41; method returns false and the version&#40;&#41; method returns 5.010,
whereas for &#39;use Foo;&#39; the module&#40;&#41; method returns &#39;Foo&#39; and the
version&#40;&#41; method returns false. So the two constructions take separate
paths through the code anyway. Unless I ignore Adam&#39;s take on the
situation as well, and just use $elem-&gt;schild&#40; 1 &#41; to retrieve the
module/version.

Honestly, though, the real reason for not just doing

  allow_import_of = 5.10

is that it just feels weird and fragile to me. Weird, because that
syntax disallows &#39;use 5.x;&#39; for any &#39;x&#39; but that explicitly listed.
Fragile because it the minimal implementation treats &#39;use 5.010;&#39;, &#39;use
5.10.0;&#39;, &#39;use v5.10;&#39; as being different. The principal of least
surprise says they ought all to be equivalent.

Plus, it seems to me if we&#39;re really interested in restricting the
version of Perl specified by &#39;use 5.x;&#39;, it should be a policy all on
its own.

Anyhow, that&#39;s my take. But I made this a separate commit so that it
could be removed if it seemed on discussion to be a bad idea.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;09&nbsp;08:10:56&nbsp;2011</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 09 Dec 2011 07:10:48 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 12/8/11 6:27 PM, Jeffrey Thalhammer via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Dec 8, 2011, at 4:16 PM, Tom Wyant via RT wrote:
&gt;
<div class="message-stanza open">&gt;&gt; And the above was found in the throes of adding another
&gt;&gt; configuration option, &#39;allow_perl_version&#39;, to allow the
&gt;&gt; aforementioned &#39;use 5.010;&#39; before the package statement. This was
&gt;&gt; committed as SVN revision 4100.
</div>&gt;
&gt; Does it make sense to have that as a separate option from
&gt; allow_import_of?  Would we gain anything by permitting this in the
&gt; config:
&gt;
&gt; [Modules::RequireExplicitPackage] allow_import_of = 5.10 utf8 strict
</div>
Interesting question because there&#39;s a big debate going on in 5p5 over what &#34;use 5.xxx&#34; means.  As of 5.10, it means

     BEGIN {
         require 5.xxx;
        require feature;
        feature-&gt;import&#40;:5.xx&#41;;
     }

and the feature-&gt;import&#40;...&#41; is supposed to be inclusive of prior versions, i.e. import of :5.yy is supposed to include everything in :5.xx where yy &gt; xx.  That might not be the case.  A feature may be added in 5.16, decided that it&#39;s deprecated in 5.18, and then removed from anything that declares it wants 5.20 &#40;though still supported if you say &#34;use 5.16&#34; or &#34;use 5.18&#34;&#41;.

So, really, for our purposes, &#34;use 5.xx&#34; should be treated as the equivalent of &#34;use feature&#34;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;09&nbsp;09:24:09&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 09 08:10:56 2011, clonezone wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 12/8/11 6:27 PM, Jeffrey Thalhammer via RT wrote:
<div class="message-stanza open">&gt; &gt; On Dec 8, 2011, at 4:16 PM, Tom Wyant via RT wrote:
&gt; &gt;
<div class="message-stanza open">&gt; &gt;&gt; And the above was found in the throes of adding another
&gt; &gt;&gt; configuration option, &#39;allow_perl_version&#39;, to allow the
&gt; &gt;&gt; aforementioned &#39;use 5.010;&#39; before the package statement. This was
&gt; &gt;&gt; committed as SVN revision 4100.
</div>&gt; &gt;
&gt; &gt; Does it make sense to have that as a separate option from
&gt; &gt; allow_import_of?  Would we gain anything by permitting this in the
&gt; &gt; config:
&gt; &gt;
&gt; &gt; [Modules::RequireExplicitPackage] allow_import_of = 5.10 utf8 strict
</div>&gt; 
&gt; Interesting question because there&#39;s a big debate going on in 5p5 over
&gt;    what &#34;use 5.xxx&#34; means.  As of 5.10, it means
&gt; 
&gt;      BEGIN {
&gt;          require 5.xxx;
&gt;       require feature;
&gt;       feature-&gt;import&#40;:5.xx&#41;;
&gt;      }
&gt; 
&gt; and the feature-&gt;import&#40;...&#41; is supposed to be inclusive of prior
&gt;    versions, i.e. import of :5.yy is supposed to include everything in
&gt;    :5.xx where yy &gt; xx.  That might not be the case.  A feature may be
&gt;    added in 5.16, decided that it&#39;s deprecated in 5.18, and then
&gt;    removed from anything that declares it wants 5.20 &#40;though still
&gt;    supported if you say &#34;use 5.16&#34; or &#34;use 5.18&#34;&#41;.
&gt; 
&gt; So, really, for our purposes, &#34;use 5.xx&#34; should be treated as the
&gt;    equivalent of &#34;use feature&#34;.
</div>
use v5.10 is now equivalent to:

    BEGIN {
        require v5.10;
        no feature;
        feature-&gt;import&#40;&#39;:5.10&#39;&#41;;
    }

But there is a good possibility that, some time before 5.16, ‘use v5.10’ will not actually load 
feature.pm to do its work.  So considering ‘use v5.10’ equivalent to ‘use feature’ may not be 
a good idea.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;10&nbsp;19:41:15&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Well, it seems that handling &#39;use 5.010;&#39; is less obvious than I thought
it was. Or, at least it is obvious different ways to different people.
To summarize:

Me: A separate configuration item, allow_perl_version.

Jeff: No new option, just stick a version in allow_import_of. 

Me: OK, no new option, stick &#39;perl&#39; in allow_import_of.

Elliot: It&#39;s more like &#39;use feature&#39; &#40;implying to me the use of
&#39;feature&#39; rather than &#39;perl&#39;, but Elliot did not say this&#41;.

Fr. Chrysostomos: This form of &#39;use&#39; did not imply &#39;use feature&#39; before
5.10, and may not by 5.16. So &#39;feature&#39; may not be a good idea.

At this point, I don&#39;t see consensus on how or whether to handle the
&#39;use 5.010;&#39; construct. It was _not_ requested in this ticket - I just
noticed that CPAN::Meta starts

use 5.006;
use strict;
use warnings;
package CPAN::Meta;

and tried to anticipate.

So what I propose to do is to wait a few days to be sure there is no
further debate. If there is none, I will back out SVN revision 4100 and
note that in this ticket.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;10&nbsp;19:45:47&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Dec 10 19:41:15 2011, WYANT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Well, it seems that handling &#39;use 5.010;&#39; is less obvious than I thought
&gt; it was. Or, at least it is obvious different ways to different people.
&gt; To summarize:
&gt; 
&gt; Me: A separate configuration item, allow_perl_version.
&gt; 
&gt; Jeff: No new option, just stick a version in allow_import_of. 
&gt; 
&gt; Me: OK, no new option, stick &#39;perl&#39; in allow_import_of.
&gt; 
&gt; Elliot: It&#39;s more like &#39;use feature&#39; &#40;implying to me the use of
&gt; &#39;feature&#39; rather than &#39;perl&#39;, but Elliot did not say this&#41;.
&gt; 
&gt; Fr. Chrysostomos: This form of &#39;use&#39; did not imply &#39;use feature&#39; before
&gt; 5.10, and may not by 5.16. So &#39;feature&#39; may not be a good idea.
</div>
FYI, I’m not actually using this module. I just wanted to provide clarification as to the 
feature.pm status, so your decision could be more informed.  I.e., I couldn’t care less what 
the outcome is. :-&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; At this point, I don&#39;t see consensus on how or whether to handle the
&gt; &#39;use 5.010;&#39; construct. It was _not_ requested in this ticket - I just
&gt; noticed that CPAN::Meta starts
&gt; 
&gt; use 5.006;
&gt; use strict;
&gt; use warnings;
&gt; package CPAN::Meta;
&gt; 
&gt; and tried to anticipate.
&gt; 
&gt; So what I propose to do is to wait a few days to be sure there is no
&gt; further debate. If there is none, I will back out SVN revision 4100 and
&gt; note that in this ticket.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;10&nbsp;21:48:02&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Dec 10 19:45:47 2011, SPROUT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sat Dec 10 19:41:15 2011, WYANT wrote:
<div class="message-stanza open">&gt; &gt; Fr. Chrysostomos: This form of &#39;use&#39; did not imply &#39;use feature&#39;
&gt; &gt; before 5.10, and may not by 5.16. So &#39;feature&#39; may not be a good
&gt; &gt; idea.
</div>&gt; 
&gt; FYI, I’m not actually using this module. I just wanted to provide
&gt; clarification as to the
&gt; feature.pm status, so your decision could be more informed.  I.e., I
&gt; couldn’t care less what
&gt; the outcome is. :-&#41;
</div>
Thank you. Much appreciated. An informed decision can still be stupid,
but is less likely to be.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;17&nbsp;18:26:12&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">As proposed a couple ticket updates ago, in the absence of dissent, I
have removed the allow_perl_version configuration option that was added
in commit 4100. The removal was committed as SVN revision 4101.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;24&nbsp;16:17:32&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Dec 10 21:48:02 2011, WYANT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sat Dec 10 19:45:47 2011, SPROUT wrote:
<div class="message-stanza open">&gt; &gt; On Sat Dec 10 19:41:15 2011, WYANT wrote:
<div class="message-stanza open">&gt; &gt; &gt; Fr. Chrysostomos: This form of &#39;use&#39; did not imply &#39;use feature&#39;
&gt; &gt; &gt; before 5.10, and may not by 5.16.
</div></div></div>
Indeed, it will not, as of perl commit 2fc860ee1e.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; FYI, I’m not actually using this module. I just wanted to provide
&gt; &gt; clarification as to the
&gt; &gt; feature.pm status, so your decision could be more informed.  I.e., I
&gt; &gt; couldn’t care less what
&gt; &gt; the outcome is. :-&#41;
</div>&gt; 
&gt; Thank you. Much appreciated. An informed decision can still be stupid,
&gt; but is less likely to be.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;25&nbsp;07:08:44&nbsp;2012</span>
    <span class="description">dolmen [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le 2011-12-11 01:41:15, WYANT a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Well, it seems that handling &#39;use 5.010;&#39; is less obvious than I thought
</div>
The difference with &#39;use&#39; statements is the scope on which they apply.

Most &#34;pragma&#34; &#40;lower-case module names&#41; apply to lexical scope: strict,
warnings, Perl version, utf8, byte, encoding... Some exceptions are well
known: base, parent, constant.
Most upper-case apply to the package scope as they import symbols into
the package.

So the rule for allowing a &#34;use&#34; statement before a &#34;package&#34; statement
is the scope on which the imported module applies.
Any lexical module should be allowed before the &#39;package&#39; statement,
except for stylistic reasons. But there is now easy rule to determine if
a module is lexical. The only practical solution is a list of module names.

-- 
Olivier Mengué - <span class="clickylink"><a target="new" rel="nofollow" href="http://perlresume.org/DOLMEN">http://perlresume.org/DOLMEN</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;05:36:18&nbsp;2012</span>
    <span class="description">dolmen [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le 2012-02-25 13:08:44, DOLMEN a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Any lexical module should be allowed before the &#39;package&#39; statement,
&gt; except for stylistic reasons.
</div>
I even think that it would be useful to make a policy that enforce that
lexical packages used at the top scope must be used before a package
statement. Because a file may contain multiple packages, and lexical
modules &#40;ex: strict, utf8&#41; will not limit themselves to the package in
which they are declared.

-- 
Olivier Mengué - <span class="clickylink"><a target="new" rel="nofollow" href="http://perlresume.org/DOLMEN">http://perlresume.org/DOLMEN</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;13:37:17&nbsp;2012</span>
    <span class="description">jeff [...] imaginative-software.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72660] Exclude pragmas from Modules::RequireExplicitPackage</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 27 Feb 2012 10:37:02 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeffrey Thalhammer &lt;jeff [...] imaginative-software.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Feb 27, 2012, at 2:36 AM, Olivier Mengué via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I even think that it would be useful to make a policy that enforce that
&gt; lexical packages used at the top scope must be used before a package
&gt; statement. Because a file may contain multiple packages, and lexical
&gt; modules &#40;ex: strict, utf8&#41; will not limit themselves to the package in
&gt; which they are declared.
</div>
I am confused.  To me, a &#34;lexical&#34; pragmata is one that is bound to the location where it is declared.   strict and warnings fall into this category.  Then there are &#34;file-scoped&#34; pragmata that apply to the entire file, regardless of where they are declared.  I think utf8 falls in this category but not 100% sure.   You can emulate a file-scoped pragmata by placing a lexical pragmata at the very beginning of a file.  But that doesn&#39;t change the fact that it is still lexical &#40;i.e. bound to a location&#41;.

Someone set me straight please.

-Jeff 
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;23:19:37&nbsp;2012</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Feb 27 13:37:17 2012, jeff@imaginative-software.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; On Feb 27, 2012, at 2:36 AM, Olivier Mengué via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; I even think that it would be useful to make a policy that enforce
</div>&gt;    that
<div class="message-stanza open">&gt; &gt; lexical packages used at the top scope must be used before a package
&gt; &gt; statement. Because a file may contain multiple packages, and lexical
&gt; &gt; modules &#40;ex: strict, utf8&#41; will not limit themselves to the package
</div>&gt;    in
<div class="message-stanza open">&gt; &gt; which they are declared.
</div>&gt; 
&gt; I am confused.  To me, a &#34;lexical&#34; pragmata is one that is bound to
&gt;    the location where it is declared.   strict and warnings fall into
&gt;    this category.  Then there are &#34;file-scoped&#34; pragmata that apply to
&gt;    the entire file, regardless of where they are declared.  I think
&gt;    utf8 falls in this category but not 100% sure.   You can emulate a
&gt;    file-scoped pragmata by placing a lexical pragmata at the very
&gt;    beginning of a file.  But that doesn&#39;t change the fact that it is
&gt;    still lexical &#40;i.e. bound to a location&#41;.
&gt; 
&gt; Someone set me straight please.
&gt; 
&gt; -Jeff
&gt; 
</div>
Me too. And let try to say why I&#39;m confused.

I understand the proposal to be for a policy that requires lexical
pragmata declared at file scope to occur before the first &#39;package&#39;
declaration, if any.

I won&#39;t comment on the merits of this policy. But presuming it can be
written, it should not be in core Perl::Critic, unless the
&#34;zero-configuration&#34; policy is dropped. I think the following dilemma
shows this:

Assume the proposed policy &#34;knows&#34; what all the lexical pragmata are.
Then, if you run Perl::Critic out of the box &#40;i.e. with no .perlcriticrc
file&#41;, every module will violate either the proposed policy or
Modules::RequireExplicitPackage. This does not sound like a good thing
to me -- at least _I_ am not anxious to respond to the RT tickets this
will cause.

Assume the proposed policy does not &#34;know&#34; what all the lexical pragmata
are. Then, the policy will do nothing unless the user configures the
names of the pragmata. But that violates the &#34;zero-configuration&#34; rule.

A further difficulty in writing the proposed policy is that nobody knows
any way to identify lexical pragmas &#40;or, for that matter, any pragma&#41;
other than to list them. Given the ferment that is CPAN, a built-in list
would &#40;I fear&#41; be obsolete in short order.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;28&nbsp;05:53:44&nbsp;2012</span>
    <span class="description">dolmen [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> jeff [...] imaginative-software.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le 2012-02-27 19:37:17, jeff@imaginative-software.com a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; On Feb 27, 2012, at 2:36 AM, Olivier Mengué via RT wrote:
&gt; I am confused.  To me, a &#34;lexical&#34; pragmata is one that is bound to
&gt;    the location where it is declared.   strict and warnings fall into
&gt;    this category.  Then there are &#34;file-scoped&#34; pragmata that apply to
&gt;    the entire file, regardless of where they are declared.  I think
&gt;    utf8 falls in this category but not 100% sure.   You can emulate a
&gt;    file-scoped pragmata by placing a lexical pragmata at the very
&gt;    beginning of a file.  But that doesn&#39;t change the fact that it is
&gt;    still lexical &#40;i.e. bound to a location&#41;.
</div>
File-scoped pragmata doesn&#39;t exists in itself. This is just a lexical
pragmata outside any {} block, so at the top scope of the file.

utf8/encoding are lexical pragmata. See the attached file that use
multiple encodings in the same source. Use &#34;perl -C enc.pl&#34; to run it.

My point is that when a file contains multiple packages, disallowing
lexical pragmas outside packages doesn&#39;t help the user to understand
what Perl does. In fact, it does the opposite, making think that the
scope of pragma is the package.
Here is an example:

   package A;
   use warnings;
   package B;
   $a = 5;
   1;

The &#34;use warnings&#34; applies to statements in package B as well as in
package A. So I prefer to write my code like that:

   use warnings;
   package A;
   package B;
   $a = 5;
   1;

--
Olivier Mengué - <span class="clickylink"><a target="new" rel="nofollow" href="http://perlresume.org/DOLMEN">http://perlresume.org/DOLMEN</a></span>
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> enc.pl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use 5.010;
{
    use utf8;
    say &#34;Olivier MenguÃ©&#34;;
}
{
    use encoding &#34;cp1252&#34;;
    say &#34;Olivier Mengué&#34;;
}
{
    use utf8;
    say &#34;Olivier MenguÃ©&#34;;
}
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
