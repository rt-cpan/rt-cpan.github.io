<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #42454 for Tkx: Megawidget method delegation ignores overrides</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #42454 for Tkx: Megawidget method delegation ignores overrides</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Tkx/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Tkx/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Tkx/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Tkx/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Tkx">Tkx CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">42454</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Tkx/Active/">Tkx</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MJCARMAN [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-34200-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.04    </td>
  </tr>
  <tr id="CF-34201-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;15&nbsp;17:40:10&nbsp;2009</span>
    <span class="description">MJCARMAN [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Megawidget method delegation ignores overrides</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Tkx has some problems when delegating method calls from one megawidget
to another megawidget.

I&#39;m trying to create a Tkx equivalent for Perl/Tk&#39;s Scrolled megawidget.
The basic design is a frame-based megawidget that embeds a widget of a
user-defined type. I want to delegate all method calls to that subwidget
so I override the _mpath&#40;&#41; method to do so. For a built-in text widget
everything appears to work properly. e.g. I can call the insert&#40;&#41; method
on my megawidget and the text is added to the subwidget. When I embed a
Tkx::ROText widget the text is *not* added. It appears that Tkx is
calling the Tcl insert method &#40;which has been stubbed to do nothing&#41;
instead of the Perl method. The key bit of code appears to be line 165
of Tkx.pm:

return scalar&#40;Tkx::i::call&#40;$self-&gt;_mpath&#40;$i[0]&#41;, @i, @_&#41;&#41;;

This is as close as I get to my insert method. I never make it to the
overridden definition in Tkx::ROText.  I need to call the method in
$i[0] on the Perl widget named $self-&gt;_mpath but there&#39;s no reference,
just a name. Is there any way to get the object reference from the name?
I&#39;ve noticed that Tkx has no equivilent of Perl/Tk&#39;s Advertise&#40;&#41; and
Subwidget&#40;&#41; methods.

In my particular case the problem is partially due to the tricks I play
to make the widget readonly &#40;renaming the Tcl widget and stubbing the
insert and delete methods for the original name&#41; but the core problem
remains. For example, if I add a &#34;blurb&#34; method to Tkx::ROText I can&#39;t
call it via Scrolled:

bad option &#34;blurb&#34;: must be bbox, cget, compare...

Here&#39;s a fairly small example that demonstrates the problem; hopefully
RT doesn&#39;t mangle it too badly...

use strict;
use warnings;

package Tkx::Scrolled;
use Tkx;
use base qw&#40;Tkx::widget Tkx::MegaConfig&#41;;
__PACKAGE__-&gt;_Mega&#40;&#39;tkx_Scrolled&#39;&#41;;

sub _Populate {
 my $class  = shift;
 my $widget = shift;
 my $path   = shift;
 my $type   = shift;
 my %opt    = @_;

 my $self = $class-&gt;new&#40;$path&#41;-&gt;_parent-&gt;new_frame&#40;-name =&gt; $path&#41;;
 $self-&gt;_class&#40;$class&#41;;

 my $new_thing = &#34;new_$type&#34;;
 my $w = $self-&gt;$new_thing&#40;-name =&gt; &#39;scrolled&#39;, %opt&#41;;

 $w-&gt;g_pack&#40;&#41;;

 return $self;
}

sub _mpath { $_[0] . &#39;.scrolled&#39; }

package main;
use Tkx;
use Tkx::ROText;

my $mw   = Tkx::widget-&gt;new&#40;&#39;.&#39;&#41;;
my $text = $mw-&gt;new_tkx_Scrolled&#40;&#39;tkx_ROText&#39;&#41;;  # &#39;text&#39; works fine

$text-&gt;g_pack&#40;&#41;;
$text-&gt;insert&#40;&#39;end&#39;, &#39;Fee Fie Fo Fum&#39;&#41;;

Tkx::MainLoop&#40;&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;16&nbsp;04:50:08&nbsp;2009</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve now applied 
<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/gisle/tkx/commit/b0a3f1bdcc9b51de8bd7608386e56cfd21f40962">http://github.com/gisle/tkx/commit/b0a3f1bdcc9b51de8bd7608386e56cfd21f40962</a></span> as fix 
for this.  The crux of the patch is this:

--- a/Tkx.pm
+++ b/Tkx.pm
@@ -162,7 +162,9 @@ sub AUTOLOAD {
 
     if &#40;$prefix eq &#34;m_&#34;&#41; {
        my @i = Tkx::i::expand_name&#40;substr&#40;$method, 2&#41;&#41;;
-       return scalar&#40;Tkx::i::call&#40;$self-&gt;_mpath&#40;$i[0]&#41;, @i, @_&#41;&#41;;
+        my $p = $self-&gt;_mpath&#40;$i[0]&#41;;
+        return scalar&#40;Tkx::i::call&#40;$p, @i, @_&#41;&#41; if $p eq $$self || !$class{$p};
+        return &#40;bless \$p, $class{$p}&#41;-&gt;$method&#40;@_&#41;;
     }
     elsif &#40;index&#40;$prefix, &#34;_&#34;&#41; != -1&#41; {
        require Carp;

On problem here is that if the sub-mega-widget implement an &#39;insert&#39; method we will not 
find it because the $w-&gt;insert&#40;&#41; call is first rewritten into $w-&gt;m_insert&#40;&#41; before it is 
forwarded.  We could just declare that mega widgets should use the &#39;m_&#39; prefix on all its 
methods.  Does that feel right?

Alternative is to add this enhancement to the patch:

--- a/Tkx.pm
+++ b/Tkx.pm
@@ -171,6 +172,9 @@ sub AUTOLOAD {
        Carp::croak&#40;&#34;method &#39;$method&#39; reserved by Tkx&#34;&#41;;
     }
 
+    my $p = $self-&gt;_mpath&#40;$method&#41;;
+    return &#40;bless \$p, $class{$p}&#41;-&gt;$method&#40;@_&#41; if $p ne $self &#38;&#38; $class{$p};
+
     $method = &#34;m_$method&#34;;
     return $self-&gt;$method&#40;@_&#41;;
 }

which make sure to forward method to perl megawidgets unchanged.   I&#39;m not totally happy 
with this because now we end up calling _mpath&#40;&#41; twice for most $w-&gt;foo calls that don&#39;t 
use the m_ prefix.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;16&nbsp;04:50:08&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;16&nbsp;10:26:26&nbsp;2009</span>
    <span class="description">MJCARMAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We could just declare that mega widgets should use the
&gt; &#39;m_&#39; prefix on all its methods.  Does that feel right?
</div>
It wasn&#39;t clear to me whether you meant requiring module authors to name
their methods &#39;m_foo&#39; or requiring users to call them that way. After
trying it both ways it appears that you meant the former. &#40;That&#39;s good
-- I would have strongly protested the latter.&#41; While it doesn&#39;t quite
feel right to me it&#39;s palatable. The extra effort is trivial. My concern
would be ensuring that developers know that they should do it.

I think it&#39;s really a question of what you want the API for building
megawidgets to be. As far as I know I&#39;m the only person who has
developed any &#40;at least for CPAN&#41; so changing it now isn&#39;t a big deal.
Whatever you choose, you&#39;ll be stuck with it eventually, so choose
carefully. :D

From an API perspective I prefer the additional change but I can
understand your desire to keep AUTOLOAD as lightweight as possible.
Would it be feasible to use AUTOLOAD to install a handler instead? That
way all the name and path parsing would only happen the first time you
called a method.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;16&nbsp;11:24:40&nbsp;2009</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 16 10:26:26 2009, MJCARMAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; We could just declare that mega widgets should use the
&gt; &gt; &#39;m_&#39; prefix on all its methods.  Does that feel right?
</div>&gt; 
&gt; It wasn&#39;t clear to me whether you meant requiring module authors to name
&gt; their methods &#39;m_foo&#39; or requiring users to call them that way. After
&gt; trying it both ways it appears that you meant the former. &#40;That&#39;s good
</div>
That&#39;s right.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -- I would have strongly protested the latter.&#41; While it doesn&#39;t quite
&gt; feel right to me it&#39;s palatable. The extra effort is trivial. My concern
&gt; would be ensuring that developers know that they should do it.
</div>
That&#39;s what documentation is for :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think it&#39;s really a question of what you want the API for building
&gt; megawidgets to be. As far as I know I&#39;m the only person who has
&gt; developed any &#40;at least for CPAN&#41; so changing it now isn&#39;t a big deal.
</div>
That&#39;s probably right. For ActiveState&#39;s applications we just ended up doing our mega 
widgets in Tcl, mostly because we &#34;out-sourced&#34; their development to our Tcl guy.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Whatever you choose, you&#39;ll be stuck with it eventually, so choose
&gt; carefully. :D
</div>
If I apply this extra patch we&#39;ll be stuck with it.  If I don&#39;t it should not be a problem to apply 
it later as this is really just an extension to the API.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; From an API perspective I prefer the additional change but I can
&gt; understand your desire to keep AUTOLOAD as lightweight as possible.
</div>
There is actually another reason now that I think about it.  Forcing the widget implementors 
to use the m_ prefix make sure that widgets behave the same whether they are implemented 
in Tcl or Perl.  Otherwise only Tcl widgets could be called both with the m_ prefix and 
without, while Perl widgets would always have to be called without.  Not that this is a big 
deal.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Would it be feasible to use AUTOLOAD to install a handler instead? That
&gt; way all the name and path parsing would only happen the first time you
&gt; called a method.
</div>
That&#39;s possibly a good idea regardless.  I think I should try to spend some time in 
Devel::NYTProf first to figure out if the time spent in the AUTOLOAD function is significant 
and only try this if it is.

BTW, as you probably noticed Tkx is now maintained in git with github as the central 
repository.  If you are interested in commit access to the repo I&#39;m happy to enable it for you.  
You would need a github account first.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;16&nbsp;13:39:20&nbsp;2009</span>
    <span class="description">MJCARMAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; My concern would be ensuring that developers know that they
&gt;&gt; should do it.
</div>&gt; 
&gt; That&#39;s what documentation is for :&#41;
</div>
Well, yeah, if they actually read it. :P

I&#39;m visualizing a scenario where if the author doesn&#39;t give their method
names an &#39;m_&#39; prefix the problem wouldn&#39;t be detected until someone
tried to embed it and delegate to it. That&#39;s when I&#39;d start getting
reports about how Tkx::Scrolled breaks Tkx::Whatever.

I could be making a mountain out of a molehill. I don&#39;t know how common
it will be to nest megawidgets. It might be more than one would expect
since there&#39;s no way to subclass the built-in widgets other than using
the megawidget API. e.g. Tkx::ROText should really be a subclass of the
text widget, not a megawidget.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Forcing the widget implementors to use the m_ prefix make sure
&gt; that widgets behave the same whether they are implemented in 
&gt; Tcl or Perl.
</div>
That&#39;s a good point. I find it rather compelling, but I&#39;m curious -- is
it possible to change the implementation between Perl and Tcl without
affecting the way it&#39;s used? Wouldn&#39;t the user at least have to change
&#34;use Tkx::Foo&#34; to &#34;Tkx::package_require&#40;&#39;widget::foo&#39;&#41;&#34;?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think I should try to spend some time in Devel::NYTProf first
&gt; to figure out if the time spent in the AUTOLOAD function is
&gt; significant and only try this if it is.
</div>
It probably is. Tkx calls AUTOLOAD for every method call and calls it
twice when the &#39;m_&#39; prefix isn&#39;t included &#40;although that could be
avoided fairly easily&#41;. That could add up quickly for things like
$text-&gt;insert&#40;&#41; although I&#39;m not sure that the display can keep up anyway...

&lt;tangent&gt;I wish I could get Devel::NYTProf to build on Windows&lt;/tangent&gt;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you are interested in commit access to the repo I&#39;m
&gt; happy to enable it for you.
</div>
I&#39;m not sure I know enough to be trusted with a commit bit. :P I did
join the tcltk mailing list. Is there a roadmap for Tkx? My work so far
has mostly been trying to plug holes for those transitioning from
Perl/Tk. I&#39;d be happy to make that part of the core Tkx distribution
instead of an smattering of separate pieces, but I have the impression
that Tkx is intended to be minimalist.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;09:46:13&nbsp;2009</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 16 13:39:20 2009, MJCARMAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; My concern would be ensuring that developers know that they
&gt; &gt;&gt; should do it.
</div>&gt; &gt; 
&gt; &gt; That&#39;s what documentation is for :&#41;
</div>&gt; 
&gt; Well, yeah, if they actually read it. :P
&gt; 
&gt; I&#39;m visualizing a scenario where if the author doesn&#39;t give their method
&gt; names an &#39;m_&#39; prefix the problem wouldn&#39;t be detected until someone
&gt; tried to embed it and delegate to it. That&#39;s when I&#39;d start getting
&gt; reports about how Tkx::Scrolled breaks Tkx::Whatever.
</div>
Seems like something that could happen.  Don&#39;t know if we can do much about it besides 
documenting the issue.  Having something like Tkx::Scrolled out there make it more likely 
that this is discovered.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I could be making a mountain out of a molehill. I don&#39;t know how common
&gt; it will be to nest megawidgets. It might be more than one would expect
&gt; since there&#39;s no way to subclass the built-in widgets other than using
&gt; the megawidget API. e.g. Tkx::ROText should really be a subclass of the
&gt; text widget, not a megawidget.
</div>
Right, but some compromises must be made in a cross-language library like Tkx.  Having to 
make it a megawidget just to tweak the behaviour of a Tcl widget seems acceptable to me.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Forcing the widget implementors to use the m_ prefix make sure
&gt; &gt; that widgets behave the same whether they are implemented in 
&gt; &gt; Tcl or Perl.
</div>&gt; 
&gt; That&#39;s a good point. I find it rather compelling, but I&#39;m curious -- is
&gt; it possible to change the implementation between Perl and Tcl without
&gt; affecting the way it&#39;s used? Wouldn&#39;t the user at least have to change
&gt; &#34;use Tkx::Foo&#34; to &#34;Tkx::package_require&#40;&#39;widget::foo&#39;&#41;&#34;?
</div>
Sure, but that&#39;s a small change compared to walking though all the places you might call 
methods on this widget.  It&#39;s not that likely that widget implementors would change the 
language, but having a single documented mapping for widget users seems valuable.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I think I should try to spend some time in Devel::NYTProf first
&gt; &gt; to figure out if the time spent in the AUTOLOAD function is
&gt; &gt; significant and only try this if it is.
</div>&gt; 
&gt; It probably is. Tkx calls AUTOLOAD for every method call and calls it
&gt; twice when the &#39;m_&#39; prefix isn&#39;t included &#40;although that could be
&gt; avoided fairly easily&#41;. That could add up quickly for things like
&gt; $text-&gt;insert&#40;&#41; although I&#39;m not sure that the display can keep up anyway...
</div>
I tried today.  The AUTOLOAD function wasn&#39;t alarmingly expensive in the test programs I 
had, but I still found that it would be a good idea to swap the order of dealing with &#34;m_&#34; and 
&#34;g_&#34; methods since the &#34;m_&#34; methods were many times more frequent.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;tangent&gt;I wish I could get Devel::NYTProf to build on Windows&lt;/tangent&gt;
</div>
It&#39;s supposed to build fine on Windows since version 2.07.  If it doesn&#39;t it might be a good 
idea to report it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; If you are interested in commit access to the repo I&#39;m
&gt; &gt; happy to enable it for you.
</div>&gt; 
&gt; I&#39;m not sure I know enough to be trusted with a commit bit. :P I did
&gt; join the tcltk mailing list. Is there a roadmap for Tkx? My work so far
&gt; has mostly been trying to plug holes for those transitioning from
&gt; Perl/Tk. I&#39;d be happy to make that part of the core Tkx distribution
&gt; instead of an smattering of separate pieces, but I have the impression
&gt; that Tkx is intended to be minimalist.
</div>
There is no roadmap.  I don&#39;t really have a need for extending Tkx much as it works fine for 
what what we do as it is and it already adopts automatically to Tcl/Tk as it improves over 
time.

Having Tkx be small is a good thing, so I think it is better to keep most megawidgets 
outside, but if anything that support the construction of these should probably be part of the 
core.  Having the commit access might make it easier for you to fix things in that area as you 
encounter them and for instance minor documentation nits you might find.

Just sending me patches is fine as well.

BTW, I uploaded Tkx-1.06 to CPAN today.  It contains the fix for forwarding to megawidgets 
in perl.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;09:46:14&nbsp;2009</span>
    <span class="description">GAAS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
