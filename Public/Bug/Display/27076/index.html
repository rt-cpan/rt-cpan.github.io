<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #17465 for Spreadsheet-WriteExcel: references in second argument to COUNTIF doesn&#39;t work</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #17465 for Spreadsheet-WriteExcel: references in second argument to COUNTIF doesn&#39;t work</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-WriteExcel">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-WriteExcel">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-WriteExcel">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-WriteExcel">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-WriteExcel">Spreadsheet-WriteExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::WriteExcel here are some pointers</b>
<p>

1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>

2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>

3) Upgrade to the latest version of Spreadsheet::WriteExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.

<p>
4) <b>Create a small but complete example program that demonstrates your problem.</b> The program should be as small as possible. At the same time it should be a complete program that generates an Excel file. If the Spreadsheet::WriteExcel section is part of a much larger program then simplify it down to the essentials. Simulate any DB reads with an array.
<p>

5) Say if you tested with Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>

6) If you are submitting a patch you should check with the author whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-writeexcel">Spreadsheet::WriteExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">17465</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-WriteExcel">Spreadsheet-WriteExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">jmcnamara [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
eva [...] multimap.com

<br />
peca110 [...] yahoo.se

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-29480-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.12    </td>
  </tr>
  <tr id="CF-29481-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




exceller.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/162096/51007/exceller.pl">
Fri Feb 03 10:27:36 2006 (460b) by Guest
</a>
</font></li>
</ul>


exceller.xls<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/162096/51004/exceller.xls">
Fri Feb 03 10:27:36 2006 (5.5k) by Guest
</a>
</font></li>
</ul>


exceller2.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/162515/51238/exceller2.pl">
Sun Feb 05 12:56:39 2006 (625b) by Guest
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=17465">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-162096" href="/Public/Bug/Display.html?id=17465#txn-162096">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;03&nbsp;10:27:36&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> COUNTIF not calculating value</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/162096/51001/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/51001">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 408b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Excel doesn&#39;t seem to calculate the value in 
$wks-&gt;write&#40; 1, 4, &#34;=COUNTIF&#40;A:A,B3&#41;&#34; &#41;;

However, if I open the output file exceller.xls and press enter in the
formula bar for cell E2, Excel then calculates the value.

This seems to be an issue with my version of Excel - on Excel:Mac v.X
the code/output works as expected.

version info:
GNU/Linux 2.6.9-1.667smp
perl, v5.8.5 built for i686-linux
Excel: 2003
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> exceller.xls</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/162096/51004/exceller.xls">Download exceller.xls</a><br />
<span class="downloadcontenttype">application/vnd.ms-excel 5.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> exceller.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/162096/51007/exceller.pl">Download exceller.pl</a><br />
<span class="downloadcontenttype">text/x-perl 460b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use utf8;
use strict;
use warnings;

use Spreadsheet::WriteExcel;

my $outfile = &#34;exceller.xls&#34;;

my $wbk = Spreadsheet::WriteExcel-&gt;new&#40; $outfile &#41;;
my $wks = $wbk-&gt;add_worksheet&#40; &#39;Test&#39; &#41;;

my $row = 1;
   for&#40;my $i =0; $i &lt; 11; $i++&#41; {
	$wks-&gt;write&#40; $row, 0, $i &#41;;
	$row++;	
    }

$wks-&gt;write&#40; 1, 2, &#34;=COUNT&#40;A:A&#41;&#34; &#41;;	
$wks-&gt;write&#40; 1, 3, &#34;=COUNTIF&#40;A:A,5&#41;&#34; &#41;;

$wks-&gt;write&#40; 2, 1, &#34;5&#34; &#41;;	
$wks-&gt;write&#40; 1, 4, &#34;=COUNTIF&#40;A:A,B3&#41;&#34; &#41;;

$wks-&gt;activate;
$wbk-&gt;close;</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-162109" href="/Public/Bug/Display.html?id=17465#txn-162109">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;03&nbsp;11:01:47&nbsp;2006</span>
    <span class="description">jmcnamara [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-162515" href="/Public/Bug/Display.html?id=17465#txn-162515">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;05&nbsp;12:56:38&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/162515/51235/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/51235">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 520b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 03 10:27:36 2006, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Excel doesn&#39;t seem to calculate the value in 
&gt; $wks-&gt;write&#40; 1, 4, &#34;=COUNTIF&#40;A:A,B3&#41;&#34; &#41;;
</div>
This is a known bug in the formula parser. It will be fixed in a future
release. In the meantime you can work around it using store_formula and
repeat_formula. Like this:

    # Workaround for formula parsing problem.
    my $countif = $wks-&gt;store_formula&#40;&#39;=COUNTIF&#40;A:A,B3&#41;&#39;&#41;;
    $wks-&gt;repeat_formula&#40;1, 5, $countif, undef, &#39;_ref2d&#39; =&gt; &#39;_ref2dV&#39;&#41;;

See the attached file.

John.
-- 
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/162515/51238/exceller2.pl">Download exceller2.pl</a><br />
<span class="downloadcontenttype">text/x-perl 625b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use utf8;
use strict;
use warnings;

use Spreadsheet::WriteExcel;

my $outfile = &#34;exceller.xls&#34;;

my $wbk = Spreadsheet::WriteExcel-&gt;new&#40; $outfile &#41;;
my $wks = $wbk-&gt;add_worksheet&#40; &#39;Test&#39; &#41;;

my $row = 1;
   for&#40;my $i =0; $i &lt; 11; $i++&#41; {
	$wks-&gt;write&#40; $row, 0, $i &#41;;
	$row++;
    }

$wks-&gt;write&#40; 1, 2, &#34;=COUNT&#40;A:A&#41;&#34; &#41;;
$wks-&gt;write&#40; 1, 3, &#34;=COUNTIF&#40;A:A,5&#41;&#34; &#41;;

$wks-&gt;write&#40; 2, 1, &#34;5&#34; &#41;;
$wks-&gt;write&#40; 1, 4, &#34;=COUNTIF&#40;A:A,B3&#41;&#34; &#41;;


# Workaround for formula parsing problem.
my $countif = $wks-&gt;store_formula&#40;&#39;=COUNTIF&#40;A:A,B3&#41;&#39;&#41;;
$wks-&gt;repeat_formula&#40;1, 5, $countif, undef, &#39;_ref2d&#39; =&gt; &#39;_ref2dV&#39;&#41;;


$wks-&gt;activate;
$wbk-&gt;close;</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-162516" href="/Public/Bug/Display.html?id=17465#txn-162516">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;05&nbsp;12:56:40&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318834" href="/Public/Bug/Display.html?id=17465#txn-318834">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;10&nbsp;23:18:02&nbsp;2007</span>
    <span class="description">peca110 [...] yahoo.se - Ticket #27076:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> references in second argument to COUNTIF doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 11 May 2007 05:15:39 +0200 &#40;CEST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-WriteExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Per Calson &lt;peca110 [...] yahoo.se&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/318834/145585/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/145585">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
   
  The COUNTIF Excel function permits references in both the first and second argument. References in the first argument works fine, both I can&#39;t get references in the second argument to work.
   
  Below is a code example that generates an excel file with this content
   
  Hi      =COUNTIF&#40;A:A,&#34;Hi&#34;&#41;
  Hi      =COUNTIF&#40;A:A,B3&#41;
  Hi      Hi
   
  The first formula returns the expected result 3 &#40;there are three &#34;Hi&#34; in column A&#41;, but the second one returns 0. If you instead enter the second formula directly in Excel it returns 3. It&#39;s actually enough to just press F2 to open the cell for editing and then press Return, then the 0 becomes 3.
   
  I use Perl version 5.8.1 and Spreadsheet-WriteExcel version 2.10 &#40;but the fault also exist in 2.18, I tried&#41;.
   
  Here is the code example:
   
  #!/app/perl/5.8.1/bin/perl
use strict;
use Spreadsheet::WriteExcel;
  my $workbook  = Spreadsheet::WriteExcel-&gt;new&#40;&#34;example.xls&#34;&#41;;
my $worksheet = $workbook-&gt;add_worksheet&#40;&#41;;
   
  # Write &#34;Hi&#34; three times in the first column.
$worksheet-&gt;write&#40;0, 0,  &#34;Hi&#34;&#41;;
$worksheet-&gt;write&#40;1, 0,  &#34;Hi&#34;&#41;;
$worksheet-&gt;write&#40;2, 0,  &#34;Hi&#34;&#41;;
   
  # Count the number of &#34;Hi&#34;s in the first column.
# The first formula works and gives the expected result 3.
# The second one returns the incorrect result 0.
$worksheet-&gt;write&#40;0, 1, &#39;=COUNTIF&#40;A:A,&#34;Hi&#34;&#41;&#39;&#41;;
$worksheet-&gt;write&#40;1, 1, &#39;=COUNTIF&#40;A:A,B2&#41;&#39;&#41;;
$worksheet-&gt;write&#40;2, 1,  &#34;Hi&#34;&#41;;

  Best regards, Per Calson

              
---------------------------------
Hitta din nästa resa på Yahoo! Shopping. 
Jämför pris på flygbiljetter och hotellrum: <span class="clickylink"><a target="new" rel="nofollow" href="http://shopping.yahoo.se/b/a/c_169901_resor_biljetter.html">http://shopping.yahoo.se/b/a/c_169901_resor_biljetter.html</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/318834/145586/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/145586">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2.1k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318901" href="/Public/Bug/Display.html?id=17465#txn-318901">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;04:55:28&nbsp;2007</span>
    <span class="description">jmcnamara [...] cpan.org - Ticket #27076:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/318901/145622/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/145622">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 393b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu May 10 23:18:02 2007, peca110@yahoo.se wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt;   The COUNTIF Excel function permits references in both the first and
&gt;    second argument.
</div>
Hi,

This is a known issue but the fix is non-trivial.

There is already a bug open against this with a suggested workaround.

    <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=17465">https://rt.cpan.org/Public/Bug/Display.html?id=17465</a></span>

I will merge this into the other issue.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318903" href="/Public/Bug/Display.html?id=17465#txn-318903">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;04:55:31&nbsp;2007</span>
    <span class="description">The RT System itself - Ticket #27076:  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318917" href="/Public/Bug/Display.html?id=17465#txn-318917">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;05:38:17&nbsp;2007</span>
    <span class="description">jmcnamara [...] cpan.org - Ticket #27076:  Merged into ticket #17465</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318918" href="/Public/Bug/Display.html?id=17465#txn-318918">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;05:38:18&nbsp;2007</span>
    <span class="description">jmcnamara [...] cpan.org -  Merged into ticket #17465</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318919" href="/Public/Bug/Display.html?id=17465#txn-318919">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;05:38:18&nbsp;2007</span>
    <span class="description">jmcnamara [...] cpan.org -  Subject changed from &#39;COUNTIF not calculating value&#39; to &#39;references in second argument to COUNTIF doesn&#39;t work&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1145279" href="/Public/Bug/Display.html?id=17465#txn-1145279">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;21&nbsp;18:51:45&nbsp;2012</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1145279/602372/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/602372">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 75b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Closing this issue. Can&#39;t fix.

Suggest using Excel::Writer::XLSX instead.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1145282" href="/Public/Bug/Display.html?id=17465#txn-1145282">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;21&nbsp;18:51:47&nbsp;2012</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.689451</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
