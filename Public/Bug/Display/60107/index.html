<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #60107 for CGI-Session: directory hashing for CGI::Session::Driver::file &#40;patch included&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #60107 for CGI-Session: directory hashing for CGI::Session::Driver::file &#40;patch included&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CGI-Session">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CGI-Session">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CGI-Session">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CGI-Session">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI-Session">CGI-Session CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">60107</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">stalled</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CGI-Session">CGI-Session</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
OPIATE [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-5872-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
4.42    </td>
  </tr>
  <tr id="CF-5873-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




hashfile.pm<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/813902/421758/hashfile.pm">
Thu Aug 05 11:13:11 2010 (8.8k) by OPIATE [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=60107">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-813902" href="/Public/Bug/Display.html?id=60107#txn-813902">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;05&nbsp;11:13:11&nbsp;2010</span>
    <span class="description">OPIATE [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> directory hashing for CGI::Session::Driver::file &#40;patch included&#41;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/813902/421757/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/421757">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 828b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve got a site that is generating hundreds of thousands of sessions a
day and due to customer requirements, the sessions have a long expiry
value. As a result, having our sessions using the file driver, causes
poor FS performance over time.

I&#39;ll leave discussion of the performance of various file systems to
other forums.

So, I modified the file driver, and created hashfile.pm, attached. It is
based on your original file driver, and implements all the same
functionality, while providing macros like %1, %2, %3, etc to allow for
hashing schemes like /tmp/1/12/123/cgisess_1234567890.

I&#39;ve attached the module; if you find it beneficial, please feel free to
include it in the core distribution.

The only caveat that I can think of is that this module will have
problems if a directory name has % in it followed by digits.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> hashfile.pm</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/813902/421758/hashfile.pm">Download hashfile.pm</a><br />
<span class="downloadcontenttype">text/x-perl 8.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">package CGI::Session::Driver::hashfile;

use strict;

use Carp;
use File::Spec;
use Fcntl qw&#40; :DEFAULT :flock :mode &#41;;
use CGI::Session::Driver;
use vars qw&#40; $FileName $NoFlock $UMask $NO_FOLLOW &#41;;

BEGIN {
    no strict &#39;refs&#39;;
}

@CGI::Session::Driver::hashfile::ISA        = &#40; &#34;CGI::Session::Driver&#34; &#41;;
$CGI::Session::Driver::hashfile::VERSION    = &#34;0.1&#34;;
$FileName                               = &#34;cgisess_%s&#34;;
$NoFlock                                = 0;
$UMask                                  = 0660;
$NO_FOLLOW                              = eval { O_NOFOLLOW } || 0;

sub init {
    my $self = shift;
    $self-&gt;{Directory} ||= File::Spec-&gt;tmpdir&#40;&#41;;

    $self-&gt;{NoFlock} = $NoFlock unless exists $self-&gt;{NoFlock};
    $self-&gt;{UMask} = $UMask unless exists $self-&gt;{UMask};

    return 1;
}

sub _file {
    my &#40;$self,$sid&#41; = @_;

    my $directory = $self-&gt;{Directory};
    $directory =~ s/\%&#40;\d+&#41;/substr&#40;$sid,0,$1&#41;/eg;

    unless &#40; -d $directory &#41; {
        require File::Path;
        unless &#40; File::Path::mkpath&#40;$directory&#41; &#41; {
            return $self-&gt;set_error&#40; &#34;init&#40;&#41;: couldn&#39;t create directory path: $!&#34; &#41;;
        }
    }

    return File::Spec-&gt;catfile&#40;$directory, sprintf&#40; $FileName, $sid &#41;&#41;;
}

sub retrieve {
    my $self = shift;
    my &#40;$sid&#41; = @_;

    my $path = $self-&gt;_file&#40;$sid&#41;;

    return 0 unless -e $path;

    # make certain our filehandle goes away when we fall out of scope
    local *FH;

    if &#40;-l $path&#41; {
        unlink&#40;$path&#41; or
          return $self-&gt;set_error&#40;&#34;retrieve&#40;&#41;: &#39;$path&#39; appears to be a symlink and I couldn&#39;t remove it: $!&#34;&#41;;
        return 0; # we deleted this so we have no hope of getting back anything
    }
    sysopen&#40;FH, $path, O_RDONLY | $NO_FOLLOW &#41; || return $self-&gt;set_error&#40; &#34;retrieve&#40;&#41;: couldn&#39;t open &#39;$path&#39;: $!&#34; &#41;;

    $self-&gt;{NoFlock} || flock&#40;FH, LOCK_SH&#41; or return $self-&gt;set_error&#40; &#34;retrieve&#40;&#41;: couldn&#39;t lock &#39;$path&#39;: $!&#34; &#41;;

    my $rv = &#34;&#34;;
    while &#40; &lt;FH&gt; &#41; {
        $rv .= $_;
    }
    close&#40;FH&#41;;
    return $rv;
}



sub store {
    my $self = shift;
    my &#40;$sid, $datastr&#41; = @_;

    my $path = $self-&gt;_file&#40;$sid&#41;;

    # make certain our filehandle goes away when we fall out of scope
    local *FH;

    my $mode = O_WRONLY|$NO_FOLLOW;

    # kill symlinks when we spot them
    if &#40;-l $path&#41; {
        unlink&#40;$path&#41; or
          return $self-&gt;set_error&#40;&#34;store&#40;&#41;: &#39;$path&#39; appears to be a symlink and I couldn&#39;t remove it: $!&#34;&#41;;
    }

    $mode = O_RDWR|O_CREAT|O_EXCL unless -e $path;

    sysopen&#40;FH, $path, $mode, $self-&gt;{UMask}&#41; or return $self-&gt;set_error&#40; &#34;store&#40;&#41;: couldn&#39;t open &#39;$path&#39;: $!&#34; &#41;;

    # sanity check to make certain we&#39;re still ok
    if &#40;-l $path&#41; {
        return $self-&gt;set_error&#40;&#34;store&#40;&#41;: &#39;$path&#39; is a symlink, check for malicious processes&#34;&#41;;
    }

    # prevent race condition &#40;RT#17949&#41;
    $self-&gt;{NoFlock} || flock&#40;FH, LOCK_EX&#41;  or return $self-&gt;set_error&#40; &#34;store&#40;&#41;: couldn&#39;t lock &#39;$path&#39;: $!&#34; &#41;;
    truncate&#40;FH, 0&#41;  or return $self-&gt;set_error&#40; &#34;store&#40;&#41;: couldn&#39;t truncate &#39;$path&#39;: $!&#34; &#41;;

    print FH $datastr;
    close&#40;FH&#41;               or return $self-&gt;set_error&#40; &#34;store&#40;&#41;: couldn&#39;t close &#39;$path&#39;: $!&#34; &#41;;
    return 1;
}


sub remove {
    my $self = shift;
    my &#40;$sid&#41; = @_;

    my $directory = $self-&gt;{Directory};
    $directory =~ s/\%&#40;\d+&#41;/substr&#40;$sid,0,$1&#41;/eg;

    my $file      = sprintf&#40; $FileName, $sid &#41;;
    my $path      = File::Spec-&gt;catfile&#40;$directory, $file&#41;;
    unlink&#40;$path&#41; or return $self-&gt;set_error&#40; &#34;remove&#40;&#41;: couldn&#39;t unlink &#39;$path&#39;: $!&#34; &#41;;
    return 1;
}


sub traverse {
    # test script used strict; it seemed to override no strict refs in the BEGIN block, so I&#39;m leaving this here
    no strict &#39;refs&#39;;

    my $self = shift;
    my &#40;$coderef, $dir, $dparts&#41; = @_;

    unless &#40; $coderef &#38;&#38; ref&#40;$coderef&#41; &#38;&#38; &#40;ref $coderef eq &#39;CODE&#39;&#41; &#41; {
        croak &#34;traverse&#40;&#41;: usage error&#34;;
    }

    if&#40;$dir&#41;
    {
        if&#40;!$dparts&#41;
        {
            opendir&#40; $$dir, $dir &#41;
                or return $self-&gt;set_error&#40; &#34;traverse&#40;&#41;: couldn&#39;t open $dir, &#34; . $! &#41;;

            my $filename_pattern = $FileName;
            $filename_pattern =~ s/\./\\./g;
            $filename_pattern =~ s/\%s/&#40;\.\+&#41;/g;
            while &#40; my $filename = readdir&#40;$$dir&#41; &#41;
            {
                next if $filename =~ m/^\.\.?$/;
                my $full_path = File::Spec-&gt;catfile&#40;$dir, $filename&#41;;
                my $mode = &#40;stat&#40;$full_path&#41;&#41;[2]
                    or return $self-&gt;set_error&#40; &#34;traverse&#40;&#41;: stat failed for $full_path: &#34; . $! &#41;;
                next if S_ISDIR&#40;$mode&#41;;
                if &#40; $filename =~ /^$filename_pattern$/ &#41;
                {
                    $coderef-&gt;&#40;$1&#41;;
                }
            }

            closedir&#40; $$dir &#41;;
        }
        else
        {
            opendir&#40; $$dparts, $dir &#41;
                or return $self-&gt;set_error&#40; &#34;traverse&#40;&#41;: couldn&#39;t open $dir, &#34; . $! &#41;;

            my $pattern = &#39;&#39;;
            my $next_dparts = &#39;&#39;;
            if&#40;$dparts =~ /^\%&#40;\d+&#41;\/&#40;.+&#41;$/&#41;
            {
                $pattern = &#39;.&#39; x $1;
                $next_dparts = $2;
            }
            elsif&#40;$dparts =~/^\%&#40;\d+&#41;\/?$/&#41;
            {
                $pattern = &#39;.&#39; x $1;
            }

            while &#40; my $filename = readdir&#40;$$dparts&#41; &#41;
            {
                next if $filename =~ m/^\.\.?$/;
                my $full_path = File::Spec-&gt;catfile&#40;$dir, $filename&#41;;
                my $mode = &#40;stat&#40;$full_path&#41;&#41;[2]
                    or return $self-&gt;set_error&#40; &#34;traverse&#40;&#41;: stat failed for $full_path: &#34; . $! &#41;;
                next if !S_ISDIR&#40;$mode&#41;;
                if &#40; $filename =~ /^$pattern$/ &#41;
                {
                    $self-&gt;traverse&#40;$coderef, $full_path, $next_dparts&#41;;
                }
            }

            closedir&#40; $$dparts &#41;;
        }
    }
    else
    {
        if&#40; $self-&gt;{Directory} =~ /\%/ &#41;
        {
            my $d = $self-&gt;{Directory};
            my $d2 = $self-&gt;{Directory};
            $d =~ s/^&#40;.+?&#41;\/\%.+$/$1/;
            $d2 =~ s/^.+?\/&#40;\%.+&#41;$/$1/;

            $self-&gt;traverse&#40;$coderef, $d, $d2&#41;;
        }
        else
        {
            $self-&gt;traverse&#40;$coderef, $self-&gt;{Directory}, &#39;&#39;&#41;;
        }
    }

    return 1;
}


sub DESTROY {
    my $self = shift;
}

1;

__END__;

=pod

=head1 NAME

CGI::Session::Driver::hashfile - CGI::Session driver implementing file storage using hashed directories. Useful for sites with a large number of simultaneous sessions

=head1 SYNOPSIS

    $s = new CGI::Session&#40;&#41;;
    $s = new CGI::Session&#40;&#34;driver:hashfile&#34;, $sid&#41;;
    $s = new CGI::Session&#40;&#34;driver:hashfile&#34;, $sid, {Directory=&gt;&#39;/tmp/%1/%2/%3&#39;}&#41;;


=head1 DESCRIPTION

I&lt;hashfile&gt; - driver will store session data in plain files, where each session will be stored in a separate
file, optionally stored in a hashed directory structure.

Naming conventions of session files are defined by C&lt;$CGI::Session::Driver::file::FileName&gt; global variable.
Default value of this variable is I&lt;cgisess_%s&gt;, where %s will be replaced with respective session ID. Should
you wish to set your own FileName template, do so before requesting for session object:

    $CGI::Session::Driver::file::FileName = &#34;%s.dat&#34;;
    $s = new CGI::Session&#40;&#41;;


=head2 DRIVER ARGUMENTS

If you wish to specify a session directory, use the B&lt;Directory&gt; option, which denotes location of the directory
where session ids are to be kept. If B&lt;Directory&gt; is not set, defaults to whatever File::Spec-&gt;tmpdir&#40;&#41; returns.
So all the three lines in the SYNOPSIS section of this manual produce the same result on a UNIX machine.

If specified B&lt;Directory&gt; does not exist, all necessary directory hierarchy will be created.

Special codes %1 through %nnn are recognized, and replaced with the specified number of digits from the beginning
of the session id. For example:

        $session_id = &#39;972gtf982u30f9&#39;;
        { Directory =&gt; &#39;/tmp/%1/%2/%3&#39; } # yields /tmp/9/97/972/cgisess_972gtf982u30f9
        { Directory =&gt; &#39;/tmp/%1/%3/%5&#39; } # yields /tmp/9/972/972gt/cgisess_972gtf982u30f9

By default, sessions are created with a umask of 0660. If you wish to change the umask for a session, pass
a B&lt;UMask&gt; option with an octal representation of the umask you would like for said session.

=head1 NOTES

If your OS doesn&#39;t support flock, you should understand the risks of going without locking the session files. Since
sessions tend to be used in environments where race conditions may occur due to concurrent access of files by
different processes, locking tends to be seen as a good and very necessary thing. If you still want to use this
driver but don&#39;t want flock, set C&lt;$CGI::Session::Driver::file::NoFlock&gt; to 1 or pass C&lt;&lt; NoFlock =&gt; 1 &gt;&gt; and this
driver will operate without locks.

=head1 LICENSING

For support and licensing see L&lt;CGI::Session|CGI::Session&gt;

=cut
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-814984" href="/Public/Bug/Display.html?id=60107#txn-814984">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;09&nbsp;10:39:17&nbsp;2010</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/814984/422319/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/422319">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 209b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Shane,

Thanks for this contribution. My previous is for you to upload this 
module to CPAN as independent distribution. That will give you more 
control over it, and spread out the maintenance load. 

   Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-814987" href="/Public/Bug/Display.html?id=60107#txn-814987">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;09&nbsp;10:39:18&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-814988" href="/Public/Bug/Display.html?id=60107#txn-814988">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;09&nbsp;10:39:19&nbsp;2010</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.329846</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
