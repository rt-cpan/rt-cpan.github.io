<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #71600 for Moose: error reported at the wrong place in 2.0205</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #71600 for Moose: error reported at the wrong place in 2.0205</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Moose/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Moose/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Moose/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Moose/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Moose">Moose CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">71600</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Moose/Active/">Moose</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mjd [...] plover.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38786-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38787-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;11&nbsp;13:27:32&nbsp;2011</span>
    <span class="description">mjd [...] plover.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> error reported at the wrong place in 2.0205</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 11 Oct 2011 13:27:21 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-moose [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Jason Dominus &lt;mjd [...] plover.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Consider this module:

        package Foo;
        use Moose;
        warn &#34;Moose version: &#34;, Moose-&gt;VERSION&#40;&#41;, &#34;\n&#34;;

        has attribute =&gt; &#40;
            lazy =&gt; 1,
        &#41;;

It produces the following output:

---- BEGIN ENCLOSURE
Moose version: 2.0205
You cannot have a lazy attribute &#40;attribute&#41; without specifying a default value for it at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Attribute.pm line 472
        Moose::Meta::Attribute::_process_lazy_option&#40;&#39;Moose::Meta::Attribute&#39;, &#39;attribute&#39;, &#39;HASH&#40;0x9f71720&#41;&#39;&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Attribute.pm line 302
        Moose::Meta::Attribute::_process_options&#40;&#39;Moose::Meta::Attribute&#39;, &#39;attribute&#39;, &#39;HASH&#40;0x9f71720&#41;&#39;&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Attribute.pm line 88
        Moose::Meta::Attribute::new&#40;&#39;Moose::Meta::Attribute&#39;, &#39;attribute&#39;, &#39;definition_context&#39;, &#39;HASH&#40;0x9e6e178&#41;&#39;, &#39;lazy&#39;, 1&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Attribute.pm line 114
        Moose::Meta::Attribute::interpolate_class_and_new&#40;&#39;Moose::Meta::Attribute&#39;, &#39;attribute&#39;, &#39;definition_context&#39;, &#39;HASH&#40;0x9e6e178&#41;&#39;, &#39;lazy&#39;, 1&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Class.pm line 704
        Moose::Meta::Class::_process_new_attribute&#40;&#39;Moose::Meta::Class=HASH&#40;0xa0e2280&#41;&#39;, &#39;attribute&#39;, &#39;definition_context&#39;, &#39;HASH&#40;0x9e6e178&#41;&#39;, &#39;lazy&#39;, 1&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Class.pm line 697
        Moose::Meta::Class::_process_attribute&#40;&#39;Moose::Meta::Class=HASH&#40;0xa0e2280&#41;&#39;, &#39;attribute&#39;, &#39;definition_context&#39;, &#39;HASH&#40;0x9e6e178&#41;&#39;, &#39;lazy&#39;, 1&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Class.pm line 566
        Moose::Meta::Class::add_attribute&#40;&#39;Moose::Meta::Class=HASH&#40;0xa0e2280&#41;&#39;, &#39;attribute&#39;, &#39;definition_context&#39;, &#39;HASH&#40;0x9e6e178&#41;&#39;, &#39;lazy&#39;, 1&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose.pm line 77
        Moose::has&#40;&#39;Moose::Meta::Class=HASH&#40;0xa0e2280&#41;&#39;, &#39;attribute&#39;, &#39;lazy&#39;, 1&#41; called at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Exporter.pm line 356
        Moose::has&#40;&#39;attribute&#39;, &#39;lazy&#39;, 1&#41; called at /tmp/bug line 5
---- BEGIN ENCLOSURE

Reporting the error at Moose/Meta/Attribute.pm line 472 is unhelpful.
It should be reported at line 5 &#40;or 6&#41; of /tmp/bug, where it actually
occurs.


Mark Jason Dominus                                               mjd@plover.com
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;11&nbsp;13:54:49&nbsp;2011</span>
    <span class="description">doy [...] tozt.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #71600] error reported at the wrong place in 2.0205</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 11 Oct 2011 12:54:40 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Mark-Jason Dominus via RT &lt;bug-Moose [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jesse Luehrs &lt;doy [...] tozt.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Oct 11, 2011 at 01:27:34PM -0400, Mark-Jason Dominus via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It produces the following output:
&gt; 
&gt; ---- BEGIN ENCLOSURE
&gt; Moose version: 2.0205
&gt; You cannot have a lazy attribute &#40;attribute&#41; without specifying a default value for it at /home/mjd/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/i686-linux/Moose/Meta/Attribute.pm line 472
&gt; [...]
&gt;       Moose::has&#40;&#39;attribute&#39;, &#39;lazy&#39;, 1&#41; called at /tmp/bug line 5
&gt; ---- BEGIN ENCLOSURE
&gt; 
&gt; Reporting the error at Moose/Meta/Attribute.pm line 472 is unhelpful.
&gt; It should be reported at line 5 &#40;or 6&#41; of /tmp/bug, where it actually
&gt; occurs.
</div>
It does at least include that information &#40;and this is why our general
policy is to use confess everywhere by default&#41;. This is not likely to
actually be fixed at least until our error system is entirely rewritten.

-doy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;11&nbsp;13:54:50&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;11&nbsp;14:25:30&nbsp;2011</span>
    <span class="description">mjd [...] plover.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #71600] error reported at the wrong place in 2.0205</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 11 Oct 2011 14:25:06 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Moose [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Jason Dominus &lt;mjd [...] plover.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It does at least include that information &#40;and this is why our general
&gt; policy is to use confess everywhere by default&#41;.
</div>
Sure.  But the policy is just a a hack around the fact that the errors
are being reported for the wrong place.  In more complex programs, the
actual cause of the error is buried in the the middle of the stack
trace.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is not likely to
&gt; actually be fixed at least until our error system is entirely rewritten.
</div>
I had hoped someone might be keeping a file of these types of problems
against the day when your error system is entirely rewritten.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;07&nbsp;22:01:17&nbsp;2013</span>
    <span class="description">cpan [...] prather.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 11 14:25:30 2011, mjd@plover.com wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I had hoped someone might be keeping a file of these types of problems
&gt; against the day when your error system is entirely rewritten.
</div>
That somebody is apparently RT, and the list isn&#39;t really long enough. However marking this 
stalled since in theory there is a branch to re-write the entire error system based on Sartak&#39;s 
promises from YAPC 2012 in Madison.

&#40;Marked stalled until that branch is merged&#41;

-Chris
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;07&nbsp;22:01:18&nbsp;2013</span>
    <span class="description">cpan [...] prather.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;11&nbsp;13:37:05&nbsp;2016</span>
    <span class="description">DROLSKY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Error reported at the wrong place in 2.0205</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is much better in newer Moose:

    Moose version: 2.1805
    You cannot have a lazy attribute &#40;attribute&#41; without specifying a default value for it at /home/autarch/.perlbrew/libs/perl-5.24.0@dev/lib/perl5/x86_64-linux/Moose/Exporter.pm line 419
        Moose::has&#40;&#39;attribute&#39;, &#39;lazy&#39;, 1&#41; called at foo line 5

Removing the reference to Moose::Exporter seems to be a bit tricky with Devel::StackTrace, since we end up with an error message like this:

    You cannot have a lazy attribute &#40;attribute&#41; without specifying a default value for it at foo line 5

This doesn&#39;t even tell you that there was a call to &#34;Moose::has&#34;, which seems worse than the alternative.

I think the only way to fix this would be to remove Devel::StackTrace from Moose::Exception entirely and find a different way to format the stack trace. That&#39;s not necessary a terrible idea.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;11&nbsp;13:37:06&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
