<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #95923 for JSON-Schema: keyword &#34;required&#34; not used like documented</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #95923 for JSON-Schema: keyword &#34;required&#34; not used like documented</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/JSON-Schema/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/JSON-Schema/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/JSON-Schema/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/JSON-Schema/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/JSON-Schema">JSON-Schema CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">95923</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/JSON-Schema/Active/">JSON-Schema</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
NJFRANCK [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-240524-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-240525-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;24&nbsp;09:35:11&nbsp;2014</span>
    <span class="description">NJFRANCK [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> keyword &#34;required&#34; not used like documented</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">According to the latest specification of JSON-Schema,
one can require the existance of some keys like this:

{
        &#34;title&#34;: &#34;Example Schema&#34;,
        &#34;type&#34;: &#34;object&#34;,
        &#34;properties&#34;: {
                &#34;firstName&#34;: {
                        &#34;type&#34;: &#34;string&#34;
                },
                &#34;lastName&#34;: {
                        &#34;type&#34;: &#34;string&#34;
                },
                &#34;age&#34;: {
                        &#34;description&#34;: &#34;Age in years&#34;,
                        &#34;type&#34;: &#34;integer&#34;,
                        &#34;minimum&#34;: 0
                }
        },
        &#34;required&#34;: [&#34;firstName&#34;, &#34;lastName&#34;]
}


But this &#34;required&#34; is not supported in your module in this way.
Your module does it like this:

..
&#34;lastName&#34;: {
   &#34;type&#34;: &#34;string&#34;,
   &#34;required&#34;: 1
}
..

Cf. <span class="clickylink"><a target="new" rel="nofollow" href="http://json-schema.org/examples.html">http://json-schema.org/examples.html</a></span>

Are you using an older version of the specification?
Doesn&#39;t matter if it is older. But I just need to
know what version is supported, so I can document
it.

Thanks in advance
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;01&nbsp;05:26:09&nbsp;2014</span>
    <span class="description">RUZ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I wrote a simple patch to enable support of &#34;required&#34; keyword. I&#39;m not sure completely if it&#39;s correct in all situations, but this is a start.

Can you tell what should I do to get it merged? Do you see any problems?

-- 
Best regards, Ruslan.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> JSON-Schema-0.015-per-spec-required-check.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Only in JSON-Schema-0.015/: MYMETA.json
Only in JSON-Schema-0.015/: MYMETA.yml
Only in JSON-Schema-0.015/: Makefile
Only in JSON-Schema-0.015/: blib
diff -ur JSON-Schema-0.015/lib/JSON/Schema/Helper.pm JSON-Schema-0.015-my/lib/JSON/Schema/Helper.pm
--- JSON-Schema-0.015/lib/JSON/Schema/Helper.pm	2014-07-30 20:01:29.000000000 +0400
+++ JSON-Schema-0.015-my/lib/JSON/Schema/Helper.pm	2012-12-14 12:09:05.000000000 +0400
@@ -276,11 +276,6 @@
 			{
 				push @{$self-&gt;{errors}}, $self-&gt;checkObj&#40;$value, $path, $schema-&gt;{&#39;properties&#39;}, $schema-&gt;{&#39;additionalProperties&#39;}, $schema-&gt;{&#39;patternProperties&#39;}, $_changing&#41;;
 			}
-
-			if &#40; defined $schema-&gt;{&#39;required&#39;} &#38;&#38; ref $value eq &#39;HASH&#39; &#41; {
-				$addError-&gt;&#40;&#34;does not have required property &#39;$_&#39;&#34;&#41;
-					foreach grep !exists $value-&gt;{$_}, @{$schema-&gt;{&#39;required&#39;}}
-			}
 			
 			if &#40;$schema-&gt;{&#39;pattern&#39;} and $self-&gt;jsMatchType&#40;&#39;string&#39;, $value&#41;&#41;
 			{
Only in JSON-Schema-0.015/: pm_to_blib
diff -ur JSON-Schema-0.015/t/03required.t JSON-Schema-0.015-my/t/03required.t
--- JSON-Schema-0.015/t/03required.t	2014-07-30 20:04:47.000000000 +0400
+++ JSON-Schema-0.015-my/t/03required.t	2012-12-14 12:06:49.000000000 +0400
@@ -41,11 +41,6 @@
 	 additionalProperties =&gt; {},
 }&#41;;
 
-my $schema5 = JSON::Schema-&gt;new&#40;{
-    type =&gt; &#39;object&#39;,
-    required =&gt; [&#39;mynumber&#39;],
-}&#41;;
-
 my $data1 = { mynumber =&gt; 1 };
 my $data2 = { mynumbre =&gt; 1 };
 
@@ -81,13 +76,5 @@
 ok !$result, &#39;H&#39;
   or map { diag &#34;reason: $_&#34; } $result-&gt;errors;
 
-$result = $schema5-&gt;validate&#40;$data1&#41;;
-ok $result, &#39;H&#39;
-  or map { diag &#34;reason: $_&#34; } $result-&gt;errors;
-
-$result = $schema5-&gt;validate&#40;$data2&#41;;
-ok !$result, &#39;H&#39;
-  or map { diag &#34;reason: $_&#34; } $result-&gt;errors;
-
 done_testing;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;01&nbsp;05:26:10&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;11&nbsp;09:20:03&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">JSON::Schema supports an older version of the spec, circa 2012.

Given how much the spec has changed over time, I&#39;m not willing to play catch-up. Instead I want to wait until the JSON Schema people give some kind of indication that the spec is stable. Ideally, by finally publishing it as an IETF RFC.

Once that happens, I&#39;ll rewrite JSON::Schema from scratch &#40;but retain the current API for compatibility&#41;.

In the mean time, I&#39;m happy for somebody else to have co-maint of JSON::Schema for small updates like this, provided they agree to the overall plan that the current implementation will eventually be scrapped.

If anybody wants to volunteer, let me know. Until then, I am marking this issue as stalled.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;11&nbsp;09:20:04&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;19&nbsp;08:07:56&nbsp;2015</span>
    <span class="description">RUZ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Sep 11 09:20:03 2014, TOBYINK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If anybody wants to volunteer, let me know. Until then, I am marking
&gt; this issue as stalled.
</div>
I&#39;m willing to volunteer &#40;CPANID: RUZ&#41; as otherwise my team will probably fork this module.

-- 
Best regards, Ruslan.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;19&nbsp;08:07:56&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
