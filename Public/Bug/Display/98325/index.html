<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #98325 for SOAP-Lite: Value of root element in SOAP Body ignored</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #98325 for SOAP-Lite: Value of root element in SOAP Body ignored</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/SOAP-Lite/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/SOAP-Lite/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/SOAP-Lite/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/SOAP-Lite/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/SOAP-Lite">SOAP-Lite CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">98325</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/SOAP-Lite/Active/">SOAP-Lite</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
oliver.lightfoot [...] retaildata.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29122-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29123-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;26&nbsp;08:59:39&nbsp;2014</span>
    <span class="description">oliver.lightfoot [...] retaildata.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Value of root element in SOAP Body ignored</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Aug 2014 14:01:58 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-SOAP-Lite [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Oliver Lightfoot &lt;oliver.lightfoot [...] retaildata.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have found a bug in SOAP::Lite.

SOAP::Lite version: 1.11.
perl version: 5.10.
OS: Debian Linux v6.0 &#40;Squeeze&#41;

The bug occurs when you set a value for the root element in SOAP Body 
and do not have any child elements. Rather than using the value set on 
the root SOAP::Data object it sets the value to undef which results in 
the root element having the xsi:nil=&#34;true&#34; attribute set.

The following code replicates this bug:

my $client = SOAP::Lite
-&gt;proxy&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost:8080">http://localhost:8080</a></span>&#39;, timeout =&gt; 360&#41;
-&gt;on_action&#40;sub {return &#34;&#34;}&#41;;

my $body = 
SOAP::Data-&gt;name&#40;&#34;ns1:SendData&#34;&#41;-&gt;value&#40;&#39;SomeTestData11212&#39;&#41;-&gt;type&#40;&#34;&#34;&#41;;

$client-&gt;call&#40;$body&#41;;

This results in the following XML:

&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;SOAP-ENV:Envelope 
SOAP-ENV:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:SOAP-ENC=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:SOAP-ENV=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34; 
xmlns:ns1=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.foo.com/bar/">http://www.foo.com/bar/</a></span>&#34; 
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; 
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;
&lt;SOAP-ENV:Body&gt;
&lt;ns1:SendData xsi:nil=&#34;true&#34; /&gt;
&lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;

As you can see the SendDate tag has been serialized as nil, however I 
propose it should actually be:

&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;SOAP-ENV:Envelope 
SOAP-ENV:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:SOAP-ENC=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:SOAP-ENV=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34; 
xmlns:ns1=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.foo.com/bar/">http://www.foo.com/bar/</a></span>&#34; 
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; 
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;
&lt;SOAP-ENV:Body&gt;
&lt;ns1:SendData&gt;SomeTestData11212&lt;/ns1:SendData&gt;
&lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;

Now the SendData tag has been serialized with the value set in the code 
example. I have tried to find out if this is considered valid SOAP XML 
and can fined nothing to suggest it is, so it seems to me that this is a 
valid expectation? I am working with a 3rd party SOAP server and this is 
certainly what they expect.

I have found the code responsible for this behaviour in Lite.pm, line 
1640, a copy is below:

$body-&gt;set_value&#40;$parameters ? \$parameters : 
SOAP::Utils::encode_data&#40;&#41;&#41; if $body;

The problem with this code is it will always overwrite the body value, 
ideally the code should check for a body value and use this but only if 
there are no other parameters, which obvously would be embedded as child 
elements and thus replace any root value?

In order to change the behaviour so it will not ignore the root element 
value I change the code to:

if &#40;$body &#38;&#38; !defined&#40;$body-&gt;value&#40;&#41;&#41; || defined&#40;$parameters&#41;&#41; {
     $body-&gt;set_value&#40;$parameters ? \$parameters : 
SOAP::Utils::encode_data&#40;&#41;&#41;;
}

I hope that you seriously consider adopting this change, it seems like a 
valid use case, however I am sure you are much better placed to decide 
this. If you could let me know your decision one way or another that 
would be greatly appreciated.

Thank you for your time.

Best regards,

-- 
Oliver Lightfoot
Senior Developer
The Retail Data Partnership Ltd
Brewery House
4 Scotgate
Stamford PE9 2YB
Telephone 01780 480562
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;26&nbsp;22:17:52&nbsp;2014</span>
    <span class="description">PHRED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Can you please try the following test? I was not able to reproduce your problem with this on my local system.

fredmoyer@aiko ~/dev/soaplite $ prove -lv t/41-RT_98325.t
t/41-RT_98325.t ..
1..1
$VAR1 = &#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;ns1:SendData xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34; xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;SomeTestData11212&lt;/ns1:SendData&gt;&#39;;
ok 1
ok
All tests successful.
Files=1, Tests=1,  0 wallclock secs &#40; 0.02 usr  0.01 sys +  0.08 cusr  0.01 csys =  0.12 CPU&#41;
Result: PASS


fredmoyer@aiko ~/dev/soaplite $ cat t/41-RT_98325.t
use strict;
use warnings;
use Test::More;
use SOAP::Lite;
use Data::Dumper;

plan tests =&gt; 1;

my $client = SOAP::Lite
    -&gt;proxy&#40; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost:8080">http://localhost:8080</a></span>&#39;, timeout =&gt; 360 &#41;
    -&gt;on_action&#40; sub { return &#34;&#34; } &#41;;

my $body =
    SOAP::Data-&gt;name&#40; &#34;ns1:SendData&#34; &#41;-&gt;value&#40; &#39;SomeTestData11212&#39; &#41;-&gt;type&#40; &#34;&#34; &#41;;

my $serialized = SOAP::Serializer-&gt;serialize&#40; $body &#41;;
use Data::Dumper;
warn&#40;Dumper&#40;$serialized&#41;&#41;;
unlike&#40;$serialized, qr/nil/&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;26&nbsp;22:17:52&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;27&nbsp;05:07:01&nbsp;2014</span>
    <span class="description">oliver.lightfoot [...] retaildata.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #98325] Value of root element in SOAP Body ignored</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Aug 2014 10:09:27 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-SOAP-Lite [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Oliver Lightfoot &lt;oliver.lightfoot [...] retaildata.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for your response.

I have run your test and it passes, however I believe that the bug is 
not covered by your test because the bug is not in the serializer code 
but in the envelope code which gets called by the &#39;call&#39; method. I have 
expanded your test script to show this, the second test fails on my system:

prove -lv soaplitetest.t
soaplitetest.t ..
1..2
$VAR1 = &#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;ns1:SendData 
xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34; 
xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; 
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;SomeTestData11212&lt;/ns1:SendData&gt;&#39;;
ok 1
$VAR1 = &#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;soap:Envelope 
soap:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:ns1=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.foo.com/bar/">http://www.foo.com/bar/</a></span>&#34; 
xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34; 
xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; 
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;&lt;soap:Body&gt;&lt;ns1:SendData 
xsi:nil=&#34;true&#34; /&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;&#39;;
not ok 2

#   Failed test at soaplitetest.t line 28.
#                   &#39;&lt;?xml version=&#34;1.0&#34; 
encoding=&#34;UTF-8&#34;?&gt;&lt;soap:Envelope 
soap:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:ns1=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.foo.com/bar/">http://www.foo.com/bar/</a></span>&#34; 
xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34; 
xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; 
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; 
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;&lt;soap:Body&gt;&lt;ns1:SendData 
xsi:nil=&#34;true&#34; /&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;&#39;
#           matches &#39;&#40;?-xism:nil&#41;&#39;
# Looks like you failed 1 test of 2.
Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
Failed 1/2 subtests

Test Summary Report
-------------------
soaplitetest.t &#40;Wstat: 256 Tests: 2 Failed: 1&#41;
   Failed test:  2
   Non-zero exit status: 1
Files=1, Tests=2,  1 wallclock secs &#40; 0.08 usr  0.02 sys +  0.54 cusr  
0.06 csys =  0.70 CPU&#41;
Result: FAIL

The amended test script is below:

use strict;
use warnings;
use Test::More;
use SOAP::Lite;
use Data::Dumper;

plan tests =&gt; 2;

my $client = SOAP::Lite
     -&gt;proxy&#40; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost:8080">http://localhost:8080</a></span>&#39;, timeout =&gt; 360 &#41;
     -&gt;on_action&#40; sub { return &#34;&#34; } &#41;;

my $body =
     SOAP::Data-&gt;name&#40; &#34;ns1:SendData&#34; &#41;-&gt;value&#40; &#39;SomeTestData11212&#39; 
&#41;-&gt;type&#40; &#34;&#34; &#41;;

my $serialized = SOAP::Serializer-&gt;serialize&#40; $body &#41;;
use Data::Dumper;
warn&#40;Dumper&#40;$serialized&#41;&#41;;
unlike&#40;$serialized, qr/nil/&#41;;

# Set namespace because call&#40;&#41; complains otherwise
$client-&gt;ns&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.foo.com/bar/&#39;">http://www.foo.com/bar/&#39;</a></span>, &#34;ns1&#34;&#41;;

my $response = $client-&gt;call&#40; $body &#41;;
my $request_content = 
$response-&gt;{_context}-&gt;{_transport}-&gt;{_proxy}-&gt;{_http_response}-&gt;{_request}-&gt;{_content};

use Data::Dumper;
warn&#40;Dumper&#40;$request_content&#41;&#41;;
unlike&#40;$request_content, qr/nil/&#41;;


On 27/08/2014 03:17, via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=98325">https://rt.cpan.org/Ticket/Display.html?id=98325</a></span> &gt;
&gt;
&gt; Can you please try the following test? I was not able to reproduce your problem with this on my local system.
&gt;
&gt; fredmoyer@aiko ~/dev/soaplite $ prove -lv t/41-RT_98325.t
&gt; t/41-RT_98325.t ..
&gt; 1..1
&gt; $VAR1 = &#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;ns1:SendData xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34; xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34; xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;SomeTestData11212&lt;/ns1:SendData&gt;&#39;;
&gt; ok 1
&gt; ok
&gt; All tests successful.
&gt; Files=1, Tests=1,  0 wallclock secs &#40; 0.02 usr  0.01 sys +  0.08 cusr  0.01 csys =  0.12 CPU&#41;
&gt; Result: PASS
&gt;
&gt;
&gt; fredmoyer@aiko ~/dev/soaplite $ cat t/41-RT_98325.t
&gt; use strict;
&gt; use warnings;
&gt; use Test::More;
&gt; use SOAP::Lite;
&gt; use Data::Dumper;
&gt;
&gt; plan tests =&gt; 1;
&gt;
&gt; my $client = SOAP::Lite
&gt;      -&gt;proxy&#40; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost:8080">http://localhost:8080</a></span>&#39;, timeout =&gt; 360 &#41;
&gt;      -&gt;on_action&#40; sub { return &#34;&#34; } &#41;;
&gt;
&gt; my $body =
&gt;      SOAP::Data-&gt;name&#40; &#34;ns1:SendData&#34; &#41;-&gt;value&#40; &#39;SomeTestData11212&#39; &#41;-&gt;type&#40; &#34;&#34; &#41;;
&gt;
&gt; my $serialized = SOAP::Serializer-&gt;serialize&#40; $body &#41;;
&gt; use Data::Dumper;
&gt; warn&#40;Dumper&#40;$serialized&#41;&#41;;
&gt; unlike&#40;$serialized, qr/nil/&#41;;
</div>
-- 
Oliver Lightfoot
Senior Developer
The Retail Data Partnership Ltd
Brewery House
4 Scotgate
Stamford PE9 2YB
Telephone 01780 480562
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
