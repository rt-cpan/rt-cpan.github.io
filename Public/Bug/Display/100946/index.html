<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #100946 for Finance-Bank-Bankwest: transaction search dates not being honoured</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #100946 for Finance-Bank-Bankwest: transaction search dates not being honoured</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Finance-Bank-Bankwest/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Finance-Bank-Bankwest/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Finance-Bank-Bankwest/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Finance-Bank-Bankwest/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Finance-Bank-Bankwest">Finance-Bank-Bankwest CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p>This distribution provides the ability to log into Bankwest's Online Banking service using a Personal Access Number (PAN) and access code, then retrieve information on all accounts associated with that PAN and their transactions.</p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">100946</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Finance-Bank-Bankwest/Active/">Finance-Bank-Bankwest</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">lxp [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
owenhollands [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-249584-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.2.8    </td>
  </tr>
  <tr id="CF-249585-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;07:00:06&nbsp;2014</span>
    <span class="description">lxp [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> transaction search dates not being honoured</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Dec 16 11:12:01 2014, owenhollands@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi, I was wondering if you had experienced an issue where queries return
&gt; the last 7 days of transactions, regardless of the dates specified?
&gt; 
&gt; I haven&#39;t had a chance to look into it myself, so I don&#39;t know if the issue
&gt; is in your code or mine.  I thought I would ask in case you were already
&gt; looking at it.
&gt; 
&gt; Owen.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;07:01:25&nbsp;2014</span>
    <span class="description">lxp [...] cpan.org -  Requestor owenhollands@gmail.com added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;07:02:10&nbsp;2014</span>
    <span class="description">lxp [...] cpan.org -  Reference by ticket #93739 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;07:07:32&nbsp;2014</span>
    <span class="description">lxp [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Owen,

On Tue Dec 16 11:12:01 2014, owenhollands@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I was wondering if you had experienced an issue where queries return
&gt; the last 7 days of transactions, regardless of the dates specified?
</div>
Thanks for letting me know about this.  Bankwest&#39;s Transaction Search
form parameters have changed, so an update to Finance::Bank::Bankwest is
needed.  I&#39;ll release a fix shortly.

-- 
Kind regards,
Alex Peters
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;07:07:32&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;08:11:34&nbsp;2014</span>
    <span class="description">lxp [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Owen,

On Tue Dec 16 23:07:32 2014, LXP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Bankwest&#39;s Transaction Search form parameters have changed, so an
&gt; update to Finance::Bank::Bankwest is needed.  I&#39;ll release a fix
&gt; shortly.
</div>
I&#39;ve identified the necessary fix, but I don&#39;t want to release until
I&#39;ve updated the unit tests &#40;which will require me downloading a bunch
of new HTML from Bankwest&#41;.

In the meantime, if you&#39;d like a fix urgently, the attached patch
&#40;prepared against the source on GitHub&#41; shows how to manually modify Finance/Bank/Bankwest/Session.pm for correct operation.

I&#39;ll let you know when the fix has been properly released.

-- 
Kind regards,
Alex Peters
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Session-fix.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff --git a/lib/Finance/Bank/Bankwest/Session.pm b/lib/Finance/Bank/Bankwest/Session.pm
index 12b66e0..53d8df1 100644
--- a/lib/Finance/Bank/Bankwest/Session.pm
+++ b/lib/Finance/Bank/Bankwest/Session.pm
@@ -224,6 +224,8 @@ date of the following Monday.
                     =&gt; &#39;3~4~5~6~7&#39;,
                 &#39;_ctl0:ContentMain:ddlAccount&#39;
                     =&gt; $account,
+                &#39;_ctl0:ContentMain:ddlRangeOptions&#39;
+                    =&gt; &#39;CUSTOM&#39;,
                 &#39;_ctl0:ContentMain:dpFromDate:txtDate&#39;
                     =&gt; $from_date,
                 &#39;_ctl0:ContentMain:dpToDate:txtDate&#39;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;20:13:44&nbsp;2014</span>
    <span class="description">owenhollands [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100946] transaction search dates not being honoured</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 18 Dec 2014 12:13:33 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Finance-Bank-Bankwest [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Owen Hollands &lt;owenhollands [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">That seems to be working - thanks.  You saved my a bunch of time trying to
fix that.

As an asside, do you think there is value in a check script that compares
the HTML off the bankwest website with a reference copy to try and detect
of the website ahs been updated?

  Owen.

On Thu, Dec 18, 2014 at 12:11 AM, Alex Peters via RT &lt;
bug-Finance-Bank-Bankwest@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100946">https://rt.cpan.org/Ticket/Display.html?id=100946</a></span> &gt;
&gt;
&gt; Hi Owen,
&gt;
&gt; On Tue Dec 16 23:07:32 2014, LXP wrote:
<div class="message-stanza open">&gt; &gt; Bankwest&#39;s Transaction Search form parameters have changed, so an
&gt; &gt; update to Finance::Bank::Bankwest is needed.  I&#39;ll release a fix
&gt; &gt; shortly.
</div>&gt;
&gt; I&#39;ve identified the necessary fix, but I don&#39;t want to release until
&gt; I&#39;ve updated the unit tests &#40;which will require me downloading a bunch
&gt; of new HTML from Bankwest&#41;.
&gt;
&gt; In the meantime, if you&#39;d like a fix urgently, the attached patch
&gt; &#40;prepared against the source on GitHub&#41; shows how to manually modify
&gt; Finance/Bank/Bankwest/Session.pm for correct operation.
&gt;
&gt; I&#39;ll let you know when the fix has been properly released.
&gt;
&gt; --
&gt; Kind regards,
&gt; Alex Peters
&gt;
&gt; diff --git a/lib/Finance/Bank/Bankwest/Session.pm
&gt; b/lib/Finance/Bank/Bankwest/Session.pm
&gt; index 12b66e0..53d8df1 100644
&gt; --- a/lib/Finance/Bank/Bankwest/Session.pm
&gt; +++ b/lib/Finance/Bank/Bankwest/Session.pm
&gt; @@ -224,6 +224,8 @@ date of the following Monday.
&gt;                      =&gt; &#39;3~4~5~6~7&#39;,
&gt;                  &#39;_ctl0:ContentMain:ddlAccount&#39;
&gt;                      =&gt; $account,
&gt; +                &#39;_ctl0:ContentMain:ddlRangeOptions&#39;
&gt; +                    =&gt; &#39;CUSTOM&#39;,
&gt;                  &#39;_ctl0:ContentMain:dpFromDate:txtDate&#39;
&gt;                      =&gt; $from_date,
&gt;                  &#39;_ctl0:ContentMain:dpToDate:txtDate&#39;
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;05:54:42&nbsp;2014</span>
    <span class="description">lxp [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Owen,

On Thu Dec 18 12:13:44 2014, owenhollands@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As an asside, do you think there is value in a check script that
&gt; compares the HTML off the bankwest website with a reference copy to
&gt; try and detect of the website ahs been updated?
</div>
I suppose it would be a bit complicated to directly compare live website
data to a reference copy, because of the varying tokens, account info,
etc. found on every page.

On that basis, I would probably go about this by scripting a bunch of
actions on the Bankwest website, passing the resultant HTML to the
Finance::Bank::Bankwest::Parser modules, and then testing that they
don&#39;t reject the HTML.

That alone, though, probably wouldn&#39;t achieve anything more than just
regularly using the Finance::Bank::Bankwest distribution normally.

I&#39;ve tried to code those parser modules with enough expectations that
they fail quite verbosely if Bankwest significantly alters the
construction of its responses, but with enough leniency that minor
design changes would allow the code to continue to work.  It seems to be
a difficult balance to get right.

The parsers continued to work in this case because the change Bankwest
made was extremely subtle: take a &lt;select&gt; box which was previously
optional, add a new &lt;option&gt; and require that &lt;option&gt; to be selected
for the date fields not to be ignored.  As far as the relevant parser
was concerned, it was exactly the same page.

In short, I&#39;m not against the idea of some sort of check script, but I&#39;m
struggling to picture how a useful one would operate and whether it
would really result in fewer breakages.  I&#39;m definitely open to further
discussion and insight on the matter though.  Thanks for the idea; I&#39;ll
keep thinking on it.

-- 
Kind regards,
Alex Peters
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
