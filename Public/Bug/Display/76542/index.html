<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76542 for POE: Use of uninitialized value $fd in exists at /usr/share/perl5/POE/Resource/FileHandles.pm line 577</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76542 for POE: Use of uninitialized value $fd in exists at /usr/share/perl5/POE/Resource/FileHandles.pm line 577</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=POE">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=POE">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=POE">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=POE">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/POE">POE CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76542</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=POE">POE</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
fschlich [...] zedat.fu-berlin.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Unimportant    </td>
  </tr>
  <tr id="CF-26342-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.352    </td>
  </tr>
  <tr id="CF-26343-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=76542">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1067396" href="/Public/Bug/Display.html?id=76542#txn-1067396">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;13&nbsp;15:52:26&nbsp;2012</span>
    <span class="description">fschlich [...] zedat.fu-berlin.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Use of uninitialized value $fd in exists at /usr/share/perl5/POE/Resource/FileHandles.pm
 line 577</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1067396/561206/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/561206">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 796b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

when running the test suite for poe-component-client-http, I get two 
warnings:

perl -w t/59_incomplete_b.t
1..4
ok 1 - got expected content-length request
ok 2 - got expected no-content-length request
Use of uninitialized value $fd in exists at 
/usr/share/perl5/POE/Resource/FileHandles.pm line 577.
Use of uninitialized value $fd in exists at 
/usr/share/perl5/POE/Resource/FileHandles.pm line 577.
ok 3 - length&#40;content&#41; triggered 406
ok 4 - content-length triggered 406

Looking at FileHandles.pm, I notice that _data_handle_remove&#40;&#41; makes 
sure  that $fd is defined when deregistering the handle with the kernel, 
but doesn&#39;t take similar precautions afterwards when removing the select 
from the session.

Add a check there or short-circuit the entire sub when $fd is undef?

Florian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1072710" href="/Public/Bug/Display.html?id=76542#txn-1072710">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;29&nbsp;18:30:58&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1072710/564359/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564359">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, Florian.

Can you reproduce the error at will?  POE&#39;s APIs have a lot of error checking at the surface &#40;in 
POE::Kernel&#41;, but they&#39;re disabled by default for speed.  If you set the POE_ASSERT_USAGE 
environment variable, they&#39;ll all be enabled at compile time.  If that doesn&#39;t give you a better 
failure message, I&#39;ll eat my hat.  Or fix a bug.  My choice.

The POE_ASSERT_DEFAULT environment variable will enable all the internals checks, including 
those for memory leaks.  I recommend it for development and field debugging, and any other 
times when the extra CPU hit isn&#39;t an issue.

-- Rocco

On Fri Apr 13 15:52:26 2012, fschlich wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; when running the test suite for poe-component-client-http, I get two 
&gt; warnings:
&gt; 
&gt; perl -w t/59_incomplete_b.t
&gt; 1..4
&gt; ok 1 - got expected content-length request
&gt; ok 2 - got expected no-content-length request
&gt; Use of uninitialized value $fd in exists at 
&gt; /usr/share/perl5/POE/Resource/FileHandles.pm line 577.
&gt; Use of uninitialized value $fd in exists at 
&gt; /usr/share/perl5/POE/Resource/FileHandles.pm line 577.
&gt; ok 3 - length&#40;content&#41; triggered 406
&gt; ok 4 - content-length triggered 406
&gt; 
&gt; Looking at FileHandles.pm, I notice that _data_handle_remove&#40;&#41; makes 
&gt; sure  that $fd is defined when deregistering the handle with the kernel, 
&gt; but doesn&#39;t take similar precautions afterwards when removing the select 
&gt; from the session.
&gt; 
&gt; Add a check there or short-circuit the entire sub when $fd is undef?
&gt; 
&gt; Florian
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1072713" href="/Public/Bug/Display.html?id=76542#txn-1072713">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;29&nbsp;18:31:00&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1074487" href="/Public/Bug/Display.html?id=76542#txn-1074487">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;04&nbsp;18:14:04&nbsp;2012</span>
    <span class="description">fschlich [...] zedat.fu-berlin.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76542] Use of uninitialized value $fd in exists at /usr/share/perl5/POE/Resource/FileHandles.pm line 577</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 5 May 2012 00:13:53 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Rocco Caputo via RT &lt;bug-POE [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Florian Schlichting &lt;fschlich [...] ZEDAT.FU-Berlin.DE&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1074487/565307/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/565307">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Rocco,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you reproduce the error at will?
</div>
well, yes of course, whenever I run t/59_incomplete_b.t from
poe-component-client-http... What I was meaning to say is that as a
Debian packager, I don&#39;t really know your module or the one where the
test is from, so wouldn&#39;t know how come the file handle has become
undef, but it struck me as odd that FileHandles.pm&#39;s
_data_handle_remove&#40;&#41; both checks for a defined $fd in its first block
and forgets to do so in its second block. Perhaps it should start with
something like

    return unless defined $fd;

or add &#34;defined $fd and&#34; on line 577?


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you set the POE_ASSERT_USAGE 
&gt; environment variable, they&#39;ll all be enabled at compile time.  If that doesn&#39;t give you a better 
&gt; failure message, I&#39;ll eat my hat.  Or fix a bug.  My choice.
</div>
$ POE_ASSERT_USAGE=1 perl -w t/59_incomplete_b.t
1..4
ok 1 - got expected content-length request
ok 2 - got expected no-content-length request
        &#40;in cleanup&#41; &#40;9488&#41; &lt;us&gt; invalid filehandle in select_read&#40;&#41; at /usr/share/perl5/POE/Kernel.pm line 2143
        POE::Kernel::select_read&#40;&#39;POE::Kernel=ARRAY&#40;0xed83b8&#41;&#39;, &#39;GLOB&#40;0x17365d8&#41;&#39;&#41; called at /usr/share/perl5/POE/Wheel/ReadWrite.pm line 392
        POE::Wheel::ReadWrite::DESTROY&#40;&#39;POE::Wheel::ReadWrite=ARRAY&#40;0x1718960&#41;&#39;&#41; called at /usr/share/perl5/POE/Component/Client/HTTP.pm line 818
        eval {...} called at /usr/share/perl5/POE/Component/Client/HTTP.pm line 818
        POE::Component::Client::HTTP::_poco_weeble_io_read&#40;undef, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;POE::Kernel=ARRAY&#40;0xed83b8&#41;&#39;, &#39;HASH&#40;0x968ac8&#41;&#39;, &#39;got_socket_input&#39;, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, undef, &#39;/usr/share/perl5/POE/Wheel/ReadWrite.pm&#39;, 283, ...&#41; called at /usr/share/perl5/POE/Session.pm line 464
        POE::Session::_invoke_state&#40;&#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;got_socket_input&#39;, &#39;ARRAY&#40;0xe69280&#41;&#39;, &#39;/usr/share/perl5/POE/Wheel/ReadWrite.pm&#39;, 283, &#39;POE::Wheel::ReadWrite&#40;13&#41; -&gt; select read&#39;&#41; called at /usr/share/perl5/POE/Kok 3 - length&#40;content&#41; triggered 406
ernel.pm line 1731
        POE::Kernel::call&#40;&#39;POE::Kernel=ARRAY&#40;0xed83b8&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;got_socket_input&#39;, &#39;HTTP::Response=HASH&#40;0x1740338&#41;&#39;, 13&#41; called at /usr/share/perl5/POE/Wheel/ReadWrite.pm line 283
        POE::Wheel::ReadWrite::__ANON__&#40;undef, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;POE::Kernel=ARRAY&#40;0xed83b8&#41;&#39;, &#39;HASH&#40;0x968ac8&#41;&#39;, &#39;POE::Wheel::ReadWrite&#40;13&#41; -&gt; select read&#39;, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, undef, &#39;/usr/share/perl5/POE/Resource/FileHandles.pm&#39;, 240,ok 4 - content-length triggered 406
 ...&#41; called at /usr/share/perl5/POE/Session.pm line 464
        POE::Session::_invoke_state&#40;&#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;POE::Wheel::ReadWrite&#40;13&#41; -&gt; select read&#39;, &#39;ARRAY&#40;0x171e6a8&#41;&#39;, &#39;/usr/share/perl5/POE/Resource/FileHandles.pm&#39;, 240, undef&#41; called at /usr/share/perl5/POE/Kernel.pm line 1049
        eval {...} called at /usr/share/perl5/POE/Kernel.pm line 1048
        POE::Kernel::_dispatch_event&#40;&#39;POE::Kernel=ARRAY&#40;0xed83b8&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x968ca8&#41;&#39;, &#39;POE::Wheel::ReadWrite&#40;13&#41; -&gt; select read&#39;, 1024, &#39;ARRAY&#40;0x171e6a8&#41;&#39;, &#39;/usr/share/perl5/POE/Resource/FileHandles.pm&#39;, 240, undef, ...&#41; called at /usr/share/perl5/POE/Resource/FileHandles.pm line 238
        POE::Kernel::_data_handle_enqueue_ready&#40;undef, undef, 30, 4&#41; called at /usr/share/perl5/POE/Loop/Select.pm line 288
        POE::Kernel::loop_do_timeslice&#40;&#39;POE::Kernel=ARRAY&#40;0xed83b8&#41;&#39;&#41; called at /usr/share/perl5/POE/Loop/Select.pm line 317
        POE::Kernel::loop_run&#40;&#39;POE::Kernel=ARRAY&#40;0xed83b8&#41;&#39;&#41; called at /usr/share/perl5/POE/Kernel.pm line 1235
        POE::Kernel::run&#40;&#39;POE::Kernel&#39;&#41; called at t/59_incomplete_b.t line 34


nice backtrace. &#34;invalid filehandle&#34; is correct, it&#39;s undef. Whether
that&#39;s a bug I cannot say. What I opened this ticket about is that
/usr/share/perl5/POE/Resource/FileHandles.pm:_data_handle_remove&#40;&#41; goes
on regardless, and uses that undef $fd as a hash key on line 579.

Florian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1075027" href="/Public/Bug/Display.html?id=76542#txn-1075027">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;06&nbsp;14:31:14&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1075027/565604/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/565604">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri May 04 18:14:04 2012, fschlich wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; $ POE_ASSERT_USAGE=1 perl -w t/59_incomplete_b.t
</div>[...]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    /usr/share/perl5/POE/Component/Client/HTTP.pm line 818
</div>
Is that the most recent CPAN release of POE::Component::Client::HTTP?  The line numbers don&#39;t 
seem to match up with recent releases.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; nice backtrace. &#34;invalid filehandle&#34; is correct, it&#39;s undef. Whether
&gt; that&#39;s a bug I cannot say. What I opened this ticket about is that
&gt; /usr/share/perl5/POE/Resource/FileHandles.pm:_data_handle_remove&#40;&#41;
&gt;    goes
&gt; on regardless, and uses that undef $fd as a hash key on line 579.
</div>
It&#39;s definitely a bug.  Undef should never be passed in.  I&#39;d like to find out why that&#39;s happening 
before addressing lower-level problems.  The low-level error helps highlight problems at the 
higher level.  They&#39;re almost like features. :&#41;

Unfortunately for me, the test case works here.  Maybe the failure is triggered by your 
environment?  It seems likely that something is nonstandard about your localhost interface.  Is it 
firewalled to prevent random use?  Is your localhost IPv6-only?  Does it have a nonstandard 
address?  Is it routed strangely, or not in your routing table at all?  Anything like that?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1086442" href="/Public/Bug/Display.html?id=76542#txn-1086442">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;03&nbsp;03:30:13&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1086442/571040/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/571040">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 719b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think I fixed the underlying cause.  I encountered the same error while running a routine test 
of POE::Component::Client::HTTP.

I just release POE::Component::Client::HTTP 0.947, which should resolve this:

commit 944c66f2149bc39a24db854d0310522b1d1697ed
Author: Rocco Caputo &lt;rcaputo@cpan.org&gt;
Date:   Sun Jun 3 03:14:47 2012 -0400

    [rt.cpan.org 76542] Fix a double close in PoCo::Client::HTTP.
    
    Florian Schlichting found POE throwing an error on an undefined file
    descriptor.  POE::Component::Client::HTTP was closing a filehandle
    before destroying the wheel that was managing it.  When it was time
    for the wheel to remove the filehandle&#39;s watcher, fileno&#40;&#41; failed, and
    trouble ensued.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1086445" href="/Public/Bug/Display.html?id=76542#txn-1086445">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;03&nbsp;03:30:15&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.351754</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
