<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #81793 for parent: allow version number in arg list</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #81793 for parent: allow version number in arg list</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/parent/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/parent/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/parent/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/parent/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/parent">parent CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">81793</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/parent/Active/">parent</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dagolden [...] cpan.org

<br />
DAMI [...] cpan.org

<br />
ether [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-44800-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-44801-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.229    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;08&nbsp;03:08:55&nbsp;2012</span>
    <span class="description">DAMI [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> allow version number in arg list</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">To require a particular version of a parent module, we need to write

use MyParent 1.234;
use parent &#39;MyParent&#39;;

It would be convenient to support a syntax like

use parent &#39;MyParent&#39;, -version =&gt; 1.234;

or maybe just

use parent &#39;MyParent&#39;, 1.234; # looks_like_number, must be a version num
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;10:12:07&nbsp;2013</span>
    <span class="description">rjbs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2012-12-08 03:08:55, DAMI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; To require a particular version of a parent module, we need to write
&gt; 
&gt; use MyParent 1.234;
&gt; use parent &#39;MyParent&#39;;
</div>
This came up on IRC yesterday and I also bemoaned its lack.  I&#39;d be happy to write a patch for 
this.  I think this is exactly the kind of thing that parent.pm could get right that base.pm got 
wrong: provide a tiny but universally useful feature to avoid having to think very much.  &#40;As 
opposed to providing barely-ever features that lead to complications more often than they help.&#41;

-- 
rjbs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;10:12:08&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;10:39:26&nbsp;2013</span>
    <span class="description">rjbs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve attached two small patches.  Together they allow:

  use parent Something =&gt; { version =&gt; 1.2 };

and also

  use parent Something =&gt; { no_require =&gt; 1 };

And also fix a bug whereby no_require exempted one from the self-inherit check.

If these look okay, I will see about also writing tests. ;&#41;

-- 
rjbs
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0001-add-assert-version-and-fix-bugs.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 4b1a8498b5d54ad96e469e0ff5d15b7ecd1e9107 Mon Sep 17 00:00:00 2001
From: Ricardo Signes &lt;rjbs@cpan.org&gt;
Date: Fri, 1 Feb 2013 10:26:05 -0500
Subject: [PATCH 1/3] add &#34;assert version&#34; and fix bugs...

1. do not allow &#39;-norequire&#39; to bypass self-inherit check
2. allow &#34;use parent foo =&gt; { &#39;:version&#39; =&gt; 1.23 }&#34;
---
 lib/parent.pm | 27 ++++++++++++++++++---------
 1 file changed, 18 insertions&#40;+&#41;, 9 deletions&#40;-&#41;

diff --git a/lib/parent.pm b/lib/parent.pm
index 8f72db8..905b4c9 100755
--- a/lib/parent.pm
+++ b/lib/parent.pm
@@ -7,23 +7,32 @@ sub import {
     my $class = shift;
 
     my $inheritor = caller&#40;0&#41;;
+    my @to_push;
+    my $no_require;
 
     if &#40; @_ and $_[0] eq &#39;-norequire&#39; &#41; {
         shift @_;
-    } else {
-        for &#40; my @filename = @_ &#41; {
-            if &#40; $_ eq $inheritor &#41; {
-                warn &#34;Class &#39;$inheritor&#39; tried to inherit from itself\n&#34;;
-            };
-
-            s{::|&#39;}{/}g;
-            require &#34;$_.pm&#34;; # dies if the file is not found
+        $no_require = 1;
+    }
+
+    my @todo = @_;
+    while &#40;my $name = shift @todo&#41; {
+        if &#40; $name eq $inheritor &#41; {
+            warn &#34;Class &#39;$inheritor&#39; tried to inherit from itself\n&#34;;
+        };
+
+        push @to_push, $name;
+        $name =~ s{::|&#39;}{/}g;
+        require &#34;$name.pm&#34; unless $no_require; # dies if the file is not found
+        if &#40;@todo and ref $todo[0]&#41; {
+            $name-&gt;VERSION&#40;$todo[0]{&#39;:version&#39;}&#41;;
+            shift @todo;
         }
     }
 
     {
         no strict &#39;refs&#39;;
-        push @{&#34;$inheritor\::ISA&#34;}, @_;
+        push @{&#34;$inheritor\::ISA&#34;}, @to_push;
     };
 };
 
-- 
1.8.1

</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0002-allow-no_require-per-parent-class.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From fef3233b30e2245d12e17a36bca5db8e8ea6aa52 Mon Sep 17 00:00:00 2001
From: Ricardo Signes &lt;rjbs@cpan.org&gt;
Date: Fri, 1 Feb 2013 10:30:05 -0500
Subject: [PATCH 2/3] allow no_require per parent class

As long as we have &#34;parent class options,&#34; allow no_require per
class.  This is almost certainly a better plan, anyway, for any case
in which we&#39;re doing MI.
---
 lib/parent.pm | 14 ++++++++++----
 1 file changed, 10 insertions&#40;+&#41;, 4 deletions&#40;-&#41;

diff --git a/lib/parent.pm b/lib/parent.pm
index 905b4c9..6f3fe07 100755
--- a/lib/parent.pm
+++ b/lib/parent.pm
@@ -21,13 +21,19 @@ sub import {
             warn &#34;Class &#39;$inheritor&#39; tried to inherit from itself\n&#34;;
         };
 
-        push @to_push, $name;
-        $name =~ s{::|&#39;}{/}g;
-        require &#34;$name.pm&#34; unless $no_require; # dies if the file is not found
+        my %arg = &#40;no_require =&gt; $no_require&#41;;
         if &#40;@todo and ref $todo[0]&#41; {
-            $name-&gt;VERSION&#40;$todo[0]{&#39;:version&#39;}&#41;;
+            %arg = &#40;%arg, %{ $todo[0] }&#41;;
             shift @todo;
         }
+
+        push @to_push, $name;
+        $name =~ s{::|&#39;}{/}g;
+
+        # dies if the file is not found
+        require &#34;$name.pm&#34; unless $arg{no_require};
+
+        $name-&gt;VERSION&#40;$arg{version}&#41; if defined $arg{version};
     }
 
     {
-- 
1.8.1

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;10:41:08&nbsp;2013</span>
    <span class="description">corion [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81793] allow version number in arg list</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 01 Feb 2013 16:40:48 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-parent [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Max Maischein &lt;corion [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Damien and Ricardo,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"> &gt;&gt; use MyParent 1.234;
&gt;&gt; use parent &#39;MyParent&#39;;
</div>&gt;
&gt; This came up on IRC yesterday and I also bemoaned its lack.  I&#39;d be happy to write a patch for
&gt; this.  I think this is exactly the kind of thing that parent.pm could get right that base.pm got
&gt; wrong: provide a tiny but universally useful feature to avoid having to think very much.  &#40;As
&gt; opposed to providing barely-ever features that lead to complications more often than they help.&#41;
&gt;
</div>I already wrote to David Golden in a related mail that I&#39;m opposed to 
this change. I don&#39;t see any big gain over the two-line approach of

use &#39;Some::Parent&#39; 1.23;
use parent &#39;Some::Parent&#39;;

or

use parent &#39;Some::Parent&#39;;
Some::Parent-&gt;VERSION&#40;1.23&#41;;

... and the added complexity and feature creep is what made base.pm such 
a mess. At least in my perception, the group of you three is the only 
instance wanting to enforce a version number. I admit that I&#39;m biased as 
I don&#39;t have such a use-case myself.

I especially want to avoid one of the really ugly problems of base.pm, 
which forced a version number for modules that didn&#39;t provide a version 
number themselves &#40;&#34;-1, set by base.pm&#34;&#41;.

David proposed an API of

     use parent [ &#39;Some::Parent&#39; =&gt; 1.234 ], [ &#39;Another::Parent&#39; =&gt; 5.678 ];

but I don&#39;t like this idea either. Back when parent.pm was born, there 
was a quite similar discussion except for the &#34;-norequire&#34; switch. 
Originally, there was the idea of allowing &#40;I think&#41; hashrefs to signify 
parent classes that should not get loaded from disk, but we arrived at 
the design decision of either having &#39;-norequire&#39; as the first argument 
and then not trying to load any of the classes, or loading all of the 
classes.

One way forward I could see would be another module, parent/versions.pm, 
which is basically a small loop around parent.pm:

package parent::versions;
require parent;

sub import {
     my $class= shift;
     my $inheritor= caller&#40;0&#41;;
     local *CORE::GLOBAL::caller = sub { $inheritor };
     while&#40;&#40; my $module, $version &#41; = splice @_, 0, 2&#41; {
         parent::-&gt;import&#40;$module&#41;;
         $module-&gt;VERSION&#40;$version&#41;;
     };
};

1

To get around the nasty *CORE::GLOBAL::caller thing, which depends on 
the load order of parent.pm, I can think of moving the main code of 
parent.pm to a subroutine that takes the target namespace as an argument 
instead of inferring it from caller&#40;0&#41;.

-max
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;10:59:16&nbsp;2013</span>
    <span class="description">corion [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81793] allow version number in arg list</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 01 Feb 2013 16:58:54 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-parent [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Max Maischein &lt;corion [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Ricardo,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; I&#39;ve attached two small patches.  Together they allow:
&gt;
&gt;    use parent Something =&gt; { version =&gt; 1.2 };
&gt;
&gt; and also
&gt;
&gt;    use parent Something =&gt; { no_require =&gt; 1 };
&gt;
&gt; And also fix a bug whereby no_require exempted one from the self-inherit check.
&gt;
&gt; If these look okay, I will see about also writing tests. ;&#41;
</div>
I haven&#39;t looked at them yet. There was discussion in 2007 &#40;[1] and [2]&#41; 
which led to the current behaviour+API. I don&#39;t see why the current 
behaviour should be changed, especially in the light of adding the 
feature outside of parent.pm, maybe with a little help from parent.pm by 
making the API less implicit.

-max

[1] <span class="clickylink"><a target="new" rel="nofollow" href="http://www.nntp.perl.org/group/perl.perl5.porters/2007/08/msg127450.html">http://www.nntp.perl.org/group/perl.perl5.porters/2007/08/msg127450.html</a></span>
[2] <span class="clickylink"><a target="new" rel="nofollow" href="http://www.nntp.perl.org/group/perl.perl5.porters/2007/08/msg127774.html">http://www.nntp.perl.org/group/perl.perl5.porters/2007/08/msg127774.html</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;10:59:41&nbsp;2013</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I created a trivial fork called &#39;inherit&#39;

    use inherit &#39;Foo&#39; =&gt; 1.23, &#39;Bar&#39;;

The implementation passes all of parent&#39;s tests, plus additional version
check testing.

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/dagolden/inherit/blob/master/lib/inherit.pm">https://github.com/dagolden/inherit/blob/master/lib/inherit.pm</a></span>

I&#39;m happy to provide it in patch format for parent &#40;or patch it directly
in blead&#41;.

Or, if you really feel it&#39;s too much feature creep, I&#39;ll just release it
to CPAN.

FWIW, the argument &#34;why not type it out longhand&#34; applies to base/parent
in the first place, so I don&#39;t find it compelling.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;11:09:05&nbsp;2013</span>
    <span class="description">rjbs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2013-02-01 10:41:08, CORION wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I already wrote to David Golden in a related mail that I&#39;m opposed to
&gt; this change. I don&#39;t see any big gain over the two-line approach of
&gt; 
&gt; use &#39;Some::Parent&#39; 1.23;
&gt; use parent &#39;Some::Parent&#39;;
</div>
Isn&#39;t this like &#34;I don&#39;t see any big gain of use parent over; use SomeParent 1.23;  BEGIN { push 
our @ISA, &#39;SomeParent&#39; }&#34;   ?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I especially want to avoid one of the really ugly problems of base.pm,
&gt; which forced a version number for modules that didn&#39;t provide a
&gt; version
&gt; number themselves &#40;&#34;-1, set by base.pm&#34;&#41;.
</div>
Nobody is suggesting restoring such nonsense!  Certainly not me, and if David Golden is 
going to argue for anything, I&#39;m sure it wouldn&#39;t be this. ;&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;      local *CORE::GLOBAL::caller = sub { $inheritor };
&gt; ...
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; To get around the nasty *CORE::GLOBAL::caller thing, which depends on
&gt; the load order of parent.pm, I can think of moving the main code of
&gt; parent.pm to a subroutine that takes the target namespace as an
&gt; argument instead of inferring it from caller&#40;0&#41;.
</div>
This seems like contortions in service of conceptual purity that doesn&#39;t have much practicla 
value.

-- 
rjbs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;11:23:11&nbsp;2013</span>
    <span class="description">corion [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81793] allow version number in arg list</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 01 Feb 2013 17:22:54 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-parent [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Max Maischein &lt;corion [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello David,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; I created a trivial fork called &#39;inherit&#39;
&gt;
&gt;      use inherit &#39;Foo&#39; =&gt; 1.23, &#39;Bar&#39;;
&gt;
&gt; The implementation passes all of parent&#39;s tests, plus additional version
&gt; check testing.
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/dagolden/inherit/blob/master/lib/inherit.pm">https://github.com/dagolden/inherit/blob/master/lib/inherit.pm</a></span>
&gt;
&gt; I&#39;m happy to provide it in patch format for parent &#40;or patch it directly
&gt; in blead&#41;.
&gt;
&gt; Or, if you really feel it&#39;s too much feature creep, I&#39;ll just release it
&gt; to CPAN.
&gt;
&gt; FWIW, the argument &#34;why not type it out longhand&#34; applies to base/parent
&gt; in the first place, so I don&#39;t find it compelling.
&gt;
</div>Well, the longhand for base / parent is about four lines:

BEGIN {
     require Some::Parent;
     push @ISA, &#39;Some::Parent&#39;;
};

... while I consider version checking a rare requirement, which can live 
better with the two-line longhand.

Determining the version number the way you do is nice, but I would 
prefer to disallow v-strings resp. 
quoted-things-that-look-like-v-strings altogether. This also would 
remove the problem of not allowing

   use inherit &#39;Foo&#39; =&gt; v2;

while allowing

   use inherit &#39;Foo&#39; =&gt; v2.0;

Also, your approach fails with:

   use inherit &#39;Foo&#39; =&gt; v65.0;

v-strings should just die.

I&#39;m not sure whether the API of parent.pm should allow for the fancy 
version syntax by sacrificing package names that look like version 
numbers. That said, I don&#39;t think numeric package names make sense.

While I&#39;m still not convinced of the utility of the change, I consider 
the API somewhat nicer than the other alternatives that use hashrefs or 
arrayrefs.

-max
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;11:33:02&nbsp;2013</span>
    <span class="description">corion [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81793] allow version number in arg list</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 01 Feb 2013 17:32:41 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-parent [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Max Maischein &lt;corion [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Ricardo,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; On 2013-02-01 10:41:08, CORION wrote:
<div class="message-stanza open">&gt;&gt; I already wrote to David Golden in a related mail that I&#39;m opposed to
&gt;&gt; this change. I don&#39;t see any big gain over the two-line approach of
&gt;&gt;
&gt;&gt; use &#39;Some::Parent&#39; 1.23;
&gt;&gt; use parent &#39;Some::Parent&#39;;
</div>&gt;
&gt; Isn&#39;t this like &#34;I don&#39;t see any big gain of use parent over; use SomeParent 1.23;  BEGIN { push
&gt; our @ISA, &#39;SomeParent&#39; }&#34;   ?
</div>Yep, it&#39;s just shorter to type, and the version number is a use case 
that I find rare.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; I especially want to avoid one of the really ugly problems of base.pm,
&gt;&gt; which forced a version number for modules that didn&#39;t provide a
&gt;&gt; version
&gt;&gt; number themselves &#40;&#34;-1, set by base.pm&#34;&#41;.
</div>&gt;
&gt; Nobody is suggesting restoring such nonsense!  Certainly not me, and if David Golden is
&gt; going to argue for anything, I&#39;m sure it wouldn&#39;t be this. ;&#41;
&gt;
<div class="message-stanza open">&gt;&gt;       local *CORE::GLOBAL::caller = sub { $inheritor };
&gt;&gt; ...
</div>&gt;
<div class="message-stanza open">&gt;&gt; To get around the nasty *CORE::GLOBAL::caller thing, which depends on
&gt;&gt; the load order of parent.pm, I can think of moving the main code of
&gt;&gt; parent.pm to a subroutine that takes the target namespace as an
&gt;&gt; argument instead of inferring it from caller&#40;0&#41;.
</div>&gt;
&gt; This seems like contortions in service of conceptual purity that doesn&#39;t have much practicla
&gt; value.
</div>
I see an easy way to add this feature outside of parent.pm by doing a 
small, non-invasive change to parent.pm itself, which allows it to be 
used from other modules in an easy way. Which is why I proposed this 
change, so the intended functionality can be added in a separate module 
without changing the existing API and parameter convention of parent.pm. 
Especially in the light of three different approaches, DWIM at the cost 
of disallowing numeric package names, and explicit, using hashrefs or 
arrayrefs, I think that the best API for passing a version requirement 
isn&#39;t obvious, and trying out the alternatives is better done outside 
parent.pm.

-max
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;11:58:41&nbsp;2013</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I agree v-strings suck, but I&#39;d like to preserve anything that &#34;use 
MODULE VERSION&#34; can take.  Taking them as strings is actually
safer/better, but requires Perl v5.10 or version.pm.  Either approach is
fine with me.  I&#39;d probably go the version.pm route for a CPAN release.

Admittedly, the &#34;v65.0&#34; case is slightly tricky.  There is a way to
introspect a scalar to see if it&#39;s v-string, but takes some B hackery.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;13:04:18&nbsp;2013</span>
    <span class="description">ether [...] cpan.org -  Requestor ETHER added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;19:57:59&nbsp;2013</span>
    <span class="description">dagolden [...] cpan.org -  Requestor DAGOLDEN added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;01&nbsp;21:25:42&nbsp;2013</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve updated inherit.pm on github to address concerns raised.

Specifically:

&#40;1&#41; potential version constraints are tested explicitly against a full
module-name regex and only considered a version if that fails

&#40;2&#41; dotted-decimals are documented as needing to be in strings, not raw
v-strings &#40;this requires adding version.pm&#41;

&#40;3&#41; we can still handle raw v-strings that don&#39;t map to alphanumerics
&#40;thanks to #1&#41;, but this is documented as strongly discouraged

&#40;4&#41; uses &#40;updated&#41; Module::Load to ensure things that look like modules
are only loaded from @INC

Please consider whether this is sufficient to be ported back to parent.
 If not &#40;or if I haven&#39;t heard back by the middle of next week or so&#41;,
I&#39;ll go ahead and release inherit.pm to CPAN instead.

I&#39;d like it to go in, but I respect an alternative point of view with
different priorities.  :-&#41;

Regards,
David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;02&nbsp;07:51:02&nbsp;2013</span>
    <span class="description">laurent.dami [...] free.fr -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81793] allow version number in arg list</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 02 Feb 2013 13:50:54 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-parent [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> laurent dami &lt;laurent.dami [...] free.fr&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le 02.02.2013 03:25, David Golden via RT a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81793">https://rt.cpan.org/Ticket/Display.html?id=81793</a></span> &gt;
&gt;
&gt; I&#39;ve updated inherit.pm on github to address concerns raised.
&gt;
&gt; [...]
&gt;
&gt; Please consider whether this is sufficient to be ported back to parent.
&gt;
</div>Thanks for this work; to me this looks like a perfect answer to my 
original ticket.

I hope this will reach an agreement and get implemented within 
parent.pm, instead of a new module inherit.pm; otherwise I&#39;ll have to 
tell my team that after having changed all our code from &#39;base.pm&#39; to  
&#39;parent.pm&#39;, we now change again .... for sure they will complain ... :-&#40; !
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;02&nbsp;09:04:44&nbsp;2013</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81793] allow version number in arg list</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 2 Feb 2013 09:04:04 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-parent [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Golden &lt;dagolden [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, Feb 2, 2013 at 7:51 AM, laurent.dami@free.fr via RT
&lt;bug-parent@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I hope this will reach an agreement and get implemented within
&gt; parent.pm, instead of a new module inherit.pm; otherwise I&#39;ll have to
&gt; tell my team that after having changed all our code from &#39;base.pm&#39; to
&gt; &#39;parent.pm&#39;, we now change again .... for sure they will complain ... :-&#40; !
</div>
The tricky bit is that you&#39;ll have to specify a newer version of
parent in your prereqs.  I hope if this change goes through, we could
bump the major version to &#34;1&#34;, so people can easily remember what
version to specify instead of having to remember &#39;0.2XX&#39; or whatever
it turns out to be.

I routinely get annoyed trying to remember which version of File::Temp
implemented &#39;newdir&#39; or which Test::More added subtests.

-- 
David Golden &lt;dagolden@cpan.org&gt;
Take back your inbox! → <span class="clickylink"><a target="new" rel="nofollow" href="http://www.bunchmail.com/">http://www.bunchmail.com/</a></span>
Twitter/IRC: @xdg
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;14:57:35&nbsp;2015</span>
    <span class="description">corion [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The functionality discussed in this ticket lives now in superclass.pm on CPAN.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;14:57:37&nbsp;2015</span>
    <span class="description">corion [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;14:57:37&nbsp;2015</span>
    <span class="description">corion [...] cpan.org -  Fixed in 0.229 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
