<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #128121 for DBD-SQLite: fetchrow_arrayref not returning fully compatible perl array ref</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #128121 for DBD-SQLite: fetchrow_arrayref not returning fully compatible perl array ref</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBD-SQLite/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBD-SQLite/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBD-SQLite/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBD-SQLite/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-SQLite">DBD-SQLite CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">128121</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBD-SQLite/Active/">DBD-SQLite</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
se_misc [...] hotmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10248-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10249-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;27&nbsp;14:43:05&nbsp;2018</span>
    <span class="description">se_misc [...] hotmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> fetchrow_arrayref not returning fully compatible perl array ref</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 27 Dec 2018 19:42:37 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-DBD-SQLite [...] rt.cpan.org&#34; &lt;bug-DBD-SQLite [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stefan E &lt;se_misc [...] hotmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thx, Ishigaki San, for providing DBD::SQLite!

Running the following code on Strawberry perl 5.26.1 &#40;64 bit, Win 7&#41; 
crashes at the line indicated. I&#39;m currently porting some code from 
mySQL to SQLite; same code had no problem with DBD::mysql. Issue is 
reproduced with DBD::SQLite 1.54 and 1.60.

use strict;
use DBI;
my&#40;$dbh, $sth, @data&#41;;

$dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=dummy1.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
$sth = $dbh-&gt;prepare&#40;&#34;SELECT id, f_1397, f_1398, f_1399, f_1400 FROM 
myTable;&#34;&#41;;
$sth-&gt;execute&#40;&#41;;

while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
   splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is used above
   push @data, [ @$row_ref ];      # -- trying to copy array after 
splice kills perl &#40;works without splice above&#41;
   #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41; solution: 
splice on copy of array
}

Thx. for your consideration

Kind regards, Stefan

</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;27&nbsp;16:05:41&nbsp;2018</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 28 04:43:05 2018, Stefan_E wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thx, Ishigaki San, for providing DBD::SQLite!
&gt; 
&gt; Running the following code on Strawberry perl 5.26.1 &#40;64 bit, Win 7&#41; 
&gt; crashes at the line indicated. I&#39;m currently porting some code from 
&gt; mySQL to SQLite; same code had no problem with DBD::mysql. Issue is 
&gt; reproduced with DBD::SQLite 1.54 and 1.60.
&gt; 
&gt; use strict;
&gt; use DBI;
&gt; my&#40;$dbh, $sth, @data&#41;;
&gt; 
&gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=dummy1.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT id, f_1397, f_1398, f_1399, f_1400 FROM 
&gt; myTable;&#34;&#41;;
&gt; $sth-&gt;execute&#40;&#41;;
&gt; 
&gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt;    splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is used above
&gt;    push @data, [ @$row_ref ];      # -- trying to copy array after 
&gt; splice kills perl &#40;works without splice above&#41;
&gt;    #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41; solution: 
&gt; splice on copy of array
&gt; }
&gt; 
&gt; Thx. for your consideration
&gt; 
&gt; Kind regards, Stefan
&gt; 
</div>
Couldn&#39;t reproduce the issue under almost the same environment &#40;64bit Win7 + strawberry 5.26.3&#41; and a few other environments.

Could you make the script above a little more complete? &#40;create a table and insert necessary data, set proper attributes, etc; please let it reproduce the issue by just running it.&#41;

And what happens if you run the same script under other OSes &#40;in other words, isn&#39;t it your environmental issue, rather than DBD::SQLite&#39;s&#41;?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;27&nbsp;16:05:42&nbsp;2018</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;27&nbsp;16:47:21&nbsp;2018</span>
    <span class="description">se_misc [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #128121] fetchrow_arrayref not returning fully compatible perl array ref</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 27 Dec 2018 21:46:53 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-DBD-SQLite [...] rt.cpan.org&#34; &lt;bug-DBD-SQLite [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stefan E &lt;se_misc [...] hotmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here is a self-contained script. Sorry, I don&#39;t have access to another 
environment &#40;except for a VM with the same strawberry - btw., a portable 
installation; DBI is 1.637, but updating to 1.642 didn&#39;t help&#41;

use strict;
use DBI;
my&#40;$dbh, $sth, @data&#41;;

unlink &#34;test.sqlite&#34; or warn &#34;Can&#39;t erase test.sqlite&#34;;
$dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=test.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
$dbh-&gt;do&#40;&#34;CREATE TABLE test_table &#40;
             t1   REAL default 0,
             t2   REAL default 0,
             t3   REAL default 0,
             t4   REAL default 0&#41;;&#34;&#41;;
$dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;1.1, 1.2, 1.3, 
1.4&#41;;&#34;&#41;;
$dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;2.1, 2.2, 2.3, 
2.4&#41;;&#34;&#41;;
$dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;3.1, 3.2, 3.3, 
3.4&#41;;&#34;&#41;;
$dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;4.1, 4.2, 4.3, 
4.4&#41;;&#34;&#41;;

$sth = $dbh-&gt;prepare&#40;&#34;SELECT t1, t2, t3, t4 FROM test_table;&#34;&#41;;

$sth-&gt;execute&#40;&#41;;
while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
   splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is used above
   push @data, [ @$row_ref ];      # -- trying to copy array after 
splice kills perl
   #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41; solution: 
splice on copy of array
}

for &#40;my $i = 0; $i &lt; scalar @data; $i++&#41; {
   print join &#34;, &#34;, @{$data[$i]};
   print &#34;\n&#34;;
}

On 27-Dec-18 22:05, Kenichi Ishigaki via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=128121">https://rt.cpan.org/Ticket/Display.html?id=128121</a></span> &gt;
&gt;
&gt; On Fri Dec 28 04:43:05 2018, Stefan_E wrote:
<div class="message-stanza open">&gt;&gt; Thx, Ishigaki San, for providing DBD::SQLite!
&gt;&gt;
&gt;&gt; Running the following code on Strawberry perl 5.26.1 &#40;64 bit, Win 7&#41;
&gt;&gt; crashes at the line indicated. I&#39;m currently porting some code from
&gt;&gt; mySQL to SQLite; same code had no problem with DBD::mysql. Issue is
&gt;&gt; reproduced with DBD::SQLite 1.54 and 1.60.
&gt;&gt;
&gt;&gt; use strict;
&gt;&gt; use DBI;
&gt;&gt; my&#40;$dbh, $sth, @data&#41;;
&gt;&gt;
&gt;&gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=dummy1.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt;&gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT id, f_1397, f_1398, f_1399, f_1400 FROM
&gt;&gt; myTable;&#34;&#41;;
&gt;&gt; $sth-&gt;execute&#40;&#41;;
&gt;&gt;
&gt;&gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt;&gt;     splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is used above
&gt;&gt;     push @data, [ @$row_ref ];      # -- trying to copy array after
&gt;&gt; splice kills perl &#40;works without splice above&#41;
&gt;&gt;     #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41; solution:
&gt;&gt; splice on copy of array
&gt;&gt; }
&gt;&gt;
&gt;&gt; Thx. for your consideration
&gt;&gt;
&gt;&gt; Kind regards, Stefan
&gt;&gt;
</div>&gt; Couldn&#39;t reproduce the issue under almost the same environment &#40;64bit Win7 + strawberry 5.26.3&#41; and a few other environments.
&gt;
&gt; Could you make the script above a little more complete? &#40;create a table and insert necessary data, set proper attributes, etc; please let it reproduce the issue by just running it.&#41;
&gt;
&gt; And what happens if you run the same script under other OSes &#40;in other words, isn&#39;t it your environmental issue, rather than DBD::SQLite&#39;s&#41;?
&gt;
&gt; .
&gt;
</div>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;27&nbsp;16:56:59&nbsp;2018</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 28 06:47:21 2018, Stefan_E wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here is a self-contained script. Sorry, I don&#39;t have access to another
&gt; environment &#40;except for a VM with the same strawberry - btw., a
&gt; portable
&gt; installation; DBI is 1.637, but updating to 1.642 didn&#39;t help&#41;
&gt; 
&gt; use strict;
&gt; use DBI;
&gt; my&#40;$dbh, $sth, @data&#41;;
&gt; 
&gt; unlink &#34;test.sqlite&#34; or warn &#34;Can&#39;t erase test.sqlite&#34;;
&gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=test.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt; $dbh-&gt;do&#40;&#34;CREATE TABLE test_table &#40;
&gt;              t1   REAL default 0,
&gt;              t2   REAL default 0,
&gt;              t3   REAL default 0,
&gt;              t4   REAL default 0&#41;;&#34;&#41;;
&gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;1.1, 1.2,
&gt; 1.3,
&gt; 1.4&#41;;&#34;&#41;;
&gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;2.1, 2.2,
&gt; 2.3,
&gt; 2.4&#41;;&#34;&#41;;
&gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;3.1, 3.2,
&gt; 3.3,
&gt; 3.4&#41;;&#34;&#41;;
&gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;4.1, 4.2,
&gt; 4.3,
&gt; 4.4&#41;;&#34;&#41;;
&gt; 
&gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT t1, t2, t3, t4 FROM test_table;&#34;&#41;;
&gt; 
&gt; $sth-&gt;execute&#40;&#41;;
&gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt;    splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is used
&gt; above
&gt;     push @data, [ @$row_ref ];      # -- trying to copy array after
&gt; splice kills perl
&gt;     #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41; solution:
&gt; splice on copy of array
&gt; }
&gt; 
&gt; for &#40;my $i = 0; $i &lt; scalar @data; $i++&#41; {
&gt;    print join &#34;, &#34;, @{$data[$i]};
&gt;    print &#34;\n&#34;;
&gt; }
&gt; 
&gt; On 27-Dec-18 22:05, Kenichi Ishigaki via RT wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=128121">https://rt.cpan.org/Ticket/Display.html?id=128121</a></span> &gt;
&gt; &gt;
&gt; &gt; On Fri Dec 28 04:43:05 2018, Stefan_E wrote:
<div class="message-stanza open">&gt; &gt;&gt; Thx, Ishigaki San, for providing DBD::SQLite!
&gt; &gt;&gt;
&gt; &gt;&gt; Running the following code on Strawberry perl 5.26.1 &#40;64 bit, Win 7&#41;
&gt; &gt;&gt; crashes at the line indicated. I&#39;m currently porting some code from
&gt; &gt;&gt; mySQL to SQLite; same code had no problem with DBD::mysql. Issue is
&gt; &gt;&gt; reproduced with DBD::SQLite 1.54 and 1.60.
&gt; &gt;&gt;
&gt; &gt;&gt; use strict;
&gt; &gt;&gt; use DBI;
&gt; &gt;&gt; my&#40;$dbh, $sth, @data&#41;;
&gt; &gt;&gt;
&gt; &gt;&gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=dummy1.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt; &gt;&gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT id, f_1397, f_1398, f_1399, f_1400 FROM
&gt; &gt;&gt; myTable;&#34;&#41;;
&gt; &gt;&gt; $sth-&gt;execute&#40;&#41;;
&gt; &gt;&gt;
&gt; &gt;&gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt; &gt;&gt;     splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is
&gt; &gt;&gt; used above
&gt; &gt;&gt;     push @data, [ @$row_ref ];      # -- trying to copy array after
&gt; &gt;&gt; splice kills perl &#40;works without splice above&#41;
&gt; &gt;&gt;     #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41;
&gt; &gt;&gt; solution:
&gt; &gt;&gt; splice on copy of array
&gt; &gt;&gt; }
&gt; &gt;&gt;
&gt; &gt;&gt; Thx. for your consideration
&gt; &gt;&gt;
&gt; &gt;&gt; Kind regards, Stefan
&gt; &gt;&gt;
</div>&gt; &gt; Couldn&#39;t reproduce the issue under almost the same environment &#40;64bit
&gt; &gt; Win7 + strawberry 5.26.3&#41; and a few other environments.
&gt; &gt;
&gt; &gt; Could you make the script above a little more complete? &#40;create a
&gt; &gt; table and insert necessary data, set proper attributes, etc; please
&gt; &gt; let it reproduce the issue by just running it.&#41;
&gt; &gt;
&gt; &gt; And what happens if you run the same script under other OSes &#40;in
&gt; &gt; other words, isn&#39;t it your environmental issue, rather than
&gt; &gt; DBD::SQLite&#39;s&#41;?
&gt; &gt;
&gt; &gt; .
&gt; &gt;
</div>&gt; 
</div>
Now I can reproduce the issue under both Win and Debian. Will look at it. Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;27&nbsp;17:56:01&nbsp;2018</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 28 06:56:59 2018, ISHIGAKI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Dec 28 06:47:21 2018, Stefan_E wrote:
<div class="message-stanza open">&gt; &gt; Here is a self-contained script. Sorry, I don&#39;t have access to
&gt; &gt; another
&gt; &gt; environment &#40;except for a VM with the same strawberry - btw., a
&gt; &gt; portable
&gt; &gt; installation; DBI is 1.637, but updating to 1.642 didn&#39;t help&#41;
&gt; &gt;
&gt; &gt; use strict;
&gt; &gt; use DBI;
&gt; &gt; my&#40;$dbh, $sth, @data&#41;;
&gt; &gt;
&gt; &gt; unlink &#34;test.sqlite&#34; or warn &#34;Can&#39;t erase test.sqlite&#34;;
&gt; &gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=test.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt; &gt; $dbh-&gt;do&#40;&#34;CREATE TABLE test_table &#40;
&gt; &gt;              t1   REAL default 0,
&gt; &gt;              t2   REAL default 0,
&gt; &gt;              t3   REAL default 0,
&gt; &gt;              t4   REAL default 0&#41;;&#34;&#41;;
&gt; &gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;1.1, 1.2,
&gt; &gt; 1.3,
&gt; &gt; 1.4&#41;;&#34;&#41;;
&gt; &gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;2.1, 2.2,
&gt; &gt; 2.3,
&gt; &gt; 2.4&#41;;&#34;&#41;;
&gt; &gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;3.1, 3.2,
&gt; &gt; 3.3,
&gt; &gt; 3.4&#41;;&#34;&#41;;
&gt; &gt;  $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;4.1, 4.2,
&gt; &gt; 4.3,
&gt; &gt; 4.4&#41;;&#34;&#41;;
&gt; &gt;
&gt; &gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT t1, t2, t3, t4 FROM test_table;&#34;&#41;;
&gt; &gt;
&gt; &gt; $sth-&gt;execute&#40;&#41;;
&gt; &gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt; &gt;    splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is used
&gt; &gt; above
&gt; &gt;     push @data, [ @$row_ref ];      # -- trying to copy array after
&gt; &gt; splice kills perl
&gt; &gt;     #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41;
&gt; &gt; solution:
&gt; &gt; splice on copy of array
&gt; &gt; }
&gt; &gt;
&gt; &gt; for &#40;my $i = 0; $i &lt; scalar @data; $i++&#41; {
&gt; &gt;    print join &#34;, &#34;, @{$data[$i]};
&gt; &gt;    print &#34;\n&#34;;
&gt; &gt; }
&gt; &gt;
&gt; &gt; On 27-Dec-18 22:05, Kenichi Ishigaki via RT wrote:
<div class="message-stanza open">&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=128121">https://rt.cpan.org/Ticket/Display.html?id=128121</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; On Fri Dec 28 04:43:05 2018, Stefan_E wrote:
<div class="message-stanza open">&gt; &gt; &gt;&gt; Thx, Ishigaki San, for providing DBD::SQLite!
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Running the following code on Strawberry perl 5.26.1 &#40;64 bit, Win
&gt; &gt; &gt;&gt; 7&#41;
&gt; &gt; &gt;&gt; crashes at the line indicated. I&#39;m currently porting some code
&gt; &gt; &gt;&gt; from
&gt; &gt; &gt;&gt; mySQL to SQLite; same code had no problem with DBD::mysql. Issue
&gt; &gt; &gt;&gt; is
&gt; &gt; &gt;&gt; reproduced with DBD::SQLite 1.54 and 1.60.
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; use strict;
&gt; &gt; &gt;&gt; use DBI;
&gt; &gt; &gt;&gt; my&#40;$dbh, $sth, @data&#41;;
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=dummy1.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt; &gt; &gt;&gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT id, f_1397, f_1398, f_1399, f_1400
&gt; &gt; &gt;&gt; FROM
&gt; &gt; &gt;&gt; myTable;&#34;&#41;;
&gt; &gt; &gt;&gt; $sth-&gt;execute&#40;&#41;;
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt; &gt; &gt;&gt;     splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is
&gt; &gt; &gt;&gt; used above
&gt; &gt; &gt;&gt;     push @data, [ @$row_ref ];      # -- trying to copy array
&gt; &gt; &gt;&gt; after
&gt; &gt; &gt;&gt; splice kills perl &#40;works without splice above&#41;
&gt; &gt; &gt;&gt;     #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41;
&gt; &gt; &gt;&gt; solution:
&gt; &gt; &gt;&gt; splice on copy of array
&gt; &gt; &gt;&gt; }
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Thx. for your consideration
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Kind regards, Stefan
&gt; &gt; &gt;&gt;
</div>&gt; &gt; &gt; Couldn&#39;t reproduce the issue under almost the same environment
&gt; &gt; &gt; &#40;64bit
&gt; &gt; &gt; Win7 + strawberry 5.26.3&#41; and a few other environments.
&gt; &gt; &gt;
&gt; &gt; &gt; Could you make the script above a little more complete? &#40;create a
&gt; &gt; &gt; table and insert necessary data, set proper attributes, etc; please
&gt; &gt; &gt; let it reproduce the issue by just running it.&#41;
&gt; &gt; &gt;
&gt; &gt; &gt; And what happens if you run the same script under other OSes &#40;in
&gt; &gt; &gt; other words, isn&#39;t it your environmental issue, rather than
&gt; &gt; &gt; DBD::SQLite&#39;s&#41;?
&gt; &gt; &gt;
&gt; &gt; &gt; .
&gt; &gt; &gt;
</div>&gt; &gt;
</div>&gt; 
&gt; Now I can reproduce the issue under both Win and Debian. Will look at
&gt; it. Thanks.
</div>

See DBI&#39;s document for fetchrow_arrayref.

    Note that the same array reference is returned for each fetch, so don&#39;t
    store the reference and then use it after a later fetch. Also, the
    elements of the array are also reused for each row, so take care if you
    want to take a reference to an element. See also &#34;bind_columns&#34;.

In this case, you splice the &#40;readonly&#41; row that will be reused for performance. The row to reuse has four elements at the first fetchrow, but it has only three at the second, which is roughly the reason of the breakage. So the solution here is don&#39;t use splice $row_ref itself.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;27&nbsp;19:04:59&nbsp;2018</span>
    <span class="description">se_misc [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #128121] fetchrow_arrayref not returning fully compatible perl array ref</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Dec 2018 00:04:33 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-DBD-SQLite [...] rt.cpan.org&#34; &lt;bug-DBD-SQLite [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stefan E &lt;se_misc [...] hotmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thx - indeed, on closer inspection, it seems to be the second 
fetchrow_arrayref which breaks.


On 27-Dec-18 23:56, Kenichi Ishigaki via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=128121">https://rt.cpan.org/Ticket/Display.html?id=128121</a></span> &gt;
&gt;
&gt; On Fri Dec 28 06:56:59 2018, ISHIGAKI wrote:
<div class="message-stanza open">&gt;&gt; On Fri Dec 28 06:47:21 2018, Stefan_E wrote:
<div class="message-stanza open">&gt;&gt;&gt; Here is a self-contained script. Sorry, I don&#39;t have access to
&gt;&gt;&gt; another
&gt;&gt;&gt; environment &#40;except for a VM with the same strawberry - btw., a
&gt;&gt;&gt; portable
&gt;&gt;&gt; installation; DBI is 1.637, but updating to 1.642 didn&#39;t help&#41;
&gt;&gt;&gt;
&gt;&gt;&gt; use strict;
&gt;&gt;&gt; use DBI;
&gt;&gt;&gt; my&#40;$dbh, $sth, @data&#41;;
&gt;&gt;&gt;
&gt;&gt;&gt; unlink &#34;test.sqlite&#34; or warn &#34;Can&#39;t erase test.sqlite&#34;;
&gt;&gt;&gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=test.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt;&gt;&gt; $dbh-&gt;do&#40;&#34;CREATE TABLE test_table &#40;
&gt;&gt;&gt;               t1   REAL default 0,
&gt;&gt;&gt;               t2   REAL default 0,
&gt;&gt;&gt;               t3   REAL default 0,
&gt;&gt;&gt;               t4   REAL default 0&#41;;&#34;&#41;;
&gt;&gt;&gt;   $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;1.1, 1.2,
&gt;&gt;&gt; 1.3,
&gt;&gt;&gt; 1.4&#41;;&#34;&#41;;
&gt;&gt;&gt;   $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;2.1, 2.2,
&gt;&gt;&gt; 2.3,
&gt;&gt;&gt; 2.4&#41;;&#34;&#41;;
&gt;&gt;&gt;   $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;3.1, 3.2,
&gt;&gt;&gt; 3.3,
&gt;&gt;&gt; 3.4&#41;;&#34;&#41;;
&gt;&gt;&gt;   $dbh-&gt;do&#40;&#34;INSERT INTO test_table &#40;t1, t2, t3, t4&#41; VALUES &#40;4.1, 4.2,
&gt;&gt;&gt; 4.3,
&gt;&gt;&gt; 4.4&#41;;&#34;&#41;;
&gt;&gt;&gt;
&gt;&gt;&gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT t1, t2, t3, t4 FROM test_table;&#34;&#41;;
&gt;&gt;&gt;
&gt;&gt;&gt; $sth-&gt;execute&#40;&#41;;
&gt;&gt;&gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt;&gt;&gt;     splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is used
&gt;&gt;&gt; above
&gt;&gt;&gt;      push @data, [ @$row_ref ];      # -- trying to copy array after
&gt;&gt;&gt; splice kills perl
&gt;&gt;&gt;      #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41;
&gt;&gt;&gt; solution:
&gt;&gt;&gt; splice on copy of array
&gt;&gt;&gt; }
&gt;&gt;&gt;
&gt;&gt;&gt; for &#40;my $i = 0; $i &lt; scalar @data; $i++&#41; {
&gt;&gt;&gt;     print join &#34;, &#34;, @{$data[$i]};
&gt;&gt;&gt;     print &#34;\n&#34;;
&gt;&gt;&gt; }
&gt;&gt;&gt;
&gt;&gt;&gt; On 27-Dec-18 22:05, Kenichi Ishigaki via RT wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=128121">https://rt.cpan.org/Ticket/Display.html?id=128121</a></span> &gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Fri Dec 28 04:43:05 2018, Stefan_E wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; Thx, Ishigaki San, for providing DBD::SQLite!
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Running the following code on Strawberry perl 5.26.1 &#40;64 bit, Win
&gt;&gt;&gt;&gt;&gt; 7&#41;
&gt;&gt;&gt;&gt;&gt; crashes at the line indicated. I&#39;m currently porting some code
&gt;&gt;&gt;&gt;&gt; from
&gt;&gt;&gt;&gt;&gt; mySQL to SQLite; same code had no problem with DBD::mysql. Issue
&gt;&gt;&gt;&gt;&gt; is
&gt;&gt;&gt;&gt;&gt; reproduced with DBD::SQLite 1.54 and 1.60.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; use strict;
&gt;&gt;&gt;&gt;&gt; use DBI;
&gt;&gt;&gt;&gt;&gt; my&#40;$dbh, $sth, @data&#41;;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; $dbh = DBI-&gt;connect&#40;&#34;DBI:SQLite:dbname=dummy1.sqlite&#34;, &#34;&#34;, &#34;&#34;&#41;;
&gt;&gt;&gt;&gt;&gt; $sth = $dbh-&gt;prepare&#40;&#34;SELECT id, f_1397, f_1398, f_1399, f_1400
&gt;&gt;&gt;&gt;&gt; FROM
&gt;&gt;&gt;&gt;&gt; myTable;&#34;&#41;;
&gt;&gt;&gt;&gt;&gt; $sth-&gt;execute&#40;&#41;;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; while &#40;my $row_ref = $sth-&gt;fetchrow_arrayref&#41; {
&gt;&gt;&gt;&gt;&gt;      splice @$row_ref, 1, 1;         # -- breaks if DBI:SQLite is
&gt;&gt;&gt;&gt;&gt; used above
&gt;&gt;&gt;&gt;&gt;      push @data, [ @$row_ref ];      # -- trying to copy array
&gt;&gt;&gt;&gt;&gt; after
&gt;&gt;&gt;&gt;&gt; splice kills perl &#40;works without splice above&#41;
&gt;&gt;&gt;&gt;&gt;      #splice @{$data[-1]}, 1, 1;     # -- alternate &#40;working&#41;
&gt;&gt;&gt;&gt;&gt; solution:
&gt;&gt;&gt;&gt;&gt; splice on copy of array
&gt;&gt;&gt;&gt;&gt; }
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thx. for your consideration
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Kind regards, Stefan
&gt;&gt;&gt;&gt;&gt;
</div>&gt;&gt;&gt;&gt; Couldn&#39;t reproduce the issue under almost the same environment
&gt;&gt;&gt;&gt; &#40;64bit
&gt;&gt;&gt;&gt; Win7 + strawberry 5.26.3&#41; and a few other environments.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Could you make the script above a little more complete? &#40;create a
&gt;&gt;&gt;&gt; table and insert necessary data, set proper attributes, etc; please
&gt;&gt;&gt;&gt; let it reproduce the issue by just running it.&#41;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; And what happens if you run the same script under other OSes &#40;in
&gt;&gt;&gt;&gt; other words, isn&#39;t it your environmental issue, rather than
&gt;&gt;&gt;&gt; DBD::SQLite&#39;s&#41;?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; .
&gt;&gt;&gt;&gt;
</div></div>&gt;&gt; Now I can reproduce the issue under both Win and Debian. Will look at
&gt;&gt; it. Thanks.
</div>&gt;
&gt; See DBI&#39;s document for fetchrow_arrayref.
&gt;
&gt;      Note that the same array reference is returned for each fetch, so don&#39;t
&gt;      store the reference and then use it after a later fetch. Also, the
&gt;      elements of the array are also reused for each row, so take care if you
&gt;      want to take a reference to an element. See also &#34;bind_columns&#34;.
&gt;
&gt; In this case, you splice the &#40;readonly&#41; row that will be reused for performance. The row to reuse has four elements at the first fetchrow, but it has only three at the second, which is roughly the reason of the breakage. So the solution here is don&#39;t use splice $row_ref itself.
&gt; .
&gt;
</div>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;28&nbsp;02:18:52&nbsp;2018</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Closed. Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;28&nbsp;02:18:53&nbsp;2018</span>
    <span class="description">ishigaki [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
