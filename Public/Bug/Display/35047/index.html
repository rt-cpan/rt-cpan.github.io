<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #35047 for Data-SExpression: [PATCH] Makefile.PL portability suggestion</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #35047 for Data-SExpression: [PATCH] Makefile.PL portability suggestion</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Data-SExpression">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Data-SExpression">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Data-SExpression">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Data-SExpression">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Data-SExpression">Data-SExpression CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">35047</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Data-SExpression">Data-SExpression</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ANDK [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-40404-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.36    </td>
  </tr>
  <tr id="CF-40405-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=35047">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-448993" href="/Public/Bug/Display.html?id=35047#txn-448993">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;14&nbsp;23:02:59&nbsp;2008</span>
    <span class="description">ANDK [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Makefile.PL protability suggestion</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/448993/220534/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/220534">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">In my environment the Makefile.PL fails because it doesn&#39;t find yapp
although Parse::Yapp is installed.

May I suggest to replace the requires_external_bin line and calculate
the path to yapp manually?

This ensures that the perl that builds the Module and the one that tests
it are the same. And it helps to find our own yapp even if not in the path.

I&#39;ve left the fallback to the requires_external_bin line in in case we
find no yapp in the expected directory.

The configure_requires promises that the yapp already is there when
Makefile.PL is executed because installers are bound to read the META.yml.

What do you think?

Here is the patch:

--- Makefile.PL~        2008-04-10 00:37:39.000000000 +0200
+++ Makefile.PL 2008-04-15 05:00:18.000000000 +0200
@@ -1,19 +1,27 @@
 use inc::Module::Install;
 
+use Config;
+use File::Spec;
+
 name&#40;&#39;Data-SExpression&#39;&#41;;
 license&#40;&#39;Perl&#39;&#41;;
 
 version_from&#40;&#39;lib/Data/SExpression.pm&#39;&#41;;
 
 requires&#40;&#39;Class::Accessor::Fast&#39;&#41;;
-requires&#40;&#39;Parse::Yapp&#39;&#41;;
+configure_requires&#40;&#39;Parse::Yapp&#39;&#41;;
 
 build_requires&#40;&#39;Test::More&#39;&#41;;
 build_requires&#40;&#39;Test::Deep&#39;&#41;;
 
-requires_external_bin&#40;&#39;yapp&#39;&#41;;
+# 
+my $yapp = File::Spec-&gt;catfile&#40;$Config{scriptdirexp},&#34;yapp&#34;&#41;;
+unless &#40;-e $yapp&#41; {
+    requires_external_bin&#40;&#39;yapp&#39;&#41;;
+    $yapp = &#34;yapp&#34;;
+}
 
-system&#40;&#39;yapp -m Data::SExpression::Parser -o
lib/Data/SExpression/Parser.pm lib/Data/SExpression/Parser.yp&#39;&#41;
+system&#40;&#34;$yapp -m Data::SExpression::Parser -o
lib/Data/SExpression/Parser.pm lib/Data/SExpression/Parser.yp&#34;&#41;
   and die&#40;&#34;Failed: Unable to create Data::SExpression::Parser &#40;Is
Parse::Yapp appropriately installed on your system?&#41;&#34;&#41;;
 
 WriteAll;




Thanks,
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-448996" href="/Public/Bug/Display.html?id=35047#txn-448996">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;14&nbsp;23:03:43&nbsp;2008</span>
    <span class="description">ANDK [...] cpan.org -  Subject changed from &#39;[PATCH] Makefile.PL protability suggestion&#39; to &#39;[PATCH] Makefile.PL portability suggestion&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-449328" href="/Public/Bug/Display.html?id=35047#txn-449328">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;15&nbsp;10:44:13&nbsp;2008</span>
    <span class="description">nelhage [...] mit.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #35047] [PATCH] Makefile.PL protability suggestion</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 15 Apr 2008 10:43:37 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Andreas Koenig via RT &lt;bug-Data-SExpression [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Nelson Elhage &lt;nelhage [...] MIT.EDU&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/449328/220713/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/220713">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is interesting. So your system has `yapp&#39; installed outside of
$PATH? It seems like this should perhaps be a patch to M::I so that
requires_external_bin also looks in $Config{scriptdirexp}. I&#39;m
hesitant to trawl specific paths for binaries myself, since I feel
that the infrastructure should know how to do that.

In any case, the current system of running yapp during Makefile.PL is
poor because
&#40;1&#41;  `make&#39; does not cause changes to Parser.yp
     to be reflected in Parser.pm, and

&#40;2&#41; It breaks automatic dependency following, because if Parse::Yapp
    is uninstalled, the build fails, rather than M::I trying to
    install it. The config_requires change may fix that latter,
    however.

Anyways, I was thinking of replacing the requires_external_bin and
system&#40;&#41; lines with something like:

postamble&#40;&lt;&lt;&#34;END_MAKEFILE&#34;&#41;;
lib/Data/SExpression/Parser.pm: lib/Data/SExpression/Parser.yp
\tyapp -m Data::SExpression::Parser -o \$@ \$&lt;
END_MAKEFILE

which causes a rule to get written to Makefile to generate Parser.pm.

I take it that would also not work on your system, however, due to
yapp not being in $PATH?

- Nelsonx

On Mon, Apr 14, 2008 at 11:03:00PM -0400, Andreas Koenig via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Mon Apr 14 23:02:59 2008: Request 35047 was acted upon.
&gt; Transaction: Ticket created by ANDK
&gt;        Queue: Data-SExpression
&gt;      Subject: [PATCH] Makefile.PL protability suggestion
&gt;    Broken in: 0.36
&gt;     Severity: Normal
&gt;        Owner: Nobody
&gt;   Requestors: ANDK@cpan.org
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=35047">http://rt.cpan.org/Ticket/Display.html?id=35047</a></span> &gt;
&gt; 
&gt; 
&gt; In my environment the Makefile.PL fails because it doesn&#39;t find yapp
&gt; although Parse::Yapp is installed.
&gt; 
&gt; May I suggest to replace the requires_external_bin line and calculate
&gt; the path to yapp manually?
&gt; 
&gt; This ensures that the perl that builds the Module and the one that tests
&gt; it are the same. And it helps to find our own yapp even if not in the path.
&gt; 
&gt; I&#39;ve left the fallback to the requires_external_bin line in in case we
&gt; find no yapp in the expected directory.
&gt; 
&gt; The configure_requires promises that the yapp already is there when
&gt; Makefile.PL is executed because installers are bound to read the META.yml.
&gt; 
&gt; What do you think?
&gt; 
&gt; Here is the patch:
&gt; 
&gt; --- Makefile.PL~        2008-04-10 00:37:39.000000000 +0200
&gt; +++ Makefile.PL 2008-04-15 05:00:18.000000000 +0200
&gt; @@ -1,19 +1,27 @@
&gt;  use inc::Module::Install;
&gt;  
&gt; +use Config;
&gt; +use File::Spec;
&gt; +
&gt;  name&#40;&#39;Data-SExpression&#39;&#41;;
&gt;  license&#40;&#39;Perl&#39;&#41;;
&gt;  
&gt;  version_from&#40;&#39;lib/Data/SExpression.pm&#39;&#41;;
&gt;  
&gt;  requires&#40;&#39;Class::Accessor::Fast&#39;&#41;;
&gt; -requires&#40;&#39;Parse::Yapp&#39;&#41;;
&gt; +configure_requires&#40;&#39;Parse::Yapp&#39;&#41;;
&gt;  
&gt;  build_requires&#40;&#39;Test::More&#39;&#41;;
&gt;  build_requires&#40;&#39;Test::Deep&#39;&#41;;
&gt;  
&gt; -requires_external_bin&#40;&#39;yapp&#39;&#41;;
&gt; +# 
&gt; +my $yapp = File::Spec-&gt;catfile&#40;$Config{scriptdirexp},&#34;yapp&#34;&#41;;
&gt; +unless &#40;-e $yapp&#41; {
&gt; +    requires_external_bin&#40;&#39;yapp&#39;&#41;;
&gt; +    $yapp = &#34;yapp&#34;;
&gt; +}
&gt;  
&gt; -system&#40;&#39;yapp -m Data::SExpression::Parser -o
&gt; lib/Data/SExpression/Parser.pm lib/Data/SExpression/Parser.yp&#39;&#41;
&gt; +system&#40;&#34;$yapp -m Data::SExpression::Parser -o
&gt; lib/Data/SExpression/Parser.pm lib/Data/SExpression/Parser.yp&#34;&#41;
&gt;    and die&#40;&#34;Failed: Unable to create Data::SExpression::Parser &#40;Is
&gt; Parse::Yapp appropriately installed on your system?&#41;&#34;&#41;;
&gt;  
&gt;  WriteAll;
&gt; 
&gt; 
&gt; 
&gt; 
&gt; Thanks,
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-449329" href="/Public/Bug/Display.html?id=35047#txn-449329">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;15&nbsp;10:44:16&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-449520" href="/Public/Bug/Display.html?id=35047#txn-449520">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;15&nbsp;16:44:51&nbsp;2008</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> ANDK [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #35047] [PATCH] Makefile.PL protability suggestion</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 15 Apr 2008 22:44:27 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Data-SExpression [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andreas.koenig.7os6VVqR [...] franz.ak.mind.de &#40;Andreas J. Koenig&#41;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/449520/220831/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/220831">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; On Tue, 15 Apr 2008 10:44:16 -0400, &#34;Nelson Elhage via RT&#34; &lt;bug-Data-SExpression@rt.cpan.org&gt; said:
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; This is interesting. So your system has `yapp&#39; installed outside of
  &gt; $PATH?
</div>
Yes. My system usually has something like several 100 different perl
versions installed. Of course they are not in $PATH.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; It seems like this should perhaps be a patch to M::I so that
  &gt; requires_external_bin also looks in $Config{scriptdirexp}.
</div>
That would be quite complicated because it would have to provide a
return value, so it&#39;s a major interface change. And progress on MI
tends to be slow.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I&#39;m
  &gt; hesitant to trawl specific paths for binaries myself, since I feel
  &gt; that the infrastructure should know how to do that.
</div>
I understand your sentiment:&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; In any case, the current system of running yapp during Makefile.PL is
  &gt; poor because
  &gt; &#40;1&#41;  `make&#39; does not cause changes to Parser.yp
  &gt;      to be reflected in Parser.pm, and
</div>
Good point.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; &#40;2&#41; It breaks automatic dependency following, because if Parse::Yapp
  &gt;     is uninstalled, the build fails, rather than M::I trying to
  &gt;     install it. The config_requires change may fix that latter,
  &gt;     however.
</div>
Yes, it&#39;s always better to not have to die during Makefile.PL.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Anyways, I was thinking of replacing the requires_external_bin and
  &gt; system&#40;&#41; lines with something like:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; postamble&#40;&lt;&lt;&#34;END_MAKEFILE&#34;&#41;;
  &gt; lib/Data/SExpression/Parser.pm: lib/Data/SExpression/Parser.yp
  &gt; \tyapp -m Data::SExpression::Parser -o \$@ \$&lt;
  &gt; END_MAKEFILE
</div>
Very nice but....

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; which causes a rule to get written to Makefile to generate Parser.pm.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I take it that would also not work on your system, however, due to
  &gt; yapp not being in $PATH?
</div>
Unfortunately Yes.

I have a job that calls &#34;slaymake&#34; like so:

    `echo $&#40;PERL&#41; | sed -e &#39;s/perl$$/slaymake/&#39;`

It seems to be working well. Maybe you could do some equivalent for yapp?

Or maybe Parse::Yapp has a shortcut available that is just a 

    $&#40;PERL&#41; -MParse::Yapp -e &#39;...&#39;

???

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-450073" href="/Public/Bug/Display.html?id=35047#txn-450073">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;16&nbsp;17:01:22&nbsp;2008</span>
    <span class="description">nelhage [...] mit.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/450073/221119/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/221119">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 683b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I just CPAN&#39;d 0.38, which should have a working solution.

It uses a script in build/ in the dist to rebuild Parser.pm, using
Parse::Yapp&#39;s perl API, instead of yapp. &#40;I made it a separate script
because it&#39;s somewhat longer than a one-liner&#41;.

In addition, I&#39;m now generating &#34;standalone&#34; parsers, so
Data::SExpression no longer has Parse::Yapp as a run-time _or_
build-time dependency, although if you _do_ have it installed, the build
will automatically notice and rebuild Parser.pm from Parser.yp when needed.

Let me know if this breaks for any other reason in your environment;
I&#39;ve tested it on a couple of machines of my own with a few perls and
with and without Parse::Yapp.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-450075" href="/Public/Bug/Display.html?id=35047#txn-450075">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;16&nbsp;17:01:26&nbsp;2008</span>
    <span class="description">nelhage [...] mit.edu -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.386931</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
