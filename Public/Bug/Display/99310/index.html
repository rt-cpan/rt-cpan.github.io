<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #99310 for Module-CPANTS-Analyse: .pm files should be inspected from blib, not lib, to account for filters</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #99310 for Module-CPANTS-Analyse: .pm files should be inspected from blib, not lib, to account for filters</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Module-CPANTS-Analyse/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Module-CPANTS-Analyse/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Module-CPANTS-Analyse/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Module-CPANTS-Analyse/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Module-CPANTS-Analyse">Module-CPANTS-Analyse CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">99310</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Module-CPANTS-Analyse/Active/">Module-CPANTS-Analyse</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ether [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38184-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38185-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;04&nbsp;15:38:37&nbsp;2014</span>
    <span class="description">ether [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> .pm files should be inspected from blib, not lib, to account for
 filters</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The PM_FILTER option in Makefile.PL can be used to construct .pm files from other sources, or modify their content, before the modules are installed.  It is this final content that should be analysed for the various metrics, rather than the raw files shipped in lib/ in the distribution.

One example is <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/lib-with-preamble">https://metacpan.org/release/lib-with-preamble</a></span> -- lib/lib/with/preamble.pm does not contain &#39;use strict&#39;, but &#39;blib/lib/lib/with/preamble.pm&#39; does. It is the blib/ version that is installed, so it is this version that should be inspected for the metrics.

I think MCA should either:
- always run &#39;perl Makefile.PL &#38;&#38; make&#39; before inspecting the distribution, or
- check Makefile.PL for &#34;PM_FILTER&#34; &#40;I&#39;m not sure what the equivalent Build.PL option is&#41; and run &#39;perl Makefile.PL &#38;&#38; make&#39; if the option is seen.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;05&nbsp;02:09:00&nbsp;2014</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Oct 05 04:38:37 2014, ETHER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The PM_FILTER option in Makefile.PL can be used to construct .pm files
&gt; from other sources, or modify their content, before the modules are
&gt; installed.  It is this final content that should be analysed for the
&gt; various metrics, rather than the raw files shipped in lib/ in the
&gt; distribution.
&gt; 
&gt; One example is <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/lib-with-preamble">https://metacpan.org/release/lib-with-preamble</a></span> --
&gt; lib/lib/with/preamble.pm does not contain &#39;use strict&#39;, but
&gt; &#39;blib/lib/lib/with/preamble.pm&#39; does. It is the blib/ version that is
&gt; installed, so it is this version that should be inspected for the
&gt; metrics.
&gt; 
&gt; I think MCA should either:
&gt; - always run &#39;perl Makefile.PL &#38;&#38; make&#39; before inspecting the
&gt; distribution, or
&gt; - check Makefile.PL for &#34;PM_FILTER&#34; &#40;I&#39;m not sure what the equivalent
&gt; Build.PL option is&#41; and run &#39;perl Makefile.PL &#38;&#38; make&#39; if the option
&gt; is seen.
</div>
Running Makefile.PL can&#39;t &#40;and won&#39;t&#41; be an option for MCA because there are distributions whose Makefile.PL runs only on a specific environment &#40;OS, external libraries, etc&#41;. Besides, PM_FILTER is not the only option to modify contents of .pm files &#40;PL_FILES, raw perl code in Makefile.PL, or maybe Dist::Zilla plugins can modify code for local sources&#41;. It&#39;s not reasonable for MCA to take each of those minor options into consideration.

As for blib, 1&#41; it conflicts with no_generated_files metric, and 2&#41; MCA needs more refactoring before blib check can be added cleanly.

Marked stalled for the latter.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;05&nbsp;02:09:00&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;05&nbsp;02:09:01&nbsp;2014</span>
    <span class="description">ishigaki [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;03&nbsp;03:06:19&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The search algorithm should - however - refined:

MooX-Cmd sno$ perl -Mblib xt/kwalitee.t
ok 1 - meta_json_conforms_to_known_spec
ok 2 - meta_json_is_parsable
ok 3 - meta_yml_conforms_to_known_spec
ok 4 - meta_yml_is_parsable
ok 5 - has_buildtool
ok 6 - has_changelog
ok 7 - has_manifest
ok 8 - has_meta_yml
ok 9 - has_readme
ok 10 - has_tests
ok 11 - no_symlinks
ok 12 - no_broken_auto_install
ok 13 - no_broken_module_install
ok 14 - has_human_readable_license
ok 15 - has_license_in_source_file
ok 16 - has_abstract_in_pod
not ok 17 - use_strict
#   Failed test &#39;use_strict&#39;
#   at xt/kwalitee.t line 11.
# Error: This distribution does not &#39;use strict;&#39; &#40;or its equivalents&#41; in all of its modules. Note that this is not about the actual strictness of the modules. It&#39;s bad if nobody can tell whether the modules are strictly written or not, without reading the source code of your favorite clever module that actually enforces strictness. In other words, it&#39;s bad if someone feels the need to add &#39;use strict&#39; to your modules.
# Details:
# The following modules don&#39;t use strict &#40;or equivalents&#41;: SecondTestApp::Cmd::ifc, ThirdTestApp, ThirdTestApp::Cmd::Foo, SecondTestApp::Cmd::cwo, FailTestApp::Cmd::nothing, FirstTestApp, OptionTestApp::Cmd::Oops, FirstTestApp::Cmd::Test, FirstTestApp::Cmd::Test::Cmd::Test, SecondTestApp
# SecondTestApp::Cmd::ifc, ThirdTestApp, ThirdTestApp::Cmd::Foo, SecondTestApp::Cmd::cwo, FailTestApp::Cmd::nothing, FirstTestApp, OptionTestApp::Cmd::Oops, FirstTestApp::Cmd::Test, FirstTestApp::Cmd::Test::Cmd::Test, SecondTestApp
# Remedy: Add &#39;use strict&#39; &#40;or its equivalents&#41; to all modules, or convince us that your favorite module is well-known enough and people can easily see the modules are strictly written.
1..17
# Looks like you failed 1 test of 17.

All those affected modules are in t/lib - nothing which is scanned for modules &#40;and most of them are intensionally without &#34;use strict;&#34;&#41;.

When running Makefile.PL is not an option, scanning blib is an option - or relying on MANIFEST. You can still fallback to current behavior when both better options fail to apply.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;03&nbsp;03:06:19&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;03&nbsp;03:42:51&nbsp;2014</span>
    <span class="description">ishigaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Could you tell me the versions of Module::CPANTS::Analyse and Test::Kwalitee you are using, and try the latest versions of both &#40;if not&#41;?

On Wed Dec 03 17:06:19 2014, REHSACK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The search algorithm should - however - refined:
&gt; 
&gt; MooX-Cmd sno$ perl -Mblib xt/kwalitee.t
&gt; ok 1 - meta_json_conforms_to_known_spec
&gt; ok 2 - meta_json_is_parsable
&gt; ok 3 - meta_yml_conforms_to_known_spec
&gt; ok 4 - meta_yml_is_parsable
&gt; ok 5 - has_buildtool
&gt; ok 6 - has_changelog
&gt; ok 7 - has_manifest
&gt; ok 8 - has_meta_yml
&gt; ok 9 - has_readme
&gt; ok 10 - has_tests
&gt; ok 11 - no_symlinks
&gt; ok 12 - no_broken_auto_install
&gt; ok 13 - no_broken_module_install
&gt; ok 14 - has_human_readable_license
&gt; ok 15 - has_license_in_source_file
&gt; ok 16 - has_abstract_in_pod
&gt; not ok 17 - use_strict
&gt; #   Failed test &#39;use_strict&#39;
&gt; #   at xt/kwalitee.t line 11.
&gt; # Error: This distribution does not &#39;use strict;&#39; &#40;or its equivalents&#41;
&gt; in all of its modules. Note that this is not about the actual
&gt; strictness of the modules. It&#39;s bad if nobody can tell whether the
&gt; modules are strictly written or not, without reading the source code
&gt; of your favorite clever module that actually enforces strictness. In
&gt; other words, it&#39;s bad if someone feels the need to add &#39;use strict&#39; to
&gt; your modules.
&gt; # Details:
&gt; # The following modules don&#39;t use strict &#40;or equivalents&#41;:
&gt; SecondTestApp::Cmd::ifc, ThirdTestApp, ThirdTestApp::Cmd::Foo,
&gt; SecondTestApp::Cmd::cwo, FailTestApp::Cmd::nothing, FirstTestApp,
&gt; OptionTestApp::Cmd::Oops, FirstTestApp::Cmd::Test,
&gt; FirstTestApp::Cmd::Test::Cmd::Test, SecondTestApp
&gt; # SecondTestApp::Cmd::ifc, ThirdTestApp, ThirdTestApp::Cmd::Foo,
&gt; SecondTestApp::Cmd::cwo, FailTestApp::Cmd::nothing, FirstTestApp,
&gt; OptionTestApp::Cmd::Oops, FirstTestApp::Cmd::Test,
&gt; FirstTestApp::Cmd::Test::Cmd::Test, SecondTestApp
&gt; # Remedy: Add &#39;use strict&#39; &#40;or its equivalents&#41; to all modules, or
&gt; convince us that your favorite module is well-known enough and people
&gt; can easily see the modules are strictly written.
&gt; 1..17
&gt; # Looks like you failed 1 test of 17.
&gt; 
&gt; All those affected modules are in t/lib - nothing which is scanned for
&gt; modules &#40;and most of them are intensionally without &#34;use strict;&#34;&#41;.
&gt; 
&gt; When running Makefile.PL is not an option, scanning blib is an option
&gt; - or relying on MANIFEST. You can still fallback to current behavior
&gt; when both better options fail to apply.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;08&nbsp;04:57:31&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">MooX-Cmd sno$ perl -MModule::CPANTS::Analyse -MTest::Kwalitee= -le &#39;print Module::CPANTS::Analyse-&gt;VERSION; print Test::Kwalitee-&gt;VERSION&#39;
[...]
0.96
1.22
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
