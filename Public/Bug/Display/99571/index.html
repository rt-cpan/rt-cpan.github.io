<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #99571 for Net-DNS: AXFR BADSIG failures</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #99571 for Net-DNS: AXFR BADSIG failures</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Net-DNS">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Net-DNS">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Net-DNS">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Net-DNS">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">99571</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Net-DNS">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
tlhackque [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.80    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=99571">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1421979" href="/Public/Bug/Display.html?id=99571#txn-1421979">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;18&nbsp;08:31:52&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AXFR BADSIG failures</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1421979/755086/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755086">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 86.2k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1421984" href="/Public/Bug/Display.html?id=99571#txn-1421984">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;18&nbsp;08:50:43&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AXFR BADSIG failures - short form</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1421984/755091/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755091">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 811b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Oct 18 08:31:52 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am seeing BADSIG failures from AXFR using TSIG.
&gt; 
&gt; It appears that the validation code for TSIG is not verifying the data
&gt; received from the wire, but is attempting to reconstruct it from the
&gt; decoded data.  This is problematic because while the result will be
&gt; semantically equivalent, it need not be bit-for-bit identical.  In
&gt; this case, due to compression.
&gt; 
&gt; The code needs to be changed to preserve the original data received
&gt; from the wire, make the RFC2848 changes &#40;adjust arcount, delete TSIG,
&gt; change msid&#41; and verify that.  Reconstructing the decoded packet will
&gt; not work reliably.
</div>
&#40;All the detail that I included made the initial report &#39;too large to display&#39;; it&#39;s not spam can can be downloaded and viewed.&#41;

It&#39;s a rather nasty bug.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422140" href="/Public/Bug/Display.html?id=99571#txn-1422140">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;18&nbsp;20:17:48&nbsp;2014</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422140/755175/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755175">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 649b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Oct 18 08:50:43 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sat Oct 18 08:31:52 2014, tlhackque wrote:
<div class="message-stanza open">&gt; &gt; I am seeing BADSIG failures from AXFR using TSIG.
&gt; &gt;
&gt; &gt; It appears that the validation code for TSIG is not verifying the
&gt; &gt; data
&gt; &gt; received from the wire, but is attempting to reconstruct it from the
&gt; &gt; decoded data.  This is problematic because while the result will be
&gt; &gt; semantically equivalent, it need not be bit-for-bit identical.
</div></div>
I was hoping you would send me something more directly machine-readable to decode.  But no matter, I can see what is driving this and have reconstructed an example which fails in the way that you observe.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422141" href="/Public/Bug/Display.html?id=99571#txn-1422141">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;18&nbsp;20:17:49&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422216" href="/Public/Bug/Display.html?id=99571#txn-1422216">#</a>      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;19&nbsp;06:32:07&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422216/755216/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755216">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Oct 18 20:17:48 2014, rwfranks@acm.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sat Oct 18 08:50:43 2014, tlhackque wrote:
<div class="message-stanza open">&gt; &gt; On Sat Oct 18 08:31:52 2014, tlhackque wrote:
<div class="message-stanza open">&gt; &gt; &gt; I am seeing BADSIG failures from AXFR using TSIG.
&gt; &gt; &gt;
&gt; &gt; &gt; It appears that the validation code for TSIG is not verifying the
&gt; &gt; &gt; data
&gt; &gt; &gt; received from the wire, but is attempting to reconstruct it from
&gt; &gt; &gt; the
&gt; &gt; &gt; decoded data.  This is problematic because while the result will be
&gt; &gt; &gt; semantically equivalent, it need not be bit-for-bit identical.
</div></div>&gt; 
&gt; I was hoping you would send me something more directly machine-
&gt; readable to decode.  But no matter, I can see what is driving this and
&gt; have reconstructed an example which fails in the way that you observe.
</div>
Thanks for looking at this.

I included the zone file, the data received from the wire, and the data reconstructed by Net::DNS. All are in the debug output. 

For a set of local reasons &#40;switches, software versions&#41;, I couldn&#39;t get you a pcap file.  In any case, decoders tend to hide the problem because the interpreted output is identical.

It should be easy to take my zone data and serve it from BIND - that should exactly reproduce my problem case.  It&#39;s independent of the signing key.  Otherwise, I&#39;m not sure what you&#39;d like.  It would be simple enough to take the wire data dump and encode it into any binary format that you need...  Or I guess I could write a binary file instead of the ASCII dump.

BTW, I don&#39;t think that this issue isn&#39;t restricted to axfr&#40;&#41; - the same thing can happen with normal queries.

I thought about this some on a walk yesterday; probably the thing to do is to keep the wire binary data on a per-record basis as it is decoded.  That will allow easy removal of the TSIG record.  Unfortunately, this means double the memory usage.  Perhaps this can be done selectively, e.g. note when a request is signed at send&#40;&#41; time; if it is, the response may be signed &#40;except for a couple of error conditions, MUST be&#41;, so we can save the wire data only when the request was signed.

It&#39;s an error to receive a signed response to an unsigned request, so this is safe.

Let me know if there&#39;s anything more I can do to help.

Thanks again.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422238" href="/Public/Bug/Display.html?id=99571#txn-1422238">#</a>      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;19&nbsp;09:39:00&nbsp;2014</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422238/755227/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755227">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 523b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Oct 19 06:32:07 2014, tlhackque wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It should be easy to take my zone data and serve it from BIND - that
&gt; should exactly reproduce my problem case.  It&#39;s independent of the
&gt; signing key.
</div>
With the benefit of 20-20 hindsight, that is probably what we should have done at the outset.

Now proposing to capture the raw packet at decode&#40;&#41; time, and release it at verify&#40;&#41; time. Automating TSIG verification on queries then becomes quite attractive from the storage management point of view.

Thanks for your help
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422454" href="/Public/Bug/Display.html?id=99571#txn-1422454">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;20&nbsp;05:41:48&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422454/755346/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755346">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Oct 19 09:39:00 2014, rwfranks@acm.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sun Oct 19 06:32:07 2014, tlhackque wrote:
&gt; 
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Now proposing to capture the raw packet at decode&#40;&#41; time, and release
&gt; it at verify&#40;&#41; time. Automating TSIG verification on queries then
&gt; becomes quite attractive from the storage management point of view.
&gt; 
</div>That sounds good.  As I noted, since the raw data is only needed for TSIG, no need to capture it unless the request was signed.  That will save storage in many applications, where TSIG isn&#39;t used.

I do like the idea of automating verification for non-axfr queries too.  I&#39;m uncomfortable with the current scheme&#39;s inconsistency - automatic for axfr and manual for others.  Plus the RFCs are pretty strict about when to verify&#40;&#41;.  There are some corner cases involving errors - and it would be simpler for clients if those decisions were made in Net::DNS rather than having the client have to code for them.  

Releasing the wire data in verify&#40;&#41; does require some extra work: you have to save the verify result in case anyone calls verify&#40;&#41; more than once on a response.  &#40;May not seem reasonable, but I can imagine code paths that fall into it. Plus it enables the next suggestion.&#41;

For people who want fine control, I suggest an $resolver-&gt;verify_tsig&#40;0&#41; to turn automatic verification off.  &#40;Since the RFC behavior is to do it, the default should be on.&#41;  In that case, you would still do the verification on receipt and save the result, but not signal or return an error unless verify&#40;&#41; is called.  With this approach, you&#39;d always release the storage and still have a compatible API for any current users.

Thanks for taking this on so promptly, especially on a weekend.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422456" href="/Public/Bug/Display.html?id=99571#txn-1422456">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;20&nbsp;06:08:52&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> SIG?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422456/755348/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755348">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 188b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I don&#39;t use it, but I noticed that the code checks for SIG&#40;0&#41; as well.  It probably has the same issue of requiring raw data...

I haven&#39;t investigated, but thought I should mention it...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422521" href="/Public/Bug/Display.html?id=99571#txn-1422521">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;20&nbsp;13:32:51&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AXFR BADSIG failures - simplification</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422521/755383/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755383">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Another walk produced a simplification that you might consider.  

By always computing the MAC in receive, it&#39;s not necessary to save the wire data for verify&#40;&#41;.  Here&#39;s how:

Dependencies:

RFC2845: 4.2, 4.3

An unsigned request may not produce a signed response.  &#40;A signed response is a FORMERR, and discarded. 4.6&#41;

A signed request will produce a response with a TSIG.  &#40;Otherwise, FORMERR and discarded. 4.6&#41;.  The response must be signed, EXCEPT if a BADSIG &#40;4.5.3&#41; or BADKEY &#40;4.5.1&#41;.  

RFC2931:

A packet may be either TSIG or SIG&#40;0&#41; signed.  Not both.  And not more than one xSIG record for transaction signature.  &#40;2.1, 3.1, appendix, 2845 3.2&#41;

There SHOULD be configuration option for whether or not to validate &#40;2.4&#41;

The xSIG record used for transaction signature must be the last record of a packet. &#40;3.2, 2845 3.2&#41;

Observation:

Given the above, the verification result can always be computed at the end of decoding a received message.

The only data that decode&#40;&#41; needs to save is the offset of the last record decoded &#40;which will be the xSIG if one is present&#41;.

On return from decode, we still have the data received from the wire in the original buffer.

If the packet is signed &#40;per rules above&#41;:

  The header is reconstructed &#40;or modified; the offsets are fixed&#41; to decrement arcount and fixup the ID.

  The MAC is computed on the prefix + reconstructed &#40;or modified&#41; header + the wire data up to the saved offset.  This excludes the SIG record from the MAC. &#39;prefix&#39; depends on the sig type - TSIG is request MAC; SIG&#40;0&#41; is rdata + query or rdata

  The resulting MAC is saved.

The wire data can be discarded.

Any error is saved &#40;whether or not signed&#41;.

verify&#40;&#41; uses the saved MAC &#38; error state.  It should be called automatically, but errors aren&#39;t reported if the config option [$resolver-&gt;autoverify&#40;0&#41;] has explicitly turned it off.  It can be called multiple times since it does not need the wire data.  So a user of the old API &#40;which required an explicit call to verify&#40;&#41;&#41; will simply get the status.  This will be a cheap call since the MAC is available.

The doc for verify&#40;&#41; gets updated to indicate that calling it is implicit, unless $resolver-&gt;auto_verify&#40;0&#41; is called.

For axfr multi-packet with auto_verify&#40;0&#41;, verify&#40;&#41; after axfr&#40;&#41; can return the verification result.  But the internal calls won&#39;t signal an error if auto_verify&#40;0&#41; was set.

I think this avoids the storage penalty, makes verification automatic for a simple client interface, and allows a client that wants to manually verify to do so - even with axfr&#40;&#41;.

The only penalty is that the MAC is computed for a signed message even if auto_verify&#40;0&#41; is set and verify&#40;&#41; is never called by the user.  Since this is an unusual case, it seems acceptable.  &#40;auto_verify&#40;1&#41; is the default, and it should be turned off only if a server is broken, Net::DNS is broken, or the user is doing something strange, like DNS testing.&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422560" href="/Public/Bug/Display.html?id=99571#txn-1422560">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;20&nbsp;15:09:55&nbsp;2014</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422560/755407/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755407">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 20 13:32:51 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Another walk produced a simplification that you might consider.
&gt; 
&gt; By always computing the MAC in receive, it&#39;s not necessary to save the
&gt; wire data for verify&#40;&#41;.
</div>
Not so fast!

The decoder _cannot_ compute the MAC on a response packet because that part of the code does not know anything about the query which produced the response, or the previous packet in a multi-packet response.

Computing the MAC requires knowledge of the request MAC or prior MAC. If you look how the axfr&#40;&#41; routine does the validation, you will note that the required state information is carried forward by creating a clone of the TSIG which is returned by verify&#40;&#41; and fed to the next verify&#40;&#41; call.

This code was not so much written as evolved in response to discussion and bug reports. There is a trail of abject failure going back years.

I have just read RFC2931 again, and it seems to me SIG&#40;0&#41; ought to follow a similar pattern. Not least because Packet has no need to know if it verifies TSIG or SIG&#40;0&#41; 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1422751" href="/Public/Bug/Display.html?id=99571#txn-1422751">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;21&nbsp;06:12:15&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1422751/755522/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/755522">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 20 15:09:55 2014, rwfranks@acm.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Oct 20 13:32:51 2014, tlhackque wrote:
<div class="message-stanza open">&gt; &gt; Another walk produced a simplification that you might consider.
&gt; &gt;
&gt; &gt; By always computing the MAC in receive, it&#39;s not necessary to save
&gt; &gt; the
&gt; &gt; wire data for verify&#40;&#41;.
</div>&gt; 
&gt; Not so fast!
&gt; 
&gt; The decoder _cannot_ compute the MAC on a response packet because that
&gt; part of the code does not know anything about the query which produced
&gt; the response, or the previous packet in a multi-packet response.
&gt; 
</div>I said &#39;receive&#39;, not &#39;decode&#39; for computing the MAC.  Meaning the caller of decode after decode returns.  Actually, the caller of Packet-&gt;&#40;new, create -- I don&#39;t have the code handy.&#41;  The wire data is still there; the decoded version lets you determine if there&#39;s a SIG/error.  

All the decoder needs to do is save/return the offset of the last record it decodes.  It doesn&#39;t need to know what that record is, or even what section it is in - the caller just needs the offset so if *it* decides to &#39;remove&#39; the last record, it knows where that record starts in the undecoded bytestream.  This suffices because *if* the record will be &#39;removed&#39; &#40;by length or substr&#41; for the MAC computation, it MUST be the last record.  It&#39;s just the end marker for the wire data going into MAC.

The logic to use the offset/compute the MAC can be a call into xSIG:: that provides the wire data buffer, decoded packet &#38; last record decoded offset.  

Those classes do know what goes into their MAC, and can keep whatever context they need in private data attached to their record and/or stashed in the resolver by the caller.  E.g. xSIG::process_transaction always gets called if the last decoded record is an xSIG.  The TSIG/SIG class can easily figure out if the MAC is needed using the decoded Packet &#38; compute it using the wire data, saving the results for verify. &#40;Including checking that arcount &gt;1 &#38; error status, etc.&#41;

It is true that the request packet is required.

But I&#39;ll try not to think more about it on my next walk and leave the fix in your hands.  I&#39;ve probably reached the point of offering diminishing returns.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Computing the MAC requires knowledge of the request MAC or prior MAC.
&gt; If you look how the axfr&#40;&#41; routine does the validation, you will note
&gt; that the required state information is carried forward by creating a
&gt; clone of the TSIG which is returned by verify&#40;&#41; and fed to the next
&gt; verify&#40;&#41; call.
&gt; 
&gt; This code was not so much written as evolved in response to discussion
&gt; and bug reports. 
</div>That does tend to happen with long-lived software.  It&#39;s unfortunate that any approach to this bug requires re-architecting the receive/verification paths.  Of course, less re-architecting can patch it together at the price of efficiency and maintainability.  My observation was that saving/copying the wire data can be avoided with the right architecture.  Since axfr&#40;&#41; data can be &#40;very&#41; large, and other queries very frequent it seemed worth thinking about.

As you&#39;re doing the work, it&#39;s your call.  I hope that my comments have been useful.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; There is a trail of abject failure going back years.
</div>Sigh.  I didn&#39;t pay attention to this until axfr&#40;&#41; broke.  I&#39;m just a user.  

Aside from learning from the failures, then only thing to do is to stay positive and look forward.  Hopefully your current pass will be the one that finally succeeds!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I have just read RFC2931 again, and it seems to me SIG&#40;0&#41; ought to
&gt; follow a similar pattern. Not least because Packet has no need to know
&gt; if it verifies TSIG or SIG&#40;0&#41;
</div>
Agree on both counts.

Thanks again for plugging away at this.  I&#39;ll stop meddling and look forward to a release with whatever fix you decide upon.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1425306" href="/Public/Bug/Display.html?id=99571#txn-1425306">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;25&nbsp;17:42:07&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> More AXFR BADSIG failures</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1425306/757108/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/757108">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have looked at the code used to patch this, and although I haven&#39;t verified a reproducer, there still appears to be a bug.

In RR/TSIG:decode_rdata, you compute the offset of the TSIG record in the wire data as:
  my $eom = $offset - Net::DNS::RR-&gt;RRFIXEDSZ - length $self-&gt;{owner}-&gt;encode&#40;&#41;;

Again, you are assuming that encode&#40;&#41; will reproduce the wire input.  This is not valid.

I believe that if you have a compressible key name - e.g. my-key.example.net., where example.net. is used earlier in the packet, this can result in the wrong offset if Net::DNS encodes the name differently from the server.

So the only place this can be fixed is in Packet::decode - as I&#39;ve noted before.

To be a bit more explicit, I&#39;ll outline two approaches:

The simplest takes advantage of the fact that the offset of a record in wire data is only interesting for signatures, and that the signature record is always last.

The more architecturally pure version saves the offset of every record - &#39;just in case&#39;.

Rough code - in the eval { of Packet::decode&#40;&#41;:

                # question/zone section
                my $hash = {};
                my $record;
+ my $last_rec = $offset;
                while &#40; $qd-- &#41; {
+ $last_rec = $offset;
                        &#40; $record, $offset &#41; = decode Net::DNS::Question&#40; $data, $offset, $hash &#41;;
                        CORE::push&#40; @{$self-&gt;{question}}, $record &#41;;
                }

                # RR sections
                while &#40; $an-- &#41; {
+ $last_rec = $offset;
                        &#40; $record, $offset &#41; = decode Net::DNS::RR&#40; $data, $offset, $hash &#41;;
                        CORE::push&#40; @{$self-&gt;{answer}}, $record &#41;;
                }

                while &#40; $ns-- &#41; {
+ $last_rec = $offset;
                        &#40; $record, $offset &#41; = decode Net::DNS::RR&#40; $data, $offset, $hash &#41;;
                        CORE::push&#40; @{$self-&gt;{authority}}, $record &#41;;
                }

                while &#40; $ar-- &#41; {
+ $last_rec = $offset;
                        &#40; $record, $offset &#41; = decode Net::DNS::RR&#40; $data, $offset, $hash &#41;;
                        CORE::push&#40; @{$self-&gt;{additional}}, $record &#41;;
                }

+ $self-&gt;{last_rec} = $last_rec;
                return $self;
        };
...

+# Use to obtain offset of last record in packet&#39;s wire data when computing signature
+# This is the first byte of the last record decoded.  When a signature is computed,
+# this byte and all following are excluded from the data to be signed.
+# This offset INCLUDES the packet header.
+
+sub last_record_offset {
+    my $self = shift;
+    croak&#40;&#39;No saved wire data&#39;&#41; unless exists $self-&gt;{last_rec};
+    return $self-&gt;{last_rec};
+}

+# Use to obtain offset of data following header in packet&#39;s wire data
+# The data always follows the packet header.
+sub packet_data_offset {
+    return HEADER_LENGTH;
+}

Back in TSIG, you need to get the packet into decode_rdata, and change:
  my $eom = $offset - Net::DNS::RR-&gt;RRFIXEDSZ - length $self-&gt;{owner}-&gt;encode&#40;&#41;;
to
  my $eom = $packet-&gt;last_record_offset - $packet-&gt;packet_data_offset;


I don&#39;t recommend the &#39;pure&#39; version, but for that, change:
+ $last_rec = $offset;
to
+ CORE::push @{$self-&gt;{last_rec}}, $offset

and 
+    return $self-&gt;{last_rec};
to
+  return $self-&gt;{last_rec}[shift];

and in TSIG:
    my $eom  = $packet-&gt;last_record_offset&#40;-1&#41; - $packet-&gt;packet_data_offset;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1425550" href="/Public/Bug/Display.html?id=99571#txn-1425550">#</a>      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;26&nbsp;14:43:36&nbsp;2014</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1425550/757250/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/757250">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 399b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Oct 25 17:42:07 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have looked at the code used to patch this, and although I haven&#39;t
&gt; verified a reproducer
</div>
because there are none.

The owner field is always transmitted uncompressed.

Just one of the topics where RFC2845 is a bit woolly.

You could have discovered this for yourself by actually doing the experiment instead of imagining bugs which are not there.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1425729" href="/Public/Bug/Display.html?id=99571#txn-1425729">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;27&nbsp;06:11:11&nbsp;2014</span>
    <span class="description">NLNETLABS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1425729/757356/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/757356">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 237b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you tlhackque,

This issue is resolved.
You can review the changes in the repository &#40; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.net-dns.org/svn/net-dns/trunk/">http://www.net-dns.org/svn/net-dns/trunk/</a></span> &#41; or via the new release candidate tarball &#40; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.net-dns.org/download/Net-DNS-0.80_3.tar.gz">http://www.net-dns.org/download/Net-DNS-0.80_3.tar.gz</a></span> &#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1425732" href="/Public/Bug/Display.html?id=99571#txn-1425732">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;27&nbsp;06:11:16&nbsp;2014</span>
    <span class="description">NLNETLABS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.413552</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
