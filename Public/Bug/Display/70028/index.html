<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #70028 for String-Strip: String gets mangled with 8 or more characters on 64bit machine</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #70028 for String-Strip: String gets mangled with 8 or more characters on 64bit machine</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/String-Strip/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/String-Strip/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/String-Strip/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/String-Strip/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/String-Strip">String-Strip CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">70028</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/String-Strip/Active/">String-Strip</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
RWSTAUNER [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-30052-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.01    </td>
  </tr>
  <tr id="CF-30053-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;04&nbsp;21:15:22&nbsp;2011</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> String gets mangled with 8 or more characters on 64bit machine</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">At least I think that&#39;s the problem:

perl -C -MString::Strip=StripLTSpace -e &#39;@t = &#40;&#34;Foo Bar&#34;, &#34;Foo Bar1&#34;,
&#34;1234567&#34;, &#34;12345678&#34;&#41;; printf &#34;1..%d\n&#34;, scalar @t; foreach &#40;@t&#41;{ $s =
&#34; $_ &#34;; StripLTSpace&#40;$s&#41;; print &#34;not &#34; unless $s eq $_; print &#34;ok 1 #
[$e] == [$s]\n&#34;; }&#39;

1..4
ok 1 # [] == [Foo Bar]
not ok 1 # [] == [Foo Br11]
ok 1 # [] == [1234567]
not ok 1 # [] == [12345788]

Considering 8 characters is the magic number I&#39;m guessing it&#39;s a 64bit
problem &#40;though I admit I know little about it&#41;.

I get the same results on 5.8.8, 5.10.1, 5.12.3, 5.14.1,
installed via perlbrew or the system binary on Xubuntu 11.04.

Also it appears that some of the tests fail but it installs anyway &#40;see
attached&#41;.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> string-strip-perl-v.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Summary of my perl5 &#40;revision 5 version 14 subversion 1&#41; configuration:
   
  Platform:
    osname=linux, osvers=2.6.38-10-generic, archname=x86_64-linux
    uname=&#39;linux raptor 2.6.38-10-generic #46-ubuntu smp tue jun 28 15:07:17 utc 2011 x86_64 x86_64 x86_64 gnulinux &#39;
    config_args=&#39;-de -Dprefix=/home/rando/perl5/perlbrew/perls/perl-5.14.1&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=undef, usemultiplicity=undef
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=define, use64bitall=define, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-O2&#39;,
    cppflags=&#39;-fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.5.2&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39; -fstack-protector -L/usr/local/lib&#39;
    libpth=/usr/local/lib /lib /usr/lib /usr/lib/x86_64-linux-gnu /lib64 /usr/lib64
    libs=-lnsl -ldl -lm -lcrypt -lutil -lc
    perllibs=-lnsl -ldl -lm -lcrypt -lutil -lc
    libc=, so=so, useshrplib=false, libperl=libperl.a
    gnulibc_version=&#39;2.13&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -O2 -L/usr/local/lib -fstack-protector&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: PERL_DONT_CREATE_GVSV PERL_MALLOC_WRAP
                        PERL_PRESERVE_IVUV USE_64_BIT_ALL USE_64_BIT_INT
                        USE_LARGE_FILES USE_PERLIO USE_PERL_ATOF
  Built under linux
  Compiled at Jul 25 2011 12:26:25
  %ENV:
    PERL5LIB=&#34;/home/rando/perl5-autolookout/lib/perl5/x86_64-linux:/home/rando/perl5-autolookout/lib/perl5&#34;
    PERLBREW_HOME=&#34;/home/rando/.perlbrew&#34;
    PERLBREW_PATH=&#34;/home/rando/perl5/perlbrew/bin:/home/rando/perl5/perlbrew/perls/perl-5.14.1/bin&#34;
    PERLBREW_PERL=&#34;perl-5.14.1&#34;
    PERLBREW_ROOT=&#34;/home/rando/perl5/perlbrew&#34;
    PERLBREW_VERSION=&#34;0.27&#34;
    PERL_CPANM_OPT=&#34;--save-dists /home/rando/perl5/cpan/mini --mirror <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost:4999/CPAN/">http://localhost:4999/CPAN/</a></span> --mirror <span class="clickylink"><a target="new" rel="nofollow" href="http://cpan.ezarticleinformation.com/">http://cpan.ezarticleinformation.com/</a></span> --mirror <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/">http://search.cpan.org/CPAN/</a></span>&#34;
  @INC:
    /home/rando/perl5-autolookout/lib/perl5/x86_64-linux
    /home/rando/perl5-autolookout/lib/perl5
    /home/rando/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1/x86_64-linux
    /home/rando/perl5/perlbrew/perls/perl-5.14.1/lib/site_perl/5.14.1
    /home/rando/perl5/perlbrew/perls/perl-5.14.1/lib/5.14.1/x86_64-linux
    /home/rando/perl5/perlbrew/perls/perl-5.14.1/lib/5.14.1
    .
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> string-strip-installation.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">String-Strip-1.01/
String-Strip-1.01/Makefile.PL
String-Strip-1.01/Changes
String-Strip-1.01/test.pl
String-Strip-1.01/Strip.xs
String-Strip-1.01/Strip.pm
String-Strip-1.01/README
String-Strip-1.01/MANIFEST
CPAN: File::Temp loaded ok &#40;v0.22&#41;
Package came without SIGNATURE

CPAN: CPAN::Meta loaded ok &#40;v2.110930001&#41;

  CPAN.pm: Going to build B/BP/BPOWERS/String-Strip-1.01.tar.gz

CPAN: CPAN::Reporter loaded ok &#40;v1.1902&#41;
Checking if your kit is complete...
Looks good
Writing Makefile for String::Strip
Writing MYMETA.yml and MYMETA.json
&#40;/home/rando/perl5/perlbrew/perls/perl-5.8.8/bin/perl Makefile.PL INSTALLDIRS=site exited with 0&#41;
CPAN::Reporter: Makefile.PL result is &#39;pass&#39;, No errors.
CPAN: Module::CoreList loaded ok &#40;v2.54&#41;
cp Strip.pm blib/lib/String/Strip.pm
AutoSplitting blib/lib/String/Strip.pm &#40;blib/lib/auto/String/Strip&#41;
/home/rando/perl5/perlbrew/perls/perl-5.8.8/bin/perl /home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/site_perl/5.8.8/ExtUtils/xsubpp  -typemap /home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/5.8.8/ExtUtils/typemap  Strip.xs &gt; Strip.xsc &#38;&#38; mv Strip.xsc Strip.c
cc -c   -fno-strict-aliasing -pipe -Wdeclaration-after-statement -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -O2   -DVERSION=\&#34;1.01\&#34; -DXS_VERSION=\&#34;1.01\&#34; -fpic &#34;-I/home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/5.8.8/x86_64-linux/CORE&#34;   Strip.c
Running Mkbootstrap for String::Strip &#40;&#41;
chmod 644 Strip.bs
rm -f blib/arch/auto/String/Strip/Strip.so
cc  -shared -L/usr/local/lib Strip.o  -o blib/arch/auto/String/Strip/Strip.so   \
                \

chmod 755 blib/arch/auto/String/Strip/Strip.so
cp Strip.bs blib/arch/auto/String/Strip/Strip.bs
chmod 644 blib/arch/auto/String/Strip/Strip.bs
Manifying blib/man3/String::Strip.3
&#40;/usr/bin/make exited with 0&#41;
CPAN::Reporter: make result is &#39;pass&#39;, No errors.
  BPOWERS/String-Strip-1.01.tar.gz
  /usr/bin/make -- OK
CPAN: YAML::XS loaded ok &#40;v0.35&#41;
Running make test
PERL_DL_NONLAZY=1 /home/rando/perl5/perlbrew/perls/perl-5.8.8/bin/perl &#34;-Iblib/lib&#34; &#34;-Iblib/arch&#34; test.pl
1..42
ok 1
ok 2
ok 3
ok 4
ok 5
ok 6
ok 7
ok 8
ok 9
ok 10
ok 11
ok 12
ok 13
ok 14
ok 15
ok 16
ok 17
not ok 18
not ok 19
ok 20
ok 21
ok 22
ok 23
ok 24
ok 25
ok 26
ok 27
ok 28
ok 29
ok 30
ok 31
ok 32
ok 33
ok 34
ok 35
ok 36
not ok 37
ok 38
ok 39
ok 40
ok 41
ok 42
&#40;/usr/bin/make test exited with 0&#41;
CPAN::Reporter: Test result is &#39;pass&#39;, &#39;make test&#39; no errors.
CPAN::Reporter: preparing a CPAN Testers report for String-Strip-1.01
CPAN::Reporter: sending test report with &#39;pass&#39; via Metabase
  BPOWERS/String-Strip-1.01.tar.gz
  /usr/bin/make test -- OK
Running make install
Prepending /home/rando/.cpan/build/String-Strip-1.01-_cmfyz/blib/arch /home/rando/.cpan/build/String-Strip-1.01-_cmfyz/blib/lib to PERL5LIB for &#39;install&#39;
Files found in blib/arch: installing files in blib/lib into architecture dependent library tree
Installing /home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/site_perl/5.8.8/x86_64-linux/auto/String/Strip/Strip.so
Installing /home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/site_perl/5.8.8/x86_64-linux/auto/String/Strip/Strip.bs
Installing /home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/site_perl/5.8.8/x86_64-linux/auto/String/Strip/autosplit.ix
Installing /home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/site_perl/5.8.8/x86_64-linux/String/Strip.pm
Installing /home/rando/perl5/perlbrew/perls/perl-5.8.8/man/man3/String::Strip.3
Appending installation info to /home/rando/perl5/perlbrew/perls/perl-5.8.8/lib/5.8.8/x86_64-linux/perllocal.pod
  BPOWERS/String-Strip-1.01.tar.gz
  /usr/bin/make install UNINST=1 -- OK</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;17&nbsp;10:27:05&nbsp;2011</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">realized there was a goof in my previous perl code.

The problem was still evident,
but here it is the code using the correct variable:

perl -C -MString::Strip=StripLTSpace -e &#39;@t = &#40;&#34;Foo Bar&#34;, &#34;Foo Bar1&#34;,
&#34;1234567&#34;, &#34;12345678&#34;&#41;; printf &#34;1..%d\n&#34;, scalar @t; foreach &#40;@t&#41;{ $s =
&#34; $_ &#34;; StripLTSpace&#40;$s&#41;; print &#34;not &#34; unless $s eq $_; print &#34;ok 1 #
[$_] =&gt; [$s]\n&#34;; }&#39;
1..4
ok 1 # [Foo Bar] =&gt; [Foo Bar]
not ok 1 # [Foo Bar1] =&gt; [Foo Br11]
ok 1 # [1234567] =&gt; [1234567]
not ok 1 # [12345678] =&gt; [12345788]
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;17&nbsp;10:27:06&nbsp;2011</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;19&nbsp;19:06:05&nbsp;2011</span>
    <span class="description">KRYDE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">To chuck in 2 cents worth, I notice the leading strippers use an
strcpy&#40;&#41; to move the remaining chars down.  I think the c99 spec is that
strcpy&#40;&#41; is unspecified if source and destination overlap.  Dunno if
that causes the bug, but may be worth avoiding.

&#40;For in-place stripping of leading chars maybe sv_chop&#40;&#41; without
copying.  Dunno how well it works in practice or if handles magic. 
Maybe SvCUR_set&#40;&#41; for trimming the end too.&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;23&nbsp;05:48:00&nbsp;2011</span>
    <span class="description">chrishammond [...] ymail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> chrishammond [...] ymail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Noticed this failing on RHEL6, too - strcpy&#40;&#41; behaviour is undefined 
where the source and destination strings overlap, memmove&#40;&#41; is safer to 
use:

+++ String-Strip-1.01/Strip.xs     2011-11-23 10:42:01.000000000 -0500
@@ -38,15 +38,16 @@
      char *arg
 CODE:
      char *pcF, *pcR;
+     int i;

      if &#40;!SvOK&#40;ST&#40;0&#41;&#41;&#41;
        XSRETURN_UNDEF;

-     if &#40;strlen&#40;arg&#41;&#41; {
+     if &#40;i = strlen&#40;arg&#41;&#41; {
        for &#40;pcF = arg; *pcF &#38;&#38; isspace&#40;*pcF&#41;; pcF++&#41;
          ;

-       strcpy&#40;arg, pcF&#41;;
+       memmove&#40;arg, pcF, i&#41;;
      }
 OUTPUT:
      arg
@@ -56,6 +57,7 @@
      char *arg
 CODE:
      char *pcF, *pcR;
+     char *pcTemp = strdup&#40;arg&#41;;
      int i;

      if &#40;!SvOK&#40;ST&#40;0&#41;&#41;&#41;
@@ -70,7 +72,7 @@
         for &#40;pcF = arg; *pcF &#38;&#38; isspace&#40;*pcF&#41;; pcF++&#41;
           ;

-        strcpy&#40;arg, pcF&#41;;
+        memmove&#40;arg, pcF, i&#41;;
        }
      }
 OUTPUT:
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;23&nbsp;06:39:55&nbsp;2011</span>
    <span class="description">chrishammond [...] ymail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> chrishammond [...] ymail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Actually, ignore this line, not required.
+     char *pcTemp = strdup&#40;arg&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;13&nbsp;23:30:32&nbsp;2012</span>
    <span class="description">PHRED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Nov 23 06:39:55 2011, chrishammond wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Actually, ignore this line, not required.
&gt; +     char *pcTemp = strdup&#40;arg&#41;;
</div>
I&#39;ve created a repository on github and merged your changes and tagged 1.02.

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/redhotpenguin/String-Strip">https://github.com/redhotpenguin/String-Strip</a></span>

I also made a request for comaintainership, so hopefully I&#39;ll be able to upload this fixed version 
to CPAN soon.  Feel free to make github pulls etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;14&nbsp;13:27:16&nbsp;2012</span>
    <span class="description">PHRED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Patch applied, thank you Chris.  1.02 is on the way to CPAN, and I am now a comaintainer.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;14&nbsp;13:27:17&nbsp;2012</span>
    <span class="description">PHRED [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
