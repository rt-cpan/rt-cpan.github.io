<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #97516 for Type-Tiny: InstanceOf[Class::Name] is not cached, makes declaring coercion inconsistent</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #97516 for Type-Tiny: InstanceOf[Class::Name] is not cached, makes declaring coercion inconsistent</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Type-Tiny/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Type-Tiny/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Type-Tiny/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Type-Tiny/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Type-Tiny">Type-Tiny CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">97516</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Type-Tiny/Active/">Type-Tiny</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mschwern [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-249424-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
0.044</li>
<li>
0.046</li>
</ul>
    </td>
  </tr>
  <tr id="CF-249425-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.000000    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;25&nbsp;18:50:48&nbsp;2014</span>
    <span class="description">mschwern [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> InstanceOf[Class::Name] is not cached, makes declaring coercion
 inconsistent</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza">InstanceOf[Class::Name] is cached, but only for about a second.&nbsp; Then a new instance of the type is returned.&nbsp; This one liner demonstrates.<br>

<br>

$ perl -wle &#39;use Scalar::Util qw(refaddr); use Types::Standard qw(:types);&nbsp; while(1) { print join &quot;, &quot;, (refaddr(InstanceOf[&quot;Class::Name&quot;]), refaddr(InstanceOf[&quot;Class::Name&quot;])); sleep 1 }&#39;<br>

140722877312264, 140722877312264<br>

140722876835704, 140722876835704<br>

140722876589416, 140722876589416<br>

140722875485312, 140722875485312<br>

<br>

Contrast with Str which always returns the same type object.<br>

<br>

$ perl -wle &#39;use Scalar::Util qw(refaddr); use Types::Standard qw(:types);&nbsp; while(1) { print join &quot;, &quot;, (refaddr(Str), refaddr(Str)); sleep 1 }&#39;<br>

140414620306936, 140414620306936<br>

140414620306936, 140414620306936<br>

140414620306936, 140414620306936<br>

140414620306936, 140414620306936<br>

<br>

This seems wasteful.&nbsp; On a practical level, it makes adding a coercion to InstanceOf[&quot;Class::Name&quot;] impossible.<br>

<br>

coerce InstanceOf[&quot;URI&quot;],<br>

&nbsp; from Str,<br>

&nbsp; via {<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; require URI;<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return URI-&gt;new($_);<br>

&nbsp; };<br>

<br>

The coercion is applied to a particular instance of InstanceOf[&quot;URI&quot;] passed to coerce.&nbsp; Later InstanceOf[&quot;URI&quot;] will return a different instance with no coercion.&nbsp; This is confusing.<br>

<br>

The problem appears to stem from a cache which will only hold onto externally referenced types.&nbsp; If I store InstanceOf[&quot;URI&quot;] in a lexical then InstanceOf[&quot;URI&quot;] will return the same object.<br>

<br>

I&#39;m having deja vu about this issue.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;26&nbsp;16:54:06&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Moose/Mouse will certainly always return the same object reference, but that&#39;s a consequence of them having global type libraries. If you have a named type constraint, that means the same everywhere.

This leads to action at a distance. A coercion to URI defined by the routing part of your application can have unintended consequences on the web-scraping part.

While Type::Tiny type constraints play nicely with Moose and Mouse, I did aim to change some aspects of the system I thought were flawed. Type::Tiny&#39;s type constraints are essentially lexical. And then Type::Library basically gives you a way to give them &#40;namespaced&#41; global names.

So the solution, such as it is, is to create a type library, and declare a new type in it:

    declare MyURI, as InstanceOf[&#34;URI&#34;];

And then attach the coercion to &#34;MyURI&#34;. Once you&#39;ve created a child type, the child &#34;belongs to you&#34;, and you can coerce to it freely.

Certainly it would be nicer if the example you provided at least emitted a warning though.

I&#39;ll keep this ticket open while I think about things.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;26&nbsp;16:54:07&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;28&nbsp;14:26:13&nbsp;2014</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #97516] InstanceOf[Class::Name] is not cached, makes declaring coercion inconsistent</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 28 Jul 2014 11:25:49 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Type-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Regardless of the lexical vs global type philosophy, the current
situation where SOME of Types::Standard&#39;s types act globally and some do
not, is the worst case.  It&#39;s unclear and undocumented to the user which
types will persist and which will just toss changes out.  The changes
made to things like InstanceOf[&#34;URI&#34;] don&#39;t even persist lexically, they
immediately disappear because of the hidden lexical nature of the type.

UNLESS that type happens to have been coincidentally cached by something
else.  For example...

subtype &#34;AbsDir&#34;,
  as InstanceOf[&#34;Path::Tiny&#34;],
  where { $_-&gt;is_absolute };

coerce &#34;AbsDir&#34;,
  from InstanceOf[&#34;Path::Tiny&#34;],
  via {
      return $_-&gt;absolute;
  };

coerce InstanceOf[&#34;Path::Tiny&#34;],
  from &#34;Str&#34;,
  via {
      return path&#40;$_&#41;;
  };

Now that final coercion will persist but only because AbsDir happens to
contain an instance of InstanceOf[&#34;Path::Tiny&#34;] which it keeps in existence.

Something has to be done about that.  &#40;Note: that something is NOT to
document the broken behavior&#41;.


Now I get a bit long winded as I have Opinions about type coercion.


The MyURI work around, as a long term solution, is problematic from my
point of view about type coercion.  Unlike the Moose POV about type
coercion, that it should be under the control of the consumer of the
type, I prefer the ease of transparent type coercion.  If my method
wants InstanceOf[URI] all I care is my method receives InstanceOf[URI];
I don&#39;t care what the original input was so long as I have a faithful
representation of it as a URI instance.

Similarly, when I add a coercion to a type I expect it to just work with
all the things that take that type.  I do not want to have to declare a
new type and then hunt down all the places which used InstanceOf[URI]
and change it to MyURI.

It&#39;s funny, each POV views the other as causing an encapsulation
violation.  I guess it depends on whether you look at type coercion as
altering the input &#40;I gave you a string and suddenly it&#39;s a URI object&#41;
or as guaranteeing the input &#40;I said I want a URI object, I don&#39;t care
what it was before&#41;.  Or as proscriptive &#40;my method takes only URI
objects, it&#39;s wrong to give it a string&#41; vs descriptive &#40;my method takes
URI objects, or anything which can be reasonably coerced into one&#41;.

Anyhow, the work around I&#39;m using for Gitpan is:

    our $URI_Type = InstanceOf[&#34;URI&#34;];


To the action at a distance issue... global types are global and
inherently have action at a distance issues.  This is like saying the
method modifiers after, before and around have action at a distance
issues.  They do.  It&#39;s part of their nature.  It&#39;s accepted.

Adding coercion is a far less severe action at a distance issue.  Moose
style conversion has to be turned on by the type user.  If I add
coercion to InstanceOf[URI] it only effects the places which have
already decided they want coercion.  The nature of that coercion may
change, but that&#39;s what you accept by using global types and coercion.

The action at a distance issue already exists with the standard types
cached by Types::Standard.  I can add a coercion to Str and it will
appear elsewhere.

Action at a distance is only a problem when a global entity is changed
in two different places.  If one library declares and modifies a global
type, and at the same time, it&#39;s not really action at a distance.  For
example, the Gitpan project has Gitpan::Types to collect all its custom
types and custom type modifications together in one place.
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/evalEmpire/gitpan/blob/rewrite/lib/Gitpan/Types.pm">https://github.com/evalEmpire/gitpan/blob/rewrite/lib/Gitpan/Types.pm</a></span>
It was in converting this to Moo/Type::Tiny that I encountered the problem.

This only works for Gitpan because it is an application.  If a CPAN
module starts messing with standard types, that&#39;s the bad sort of action
at a distance... unless it&#39;s a CPAN module about types.


As to Type::Tiny&#39;s intent to make types lexical, that&#39;s fine.  If you
want lexical protections for your types, you can make lexical types.  If
you want global types, you can make global types.  Type::Tiny presents a
lexical type system with types declared lexically.  Types::Standard
presents a global type system with types declared in a separate file and
exported.

Changes to lexical types should be lexical.  And changes to global types
should be global.

If you start adding coercions to global types declared elsewhere, you
incur the same problems as messing with any global.  This is a known
problem with global entities and one which is accepted.


All that said, mutable global entities are a problem because they can be
changed anywhere and cause action at a distance.  IMMUTABLE global
entities are less of a problem.  Perhaps types can be locked to prevent
further changes, and unlocked as an &#34;I thought about this and know what
I&#39;m doing&#34; check?


Another possibility is to have Types::Standard export *copies* of their
types so they can be safely messed with without danger of causing action
at a distance.  Then if one wants to modify standard types for their own
project they have to write their own local type library like Gitpan::Types.


Another possibility is to accept that Types::Standard produces global
types, to make all standard types persist, and document that standard
programming practices about modifying globals apply.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;30&nbsp;05:56:37&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; All that said, mutable global entities are a problem 
&gt; because they can be changed anywhere and cause action 
&gt; at a distance.  IMMUTABLE global entities are less of 
&gt; a problem.
</div>
Agreed. Type::Tiny objects are already immutable by design, but the Type::Coercion objects referenced by them are not.

However, Type::Coercion has long provided a $coercion-&gt;freeze method to lock down a coercion object, causing it to throw an exception if there are any attempts to add coercions to it. The problem is that other parts of Type::Tiny have been conservative at calling $coercion-&gt;freeze.

Well, not any more...

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/tobyink/p5-type-tiny/compare/lockdown">https://github.com/tobyink/p5-type-tiny/compare/lockdown</a></span>

As of the next release, all the bundled type constraints will have their coercions frozen, as will any parameterized type constraint at all.

Third-party type libraries can call:

    __PACKAGE__-&gt;meta-&gt;make_immutable;  # familiar?

... to do the same to their types.

If you want to add coercions to a type constraint with a frozen coercion object, the officially supported technique is to create a child type and add the coercions to that. Type::Tiny has long had a $type-&gt;plus_coercions method to simplify that process.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; unlocked as an &#34;I thought about this and know what
&gt; I&#39;m doing&#34; check
</div>
The following should unlock a type&#39;s coercion object:

    $type-&gt;coercion-&gt;{frozen} = 0;

It is unlikely to become an officially supported part of Type::Tiny&#39;s API, but it is equally unlikely to suddenly stop working.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;30&nbsp;05:56:37&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;30&nbsp;11:08:27&nbsp;2014</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #97516] InstanceOf[Class::Name] is not cached, makes declaring coercion inconsistent</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 30 Jul 2014 08:03:09 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Type-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 7/30/14, 2:56 AM, Toby Inkster via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As of the next release, all the bundled type constraints will
&gt; have their coercions frozen, as will any parameterized type
&gt; constraint at all.
</div>
Okie doke.  I&#39;ll switch my code over.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The following should unlock a type&#39;s coercion object:
&gt; 
&gt;     $type-&gt;coercion-&gt;{frozen} = 0;
&gt; 
&gt; It is unlikely to become an officially supported part
&gt; of Type::Tiny&#39;s API, but it is equally unlikely to suddenly stop working.
</div>
If you&#39;re going to tell people to do that, I would make it part of the
API.  I know, I know, you don&#39;t want people actually doing it so you
don&#39;t want it in the API.  The limbo state is worse.  Providing an
unofficial, encapsulation-breaking work around sets you and everyone who
uses it up for a maintenance headache down the road when you either want
to remove or change the behavior and find out it&#39;s used in some Really
Important CPAN module&#39;s dependency chain.

Put in the accessor, give it an annoyingly long name, document it,
document why it&#39;s a bad idea to alter standard types &#40;global effects&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;31&nbsp;10:17:16&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you&#39;re going to tell people to do that, 
&gt; I would make it part of the API.
</div>
Oh, OK.

But I&#39;m marking it as unstable.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;16&nbsp;14:14:58&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Type-Tiny-1.000000 has been released, mostly resolving this.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;16&nbsp;14:14:58&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;16&nbsp;14:14:59&nbsp;2014</span>
    <span class="description">perl [...] toby.ink -  Fixed in 1.000000 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
