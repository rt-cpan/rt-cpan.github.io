<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #72829 for Class-XSAccessor: Cached accessors - minor problem</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #72829 for Class-XSAccessor: Cached accessors - minor problem</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Class-XSAccessor">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Class-XSAccessor">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Class-XSAccessor">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Class-XSAccessor">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Class-XSAccessor">Class-XSAccessor CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">72829</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">stalled</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Class-XSAccessor">Class-XSAccessor</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ribasushi [...] leporine.io

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-221550-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-221551-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=72829">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1005837" href="/Public/Bug/Display.html?id=72829#txn-1005837">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;30&nbsp;02:43:16&nbsp;2011</span>
    <span class="description">ribasushi [...] leporine.io -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Cached accessors - minor problem</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1005837/524121/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/524121">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I just saw 1.12_01 being released - the cached accessor stuff is an
awesome awesome idea. It in fact obviates the need for me to deal with
the CAG inherited type we were talking about &#40;more detail about
implementation here:
<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L237&#41;">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L237&#41;</a></span>

However there is a problem - the method names. First of all they are
short and common enough to virtually guarantee clashes with existing
software. For example I can not add a _set method to the DBIC
ResultClass inheritance chain, as there is an extremely high chance an
actual user of said library already has such methods. I propose
something like _xsa_cached_get / _xsa_cached_set.

Furthermore the way you implemented this it will be quite complicated to
retrofit it into larger frameworks like Moo or Class::Accessor::Grouped,
as we now need to implement a flexible accessor dispatch table inside
the _set/_get subs &#40;i.e. what to do on &#39;foo&#39;, what to do on &#39;bar&#39;, etc&#41;.
Again CAG is a good example on why this is a problem:
<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L100">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L100</a></span>.
We currently only use XSA for the &#39;simple&#39; type &#40;and go to hreat lengths
to make sure we do not short-circuit a user-defines get/set_simple, e.g.
<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L654&#41;">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L654&#41;</a></span>
Is it possible to compile the accessor name into the method as well?
Something like _xsa_cached_get_foo / _xsa_cached_set_foo?

Cheers!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1006152" href="/Public/Bug/Display.html?id=72829#txn-1006152">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;30&nbsp;14:25:27&nbsp;2011</span>
    <span class="description">rt-cpan [...] trout.me.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1006152/524292/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/524292">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Nov 30 02:43:16 2011, RIBASUSHI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Furthermore the way you implemented this it will be quite complicated
&gt; to
&gt; retrofit it into larger frameworks like Moo or
&gt; Class::Accessor::Grouped,
&gt; as we now need to implement a flexible accessor dispatch table inside
&gt; the _set/_get subs &#40;i.e. what to do on &#39;foo&#39;, what to do on &#39;bar&#39;,
&gt; etc&#41;.
&gt; Again CAG is a good example on why this is a problem:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-</a></span>
&gt; 0.10004/lib/Class/Accessor/Grouped.pm#L100.
&gt; We currently only use XSA for the &#39;simple&#39; type &#40;and go to hreat
&gt; lengths
&gt; to make sure we do not short-circuit a user-defines get/set_simple,
&gt; e.g.
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-</a></span>
&gt; 0.10004/lib/Class/Accessor/Grouped.pm#L654&#41;
&gt; Is it possible to compile the accessor name into the method as well?
&gt; Something like _xsa_cached_get_foo / _xsa_cached_set_foo?
</div>
It seems to me that what I really want is to be able to pass a method
name &#40;and, if possible, have a choice of passing a coderef as well&#41; plus
some static arguments to be passed thereto - and then you&#39;re effectively
defaulting the names to _get/_set and the arguments to $attr_name.

The other thing that I&#39;d really like to have here is to be able to have
-only- the _get or _set behaviour on any given accessor - for example I
could use _set only to implement set-with-type-checks or _get only to
implement lazyily-calculated-defaults.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1006155" href="/Public/Bug/Display.html?id=72829#txn-1006155">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;30&nbsp;14:25:28&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1006346" href="/Public/Bug/Display.html?id=72829#txn-1006346">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;01&nbsp;02:06:45&nbsp;2011</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72829] Cached accessors - minor problem</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 01 Dec 2011 08:06:29 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Class-XSAccessor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Mueller &lt;smueller [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1006346/524389/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/524389">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 11/30/2011 08:25 PM, MSTROUT via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         Queue: Class-XSAccessor
&gt;   Ticket&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=72829">https://rt.cpan.org/Ticket/Display.html?id=72829</a></span>&gt;
&gt;
&gt; On Wed Nov 30 02:43:16 2011, RIBASUSHI wrote:
<div class="message-stanza open">&gt;&gt; Furthermore the way you implemented this it will be quite complicated
&gt;&gt; to
&gt;&gt; retrofit it into larger frameworks like Moo or
&gt;&gt; Class::Accessor::Grouped,
&gt;&gt; as we now need to implement a flexible accessor dispatch table inside
&gt;&gt; the _set/_get subs &#40;i.e. what to do on &#39;foo&#39;, what to do on &#39;bar&#39;,
&gt;&gt; etc&#41;.
&gt;&gt; Again CAG is a good example on why this is a problem:
&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-</a></span>
&gt;&gt; 0.10004/lib/Class/Accessor/Grouped.pm#L100.
&gt;&gt; We currently only use XSA for the &#39;simple&#39; type &#40;and go to hreat
&gt;&gt; lengths
&gt;&gt; to make sure we do not short-circuit a user-defines get/set_simple,
&gt;&gt; e.g.
&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-</a></span>
&gt;&gt; 0.10004/lib/Class/Accessor/Grouped.pm#L654&#41;
&gt;&gt; Is it possible to compile the accessor name into the method as well?
&gt;&gt; Something like _xsa_cached_get_foo / _xsa_cached_set_foo?
</div>&gt;
&gt; It seems to me that what I really want is to be able to pass a method
&gt; name &#40;and, if possible, have a choice of passing a coderef as well&#41; plus
&gt; some static arguments to be passed thereto - and then you&#39;re effectively
&gt; defaulting the names to _get/_set and the arguments to $attr_name.
&gt;
&gt; The other thing that I&#39;d really like to have here is to be able to have
&gt; -only- the _get or _set behaviour on any given accessor - for example I
&gt; could use _set only to implement set-with-type-checks or _get only to
&gt; implement lazyily-calculated-defaults.
</div>
This reply applies to both of you, not just Matt.

I didn&#39;t do any of this because that requires hacking on the C-level 
storage for the hash keys. Right now, it sports exactly 1-to-1 mapping 
of hash key strings to integers with lookup either way. Shoving more 
info in there without

a&#41; Slowing down the simple cases &#40;possibly by quite a bit&#41;
b&#41; Breaking the terrible and likely fragile code that implements the 
out-of-perl storage.
c&#41; Breaking it specifically wrt. thread-safety.

Now, all of these may be irrational fear, so don&#39;t let me discourage you 
from hacking on it &#40;and cleaning it up as you see fit, but please be 
available for debugging weird issues if you break it&#41;.

For me, however, I simply needed exactly the behaviour of the current 
implementation of cached accessors for $work &#40;we have a weirdly twisted 
variant of a formerly-Class::DBI ORM that we can&#39;t migrate away from and 
don&#39;t generally give a flying fuck about anyway&#41;. What you propose is a 
superset of what I need, so that&#39;ll work for me, too. Just be aware that 
a&#41; I don&#39;t have the time to implement it and b&#41; any call back into Perl 
from C is going to be so mind-numbingly slow that you could have done 
the whole thing in Perl from the get-go. So make sure the common case 
doesn&#39;t have to do that.

Cheers,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1006368" href="/Public/Bug/Display.html?id=72829#txn-1006368">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;01&nbsp;03:23:47&nbsp;2011</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72829] Cached accessors - minor problem</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 01 Dec 2011 09:23:27 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Class-XSAccessor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Mueller &lt;smueller [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1006368/524398/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/524398">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 11/30/2011 08:43 AM, Peter Rabbitson via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However there is a problem - the method names. First of all they are
&gt; short and common enough to virtually guarantee clashes with existing
&gt; software. For example I can not add a _set method to the DBIC
&gt; ResultClass inheritance chain, as there is an extremely high chance an
&gt; actual user of said library already has such methods. I propose
&gt; something like _xsa_cached_get / _xsa_cached_set.
</div>
That would be easy and I&#39;d be happy to do that.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Furthermore the way you implemented this it will be quite complicated to
&gt; retrofit it into larger frameworks like Moo or Class::Accessor::Grouped,
</div>
Large framework like Moo? IMO, that&#39;s a failure right there. No offense, 
Matt!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; as we now need to implement a flexible accessor dispatch table inside
&gt; the _set/_get subs &#40;i.e. what to do on &#39;foo&#39;, what to do on &#39;bar&#39;, etc&#41;.
&gt; Again CAG is a good example on why this is a problem:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L100">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L100</a></span>.
&gt; We currently only use XSA for the &#39;simple&#39; type &#40;and go to hreat lengths
&gt; to make sure we do not short-circuit a user-defines get/set_simple, e.g.
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L654&#41;">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-0.10004/lib/Class/Accessor/Grouped.pm#L654&#41;</a></span>
</div>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is it possible to compile the accessor name into the method as well?
&gt; Something like _xsa_cached_get_foo / _xsa_cached_set_foo?
</div>
Not easily/efficiently.

--Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1008505" href="/Public/Bug/Display.html?id=72829#txn-1008505">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;06&nbsp;10:37:44&nbsp;2011</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1008505/525496/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/525496">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Nov 30 14:25:27 2011, MSTROUT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Nov 30 02:43:16 2011, RIBASUSHI wrote:
<div class="message-stanza open">&gt; &gt; Furthermore the way you implemented this it will be quite 
</div></div>complicated
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; to
&gt; &gt; retrofit it into larger frameworks like Moo or
&gt; &gt; Class::Accessor::Grouped,
&gt; &gt; as we now need to implement a flexible accessor dispatch table 
</div></div>inside
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; the _set/_get subs &#40;i.e. what to do on &#39;foo&#39;, what to do on &#39;bar&#39;,
&gt; &gt; etc&#41;.
&gt; &gt; Again CAG is a good example on why this is a problem:
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-</a></span>
&gt; &gt; 0.10004/lib/Class/Accessor/Grouped.pm#L100.
&gt; &gt; We currently only use XSA for the &#39;simple&#39; type &#40;and go to hreat
&gt; &gt; lengths
&gt; &gt; to make sure we do not short-circuit a user-defines get/set_simple,
&gt; &gt; e.g.
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-">https://metacpan.org/source/RIBASUSHI/Class-Accessor-Grouped-</a></span>
&gt; &gt; 0.10004/lib/Class/Accessor/Grouped.pm#L654&#41;
&gt; &gt; Is it possible to compile the accessor name into the method as well?
&gt; &gt; Something like _xsa_cached_get_foo / _xsa_cached_set_foo?
</div>&gt; 
&gt; It seems to me that what I really want is to be able to pass a method
&gt; name &#40;and, if possible, have a choice of passing a coderef as well&#41; 
</div>plus
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; some static arguments to be passed thereto - and then you&#39;re 
</div>effectively
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; defaulting the names to _get/_set and the arguments to $attr_name.
&gt; 
&gt; The other thing that I&#39;d really like to have here is to be able to 
</div>have
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -only- the _get or _set behaviour on any given accessor - for example 
</div>I
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; could use _set only to implement set-with-type-checks or _get only to
&gt; implement lazyily-calculated-defaults.
</div>
I thought some more about the general problem of adding more meta-
information to the generated accessors. It&#39;s a bit nasty. Since that&#39;s 
thinking I&#39;ve done before, I added some comments to the code for the 
Steffen of the future to read instead of redoing the whole thought 
thing:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/tsee/Class-">https://github.com/tsee/Class-</a></span>
XSAccessor/commit/5590225024cb52adf187b45113544ff36a5516fa

Hope that makes some sense. So if we want this further parameterization, 
we&#39;ll have to reconsider more of the implementation and algorithms in 
the module.

BTW: The thread-safety issue that I discovered the other day is fixed in 
the master branch now. Maybe this will allow us to recover cygwin! Yay!

On further reflection, it should be possible to include the hash key 
name into the _get/_set-alike method to call without too much pain. But 
that would be most elegantly solved by further parametization to avoid 
some of the ludicrous code duplication that&#39;s already going on. So I&#39;m 
punting on it for the time being.

Cheers,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1136573" href="/Public/Bug/Display.html?id=72829#txn-1136573">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;04&nbsp;15:13:08&nbsp;2012</span>
    <span class="description">ribasushi [...] leporine.io -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1136574" href="/Public/Bug/Display.html?id=72829#txn-1136574">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;04&nbsp;15:13:08&nbsp;2012</span>
    <span class="description">ribasushi [...] leporine.io -  Severity Wishlist added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.493383</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
