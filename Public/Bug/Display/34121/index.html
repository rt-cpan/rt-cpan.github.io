<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #34121 for SQL-Statement: Confuses literals with identifiers</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #34121 for SQL-Statement: Confuses literals with identifiers</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/SQL-Statement/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/SQL-Statement/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/SQL-Statement/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/SQL-Statement/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/SQL-Statement">SQL-Statement CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">34121</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/SQL-Statement/Active/">SQL-Statement</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">REHSACK [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
IKEGAMI [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-29588-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.15    </td>
  </tr>
  <tr id="CF-29589-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;20:03:37&nbsp;2008</span>
    <span class="description">IKEGAMI [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Confuses literals with identifiers</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">SQL::Statement successfully parses quoted SQL identifiers &#40;e.g. &#39;SELECT
&#34;my_field&#34; FROM &#34;MyTable&#34;&#39;&#41;, but fails to handle them properly. It
considers the entire literal, quotes included, to be the identifier.

As a result,
table &#39;&#34;MyTable&#34;&#39; is considered different from table &#39;MyTable&#39;, and
field &#39;&#34;my_field&#34;&#39; is considered from field &#39;my_field&#39;.

This bug makes it impossible to use quoted identifiers and to work with
tables and fields whose names are reserved words.

The problem exists in 1.15 and has probably been present since quoted
identifiers were introduced.

e.g.
The following statement fails since it can&#39;t find the field &#39;&#34;set&#34;&#39; when
the field &#39;set&#39; exists:

      SELECT id,
             gid,
             card,
             &#34;set&#34;,
             illus,
             num
        FROM Print

e.g.
Given

      my $dbh = DBI-&gt;connect&#40;&#39;dbi:CSV:&#39;&#41;;
      $dbh-&gt;{csv_tables}{Order}{file} = &#39;Order.csv&#39;;

the following creates the wrong file since SQL::Statement reports the
table name is &#39;&#34;Order&#34;&#39;:

      CREATE TABLE &#34;Order&#34; &#40;
                ...
             &#41;


And the list goes on and on.

The issue was originally brought up on PerlMonks. The following node
contains code that produce an error as a result of this bug:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=673399">http://www.perlmonks.org/?node_id=673399</a></span>

No patch provided since the fix isn&#39;t trivial and could very well break
backwards compatibility. See <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=673590">http://www.perlmonks.org/?node_id=673590</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;01&nbsp;17:02:40&nbsp;2009</span>
    <span class="description">REHSACK [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;01&nbsp;17:03:15&nbsp;2009</span>
    <span class="description">REHSACK [...] cpan.org -  Severity Important added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;01&nbsp;18:51:17&nbsp;2009</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Could you please try if 1.16_02 fixes your problems?
The patches from RT 15688
&#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=15688&#41;">https://rt.cpan.org/Ticket/Display.html?id=15688&#41;</a></span>: »Columns aliased
with double quotes are a fatal error« has been applied and the
description was similar.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;01&nbsp;18:51:17&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;01&nbsp;23:53:14&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 1 Jan 2009 23:52:58 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Jan 1, 2009 at 6:51 PM, Jens Rehsack via RT &lt;
bug-SQL-Statement@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=34121">https://rt.cpan.org/Ticket/Display.html?id=34121</a></span> &gt;
&gt;
&gt; Could you please try if 1.16_02 fixes your problems?
&gt; The patches from RT 15688
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=15688&#41;">https://rt.cpan.org/Ticket/Display.html?id=15688&#41;</a></span>: »Columns aliased
&gt; with double quotes are a fatal error« has been applied and the
&gt; description was similar.
&gt;
</div>
I&#39;m getting a 404 trying to download 1.16_02 &#40;and 1.16_03&#41;. I&#39;ve attached
the test that I would have run.

With 1.15, the output is:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">    &gt;perl test.pl
</div>    SQL::Statement v1.15

    DBD::CSV::st execute failed:
    Execution ERROR: No such column &#39;TEST.&#34;text&#34;&#39;.

     [for Statement &#34;
         SELECT &#34;text&#34;
            FROM test
       &#34;] at test.pl line 47.

The desired output is

    foo
    bar
    baz
    Test passed.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;00:48:01&nbsp;2009</span>
    <span class="description">dubzed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients:;, ikegami [...] adaelis.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 01 Jan 2009 21:46:56 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Ikegami,

jZed, here.  Unless I&#39;m mistaken you are running afowl of this line in 
SQL::Statement::Syntax

&#34;A delimited identifier is *never* equal to a regular identifer &#40;so 
&#34;foo&#34; and foo are two different columns&#41;. But don&#39;t do that :-&#41;.&#34;

Delimited column names are expected to have quotes around them in the 
.csv file and the same name without quotes around them is not treated as 
a delimited identifier &#40;if it didn&#39;t save the quotes around it, how 
would it know was delimited the next time&#41;?

If all you want is to be able to name a column with a SQL keyword, try 
&#34;DROP KEYWORD text&#34; and you can use that as a column name.

-- 
Jeff

ikegami@adaelis.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: SQL-Statement
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=34121">http://rt.cpan.org/Ticket/Display.html?id=34121</a></span> &gt;
&gt;
&gt; On Thu, Jan 1, 2009 at 6:51 PM, Jens Rehsack via RT &lt;
&gt; bug-SQL-Statement@rt.cpan.org&gt; wrote:
&gt;
&gt;   
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=34121">https://rt.cpan.org/Ticket/Display.html?id=34121</a></span> &gt;
&gt;&gt;
&gt;&gt; Could you please try if 1.16_02 fixes your problems?
&gt;&gt; The patches from RT 15688
&gt;&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=15688&#41;">https://rt.cpan.org/Ticket/Display.html?id=15688&#41;</a></span>: »Columns aliased
&gt;&gt; with double quotes are a fatal error« has been applied and the
&gt;&gt; description was similar.
&gt;&gt;
&gt;&gt;     
</div>&gt;
&gt; I&#39;m getting a 404 trying to download 1.16_02 &#40;and 1.16_03&#41;. I&#39;ve attached
&gt; the test that I would have run.
&gt;
&gt; With 1.15, the output is:
&gt;
<div class="message-stanza open">&gt;     &gt;perl test.pl
</div>&gt;     SQL::Statement v1.15
&gt;
&gt;     DBD::CSV::st execute failed:
&gt;     Execution ERROR: No such column &#39;TEST.&#34;text&#34;&#39;.
&gt;
&gt;      [for Statement &#34;
&gt;          SELECT &#34;text&#34;
&gt;             FROM test
&gt;        &#34;] at test.pl line 47.
&gt;
&gt; The desired output is
&gt;
&gt;     foo
&gt;     bar
&gt;     baz
&gt;     Test passed.
&gt;
&gt;   
&gt;
&gt; ------------------------------------------------------------------------
&gt;
&gt; On Thu, Jan 1, 2009 at 6:51 PM, Jens Rehsack via RT 
&gt; &lt;bug-SQL-Statement@rt.cpan.org &lt;mailto:bug-SQL-Statement@rt.cpan.org&gt;&gt; 
&gt; wrote:
&gt;
&gt;     &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=34121">https://rt.cpan.org/Ticket/Display.html?id=34121</a></span> &gt;
&gt;
&gt;     Could you please try if 1.16_02 fixes your problems?
&gt;     The patches from RT 15688
&gt;     &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=15688&#41;">https://rt.cpan.org/Ticket/Display.html?id=15688&#41;</a></span>: »Columns aliased
&gt;     with double quotes are a fatal error« has been applied and the
&gt;     description was similar.
&gt;
&gt;
&gt; I&#39;m getting a 404 trying to download 1.16_02 &#40;and 1.16_03&#41;. I&#39;ve 
&gt; attached the test that I would have run.
&gt;
&gt; With 1.15, the output is:
&gt;
<div class="message-stanza open">&gt;     &gt;perl test.pl
</div>&gt;     SQL::Statement v1.15
&gt;
&gt;     DBD::CSV::st execute failed:
&gt;     Execution ERROR: No such column &#39;TEST.&#34;text&#34;&#39;.
&gt;
&gt;      [for Statement &#34;
&gt;          SELECT &#34;text&#34;
&gt;             FROM test
&gt;        &#34;] at test.pl line 47.
&gt;
&gt; The desired output is
&gt;
&gt;     foo
&gt;     bar
&gt;     baz
&gt;     Test passed.
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;02:14:49&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Jan 2009 02:14:35 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Jan 2, 2009 at 12:46 AM, dubzed &lt;dubzed@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; jZed, here.  Unless I&#39;m mistaken you are running afowl of this line in
&gt; SQL::Statement::Syntax
&gt; &#34;A delimited identifier is *never* equal to a regular identifer &#40;so &#34;foo&#34;
&gt; and foo are two different columns&#41;. But don&#39;t do that :-&#41;.&#34;
&gt;
</div>
 Yes I am. I didn&#39;t realize the behaviour for which I filed a bug report was
documented.

&#40;if it didn&#39;t save the quotes around it, how would it know was delimited the
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; next time&#41;?
&gt;
</div>
I don&#39;t understand what you are saying. What needs to know how the table or
field name was encoded, and why does it need to know? Even if I buy into the
premise that there is a need to know how the table or field name was
encoded, that&#39;s doesn&#39;t prevent two equivalent encodings of the same name
from being treated as the same name.

- Eric &#34;ikegami&#34; Brine
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;02:59:38&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Jan 2009 02:58:51 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Jan 1, 2009 at 11:52 PM, Eric Brine &lt;ikegami@adaelis.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu, Jan 1, 2009 at 6:51 PM, Jens Rehsack via RT &lt;
&gt; bug-SQL-Statement@rt.cpan.org&gt; wrote:
&gt;
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=34121">https://rt.cpan.org/Ticket/Display.html?id=34121</a></span> &gt;
&gt;&gt;
&gt;&gt; Could you please try if 1.16_02 fixes your problems?
&gt;&gt; The patches from RT 15688
&gt;&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=15688&#41;">https://rt.cpan.org/Ticket/Display.html?id=15688&#41;</a></span>: »Columns aliased
&gt;&gt; with double quotes are a fatal error« has been applied and the
&gt;&gt; description was similar.
&gt;&gt;
</div>&gt;
&gt; I&#39;m getting a 404 trying to download 1.16_02 &#40;and 1.16_03&#41;. I&#39;ve attached
&gt; the test that I would have run.
&gt;
&gt; With 1.15, the output is:
&gt;
<div class="message-stanza open">&gt;     &gt;perl test.pl
</div>&gt;     SQL::Statement v1.15
&gt;
&gt;     DBD::CSV::st execute failed:
&gt;     Execution ERROR: No such column &#39;TEST.&#34;text&#34;&#39;.
&gt;
&gt;      [for Statement &#34;
&gt;          SELECT &#34;text&#34;
&gt;             FROM test
&gt;        &#34;] at test.pl line 47.
&gt;
&gt; The desired output is
&gt;
&gt;     foo
&gt;     bar
&gt;     baz
&gt;     Test passed.
&gt;
&gt;
</div>I am able to download it now. It introduced a bug.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">    &gt;perl test.pl
</div>    SQL::Statement v1.16_02

    DBD::CSV::db prepare failed: SQL ERROR: Bad table or column name &#39;text&#39;
is a SQL reserved word!

     [for Statement &#34;
          SELECT &#34;text&#34;
            FROM TestTable
       &#34;] at test.pl line 42.

Note that &#39;text&#39; was quoted, and thus not a reserved word.

If I sidestep the new bug by changing &#39;&#34;text&#34;&#39; to &#39;&#34;foo&#34;&#39; &#40;as in the
attached files&#41;, the bug I reported is gone.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">    &gt;perl test2.pl
</div>    SQL::Statement v1.16_02

    foo
    bar
    baz
    Test passed.

The documentation needs to be fixed, however. It currently claims

&#34;A delimited identifier is *never* equal to a regular identifer &#40;so &#34;foo&#34;
and foo are two different columns&#41;.  But don&#39;t do that :-&#41;.&#34;

But that&#39;s just been fixed

- Eric &#34;ikegami&#34; Brine
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;03:05:22&nbsp;2009</span>
    <span class="description">dubzed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 02 Jan 2009 00:05:10 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Eric Brine wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri, Jan 2, 2009 at 12:46 AM, dubzed &lt;dubzed@gmail.com 
&gt; &lt;mailto:dubzed@gmail.com&gt;&gt; wrote:
&gt;
&gt;     jZed, here.  Unless I&#39;m mistaken you are running afowl of this
&gt;     line in SQL::Statement::Syntax
&gt;     &#34;A delimited identifier is *never* equal to a regular identifer
&gt;     &#40;so &#34;foo&#34; and foo are two different columns&#41;. But don&#39;t do that :-&#41;.&#34;
&gt;
&gt;
&gt;  Yes I am. I didn&#39;t realize the behaviour for which I filed a bug 
&gt; report was documented.
&gt;
&gt;     &#40;if it didn&#39;t save the quotes around it, how would it know was
&gt;     delimited the next time&#41;?
&gt;
&gt;
&gt; I don&#39;t understand what you are saying. What needs to know how the 
&gt; table or field name was encoded, and why does it need to know? Even if 
&gt; I buy into the premise that there is a need to know how the table or 
&gt; field name was encoded, that&#39;s doesn&#39;t prevent two equivalent 
&gt; encodings of the same name from being treated as the same name.
</div>
Undelimited names are case insensitve, therefore  the column names 
q{foo}. q{FOO}, and q{FoO} are the same.  Which of those should
q{SELECT &#34;foo&#34; FROM ...} refer to?  The SQL standard, AFAIK doesn&#39;t 
define that.  Different implementations do it differently or not at all. 
&#40;Correct me if you know differently, I looked it all up when I wrote 
this into S::S, but don&#39;t have the references handy&#41;. 

 What I define in S::S is that q{&#34;foo&#34;} is always q{&#34;foo&#34;} and never 
q{anything else}.  That way the delimted identifier is case sensitive 
and the undelimited isn&#39;t as per the standard.  And therefore S::S 
expects to see the quote marks in the column name in the .csv file if it 
is to find it under a delimited name. 

Seem like a bug?  Maybe, but I&#39;m not sure there&#39;s a standard way of 
handling it and given the limits of meta-data-less .csv files, I&#39;m not 
sure what other option I have without violating case-sensitivity rules 
which would seem like a much bigger bug to me.

Does that make any more sense?

-- 
Jeff

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; :
&gt; - Eric &#34;ikegami&#34; Brine
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;16:26:27&nbsp;2009</span>
    <span class="description">dubzed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 02 Jan 2009 13:25:17 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;, bug-SQL-Statement [...] rt.cpan.org,  Jens Rehsack &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Eric Brine wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This means that keywords can never be used as field names with 
&gt; SQL::Statement 1.15.
</div>As I pointed out earlier and as is mentioned IIRC in the docs, one way 
to use keywords as fieldnames is to use a &#34;DROP KEYWORD foo&#34; statement 
which allows you to use keywords as column names.  Another is to 
manually set 
$dbh-&gt; {csv_tables}-&gt;{TABLE}-&gt;{column_names}.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This means that spaces can never be present in an identifier unless if 
&gt; also starts and ends with quotes. This sucks.
</div>No other implementation allows you &#40;or should if it pretends to be 
valid&#41; to put spaces in column names without delimiting them with 
quotes.    How it stores them internall is its business and the fact 
that you can see how .csv stores it is kind of irrelevant.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; You want quoting to denote case sensitivity, so literal q{&#34;foo&#34;} 
&gt; should represent identifier q{foo} and nothing else.
&gt;
</div>Well, unfortunately your intuition here is not the established standard, 
I don&#39;t have the full stuff on hand, but here&#39;s part of the story 
[verbatim from Martin Gruber and Joe Celko &#40;who is on the standards 
committee and whom I have talked to in person about this&#41;,_ SQL Instant 
Reference_, Sybex]

&#34;A regular and a delimited identifier are equal if they contain the same 
characters, taking case into account, but first converting the regular 
&#40;but not the delimited&#41; identifier to all uppercase letters.  In effect 
a delimited identifier that contains lowercase letters can never equal a 
regular identifier although it may equal another delimited one.&#34;

So that would kind of leave your choice of having it represent q{foo} 
out on a limb.  At least one of the major RDBMS handles it this way with 
only upper-case matches, another handles it the way you&#39;d like, another 
handles it as I do by not allowing equations between delimited and 
regular identifiers. 

If you think things are as simple as treating q{&#34;foo&#34;} and q{foo} the 
same, how would you handle this perfectly valid syntax: q{CREATE TABLE 
bar &#40;&#34;foo&#34; integer, FOO text&#41;}  ...  q{SELECT &#34;foo&#34; AS foo1, FoO AS foo2 
.FROM bar.}   If there were no indication in the .csv file that the 
first of those is delimited, how would the select statement know which 
to retrieve?

I understand that you don&#39;t like the way things operate but in this 
case, you haven&#39;t shown that my way of doing it breaks any standard  or 
that you have a solution which would work without breaking the standard.

I have made many sloppy decisions in S::S and you&#39;ve caught a bunch of 
them.  This isn&#39;t one of those cases.

-- 
Jeff
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;17:37:04&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, &#34;Jens Rehsack&#34; &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Jan 2009 17:36:51 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Jan 2, 2009 at 4:25 PM, dubzed &lt;dubzed@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Eric Brine wrote:
&gt;
<div class="message-stanza open">&gt;&gt; This means that spaces can never be present in an identifier unless if
&gt;&gt; also starts and ends with quotes. This sucks.
&gt;&gt;
</div>&gt; No other implementation allows you &#40;or should if it pretends to be valid&#41;
&gt; to put spaces in column names without delimiting them with quotes.
</div>

That&#39;s not what I said. Let&#39;s use an example: It&#39;s impossible to address
field q{foo bar} with SQL::Statement. In another implementation, you&#39;d use
q{&#34;foo bar&#34;}. In SQL::Statement, that means something else.

&#34;A regular and a delimited identifier are equal if they contain the same
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; characters, taking case into account, but first converting the regular &#40;but
&gt; not the delimited&#41; identifier to all uppercase letters.  In effect a
&gt; delimited identifier that contains lowercase letters can never equal a
&gt; regular identifier although it may equal another delimited one.&#34;
</div>

I have no problem with that. I didn&#39;t know the specifics. According to that
passage, literal q{&#34;FOO&#34;} should equal literal q{foo} and literal q{FOO}.
That&#39;s not the case in SQL::Statement 1.15 &#40;See attached test3.&#41; It&#39;s equal
to neither.

If you think things are as simple as treating q{&#34;foo&#34;} and q{foo} the same,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; how would you handle this perfectly valid syntax: q{CREATE TABLE bar &#40;&#34;foo&#34;
&gt; integer, FOO text&#41;}  ...  q{SELECT &#34;foo&#34; AS foo1, FoO AS foo2 .FROM bar.}
&gt; If there were no indication in the .csv file that the first of those is
&gt; delimited, how would the select statement know which to retrieve?
</div>

It can&#39;t, and this it should give an error. It&#39;s possible to have a query
that&#39;s syntactically valid but cannot be executed. I can&#39;t even execute your
CREATE TABLE in either MySQL or SQLite &#40;&#34;duplicate column name&#34; for both&#41;.
What does need to work is

SELECT foo, bar as &#34;foo&#34; FROM baz

I haven&#39;t suggested anything that would prevent that from working.
Incidentally, that doesn&#39;t work either! &#40;See attached test4.&#41;

    SQL::Statement v1.15

    DBD::CSV::db prepare failed: SQL ERROR: Bad table or column name &#39;bar AS
?QI0?&#39; has chars not alphanumeric or underscore!

     [for Statement &#34;
         SELECT foo, bar AS &#34;foo&#34;
            FROM TestTable4
       &#34;] at C:\Documents and Settings\ikegami\Desktop\New Folder\test4.pl
line 42.



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I understand that you don&#39;t like the way things operate but in this case,
&gt; you haven&#39;t shown that my way of doing it breaks any standard  or that you
&gt; have a solution which would work without breaking the standard.
</div>

If I have a column named q{foo}, I cannot access it with q{&#34;foo&#34;} using
SQL::Statement.
If I have a column named q{foo bar}, I cannot access it using
SQL::Statement.
If I have a column named q{text}, I cannot access it using SQL::Statement.

So which is it?
- The standard doesn&#39;t have a method of accessing those columns.
- SQL::Statement implement the method of accessing those columns.
- I don&#39;t know how to craft an SQL statement to access those columns.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;18:36:26&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> IKEGAMI [...] cpan.org, Dan [...] dwright.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Jan 2009 18:36:12 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">2009/1/2 ikegami@adaelis.com via RT &lt;bug-SQL-Statement@rt.cpan.org&gt;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; If I have a column named q{foo}, I cannot access it with q{&#34;foo&#34;} using
&gt; SQL::Statement.
&gt; If I have a column named q{foo bar}, I cannot access it using
&gt; SQL::Statement.
&gt; If I have a column named q{text}, I cannot access it using SQL::Statement.
&gt;
&gt; So which is it?
&gt; - The standard doesn&#39;t have a method of accessing those columns.
&gt; - SQL::Statement implement the method of accessing those columns.
&gt; - I don&#39;t know how to craft an SQL statement to access those columns.
</div>

That should be

- The standard doesn&#39;t have a method of accessing those last two columns.
- SQL::Statement doesn&#39;t implement the standard method of accessing those
last two columns.
- I don&#39;t know how to craft an SQL statement to access those last two
columns.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;02&nbsp;23:41:16&nbsp;2009</span>
    <span class="description">dubzed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, Jens Rehsack &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 02 Jan 2009 20:40:58 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The most common cases of using delimiters to access table and column 
names that would otherwise be invalid &#40;e.g. at table name of &#34;test.csv&#34; 
or a column named &#34;has space&#34; or &#34;text&#34;&#41; are handled by S::S as shown in 
the attached test in which S::S works the same as SQLite and better than 
MySQL.  So everything you ask about is supported in terms of the SQL 
syntax.  What isn&#39;t supported is accessing files that were not created 
with SQL syntax but were instead created by another process or by hand.  
In those cases you need to either edit the file, change the process, or 
munge the column names with $dbh-&gt;{csv_tables}.  If you know of a way 
that would support both SQL created names and hand-created names and 
still object when undelimited invalid names are used, please let me know.


Jeff


Eric Brine wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; On Fri, Jan 2, 2009 at 4:25 PM, dubzed &lt;dubzed@gmail.com 
&gt; &lt;mailto:dubzed@gmail.com&gt;&gt; wrote:
&gt;
&gt;     Eric Brine wrote:
&gt;
&gt;         This means that spaces can never be present in an identifier
&gt;         unless if also starts and ends with quotes. This sucks.
&gt;
&gt;     No other implementation allows you &#40;or should if it pretends to be
&gt;     valid&#41; to put spaces in column names without delimiting them with
&gt;     quotes.
&gt;
&gt;
&gt; That&#39;s not what I said. Let&#39;s use an example: It&#39;s impossible to 
&gt; address field q{foo bar} with SQL::Statement. In another 
&gt; implementation, you&#39;d use q{&#34;foo bar&#34;}. In SQL::Statement, that means 
&gt; something else.
&gt;
&gt;     &#34;A regular and a delimited identifier are equal if they contain
&gt;     the same characters, taking case into account, but first
&gt;     converting the regular &#40;but not the delimited&#41; identifier to all
&gt;     uppercase letters.  In effect a delimited identifier that contains
&gt;     lowercase letters can never equal a regular identifier although it
&gt;     may equal another delimited one.&#34;
&gt;
&gt;
&gt; I have no problem with that. I didn&#39;t know the specifics. According to 
&gt; that passage, literal q{&#34;FOO&#34;} should equal literal q{foo} and literal 
&gt; q{FOO}. That&#39;s not the case in SQL::Statement 1.15 &#40;See attached 
&gt; test3.&#41; It&#39;s equal to neither.
&gt;
&gt;     If you think things are as simple as treating q{&#34;foo&#34;} and q{foo}
&gt;     the same, how would you handle this perfectly valid syntax:
&gt;     q{CREATE TABLE bar &#40;&#34;foo&#34; integer, FOO text&#41;}  ...  q{SELECT &#34;foo&#34;
&gt;     AS foo1, FoO AS foo2 .FROM bar.}   If there were no indication in
&gt;     the .csv file that the first of those is delimited, how would the
&gt;     select statement know which to retrieve?
&gt;
&gt;
&gt; It can&#39;t, and this it should give an error. It&#39;s possible to have a 
&gt; query that&#39;s syntactically valid but cannot be executed. I can&#39;t even 
&gt; execute your CREATE TABLE in either MySQL or SQLite &#40;&#34;duplicate column 
&gt; name&#34; for both&#41;. What does need to work is
&gt;
&gt; SELECT foo, bar as &#34;foo&#34; FROM baz
&gt;
&gt; I haven&#39;t suggested anything that would prevent that from working. 
&gt; Incidentally, that doesn&#39;t work either! &#40;See attached test4.&#41;
&gt;
&gt;     SQL::Statement v1.15
&gt;
&gt;     DBD::CSV::db prepare failed: SQL ERROR: Bad table or column name 
&gt; &#39;bar AS ?QI0?&#39; has chars not alphanumeric or underscore!
&gt;
&gt;      [for Statement &#34;
&gt;          SELECT foo, bar AS &#34;foo&#34;
&gt;             FROM TestTable4
&gt;        &#34;] at C:\Documents and Settings\ikegami\Desktop\New 
&gt; Folder\test4.pl line 42.
&gt;
&gt;  
&gt;
&gt;     I understand that you don&#39;t like the way things operate but in
&gt;     this case, you haven&#39;t shown that my way of doing it breaks any
&gt;     standard  or that you have a solution which would work without
&gt;     breaking the standard.
&gt;
&gt;
&gt; If I have a column named q{foo}, I cannot access it with q{&#34;foo&#34;} 
&gt; using SQL::Statement.
&gt; If I have a column named q{foo bar}, I cannot access it using 
&gt; SQL::Statement.
&gt; If I have a column named q{text}, I cannot access it using SQL::Statement.
&gt;
&gt; So which is it?
&gt; - The standard doesn&#39;t have a method of accessing those columns.
&gt; - SQL::Statement implement the method of accessing those columns.
&gt; - I don&#39;t know how to craft an SQL statement to access those columns.
&gt;
</div></div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl
use warnings;
use strict;
use DBI;

my &#40;$user,$pass&#41; = qw&#40; jeff xxx &#41;;
test&#40;$_&#41; for qw&#40; dbi:CSV: dbi:SQLite: dbi:mysql:database=test &#41;;

sub test {
    my $dsn = shift;
    my $dbh = DBI-&gt;connect&#40; $dsn, $user, $pass, {
        RaiseError =&gt; 1,
        PrintError =&gt; 0,
        AutoCommit =&gt; 1,
    }&#41;;
    if&#40; $dsn =~ /mysql/ &#41; {
        # NOTE : mysql only uses double quotes as delims if in ANSI mode
        # 
        $dbh-&gt;do&#40;$_&#41; for split&#40;/;\n/,q{
	    SET GLOBAL TRANSACTION ISOLATION LEVEL SERIALIZABLE;
            SET GLOBAL sql_mode = &#39;ANSI&#39;
        }&#41;;
    }
    $dbh-&gt;do&#40;$_&#41; for  split&#40;/;\n/, q{
        DROP TABLE IF EXISTS test;
        CREATE TABLE test &#40;&#34;name with spaces&#34; INT, &#34;text&#34; TEXT&#41;;
        INSERT INTO test VALUES &#40;3, &#39;foo&#39; &#41;
    }&#41;;
    print &#34;$dsn\n&#34;;
    print &#34;   delimited column names :ok!\n&#34; 
        if &#39;foo&#39; eq $dbh-&gt;selectrow_array&#40;q{
            SELECT &#34;text&#34; FROM test WHERE &#34;name with spaces&#34; = 3
        }
    &#41;;

    $dbh-&gt;do&#40;$_&#41; for  split&#40;/;\n/, q{
        DROP TABLE IF EXISTS &#34;test.csv&#34;;
        CREATE TABLE &#34;test.csv&#34; &#40;&#34;name with spaces&#34; INT, &#34;text&#34; TEXT&#41;;
        INSERT INTO &#34;test.csv&#34; VALUES &#40;3, &#39;bar&#39; &#41;
    }&#41;;
    # NOTE : mysql fails this, it doesn&#39;t support &#34;test.csv&#34; as a table name
    # even if delimited, this seems like one of the most likely and useful
    # uses of delimited identifiers with S::S
    #
    print &#34;   delimited table names :ok!\n&#34; 
        if &#39;bar&#39; eq $dbh-&gt;selectrow_array&#40;q{
            SELECT &#34;text&#34; FROM &#34;test.csv&#34; WHERE &#34;name with spaces&#34; = 3
        }
    &#41;;

}
__END__
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;02:25:08&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, &#34;Jens Rehsack&#34; &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 3 Jan 2009 02:24:54 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Jan 2, 2009 at 11:40 PM, dubzed &lt;dubzed@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The most common cases of using delimiters to access table and column names
&gt; that would otherwise be invalid &#40;e.g. at table name of &#34;test.csv&#34; or a
&gt; column named &#34;has space&#34; or &#34;text&#34;&#41; are handled by S::S as shown in the
&gt; attached test
</div>

No it doesn&#39;t. The attached test works with a column named q{&#34;has space&#34;},
not q{has space}

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">---BEGIN---
&#34;&#34;&#34;name with spaces&#34;&#34;&#34;,&#34;&#34;&#34;text&#34;&#34;&#34;
3,bar
---END---

should be

<div class="message-stanza open">---BEGIN---
&#34;name with spaces&#34;,&#34;text&#34;
3,bar
---END---
</div></div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;02:35:47&nbsp;2009</span>
    <span class="description">dubzed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, Jens Rehsack &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 02 Jan 2009 23:35:32 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Eric Brine wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; On Fri, Jan 2, 2009 at 11:40 PM, dubzed &lt;dubzed@gmail.com 
&gt; &lt;mailto:dubzed@gmail.com&gt;&gt; wrote:
&gt;
&gt;     The most common cases of using delimiters to access table and
&gt;     column names that would otherwise be invalid &#40;e.g. at table name
&gt;     of &#34;test.csv&#34; or a column named &#34;has space&#34; or &#34;text&#34;&#41; are handled
&gt;     by S::S as shown in the attached test
&gt;
&gt;
&gt; No it doesn&#39;t. The attached test works with a column named q{&#34;has 
&gt; space&#34;}, not q{has space}
</div>
You are talking about what the column is named in the text file.  I am 
talking about how the column is referred to in the syntax.  One of the 
points of S::S is to allow similar kinds of syntax to be used as is used 
in other implementations.  It accomplishes that.   Because you don&#39;t 
like how the resulting text file looks has nothing to do with how well 
or poorly the SQL syntax is implemented.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; ---BEGIN---
&gt; &#34;&#34;&#34;name with spaces&#34;&#34;&#34;,&#34;&#34;&#34;text&#34;&#34;&#34;
&gt; 3,bar
&gt; ---END---
&gt;
&gt; should be
&gt;
&gt; ---BEGIN---
&gt; &#34;name with spaces&#34;,&#34;text&#34;
&gt; 3,bar
&gt; ---END---
&gt;
</div>
If it was that way, when S::S opened the file, how would it know that it 
should not object to &#34;name with spaces&#39; - or do you want it not to check 
for valid names at all?

-- 
Jeff
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;02:46:07&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, &#34;Jens Rehsack&#34; &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 3 Jan 2009 02:45:53 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[ I rushed reply, so I&#39;m redoing it. ]

On Fri, Jan 2, 2009 at 11:40 PM, dubzed &lt;dubzed@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The most common cases of using delimiters to access table and column names
&gt; that would otherwise be invalid &#40;e.g. at table name of &#34;test.csv&#34; or a
&gt; column named &#34;has space&#34; or &#34;text&#34;&#41; are handled by S::S as shown in the
&gt; attached test in which S::S works the same as SQLite
</div>

No it doesn&#39;t. When SQLite is used, a column named q{has space} is created.
When SQL::Statement is used, a column named q{&#34;has space&#34;} is created.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">---BEGIN---
&#34;&#34;&#34;name with spaces&#34;&#34;&#34;,&#34;&#34;&#34;text&#34;&#34;&#34;
3,bar
---END---

should be

<div class="message-stanza open">---BEGIN---
&#34;name with spaces&#34;,&#34;text&#34;
3,bar
---END---

So everything you ask about is supported in terms of the SQL syntax.


SQL::Statement supports the *syntax*, but the *semantics* are different.
That&#39;s the bug I&#39;m reporting.

 If you know of a way that would support both SQL created names and
<div class="message-stanza open">&gt; hand-created names and still object when undelimited invalid names are used,
&gt; please let me know.
</div>

You said you wanted it to behave like in the passage you quoted, so what&#39;s
stopping you from doing that? If it&#39;s unquoted, make it uppercase &#40;literal
q{foo} becomes identifier q{FOO}&#41;. If it&#39;s quoted, keep the case &#40;literal
q{&#34;foo&#34;} becomes identifier q{foo}&#41;.
</div></div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;06:36:36&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, &#34;Jens Rehsack&#34; &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 3 Jan 2009 06:35:42 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, Jan 3, 2009 at 2:35 AM, dubzed &lt;dubzed@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Eric Brine wrote:
&gt;
</div>No it doesn&#39;t. The attached test works with a column named q{&#34;has space&#34;},
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; not q{has space}
&gt;&gt;
</div>&gt;
&gt; You are talking about what the column is named in the text file.  I am
&gt; talking about how the column is referred to in the syntax.  One of the
&gt; points of S::S is to allow similar kinds of syntax to be used as is used in
&gt; other implementations.  It accomplishes that.   Because you don&#39;t like how
&gt; the resulting text file looks has nothing to do with how well or poorly the
&gt; SQL syntax is implemented.
</div>

This bug report is not about the syntax. I don&#39;t know why you keep bringing
that up.

Are you saying the problem is in DBD::CSV, that it should parse the SQL
identifier to extract the column name?


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ---BEGIN---
<div class="message-stanza open">&gt;&gt; &#34;&#34;&#34;name with spaces&#34;&#34;&#34;,&#34;&#34;&#34;text&#34;&#34;&#34;
&gt;&gt; 3,bar
&gt;&gt; ---END---
&gt;&gt;
&gt;&gt; should be
&gt;&gt;
&gt;&gt; ---BEGIN---
&gt;&gt; &#34;name with spaces&#34;,&#34;text&#34;
&gt;&gt; 3,bar
&gt;&gt; ---END---
&gt;&gt;
&gt;&gt;
</div>&gt; If it was that way, when S::S opened the file, how would it know that it
&gt; should not object to &#34;name with spaces&#39; - or do you want it not to check for
&gt; valid names at all?
&gt;
</div>
I don&#39;t understand the question.
S::S should object to column names it can&#39;t handle.
S::S shouldn&#39;t object to column names it can handle.

q{name with spaces} is a valid column name.
It would appear as q{&#34;name with spaces&#34;} in a CSV file, but S::S need not
ever know that.
It would appear as q{&#34;name with spaces&#34;} in an SQL statement.

Do you really not know the difference between a literal and an identifier?
In Perl, &#34;foo bar&#34; is a 9 character literal that represents a 7 character
long string.
In CSV, &#34;foo bar&#34; is a 9 character literal that represents a 7 character
long column name.
In SQL, &#34;foo bar&#34; is a 9 character literal that represents a 7 character
long column name.
In S::S, &#34;foo bar&#34; is a 9 character literal that represents a 9 character
long column name.
This is the bug I&#39;m reporting.

Eric &#34;ikegami&#34; Brine
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;07:17:19&nbsp;2009</span>
    <span class="description">rehsack [...] web.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;, bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 03 Jan 2009 12:12:26 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jens Rehsack &lt;rehsack [...] web.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Eric, hi Jeff,

I read your entire mail tree and must give up understanding your arguments. 
But I tried the 2 submitted tests Eric provided with 1.16_03 - test3 works, 
test4 don&#39;t. I just ask myself, why does Eric modify the csv_tables in the 
DBD::CSV-Instance?

Eric:
        SELECT &#34;MY COL WITH SPACES&#34; FROM &#34;MY TABLE WITH SPACES&#34;
will select a column q{MY COL WITH SPACES} &#40;as one identifier&#41; from table 
q{MY TABLE WITH SPACES}, regardless how they are internally represented.

If you want to demonstrate an SQL::Statement bug, please don&#39;t modify in 
DBD::CSV, use SQL::Statement as described in 
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/perldoc?SQL::Statement::Structure">http://search.cpan.org/perldoc?SQL::Statement::Structure</a></span> to create the 
tables, insert some data and dump them. This time I will do it and add a 
test for it - it was just for the next time&#40;s&#41;.

Best regards,
Jens
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;13:51:31&nbsp;2009</span>
    <span class="description">dubzed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;, Jens Rehsack &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 03 Jan 2009 10:51:15 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">ikegami@adaelis.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: SQL-Statement
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=34121">http://rt.cpan.org/Ticket/Display.html?id=34121</a></span> &gt;
&gt;
&gt; On Sat, Jan 3, 2009 at 2:35 AM, dubzed &lt;dubzed@gmail.com&gt; wrote:
&gt;
&gt;   
<div class="message-stanza open">&gt;&gt; Eric Brine wrote:
&gt;&gt;
&gt;&gt;     
</div>&gt; No it doesn&#39;t. The attached test works with a column named q{&#34;has space&#34;},
&gt;   
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt;&gt; not q{has space}
&gt;&gt;&gt;
&gt;&gt;&gt;       
</div>&gt;&gt; You are talking about what the column is named in the text file.  I am
&gt;&gt; talking about how the column is referred to in the syntax.  One of the
&gt;&gt; points of S::S is to allow similar kinds of syntax to be used as is used in
&gt;&gt; other implementations.  It accomplishes that.   Because you don&#39;t like how
&gt;&gt; the resulting text file looks has nothing to do with how well or poorly the
&gt;&gt; SQL syntax is implemented.
&gt;&gt;     
</div>&gt;
&gt;
&gt; This bug report is not about the syntax. I don&#39;t know why you keep bringing
&gt; that up.
&gt;
&gt;   
</div>Because we are discussing S::S whose purpose is to provide SQL syntax 
support.  It is used for many purposes only some of which apply to 
DBD::CSV - other DBDs, parsing of SQL dumps, etc.    And what you are 
reporting is not symantics, it is an internal storage detail.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Are you saying the problem is in DBD::CSV, that it should parse the SQL
&gt; identifier to extract the column name?
&gt;
&gt;
&gt;   
<div class="message-stanza open">&gt;&gt; ---BEGIN---
&gt;&gt;     
<div class="message-stanza open">&gt;&gt;&gt; &#34;&#34;&#34;name with spaces&#34;&#34;&#34;,&#34;&#34;&#34;text&#34;&#34;&#34;
&gt;&gt;&gt; 3,bar
&gt;&gt;&gt; ---END---
&gt;&gt;&gt;
&gt;&gt;&gt; should be
&gt;&gt;&gt;
&gt;&gt;&gt; ---BEGIN---
&gt;&gt;&gt; &#34;name with spaces&#34;,&#34;text&#34;
&gt;&gt;&gt; 3,bar
&gt;&gt;&gt; ---END---
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;       
</div>&gt;&gt; If it was that way, when S::S opened the file, how would it know that it
&gt;&gt; should not object to &#34;name with spaces&#39; - or do you want it not to check for
&gt;&gt; valid names at all?
&gt;&gt;
&gt;&gt;     
</div>&gt;
&gt; I don&#39;t understand the question.
&gt; S::S should object to column names it can&#39;t handle.
&gt; S::S shouldn&#39;t object to column names it can handle.\
&gt;   
</div>
That&#39;s absurd.  SQL Statement should behave like every other RDBMS in 
this respect - it should not accept identifiers that are not valid in 
the SQL standard.  It should tell the user their syntax is broken and 
refuse to use them. Otherwise it would be completely incompatible with 
other RDBMSs.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; q{name with spaces} is a valid column name.
&gt;   
</div>No it is not a SQL &#39;92 valid column unless it is delimited. In what 
possible sense could you use the word &#34;valid&#34; for it?
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It would appear as q{&#34;name with spaces&#34;} in a CSV file, but S::S need not
&gt; ever know that.
&gt;   
</div>No it can&#39;t appear like that in the file.  If it appears like that in 
the file there is no way for S::S to treat it as a valid identifier 
because it isn&#39;t one. &#40;well it can appear in the file but you can&#39;t 
expect S::S to handle it unless you munge it first&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It would appear as q{&#34;name with spaces&#34;} in an SQL statement.
&gt;
&gt; Do you really not know the difference between a literal and an identifier?
&gt;   
</div>
Do you really not know the difference between a SQL valid identifier and 
one that isn&#39;t?

-- 
Jeff

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In Perl, &#34;foo bar&#34; is a 9 character literal that represents a 7 character
&gt; long string.
&gt; In CSV, &#34;foo bar&#34; is a 9 character literal that represents a 7 character
&gt; long column name.
&gt; In SQL, &#34;foo bar&#34; is a 9 character literal that represents a 7 character
&gt; long column name.
&gt; In S::S, &#34;foo bar&#34; is a 9 character literal that represents a 9 character
&gt; long column name.
&gt; This is the bug I&#39;m reporting.
&gt;
&gt; Eric &#34;ikegami&#34; Brine
&gt;
&gt;   
&gt;
&gt; ------------------------------------------------------------------------
&gt;
&gt;
&gt;
&gt; On Sat, Jan 3, 2009 at 2:35 AM, dubzed &lt;dubzed@gmail.com 
&gt; &lt;mailto:dubzed@gmail.com&gt;&gt; wrote:
&gt;
&gt;     Eric Brine wrote:
&gt;
&gt;         No it doesn&#39;t. The attached test works with a column named
&gt;         q{&#34;has space&#34;}, not q{has space}
&gt;
&gt;
&gt;     You are talking about what the column is named in the text file.
&gt;      I am talking about how the column is referred to in the syntax.
&gt;      One of the points of S::S is to allow similar kinds of syntax to
&gt;     be used as is used in other implementations.  It accomplishes
&gt;     that.   Because you don&#39;t like how the resulting text file looks
&gt;     has nothing to do with how well or poorly the SQL syntax is
&gt;     implemented.
&gt;
&gt;
&gt; This bug report is not about the syntax. I don&#39;t know why you keep 
&gt; bringing that up.
&gt;
&gt; Are you saying the problem is in DBD::CSV, that it should parse the 
&gt; SQL identifier to extract the column name?
&gt;  
&gt;
&gt;         ---BEGIN---
&gt;         &#34;&#34;&#34;name with spaces&#34;&#34;&#34;,&#34;&#34;&#34;text&#34;&#34;&#34;
&gt;         3,bar
&gt;         ---END---
&gt;
&gt;         should be
&gt;
&gt;         ---BEGIN---
&gt;         &#34;name with spaces&#34;,&#34;text&#34;
&gt;         3,bar
&gt;         ---END---
&gt;
&gt;
&gt;     If it was that way, when S::S opened the file, how would it know
&gt;     that it should not object to &#34;name with spaces&#39; - or do you want
&gt;     it not to check for valid names at all?
&gt;
&gt;
&gt; I don&#39;t understand the question.
&gt; S::S should object to column names it can&#39;t handle.
&gt; S::S shouldn&#39;t object to column names it can handle.
&gt;
&gt; q{name with spaces} is a valid column name.
&gt; It would appear as q{&#34;name with spaces&#34;} in a CSV file, but S::S need 
&gt; not ever know that.
&gt; It would appear as q{&#34;name with spaces&#34;} in an SQL statement.
&gt;
&gt; Do you really not know the difference between a literal and an identifier?
&gt; In Perl, &#34;foo bar&#34; is a 9 character literal that represents a 7 
&gt; character long string.
&gt; In CSV, &#34;foo bar&#34; is a 9 character literal that represents a 7 
&gt; character long column name.
&gt; In SQL, &#34;foo bar&#34; is a 9 character literal that represents a 7 
&gt; character long column name.
&gt; In S::S, &#34;foo bar&#34; is a 9 character literal that represents a 9 
&gt; character long column name.
&gt; This is the bug I&#39;m reporting.
&gt;
&gt; Eric &#34;ikegami&#34; Brine
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;22:56:56&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, &#34;Jens Rehsack&#34; &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 3 Jan 2009 22:56:41 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, Jan 3, 2009 at 1:51 PM, dubzed &lt;dubzed@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Because we are discussing S::S whose purpose is to provide SQL syntax
&gt; support.  It is used for many purposes only some of which apply to DBD::CSV
&gt; - other DBDs, parsing of SQL dumps, etc.    And what you are reporting is
&gt; not symantics, it is an internal storage detail.
</div>
Yes, it&#39;s an internal storage detail that leaks out of interface into its
users such as DBD::CSV. That&#39;s what need to be fixed.

S::S should object to column names it can&#39;t handle.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; S::S shouldn&#39;t object to column names it can handle.
&gt;&gt;
</div>&gt; That&#39;s absurd.  SQL Statement should behave like every other RDBMS in this
&gt; respect - it should not accept identifiers that are not valid in the SQL
&gt; standard.
</div>
That&#39;s exactly what I said, so how is it absurd?

q{name with spaces} is a valid column name.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;
</div>&gt; No it is not a SQL &#39;92 valid column unless it is delimited. In what
&gt; possible sense could you use the word &#34;valid&#34; for it?
</div>
No! q{name with spaces} is a valid table name in MySQL, SQLite, ProgreSQL,
Oracle, DB2, MS SQL, etc. All I&#39;m asking is the same for S::S. Yes, to refer
to the name, you need to delimit it in the SQL &#40;q{&#34;name with spaces&#34;}&#41;, but
the table name is q{name with spaces}.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It would appear as q{&#34;name with spaces&#34;} in a CSV file, but S::S need not
<div class="message-stanza open">&gt;&gt; ever know that.
&gt;&gt;
</div>&gt; No it can&#39;t appear like that in the file.  If it appears like that in the
&gt; file there is no way for S::S to treat it as a valid identifier because it
&gt; isn&#39;t one.
</div>
You say that, but 1.16_03 proves you wrong. And there is a valid literal for
it: q{&#34;name with spaces&#34;}


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Do you really not know the difference between a SQL valid identifier and
&gt; one that isn&#39;t?
&gt;
</div>Do you know the difference between a name and a literal?
q{&#34;name with spaces&#34;} is a literal &#40;appears in the SQL&#41; for the name q{name
with spaces}.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;03&nbsp;23:13:49&nbsp;2009</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-SQL-Statement [...] rt.cpan.org, &#34;Jens Rehsack&#34; &lt;rehsack [...] web.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34121] Confuses literals with identifiers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 3 Jan 2009 23:13:37 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> dubzed &lt;dubzed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eric Brine&#34; &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">What would you think if HTML treated q{abc} differently than q{a&#38;#98;c}?
What would you think if Perl treated q{&#34;foo\nbar&#34;} differently than
q{&#34;foo\012bar&#34;}?
What would you think if S::S treated q{&#34;FOO&#34;} differently than q{foo}?

literals appears in source   strings they represent
--------------------------   ----------------------
q{a&#38;#98;c}          &#40;HTML&#41;   abc
q{&#34;foo\nbar&#34;}       &#40;Perl&#41;   &#40;something with newlines&#41;
q{&#34;name&#34;}           &#40;SQL&#41;    name
name                &#40;SQL&#41;    NAME
q{&#34;name&#34;}           &#40;S::S&#41;   &#34;name&#34;           XXX
name                &#40;S::S&#41;   name&#40;?&#41;          XXX&#40;?&#41;

Unless you have a question for me, there&#39;s really nothing further I can say
short of writing the fix. Fortunately, Jens Rehsack seems to understand and
already wrote it as 1.16_03. Thanks.

- Eric
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;19&nbsp;03:56:54&nbsp;2009</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The original problem is solved and the submitter provides some
additional tests to allow fix some more issues test-driven :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;19&nbsp;03:56:56&nbsp;2009</span>
    <span class="description">REHSACK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
