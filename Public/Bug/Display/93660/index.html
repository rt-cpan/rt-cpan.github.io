<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #93660 for HTML-Tree: Entity &#39;ndash&#39; converts to Octal&#40;342,200,223&#41;, want 226</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #93660 for HTML-Tree: Entity &#39;ndash&#39; converts to Octal&#40;342,200,223&#41;, want 226</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/HTML-Tree/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/HTML-Tree/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/HTML-Tree/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/HTML-Tree/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/HTML-Tree">HTML-Tree CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">93660</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/HTML-Tree/Active/">HTML-Tree</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
alexander.danel [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-16146-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
5.03    </td>
  </tr>
  <tr id="CF-16147-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;18:03:43&nbsp;2014</span>
    <span class="description">alexander.danel [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Entity &#39;ndash&#39; converts to Octal&#40;342,200,223&#41;, want 226</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The entity &#39;ndash&#39; converts to three octal bytes: 342, 200, 223.  This is also true for the entity &#39;#8209&#39;.  When sent through HTML::PrettyPrinter-&gt;format&#40;&#41; this causes the warning &#34;Wide character in print...&#34;, and the result is incorrect.

It seems to me these entities should be converted to the single character \o{226}, which is decimal 150; which is &#34;en dash&#34;.

Setting &#34;$root-&gt;no_expand_entities&#40;1&#41;;&#34; is not helpful; the entity stays unexpanded, then PrettyPrinter does not recognize that it is an entity and converts the leading &#39;&#38;&#39; into &#34;&#38;amp&#34; for every entity in the document.  &#40;And, I don&#39;t want to turn off conversion, because there might be real ampersands.&#41;

My work-around will be to convert these ndash entities into normal hyphen characters.

I am working in a CygWin environment.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;18:32:13&nbsp;2014</span>
    <span class="description">alexander.danel [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> alexander.danel [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Mar 08 18:03:43 2014, alexander.danel@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The entity &#39;ndash&#39; converts to three octal bytes: 342, 200, 223.  This
&gt; is also true for the entity &#39;#8209&#39;.  When sent through
&gt; HTML::PrettyPrinter-&gt;format&#40;&#41; this causes the warning &#34;Wide character
&gt; in print...&#34;, and the result is incorrect.
&gt; 
&gt; It seems to me these entities should be converted to the single
&gt; character \o{226}, which is decimal 150; which is &#34;en dash&#34;.
&gt; 
&gt; Setting &#34;$root-&gt;no_expand_entities&#40;1&#41;;&#34; is not helpful; the entity
&gt; stays unexpanded, then PrettyPrinter does not recognize that it is an
&gt; entity and converts the leading &#39;&#38;&#39; into &#34;&#38;amp&#34; for every entity in
&gt; the document.  &#40;And, I don&#39;t want to turn off conversion, because
&gt; there might be real ampersands.&#41;
&gt; 
&gt; My work-around will be to convert these ndash entities into normal
&gt; hyphen characters.
&gt; 
&gt; I am working in a CygWin environment.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;18:42:18&nbsp;2014</span>
    <span class="description">alexander.danel [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> alexander.danel [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">OK, well, once again, I may need to withdraw my ticket minutes after creating it.

I seem to be having two issues:

&#40;1&#41; There might be a problem in HTML::Entities, rather than HTML::Tree.  I just looked into the &#34;Entities.pm&#34; file, and found this:

    &#39;ndash;&#39;    =&gt; chr&#40;8211&#41;,

This should probably say &#34;8209&#34;, not &#34;8211&#34;.

&#40;2&#41; There doesn&#39;t seem to be an easy way to tell PrettyPrint that ALL entities should be converted.  &#40;Any advice?&#41;

Sorry to be causing trouble, but I am trying to be helpful, not trying to be a pain.

Alexander Danel
# -----------------------------------
On Sat Mar 08 18:03:43 2014, alexander.danel@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The entity &#39;ndash&#39; converts to three octal bytes: 342, 200, 223.  This
&gt; is also true for the entity &#39;#8209&#39;.  When sent through
&gt; HTML::PrettyPrinter-&gt;format&#40;&#41; this causes the warning &#34;Wide character
&gt; in print...&#34;, and the result is incorrect.
&gt; 
&gt; It seems to me these entities should be converted to the single
&gt; character \o{226}, which is decimal 150; which is &#34;en dash&#34;.
&gt; 
&gt; Setting &#34;$root-&gt;no_expand_entities&#40;1&#41;;&#34; is not helpful; the entity
&gt; stays unexpanded, then PrettyPrinter does not recognize that it is an
&gt; entity and converts the leading &#39;&#38;&#39; into &#34;&#38;amp&#34; for every entity in
&gt; the document.  &#40;And, I don&#39;t want to turn off conversion, because
&gt; there might be real ampersands.&#41;
&gt; 
&gt; My work-around will be to convert these ndash entities into normal
&gt; hyphen characters.
&gt; 
&gt; I am working in a CygWin environment.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;19:22:22&nbsp;2014</span>
    <span class="description">alexander.danel [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> alexander.danel [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Just checked Wikipedia, it lists char&#40;8211&#41; as &#34;en dash&#34;, so that agrees with HTML::Entities.

I can tell you that for both entities I mentioned, &#39;&#38;#8209;&#39; and &#39;&#38;ndash;&#39;, when processed by HTML::TreeBuilder and then by HTML::PrettyPrinter, get converted to three octal bytes; for &#39;8209&#39; the result is [342 200 221] and for &#39;ndash&#39; it is [342 220 223].  

Somehow, these represent decimal 8209 and 8211, I guess. &#40;I don&#39;t get how, but that&#39;s besides the point.&#41; 

The reason I got interested in &#38;#8209; is because I have a Microsoft Word document that uses that entity for the minus in &#34;N-1&#34; and the hyphen in &#34;x-ray&#34;.

Alexander Danel
# -------------------------------------
On Sat Mar 08 18:42:18 2014, alexander.danel@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; OK, well, once again, I may need to withdraw my ticket minutes after
&gt; creating it.
&gt; 
&gt; I seem to be having two issues:
&gt; 
&gt; &#40;1&#41; There might be a problem in HTML::Entities, rather than
&gt; HTML::Tree.  I just looked into the &#34;Entities.pm&#34; file, and found
&gt; this:
&gt; 
&gt; &#39;ndash;&#39;    =&gt; chr&#40;8211&#41;,
&gt; 
&gt; This should probably say &#34;8209&#34;, not &#34;8211&#34;.
&gt; 
&gt; &#40;2&#41; There doesn&#39;t seem to be an easy way to tell PrettyPrint that ALL
&gt; entities should be converted.  &#40;Any advice?&#41;
&gt; 
&gt; Sorry to be causing trouble, but I am trying to be helpful, not trying
&gt; to be a pain.
&gt; 
&gt; Alexander Danel
&gt; # -----------------------------------
&gt; On Sat Mar 08 18:03:43 2014, alexander.danel@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; The entity &#39;ndash&#39; converts to three octal bytes: 342, 200, 223.
&gt; &gt; This
&gt; &gt; is also true for the entity &#39;#8209&#39;.  When sent through
&gt; &gt; HTML::PrettyPrinter-&gt;format&#40;&#41; this causes the warning &#34;Wide character
&gt; &gt; in print...&#34;, and the result is incorrect.
&gt; &gt;
&gt; &gt; It seems to me these entities should be converted to the single
&gt; &gt; character \o{226}, which is decimal 150; which is &#34;en dash&#34;.
&gt; &gt;
&gt; &gt; Setting &#34;$root-&gt;no_expand_entities&#40;1&#41;;&#34; is not helpful; the entity
&gt; &gt; stays unexpanded, then PrettyPrinter does not recognize that it is an
&gt; &gt; entity and converts the leading &#39;&#38;&#39; into &#34;&#38;amp&#34; for every entity in
&gt; &gt; the document.  &#40;And, I don&#39;t want to turn off conversion, because
&gt; &gt; there might be real ampersands.&#41;
&gt; &gt;
&gt; &gt; My work-around will be to convert these ndash entities into normal
&gt; &gt; hyphen characters.
&gt; &gt;
&gt; &gt; I am working in a CygWin environment.
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;22:43:39&nbsp;2014</span>
    <span class="description">cjm [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This kind of question is much more appropriate for <span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/">http://stackoverflow.com/</a></span>  HTML-Tree is a long-established and heavily used module.  If its basic functionality isn&#39;t working, you should assume you&#39;re doing something wrong.  Please don&#39;t report a bug unless you&#39;re sure it&#39;s really a problem with the module.

You didn&#39;t give a sample program to illustrate the problem you&#39;re having, but I&#39;m guessing you haven&#39;t set the proper encoding on your output filehandle.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Somehow, these represent decimal 8209 and 8211, I guess. &#40;I don&#39;t get how, but that&#39;s besides the point.&#41;
</div>
<span class="clickylink"><a target="new" rel="nofollow" href="http://en.wikipedia.org/wiki/UTF-8">http://en.wikipedia.org/wiki/UTF-8</a></span>

Here are some other links you should read up on:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.joelonsoftware.com/articles/Unicode.html">http://www.joelonsoftware.com/articles/Unicode.html</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://perldoc.perl.org/perlunicode.html">http://perldoc.perl.org/perlunicode.html</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.simon-cozens.org/content/everything-you-need-know-about-unicode">http://www.simon-cozens.org/content/everything-you-need-know-about-unicode</a></span>

&#38;#8209; is not an en-dash.  It is Unicode Character &#39;NON-BREAKING HYPHEN&#39; U+2011 &#40;Unicode codepoints are normally written in hexadecimal notation&#41;.  <span class="clickylink"><a target="new" rel="nofollow" href="http://www.fileformat.info/info/unicode/char/2011/index.htm">http://www.fileformat.info/info/unicode/char/2011/index.htm</a></span>  In other words, it&#39;s a hyphen that word-wrapping code is not supposed to allow a line-break after.

Here&#39;s what I pass to HTML::PrettyPrinter for entity encoding when I want all non-ASCII chars as entities:

  entities =&gt; do { &#34;&lt;&gt;&#38;\x7F-\x{10FFFF}&#34; }

The &#34;no warnings &#39;utf8&#39;;&#34; suppresses a warning in some versions of Perl &#40;complaining that U+10FFFF hasn&#39;t actually been allocated yet&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;22:43:40&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;22:43:43&nbsp;2014</span>
    <span class="description">cjm [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;22:47:08&nbsp;2014</span>
    <span class="description">cjm [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">That was supposed to be

  entities =&gt; do { no warnings &#39;utf8&#39;; &#34;&lt;&gt;&#38;\x7F-\x{10FFFF}&#34; }
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;22:53:31&nbsp;2014</span>
    <span class="description">alexander.danel [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> alexander.danel [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">So, I have a work-around, and my problem was with &#34;PrettyPrinter.pm&#34;; sorry for the drama.

My workaround is:

$prettyPrinter-&gt;entities&#40;$prettyPrinter-&gt;entities&#40;&#41; 
                        . &#34;\o{200}-\o{377}&#34;
                        . &#34;\o{400}-\o{177777}&#34;
                        &#41;;

I looked into the &#34;PrettyPrinter.pm&#34; file and found that is calls &#34;as_HTML&#40;&#41;&#34; and &#34;encode_entities&#40;&#41;&#34;.  In contrast to &#34;as_HTML&#40;&#41;&#34;, which allows &#34;undef&#34; to stand for &#34;all unsafe values&#34;, PrettyPrinter does not allow &#34;undef&#34; as a value; probably because of the attempt to be clever in creating the &#34;setter&#34; routines.  I read the &#34;Entities.pm&#34; code, and decided to try a range that goes beyond &#34;\377&#34; and was surprised to find it worked; I didn&#39;t know Perl does that.  

$ perl -e &#39;print &#34;\o{400}-\o{177777}\n&#34;;&#39; | od -c
Wide character in print at -e line 1.
0000000 304 200   - 357 277 277  \n

Again, sorry for the &#34;sky is falling&#34; messages.

Alexander Danel
# --------------------

On Sat Mar 08 19:22:22 2014, alexander.danel@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Just checked Wikipedia, it lists char&#40;8211&#41; as &#34;en dash&#34;, so that
&gt; agrees with HTML::Entities.
&gt; 
&gt; I can tell you that for both entities I mentioned, &#39;&#38;#8209;&#39; and
&gt; &#39;&#38;ndash;&#39;, when processed by HTML::TreeBuilder and then by
&gt; HTML::PrettyPrinter, get converted to three octal bytes; for &#39;8209&#39;
&gt; the result is [342 200 221] and for &#39;ndash&#39; it is [342 220 223].
&gt; 
&gt; Somehow, these represent decimal 8209 and 8211, I guess. &#40;I don&#39;t get
&gt; how, but that&#39;s besides the point.&#41;
&gt; 
&gt; The reason I got interested in &#38;#8209; is because I have a Microsoft
&gt; Word document that uses that entity for the minus in &#34;N-1&#34; and the
&gt; hyphen in &#34;x-ray&#34;.
&gt; 
&gt; Alexander Danel
&gt; # -------------------------------------
&gt; On Sat Mar 08 18:42:18 2014, alexander.danel@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; OK, well, once again, I may need to withdraw my ticket minutes after
&gt; &gt; creating it.
&gt; &gt;
&gt; &gt; I seem to be having two issues:
&gt; &gt;
&gt; &gt; &#40;1&#41; There might be a problem in HTML::Entities, rather than
&gt; &gt; HTML::Tree.  I just looked into the &#34;Entities.pm&#34; file, and found
&gt; &gt; this:
&gt; &gt;
&gt; &gt; &#39;ndash;&#39;    =&gt; chr&#40;8211&#41;,
&gt; &gt;
&gt; &gt; This should probably say &#34;8209&#34;, not &#34;8211&#34;.
&gt; &gt;
&gt; &gt; &#40;2&#41; There doesn&#39;t seem to be an easy way to tell PrettyPrint that ALL
&gt; &gt; entities should be converted.  &#40;Any advice?&#41;
&gt; &gt;
&gt; &gt; Sorry to be causing trouble, but I am trying to be helpful, not
&gt; &gt; trying
&gt; &gt; to be a pain.
&gt; &gt;
&gt; &gt; Alexander Danel
&gt; &gt; # -----------------------------------
&gt; &gt; On Sat Mar 08 18:03:43 2014, alexander.danel@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; The entity &#39;ndash&#39; converts to three octal bytes: 342, 200, 223.
&gt; &gt; &gt; This
&gt; &gt; &gt; is also true for the entity &#39;#8209&#39;.  When sent through
&gt; &gt; &gt; HTML::PrettyPrinter-&gt;format&#40;&#41; this causes the warning &#34;Wide
&gt; &gt; &gt; character
&gt; &gt; &gt; in print...&#34;, and the result is incorrect.
&gt; &gt; &gt;
&gt; &gt; &gt; It seems to me these entities should be converted to the single
&gt; &gt; &gt; character \o{226}, which is decimal 150; which is &#34;en dash&#34;.
&gt; &gt; &gt;
&gt; &gt; &gt; Setting &#34;$root-&gt;no_expand_entities&#40;1&#41;;&#34; is not helpful; the entity
&gt; &gt; &gt; stays unexpanded, then PrettyPrinter does not recognize that it is
&gt; &gt; &gt; an
&gt; &gt; &gt; entity and converts the leading &#39;&#38;&#39; into &#34;&#38;amp&#34; for every entity in
&gt; &gt; &gt; the document.  &#40;And, I don&#39;t want to turn off conversion, because
&gt; &gt; &gt; there might be real ampersands.&#41;
&gt; &gt; &gt;
&gt; &gt; &gt; My work-around will be to convert these ndash entities into normal
&gt; &gt; &gt; hyphen characters.
&gt; &gt; &gt;
&gt; &gt; &gt; I am working in a CygWin environment.
</div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;08&nbsp;22:57:35&nbsp;2014</span>
    <span class="description">alexander.danel [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> alexander.danel [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Christopher,

Great response; thanks much.

Will read-up, and will use &#34;stackoverflow.com&#34; in the future.

Alexander

# --------------------------------------------
On Sat Mar 08 22:43:39 2014, CJM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This kind of question is much more appropriate for
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/">http://stackoverflow.com/</a></span>  HTML-Tree is a long-established and heavily
&gt; used module.  If its basic functionality isn&#39;t working, you should
&gt; assume you&#39;re doing something wrong.  Please don&#39;t report a bug unless
&gt; you&#39;re sure it&#39;s really a problem with the module.
&gt; 
&gt; You didn&#39;t give a sample program to illustrate the problem you&#39;re
&gt; having, but I&#39;m guessing you haven&#39;t set the proper encoding on your
&gt; output filehandle.
&gt; 
<div class="message-stanza open">&gt; &gt; Somehow, these represent decimal 8209 and 8211, I guess. &#40;I don&#39;t get
&gt; &gt; how, but that&#39;s besides the point.&#41;
</div>&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://en.wikipedia.org/wiki/UTF-8">http://en.wikipedia.org/wiki/UTF-8</a></span>
&gt; 
&gt; Here are some other links you should read up on:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.joelonsoftware.com/articles/Unicode.html">http://www.joelonsoftware.com/articles/Unicode.html</a></span>
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://perldoc.perl.org/perlunicode.html">http://perldoc.perl.org/perlunicode.html</a></span>
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.simon-cozens.org/content/everything-you-need-know-about-">http://www.simon-cozens.org/content/everything-you-need-know-about-</a></span>
&gt; unicode
&gt; 
&gt; &#38;#8209; is not an en-dash.  It is Unicode Character &#39;NON-BREAKING
&gt; HYPHEN&#39; U+2011 &#40;Unicode codepoints are normally written in hexadecimal
&gt; notation&#41;.
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.fileformat.info/info/unicode/char/2011/index.htm">http://www.fileformat.info/info/unicode/char/2011/index.htm</a></span>  In other
&gt; words, it&#39;s a hyphen that word-wrapping code is not supposed to allow
&gt; a line-break after.
&gt; 
&gt; Here&#39;s what I pass to HTML::PrettyPrinter for entity encoding when I
&gt; want all non-ASCII chars as entities:
&gt; 
&gt; entities =&gt; do { &#34;&lt;&gt;&#38;\x7F-\x{10FFFF}&#34; }
&gt; 
&gt; The &#34;no warnings &#39;utf8&#39;;&#34; suppresses a warning in some versions of
&gt; Perl &#40;complaining that U+10FFFF hasn&#39;t actually been allocated yet&#41;.
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
