<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #92527 for Scalar-List-Utils: &#34;isdual&#34; returns false positives.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #92527 for Scalar-List-Utils: &#34;isdual&#34; returns false positives.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Scalar-List-Utils/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Scalar-List-Utils/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Scalar-List-Utils/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Scalar-List-Utils/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Scalar-List-Utils">Scalar-List-Utils CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">92527</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Scalar-List-Utils/Active/">Scalar-List-Utils</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
davido [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-28278-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
1.27</li>
<li>
1.27_001</li>
<li>
1.27_002</li>
<li>
1.28</li>
<li>
1.29</li>
<li>
1.29_001</li>
<li>
1.30</li>
<li>
1.31</li>
<li>
1.32</li>
<li>
1.33</li>
<li>
1.34</li>
<li>
1.35</li>
<li>
1.36</li>
<li>
1.37</li>
<li>
1.38</li>
</ul>
    </td>
  </tr>
  <tr id="CF-28279-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;28&nbsp;01:51:23&nbsp;2014</span>
    <span class="description">davido [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> &#34;isdual&#34; returns false positives.</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve read the discussion earlier in the RT for Scalar::Util pertaining to the proposed &#34;isdual&#34; function.  I believe the consensus in that thread was that detecting a dualvar should be positive if information will be lost when printing the variable &#40;for example&#41;, and that, in specific, if the IV or NV is not equivalent to the string contained in the PV.  In other words, we do not have a &#34;dualvar&#34; if $x == 10 and $x eq &#39;10&#39;.

Consider the following code:

use Scalar::Utils qw&#40; isdual &#41;;
my $x = 10;
print &#34;$x\n&#34;;
print isdual&#40;$x&#41;, &#34;\n&#34;;

__OUTPUT__
10
1

So despite that the stringified scalar and its integer component agree with each other, it is being reported as a dualvar.  It&#39;s always been my impression that what we consider to be a dualvar is a variable where the IV or NV and the PV disagree with each other.  If the return value of isdual is now the new definition of what constitutes a dualvar, the definition has become so inclusive as to be practically worthless.  Do we really want to call any scalar that has a numeric and string component dualvars, even if those components are in complete agreement, and resulted only from an internal stringification or numerification?  I doubt it.

I see that this behavior is documented, but it is still incorrect behavior.  If someone just wanted to know if there&#39;s an active IV and PV component &#40;even if they agree with each other&#41;, the B module offers such introspection.  Scalar::Util shouldn&#39;t be so concerned with exposing an implementation detail.  What it should be concerned with is whether the user needs to be concerned that the IV and PV disagree with each other.  That elevates its usefulness from simply leaking implementation details, to divulging information that has relevancy to the actual use of a variable.

As it currently stands, &#34;isdual&#34; is misnamed.  As implemented, it should have some &#34;guts&#34; sort of name, such as &#34;hasPVand_NVorIV&#34;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;05&nbsp;13:28:26&nbsp;2014</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 28 01:51:23 2014, DAVIDO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I see that this behavior is documented, but it is still incorrect
&gt; behavior.  If someone just wanted to know if there&#39;s an active IV and
&gt; PV component &#40;even if they agree with each other&#41;, the B module offers
&gt; such introspection.  Scalar::Util shouldn&#39;t be so concerned with
&gt; exposing an implementation detail.  What it should be concerned with
&gt; is whether the user needs to be concerned that the IV and PV disagree
&gt; with each other.  That elevates its usefulness from simply leaking
&gt; implementation details, to divulging information that has relevancy to
&gt; the actual use of a variable.
</div>
Indeed; I am inclined to agree. The current implementation of isdual&#40;&#41; is answering a question of limited use.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As it currently stands, &#34;isdual&#34; is misnamed.  As implemented, it
&gt; should have some &#34;guts&#34; sort of name, such as &#34;hasPVand_NVorIV&#34;.
</div>
Unfortunately it&#39;s now sufficiently old that it couldn&#39;t easily be renamed. Ofcourse what I could do is add a new, better name for it as an alias, and also create a better behaviour as a newly-named function.

I&#39;d suggest

  $bool = Scalar::Util::has_str_and_num&#40; $sv &#41;

to answer the question currently performed; namely, that it has POK and IOK|NOK, and

  $bool = Scalar::Util::str_and_num_differ&#40; $sv &#41;

to answer the more useful question of it having both POK and IOK|NOK and yet these two containing inconsistent values. It is a somewhat long and unwieldly name, but I believe that justified by the slightly odd behaviour of the function combined with the rarity it should be needed in practice.

Does that sound a good plan?

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;05&nbsp;13:28:26&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;05&nbsp;21:51:21&nbsp;2014</span>
    <span class="description">daoswald [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92527] &#34;isdual&#34; returns false positives.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 5 Feb 2014 19:50:56 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Scalar-List-Utils [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Oswald &lt;daoswald [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sounds reasonable.  I didn&#39;t think that isdual had been around long enough
to care; I don&#39;t believe it&#39;s being used in any CPAN modules, but of course
we cannot know about any uses outside of CPAN.  A deprecation cycle
followed by upgraded semantics might be ok.  Frankly, I doubt that anyone
who may be using it is aware that it is hobbled.  You might just look at it
as a bug fix.

But if you are concerned that it&#39;s being used in the wild and don&#39;t want to
go through a deprecation cycle, your suggestion of providing a more
appropriate alias, as well as adding a more capable function under a new
name does make a lot of sense.




On Wed, Feb 5, 2014 at 11:28 AM, Paul Evans via RT &lt;
bug-Scalar-List-Utils@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=92527">https://rt.cpan.org/Ticket/Display.html?id=92527</a></span> &gt;
&gt;
&gt; On Tue Jan 28 01:51:23 2014, DAVIDO wrote:
<div class="message-stanza open">&gt; &gt; I see that this behavior is documented, but it is still incorrect
&gt; &gt; behavior.  If someone just wanted to know if there&#39;s an active IV and
&gt; &gt; PV component &#40;even if they agree with each other&#41;, the B module offers
&gt; &gt; such introspection.  Scalar::Util shouldn&#39;t be so concerned with
&gt; &gt; exposing an implementation detail.  What it should be concerned with
&gt; &gt; is whether the user needs to be concerned that the IV and PV disagree
&gt; &gt; with each other.  That elevates its usefulness from simply leaking
&gt; &gt; implementation details, to divulging information that has relevancy to
&gt; &gt; the actual use of a variable.
</div>&gt;
&gt; Indeed; I am inclined to agree. The current implementation of isdual&#40;&#41; is
&gt; answering a question of limited use.
&gt;
<div class="message-stanza open">&gt; &gt; As it currently stands, &#34;isdual&#34; is misnamed.  As implemented, it
&gt; &gt; should have some &#34;guts&#34; sort of name, such as &#34;hasPVand_NVorIV&#34;.
</div>&gt;
&gt; Unfortunately it&#39;s now sufficiently old that it couldn&#39;t easily be
&gt; renamed. Ofcourse what I could do is add a new, better name for it as an
&gt; alias, and also create a better behaviour as a newly-named function.
&gt;
&gt; I&#39;d suggest
&gt;
&gt;   $bool = Scalar::Util::has_str_and_num&#40; $sv &#41;
&gt;
&gt; to answer the question currently performed; namely, that it has POK and
&gt; IOK|NOK, and
&gt;
&gt;   $bool = Scalar::Util::str_and_num_differ&#40; $sv &#41;
&gt;
&gt; to answer the more useful question of it having both POK and IOK|NOK and
&gt; yet these two containing inconsistent values. It is a somewhat long and
&gt; unwieldly name, but I believe that justified by the slightly odd behaviour
&gt; of the function combined with the rarity it should be needed in practice.
&gt;
&gt; Does that sound a good plan?
&gt;
&gt; --
&gt;
&gt; Paul Evans
&gt;
</div>


-- 

David Oswald
daoswald@gmail.com
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
