<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76881 for Device-SerialPort: Device::SerialPort spawning warnings</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76881 for Device-SerialPort: Device::SerialPort spawning warnings</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Device-SerialPort">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Device-SerialPort">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Device-SerialPort">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Device-SerialPort">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Device-SerialPort">Device-SerialPort CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76881</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Device-SerialPort">Device-SerialPort</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jph4dotcom [...] xs4all.nl

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-11374-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-11375-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=76881">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1072626" href="/Public/Bug/Display.html?id=76881#txn-1072626">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;29&nbsp;06:42:10&nbsp;2012</span>
    <span class="description">jph4dotcom [...] xs4all.nl -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Device::SerialPort spawning warnings</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 29 Apr 2012 12:41:57 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Device-SerialPort [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JPH &lt;jph4dotcom [...] xs4all.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1072626/564310/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564310">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza">  

    
  
  
    
<pre>I discussed this issue on stackoverflow.com ( <a href="http://stackoverflow.com/questions/10370724"><span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/questions/10370724">http://stackoverflow.com/questions/10370724</a></span></a> ), where I was given a 
work around and was advised to register a bug with the author.

The warnings below occur while being attached to an Arduino sending data to my PC. Because the set up must be able 
to recover from a USB disconnect/reconnect, as a test I pull the cable from my Arduino, wait a few seconds, then 
reattach it. The interesting thing is that I can make my own script catch all warnings, except for two coming from
inside the Device::Serial module<b>:

Use of uninitialized value $count_in in addition (+) at /usr/lib/perl5/Device/SerialPort.pm line 2214.
Use of uninitialized value $string_in in concatenation (.) or string at /usr/lib/perl5/Device/SerialPort.pm line 2232.</b>

I am on Ubuntu 11.10  using libdevice-serialport-perl (1.04-2build1)

Hope this helps to improve the module. Don't hesitate to contact me if you require more details.

Kind regards, 

JP
</pre>

  


</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1072629" href="/Public/Bug/Display.html?id=76881#txn-1072629">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;29&nbsp;07:51:15&nbsp;2012</span>
    <span class="description">jph4dotcom [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76881] AutoReply: Device::SerialPort spawning warnings</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 29 Apr 2012 13:50:55 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Device-SerialPort [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JPH &lt;jph4dotcom [...] xs4all.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1072629/564313/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564313">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Added a fix on mentioned URL.

Hope this helps.

On 04/29/2012 12:42 PM, Bugs in Device-SerialPort via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Greetings,
&gt;
&gt; This message has been automatically generated in response to the
&gt; creation of a trouble ticket regarding:
&gt;       &#34;Device::SerialPort spawning warnings&#34;,
&gt; a summary of which appears below.
&gt;
&gt; There is no need to reply to this message right now.  Your ticket has been
&gt; assigned an ID of [rt.cpan.org #76881].  Your ticket is accessible
&gt; on the web at:
&gt;
&gt;      <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76881">https://rt.cpan.org/Ticket/Display.html?id=76881</a></span>
&gt;
&gt; Please include the string:
&gt;
&gt;           [rt.cpan.org #76881]
&gt;
&gt; in the subject line of all future correspondence about this issue. To do so,
&gt; you may reply to this message.
&gt;
&gt;                          Thank you,
&gt;                          bug-Device-SerialPort@rt.cpan.org
&gt;
&gt; -------------------------------------------------------------------------
&gt; I discussed this issue on stackoverflow.com &#40;
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/questions/10370724">http://stackoverflow.com/questions/10370724</a></span> &#41;, where I was given a
&gt; work around and was advised to register a bug with the author.
&gt;
&gt; The warnings below occur while being attached to an Arduino sending data to my PC. Because the set up must be able
&gt; to recover from a USB disconnect/reconnect, as a test I pull the cable from my Arduino, wait a few seconds, then
&gt; reattach it. The interesting thing is that I can make my own script catch all warnings, except for two coming from
&gt; inside the Device::Serial module:
&gt;
&gt; Use of uninitialized value $count_in in addition &#40;+&#41; at /usr/lib/perl5/Device/SerialPort.pm line 2214.
&gt; Use of uninitialized value $string_in in concatenation &#40;.&#41; or string at /usr/lib/perl5/Device/SerialPort.pm line 2232.
&gt; I am on Ubuntu 11.10  using libdevice-serialport-perl &#40;1.04-2build1&#41;
&gt;
&gt; Hope this helps to improve the module. Don&#39;t hesitate to contact me if you require more details.
&gt;
&gt; Kind regards,
&gt;
&gt; JP
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1073238" href="/Public/Bug/Display.html?id=76881#txn-1073238">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;30&nbsp;23:27:05&nbsp;2012</span>
    <span class="description">Bbirthisel [...] aol.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76881] AutoReply: Device::SerialPort spawning warnings</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Apr 2012 23:26:41 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Device-SerialPort [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Bill Birthisel &lt;bbirthisel [...] aol.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1073238/564642/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564642">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi JP,

I&#39;m no longer the primary maintainer. But I did write the relevant 
section of the code originally. So I&#39;ll offer an opinion.

I don&#39;t consider this a bug. I agree that the warning message could be 
clearer. And that would be worthwhile to fix if something else was being 
done at the same time. But I never envisioned someone trying to 
disconnect/recover from within a tied-filehandle interface. It is 
possible, although not encouraged, using the lower-level methods &#40;e.g. 
input&#41; with the user responsible for checking errors and maintaining 
buffering. This code predates the widespread use of USB serial ports. On 
a hard-coded serial port, loss of connectivity carried with it a serious 
risk of lost or corrupted characters. I don&#39;t know if that risk still 
exists with a USB-based port.

As I understand your posting, the code is working for you - but you get 
extra warnings on a hardware disconnect. I suspect many users, including 
me, would consider that a good thing. It may be that the use of the 
tied-filehandle interface, which does not expose much of the raw 
internal states, is causing some of the confusion.

Here is the pipeline:
1. Your device
2. Serial to USB &#40;with internal buffering&#41;
3. USB Cable
4. linux USB Driver &#40;with internal buffering and emulation to look like 
hardware serial device&#41;
5. POSIX.pm &#40;serial port interface including buffering&#41;
6. Device::SerialPort
7. Tied-Filehandle interface
8. Your code

The warning messages are coming from 7 &#40;where the count and the buffer 
are seen as undefined&#41;.
But that is not where the error originates. Item 7 calls 6 which in turn 
formats calls to 5. etc. When you break at item 3, about all that 
propagates up through the whole sequence is that at least one of the 
steps lost synchronization. It may be that your code uses checksums or 
something similar to detect lost data - but the inner items don&#39;t know 
anything about that. And while it is possible to explicitly check each 
data element for sanity &#40;i.e. is it defined&#41; in the low-level interface, 
the tie in perl does not have a convenient way to manage that. It looks 
to be quite a bit of work to make the tied-filehandle interface utterly 
airtight in the disconnect/recovery case. It might be nice to have. But 
I don&#39;t have time to do it and this is the first example I have heard 
reported in over ten years where that was a requirement.

-bill

On 04/29/2012 07:51 AM, JPH via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         Queue: Device-SerialPort
&gt;   Ticket&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76881">https://rt.cpan.org/Ticket/Display.html?id=76881</a></span>&gt;
&gt;
&gt; Added a fix on mentioned URL.
&gt;
&gt; Hope this helps.
&gt;
&gt; On 04/29/2012 12:42 PM, Bugs in Device-SerialPort via RT wrote:
<div class="message-stanza open">&gt;&gt; Greetings,
&gt;&gt;
&gt;&gt; This message has been automatically generated in response to the
&gt;&gt; creation of a trouble ticket regarding:
&gt;&gt;      &#34;Device::SerialPort spawning warnings&#34;,
&gt;&gt; a summary of which appears below.
&gt;&gt;
&gt;&gt; There is no need to reply to this message right now.  Your ticket has been
&gt;&gt; assigned an ID of [rt.cpan.org #76881].  Your ticket is accessible
&gt;&gt; on the web at:
&gt;&gt;
&gt;&gt;       <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76881">https://rt.cpan.org/Ticket/Display.html?id=76881</a></span>
&gt;&gt;
&gt;&gt; Please include the string:
&gt;&gt;
&gt;&gt;            [rt.cpan.org #76881]
&gt;&gt;
&gt;&gt; in the subject line of all future correspondence about this issue. To do so,
&gt;&gt; you may reply to this message.
&gt;&gt;
&gt;&gt;                           Thank you,
&gt;&gt;                           bug-Device-SerialPort@rt.cpan.org
&gt;&gt;
&gt;&gt; -------------------------------------------------------------------------
&gt;&gt; I discussed this issue on stackoverflow.com &#40;
&gt;&gt;
&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/questions/10370724">http://stackoverflow.com/questions/10370724</a></span> &#41;, where I was given a
&gt;&gt; work around and was advised to register a bug with the author.
&gt;&gt;
&gt;&gt; The warnings below occur while being attached to an Arduino sending data to my PC. Because the set up must be able
&gt;&gt; to recover from a USB disconnect/reconnect, as a test I pull the cable from my Arduino, wait a few seconds, then
&gt;&gt; reattach it. The interesting thing is that I can make my own script catch all warnings, except for two coming from
&gt;&gt; inside the Device::Serial module:
&gt;&gt;
&gt;&gt; Use of uninitialized value $count_in in addition &#40;+&#41; at /usr/lib/perl5/Device/SerialPort.pm line 2214.
&gt;&gt; Use of uninitialized value $string_in in concatenation &#40;.&#41; or string at /usr/lib/perl5/Device/SerialPort.pm line 2232.
&gt;&gt; I am on Ubuntu 11.10  using libdevice-serialport-perl &#40;1.04-2build1&#41;
&gt;&gt;
&gt;&gt; Hope this helps to improve the module. Don&#39;t hesitate to contact me if you require more details.
&gt;&gt;
&gt;&gt; Kind regards,
&gt;&gt;
&gt;&gt; JP
&gt;&gt;
&gt;&gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1073241" href="/Public/Bug/Display.html?id=76881#txn-1073241">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;30&nbsp;23:27:07&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1073423" href="/Public/Bug/Display.html?id=76881#txn-1073423">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;01&nbsp;15:40:15&nbsp;2012</span>
    <span class="description">jph4dotcom [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76881] AutoReply: Device::SerialPort spawning warnings</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 01 May 2012 21:40:03 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Device-SerialPort [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JPH &lt;jph4dotcom [...] xs4all.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1073423/564724/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564724">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thnx Bill for your comment, I&#39;ll have to study/think about your pipeline steps 1-8, maybe with this sum up I can figure out how to prevent DTS from pulsing when I open the filehandle &#40;which is 
effectively resetting my Arduino&#41;.

About the disconnect/recover, Sometimes the devices get disconnected due to EMI &#40;eg. a &#39;tuned&#39; motorbike passing the house&#41;, so I have to recover from that. I&#39;m able to recover just fine, just don&#39;t 
like the two undefined variable warnings. Perl does throws proper errors too if I don&#39;t catch them myself.

Anyways, My opinion is that it is a &#39;nice to have fixed&#39;. I added &#40;what I think is&#41; a fix, but I know too little about the inner workings to be sure. For now I&#39;m using my &#39;patched&#39; version on my PC.

What would be a proper way get in contact with people who have in depth knowledge on Device::SerialPort? My experience is that it is hard to find. Is there a forum/mailing list ...

Thanks for your time.

Enjoy!

JP

On 05/01/2012 05:27 AM, Bbirthisel@aol.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But I never envisioned someone trying to
&gt; disconnect/recover from within a tied-filehandle interface.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here is the pipeline:
&gt; 1. Your device
&gt; 2. Serial to USB &#40;with internal buffering&#41;
&gt; 3. USB Cable
&gt; 4. linux USB Driver &#40;with internal buffering and emulation to look like
&gt; hardware serial device&#41;
&gt; 5. POSIX.pm &#40;serial port interface including buffering&#41;
&gt; 6. Device::SerialPort
&gt; 7. Tied-Filehandle interface
&gt; 8. Your code
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1073504" href="/Public/Bug/Display.html?id=76881#txn-1073504">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;01&nbsp;21:05:52&nbsp;2012</span>
    <span class="description">Bbirthisel [...] aol.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76881] AutoReply: Device::SerialPort spawning warnings</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 01 May 2012 21:05:49 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Device-SerialPort [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Bill Birthisel &lt;bbirthisel [...] aol.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1073504/564764/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564764">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi JP,

You successfully reached at least one of the people with in depth 
knowledge. The other would be the current maintainer &#40;see the README in 
the distribution&#41;. He took over in part because he had a more complete 
test environment including a Solaris machine. These days, I only have a 
couple of linux variants and several Windows versions. One of the tricky 
parts of changing/maintaining the SerialPort family of modules was that 
they run on a lot of different hardware - although not always 
identically :-&#40;
But we have tried to make the look identical

If you want to try to detect and respond to momentary disconnects more 
reliably, I would tend to stay away from the tied filehandle interface 
and use either input or read directly. That way, you can test the return 
values for undef before trying to use them in other operations. So in 
your case, you were receiving these errors:

Use of uninitialized value $count_in in addition &#40;+&#41; at /usr/lib/perl5/Device/SerialPort.pm line 2214.
Use of uninitialized value $string_in in concatenation &#40;.&#41; or string at /usr/lib/perl5/Device/SerialPort.pm line 2232.

Where the underlying code is &#40;in part, [[line#]]  and ###comments added&#41;:

[[2206]]    &#40;$count_in, $string_in&#41; = $self-&gt;read&#40;$size&#41;;
                ###
                ### This is the real problem. $self-&gt;read is returning undef
                ### perhaps from some logic in read itself or perhaps in the
                ### call to POSIX::read that happens further up the pipeline.
                ###
                ### It might be possible to do something like this
                ### unless &#40;defined $count_in&#41; {
                ###     $count_in = 0;
                ###     $string_in = &#34;&#34;;
                ###     }
                ###
                ### I haven&#39;t tested it and I won&#39;t guarantee it would work in your case.

            $$buf = &#39;&#39; unless defined $$buf;
            my $buflen = length $$buf;

            my &#40;$tail, $head&#41; = &#40;&#39;&#39;,&#39;&#39;&#41;;

           if&#40;$offset&gt;= 0&#41;{ # positive offset
[[2214]]       if&#40;$buflen&gt;  $offset + $count_in&#41;{
                  $tail = substr&#40;$$buf, $offset + $count_in&#41;;
              }

               if&#40;$buflen&lt;  $offset&#41;{
                  $head = $$buf . &#40;&#34;\0&#34; x &#40;$offset - $buflen&#41;&#41;;
              } else {
                   $head = substr&#40;$$buf, 0, $offset&#41;;
               }
            } else { # negative offset
               $head = substr&#40;$$buf, 0, &#40;$buflen + $offset&#41;&#41;;

              if&#40;-$offset&gt;  $count_in&#41;{
                   $tail = substr&#40;$$buf, $offset + $count_in&#41;;
              }
           }

           # remaining unhandled case: $offset&lt;  0&#38;&#38;  -$offset&gt;  $buflen
[[2232]]    $$buf = $head.$string_in.$tail;
            return $count_in;

-bill


  On 05/01/2012 03:40 PM, JPH via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         Queue: Device-SerialPort
&gt;   Ticket&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76881">https://rt.cpan.org/Ticket/Display.html?id=76881</a></span>&gt;
&gt;
&gt; Thnx Bill for your comment, I&#39;ll have to study/think about your pipeline steps 1-8, maybe with this sum up I can figure out how to prevent DTS from pulsing when I open the filehandle &#40;which is
&gt; effectively resetting my Arduino&#41;.
&gt;
&gt; About the disconnect/recover, Sometimes the devices get disconnected due to EMI &#40;eg. a &#39;tuned&#39; motorbike passing the house&#41;, so I have to recover from that. I&#39;m able to recover just fine, just don&#39;t
&gt; like the two undefined variable warnings. Perl does throws proper errors too if I don&#39;t catch them myself.
&gt;
&gt; Anyways, My opinion is that it is a &#39;nice to have fixed&#39;. I added &#40;what I think is&#41; a fix, but I know too little about the inner workings to be sure. For now I&#39;m using my &#39;patched&#39; version on my PC.
&gt;
&gt; What would be a proper way get in contact with people who have in depth knowledge on Device::SerialPort? My experience is that it is hard to find. Is there a forum/mailing list ...
&gt;
&gt; Thanks for your time.
&gt;
&gt; Enjoy!
&gt;
&gt; JP
&gt;
&gt; On 05/01/2012 05:27 AM, Bbirthisel@aol.com via RT wrote:
<div class="message-stanza open">&gt;&gt; But I never envisioned someone trying to
&gt;&gt; disconnect/recover from within a tied-filehandle interface.
&gt;&gt; Here is the pipeline:
&gt;&gt; 1. Your device
&gt;&gt; 2. Serial to USB &#40;with internal buffering&#41;
&gt;&gt; 3. USB Cable
&gt;&gt; 4. linux USB Driver &#40;with internal buffering and emulation to look like
&gt;&gt; hardware serial device&#41;
&gt;&gt; 5. POSIX.pm &#40;serial port interface including buffering&#41;
&gt;&gt; 6. Device::SerialPort
&gt;&gt; 7. Tied-Filehandle interface
&gt;&gt; 8. Your code
</div></div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.340191</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
