<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #26545 for ExtUtils-CBuilder: Windows split_like_shell misparses UNC paths - causes other modules to fail to build/test &#40;+FIX&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #26545 for ExtUtils-CBuilder: Windows split_like_shell misparses UNC paths - causes other modules to fail to build/test &#40;+FIX&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=ExtUtils-CBuilder">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=ExtUtils-CBuilder">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=ExtUtils-CBuilder">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=ExtUtils-CBuilder">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please email the <a href="mailto:perlbug@perl.org">preferred bug tracker</a> to report your issue.</div>
</p>
<p>
<div>Please visit the <a href="http://rt.perl.org/rt3/">preferred bug tracker</a> to report your issue.</div>
</p>
</div>


<div class="error">
  <div class="titlebox error " id="">
  <div class="titlebox-title">
    <span class="left">Queue is disabled</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--error----UXVldWUgaXMgZGlzYWJsZWQ_---0">


This queue is disabled and you may not create new tickets in it.  Disabled queues are usually because the distribution was merged with another or changed names.  Sometimes they are the end result of a bad autocreate from PAUSE data before anyone noticed.
    <hr class="clear" />
  </div>
</div>




</div>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p>ExtUtils::CBuilder is now maintained by the Perl 5 core.  Please report bugs via the 'perlbug' tool included with Perl and do not add new tickets here.</p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">26545</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=ExtUtils-CBuilder">ExtUtils-CBuilder</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jloverso [...] mathworks.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-12462-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
0.18</li>
<li>
0.18_01</li>
</ul>
    </td>
  </tr>
  <tr id="CF-12463-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




err.modb<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/312102/142150/err.modb">
Sun Apr 22 19:34:18 2007 (6.9k) by jloverso [...] mathworks.com
</a>
</font></li>
</ul>


err.parsexs<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/312102/142153/err.parsexs">
Sun Apr 22 19:34:18 2007 (2k) by jloverso [...] mathworks.com
</a>
</font></li>
</ul>


err.vers<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/312102/142156/err.vers">
Sun Apr 22 19:34:18 2007 (340b) by jloverso [...] mathworks.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=26545">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-312102" href="/Public/Bug/Display.html?id=26545#txn-312102">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;22&nbsp;19:34:17&nbsp;2007</span>
    <span class="description">jloverso [...] mathworks.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Windows split_like_shell misparses UNC paths - causes other
 modules to fail to build/test &#40;+FIX&#41;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/312102/142147/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/142147">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">ExtUtils::Cbuilder fails to be able to compile program when used in a Perl
tha is installed on a UNC path on Windows.  It will install fine, but
modules
sing it will fail to build or pass tests.  See the attached files for the
errors from version, ExtUtils::ParseXS, and Module::Build.   The error from
&#39;perl Makefile.PL&#39; for &#39;version&#39; was the most helpful:

    Testing if you have a C compiler
    compilet.c
    LINK : fatal error LNK1181: cannot open input file &#39;perl58.lib&#39;
    Checking if your kit is complete...
    Looks good
    Writing Makefile for version::vxs
    Writing Makefile for version

Tracing the code finds that ExtUtils::CBuilder::Platform::Windows::link&#40;&#41;
is getting the value of $Config{lddlflags}, and then using
ExtUtils::CBuilder::Platform::Windows::split_like_shell&#40;&#41; on it and
placing it in %spec.  In this network build of perl, lddlflags is:

lddlflags=&#39;-dll -nologo -nodefaultlib -debug -opt:ref,icf 
-libpath:&#34;\\mathworks
\devel\sandbox\jloverso\ws\3rdparty\release\win32\perl-5.8.8-tmw-022\lib\CORE&#34;
-machine:x86&#39;;

That is the correct path to where perl58.lib is, but it fails to pass it
to the
compiler correctly.  Using the debugger I found:

ExtUtils::CBuilder::Platform::Windows::link&#40;//mathworks/devel/sandbox/jloverso/w
s/3rdparty/release/win32/perl-5.8.8-tmw-022/site/lib/ExtUtils/CBuilder/Platform/
Windows.pm:189&#41;:
189:      unless &#40; $spec{basename} &#41; {
  DB&lt;5&gt; x $lddlflags
0  &#39;-dll -nologo -nodefaultlib -debug -opt:ref,icf 
-libpath:&#34;\\\\mathworks\\devel\\sandbox\\jloverso\\ws\\3rdparty\\release\\win32\\perl-5.8.8-tmw-022\\lib\\CORE&#34;
 -machine:x86&#39;
  DB&lt;6&gt; p $lddlflags
-dll -nologo -nodefaultlib -debug -opt:ref,icf 
-libpath:&#34;\\mathworks\devel\sandbox\jloverso\ws\3rdparty\release\win32\perl-5.8.8-tmw-022\lib\CORE&#34;
 -machine:x86
  DB&lt;7&gt; x $spec{lddlflags}
0  ARRAY&#40;0x2044760&#41;
   0  &#39;-dll&#39;
   1  &#39;-nologo&#39;
   2  &#39;-nodefaultlib&#39;
   3  &#39;-debug&#39;
   4  &#39;-opt:ref,icf&#39;
   5 
&#39;-libpath:\\mathworks\\devel\\sandbox\\jloverso\\ws\\3rdparty\\release\\win32\\perl-5.8.8-tmw-022\\lib\\CORE&#39;
   6  &#39;-machine:x86&#39;


What&#39;s happening is that ...::Windows::split_like_shell&#40;&#41; is converted the
leading double backslash of the UNC path to just have a signle backslash.
Note that it is also dropping the double quotes in the string.

The simplest fix is disable the logic in split_like_shell&#40;&#41; that thinks
backslashes quote backslashes on the Windows command line:

lib/ExtUtils/CBuilder/Platform/Windows.pm
@@ -60,7 +60,7 @@
       $arg .= &#39;&#34;&#39;;
       $i++;
     } elsif &#40; $ch eq &#39;\\&#39; &#38;&#38; $next_ch eq &#39;\\&#39; &#41; {
-      $arg .= &#39;\\&#39;;
+      $arg .= &#39;\\\\&#39;;
       $i++;
     } elsif &#40; $ch eq &#39;&#34;&#39; &#38;&#38; $next_ch eq &#39;&#34;&#39; &#38;&#38; $quote_mode &#41; {
       $quote_mode = !$quote_mode;


I&#39;m not sure if the spaces being dropped is also a problem.
The arg list is passed to system&#40;&#41; which will quote strings
properly, but I&#39;m not sure if this logic is removing quotes
it shouldn&#39;t be.

The entire &#39;split_like_shell&#40;&#41;&#39; on Windows isn&#39;t really needed;
unlike UNIX, Windows passes the command string &#40;not an argument
vector&#41; to a program being run, and it&#39;s up to the program to
split the command string into arguments.  This is why different
programs handle quoted strings differently.  As a result, I tried
a change where I stubbed out most of split_like_shell&#40;&#41;:

lib/ExtUtils/CBuilder/Platform/Windows.pm
@@ -47,6 +47,9 @@
   
   my @argv;
   return @argv unless defined&#40;&#41; &#38;&#38; length&#40;&#41;;
+
+  # do nothing on windows
+  return &#40;$_&#41;;
   
   my $arg = &#39;&#39;;
   my&#40; $i, $quote_mode &#41; = &#40; 0, 0 &#41;;


This change was also sufficient to fix all the other modules having
problems.
In the same place in version/Makefile.PL, the value in the %spec now looks
like:

  DB&lt;7&gt; x $spec{lddlflags}
0  ARRAY&#40;0x2044760&#41;
   0  &#39;-dll -nologo -nodefaultlib -debug -opt:ref,icf 
-libpath:&#34;\\\\mathworks\\devel\\sandbox\\jloverso\\ws\\3rdparty\\release\\win32\\perl-5.8.8-tmw-022\\lib\\CORE&#34;
 -machine:x86&#39;

So it seems you can just take out nearly this whole function.

&#40;That wouldn&#39;t be try for cygwin systems - but I don&#39;t know if they
use lib/ExtUtils/CBuilder/Platform/Windows.pm&#41;.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> err.modb</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/312102/142150/err.modb">Download err.modb</a><br />
<span class="downloadcontenttype">application/octet-stream 6.9k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> err.parsexs</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/312102/142153/err.parsexs">Download err.parsexs</a><br />
<span class="downloadcontenttype">application/octet-stream 2k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> err.vers</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/312102/142156/err.vers">Download err.vers</a><br />
<span class="downloadcontenttype">application/octet-stream 340b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-415679" href="/Public/Bug/Display.html?id=26545#txn-415679">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;30&nbsp;22:12:47&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/415679/202948/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/202948">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 289b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Finally getting around to looking at this issue, sorry it took so long.

I&#39;m inclined to take the second fix you proposed, turning split_like_shell&#40;&#41; into a near-no-op.  
I&#39;ve committed that as a patch, and I&#39;ll see if anyone else can confirm that it&#39;s desirable 
behavior.

Thanks,

 -Ken
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-415680" href="/Public/Bug/Display.html?id=26545#txn-415680">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;30&nbsp;22:12:49&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-428819" href="/Public/Bug/Display.html?id=26545#txn-428819">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;29&nbsp;10:50:10&nbsp;2008</span>
    <span class="description">shay [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> shay [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/428819/209812/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/209812">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 30 22:12:47 2008, KWILLIAMS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Finally getting around to looking at this issue, sorry it took so
&gt; long.
&gt; 
&gt; I&#39;m inclined to take the second fix you proposed, turning
&gt; split_like_shell&#40;&#41; into a near-no-op.
&gt; I&#39;ve committed that as a patch, and I&#39;ll see if anyone else can
&gt; confirm that it&#39;s desirable
&gt; behavior.
</div>
It isn&#39;t entirely desirable because it breaks MinGW/GCC, e.g. it causes
the ../lib/CPANPLUS/Dist/Build/t/02_CPANPLUS-Dist-Build.t failure here:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.nntp.perl.org/group/perl.daily-build.reports/2008/02/msg53954.html">http://www.nntp.perl.org/group/perl.daily-build.reports/2008/02/msg53954.html</a></span>

The errors in the test there are:

gcc:  -s -O2 -DWIN32 -DHAVE_DES_FCRYPT  -DPERL_IMPLICIT_CONTEXT
-DPERL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields
-DPERL_MSVCRT_READFIX: No such file or directory
gcc:  : No such file or directory
gcc: unrecognized option `-s -O2&#39;

These errors are caused because the the gcc command being run gets
broken down into these separate array elements &#40;shown here []-delimited&#41;:

[gcc]
[-c]
[ -s -O2 -DWIN32 -DHAVE_DES_FCRYPT  -DPERL_IMPLICIT_CONTEXT
-DPERL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields
-DPERL_MSVCRT_READFIX]
[ ]
[-s -O2]
[&#34;-DXS_VERSION=\&#34;0.01\&#34;&#34;]
[&#34;-DVERSION=\&#34;0.01\&#34;&#34;]
[-I&#34;C:\p5p\bleadperl\lib\CORE&#34;]
[-I&#34;C:\MinGW\include&#34;]
[-o]
[&#34;lib\Foo\Bar.o&#34;]
[&#34;lib\Foo\Bar.c&#34;]

and these evidently *are* passed as an *array* to gcc, which then chokes
on the two containing more than one option, and on the blank one.

The OP noted that the statement about &#34;Windows passing the whole command
string &#40;not an argument array&#41; to the target program&#34; &#34;wouldn&#39;t be true
for cygwin systems&#34;. It looks like it isn&#39;t true for MinGW/GCC either.
You can see the same effect as above with this test program:

open my $fh, &#39;&gt;&#39;, &#39;test.c&#39;;
print $fh qq[#include &lt;stdio.h&gt;\n];
print $fh qq[int main&#40;void&#41; { printf&#40;&#34;Hello, world.\\n&#34;&#41;; return 0; }\n];
close $fh;
system&#40;&#39;gcc&#39;, &#39;-s -O2&#39;, &#39;test.c&#39;&#41;;
unlink &#39;test.c&#39;, &#39;a.exe&#39;;

That causes the error:

If you change the system&#40;&#41; call to this:

system&#40;&#39;gcc&#39;, &#39;-s&#39;, &#39;-O2&#39;, &#39;test.c&#39;&#41;;

then it works fine.

So it looks like split_like_shell&#40;&#41; is required on Win32, at least for
the MinGW/GCC case.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-451072" href="/Public/Bug/Display.html?id=26545#txn-451072">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;18&nbsp;12:48:40&nbsp;2008</span>
    <span class="description">shay [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> shay [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/451072/221648/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/221648">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 210b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Just checked out r11099 from svn and the problems that I was having with
MinGW now appear to be fixed &#40;tried MinGW, VC++ and Borland&#41;. I can&#39;t
comment on whether the original UNC bug here is still fixed or not.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-451958" href="/Public/Bug/Display.html?id=26545#txn-451958">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;20&nbsp;22:26:27&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/451958/222112/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/222112">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 80b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Great - I&#39;ve release version 0.23 to CPAN, which hopefully fixes the breakage.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-451960" href="/Public/Bug/Display.html?id=26545#txn-451960">#</a>      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;20&nbsp;22:26:29&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.531982</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
