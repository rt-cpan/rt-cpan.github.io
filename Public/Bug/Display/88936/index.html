<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #88936 for Compress-Raw-Zlib: gcc -g3: final link failed: Memory exhausted</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #88936 for Compress-Raw-Zlib: gcc -g3: final link failed: Memory exhausted</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Compress-Raw-Zlib/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Compress-Raw-Zlib/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Compress-Raw-Zlib/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Compress-Raw-Zlib/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Compress-Raw-Zlib">Compress-Raw-Zlib CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">88936</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Compress-Raw-Zlib/Active/">Compress-Raw-Zlib</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
RURBAN [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
perl5-porters [...] perl.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38610-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.062    </td>
  </tr>
  <tr id="CF-38611-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.065    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;24&nbsp;11:31:02&nbsp;2013</span>
    <span class="description">RURBAN [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> perl5-porters [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> gcc -g3: final link failed: Memory exhausted</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">With the new Compress-Raw-Zlib-2.062 version in blead
compilation with gcc -g3 &#40;4.7 and 4.8&#41; fails to link with

cc  -shared -g3 -L/usr/local/lib -fstack-protector Zlib.o adler32.o crc32.o infback.o inflate.o uncompr.o compress.o deflate.o inffast.o inftrees.o trees.o zutil.o   -o ../../lib/auto/Compress/Raw/Zlib/Zlib.so  \
/usr/bin/ld: final link failed: Memory exhausted

I have to clean all *.o and recompile with -g to be able to link this.
-g3 stores macros in dwarf.

Maybe there&#39;s a new recursive macro. 2.061 worked fine.
A workaround until the real problem is being found is to add a hints file, which checks for -g3 in OPTIMIZE and replaces it with -g

Inspecting core ef379d05f8358 reveils nothing obvious to me, so maybe it&#39;s a recent core change, not the 2.062 change.
The last successful blead build with -g3 was at Sep 16, with a2553af6e5f1db5aac7e0bb23db887f37101de35

With git log -p a2553af6e5f1db5aac7e0bb23db887f37101de35...c6ba15252667d61624481a75c7b61acee4e89cb3 -- ..*.h
nothing springs into my eye neither, but there were a lot of perl.h changes.

-- 
Reini Urban
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;24&nbsp;12:31:34&nbsp;2013</span>
    <span class="description">RURBAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> perl5-porters [...] perl.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Found a fix:

-g3 -fdebug-types-section
on gcc 4.7.3 and higher fixes the &#39;final link failed: Memory exhausted&#39; problem with -g3.

It cannot be memory, since the sum of all *.o is lower than 1MB and I have 16MB RAM.
So it&#39;s apparently a new gcc dwarf linking problem, with the introduction of the -fdebug-types-section switch.

<span class="clickylink"><a target="new" rel="nofollow" href="http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html">http://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html</a></span>:
&#34;When using DWARF Version 4 or higher, type DIEs can be put into their own .debug_types section instead of making them part of the .debug_info section. It is more efficient to put them in a separate comdat sections since the linker can then remove duplicates. But not all DWARF consumers support .debug_types sections yet and on some objects .debug_types produces larger instead of smaller debugging information.&#34;


On Tue Sep 24 11:31:02 2013, RURBAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; With the new Compress-Raw-Zlib-2.062 version in blead
&gt; compilation with gcc -g3 &#40;4.7 and 4.8&#41; fails to link with
&gt; 
&gt; cc  -shared -g3 -L/usr/local/lib -fstack-protector Zlib.o adler32.o
&gt; crc32.o infback.o inflate.o uncompr.o compress.o deflate.o inffast.o
&gt; inftrees.o trees.o zutil.o   -o
&gt; ../../lib/auto/Compress/Raw/Zlib/Zlib.so  \
&gt; /usr/bin/ld: final link failed: Memory exhausted
&gt; 
&gt; I have to clean all *.o and recompile with -g to be able to link this.
&gt; -g3 stores macros in dwarf.
&gt; 
&gt; Maybe there&#39;s a new recursive macro. 2.061 worked fine.
&gt; A workaround until the real problem is being found is to add a hints
&gt; file, which checks for -g3 in OPTIMIZE and replaces it with -g
&gt; 
&gt; Inspecting core ef379d05f8358 reveils nothing obvious to me, so maybe
&gt; it&#39;s a recent core change, not the 2.062 change.
&gt; The last successful blead build with -g3 was at Sep 16, with
&gt; a2553af6e5f1db5aac7e0bb23db887f37101de35
&gt; 
&gt; With git log -p
&gt; a2553af6e5f1db5aac7e0bb23db887f37101de35...c6ba15252667d61624481a75c7b61acee4e89cb3
&gt; -- ..*.h
&gt; nothing springs into my eye neither, but there were a lot of perl.h
&gt; changes.
</div>

-- 
Reini Urban
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;24&nbsp;12:42:56&nbsp;2013</span>
    <span class="description">RURBAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Sep 24 12:31:34 2013, RURBAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Found a fix:
&gt; 
&gt; -g3 -fdebug-types-section
&gt; on gcc 4.7.3 and higher fixes the &#39;final link failed: Memory
&gt; exhausted&#39; problem with -g3.
</div>
nope, spoke too early. This didn&#39;t help either.

only &#39;-g3 -gstabs -fdebug-types-section&#39;
helps if you want -g level 3 &#40;macros&#41;.

This slows down run-time, so it should go into the docs or a hints file if reproducable.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;27&nbsp;13:21:52&nbsp;2013</span>
    <span class="description">RURBAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> perl5-porters [...] perl.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Attached patch changes -g3 to -g for this 2.062 release.
It&#39;s only a cc problem, not ld.

I&#39;ve checked older perl debugging releases with optimize containing -g3 and they failed with the same problem, so it&#39;s definitely only a problem with a MACRO with the update to 2.062.

Patch also at <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/rurban/Compress-Raw-Zlib">https://github.com/rurban/Compress-Raw-Zlib</a></span>
-- 
Reini Urban
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0001-fix-88936-out-of-memory-with-g3-since-2.062.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 279cb26adc135669eb9f525bccee92aede997e3a Mon Sep 17 00:00:00 2001
From: Reini Urban &lt;rurban@cpanel.net&gt;
Date: Fri, 27 Sep 2013 12:13:35 -0500
Subject: [PATCH] fix [88936] out of memory with -g3 since 2.062

change -g3 to -g with gcc
---
 Makefile.PL | 8 +++++++-
 1 file changed, 7 insertions&#40;+&#41;, 1 deletion&#40;-&#41;

diff --git a/Makefile.PL b/Makefile.PL
index d8c060d..aba7abc 100644
--- a/Makefile.PL
+++ b/Makefile.PL
@@ -6,6 +6,7 @@ require 5.006 ;
 use private::MakeUtil;
 use ExtUtils::MakeMaker 5.16 ;
 use ExtUtils::Install &#40;&#41;; # only needed to check for version
+use Config;
 
 my $ZLIB_LIB ;
 my $ZLIB_INCLUDE ;
@@ -14,6 +15,10 @@ my $OLD_ZLIB = &#39;&#39; ;
 my $WALL = &#39;&#39; ;
 my $GZIP_OS_CODE = -1 ;
 my $USE_PPPORT_H = &#40;$ENV{PERL_CORE}&#41; ? &#39;&#39; : &#39;-DUSE_PPPORT_H&#39;;
+my $OPTIMIZE = $Config{&#39;optimize&#39;};
+if &#40;$Config{&#39;gccversion&#39;} and $OPTIMIZE =~ /-g3/&#41; {
+  $OPTIMIZE =~ s/-g3/-g/; # [88936] out of memory with -g3 since 2.062
+}
 
 #$WALL = &#39; -pedantic &#39; if $Config{&#39;cc&#39;} =~ /gcc/ ;
 #$WALL = &#39; -Wall -Wno-comment &#39; if $Config{&#39;cc&#39;} =~ /gcc/ ;
@@ -81,7 +86,8 @@ WriteMakefile&#40;
         ? zlib_files&#40;$ZLIB_LIB&#41;
         : &#40;LIBS =&gt; [ &#34;-L$ZLIB_LIB -lz &#34; ]&#41;
     &#41;,
-      
+    OPTIMIZE =&gt; $OPTIMIZE,
+
     INSTALLDIRS =&gt; &#40;$] &gt;= 5.009 &#38;&#38; $] &lt; 5.011 ? &#39;perl&#39; : &#39;site&#39;&#41;,
 
     META_MERGE =&gt; {
-- 
1.8.4.rc3

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;27&nbsp;13:21:54&nbsp;2013</span>
    <span class="description">RURBAN [...] cpan.org -  Fixed in 2.062 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;21&nbsp;04:35:50&nbsp;2013</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hey Reini,

not sure how 2.061 works while 2.062 doesn&#39;t. The only change made that impacts the code was to Makefile.PL to tighten up the code that allows a prebuilt zlib library to be used, rather than the one I ship. Do you make use of the env variables ZLIB_INCLUDE, ZLIB_LIBRARY or BUILD_ZLIB?

I don&#39;t mind adding this change if that&#39;s the only option. Would be good to get to the bottom of the issue &#38; fix that, but I don&#39;t have gcc 4.7/8. I assume the issue is caused by an interaction between Perl C macros &#38; the ones that zlib uses.

Sorry for not getting back to you sooner on this, but $WORK has been hectic.

Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;21&nbsp;04:35:50&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;23&nbsp;11:37:22&nbsp;2013</span>
    <span class="description">rurban [...] x-ray.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rurban [...] x-ray.at</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hey Paul,

On Mon Oct 21 04:35:50 2013, PMQS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; not sure how 2.061 works while 2.062 doesn&#39;t. The only change made
&gt; that impacts the code was to Makefile.PL to tighten up the code that
&gt; allows a prebuilt zlib library to be used, rather than the one I ship.
&gt; Do you make use of the env variables ZLIB_INCLUDE, ZLIB_LIBRARY or
&gt; BUILD_ZLIB?
</div>
Nope. zlib is provided by debian.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I don&#39;t mind adding this change if that&#39;s the only option. Would be
&gt; good to get to the bottom of the issue &#38; fix that, but I don&#39;t have
&gt; gcc 4.7/8. I assume the issue is caused by an interaction between Perl
&gt; C macros &#38; the ones that zlib uses.
</div>
I&#39;m pretty sure it&#39;s a new recursive perl macro which caused this problem only here, 
but I haven&#39;t found it yet.
This is the only way to fix it for now.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;23&nbsp;17:57:24&nbsp;2013</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 23 11:37:22 2013, rurban@x-ray.at wrote:
...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I&#39;m pretty sure it&#39;s a new recursive perl macro which caused this
&gt; problem only here,
&gt; but I haven&#39;t found it yet.
&gt; This is the only way to fix it for now.
</div>
OK. I&#39;ve added your change to my development copy.

Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;03&nbsp;17:53:39&nbsp;2013</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;03&nbsp;17:53:39&nbsp;2013</span>
    <span class="description">pmqs [...] cpan.org -  Fixed in 2.063 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;03&nbsp;17:53:40&nbsp;2013</span>
    <span class="description">pmqs [...] cpan.org -  Fixed in 2.062 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;04&nbsp;14:27:50&nbsp;2013</span>
    <span class="description">rurban [...] x-ray.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rurban [...] x-ray.at</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dave Mitchell found the gcc problem with infback.c, so it&#39;s no a perl CORE problem

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Nope, it appears to be a gcc bug.
&gt; First, it&#39;s reproducible with just linking infback.o, which doesn&#39;t rely
&gt; on perl src; and second, I&#39;ve reduced it to the following minimal case:
&gt; 
&gt; $ cc -c -g3 -fstack-protector -fPIC  foo.c
&gt; $ cc -shared -g3 foo.o -o /tmp/foo.so
&gt; /usr/bin/ld: final link failed: Memory exhausted
&gt; collect2: error: ld returned 1 exit status
&gt; foo.c:
&gt; 
&gt; #define FOO1
&gt; #define FOO2
&gt; #define FOO3
&gt; #define FOO4
&gt; #define FOO5
&gt; #define FOO6
&gt; #define FOO7
&gt; #define FOO8
&gt; #define FOO9
&gt; #define FOO10
&gt; #define FOO11
&gt; #define FOO12
&gt; #define FOO13
&gt; #define FOO14
&gt; #define FOO15
&gt; #define FOO16
&gt; #define FOO17
&gt; #define FOO18
&gt; #define FOO19
&gt; #define FOO20
&gt; #define FOO21
&gt; #define FOO22
&gt; #define FOO23
&gt; #define FOO24
&gt; #define FOO25
&gt; #define FOO26
&gt; #define FOO27
&gt; #define FOO28
&gt; #define BAR1
&gt; #define BAR2
&gt; #define BAR3
&gt; #define BAR4
&gt; #define BAR5
&gt; #define BAR6
&gt; #define BAR7
&gt; #define BAR8
&gt; #define BAR9
&gt; #define BAR10
&gt; #define BAR11
&gt; #define BAR12
&gt; #define BAR13
&gt; #define BAR14
&gt; #define BAR15
&gt; #define BAR16
&gt; #define BAR17
&gt; #define BAR18
&gt; #define BAR19
&gt; #define BAR20
&gt; #define BAR21
&gt; #define BAR22
&gt; #define BAR23
&gt; #define BAR24
&gt; #define BAR25
&gt; #define BAR26
&gt; #define BAR27
&gt; #define BAR28
&gt; #define BAR29
&gt; #define BAR30
&gt; #define BAR31
&gt; #define BAR32
&gt; #define BAR33
&gt; #define BAR34
&gt; #define BAR35
&gt; #define BAR36
&gt; #define BAR37
&gt; #define BAR38
&gt; #define BAR39
&gt; #define BAR40
&gt; #define BAR41
&gt; #define BAR42
&gt; #define BAR43
&gt; #define BAR44
&gt; #define BAR45
&gt; #define BAR46
&gt; #define BAR47
&gt; #define BAR48
&gt; #define BAR49
&gt; #define BAR50
&gt; #define BAR51
&gt; #define BAR52
&gt; #define BAR53
&gt; #define BAR54
&gt; #define BAR55
&gt; #define BAR56
&gt; #define BAR57
&gt; #define BAR58
&gt; #define BAR59
&gt; #define BAR60
&gt; #define BAR61
&gt; #define ZLIB_VER_SUBREVISION 0
&gt; 
&gt; typedef char  chr1;
&gt; typedef chr1  chr2;
&gt; typedef int   int2;
&gt; typedef int   int1;
&gt; typedef void *voidpf;
&gt; typedef void &#40;*funcp&#41;&#40;&#41;;
&gt; 
&gt; struct struct4 {int i;};
&gt; 
&gt; typedef struct struct3 {
&gt;      unsigned int v2;
&gt;      int  v3;
&gt;      long v6;
&gt;      char v7;
&gt;      int  v12;
&gt;      int  v13;
&gt;      int1 v14;
&gt;      int2 v5;
&gt;      chr2 v4;
&gt;      chr2 v1;
&gt;      struct struct4 *v8;
&gt;      funcp  v9;
&gt;      funcp  v10;
&gt;      voidpf v11;
&gt; } struct2;
&gt; 
&gt; typedef struct2 *type2;
&gt; 
&gt; typedef short foo1;
&gt; 
&gt; typedef enum {
&gt;      E1, E2, E3, E4, E5, E6, E7, E8, E9, E10, E11, E12, E13, E14, E15,
&gt; } enum1;
&gt; 
&gt; struct struct1 {
&gt;      enum1 mode;
&gt; };
&gt; 
&gt; int f1&#40;type2 t2, int i1, int i2, int i3, int i4&#41; {
&gt;      struct struct1 *s1;
&gt; }
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;02&nbsp;09:59:09&nbsp;2014</span>
    <span class="description">fraserbn [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> fraserbn [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 23 17:57:24 2013, PMQS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Oct 23 11:37:22 2013, rurban@x-ray.at wrote:
&gt; ...
&gt; 
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; I&#39;m pretty sure it&#39;s a new recursive perl macro which caused this
&gt; &gt; problem only here,
&gt; &gt; but I haven&#39;t found it yet.
&gt; &gt; This is the only way to fix it for now.
</div>&gt; 
&gt; OK. I&#39;ve added your change to my development copy.
&gt; 
&gt; Paul
&gt; 
</div>
Howdy,

It looks like this issue is still showing it&#39;s ugly head around. In particular, it still affects perls compiled with either -O3 or greater, or with -ggdb3. So I think that Makefile.PL needs to change those to -O2 and -ggdb2.

Thanks in advance!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;02&nbsp;09:59:17&nbsp;2014</span>
    <span class="description">fraserbn [...] gmail.com -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;02&nbsp;10:56:27&nbsp;2014</span>
    <span class="description">khw [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> khw [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Feb 02 07:59:09 2014, Hugmeir wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Oct 23 17:57:24 2013, PMQS wrote:
<div class="message-stanza open">&gt; &gt; On Wed Oct 23 11:37:22 2013, rurban@x-ray.at wrote:
&gt; &gt; ...
&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; I&#39;m pretty sure it&#39;s a new recursive perl macro which caused this
&gt; &gt; &gt; problem only here,
&gt; &gt; &gt; but I haven&#39;t found it yet.
&gt; &gt; &gt; This is the only way to fix it for now.
</div>&gt; &gt;
&gt; &gt; OK. I&#39;ve added your change to my development copy.
&gt; &gt;
&gt; &gt; Paul
&gt; &gt;
</div>&gt; 
&gt; Howdy,
&gt; 
&gt; It looks like this issue is still showing it&#39;s ugly head around. In
&gt; particular, it still affects perls compiled with either -O3 or
&gt; greater, or with -ggdb3. So I think that Makefile.PL needs to change
&gt; those to -O2 and -ggdb2.
&gt; 
&gt; Thanks in advance!
</div>
Attached is a patch that does this.  It also adds a /g to the substitution operator, as it is legal to specify the option multiple times, and each should be changed.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0004-Allow-to-compile-under-gdb3-under-gcc.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 99d67d6dcd303a689a57ce4f01f5f13d9a6a589c Mon Sep 17 00:00:00 2001
From: Karl Williamson &lt;public@khwilliamson.com&gt;
Date: Sun, 2 Feb 2014 08:51:09 -0700
Subject: [PATCH 4/4] Allow to compile under -gdb3 under gcc

---
 cpan/Compress-Raw-Zlib/Makefile.PL | 4 ++--
 1 file changed, 2 insertions&#40;+&#41;, 2 deletions&#40;-&#41;

diff --git a/cpan/Compress-Raw-Zlib/Makefile.PL b/cpan/Compress-Raw-Zlib/Makefile.PL
index aba7abc..015c1d9 100644
--- a/cpan/Compress-Raw-Zlib/Makefile.PL
+++ b/cpan/Compress-Raw-Zlib/Makefile.PL
@@ -16,8 +16,8 @@ my $WALL = &#39;&#39; ;
 my $GZIP_OS_CODE = -1 ;
 my $USE_PPPORT_H = &#40;$ENV{PERL_CORE}&#41; ? &#39;&#39; : &#39;-DUSE_PPPORT_H&#39;;
 my $OPTIMIZE = $Config{&#39;optimize&#39;};
-if &#40;$Config{&#39;gccversion&#39;} and $OPTIMIZE =~ /-g3/&#41; {
-  $OPTIMIZE =~ s/-g3/-g/; # [88936] out of memory with -g3 since 2.062
+if &#40;$Config{&#39;gccversion&#39;} and $OPTIMIZE =~ /-g &#40;gdb&#41;? 3/x&#41; {
+  $OPTIMIZE =~ s/-g&#40;gdb&#41;?3/-g/g; # [88936] out of memory with -g3 since 2.062
 }
 
 #$WALL = &#39; -pedantic &#39; if $Config{&#39;cc&#39;} =~ /gcc/ ;
-- 
1.8.3.2

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;02&nbsp;14:28:30&nbsp;2014</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks - patch applied.

Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;02&nbsp;14:40:50&nbsp;2014</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;04&nbsp;05:41:07&nbsp;2015</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;04&nbsp;05:41:07&nbsp;2015</span>
    <span class="description">pmqs [...] cpan.org -  Fixed in 2.065 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;May&nbsp;04&nbsp;05:41:08&nbsp;2015</span>
    <span class="description">pmqs [...] cpan.org -  Fixed in 2.063 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
