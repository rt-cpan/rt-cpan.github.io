<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #33485 for Win32-OLE: Problem with EPIC debugger and Win32::OLE</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #33485 for Win32-OLE: Problem with EPIC debugger and Win32::OLE</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Win32-OLE/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Win32-OLE/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Win32-OLE/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Win32-OLE/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-OLE">Win32-OLE CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">33485</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Win32-OLE/Active/">Win32-OLE</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Oliver.Koch [...] Linde-LE.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35672-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35673-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;21&nbsp;06:45:55&nbsp;2008</span>
    <span class="description">Oliver.Koch [...] Linde-LE.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-PadWalker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Problem with EPIC debugger and Win32::OLE</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Feb 2008 12:45:19 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libwin32 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Oliver.Koch [...] Linde-LE.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear all,

I&#39;ve found a problem with the debugger of EPIC.
When stepping over the Win32::OLE code of my little demo script &#40;instead of
using Run or Resume&#41;, the program output from Win32::OLE is different &#40;and
wrong&#41;.

&#40;See attached file: OLE-Excel_EPIC_Debug_Error.pl&#41;

For details of my configuration and outputs please look into the demo
script.

In the beginning I suspected the error is related to the Padwalker module,
because you can avoid the wrong output by disabling the &#34;Show local
variables&#34; option of the variables view in EPIC. But I already had some
debug attempts with Robin Houston, who admirably tried to check whether the
padwalker module needs a fixed.
Please, follow this thread for details:
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33211">http://rt.cpan.org/Ticket/Display.html?id=33211</a></span>

Finally, it seems to me that the problem is more related to Win32::OLE
and/or EPIC.

Perhaps, you&#39;d analyze the problem based on your background.

Regards,

Oliver

P.S.: I post this report to the EPIC team, too.
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;22&nbsp;03:34:50&nbsp;2008</span>
    <span class="description">Oliver.Koch [...] Linde-LE.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fw: [rt.cpan.org #33485] Problem with EPIC debugger and Win32::OLE</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 22 Feb 2008 09:32:35 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libwin32 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Oliver.Koch [...] Linde-LE.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
----- Forwarded by Oliver Koch/MUC/VA/Linde-VA on 22.02.2008 09:30 -----
                                                                           
             Oliver                                                        
             Koch/MUC/VA/Linde                                             
             -VA                                                        To 
                                       bug-PadWalker@rt.cpan.org           
             22.02.2008 09:30                                           cc 
                                                                           
                                                                   Subject 
                                       Re: [rt.cpan.org #33211] Problem    
                                       with Eclipse EPIC and &#39;Show Local   
                                       Variables&#39;&#40;Document link: Oliver    
                                       Koch&#41;                               
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           



Dear Robin,

&#34;Robin Houston via RT&#34; &lt;bug-PadWalker@rt.cpan.org&gt; wrote on 21.02.2008
19:04:18:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33211">http://rt.cpan.org/Ticket/Display.html?id=33211</a></span> &gt;
&gt;
&gt; Hi Oliver,
&gt;
&gt; I am quite interested in getting to the bottom of this, but there is
&gt; not much
&gt; hands-on debugging I can do, without a machine that can run
&gt; Win32::OLE. It may
&gt; well be that you do not have time to pursue this further, which I
&gt; understand.
</div>I know, that you are fully committed to solve the issue and I&#39;m very
thankful for it.
And I&#39;m willing too to do my very best to help in finding the source of the
problem.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Unfortunately I don&#39;t have any specific idea of what the problem
&gt; might be.
&gt; I did wonder whether it could be related to the Win32::OLE module&#39;s
&gt; use of
&gt; tied variables. &#40;Simply printing the value of a tied variable can invoke
&gt; arbitrary behaviour, of course.&#41; However, I can&#39;t see any specific
&gt; way that
&gt; this would be a problem. Win32::OLE used tied hashes, and the EPIC code
&gt; does not seem to try and print the actual keys and values of a hash.
&gt; &#40;However I don&#39;t completely understand how the EPIC system works, and
&gt; I must confess that I haven&#39;t used it myself, so perhaps I could be
&gt; mistaken on this point? I suspect not, from what I do understand of the
&gt; code.&#41;
</div>Neither do I, that&#39;s reason why I sent the issue to the EPIC &#40;#1898659&#41; and
the Win32::OLE &#40;#33485&#41; team, too.
I created a more general example making use of Excel&#39;s COM object instead
of Visual Source Safe.
I think someone from the Win32::OLE team should try to debug the example to
get an idea, whether it&#39;s an internal problem, something special with the
EPIC debugger or maybe with the padwalker module.
Unfortunately, I neither have the knowledge nor the debug experience to do
this own my own.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It is not clear to me, from what you&#39;ve said, whether the error code
&gt; is being
&gt; inappropriately set, or whether in fact the OLE call is failing, and
&gt; the error
&gt; response is correctly reflecting that.
</div>I think, this is clear, because the OLE calls are executed correctly, but
the return values from LastError&#40;&#41; aren&#39;t accordingly.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It seems unlikely to me that the LastError&#40;&#41; method plays any part in
&gt; what
&gt; you&#39;re seeing, but I could be wrong. You could eliminate the possibility
&gt; by printing the error variable $Win32::OLE::LastError directly,
&gt; rather than
&gt; using the method.
</div>I just tried this, but it didn&#39;t change anything. But I agree, that
LastError&#40;&#41; maybe just discovers, that there was something wrong
&#40;different&#41; during the last OLE call.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think the changes you&#39;ve made have eliminated the obvious ways that
&gt; the debugging could interfere with your program. What is happening must
&gt; therefore be something I haven&#39;t considered yet. If I were debugging
&gt; this
&gt; myself, the next thing I would try would be to recompile Win32::OLE with
&gt; the _DEBUG symbol defined, which will make it print lots of detailed
&gt; information about what it&#39;s doing. Comparing the output with and without
&gt; the debugger might yield some new clues.
</div>I agree, that this should be the next step, but I don&#39;t feel
instrumented/prepared to do this. So I think, it&#39;s more promising, that the
Win32::OLE team have a look on his.

Regards,

Oliver
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;21:30:06&nbsp;2008</span>
    <span class="description">JDB [...] cpan.org -  Queue changed from libwin32 to Win32-OLE</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;04:11:46&nbsp;2009</span>
    <span class="description">Oliver.Koch [...] Linde-LE.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #33485] Problem with EPIC debugger and Win32::OLE</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 9 Mar 2009 09:11:30 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libwin32 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Oliver.Koch [...] Linde-LE.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear Win32::OLE developers,

There&#39;s an update from the EPIC developers related to this bug.
It is assumed, that the problem lies within Win32::OLE.
Please, confer the e-mail added below.

So, I had again a look at the bug report #33485 at rt.cpan.org and found
accidentally, that was added a very brief note: &#34;JDB - Queue von libwin32
in Win32-OLE geändert &#34;

This messages looks like a bug fix, but I&#39;m not sure, because the bug
status is still on new.
What does this message mean?
Is the status really still on &#34;new&#34;?
Should I do something?

Regards,

Oliver

----- Forwarded by Oliver Koch/MUC/VA/Linde-VA on 09.03.2009 09:00 -----
                                                                       
             Jan Ploski                                                
             &lt;jpl@plosquare.co                                         
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">             m&gt;                                                         To
</div>                                       Oliver.Koch@Linde-LE.com        
             08.03.2009 01:47                                           cc
                                                                       
                                                                   Subject
                                       Re: [ 1898659 ] Problem with EPIC
                                       debugger and Win32::OLE         
                                                                       
                                                                       
                                                                       
                                                                       
                                                                       
                                                                       




Dear Oliver,

I examined your bug report and updated the ticket:

<span class="clickylink"><a target="new" rel="nofollow" href="http://sourceforge.net/tracker/index.php?func=detail&#38;aid=1898659&#38;group_id=75859&#38;atid=545274">http://sourceforge.net/tracker/index.php?func=detail&#38;aid=1898659&#38;group_id=75859&#38;atid=545274</a></span>


Regards,
Jan Ploski
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;14:52:03&nbsp;2009</span>
    <span class="description">jand [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #33485] Problem with EPIC debugger and Win32::OLE</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 9 Mar 2009 11:51:32 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-OLE [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Jan Dubois&#34; &lt;jand [...] activestate.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 09 Mar 2009, Oliver.Koch@Linde-LE.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So, I had again a look at the bug report #33485 at rt.cpan.org and
&gt; found accidentally, that was added a very brief note: &#34;JDB - Queue von
&gt; libwin32 in Win32-OLE geändert &#34;
</div>
No, that was not a bug fix; it just means that all Win32::OLE related
tickets are being copied to the libwin32@perl.org mailing list in
addition to be sent to the maintainers.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This messages looks like a bug fix, but I&#39;m not sure, because the bug
&gt; status is still on new. What does this message mean? Is the status
&gt; really still on &#34;new&#34;? Should I do something?
</div>
I&#39;m not sure there is anything that can be done about this, so I&#39;m not
sure that this really classifies as a bug, and not just as an unwelcome
side-effect.

It is similar to displaying the value of the expression ++$i without
changing the value of $i. You have to save the state of $i, evaluate
&#34;++$i&#34;, record the result and then restore $i to its old value.

Similarly accessing any object properties via Win32::OLE will change the
value of Win32::OLE-&gt;LastError&#40;&#41;. If you don&#39;t want that, then you have
to save the value before accessing the properties, and restoring it
afterwards:

    my $last_error = Win32::OLE-&gt;LastError&#40;&#41;;
    # ... try to display the properties
    Win32::OLE-&gt;LastError&#40;$last_error&#41;;

This is the activity the debugger would need to take every time it
displays the value of a property w\of a Win32::OLE object if it doesn&#39;t
want to destroy the value of Win32::OLE-&gt;LastError&#40;&#41;. There is nothing
Win32::OLE can do about this, as it doesn&#39;t know if the code is being
called by the user program, or by the debugger.

An OLE property access is not just a simple memory dereferencing
operation; it will typically involve a remote procedure call to a
different process, or possibly even to a remote machine, which can
result in any number of errors. So a property access definitely needs to
set Win32::OLE-&gt;LastError.

Note that this problem is not unique to Win32::OLE-&gt;LastError&#40;&#41; either;
any tied hash or array implementation that has side effects will have
similar problems when a debugger accesses its elements.

I guess I should close this bug as a &#34;known limitation&#34;, as any kind of
work-around will have to go into the debugger anyways.

Cheers,
-Jan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;14:52:04&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;15:17:46&nbsp;2009</span>
    <span class="description">JDB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">As I wrote in my email reply, this problem is a &#34;known limitation&#34; and
working as designed.  The debugger will need to work around this as the
module itself doesn&#39;t know when it is being invoked by a debugger, and
when it isn&#39;t.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;15:17:47&nbsp;2009</span>
    <span class="description">JDB [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;10&nbsp;03:02:27&nbsp;2009</span>
    <span class="description">Oliver.Koch [...] Linde-LE.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #33485] Problem with EPIC debugger and Win32::OLE</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 10 Mar 2009 08:02:12 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-OLE [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Oliver.Koch [...] Linde-LE.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear Jan,

Thanks for the analysis. In general the explanation sounds reasonable.

But to be honest I&#39;m a little bit confused, because there is now a
contradictory situation. From Padwalker module&#39;s point of view there
couldn&#39;t be found a problem, from EPIC&#39;s point of view the problem is
located in Win32::OLE, and from your&#39;s point of view the problem is within
the debugger.
Since I have not a deep enough insight into any of the three products, I
feel, that I&#39;m not capable to resolve this conflict.

At first I&#39;d like to ask, whether all parties have tested the same aspect
of this incident?

Secondly, I think, that the fastest and the most reliable way to fix this
is, that you developers resolve this contradiction in direct communication:
Jan Dubios
&lt;bug-Win32-OLE at rt.cpan.org&gt;
[rt.cpan.org #33485] Problem with EPIC debugger and Win32::OLE
<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=33485">https://rt.cpan.org/Ticket/Display.html?id=33485</a></span>

Jan Ploski
&lt;jpl at plosquare.com&gt;
[ 1898659 ] Problem with EPIC debugger and Win32::OLE
<span class="clickylink"><a target="new" rel="nofollow" href="http://sourceforge.net/tracker/index.php?func=detail&#38;aid=1898659&#38;group_id=75859&#38;atid=545274">http://sourceforge.net/tracker/index.php?func=detail&#38;aid=1898659&#38;group_id=75859&#38;atid=545274</a></span>


Robin Houston
&lt;bug-PadWalker at rt.cpan.org&gt;
[rt.cpan.org #33484] Problem with EPIC debugger and Win32::OLE
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33484">http://rt.cpan.org/Ticket/Display.html?id=33484</a></span>
[rt.cpan.org #33211] Problem with Eclipse EPIC and &#39;Show Local Variables&#39;
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33211">http://rt.cpan.org/Ticket/Display.html?id=33211</a></span>

I hope, that this bring foward this incident to resolve without remaining
questions.

Kind regards,

Oliver

P.S.: I post this e-mail to all four treads.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;10&nbsp;03:02:28&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;10&nbsp;04:27:45&nbsp;2009</span>
    <span class="description">jpl [...] plosquare.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 09 15:17:46 2009, JDB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As I wrote in my email reply, this problem is a &#34;known limitation&#34; and
&gt; working as designed.  The debugger will need to work around this as the
&gt; module itself doesn&#39;t know when it is being invoked by a debugger, and
&gt; when it isn&#39;t.
</div>
I wasn&#39;t aware of this RT thread when posting my first assessment in the
EPIC bug repository. Thanks to Oliver for pointing it out.

You are correct that the problem now needs to be solved in the debugger,
mostly because you have a published API and other clients who may
already rely on this problematic behavior. From a design point of view,
I think that your implementation is flawed, same goes for any other tied
hash implementation with side effects. What looks like a memory access
should be a memory access. Calls to &#40;remote&#41; procedures that may fail
should look like calls to procedures. The semantics are quite different,
as you correctly noted.

I&#39;ll see what and whether anything can be done in EPIC to work around
this Win32::OLE limitation. I suggest that the RT tickets here and for
Padwalker should be closed and the issue further tracked on the EPIC side.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
