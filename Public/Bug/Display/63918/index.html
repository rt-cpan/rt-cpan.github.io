<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #63918 for PDF-API2: String conversion bug &#40;and patch&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #63918 for PDF-API2: String conversion bug &#40;and patch&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/PDF-API2/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/PDF-API2/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/PDF-API2/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/PDF-API2/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/PDF-API2">PDF-API2 CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">63918</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/PDF-API2/Active/">PDF-API2</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
fd [...] taz.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24958-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24959-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.021    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;14&nbsp;17:25:18&nbsp;2010</span>
    <span class="description">fd [...] taz.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 14 Dec 2010 23:25:06 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PDF-API2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

there is a bug that gets exposed when PDF::API2 is about to process a 
Indexed ColorSpace lookup table.

Considering e.g.

   3\000f\\3\000f

which is hex 3300665c330066

as part of the input stream, PDF::API2::Basic::PDF::String::convert 
changes this to

   3\000f\3\000f

which gets hex 330066030066, which is wrong and one byte less, when 
reading in.

The patch is:

--- /usr/share/perl5/PDF/API2/Basic/PDF/String.pm~
+++ /usr/share/perl5/PDF/API2/Basic/PDF/String.pm
@@ -48,7 +48,7 @@
      &#34;t&#34; =&gt; &#34;\t&#34;,
      &#34;b&#34; =&gt; &#34;\b&#34;,
      &#34;f&#34; =&gt; &#34;\f&#34;,
-    &#34;\\&#34; =&gt; &#34;\\&#34;,
+    &#34;\\&#34; =&gt; &#34;\\\\&#34;,
      &#34;&#40;&#34; =&gt; &#34;&#40;&#34;,
      &#34;&#41;&#34; =&gt; &#34;&#41;&#34;
          &#41;;

perl is 5.10.1, system is debian lenny.

best regards,
Frank.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;15&nbsp;05:43:17&nbsp;2010</span>
    <span class="description">fd [...] taz.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63918] AutoReply: String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 15 Dec 2010 11:43:07 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Bugs in PDF-API2 via RT &lt;bug-PDF-API2 [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 14.12.10 um 17:25 schrieb Bugs in PDF-API2 via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Considering e.g.
&gt;
&gt;   3\000f\\3\000f
&gt;
&gt; which is hex 3300665c330066
&gt;
&gt; as part of the input stream, PDF::API2::Basic::PDF::String::convert
&gt; changes this to
&gt;
&gt;   3\000f\3\000f
&gt;
&gt; which gets hex 330066030066, which is wrong and one byte less, when
&gt; reading in.
&gt;
&gt; The patch is:
&gt;
&gt; --- /usr/share/perl5/PDF/API2/Basic/PDF/String.pm~
&gt; +++ /usr/share/perl5/PDF/API2/Basic/PDF/String.pm
&gt; @@ -48,7 +48,7 @@
&gt;      &#34;t&#34; =&gt; &#34;\t&#34;,
&gt;      &#34;b&#34; =&gt; &#34;\b&#34;,
&gt;      &#34;f&#34; =&gt; &#34;\f&#34;,
&gt; -    &#34;\\&#34; =&gt; &#34;\\&#34;,
&gt; +    &#34;\\&#34; =&gt; &#34;\\\\&#34;,
&gt;      &#34;&#40;&#34; =&gt; &#34;&#40;&#34;,
&gt;      &#34;&#41;&#34; =&gt; &#34;&#41;&#34;
&gt;          &#41;;
</div>
Unfortunately this patch does not work well, because it results in 
doubling \\ in another string:

0000005c00000000 -&gt; 0000005c5c00000000

F.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;15&nbsp;06:24:10&nbsp;2010</span>
    <span class="description">fd [...] taz.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63918] AutoReply: String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 15 Dec 2010 12:24:00 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Bugs in PDF-API2 via RT &lt;bug-PDF-API2 [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 15.12.10 um 11:43 schrieb Frank Doepper:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Unfortunately this patch does not work well, because it results in 
&gt; doubling \\ in another string:
&gt;
&gt; 0000005c00000000 -&gt; 0000005c5c00000000
</div>
So, the patch has to be:

--- lib/PDF/API2/Basic/PDF/String.pm~
+++ lib/PDF/API2/Basic/PDF/String.pm
+0100
@@ -129,11 +129,7 @@
      {
          # if we import binary escapes,
          # let it be hex on output -- fredo
-        if&#40;$str =~ s/\\&#40;[nrtbf\\&#40;&#41;]&#41;/$trans{$1}/ogi&#41;
-        {
-            $self-&gt;{&#39; ishex&#39;}=1;
-        }
-        if&#40;$str =~ s/\\&#40;[0-7]{1,3}&#41;/chr&#40;oct&#40;$1&#41;&#41;/oeg&#41;
+        if&#40;$str =~ s/\\&#40;[nrtbf\\&#40;&#41;]|[0-7]{1,3}&#41;/$trans{$1}||chr&#40;oct&#40;$1&#41;&#41;/oegi&#41;
          {
              $self-&gt;{&#39; ishex&#39;}=1;
          }


regards,
F.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;11:30:57&nbsp;2013</span>
    <span class="description">steve [...] deefs.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for submitting this bug.  I ended up rewriting the convert&#40;&#41; method 
due to a number of other parsing mistakes it was making, and the new 
version parses both of these cases correctly.

It will be included in release 2.021.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;11:30:58&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;11:30:58&nbsp;2013</span>
    <span class="description">steve [...] deefs.net -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;12:34:11&nbsp;2013</span>
    <span class="description">fd [...] taz.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63918] String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Jan 2013 18:33:58 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Steve Simms via RT &lt;bug-PDF-API2 [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 21.01.13 um 11:30 schrieb Steve Simms via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=63918">https://rt.cpan.org/Ticket/Display.html?id=63918</a></span> &gt;
&gt;
&gt; Thanks for submitting this bug.  I ended up rewriting the convert&#40;&#41; method
&gt; due to a number of other parsing mistakes it was making, and the new
&gt; version parses both of these cases correctly.
&gt;
&gt; It will be included in release 2.021.
</div>
Thank you. In the meantime I have found another bug regarding a Indexed
Colorspace beginning with &#34;[/Indexed/DeviceCMYK 255&#40;&lt;&#34;. I attach the patch
I am currently applying to the Debian package libpdf-api2-perl &#40;0.73-1&#41; to
this mail.

I can try to find the real-life test case if you want.

Regards,
Frank Doepper
taz-edv

-- 
xmpp:fd@jabber.taz.de
tel:+49-30-25902-307
pgp:0x0C91F566
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;12:34:12&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;12:42:00&nbsp;2013</span>
    <span class="description">steve [...] deefs.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thank you. In the meantime I have found another bug regarding a Indexed
&gt; Colorspace beginning with &#34;[/Indexed/DeviceCMYK 255&#40;&lt;&#34;. I attach the 
</div>patch
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am currently applying to the Debian package libpdf-api2-perl &#40;0.73-1&#41; 
</div>to
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; this mail.
</div>
I think the rewrite should have solved that issue as well.  There were 
several places where the literal string handling wasn&#39;t lining up with the 
PDF spec.

You can see the change here and try it out for yourself:
<span class="clickylink"><a target="new" rel="nofollow" href="https://bitbucket.org/ssimms/pdfapi2/commits/29c2bad23cfe974bba919476e9ed9">https://bitbucket.org/ssimms/pdfapi2/commits/29c2bad23cfe974bba919476e9ed9</a></span>
56c
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;21&nbsp;12:42:01&nbsp;2013</span>
    <span class="description">steve [...] deefs.net -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;20&nbsp;12:28:31&nbsp;2013</span>
    <span class="description">fd [...] taz.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63918] String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 Feb 2013 18:27:43 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Steve Simms via RT &lt;bug-PDF-API2 [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Steve.

Am 21.01.13 um 12:42 schrieb Steve Simms via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=63918">https://rt.cpan.org/Ticket/Display.html?id=63918</a></span> &gt;
&gt;
<div class="message-stanza open">&gt; &gt; Thank you. In the meantime I have found another bug regarding a
&gt; &gt; Indexed Colorspace beginning with &#34;[/Indexed/DeviceCMYK 255&#40;&lt;&#34;. I
&gt; &gt; attach the patch I am currently applying to the Debian package
&gt; &gt; libpdf-api2-perl &#40;0.73-1&#41; to this mail.
</div>&gt;
&gt; I think the rewrite should have solved that issue as well.  There were
&gt; several places where the literal string handling wasn&#39;t lining up with
&gt; the PDF spec.
&gt;
&gt; You can see the change here and try it out for yourself:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://bitbucket.org/ssimms/pdfapi2/commits/29c2bad23cfe974bba919476e9ed956c">https://bitbucket.org/ssimms/pdfapi2/commits/29c2bad23cfe974bba919476e9ed956c</a></span>
</div>
Unfortunately it has not. I have taken 2.020 and applied the patch
29c2bad... to it, but, when I use it, it breaks the Indexed Colorspace.

I have attached two PDFs, S43-bs3-bln-01.pdf is the original one,
S43-bs3-bln-01.seite.pdf is produced with PDF::API2 and has a broken
&#34;Indexed Colorspace&#34;.

Best regards,
Frank Doepper
taz-edv

-- 
xmpp:fd@jabber.taz.de
pgp:0x0C91F566
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;20&nbsp;12:28:41&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;25&nbsp;17:19:46&nbsp;2013</span>
    <span class="description">steve [...] deefs.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">To clarify, are you saying that the patch fixes the original issue but not 
the later issue, or are you saying that both of them are still broken?

If the original issue is fixed, I&#39;d like to close this ticket, and a new 
ticket can be created for the later issue.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;26&nbsp;10:57:16&nbsp;2013</span>
    <span class="description">fd [...] taz.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63918] String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Feb 2013 16:56:10 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Steve Simms via RT &lt;bug-PDF-API2 [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 25.02.13 um 17:19 schrieb Steve Simms via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; To clarify, are you saying that the patch fixes the original issue but
&gt; not the later issue, or are you saying that both of them are still
&gt; broken?
</div>
Both of them are still broken. The attachments in my FebÂ 20 mail
illustrate the original issue, and I attach files to illustrate the later
issue to this mail: S05-tt5-02.pdf is before, S05-tt5-02.seite.pdf is
after processing with PDF::API2.

Do you need some minimal code to reproduce the issues?

Best regards,
Frank Doepper
taz-edv

-- 
xmpp:fd@jabber.taz.de
pgp:0x0C91F566
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;26&nbsp;11:19:12&nbsp;2013</span>
    <span class="description">steve [...] deefs.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Feb 26 10:57:16 2013, fd@taz.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Do you need some minimal code to reproduce the issues?
</div>
That would be helpful, yes.  I don&#39;t use that part of the code in my own 
work.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;26&nbsp;13:56:26&nbsp;2013</span>
    <span class="description">fd [...] taz.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63918] String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Feb 2013 19:56:15 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Steve Simms via RT &lt;bug-PDF-API2 [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 26.02.13 um 11:19 schrieb Steve Simms via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Feb 26 10:57:16 2013, fd@taz.de wrote:
<div class="message-stanza open">&gt; &gt; Do you need some minimal code to reproduce the issues?
</div>&gt;
&gt; That would be helpful, yes.  I don&#39;t use that part of the code in my own
&gt; work.
</div>
Well, here it is.

$ ./pdf-api2-test.pl S05-tt5-02.pdf s.pdf
$ xpdf s.pdf
Error: Bad Indexed color space &#40;lookup table string too short&#41;
Error &#40;24505&#41;: Bad image parameters

$ ./pdf-api2-test.pl S43-bs3-bln-01.pdf b.pdf
$ xpdf b.pdf
Error: Bad Indexed color space &#40;lookup table string too short&#41;
Error &#40;32985&#41;: Bad image parameters

Best,
Frank
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;25&nbsp;11:15:19&nbsp;2014</span>
    <span class="description">steve [...] deefs.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m going to mark this one as resolved with the recent 2.021 release, since it addresses the original bug report.

If you can track down where the problem is for the indexed colorspace, please open up a new ticket with some more details.

Likewise, if 2.021 broke something that used to work in 2.020 or earlier, please open up a new ticket with an example &#40;as always, if you can point out exactly where in the code the problem is, that&#39;ll make it easiest to fix&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;25&nbsp;11:15:20&nbsp;2014</span>
    <span class="description">steve [...] deefs.net -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;25&nbsp;11:15:21&nbsp;2014</span>
    <span class="description">steve [...] deefs.net -  Fixed in 2.021 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;27&nbsp;11:51:15&nbsp;2014</span>
    <span class="description">fd [...] taz.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63918] String conversion bug &#40;and patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 27 Feb 2014 17:51:03 +0100 &#40;CET&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Steve Simms via RT &lt;bug-PDF-API2 [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Frank Doepper &lt;fd [...] taz.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 25.02.14 um 11:15 schrieb Steve Simms via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=63918">https://rt.cpan.org/Ticket/Display.html?id=63918</a></span> &gt;
&gt;
&gt; I&#39;m going to mark this one as resolved with the recent 2.021 release,
&gt; since it addresses the original bug report.
&gt;
&gt; If you can track down where the problem is for the indexed colorspace,
&gt; please open up a new ticket with some more details.
&gt;
&gt; Likewise, if 2.021 broke something that used to work in 2.020 or
&gt; earlier, please open up a new ticket with an example &#40;as always, if you
&gt; can point out exactly where in the code the problem is, that&#39;ll make it
&gt; easiest to fix&#41;.
</div>
I suspect a regression, you seem at least to insert a literal linebreak
instead of a 0A byte when reading \n in an &#40;&#41; encoded Indexed ColorSpace
definition.

Indexed ColorSpace processing is again broken, as it can easily be proofed
by using the test cases which are already attached to this bug.

I am not opening a new bug now, because I have my patched 0.73 working
here, for years, in production.

So, anyway, thank you a lot for this software.

Best regards,
Frank.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
