<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #33529 for Tk: Bug Report of Tk-804.028 Tk::Text</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #33529 for Tk: Bug Report of Tk-804.028 Tk::Text</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Tk/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Tk/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Tk/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Tk/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Tk">Tk CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">33529</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Tk/Active/">Tk</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
yesheng [...] tsinghua.org.cn

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-33610-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-33611-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;22&nbsp;23:23:41&nbsp;2008</span>
    <span class="description">yesheng [...] tsinghua.org.cn -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug Report of Tk-804.028 Tk::Text</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 23 Feb 2008 12:02:00 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> yesheng [...] tsinghua.org.cn</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear CPAN group,

There is an important issue found in Perl Tk-804.028 Tk::Text widget.

Copy and paste many lines of Chinese Charactors to Tk::Text window, will cause
application crash, its almost 100% reproducable.

Following is the result of copying and pasting all text of www.google.cn to
notepad 3 times, and pasting all of them to Tk:Text window.


&#40;1&#41;
SV = PV&#40;0x319d508&#41; at 0x319cdac
  REFCNT = 1
  FLAGS = &#40;POK,pPOK&#41;
  PV = 0x31a48a4 &#34;\346\211\200\346\234\211\347\266\262\351\240\201 \345\234\226\
347\211\207 \346\226\260\350\201\236 \347\266\262\344\270\212\350\253\226\345\24
3\207 \347\266\262\350\252\214\346\220\234\345\260\213 Gmail \346\233\264\345\24
4\232 \342\226\274 \346\227\245\346\233\206 \347\233\270\347\211\207 \346\226\20
7\344\273\266 \351\226\261\350\256\200\345\231\250 \346\233\264\345\244\232 \302
\273 \347\231\273\345\205\245\n\n\345\217\260\347\201\243 \n\n  \n   \351\200\26
2\351\232\216\346\220\234\345\260\213\n  \344\275\277\347\224\250\345\201\217\34
5\245\275\n  \350\252\236\350\250\200\351\201\270\351\240\205 \n\346\220\234\345
\260\213\357\274\232  \346\211\200\346\234\211\347\266\262\351\240\201  \344\270
\255\346\226\207\347\266\262\351\240\201  \347\271\201\351\253\224\344\270\255\3
46\226\207\347\266\262\351\240\201  \345\217\260\347\201\243\347\232\204\347\266
\262\351\240\201  \n\n\n\345\202\263\347\265\261\351\246\226\351\240\201  |  iGo
ogle: \345\217\260\347\201\243\351\246\226\351\240\201\n\n\n\345\273\243\345\221
\212\346\234\215\345\213\231 - Google \345\256\214\345\205\250\346\211\213\345\2
06\212 - Google.com in English\n\302\2512008 Google\n\n\346\211\200\346\234\211\
347\266\262\351\240\201 \345\234\226\347\211\207 \346\226\260\350\201\236 \347\2
66\262\344\270\212\350\253\226\345\243\207 \347\266\262\350\252\214\346\220\234\
345\260\213 Gmail \346\233\264\345\244\232 \342\226\274 \346\227\245\346\233\206
 \347\233\270\347\211\207 \346\226\207\344\273\266 \351\226\261\350\256\200\345\
231\250 \346\233\264\345\244\232 \302\273 \347\231\273\345\205\245\n\n\345\217\2
60\347\201\243 \n\n  \n   \351\200\262\351\232\216\346\220\234\345\260\213\n  \3
44\275\277\347\224\250\345\201\217\345\245\275\n  \350\252\236\350\250\200\351\2
01\270\351\240\205 \n\346\220\234\345\260\213\357\274\232  \346\211\200\346\234\
211\347\266\262\351\240\201  \344\270\255\346\226\207\347\266\262\351\240\201  \
347\271\201\351\253\224\344\270\255\346\226\207\347\266\262\351\240\201  \345\21
7\260\347\201\243\347\232\204\347\266\262\351\240\201  \n\n\n\345\202\263\347\26
5\261\351\246\226\351\240\201  |  iGoogle: \345\217\260\347\201\243\351\246\226\
351\240\201\n\n\n\345\273\243\345\221\212\346\234\215\345\213\231 - Google \345\
256\214\345\205\250\346\211\213\345\206\212 - Google.com in English\n\302\251200
8 Google\n\n\346\211\200\346\234\211\347\266\262\351\240\201 \345\234\226\347\21
1\207 \346\226\260\350\201\236 \347\266\262\344\270\212\350\253\226\345\243\207
\347\266\262\350\252\214\346\220\234\345\260\213 Gmail \346\233\264\345\244\232
\342\226\274 \346\227\245\346\233\206 \347\233\270\347\211\207 \346\226\207\344\
273\266 \351\226\261\350\256\200\345\231\250 \346\233\264\345\244\232 \302\273 \
347\231\273\345\205\245\n\n\345\217\260\347\201\243 \n\n  \n   \351\200\262\351\
232\216\346\220\234\345\260\213\n  \344\275\277\347\224\250\345\201\217\345\245\
275\n  \350\252\236\350\250\200\351\201\270\351\240\205 \n\346\220\234\345\260\2
13\357\274\232  \346\211\200\346\234\211\347\266\262\351\240\201  \344\270\255\3
46\226\207\347\266\262\351\240\201  \347\271\201\351\253\224\344\270\255\346\226
\207\347\266\262\351\240\201  \345\217\260\347\201\243\347\232\204\347\266\262\3
51\240\201  \n\n\n\345\202\263\347\265\261\351\246\226\351\240\201  |  iGoogle:
\345\217\260\347\201\243\351\246\226\351\240\201\n\n\n\345\273\243\345\221\212\3
46\234\215\345\213\231 - Google \345\256\214\345\205\250\346\211\213\345\206\212
 - Google.com in English\n\302\2512008 Google\n\n\0\250\346\211\213\345\206\212
- Google.com in English\r\n\302\2512008 Google\r\n\r\n&#34;\0
  CUR = 1167
  LEN = 1168

This application has requested the Runtime to terminate it in an unusual way.
Please contact the application&#39;s support team for more information.

Best Regards,
Sheng
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;07:03:08&nbsp;2008</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 22 23:23:41 2008, yesheng@tsinghua.org.cn wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Dear CPAN group,
&gt; 
&gt; There is an important issue found in Perl Tk-804.028 Tk::Text widget.
&gt; 
&gt; Copy and paste many lines of Chinese Charactors to Tk::Text window,
&gt; will cause
&gt; application crash, its almost 100% reproducable.
&gt; 
&gt; Following is the result of copying and pasting all text of
&gt; www.google.cn to
&gt; notepad 3 times, and pasting all of them to Tk:Text window.
&gt; 
</div>
I tried to reproduce the crash in various ways, but failed. I tried

* FreeBSD 6.2 + perl 5.8.8 + Tk 804.028: copy the contents of
www.google.cn to kate, clicked on &#34;select all&#34; and &#34;copy&#34; and did ctrl-v
in the &#34;Basic editable text&#34; window of the &#34;widget&#34; demonstration. I
tried also to save the contents from the dump you provided, load it into
kate and then into the text widget, also no crash.

* Windows Vista + ActivePerl 5.8.8 + Tk 804.028 &#40;ppm from bribes, I
think&#41;: copy the contents of www.google.cn and other chinese sites into
notepad and then again in the text widget of the &#34;Basic editable text&#34;
demonstration. No crash, but sometimes the chinese characters were
displayed as binary garbage.

Can you give me more information? Maybe it depends on the actual pasted
text &#40;can you send me a textfile which may reproduce the problem&#41;, or
the operating system, or maybe it&#39;s another Tk or perl build?

Regards,
    Slaven
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;07:03:09&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;29&nbsp;05:39:59&nbsp;2008</span>
    <span class="description">yesheng [...] tsinghua.org.cn -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re:[rt.cpan.org #33529] AutoReply: Bug Report of Tk-804.028 Tk::Text </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 29 Feb 2008 18:17:29 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> yesheng [...] tsinghua.org.cn</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Reply to Slaven:

Sorry for late response.
Here is the attached text file copy from www.google.cn, 3 times to make a larger
size.&#40;33529_sample.txt&#41;

And I reproduced it again.
My environment is windows XP+sp2&#40;code page is cp936&#41;, ActivePerl 5.8.8, Tk:
804.27.

Thanks,
Sheng

<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33529">http://rt.cpan.org/Ticket/Display.html?id=33529</a></span>



In your mail:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;From: &#34;Bugs in Tk via RT&#34; &lt;bug-Tk@rt.cpan.org&gt;
&gt;Reply-To: bug-Tk@rt.cpan.org
&gt;To: yesheng@tsinghua.org.cn
&gt;Subject: [rt.cpan.org #33529] AutoReply: Bug Report of Tk-804.028 Tk::Text 
&gt;Date:Fri, 22 Feb 2008 23:23:42 -0500
&gt;
&gt;
&gt;Greetings,
&gt;
&gt;This message has been automatically generated in response to the
&gt;creation of a trouble ticket regarding:
&gt;       &#34;Bug Report of Tk-804.028 Tk::Text&#34;, 
&gt;a summary of which appears below.
&gt;
&gt;There is no need to reply to this message right now.  Your ticket has been
&gt;assigned an ID of [rt.cpan.org #33529].  Your ticket is accessible
&gt;on the web at:
&gt;
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33529">http://rt.cpan.org/Ticket/Display.html?id=33529</a></span>
&gt;
&gt;Please include the string:
&gt;
&gt;         [rt.cpan.org #33529]
&gt;
&gt;in the subject line of all future correspondence about this issue. To do so, 
&gt;you may reply to this message.
&gt;
&gt;                        Thank you,
&gt;                        bug-Tk@rt.cpan.org
&gt;
&gt;-------------------------------------------------------------------------
&gt;Dear CPAN group,
&gt;
&gt;There is an important issue found in Perl Tk-804.028 Tk::Text widget.
&gt;
&gt;Copy and paste many lines of Chinese Charactors to Tk::Text window, will cause
&gt;application crash, its almost 100% reproducable.
&gt;
&gt;Following is the result of copying and pasting all text of www.google.cn to
&gt;notepad 3 times, and pasting all of them to Tk:Text window.
&gt;
&gt;
&gt;&#40;1&#41;
&gt;SV = PV&#40;0x319d508&#41; at 0x319cdac
&gt;  REFCNT = 1
&gt;  FLAGS = &#40;POK,pPOK&#41;
&gt;  PV = 0x31a48a4 &#34;\346\211\200\346\234\211\347\266\262\351\240\201 \345\234\226\
&gt;347\211\207 \346\226\260\350\201\236 \347\266\262\344\270\212\350\253\226\345\24
&gt;3\207 \347\266\262\350\252\214\346\220\234\345\260\213 Gmail \346\233\264\345\24
&gt;4\232 \342\226\274 \346\227\245\346\233\206 \347\233\270\347\211\207 \346\226\20
&gt;7\344\273\266 \351\226\261\350\256\200\345\231\250 \346\233\264\345\244\232 \302
&gt;\273 \347\231\273\345\205\245\n\n\345\217\260\347\201\243 \n\n  \n   \351\200\26
&gt;2\351\232\216\346\220\234\345\260\213\n  \344\275\277\347\224\250\345\201\217\34
&gt;5\245\275\n  \350\252\236\350\250\200\351\201\270\351\240\205 \n\346\220\234\345
&gt;\260\213\357\274\232  \346\211\200\346\234\211\347\266\262\351\240\201  \344\270
&gt;\255\346\226\207\347\266\262\351\240\201  \347\271\201\351\253\224\344\270\255\3
&gt;46\226\207\347\266\262\351\240\201  \345\217\260\347\201\243\347\232\204\347\266
&gt;\262\351\240\201  \n\n\n\345\202\263\347\265\261\351\246\226\351\240\201  |  iGo
&gt;ogle: \345\217\260\347\201\243\351\246\226\351\240\201\n\n\n\345\273\243\345\221
&gt;\212\346\234\215\345\213\231 - Google \345\256\214\345\205\250\346\211\213\345\2
&gt;06\212 - Google.com in English\n\302\2512008 Google\n\n\346\211\200\346\234\211\
&gt;347\266\262\351\240\201 \345\234\226\347\211\207 \346\226\260\350\201\236 \347\2
&gt;66\262\344\270\212\350\253\226\345\243\207 \347\266\262\350\252\214\346\220\234\
&gt;345\260\213 Gmail \346\233\264\345\244\232 \342\226\274 \346\227\245\346\233\206
&gt; \347\233\270\347\211\207 \346\226\207\344\273\266 \351\226\261\350\256\200\345\
&gt;231\250 \346\233\264\345\244\232 \302\273 \347\231\273\345\205\245\n\n\345\217\2
&gt;60\347\201\243 \n\n  \n   \351\200\262\351\232\216\346\220\234\345\260\213\n  \3
&gt;44\275\277\347\224\250\345\201\217\345\245\275\n  \350\252\236\350\250\200\351\2
&gt;01\270\351\240\205 \n\346\220\234\345\260\213\357\274\232  \346\211\200\346\234\
&gt;211\347\266\262\351\240\201  \344\270\255\346\226\207\347\266\262\351\240\201  \
&gt;347\271\201\351\253\224\344\270\255\346\226\207\347\266\262\351\240\201  \345\21
&gt;7\260\347\201\243\347\232\204\347\266\262\351\240\201  \n\n\n\345\202\263\347\26
&gt;5\261\351\246\226\351\240\201  |  iGoogle: \345\217\260\347\201\243\351\246\226\
&gt;351\240\201\n\n\n\345\273\243\345\221\212\346\234\215\345\213\231 - Google \345\
&gt;256\214\345\205\250\346\211\213\345\206\212 - Google.com in English\n\302\251200
&gt;8 Google\n\n\346\211\200\346\234\211\347\266\262\351\240\201 \345\234\226\347\21
&gt;1\207 \346\226\260\350\201\236 \347\266\262\344\270\212\350\253\226\345\243\207
&gt;\347\266\262\350\252\214\346\220\234\345\260\213 Gmail \346\233\264\345\244\232
&gt;\342\226\274 \346\227\245\346\233\206 \347\233\270\347\211\207 \346\226\207\344\
&gt;273\266 \351\226\261\350\256\200\345\231\250 \346\233\264\345\244\232 \302\273 \
&gt;347\231\273\345\205\245\n\n\345\217\260\347\201\243 \n\n  \n   \351\200\262\351\
&gt;232\216\346\220\234\345\260\213\n  \344\275\277\347\224\250\345\201\217\345\245\
&gt;275\n  \350\252\236\350\250\200\351\201\270\351\240\205 \n\346\220\234\345\260\2
&gt;13\357\274\232  \346\211\200\346\234\211\347\266\262\351\240\201  \344\270\255\3
&gt;46\226\207\347\266\262\351\240\201  \347\271\201\351\253\224\344\270\255\346\226
&gt;\207\347\266\262\351\240\201  \345\217\260\347\201\243\347\232\204\347\266\262\3
&gt;51\240\201  \n\n\n\345\202\263\347\265\261\351\246\226\351\240\201  |  iGoogle:
&gt;\345\217\260\347\201\243\351\246\226\351\240\201\n\n\n\345\273\243\345\221\212\3
&gt;46\234\215\345\213\231 - Google \345\256\214\345\205\250\346\211\213\345\206\212
&gt; - Google.com in English\n\302\2512008 Google\n\n\0\250\346\211\213\345\206\212
&gt;- Google.com in English\r\n\302\2512008 Google\r\n\r\n&#34;\0
&gt;  CUR = 1167
&gt;  LEN = 1168
&gt;
&gt;This application has requested the Runtime to terminate it in an unusual way.
&gt;Please contact the application&#39;s support team for more information.
&gt;
&gt;Best Regards,
&gt;Sheng
&gt;
&gt;
&gt;
&gt; 
</div></div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;31&nbsp;10:36:23&nbsp;2008</span>
    <span class="description">yesheng [...] tsinghua.org.cn -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re:[rt.cpan.org #33529] AutoReply: Bug Report of Tk-804.028 Tk::Text </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 31 Aug 2008 22:09:11 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> yesheng [...] tsinghua.org.cn</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">update to this issue:

I found when pasting many Chinese text to a Tk::Entry widget, the application will
also crash, and same error information prompted. So I think it&#39;s may be an issue
about converting Window clipboard  data into Perl/Tk internal octet.

Regards,
Sheng
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;12&nbsp;17:58:40&nbsp;2008</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 29 05:39:59 2008, yesheng@tsinghua.org.cn wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Reply to Slaven:
&gt; 
&gt; Sorry for late response.
&gt; Here is the attached text file copy from www.google.cn, 3 times to
&gt; make a larger
&gt; size.&#40;33529_sample.txt&#41;
&gt; 
&gt; And I reproduced it again.
&gt; My environment is windows XP+sp2&#40;code page is cp936&#41;, ActivePerl
&gt; 5.8.8, Tk:
&gt; 804.27.
</div>  ^^^^^^
Does the error also appear with Tk 804.028? The old 027 had issues with
the selections, and these known issues were fixed in 028.

Regards,
    Slaven

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks,
&gt; Sheng
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33529">http://rt.cpan.org/Ticket/Display.html?id=33529</a></span>
&gt; 
&gt; 
&gt; 
&gt; In your mail:
<div class="message-stanza open">&gt; &gt;From: &#34;Bugs in Tk via RT&#34; &lt;bug-Tk@rt.cpan.org&gt;
&gt; &gt;Reply-To: bug-Tk@rt.cpan.org
&gt; &gt;To: yesheng@tsinghua.org.cn
&gt; &gt;Subject: [rt.cpan.org #33529] AutoReply: Bug Report of Tk-804.028
</div>&gt; Tk::Text
<div class="message-stanza open">&gt; &gt;Date:Fri, 22 Feb 2008 23:23:42 -0500
&gt; &gt;
&gt; &gt;
&gt; &gt;Greetings,
&gt; &gt;
&gt; &gt;This message has been automatically generated in response to the
&gt; &gt;creation of a trouble ticket regarding:
&gt; &gt;     &#34;Bug Report of Tk-804.028 Tk::Text&#34;,
&gt; &gt;a summary of which appears below.
&gt; &gt;
&gt; &gt;There is no need to reply to this message right now.  Your ticket has
</div>&gt; been
<div class="message-stanza open">&gt; &gt;assigned an ID of [rt.cpan.org #33529].  Your ticket is accessible
&gt; &gt;on the web at:
&gt; &gt;
&gt; &gt;    <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33529">http://rt.cpan.org/Ticket/Display.html?id=33529</a></span>
&gt; &gt;
&gt; &gt;Please include the string:
&gt; &gt;
&gt; &gt;         [rt.cpan.org #33529]
&gt; &gt;
&gt; &gt;in the subject line of all future correspondence about this issue. To
</div>&gt; do so,
<div class="message-stanza open">&gt; &gt;you may reply to this message.
&gt; &gt;
&gt; &gt;                        Thank you,
&gt; &gt;                        bug-Tk@rt.cpan.org
&gt; &gt;
&gt; &gt;-------------------------------------------------------------------------
&gt; &gt;Dear CPAN group,
&gt; &gt;
&gt; &gt;There is an important issue found in Perl Tk-804.028 Tk::Text widget.
&gt; &gt;
&gt; &gt;Copy and paste many lines of Chinese Charactors to Tk::Text window,
</div>&gt; will cause
<div class="message-stanza open">&gt; &gt;application crash, its almost 100% reproducable.
&gt; &gt;
&gt; &gt;Following is the result of copying and pasting all text of
</div>&gt; www.google.cn to
<div class="message-stanza open">&gt; &gt;notepad 3 times, and pasting all of them to Tk:Text window.
&gt; &gt;
&gt; &gt;
&gt; &gt;&#40;1&#41;
&gt; &gt;SV = PV&#40;0x319d508&#41; at 0x319cdac
&gt; &gt;  REFCNT = 1
&gt; &gt;  FLAGS = &#40;POK,pPOK&#41;
&gt; &gt;  PV = 0x31a48a4 &#34;\346\211\200\346\234\211\347\266\262\351\240\201
</div>&gt; \345\234\226\
<div class="message-stanza open">&gt; &gt;347\211\207 \346\226\260\350\201\236
</div>&gt; \347\266\262\344\270\212\350\253\226\345\24
<div class="message-stanza open">&gt; &gt;3\207 \347\266\262\350\252\214\346\220\234\345\260\213 Gmail
</div>&gt; \346\233\264\345\24
<div class="message-stanza open">&gt; &gt;4\232 \342\226\274 \346\227\245\346\233\206 \347\233\270\347\211\207
</div>&gt; \346\226\20
<div class="message-stanza open">&gt; &gt;7\344\273\266 \351\226\261\350\256\200\345\231\250
</div>&gt; \346\233\264\345\244\232 \302
<div class="message-stanza open">&gt; &gt;\273 \347\231\273\345\205\245\n\n\345\217\260\347\201\243 \n\n  \n
</div>&gt; \351\200\26
<div class="message-stanza open">&gt; &gt;2\351\232\216\346\220\234\345\260\213\n
</div>&gt; \344\275\277\347\224\250\345\201\217\34
<div class="message-stanza open">&gt; &gt;5\245\275\n  \350\252\236\350\250\200\351\201\270\351\240\205
</div>&gt; \n\346\220\234\345
<div class="message-stanza open">&gt; &gt;\260\213\357\274\232
</div>&gt; \346\211\200\346\234\211\347\266\262\351\240\201  \344\270
<div class="message-stanza open">&gt; &gt;\255\346\226\207\347\266\262\351\240\201
</div>&gt; \347\271\201\351\253\224\344\270\255\3
<div class="message-stanza open">&gt; &gt;46\226\207\347\266\262\351\240\201
</div>&gt; \345\217\260\347\201\243\347\232\204\347\266
<div class="message-stanza open">&gt; &gt;\262\351\240\201
</div>&gt; \n\n\n\345\202\263\347\265\261\351\246\226\351\240\201  |  iGo
<div class="message-stanza open">&gt; &gt;ogle:
</div>&gt; \345\217\260\347\201\243\351\246\226\351\240\201\n\n\n\345\273\243\345\221
<div class="message-stanza open">&gt; &gt;\212\346\234\215\345\213\231 - Google
</div>&gt; \345\256\214\345\205\250\346\211\213\345\2
<div class="message-stanza open">&gt; &gt;06\212 - Google.com in English\n\302\2512008
</div>&gt; Google\n\n\346\211\200\346\234\211\
<div class="message-stanza open">&gt; &gt;347\266\262\351\240\201 \345\234\226\347\211\207
</div>&gt; \346\226\260\350\201\236 \347\2
<div class="message-stanza open">&gt; &gt;66\262\344\270\212\350\253\226\345\243\207
</div>&gt; \347\266\262\350\252\214\346\220\234\
<div class="message-stanza open">&gt; &gt;345\260\213 Gmail \346\233\264\345\244\232 \342\226\274
</div>&gt; \346\227\245\346\233\206
<div class="message-stanza open">&gt; &gt; \347\233\270\347\211\207 \346\226\207\344\273\266
</div>&gt; \351\226\261\350\256\200\345\
<div class="message-stanza open">&gt; &gt;231\250 \346\233\264\345\244\232 \302\273
</div>&gt; \347\231\273\345\205\245\n\n\345\217\2
<div class="message-stanza open">&gt; &gt;60\347\201\243 \n\n  \n
</div>&gt; \351\200\262\351\232\216\346\220\234\345\260\213\n  \3
<div class="message-stanza open">&gt; &gt;44\275\277\347\224\250\345\201\217\345\245\275\n
</div>&gt; \350\252\236\350\250\200\351\2
<div class="message-stanza open">&gt; &gt;01\270\351\240\205 \n\346\220\234\345\260\213\357\274\232
</div>&gt; \346\211\200\346\234\
<div class="message-stanza open">&gt; &gt;211\347\266\262\351\240\201
</div>&gt; \344\270\255\346\226\207\347\266\262\351\240\201  \
<div class="message-stanza open">&gt; &gt;347\271\201\351\253\224\344\270\255\346\226\207\347\266\262\351\240\201
</div>&gt; \345\21
<div class="message-stanza open">&gt; &gt;7\260\347\201\243\347\232\204\347\266\262\351\240\201
</div>&gt; \n\n\n\345\202\263\347\26
<div class="message-stanza open">&gt; &gt;5\261\351\246\226\351\240\201  |  iGoogle:
</div>&gt; \345\217\260\347\201\243\351\246\226\
<div class="message-stanza open">&gt; &gt;351\240\201\n\n\n\345\273\243\345\221\212\346\234\215\345\213\231 -
</div>&gt; Google \345\
<div class="message-stanza open">&gt; &gt;256\214\345\205\250\346\211\213\345\206\212 - Google.com in
</div>&gt; English\n\302\251200
<div class="message-stanza open">&gt; &gt;8 Google\n\n\346\211\200\346\234\211\347\266\262\351\240\201
</div>&gt; \345\234\226\347\21
<div class="message-stanza open">&gt; &gt;1\207 \346\226\260\350\201\236
</div>&gt; \347\266\262\344\270\212\350\253\226\345\243\207
<div class="message-stanza open">&gt; &gt;\347\266\262\350\252\214\346\220\234\345\260\213 Gmail
</div>&gt; \346\233\264\345\244\232
<div class="message-stanza open">&gt; &gt;\342\226\274 \346\227\245\346\233\206 \347\233\270\347\211\207
</div>&gt; \346\226\207\344\
<div class="message-stanza open">&gt; &gt;273\266 \351\226\261\350\256\200\345\231\250 \346\233\264\345\244\232
</div>&gt; \302\273 \
<div class="message-stanza open">&gt; &gt;347\231\273\345\205\245\n\n\345\217\260\347\201\243 \n\n  \n
</div>&gt; \351\200\262\351\
<div class="message-stanza open">&gt; &gt;232\216\346\220\234\345\260\213\n
</div>&gt; \344\275\277\347\224\250\345\201\217\345\245\
<div class="message-stanza open">&gt; &gt;275\n  \350\252\236\350\250\200\351\201\270\351\240\205
</div>&gt; \n\346\220\234\345\260\2
<div class="message-stanza open">&gt; &gt;13\357\274\232  \346\211\200\346\234\211\347\266\262\351\240\201
</div>&gt; \344\270\255\3
<div class="message-stanza open">&gt; &gt;46\226\207\347\266\262\351\240\201
</div>&gt; \347\271\201\351\253\224\344\270\255\346\226
<div class="message-stanza open">&gt; &gt;\207\347\266\262\351\240\201
</div>&gt; \345\217\260\347\201\243\347\232\204\347\266\262\3
<div class="message-stanza open">&gt; &gt;51\240\201  \n\n\n\345\202\263\347\265\261\351\246\226\351\240\201  |
</div>&gt; iGoogle:
&gt;
&gt;\345\217\260\347\201\243\351\246\226\351\240\201\n\n\n\345\273\243\345\221\212\3
<div class="message-stanza open">&gt; &gt;46\234\215\345\213\231 - Google
</div>&gt; \345\256\214\345\205\250\346\211\213\345\206\212
<div class="message-stanza open">&gt; &gt; - Google.com in English\n\302\2512008
</div>&gt; Google\n\n\0\250\346\211\213\345\206\212
<div class="message-stanza open">&gt; &gt;- Google.com in English\r\n\302\2512008 Google\r\n\r\n&#34;\0
&gt; &gt;  CUR = 1167
&gt; &gt;  LEN = 1168
&gt; &gt;
&gt; &gt;This application has requested the Runtime to terminate it in an
</div>&gt; unusual way.
<div class="message-stanza open">&gt; &gt;Please contact the application&#39;s support team for more information.
&gt; &gt;
&gt; &gt;Best Regards,
&gt; &gt;Sheng
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
</div>&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;16&nbsp;04:47:15&nbsp;2008</span>
    <span class="description">yesheng [...] tsinghua.org.cn -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re:[rt.cpan.org #33529] AutoReply: Bug Report of Tk-804.028 Tk::Text </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 16 Sep 2008 16:19:31 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> yesheng [...] tsinghua.org.cn</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">update to issue #33529.

Further test show the crash happen at clipboardGet&#40;&#41; function in Tk/Clipboard.pm:
 $w-&gt;SelectionGet&#40;&#39;-selection&#39;,&#39;CLIPBOARD&#39;,@_&#41;;

According to your suggest, I have tried 804.028 against 804.027, there is a
difference:

* If some text is ok for 804.027, it is also ok for 804.028.
* If some text will cause 804.027 crash, it will cause 804.028 show garbage
characters. So I guess it is a partially fixed issue.

Best Regards,
Sheng
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;05&nbsp;04:25:37&nbsp;2008</span>
    <span class="description">issue33529 [...] yahoo.cn -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33529] Bug Report of Tk-804.028 Tk::Text</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 5 Dec 2008 17:25:19 +0800 &#40;CST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tk &lt;issue33529 [...] yahoo.cn&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Slaven,

Now I have found a very important clue for the issue!

Whether the Chinese&#40;or other non-ascii chars&#41; text is shown correctly only depends on the Number of &lt;newline&gt; in the text.

My test show that if a text contain 4 or 5 lines,
or 9/10 lines,
or 14/15 lines,
or 19/20 lines,
or 24/25 lines,
or 29/30 lines

The text pasted to Tk804.028 edit window will show garbage characters!

So my conclusion is: 

If a text contain 5n-1 or 5n &#40;n=1,2,3,...&#41; number of &lt;newlines&gt;, all the Chinese characters pasted in edit window will be shown incorrectly, but the ASCII characters are shown correctly.

Hope above info give help for your debugging.

I am looking forward for the solution or workaround soon.

Many Thanks,
Sheng




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">      ___________________________________________________________ 
  好玩贺卡等你发，邮箱贺卡全新上线！ 
<span class="clickylink"><a target="new" rel="nofollow" href="http://card.mail.cn.yahoo.com/">http://card.mail.cn.yahoo.com/</a></span>
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;05&nbsp;12:26:33&nbsp;2008</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33529] Bug Report of Tk-804.028 Tk::Text</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 5 Dec 2008 09:26:06 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;issue33529 [...] yahoo.cn via RT&#34; &lt;bug-Tk [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Dec 05, 2008 at 04:25:42AM -0500, issue33529@yahoo.cn via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Whether the Chinese&#40;or other non-ascii chars&#41; text is shown correctly only depends on the Number of &lt;newline&gt; in the text.
&gt; 
&gt; My test show that if a text contain 4 or 5 lines,
&gt; or 9/10 lines,
&gt; or 14/15 lines,
&gt; or 19/20 lines,
&gt; or 24/25 lines,
&gt; or 29/30 lines
&gt; 
&gt; The text pasted to Tk804.028 edit window will show garbage characters!
</div>
Just some random questions:

  Always garbage, or only for some chars?

  What is the encoding of your clipboard?

  inspecting the binary representation &#40;2 bytes&#41; of your chars, do
    they contain 0x0A?

Thanks,
Ilyy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;06&nbsp;10:06:39&nbsp;2008</span>
    <span class="description">issue33529 [...] yahoo.cn -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33529] Bug Report of Tk-804.028 Tk::Text</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 6 Dec 2008 23:06:19 +0800 &#40;CST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tk &lt;issue33529 [...] yahoo.cn&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, following is my answers, please check:

* Always garbage for whatever and how many Chinese chars, as long as total newline numbers are 4,5; 9,10;...
* I am sure my clipboard use &#39;gbk&#39; encode.
* No 0x0A in text, it do not depend on special characters.
 
BTW, Now I found a new rule:
========================
If &lt;newline&gt; number is 4,9, 14,19, 24,29,...
&#40;rule a&#41; when the text is ended by ChineseChar+&lt;newline&gt;,  it will show garbage
&#40;rule b&#41; in other case no garbage.
 
If &lt;newline&gt; number is 5,10, 15,20, 25,30,...
&#40;rule c&#41; when the text is ended by ChineseChar+&lt;newline&gt; or ChineseChar+AsciiChar+&lt;newline&gt;,  it will show garbage
&#40;rule d&#41; in other case no garbage.
========================
Following is text examples&#40;&lt;nl&gt; means newline: 0x0A&#41;:
&#40;1&#41; following will show garbage&#40;rule a&#41;
1&lt;nl&gt;
2&lt;nl&gt;
3&lt;nl&gt;
好&lt;nl&gt;
&#40;2&#41; folloing will not show garbage&#40;because newline number is 3&#41;
1&lt;nl&gt;
2&lt;nl&gt;
3&lt;nl&gt;
好
&#40;3&#41; following will not show garbage&#40;rule b&#41;
1&lt;nl&gt;
2&lt;nl&gt;
3&lt;nl&gt;
好4&lt;nl&gt;
&#40;4&#41; will not show garbage&#40;rule d&#41;
1&lt;nl&gt;
2&lt;nl&gt;
3&lt;nl&gt;
4&lt;nl&gt;
好05&lt;nl&gt;
&#40;5&#41;will show garbage&#40;rule c&#41;
1&lt;nl&gt;
2&lt;nl&gt;
3&lt;nl&gt;
4&lt;nl
好&lt;nl&gt;
&#40;6&#41;will show garbage&#40;rule c&#41;
1&lt;nl&gt;
2&lt;nl&gt;
3&lt;nl&gt;
4&lt;nl
好5&lt;nl&gt;
&#40;7&#41;will show garbage&#40;rule c&#41;
1&lt;nl&gt;
2&lt;nl&gt;
3&lt;nl&gt;
4&lt;nl&gt;
0好5&lt;nl&gt;
If I replace 好 with any other Chinese character, the same result happen.
It should happen at $w-&gt;SelectionGet&#40;&#39;-selection&#39;,&#39;CLIPBOARD&#39;,@_&#41;;



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">      ___________________________________________________________ 
  好玩贺卡等你发，邮箱贺卡全新上线！ 
<span class="clickylink"><a target="new" rel="nofollow" href="http://card.mail.cn.yahoo.com/">http://card.mail.cn.yahoo.com/</a></span>
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
