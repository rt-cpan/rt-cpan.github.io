<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #123201 for IO-Socket-SSL: Test failure with Visual C++ + Perl 5.26.1</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #123201 for IO-Socket-SSL: Test failure with Visual C++ + Perl 5.26.1</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Socket-SSL">IO-Socket-SSL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">123201</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/IO-Socket-SSL/Active/">IO-Socket-SSL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Steffen_Ullrich [...] genua.de
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
PLICEASE [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-17228-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-17229-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;05&nbsp;16:48:30&nbsp;2017</span>
    <span class="description">PLICEASE [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Test failure with Visual C++ + Perl 5.26.1</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I am seeing a failure in the t\connectSSL-timeout.t and t\npn.t tests with a Perl built with MS Visual C++ 14.1 64 bit.  Here is a detailed log I managed to capture:

<span class="clickylink"><a target="new" rel="nofollow" href="https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c">https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c</a></span>

I am also attaching the output of perl -V
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> perlv.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Summary of my perl5 &#40;revision 5 version 26 subversion 1&#41; configuration:
  Derived from: 
  Platform:
    osname=MSWin32
    osvers=6.1
    archname=MSWin32-x64-multi-thread
    uname=&#39;&#39;
    config_args=&#39;undef&#39;
    hint=recommended
    useposix=true
    d_sigaction=undef
    useithreads=define
    usemultiplicity=define
    use64bitint=define
    use64bitall=undef
    uselongdouble=undef
    usemymalloc=n
    default_inc_excludes_dot=define
    bincompat5005=undef
  Compiler:
    cc=&#39;cl&#39;
    ccflags =&#39;-nologo -GF -W3 -O1 -MD -Zi -DNDEBUG -GL -fp:precise -DWIN32 -D_CONSOLE -DNO_STRICT -DWIN64 -DCONSERVATIVE -D_CRT_SECURE_NO_DEPRECATE -D_CRT_NONSTDC_NO_DEPRECATE -D_WINSOCK_DEPRECATED_NO_WARNINGS  -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS&#39;
    optimize=&#39;-O1 -MD -Zi -DNDEBUG -GL -fp:precise&#39;
    cppflags=&#39;-DWIN32&#39;
    ccversion=&#39;19.11.25508.2&#39;
    gccversion=&#39;&#39;
    gccosandvers=&#39;&#39;
    intsize=4
    longsize=4
    ptrsize=8
    doublesize=8
    byteorder=12345678
    doublekind=3
    d_longlong=undef
    longlongsize=8
    d_longdbl=define
    longdblsize=8
    longdblkind=0
    ivtype=&#39;__int64&#39;
    ivsize=8
    nvtype=&#39;double&#39;
    nvsize=8
    Off_t=&#39;__int64&#39;
    lseeksize=8
    alignbytes=8
    prototype=define
  Linker and Libraries:
    ld=&#39;link&#39;
    ldflags =&#39;-nologo -nodefaultlib -debug -opt:ref,icf -ltcg  -libpath:&#34;n:\lang\perl\msvs\x64\5.26.1\lib\CORE&#34;  -machine:AMD64&#39;
    libpth=N:\lang\msvs\2017\Community\VC\Tools\MSVC\14.11.25503\\lib\x64
    libs=oldnames.lib kernel32.lib user32.lib gdi32.lib winspool.lib  comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib  netapi32.lib uuid.lib ws2_32.lib mpr.lib winmm.lib  version.lib odbc32.lib odbccp32.lib comctl32.lib msvcrt.lib vcruntime.lib ucrt.lib
    perllibs=oldnames.lib kernel32.lib user32.lib gdi32.lib winspool.lib  comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib  netapi32.lib uuid.lib ws2_32.lib mpr.lib winmm.lib  version.lib odbc32.lib odbccp32.lib comctl32.lib msvcrt.lib vcruntime.lib ucrt.lib
    libc=ucrt.lib
    so=dll
    useshrplib=true
    libperl=perl526.lib
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_win32.xs
    dlext=dll
    d_dlsymun=undef
    ccdlflags=&#39; &#39;
    cccdlflags=&#39; &#39;
    lddlflags=&#39;-dll -nologo -nodefaultlib -debug -opt:ref,icf -ltcg  -libpath:&#34;n:\lang\perl\msvs\x64\5.26.1\lib\CORE&#34;  -machine:AMD64&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options:
    HAS_TIMES
    HAVE_INTERP_INTERN
    MULTIPLICITY
    PERLIO_LAYERS
    PERL_COPY_ON_WRITE
    PERL_DONT_CREATE_GVSV
    PERL_IMPLICIT_CONTEXT
    PERL_IMPLICIT_SYS
    PERL_MALLOC_WRAP
    PERL_OP_PARENT
    PERL_PRESERVE_IVUV
    USE_64_BIT_INT
    USE_ITHREADS
    USE_LARGE_FILES
    USE_LOCALE
    USE_LOCALE_COLLATE
    USE_LOCALE_CTYPE
    USE_LOCALE_NUMERIC
    USE_LOCALE_TIME
    USE_PERLIO
    USE_PERL_ATOF
  Locally applied patches:
    uncommitted-changes
  Built under MSWin32
  Compiled at Oct  5 2017 10:02:13
  %ENV:
    PERL5LIB=&#34;n:\home\ollisg\perl5\msvs\x64\5.26.1\lib\perl5&#34;
    PERL_CPANM_OPT=&#34;--mirror <span class="clickylink"><a target="new" rel="nofollow" href="http://mirror.sydney.wdlabs.com/cpan/">http://mirror.sydney.wdlabs.com/cpan/</a></span> --mirror-only&#34;
    PERL_LOCAL_LIB_ROOT=&#34;n:\home\ollisg\perl5\msvs\x64\5.26.1&#34;
    PERL_MB_OPT=&#34;--install_base &#34;n:\\home\\ollisg\\perl5\\msvs\\x64\\5.26.1&#34;&#34;
    PERL_MM_OPT=&#34;INSTALL_BASE=n:\\home\\ollisg\\perl5\\msvs\\x64\\5.26.1&#34;
    PERL_PKG_CONFIG_SCRIPTS=&#34;pkg-config&#34;
  @INC:
    n:\home\ollisg\perl5\msvs\x64\5.26.1\lib\perl5/5.26.1/MSWin32-x64-multi-thread
    n:\home\ollisg\perl5\msvs\x64\5.26.1\lib\perl5/5.26.1
    n:\home\ollisg\perl5\msvs\x64\5.26.1\lib\perl5/MSWin32-x64-multi-thread
    n:\home\ollisg\perl5\msvs\x64\5.26.1\lib\perl5
    N:/lang/perl/msvs/x64/5.26.1/lib
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;21&nbsp;15:11:13&nbsp;2017</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Do 05. Okt 2017, 16:48:30, PLICEASE schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am seeing a failure in the t\connectSSL-timeout.t and t\npn.t tests
&gt; with a Perl built with MS Visual C++ 14.1 64 bit.  Here is a detailed
&gt; log I managed to capture:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c">https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c</a></span>
&gt; 
</div>

From the output of the tests:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; t\01loadmodule.t .................. # openssl version=0x20000000
</div>
It looks like you are using LibreSSL. I&#39;ve got similar reports with OpenBSD since they simply disabled NPN support in LibreSSL without removing the functions, i.e. the functions claim to succeed but actually don&#39;t set the NPN extension :&#40; That&#39;s why the t/npn.t tests fails. 

As for the t/connectSSL-timeout.t: could you please rerun the tests with verbosity or simply &#34;perl -Mblib t/...&#34; and provide the output. Also, can you verify that the tests fails reliably all the time? Windows is known to be flaky with nonblocking support and the timeout is implemented using nonblocking sockets. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;21&nbsp;15:11:14&nbsp;2017</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;21&nbsp;15:11:54&nbsp;2017</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;22&nbsp;02:09:18&nbsp;2017</span>
    <span class="description">PLICEASE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Oct 21 15:11:13 2017, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; From the output of the tests:
<div class="message-stanza open">&gt; &gt; t\01loadmodule.t .................. # openssl version=0x20000000
</div>&gt; 
&gt; It looks like you are using LibreSSL. I&#39;ve got similar reports with
&gt; OpenBSD since they simply disabled NPN support in LibreSSL without
&gt; removing the functions, i.e. the functions claim to succeed but
&gt; actually don&#39;t set the NPN extension :&#40; That&#39;s why the t/npn.t tests
&gt; fails.
</div>
Ah, thanks for the info it looks as though this may be related to <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=122916">https://rt.cpan.org/Ticket/Display.html?id=122916</a></span> .  I can for now patch my local copy of IO::Socket::SSL to set $can_npn to false.  Or maybe install Net::SSLeay from subversion.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As for the t/connectSSL-timeout.t: could you please rerun the tests
&gt; with verbosity or simply &#34;perl -Mblib t/...&#34; and provide the output.
&gt; Also, can you verify that the tests fails reliably all the time?
&gt; Windows is known to be flaky with nonblocking support and the timeout
&gt; is implemented using nonblocking sockets.
</div>
I just tried it a couple of times and timeout failure is indeed not reliable.  Sometimes it blocks indefinitely.  I ran both tests with verbose output after the full summary.  You can see the results here:

<span class="clickylink"><a target="new" rel="nofollow" href="https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c#file-gistfile1-txt-L149">https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c#file-gistfile1-txt-L149</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;22&nbsp;04:57:43&nbsp;2017</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Ah, thanks for the info it looks as though this may be related to
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=122916">https://rt.cpan.org/Ticket/Display.html?id=122916</a></span> .  I can for now
&gt; patch my local copy of IO::Socket::SSL to set $can_npn to false.  Or
&gt; maybe install Net::SSLeay from subversion.
</div>
I&#39;ve just released IO::Socket::SSL 2.052 which should work around this &#34;feature&#34; of LibreSSL of still implementing the functions related to NPN while removing the actual functionality from these functions.  Hopefully the test will now detect that NPN is not supported.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; As for the t/connectSSL-timeout.t: could you please rerun the tests
&gt; &gt; with verbosity or simply &#34;perl -Mblib t/...&#34; and provide the output.
&gt; &gt; Also, can you verify that the tests fails reliably all the time?
&gt; &gt; Windows is known to be flaky with nonblocking support and the timeout
&gt; &gt; is implemented using nonblocking sockets.
</div>&gt; 
&gt; I just tried it a couple of times and timeout failure is indeed not
&gt; reliable.  Sometimes it blocks indefinitely.  I ran both tests with
&gt; verbose output after the full summary.  You can see the results here:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c#file-">https://gist.github.com/plicease/bcd1f68ed7187d5f07d938316e50141c#file-</a></span>
&gt; gistfile1-txt-L149
</div>
The verbose output says:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; not ok # An operation was attempted on something that is not a socket. at ./t/testlib.pl line 181.
</div>
The relevant part in testlib.pl is just trying to create a simple IO::Socket::INET listener and the error comes from inside IO::Socket::INET. I have no idea what is going on there internally in Windows. But again, Windows support seems to be flaky although it looks like the tests &#40;which use fork&#41; stress the Windows support more than production code.

I will close the bug for now since the first problem should be solved and the second one seems to be outside IO::Socket::SSL.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;22&nbsp;04:57:44&nbsp;2017</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;22&nbsp;08:44:15&nbsp;2017</span>
    <span class="description">PLICEASE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Oct 22 04:57:43 2017, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The relevant part in testlib.pl is just trying to create a simple
&gt; IO::Socket::INET listener and the error comes from inside
&gt; IO::Socket::INET. I have no idea what is going on there internally in
&gt; Windows. But again, Windows support seems to be flaky although it
&gt; looks like the tests &#40;which use fork&#41; stress the Windows support more
&gt; than production code.
&gt; 
&gt; I will close the bug for now since the first problem should be solved
&gt; and the second one seems to be outside IO::Socket::SSL.
</div>
I did some more testing last night and the other test that uses fork_sub also fails intermittently.  At least one of them fails most of the time.  Given how unreliable these tests are under psudo-fork I do think it would be better to either rewrite the test so that it doesn&#39;t rely on fork, or to skip it on windows.

I suppose failing that it would be helpful to either leave this bug open or have some documentation that these tests are expected to fail frequently on windows.  It looks like Strawberry Perl just skips the tests for this module, which is unfortunately par for course for Strawberry :&#40;

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/KMX/Perl-Dist-Strawberry-4.014/share/64bit-5.26.0.1.pp#L174">https://metacpan.org/source/KMX/Perl-Dist-Strawberry-4.014/share/64bit-5.26.0.1.pp#L174</a></span>
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
