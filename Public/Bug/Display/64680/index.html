<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #64680 for Proc-Daemon: PGID does not exist after calling Proc::Daemon::Init&#40;&#41; &#40;POSIX::setsid&#40;&#41;&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #64680 for Proc-Daemon: PGID does not exist after calling Proc::Daemon::Init&#40;&#41; &#40;POSIX::setsid&#40;&#41;&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Proc-Daemon">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Proc-Daemon">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Proc-Daemon">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Proc-Daemon">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Proc-Daemon">Proc-Daemon CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">64680</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Proc-Daemon">Proc-Daemon</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
RWSTAUNER [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-27158-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.05    </td>
  </tr>
  <tr id="CF-27159-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Daemon.zip<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/880739/456260/Daemon.zip">
Wed Jan 12 17:14:11 2011 (5.1k) by DetlefPilzecker [...] web.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=64680">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-880088" href="/Public/Bug/Display.html?id=64680#txn-880088">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;11&nbsp;01:14:50&nbsp;2011</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> PGID does not exist after calling Proc::Daemon::Init&#40;&#41;
 &#40;POSIX::setsid&#40;&#41;&#41;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/880088/455876/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/455876">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Using perl 5.8.3 on Linux &#40;specifically Fedora Core 2 &#40;5+ years old&#41;&#41;...

After doing Proc::Daemon::Init&#40;&#41;;
the current process group id is invalid &#40;there is no process by that ID&#41;.
This is because the POSIX::setsid&#40;&#41; is called after the first fork and
before the second.

The daemon I had written was attempting to send a signal to its process
group &#40;an example I found in perlipc&#41;, and it took me a while to
diagnose why it wasn&#39;t working...

Specifically I had one process that forked and maintained a child &#40;which
looped around a system call.  The main process was set up to intercept
TERM and then pass it on to its children &#40;using its process group&#41;:

kill&#40;TERM =&gt; -$$&#41;;

But the children never got the signal, because they all belonged to a
process group that was surprisingly different than my main process.

I would end up with a ps listing like so:
PID PGID
102 101 main
103 101 second
104 101 third

main originally had a PID of 100... then Proc::Daemon::Init forked &#40;PID
101&#41;, POSIX::setsid&#40;&#41; &#40;PGID 101&#41;, then forked again &#40;PID 102&#41;.
So I couldn&#39;t use &#34;-$$&#34; to signal the obvious process group.
Trying to maintain my PIDs &#40;particularly because I was doing a system&#40;&#41;&#41;
seemed more complicated than necessary.
When I realized what was happening I called POSIX::setsid&#40;&#41; after
calling Proc::Daemon::Init&#40;&#41; and once again everything worked as expected.

So I don&#39;t know if you have an argument one way or another about the way
that it currently works, but at the very least I was confused and fooled
around &#40;with the wrong code&#41; for an hour.
So if there&#39;s a good reason for leaving the PGID at an unexistent
process, then I&#39;d suggest that you at least document it.

Otherwise I appreciate the module &#40;especially its simplicity&#41;
and look forward to replacing some more old code I have with a simple
Proc::Daemon::Init&#40;&#41; call.
Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-880739" href="/Public/Bug/Display.html?id=64680#txn-880739">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;12&nbsp;17:14:11&nbsp;2011</span>
    <span class="description">DetlefPilzecker [...] web.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> deti [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/880739/456259/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/456259">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 461b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi RWSTAUNER!

Thanks for reporting!


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; After doing Proc::Daemon::Init&#40;&#41;; the current process
&gt; group id is invalid &#40;there is no process by that ID&#41;.
</div>
Confirmed.

Can you test the attached Daemon.pm in the .zip by replacing it with 
the original? Does it solve your problem?


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Otherwise I appreciate the module &#40;especially its simplicity&#41;
&gt; and look forward to replacing some more old code I have with a simple
&gt; Proc::Daemon::Init&#40;&#41; call.
&gt; Thanks!
</div>
Thanks!
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Daemon.zip</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/880739/456260/Daemon.zip">Download Daemon.zip</a><br />
<span class="downloadcontenttype">application/zip 5.1k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-880742" href="/Public/Bug/Display.html?id=64680#txn-880742">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;12&nbsp;17:14:12&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-880770" href="/Public/Bug/Display.html?id=64680#txn-880770">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;12&nbsp;17:35:34&nbsp;2011</span>
    <span class="description">ehood [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/880770/456285/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/456285">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 381b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m not sure this is a real bug.  One of the main goals of running
as a daemon process is to completely detaching from the parent
process, including any session ID it may have.  This way, signals
to the session ID does not go to the daemon process.

I.e.  By definition, a daemon runs with its own session ID.

It seems the case reported here is the &#34;daemon&#34; is not truly
a daemon.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-881276" href="/Public/Bug/Display.html?id=64680#txn-881276">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;13&nbsp;16:32:29&nbsp;2011</span>
    <span class="description">DetlefPilzecker [...] web.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> deti [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/881276/456578/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/456578">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not sure this is a real bug.  One of the main goals of running
&gt; as a daemon process is to completely detaching from the parent
&gt; process, including any session ID it may have.  This way, signals
&gt; to the session ID does not go to the daemon process.
&gt; 
&gt; I.e.  By definition, a daemon runs with its own session ID.
&gt; 
&gt; It seems the case reported here is the &#34;daemon&#34; is not truly
&gt; a daemon.
</div>
I wasn&#39;t sure too.
Unfortunately I can&#39;t find an example out in the web showing and 
explaining a double-fork with setsid. Only double-fork without setsid 
or single fork with setsid.
At the moment &#40;with our double-fork&#41; we detach from the parent and then 
we exit the detached child leaving the grandchild running without 
session leader. I came to the conclusion that this can&#39;t be right too. 
So in my previously attached file the grandchild &#40;real daemon&#41; also 
becomes a session leader. This way it is detached from the possibly 
running grandparent and the exited parent.

Comments and/or examples how to do it better are strongly appreciated!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-881293" href="/Public/Bug/Display.html?id=64680#txn-881293">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;13&nbsp;17:05:14&nbsp;2011</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> RWSTAUNER [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/881293/456587/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/456587">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 801b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yes, that solves the problem and seems to make sense to me.
Does that seem appropriate to you?
There&#39;s no way for me to get the PGID in the way it works in v0.05,
so I had to call setsid&#40;&#41; myself.  Just seemed like an extra step.
Thanks!

On Wed Jan 12 17:14:11 2011, DetlefPilzecker@web.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi RWSTAUNER!
&gt; 
&gt; Thanks for reporting!
&gt; 
&gt; 
<div class="message-stanza open">&gt; &gt; After doing Proc::Daemon::Init&#40;&#41;; the current process
&gt; &gt; group id is invalid &#40;there is no process by that ID&#41;.
</div>&gt; 
&gt; Confirmed.
&gt; 
&gt; Can you test the attached Daemon.pm in the .zip by replacing it with 
&gt; the original? Does it solve your problem?
&gt; 
&gt; 
<div class="message-stanza open">&gt; &gt; Otherwise I appreciate the module &#40;especially its simplicity&#41;
&gt; &gt; and look forward to replacing some more old code I have with a simple
&gt; &gt; Proc::Daemon::Init&#40;&#41; call.
&gt; &gt; Thanks!
</div>&gt; 
&gt; Thanks!
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-882749" href="/Public/Bug/Display.html?id=64680#txn-882749">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;17&nbsp;11:45:16&nbsp;2011</span>
    <span class="description">DETI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/882749/457427/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/457427">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza">On Thu Jan 13 17:05:14 2011, RWSTAUNER wrote:<br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yes, that solves the problem and seems to make sense to me.<br>

&gt; Does that seem appropriate to you?<br>
</div><br>

First it did, now it doesn't any more.<br>

After many researches I will add the following comment into the source code:<br>

<br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"># ...<br>

# This second fork is not absolutely necessary, it is more a precaution.<br>

# 1. Prevent possibility of reacquiring a controlling terminal.<br>

# Without this fork the daemon would remain a session-leader. In<br>

# this case there is a potential possibility that the process could<br>

# reacquire a controlling terminal. E.g. if it opens a terminal device,<br>

# without using the O_NOCTTY flag. In Perl this is normally the case<br>

# when you use &lt;open&gt;, instead of &lt;sysopen&gt; with the O_NOCTTY flag<br>

# set.<br>

# ...<br>
</div><br>

And in the documentation I will add:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><blockquote>


<div>NOTE: Because of the second fork the daemon will not be a session-leader and<br>
therefore Signals will not be send to other members of his process group. If<br>
you need the functionality of a session-leader you may want to call<br>
POSIX::setsid() manually on your daemon.</div>

</blockquote>
</div>I think this is the right way to do it.&nbsp;<br>

Thanks again for your contribution!<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-882785" href="/Public/Bug/Display.html?id=64680#txn-882785">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;17&nbsp;13:40:09&nbsp;2011</span>
    <span class="description">DETI [...] cpan.org -  Ticket deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-882786" href="/Public/Bug/Display.html?id=64680#txn-882786">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;17&nbsp;13:40:12&nbsp;2011</span>
    <span class="description">DETI [...] cpan.org -  Status changed from &#39;deleted&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-882787" href="/Public/Bug/Display.html?id=64680#txn-882787">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;17&nbsp;14:30:13&nbsp;2011</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> RWSTAUNER [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/882787/457450/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/457450">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 195b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sounds ok to me.

As long as the current functionality is clear &#40;in comments and/or pod&#41;
I understand what&#39;s happening and how I should use the module.

Thanks for investigating/considering this!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-882864" href="/Public/Bug/Display.html?id=64680#txn-882864">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;17&nbsp;17:18:47&nbsp;2011</span>
    <span class="description">DETI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/882864/457488/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/457488">with headers</a>
<br />
<span class="downloadcontenttype">text/html 89b</span>
</div>
<div class="messagebody">
<div class="message-stanza">Uploaded version 0.06 on PAUSE now. It should be available in some hours at CPAN.
 <br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-882867" href="/Public/Bug/Display.html?id=64680#txn-882867">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;17&nbsp;17:21:40&nbsp;2011</span>
    <span class="description">DETI [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.536437</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
