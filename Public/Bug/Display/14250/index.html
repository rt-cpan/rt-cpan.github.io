<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #14250 for Class-Std: No Class::Std behaviours for runtime loaded classes</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #14250 for Class-Std: No Class::Std behaviours for runtime loaded classes</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Class-Std">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Class-Std">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Class-Std">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Class-Std">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Class-Std">Class-Std CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">14250</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Class-Std">Class-Std</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dan.kubb-cpan [...] autopilotmarketing.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-7300-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.0.4    </td>
  </tr>
  <tr id="CF-7301-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Class-Std+runtime.tgz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/591084/299331/Class-Std%2Bruntime.tgz">
Tue Apr 14 12:27:15 2009 (25.5k) by jloverso [...] mathworks.com
</a>
</font></li>
</ul>


Class-Std-runtime_loaded.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/140167/39172/Class-Std-runtime_loaded.patch">
Sun Aug 21 21:44:45 2005 (7.9k) by 
</a>
</font></li>
</ul>


Class-Std.tgz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/140171/39351/Class-Std.tgz">
Fri Aug 26 02:03:50 2005 (21.7k) by jonathan.glatt [...] gmail.com
</a>
</font></li>
</ul>


t_runtime.tgz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/591062/299316/t_runtime.tgz">
Tue Apr 14 11:46:18 2009 (1.8k) by jloverso [...] mathworks.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=14250">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-140167" href="/Public/Bug/Display.html?id=14250#txn-140167">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;21&nbsp;21:44:45&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> No Class::Std behaviours for runtime loaded classes</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/140167/39171/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/39171">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Class::Std classes don&#39;t retain all of their behaviour when they are &#34;use eval&#39;d&#34; at runtime.

For example CUMULATIVE, PRIVATE and RESTRICTED attributes have no effect for classes loaded at runtime.  This can lead to subtle bugs where you believe CUMULATIVE is working, but because of how the classes were originally loaded, the behaviour was not enabled, since the CHECK block was not executed.

There are cases where I don&#39;t know precisely what classes will be used until run-time, or when I&#39;m writing test cases with Test::More and load the class using use_ok&#40;&#41;.

Attached is a patch to corrects this problem.  It installs an &#34;import&#34; method in the Class::Std derived class that reloads all the Class::Std behaviours.  The loading systems used to be inside the CHECK block, but they have been moved into their own subroutines.  The CHECK block still executes, but it uses the new subroutines to set up everything.

I looked for a way to do it without using a CHECK block at all, but I could not find an approach that would work in all instances.. if you have any ideas I&#39;d love to hear them, and I&#39;d be glad to implement them and supply a patch.  I tried re-installing all the behaviour when the new&#40;&#41; constructor was used &#40;being careful not to wastefully repeat the process more than once&#41;, but I couldn&#39;t get all the test cases to pass with that approach.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/140167/39172/Class-Std-runtime_loaded.patch">Download Class-Std-runtime_loaded.patch</a><br />
<span class="downloadcontenttype">text/x-diff 7.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -urN Class-Std-0.0.4/lib/Class/Std.pm Class-Std-NEW/lib/Class/Std.pm
--- Class-Std-0.0.4/lib/Class/Std.pm	2005-08-06 21:19:22.000000000 -0700
+++ Class-Std-NEW/lib/Class/Std.pm	2005-08-21 18:10:30.000000000 -0700
@@ -10,8 +10,6 @@
 
 *ID = \&#38;Scalar::Util::refaddr;
 
-my &#40;%attribute, %cumulative, %anticumulative, %restricted, %private, %overload&#41;;
-
 my @exported_subs = qw&#40;
     new
     DESTROY
@@ -25,10 +23,14 @@
     my $caller = caller;
 
     no strict &#39;refs&#39;;
-    *{ $caller . &#39;::ident&#39;   } = \&#38;Scalar::Util::refaddr;
+    *{ $caller . &#39;::ident&#39;  } = __PACKAGE__-&gt;can&#40;&#39;ID&#39;&#41;;
+    *{ $caller . &#39;::import&#39; } = __PACKAGE__-&gt;can&#40;&#39;_install_handlers&#39;&#41;;
+
     for my $sub &#40; @exported_subs &#41; {
-        *{ $caller . &#39;::&#39; . $sub } = \&#38;{$sub};
+        *{ $caller . &#39;::&#39; . $sub } = __PACKAGE__-&gt;can&#40;$sub&#41;;
     }
+
+    return;
 }
 
 sub _find_sub {
@@ -73,6 +75,8 @@
 *_extract_get      = _extractor_for_pair_named&#40;&#39;get&#39;&#41;;
 *_extract_set      = _extractor_for_pair_named&#40;&#39;set&#39;&#41;;
 
+my %attribute;
+
 sub MODIFY_HASH_ATTRIBUTES {
     my &#40;$package, $referent, @attrs&#41; = @_;
     for my $attr &#40;@attrs&#41; {
@@ -86,7 +90,7 @@
                 no strict &#39;refs&#39;;
                 *{$package.&#39;::get_&#39;.$getter} = sub {
                     return $referent-&gt;{ID&#40;$_[0]&#41;};
-                }
+                };
             }
             if &#40;$setter = _extract_set&#40;$config&#41;&#41; {
                 no strict &#39;refs&#39;;
@@ -97,7 +101,7 @@
                     my $old_val = $referent-&gt;{ID&#40;$self&#41;};
                     $referent-&gt;{ID&#40;$self&#41;} = $new_val;
                     return $old_val;
-                }
+                };
             }
         }
         undef $attr;
@@ -149,6 +153,9 @@
     CODIFY    =&gt; sprintf&#40; $STD_OVERLOADER, q{&#38;{}}  &#41;,
 &#41;;
 
+
+my &#40;%cumulative, %anticumulative, %restricted, %private, %overload&#41;;
+
 sub MODIFY_CODE_ATTRIBUTES {
     my &#40;$package, $referent, @attrs&#41; = @_;
     for my $attr &#40;@attrs&#41; {
@@ -158,10 +165,10 @@
         elsif &#40;$attr =~ m/\A CUMULATIVE \s* [&#40;] \s* BASE \s* FIRST \s* [&#41;] \z/xms&#41; {
             push @{$anticumulative{$package}}, $referent;
         }
-        elsif &#40;$attr =~ m/\A RESTRICTED \z/xms&#41; {
+        elsif &#40;$attr eq &#39;RESTRICTED&#39;&#41; {
             push @{$restricted{$package}}, $referent;
         }
-        elsif &#40;$attr =~ m/\A PRIVATE \z/xms&#41; {
+        elsif &#40;$attr eq &#39;PRIVATE&#39;&#41; {
             push @{$private{$package}}, $referent;
         }
         elsif &#40;exists $OVERLOADER_FOR{$attr}&#41; {
@@ -224,9 +231,20 @@
 }
 
 CHECK {
-    my &#40;%cumulative_named, %anticumulative_named&#41;;
+    _install_handlers&#40;&#41;;
+}
+
+sub _install_handlers {
+    _install_restricted&#40;&#41;;
+    _install_private&#40;&#41;;
+    _install_cumulative&#40;&#41;;
+    _install_anticumulative&#40;&#41;;
+    _install_overload&#40;&#41;;
+    return;
+}
 
-    # Implement restricted methods &#40;only callable within hierarchy&#41;...
+# Implement restricted methods &#40;only callable within hierarchy&#41;...
+sub _install_restricted {
     for my $package &#40;keys %restricted&#41; {
         for my $sub_ref &#40;@{$restricted{$package}}&#41; {
             my $name = _find_sub&#40;$package, $sub_ref&#41;;
@@ -234,18 +252,24 @@
             no strict &#39;refs&#39;;
             my $sub_name = $package.&#39;::&#39;.$name;
             my $original = *{$sub_name}{CODE}
-                or croak &#34;Restricted method ${package}::$name&#40;&#41; declared &#34;,
+                or croak &#34;Restricted method $sub_name&#40;&#41; declared &#34;,
                          &#39;but not defined&#39;;
             *{$sub_name} = sub {
                 my $caller = caller;
                 goto &#38;{$original} if $caller-&gt;isa&#40;$package&#41;
                                   || $package-&gt;isa&#40;$caller&#41;;
                 croak &#34;Can&#39;t call restricted method $sub_name&#40;&#41; from class $caller&#34;;
-            }
+            };
         }
     }
 
-    # Implement private methods &#40;only callable from class itself&#41;...
+    %restricted = &#40;&#41;;
+
+    return;
+}
+
+# Implement private methods &#40;only callable from class itself&#41;...
+sub _install_private {
     for my $package &#40;keys %private&#41; {
         for my $sub_ref &#40;@{$private{$package}}&#41; {
             my $name = _find_sub&#40;$package, $sub_ref&#41;;
@@ -253,16 +277,24 @@
             no strict &#39;refs&#39;;
             my $sub_name = $package.&#39;::&#39;.$name;
             my $original = *{$sub_name}{CODE}
-                or croak &#34;Private method ${package}::$name&#40;&#41; declared &#34;,
+                or croak &#34;Private method $sub_name&#40;&#41; declared &#34;,
                          &#39;but not defined&#39;;
             *{$sub_name} = sub {
                 my $caller = caller;
                 goto &#38;{$original} if $caller eq $package;
                 croak &#34;Can&#39;t call private method $sub_name&#40;&#41; from class $caller&#34;;
-            }
+            };
         }
     }
 
+    %private = &#40;&#41;;
+
+    return;
+}
+
+my %cumulative_named;
+
+sub _install_cumulative {
     for my $package &#40;keys %cumulative&#41; {
         for my $sub_ref &#40;@{$cumulative{$package}}&#41; {
             my $name = _find_sub&#40;$package, $sub_ref&#41;;
@@ -298,7 +330,15 @@
             };
         }
     }
+    
+    %cumulative = &#40;&#41;;
+
+    return;
+}
+
+my %anticumulative_named;
 
+sub _install_anticumulative {
     for my $package &#40;keys %anticumulative&#41; {
         for my $sub_ref &#40;@{$anticumulative{$package}}&#41; {
             my $name = _find_sub&#40;$package, $sub_ref&#41;;
@@ -346,16 +386,25 @@
         }
     }
 
+    %anticumulative = &#40;&#41;;
+
+    return;
+}
+
+sub _install_overload {
     for my $package &#40;keys %overload&#41; {
-        foreach my $operation &#40;@{ $overload{$package} }&#41; {
+        for my $operation &#40;@{ $overload{$package} }&#41; {
             my &#40;$referent, $attr&#41; = @$operation;
             local $^W;
             my $method = _find_sub&#40;$package, $referent&#41;;
             eval sprintf $OVERLOADER_FOR{$attr}, &#40;$package&#41;x2;
             die &#34;Internal error: $@&#34; if $@;
         }
-        delete $overload{$package};
     }
+
+    %overload = &#40;&#41;;
+
+    return;
 }
 
 sub new {
@@ -426,7 +475,6 @@
     return grep { $seen{$_}++ } @_;
 }
 
-
 sub _mislabelled {
     my &#40;@names&#41; = map { qq{&#39;$_&#39;} } uniq @_;
 
diff -urN Class-Std-0.0.4/t/runtime_load.t Class-Std-NEW/t/runtime_load.t
--- Class-Std-0.0.4/t/runtime_load.t	1969-12-31 16:00:00.000000000 -0800
+++ Class-Std-NEW/t/runtime_load.t	2005-08-21 18:10:03.000000000 -0700
@@ -0,0 +1,72 @@
+use Test::More tests =&gt; 11;
+
+use strict;
+use warnings FATAL =&gt; &#39;all&#39;;
+use lib &#39;t/lib&#39;;
+
+my $class = &#39;TestClass&#39;;
+
+USE: {
+    # suppress the &#39;Too late to run CHECK block&#39; warning
+    local $SIG{__WARN__} = sub {};
+    use_ok $class;
+}
+
+my $obj;
+
+NEW: {
+    my $method = &#39;new&#39;;
+
+    can_ok $class, $method;
+    isa_ok $obj = $class-&gt;$method, $class;
+}
+
+CUMULATIVE: {
+    my $method = &#39;cumulative&#39;;
+
+    can_ok $obj, $method;
+
+    is&#40;
+        $obj-&gt;$method,
+        &#39;TestClassTestClass::Base&#39;,
+        &#39;CUMULATIVE is enabled&#39;,
+    &#41;;
+}
+
+INSTALLED_PRIVATE: {
+    my $method = &#39;private&#39;;
+
+    eval &#34;package $class; sub $method : PRIVATE {}&#34;;
+    is $@, &#39;&#39;, &#39;no errors installing $method method&#39;;
+
+    # Reload Class::Std handlers
+    Class::Std::_install_handlers&#40;&#41;;
+
+    can_ok $obj, $method;
+
+    eval { $obj-&gt;$method };
+    like&#40;
+        $@,
+        qr/Can\&#39;t call private method/,
+        &#39;PRIVATE constraint works&#39;,
+    &#41;;
+}
+
+INSTALLED_RESTRICTED: {
+    my $method = &#39;restricted&#39;;
+
+    eval &#34;package $class; sub $method : RESTRICTED {}&#34;;
+    is $@, &#39;&#39;, &#39;no errors installing method&#39;;
+
+    # Reload Class::Std handlers
+    Class::Std::_install_handlers&#40;&#41;;
+
+    can_ok $obj, $method;
+
+    eval { $obj-&gt;$method };
+    like&#40;
+        $@,
+        qr/Can\&#39;t call restricted method/,
+        &#39;RESTRICTED constraint works&#39;,
+    &#41;;
+}
diff -urN Class-Std-0.0.4/t/lib/TestClass.pm Class-Std-NEW/t/lib/TestClass.pm
--- Class-Std-0.0.4/t/lib/TestClass.pm	1969-12-31 16:00:00.000000000 -0800
+++ Class-Std-NEW/t/lib/TestClass.pm	2005-08-21 18:06:25.000000000 -0700
@@ -0,0 +1,15 @@
+package TestClass;
+
+use Class::Std;
+
+our @ISA = qw&#40;TestClass::Base&#41;;
+
+sub cumulative : CUMULATIVE { __PACKAGE__ }
+
+package TestClass::Base;
+
+use Class::Std;
+
+sub cumulative : CUMULATIVE { __PACKAGE__ }
+
+1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-140168" href="/Public/Bug/Display.html?id=14250#txn-140168">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;25&nbsp;08:35:56&nbsp;2005</span>
    <span class="description">LMEYER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> luke [...] daeron.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/140168/39309/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/39309">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;d like to first note that this problem is disastrous for use with
mod_perl, where delayed loading is the common case, not the exception.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Attached is a patch to corrects this problem.  It installs an &#34;import&#34;
&gt;    method in the Class::Std derived class that reloads all the
&gt;    Class::Std behaviours.  The loading systems used to be inside the
&gt;    CHECK block, but they have been moved into their own subroutines.
&gt;    The CHECK block still executes, but it uses the new subroutines to
&gt;    set up everything.
</div>
I see problems with this implementation.  Specifically, as
_install_restricted et al create wrappers for for their methods, and
this occurs for ALL subs at EACH import -- you&#39;re going to have a lot of
wrapped wrappers.  What you need is an import that creates the wrappers
only for the class being imported, and a flag to keep it from happening
multiple times &#40;as an import can happen multiple times&#41;.

Also, import&#40;&#41; doesn&#39;t always get called.  Also also, the class may want
to have its own import method and this would preclude it.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I looked for a way to do it without using a CHECK block at all, but I
&gt;    could not find an approach that would work in all instances.. if
&gt;    you have any ideas I&#39;d love to hear them, and I&#39;d be glad to
&gt;    implement them and supply a patch.  I tried re-installing all the
&gt;    behaviour when the new&#40;&#41; constructor was used &#40;being careful not to
&gt;    wastefully repeat the process more than once&#41;, but I couldn&#39;t get
&gt;    all the test cases to pass with that approach.
</div>
If the flagged per-package approach is used I don&#39;t see why the CHECK
block would be necessary.  Seems like it could be done as easily in
new&#40;&#41; and probably should.  I&#39;ll play with this if I get some time.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-140171" href="/Public/Bug/Display.html?id=14250#txn-140171">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;26&nbsp;02:03:50&nbsp;2005</span>
    <span class="description">LMEYER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> luke [...] daeron.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/140171/39350/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/39350">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve created a simple patch that applies sub attributes at runtime
without futzing with import&#40;&#41; and without wrapping the wrappers.  The
CHECK block &#40;which previously adjusted all of the methods for every
package&#41; mutated into a sub that adjusts the methods -- once only -- for
a single package.  This sub is then called by new&#40;&#41;, so in essence the
adjustment is as lazy as possible.

The only problem I can see with this is that *class* &#40;non-object&#41;
methods with :attributes could be called before the first new&#40;&#41;, i.e.
before the attributes have been applied.  I&#39;m not sure this is really a
problem.  If it is, we could just add back the CHECK block, leaving this
corner case only for runtime-loaded classes.

I created two new test cases, which repeat the cumulative.t and access.t
tests with runtime-loaded classes.

But Wait, There&#39;s More!

Sometimes it comes in handy to reload a class &#40;when developing mod_perl
applications, for instance&#41;.  This doesn&#39;t work too well when the same
attributes and methods come in for processing the second time.  So I
also patched import&#40;&#41; to make Class::Std forget everything about a class
when it&#39;s &#40;re&#41;loaded.  I also created a test case for this.

The only problem with *that* would be if someone carelessly did a &#39;use
Class::Std&#39; twice in the same class, thereby wiping out any prior
declarations.  I think a &#34;don&#39;t do that&#34; would suffice for that.

It&#39;s a shame that coderefs don&#39;t make it into the symbol table before
MODIFY_CODE_ATTRIBUTES is called, or all of this delayed adjustment
could instead happen immediately when the sub is created.  Maybe in a
future attributes implementation.

Anyway, with this patch Class::Std classes can be created and reloaded
properly at runtime.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/140171/39351/Class-Std.tgz">Download Class-Std.tgz</a><br />
<span class="downloadcontenttype">application/x-gzip 21.7k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-140172" href="/Public/Bug/Display.html?id=14250#txn-140172">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;26&nbsp;06:16:18&nbsp;2005</span>
    <span class="description">DKUBB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dan.kubb-cpan [...] autopilotmarketing.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/140172/39360/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/39360">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I see problems with this implementation.  Specifically, as
&gt; _install_restricted et al create wrappers for for their methods, and
&gt; this occurs for ALL subs at EACH import -- you&#39;re going to have a lot
&gt; of wrapped wrappers.  What you need is an import that creates the
&gt; wrappers only for the class being imported, and a flag to keep it from
&gt; happening multiple times &#40;as an import can happen multiple times&#41;.
</div>
One thing that might not have been clear from the patch is that I reset
the %cumulative, %anticumulative and other hashes right after the
subs are wrapped the first time, thus making it impossible for a double
wrapping.  From what I can see this produces the same effective results
as deleting the hashes for a specific package inside the import as you
did in the patch submitted Aug 25th.

One other idea I had that *should* absolutely prevent double wrapping
of any kind is to actually bless the wrapper subroutine -- basically making
it an CODE-based object, beside installing it into the symbol table.
From then on whenever checking a subroutine to see if it has been
wrapped, you just need to check to see if its blessed and skip the
wrapping process.  &#40;never seen anyone bless a subroutine that is later
installed in the symbol table, but I see no reason why this won&#39;t work&#41;
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, import&#40;&#41; doesn&#39;t always get called.  Also also, the class may
&gt; want to have its own import method and this would preclude it.
</div>
You&#39;re right.. it is probably best not to do it in the import method.

Hmm, I wonder if maybe a better approach might be to explicitly execute
a method within the Class::Std derived class after all its methods are
properly named and installed in the symbol table, sort of like this:

------------------------------------------------------------
package My::Class;

use strict;
use warnings FATAL =&gt; &#39;all&#39;;
use Class::Std;
{
  my %name_of : ATTR;

  sub my_method : CUMULATIVE {
     # ...
  }
}

register_class;   # imported by Class::Std

------------------------------------------------------------

This might not be as auto-magical as a CHECK block or setting things
up in the new constructor, but being explicit might not be such a bad
idea in this case.  I haven&#39;t tested this, but I see no reason why it wouldn&#39;t
work.

This had the advantage of allowing class and object methods
to use Class::Std behaviour&#39;s properly as the module user would expect. I
don&#39;t think a module user should have to know anything about the internals
of a module in order to use it.  They shouldn&#39;t need to know that they can&#39;t
call class methods and expect them to implement Class::Std behaviours,
until the new constructor has been executed for the first time.

Combined with the bless&#39;d wrappers or clearing out of the Class::Std lexical
hashes after use should prevent double-wrapping of any methods, and allow
runtime loaded modules to be used.  It should also safely handle cases where
the same module is reloaded multiple times.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-140173" href="/Public/Bug/Display.html?id=14250#txn-140173">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;01&nbsp;14:20:23&nbsp;2005</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/140173/39625/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/39625">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">[DKUBB - Fri Aug 26 06:16:18 2005]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; One thing that might not have been clear from the patch is that I
&gt; reset
&gt; the %cumulative, %anticumulative and other hashes right after the
&gt; subs are wrapped the first time, thus making it impossible for a
&gt; double
&gt; wrapping.
</div>
Hmm, nope, missed that.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; wrapping process.  &#40;never seen anyone bless a subroutine that is later
&gt; installed in the symbol table, but I see no reason why this won&#39;t
&gt; work&#41;
</div>
Now THAT is an interesting idea that may have interesting uses --
bascially, attach meta-data to your subroutine :-&#41;  Feels like a hack
though.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hmm, I wonder if maybe a better approach might be to explicitly
&gt; execute
&gt; a method within the Class::Std derived class after all its methods are
&gt; properly named and installed in the symbol table, sort of like this:
</div>
I was starting to think that might be the case.  It makes the usage a
bit more hokey, though.  It&#39;s explicitly doing what CHECK was meant &#40;but
fails&#41; to do.  On the other hand, it would give you a chance to install
anonymous subs with Class::Std attributes into the symbol table as well,
which might be useful.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-591035" href="/Public/Bug/Display.html?id=14250#txn-591035">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;14&nbsp;10:47:45&nbsp;2009</span>
    <span class="description">jloverso [...] mathworks.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/591035/299294/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/299294">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 71b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Daniel,

Are you looking at addressing this?  It still applies to v0.9.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-591036" href="/Public/Bug/Display.html?id=14250#txn-591036">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;14&nbsp;10:47:46&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-591056" href="/Public/Bug/Display.html?id=14250#txn-591056">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;14&nbsp;10:57:50&nbsp;2009</span>
    <span class="description">webmaster [...] simplemood.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #14250] No Class::Std behaviours for runtime loaded classes </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 14 Apr 2009 09:57:32 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Class-Std [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dan Muey &lt;webmaster [...] simplemood.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/591056/299305/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/299305">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 310b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yes, as time allows, any input to help expedite things is greatly  
appreciated!

On Apr 14, 2009, at 9:47 AM, John LoVerso via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: Class-Std
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=14250">https://rt.cpan.org/Ticket/Display.html?id=14250</a></span> &gt;
&gt;
&gt; Daniel,
&gt;
&gt; Are you looking at addressing this?  It still applies to v0.9.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-591062" href="/Public/Bug/Display.html?id=14250#txn-591062">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;14&nbsp;11:46:18&nbsp;2009</span>
    <span class="description">jloverso [...] mathworks.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> CUMULATIVE fails for classes compiled at separate times</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> dmuey [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/591062/299313/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/299313">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 929b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Attached is a tar file that includes two of Luke&#39;s tests from his patch
above:  t/runtime_access.t t/runtime_cumulative.t

These tests work in 0.7, 0.8, and 0.9.

The remaining bug &#40;that we just tripped over today&#41; is that CUMULATIVE
fails when a runtime-compiled class derives from a class that was
compiled earlier.

I added some additional tests that show this problem.  That are all
variants of runtime_cumulative.t &#40;which is just a copy of cumulative.t
with the classes &#39;eval&#39;d&#41;.

runtime_cumulative2.t compiles some classes when the module is initially
loaded, and the rest are eval&#39;d &#40;like in runtime_cumulative.t&#41; - and
this is by just moving the &#39;eval&#39; down a few lines.  This fails.

runtime_cumulative3.t doesn&#39;t include the classes inline, but instead
loads them with &#39;use&#39;.  It works.

runtime_cumulative3_require.t is the same except that some of the
derived classes are loaded at runtime with &#39;require&#39;.  It fails.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/591062/299316/t_runtime.tgz">Download t_runtime.tgz</a><br />
<span class="downloadcontenttype">application/x-compressed 1.8k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-591084" href="/Public/Bug/Display.html?id=14250#txn-591084">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;14&nbsp;12:27:15&nbsp;2009</span>
    <span class="description">jloverso [...] mathworks.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: CUMULATIVE fails for classes compiled at separate times</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/591084/299328/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/299328">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 214b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve attached an updated version of Luke&#39;s patch so that it applies to
and works with 0.9 &#40;it should also apply to 0.8&#41;.  I adapted it to fit
within the framework of how Damian originally fixed most of this in 0.7.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/591084/299331/Class-Std%2Bruntime.tgz">Download Class-Std+runtime.tgz</a><br />
<span class="downloadcontenttype">application/x-compressed 25.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.685779</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
