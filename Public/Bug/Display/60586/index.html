<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #60586 for Collision-2D: Implement polygon collisions using Math::Clipper</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #60586 for Collision-2D: Implement polygon collisions using Math::Clipper</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Collision-2D">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Collision-2D">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Collision-2D">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Collision-2D">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Collision-2D">Collision-2D CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">60586</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Collision-2D">Collision-2D</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
smueller [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-231934-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-231935-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=60586">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-820463" href="/Public/Bug/Display.html?id=60586#txn-820463">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;06:03:39&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Implement polygon collisions using Math::Clipper</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/820463/425113/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/425113">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 826b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

out of idle curiosity, I wrapped a simple C++ library for polygon
clipping &#40;i.e. polygon intersections and thus collision detection&#41; for
Perl yesterday. The result is on github &#40;in account my &#34;tsee&#34;&#41; and on
CPAN as Math::Clipper.

Right now, Math::Clipper takes its arguments as nested array references
&#40;see docs&#41;, but ideally, Collision::2D would be able to pass polygons as
opaque and efficient C/XS objects. I&#39;m all open for adding an interface
to Math::Clipper to do this, but I&#39;m afraid there&#39;d be a circular
dependency between the two modules. Ideas and patches welcome.

Also, I haven&#39;t thought about how polygon-circle intersections &#40;or
collisions&#41; could be efficiently implemented. If the circle is small vs.
the polygon, checking all the polygon points is not enough for concave
polygons.

Best regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-820727" href="/Public/Bug/Display.html?id=60586#txn-820727">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;23:19:09&nbsp;2010</span>
    <span class="description">zpmorgan [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/820727/425240/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/425240">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 873b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, Steffen. Nice portfolio :&#41;

Anyways, perhaps the words we use are ambiguous. In the Collision::2D
docs, &#39;intersection&#39; is synonymous with &#39;static collision&#39;, where
&#39;collision&#39; mostly means &#39;continuous collision&#39; or &#39;dynamic collision&#39;,
where there is an additional time dimension. Unless Math::Clipper can
somehow clip polyhedrons, I have a hard time seeing how it can detect
continuous collisions. I do appreciate the offer, though.

I don&#39;t think circle-polygon static collisions are that difficult. Try
drawing a ray from the center of the circle to infinity. If the number
of edges that it hits is odd, the center of the circle is inside the
poly. If the circle is outside, then check if any edges intersect with
the circle, and check if some corner is in the circle. Dynamic
collisions would not be any more complicated, if/when there is a
line-segment type.

Zach
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-820729" href="/Public/Bug/Display.html?id=60586#txn-820729">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;23:19:10&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-820730" href="/Public/Bug/Display.html?id=60586#txn-820730">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;23:22:17&nbsp;2010</span>
    <span class="description">zpmorgan [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-820798" href="/Public/Bug/Display.html?id=60586#txn-820798">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;22&nbsp;05:33:17&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/820798/425272/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/425272">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Zach,

thanks for your quick response. Your suggestion about circle-polynomial
collisions makes perfect sense.

Unfortunately, the note about intersections vs. collisions seems quite
valid as well. The one thing I probably don&#39;t understand sufficiently is
the &#34;interval&#34; parameter of the dynamic collision detection. It&#39;s not
very clearly documented and I had interpreted it as a time step for
iterating dynamic collisions. Without looking at the implementation, I
assumed that it did something like

while &#40;!intersection&#40;@obj&#41;&#41; {time += step; kinematics&#40;@obj&#41;}

with an appropriate stop condition.

Maybe you could add an explanation of the interval parameter to the
docs? Or did I just miss it? Reading the ::Collision docs, it refers to
the exact time of collision, so it can&#39;t be doing just what I wrote above.

Thanks for your patience!

Best regards,
Steffen

PS: If I wrote an XSUB constructor that can handle named arguments,
would you be open for converting the pure_perl_new&#40;%hash&#41; =&gt;
_xsub_new&#40;@list&#41; double-call to a single XS constructor? It seems an
easy performance win for cases with lots of objects. But maybe I should
fire up a profiler before I do premature optimization...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-820800" href="/Public/Bug/Display.html?id=60586#txn-820800">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;22&nbsp;05:33:18&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-820801" href="/Public/Bug/Display.html?id=60586#txn-820801">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;22&nbsp;05:33:18&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823995" href="/Public/Bug/Display.html?id=60586#txn-823995">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;29&nbsp;04:00:53&nbsp;2010</span>
    <span class="description">zpmorgan [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60586] Implement polygon collisions using Math::Clipper</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 29 Aug 2010 04:00:41 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Collision-2D [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Zach Morgan &lt;zpmorgan [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/823995/426899/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/426899">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m sorry Steffen, I somehow missed this message earlier.

It seems that you have the wrong idea about continuous collision
detection. It is much more precise than a series of static collision
tests. For example, if you fling a particle at a wall, and you know
its precise velocity &#38; location at t=0, then it is trivial to
determine when it will collide with the wall. If this is implemented
using a bunch of static tests, it will be slower than necessary, and
you wouldn&#39;t know the precise moment of collision.  &#39;interval&#39; is the
maximum time component that you&#39;re interested in.

If you&#39;d like explanations for how I handled the various types of
collisions, I&#39;d be happy to explain it. I mostly just worked it out
with basic geometrical equations.

Also, about the constructor, wouldn&#39;t an xsub constructor with named
arguments still use a hash? Do you think it would boost performance
much? I think that converting some of the point collision routines
would be a much bigger gain. &#40;some collision tests are broken down
into multiple point collision tests&#41;

Thanks,
Zach

On 8/22/10, Steffen Mueller via RT &lt;bug-Collision-2D@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Collision-2D
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60586">https://rt.cpan.org/Ticket/Display.html?id=60586</a></span> &gt;
&gt;
&gt; Hi Zach,
&gt;
&gt; thanks for your quick response. Your suggestion about circle-polynomial
&gt; collisions makes perfect sense.
&gt;
&gt; Unfortunately, the note about intersections vs. collisions seems quite
&gt; valid as well. The one thing I probably don&#39;t understand sufficiently is
&gt; the &#34;interval&#34; parameter of the dynamic collision detection. It&#39;s not
&gt; very clearly documented and I had interpreted it as a time step for
&gt; iterating dynamic collisions. Without looking at the implementation, I
&gt; assumed that it did something like
&gt;
&gt; while &#40;!intersection&#40;@obj&#41;&#41; {time += step; kinematics&#40;@obj&#41;}
&gt;
&gt; with an appropriate stop condition.
&gt;
&gt; Maybe you could add an explanation of the interval parameter to the
&gt; docs? Or did I just miss it? Reading the ::Collision docs, it refers to
&gt; the exact time of collision, so it can&#39;t be doing just what I wrote above.
&gt;
&gt; Thanks for your patience!
&gt;
&gt; Best regards,
&gt; Steffen
&gt;
&gt; PS: If I wrote an XSUB constructor that can handle named arguments,
&gt; would you be open for converting the pure_perl_new&#40;%hash&#41; =&gt;
&gt; _xsub_new&#40;@list&#41; double-call to a single XS constructor? It seems an
&gt; easy performance win for cases with lots of objects. But maybe I should
&gt; fire up a profiler before I do premature optimization...
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823998" href="/Public/Bug/Display.html?id=60586#txn-823998">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;29&nbsp;04:00:55&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824017" href="/Public/Bug/Display.html?id=60586#txn-824017">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;29&nbsp;08:20:28&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> zpmorgan [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824017/426914/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/426914">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Zach,

On Sun Aug 29 04:00:53 2010, zpmorgan@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m sorry Steffen, I somehow missed this message earlier.
</div>
No worries.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It seems that you have the wrong idea about continuous collision
&gt; detection.
</div>
Indeed, I originally had the wrong idea.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you&#39;d like explanations for how I handled the various types of
&gt; collisions, I&#39;d be happy to explain it. I mostly just worked it out
&gt; with basic geometrical equations.
</div>
That&#39;s fine. I think I could do the math, too. And I always have the
code to look at.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, about the constructor, wouldn&#39;t an xsub constructor with named
&gt; arguments still use a hash? Do you think it would boost performance
&gt; much? I think that converting some of the point collision routines
&gt; would be a much bigger gain. &#40;some collision tests are broken down
&gt; into multiple point collision tests&#41;
</div>
Hmm. The constructor could still use a hash. Or it could walk the
arguments doign flip/flop with the expected key/value pairs. The big win
would be eliminating the extra entersub call of the Perl function
wrapper. Furthermore, calling XSUBs is faster than ordinary subs, so you
win some more. Below is the code &#40;from Class::XSAccessor&#41; that
implements a plain dumb constructor a la &#34;return bless {@_}=&gt;$class&#34; for
a Perl-hash based object. You&#39;d want to either create a hash &#40;without
blessing it&#41; and then hv_fetch from there to get the values for the C
object or, as I wrote above, just walk the argument list doing strEQ in
an if or even using a static hash map/switch for the keyname =&gt; struct
member conversion.

Naturally, these constructors could be generated from a list of valid
keys and struct member names using macros.

void
constructor&#40;class, ...&#41;
    SV* class;
  PREINIT:
    int iStack;
    HV* hash;
    SV* obj;
    const char* classname;
  PPCODE:
    if &#40;sv_isobject&#40;class&#41;&#41; {
      classname = sv_reftype&#40;SvRV&#40;class&#41;, 1&#41;;
    }
    else {
      if &#40;!SvPOK&#40;class&#41;&#41;
        croak&#40;&#34;Need an object or class name as first argument to the
constructor.&#34;&#41;;
      classname = SvPV_nolen&#40;class&#41;;
    }
    
    hash = &#40;HV *&#41;sv_2mortal&#40;&#40;SV *&#41;newHV&#40;&#41;&#41;;
    obj = sv_bless&#40; newRV_inc&#40;&#40;SV*&#41;hash&#41;, gv_stashpv&#40;classname, 1&#41; &#41;;

    if &#40;items &gt; 1&#41; {
      if &#40;!&#40;items % 2&#41;&#41;
        croak&#40;&#34;Uneven number of arguments to constructor.&#34;&#41;;

      for &#40;iStack = 1; iStack &lt; items; iStack += 2&#41; {
        HE *he;
        he = hv_store_ent&#40;hash, ST&#40;iStack&#41;, newSVsv&#40;ST&#40;iStack+1&#41;&#41;, 0&#41;;
        if &#40;!he&#41; {
          croak&#40;&#34;Failed to write value to hash.&#34;&#41;;
        }
      }
    }
    PUSHs&#40;sv_2mortal&#40;obj&#41;&#41;;


Back to the original topic. I believe I figured out an algorithm that&#39;ll
detect polygon-polygon collision &#40;yes, the dynamic type&#41;. I haven&#39;t
really done the math with pencil and paper, but it should be around
O&#40;n*m&#41; where n/m are the number of vertexes in the two polygons that are
involved.

First, we boost the scene so that one of the polygons is at rest
&#40;O&#40;n+m&#41;&#41;. To determine whether the polygons will collide at all, we
orthogonally project the vertexes of both polygons on the line that is
orthogonal to the direction of movement of the moving polygon &#40;O&#40;n+m&#41;
again&#41;. For each polygon, we find the outermost points on the line.
Then, if the two line segments intersect, the polygons will collide
&#40;unless the direction of movement is going away from the second
polygon&#41;. So this should be O&#40;n&#41; overall.

Then, do get the actual collision, we use that one of the polygons isn&#39;t
moving. The collision must happen between one of the vertexes of either
of the polygons with an edge of the respective other polygon. So we use
the line trajectory of each vertex in the moving polygon and calculate
the intersection point with each edge &#40;or the line it&#39;s in&#41; of the
static polygon. We verify that the point is within the edge. If so, we
get the collision time. Repeat with switched roles. Then we calculate
the minimum of the collision times. This part should be O&#40;n*m&#41;.

Of course, the difficult bit is always handling all the edge cases such
as head-on vertex-vertex collision.

It doesn&#39;t seem like I&#39;ll get the time to implement this any time soon,
but I thought I&#39;d put this out there regardless.

Cheers,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824020" href="/Public/Bug/Display.html?id=60586#txn-824020">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;29&nbsp;08:23:13&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> zpmorgan [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824020/426917/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/426917">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 126b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Arg. The code was mangled. The original is here:

<span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/SMUELLER/Class-XSAccessor-1.07_02/XS/Hash.xs">http://cpansearch.perl.org/src/SMUELLER/Class-XSAccessor-1.07_02/XS/Hash.xs</a></span>
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.512772</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
