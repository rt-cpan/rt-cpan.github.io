<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #102794 for Spreadsheet-Read: Cannot process Google Drive .xlsx files</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #102794 for Spreadsheet-Read: Cannot process Google Drive .xlsx files</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-Read">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-Read">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-Read">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-Read">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-Read">Spreadsheet-Read CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">102794</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-Read">Spreadsheet-Read</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
projs+perl [...] niss.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-29470-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.58    </td>
  </tr>
  <tr id="CF-29471-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




bug_demo.xlsx<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1473894/784905/bug_demo.xlsx">
Sun Mar 15 21:25:02 2015 (3.5k) by projs+perl [...] niss.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=102794">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1473894" href="/Public/Bug/Display.html?id=102794#txn-1473894">#</a>      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;15&nbsp;21:25:02&nbsp;2015</span>
    <span class="description">projs+perl [...] niss.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Cannot process Google Drive .xlsx files</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1473894/784904/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/784904">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">A few months ago, automated downloads of Google spreadsheets no longer included the ODS format. While XLSX format is available, the structure of that file format from Google cause problems with Spreadsheet::Read; or at least problems with the underlying parsers.

While the module has not yet been released, a fix to work with the new structure was made to Spreadsheet::ParseXLSX a couple of days ago.  &#40;Check <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/doy/spreadsheet-parsexlsx/issues/29&#41;">https://github.com/doy/spreadsheet-parsexlsx/issues/29&#41;</a></span>.  Without the fix, the error message with the attached sample document was

        Can&#39;t call method &#34;first_child&#34; on an undefined value at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm line 455.

    453             styles =&gt; [
    454                 map {
    455                     $border{$border-&gt;first_child&#40;$_&#41;-&gt;att&#40;&#39;style&#39;&#41; || &#39;none&#39;}
    456                 } qw&#40;left right top bottom&#41;
    457             ],

I did not delve too deeply into the issue, but it seems like the order of expected XML elements changed.  When I installed that unreleased ParseXLSX.pm directly, the problem shifted to Spreadsheet::XLSX.

Spreadsheet::XLSX also has a problem with google&#39;s interpretation of the XLSX structure.  Its warning message, which is symptomatic of a deeper problem, is

        Use of uninitialized value in concatenation &#40;.&#41; or string at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/XLSX.pm line 150.

    148         foreach my $sheet &#40;@Worksheet&#41; {
    149
    150                 my $member_sheet = $self -&gt; {zip} -&gt; memberNamed &#40;&#34;xl/$sheet-&gt;{path}&#34;&#41; or next;
    151

The problem is $sheet-&gt;{path} is undefined instead matching the corresponding XML file in the xl/worksheets/ directory of the unzipped spreadsheet.

Unfortunately, Spreadsheet::XLSX has not been updated in five years and has quite a backlog of issues.  &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Dist/Display.html?Name=Spreadsheet-XLSX&#41;">https://rt.cpan.org/Public/Dist/Display.html?Name=Spreadsheet-XLSX&#41;</a></span> Rather than wait for a fix in that module, I tried, and failed, to modify the source so Spreadsheet::Read skip it and use ParseXLSX instead.

Is there some way to deprecate the use of Spreadsheet::XLSX in favor of a current, and functional, alternative?

Environment:

        Spreadsheet::XLSX       version 0.13
        Spreadsheet::ParseXLSX  version 0.16
        Spreadsheet::ParseExcel version 0.65
        Spreadsheet::Read       version 0.58

        perl v5.20.1 for darwin &#40;aka OS X&#41;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> bug_demo.xlsx</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1473894/784905/bug_demo.xlsx">Download bug_demo.xlsx</a><br />
<span class="downloadcontenttype">application/vnd.openxmlformats-officedocument.spreadsheetml.sheet 3.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1473951" href="/Public/Bug/Display.html?id=102794#txn-1473951">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;04:47:26&nbsp;2015</span>
    <span class="description">h.m.brand [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #102794] Cannot process Google Drive .xlsx files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 16 Mar 2015 09:46:59 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-Read [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1473951/784946/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/784946">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, 15 Mar 2015 21:25:03 -0400, &#34;Scott Bolte via RT&#34;
&lt;bug-Spreadsheet-Read@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; A few months ago, automated downloads of Google spreadsheets no longer
&gt; included the ODS format. While XLSX format is available, the structure
&gt; of that file format from Google cause problems with Spreadsheet::Read;
&gt; or at least problems with the underlying parsers.
&gt; 
&gt; While the module has not yet been released, a fix to work with the new
&gt; structure was made to Spreadsheet::ParseXLSX a couple of days ago.
&gt; &#40;Check <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/doy/spreadsheet-parsexlsx/issues/29&#41;">https://github.com/doy/spreadsheet-parsexlsx/issues/29&#41;</a></span>.
&gt; Without the fix, the error message with the attached sample document
&gt; was
&gt; 
&gt;  Can&#39;t call method &#34;first_child&#34; on an undefined value at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm line 455.
&gt; 
&gt;   453     styles =&gt; [
&gt;   454         map {
&gt;   455             $border{$border-&gt;first_child &#40;$_&#41;-&gt;att &#40;&#39;style&#39;&#41; || &#39;none&#39;}
&gt;   456             } qw&#40;left right top bottom&#41;
&gt;   457         ],
&gt; 
&gt; I did not delve too deeply into the issue, but it seems like the order
&gt; of expected XML elements changed.  When I installed that unreleased
&gt; ParseXLSX.pm directly, the problem shifted to Spreadsheet::XLSX.
&gt; 
&gt; Spreadsheet::XLSX also has a problem with google&#39;s interpretation of the
&gt; XLSX structure.  Its warning message, which is symptomatic of a deeper
&gt; problem, is
</div>
Spreadsheet::XLSX is something that ought to be deprecated now that we
have Spreadsheet::ParseXLSX. It is buggy and not maintained. Whatever
problem is found in Spreadsheet::XLSX, be sure that it will not be fixed

Don&#39;t waste your time in it

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Use of uninitialized value in concatenation &#40;.&#41; or string at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/XLSX.pm line 150.
&gt; 
&gt;   148     foreach my $sheet &#40;@Worksheet&#41; {
&gt;   149
&gt;   150         my $member_sheet = $self-&gt;{zip}-&gt;memberNamed &#40;&#34;xl/$sheet-&gt;{path}&#34;&#41; or next;
&gt;   151
&gt; 
&gt; The problem is $sheet-&gt;{path} is undefined instead matching the
&gt; corresponding XML file in the xl/worksheets/ directory of the unzipped
&gt; spreadsheet.
&gt; 
&gt; Unfortunately, Spreadsheet::XLSX has not been updated in five years and
&gt; has quite a backlog of issues.
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Dist/Display.html?Name=Spreadsheet-XLSX&#41;">https://rt.cpan.org/Public/Dist/Display.html?Name=Spreadsheet-XLSX&#41;</a></span>
</div>
The author has abandoned the module to to a lack of interest in perl
itself. He wrote the module when he needed to parse XLSX and there was
no alternative available. It parses XML with regular expressions. That
should say enough.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Rather than wait for a fix in that module, I tried, and failed, to
&gt; modify the source so Spreadsheet::Read skip it and use ParseXLSX
&gt; instead.
</div>
ParseXLSX is already preferred over XLSX when installed since version
0.53 &#40;29 Jan 2014&#41;.

To disable Spreadsheet::XLSX completely:
--8&lt;---
--- Read.pm     2015-03-15 09:32:30.738033028 +0100
+++ Read.pm     2015-03-16 09:45:50.414152843 +0100
@@ -45,7 +45,6 @@ my @parsers = &#40;
     [ sxc  =&gt; &#34;Spreadsheet::ReadSXC&#34;,      &#34;0.20&#34;  ],
     [ xls  =&gt; &#34;Spreadsheet::ParseExcel&#34;,   &#34;0.34&#34;  ],
     [ xlsx =&gt; &#34;Spreadsheet::ParseXLSX&#34;,    &#34;0.13&#34;  ],
-    [ xlsx =&gt; &#34;Spreadsheet::XLSX&#34;,         &#34;0.13&#34;  ],
     [ prl  =&gt; &#34;Spreadsheet::Perl&#34;,         &#34;&#34;      ],

     # Helper modules
--&gt;8---

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is there some way to deprecate the use of Spreadsheet::XLSX in favor of a current, and functional, alternative?
&gt; 
&gt; Environment:
&gt; 
&gt;       Spreadsheet::XLSX       version 0.13
&gt;       Spreadsheet::ParseXLSX  version 0.16
&gt;       Spreadsheet::ParseExcel version 0.65
&gt;       Spreadsheet::Read       version 0.58
&gt; 
&gt;       perl v5.20.1 for darwin &#40;aka OS X&#41;
</div>

-- 
H.Merijn Brand  <span class="clickylink"><a target="new" rel="nofollow" href="http://tux.nl">http://tux.nl</a></span>   Perl Monger  <span class="clickylink"><a target="new" rel="nofollow" href="http://amsterdam.pm.org/">http://amsterdam.pm.org/</a></span>
using perl5.00307 .. 5.21   porting perl5 on HP-UX, AIX, and openSUSE
<span class="clickylink"><a target="new" rel="nofollow" href="http://mirrors.develooper.com/hpux/">http://mirrors.develooper.com/hpux/</a></span>        <span class="clickylink"><a target="new" rel="nofollow" href="http://www.test-smoke.org/">http://www.test-smoke.org/</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://qa.perl.org">http://qa.perl.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.goldmark.org/jeff/stupid-disclaimers/">http://www.goldmark.org/jeff/stupid-disclaimers/</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1473951/784947/">Download &#40;untitled&#41;</a><br />
<span class="downloadcontenttype">application/pgp-signature 490b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1473952" href="/Public/Bug/Display.html?id=102794#txn-1473952">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;04:47:26&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1473955" href="/Public/Bug/Display.html?id=102794#txn-1473955">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;04:59:16&nbsp;2015</span>
    <span class="description">HMBRAND [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1473955/784950/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/784950">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 429b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">As Spreadsheet::Read is just a wrapper module, this ticket - however useful and well-worded - is not about a bug in Spreadsheet::Read. This module cannot solve this particular problem for the parser below.

Sometimes Spreadsheet::Read is able to find workarounds, but that is not the case here, so I can do nothing about it.

Sorry to reject this ticket as is.

BTW, I&#39;d advice you to just uninstall Spreadsheet::XLSX completely.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1473957" href="/Public/Bug/Display.html?id=102794#txn-1473957">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;04:59:22&nbsp;2015</span>
    <span class="description">HMBRAND [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1473993" href="/Public/Bug/Display.html?id=102794#txn-1473993">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;08:21:22&nbsp;2015</span>
    <span class="description">projs+perl [...] niss.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1473993/784976/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/784976">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I should have provided details on when I tried, and failed, to avoid using Spreadsheet::XLSX. I both commented it out in Spreadsheet/Read.pm and renamed Spreadsheet/XLSX.pm to hide it. In both cases, attempts to use Spreadsheet::Read subsequently failed.



   host% perl -MCarp=verbose ./parse_sheets.pl
   Parser for XLSX is not installed at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/Read.pm line 415.
        Spreadsheet::Read::ReadData&#40;&#34;/Users/scott/Downloads/bug_demo.xlsx&#34;, &#34;strip&#34;, 3, &#34;dtfmt&#34;, &#34;yyyy-mm-dd&#34;, &#34;parser&#34;, &#34;xlsx&#34;, &#34;debug&#34;, undef, ...&#41; called at ./parse_sheets.pl line 158


On Mon Mar 16 04:59:16 2015, HMBRAND wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As Spreadsheet::Read is just a wrapper module, this ticket - however
&gt; useful and well-worded - is not about a bug in Spreadsheet::Read. This
&gt; module cannot solve this particular problem for the parser below.
&gt; 
&gt; Sometimes Spreadsheet::Read is able to find workarounds, but that is
&gt; not the case here, so I can do nothing about it.
&gt; 
&gt; Sorry to reject this ticket as is.
&gt; 
&gt; BTW, I&#39;d advice you to just uninstall Spreadsheet::XLSX completely.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1474003" href="/Public/Bug/Display.html?id=102794#txn-1474003">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;08:41:25&nbsp;2015</span>
    <span class="description">h.m.brand [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #102794] Cannot process Google Drive .xlsx files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 16 Mar 2015 13:41:08 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-Read [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474003/784985/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/784985">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 16 Mar 2015 08:21:22 -0400, &#34;Scott Bolte via RT&#34;
&lt;bug-Spreadsheet-Read@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I should have provided details on when I tried, and failed, to avoid
&gt; using Spreadsheet::XLSX. I both commented it out in Spreadsheet/Read.pm
&gt; and renamed Spreadsheet/XLSX.pm to hide it. In both cases, attempts to
&gt; use Spreadsheet::Read subsequently failed.
</div>
As long as it is not able to load/use any of the preferred modules,
it&#39;ll try the next supported version. The first one tried is the one I
prefer. It should be obvious that Spreadsheet::Read is unable to load
Spreadsheet::ParseXLSX

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    host% perl -MCarp=verbose ./parse_sheets.pl
&gt;    Parser for XLSX is not installed at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/Read.pm line 415.
&gt;       Spreadsheet::Read::ReadData&#40;&#34;/Users/scott/Downloads/bug_demo.xlsx&#34;, &#34;strip&#34;, 3, &#34;dtfmt&#34;, &#34;yyyy-mm-dd&#34;, &#34;parser&#34;, &#34;xlsx&#34;, &#34;debug&#34;, undef, ...&#41; called at ./parse_sheets.pl line 158
</div>
In which case it was unable to load Spreadsheet::ParseXLSX
I think that message is pretty clear. I can change it to
&#34;Spreadsheet::Read is unable to load any of the supported XLSX parsers&#34;
but I don&#39;t think that adds real value.

Does your module load and show the version?

$ perl -MSpreadsheet::ParseXLSX -wE&#39;say $Spreadsheet::ParseXLSX::VERSION&#39;
0.16

-- 
H.Merijn Brand  <span class="clickylink"><a target="new" rel="nofollow" href="http://tux.nl">http://tux.nl</a></span>   Perl Monger  <span class="clickylink"><a target="new" rel="nofollow" href="http://amsterdam.pm.org/">http://amsterdam.pm.org/</a></span>
using perl5.00307 .. 5.21   porting perl5 on HP-UX, AIX, and openSUSE
<span class="clickylink"><a target="new" rel="nofollow" href="http://mirrors.develooper.com/hpux/">http://mirrors.develooper.com/hpux/</a></span>        <span class="clickylink"><a target="new" rel="nofollow" href="http://www.test-smoke.org/">http://www.test-smoke.org/</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://qa.perl.org">http://qa.perl.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.goldmark.org/jeff/stupid-disclaimers/">http://www.goldmark.org/jeff/stupid-disclaimers/</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474003/784986/">Download &#40;untitled&#41;</a><br />
<span class="downloadcontenttype">application/pgp-signature 490b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1474282" href="/Public/Bug/Display.html?id=102794#txn-1474282">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;18:37:10&nbsp;2015</span>
    <span class="description">projs+perl [...] niss.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474282/785142/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/785142">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I do have Spreadsheet::ParseXLSX installed, both the stock 0.16 version and the pending replacement that works with the Google XLSX files. While the problem changes, there is a problem with both.

First, here is the stripped down test case:

    host% cat parse_demo.pl
    #!/usr/bin/env perl

    use strict;
    use warnings;
    use Spreadsheet::Read;

    for my $module &#40; sort keys %INC &#41; {
        if &#40; $module =~ m/spreadsheet/i &#41; {
            printf qq{%-40s -&gt; %s\n}, $module, $INC{$module};
        }
    }

    ReadData&#40;q{bug_demo.xlsx}&#41;;
    exit;

    host% perl -MSpreadsheet::ParseXLSX -wE&#39;say $Spreadsheet::ParseXLSX::VERSION&#39;
    0.16

    host% perl -MCarp=verbose parse_demo.pl
    Spreadsheet/ParseExcel.pm                -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel.pm
    Spreadsheet/ParseExcel/Cell.pm           -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Cell.pm
    Spreadsheet/ParseExcel/FmtDefault.pm     -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/FmtDefault.pm
    Spreadsheet/ParseExcel/Font.pm           -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Font.pm
    Spreadsheet/ParseExcel/Format.pm         -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Format.pm
    Spreadsheet/ParseExcel/Utility.pm        -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Utility.pm
    Spreadsheet/ParseExcel/Workbook.pm       -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Workbook.pm
    Spreadsheet/ParseExcel/Worksheet.pm      -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Worksheet.pm
    Spreadsheet/ParseXLSX.pm                 -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm
    Spreadsheet/Read.pm                      -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/Read.pm
    Spreadsheet/ReadSXC.pm                   -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ReadSXC.pm
    Can&#39;t call method &#34;first_child&#34; on an undefined value at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm line 455.

That demonstrates the XML element ordering issue that crops up with Google&#39;s interpretation of XLSX doc format.

Now I replace the stock version with the not yet released version from <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/doy/spreadsheet-parsexlsx/tree/master/lib/Spreadsheet">https://github.com/doy/spreadsheet-parsexlsx/tree/master/lib/Spreadsheet</a></span>

    host% perldoc -l Spreadsheet::ParseXLSX
    /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm
    host% sudo mv -n /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm{,-0.16}

    host% curl --remote-name <span class="clickylink"><a target="new" rel="nofollow" href="https://raw.githubusercontent.com/doy/spreadsheet-parsexlsx/master/lib/Spreadsheet/ParseXLSX.pm">https://raw.githubusercontent.com/doy/spreadsheet-parsexlsx/master/lib/Spreadsheet/ParseXLSX.pm</a></span>
      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                     Dload  Upload   Total   Spent    Left  Speed
    100 30821  100 30821    0     0  97935      0 --:--:-- --:--:-- --:--:--  102k
    host% md5 ParseXLSX.pm
    MD5 &#40;ParseXLSX.pm&#41; = 4db04805888cb8f1a56295e201637bd7
    host% sudo cp -p ParseXLSX.pm /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm

    host% perl -MCarp=verbose parse_demo.pl
    Spreadsheet/ParseExcel.pm                -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel.pm
    Spreadsheet/ParseExcel/Cell.pm           -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Cell.pm
    Spreadsheet/ParseExcel/FmtDefault.pm     -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/FmtDefault.pm
    Spreadsheet/ParseExcel/Font.pm           -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Font.pm
    Spreadsheet/ParseExcel/Format.pm         -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Format.pm
    Spreadsheet/ParseExcel/Utility.pm        -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Utility.pm
    Spreadsheet/ParseExcel/Workbook.pm       -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Workbook.pm
    Spreadsheet/ParseExcel/Worksheet.pm      -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Worksheet.pm
    Spreadsheet/ParseXLSX.pm                 -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm
    Spreadsheet/Read.pm                      -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/Read.pm
    Spreadsheet/ReadSXC.pm                   -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ReadSXC.pm
    Parser for XLSX is not installed at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/Read.pm line 415.
        Spreadsheet::Read::ReadData&#40;&#34;bug_demo.xlsx&#34;&#41; called at parse_demo.pl line 13

So even though Spreadsheet::ParseXLSX is successfully loaded according to %INC, Spreadsheet::Read thinks otherwise. I&#39;m not sure why.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1474295" href="/Public/Bug/Display.html?id=102794#txn-1474295">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;19:24:49&nbsp;2015</span>
    <span class="description">h.m.brand [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #102794] Cannot process Google Drive .xlsx files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 17 Mar 2015 00:24:28 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-Read [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474295/785146/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/785146">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 16 Mar 2015 18:37:10 -0400, &#34;Scott Bolte via RT&#34;
&lt;bug-Spreadsheet-Read@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Spreadsheet-Read
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=102794">https://rt.cpan.org/Ticket/Display.html?id=102794</a></span> &gt;
&gt; 
&gt; I do have Spreadsheet::ParseXLSX installed, both the stock 0.16 version and the pending replacement that works with the Google XLSX files. While the problem changes, there is a problem with both.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     host% perl -MCarp=verbose parse_demo.pl
&gt;     Spreadsheet/ParseExcel.pm                -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel.pm
&gt;     Spreadsheet/ParseExcel/Cell.pm           -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Cell.pm
&gt;     Spreadsheet/ParseExcel/FmtDefault.pm     -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/FmtDefault.pm
&gt;     Spreadsheet/ParseExcel/Font.pm           -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Font.pm
&gt;     Spreadsheet/ParseExcel/Format.pm         -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Format.pm
&gt;     Spreadsheet/ParseExcel/Utility.pm        -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Utility.pm
&gt;     Spreadsheet/ParseExcel/Workbook.pm       -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Workbook.pm
&gt;     Spreadsheet/ParseExcel/Worksheet.pm      -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseExcel/Worksheet.pm
&gt;     Spreadsheet/ParseXLSX.pm                 -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ParseXLSX.pm
&gt;     Spreadsheet/Read.pm                      -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/Read.pm
&gt;     Spreadsheet/ReadSXC.pm                   -&gt; /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/ReadSXC.pm
&gt;     Parser for XLSX is not installed at /opt/local/lib/perl5/site_perl/5.20/Spreadsheet/Read.pm line 415.
&gt;       Spreadsheet::Read::ReadData&#40;&#34;bug_demo.xlsx&#34;&#41; called at parse_demo.pl line 13
&gt; 
&gt; So even though Spreadsheet::ParseXLSX is successfully loaded according to %INC, Spreadsheet::Read thinks otherwise. I&#39;m not sure why.
</div>
Can I get the failing xlsx?

-- 
H.Merijn Brand  <span class="clickylink"><a target="new" rel="nofollow" href="http://tux.nl">http://tux.nl</a></span>   Perl Monger  <span class="clickylink"><a target="new" rel="nofollow" href="http://amsterdam.pm.org/">http://amsterdam.pm.org/</a></span>
using perl5.00307 .. 5.21   porting perl5 on HP-UX, AIX, and openSUSE
<span class="clickylink"><a target="new" rel="nofollow" href="http://mirrors.develooper.com/hpux/">http://mirrors.develooper.com/hpux/</a></span>        <span class="clickylink"><a target="new" rel="nofollow" href="http://www.test-smoke.org/">http://www.test-smoke.org/</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://qa.perl.org">http://qa.perl.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.goldmark.org/jeff/stupid-disclaimers/">http://www.goldmark.org/jeff/stupid-disclaimers/</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474295/785147/">Download &#40;untitled&#41;</a><br />
<span class="downloadcontenttype">application/pgp-signature 490b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1474300" href="/Public/Bug/Display.html?id=102794#txn-1474300">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;16&nbsp;20:24:46&nbsp;2015</span>
    <span class="description">projs+perl [...] niss.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474300/785154/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/785154">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 54b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The failing xlsx file was attached to my first report.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1474367" href="/Public/Bug/Display.html?id=102794#txn-1474367">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;17&nbsp;04:18:40&nbsp;2015</span>
    <span class="description">HMBRAND [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474367/785192/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/785192">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The reason Spreadsheet::Read cannot load Spreadsheet::ParseXLSX is because the git checkout does not return a VERSION

$ perl -MSpreadsheet::ParseXLSX -wE&#39;say Spreadsheet::ParseXLSX-&gt;VERSION&#39;
Use of uninitialized value in say at -e line 1.

Causing the minimal requirement to fail &#40;and then fallback to the next alternative&#41;

$ perl -MSpreadsheet::ParseXLSX -wE&#39;say Spreadsheet::ParseXLSX-&gt;VERSION&#40;&#34;0.13&#34;&#41;&#39;
Spreadsheet::ParseXLSX does not define $Spreadsheet::ParseXLSX::VERSION--version check failed at -e line 1.

If I manually add a Â«our $VERSION = &#34;0.16&#34;;Â» in ParseXLSX.pm, all goes as expected:

$ perl -Mblib examples/xlscat -v9 -i sandbox/rt102794.xlsx
ReadData &#40;sandbox/rt102794.xlsx, debug 0 clip 1&#41;;
[
    {   error            =&gt; undef,
        parser           =&gt; &#39;Spreadsheet::ParseXLSX&#39;,
        sheet            =&gt; {
            &#39;Mar \&#39;15&#39;       =&gt; 1
            },
        sheets           =&gt; 1,
        type             =&gt; &#39;xlsx&#39;,
        version          =&gt; &#39;0.16&#39;
        },
    {   A1               =&gt; &#39;Alpha&#39;,
        A2               =&gt; 10,
        B1               =&gt; &#39;Beta&#39;,
        B2               =&gt; 20,
        C1               =&gt; &#39;&#39;,
        attr             =&gt; [],
        cell             =&gt; [
            [],
            [   undef,
                &#39;Alpha&#39;,
                10
                ],
            [   undef,
                &#39;Beta&#39;,
                20
                ],
            [   undef,
                &#39;&#39;
                ]
            ],
        label            =&gt; &#39;Mar \&#39;15&#39;,
        maxcol           =&gt; 2,
        maxrow           =&gt; 2,
        merged           =&gt; []
        }
    ]
Opened sandbox/rt102794.xlsx with 1 sheets
Opening sheet 1 ...
{   A1               =&gt; &#39;Alpha&#39;,
    A2               =&gt; 10,
    B1               =&gt; &#39;Beta&#39;,
    B2               =&gt; 20,
    C1               =&gt; &#39;&#39;,
    attr             =&gt; [],
    cell             =&gt; [
        [],
        [   undef,
            &#39;Alpha&#39;,
            10
            ],
        [   undef,
            &#39;Beta&#39;,
            20
            ],
        [   undef,
            &#39;&#39;
            ]
        ],
    label            =&gt; &#39;Mar \&#39;15&#39;,
    maxcol           =&gt; 2,
    maxrow           =&gt; 2,
    merged           =&gt; []
    }
sandbox/rt102794.xlsx - 01: [ Mar &#39;15 ]   2 Cols,     2 Rows
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1474455" href="/Public/Bug/Display.html?id=102794#txn-1474455">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;17&nbsp;08:42:25&nbsp;2015</span>
    <span class="description">projs+perl [...] niss.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1474455/785248/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/785248">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 74b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sweet, sweet, sweet -- Thank you!

Sorry I did not figure that out myself.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.713367</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
