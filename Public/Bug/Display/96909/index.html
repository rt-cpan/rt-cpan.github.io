<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #96909 for Tk: Window events trigger &#39;focusout&#39; event in Entry widget</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #96909 for Tk: Window events trigger &#39;focusout&#39; event in Entry widget</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Tk/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Tk/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Tk/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Tk/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Tk">Tk CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">96909</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Tk/Active/">Tk</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
eeyles [...] graphic.plc.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-33610-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-33611-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;03&nbsp;04:37:39&nbsp;2014</span>
    <span class="description">eeyles [...] graphic.plc.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Window events trigger &#39;focusout&#39; event in Entry widget</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 03 Jul 2014 09:37:02 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ed Eyles &lt;eeyles [...] graphic.plc.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello

Certain events for a window appear to trigger the &#39;focusout&#39; event for 
an Entry widget that is installed in that window.  I do not believe this 
is sensible, because, as far as the user is concerned, the widget does 
not actually lose the focus in the course of these events.

So, if we have a Tk window containing an Entry widget which has a 
validation command for the &#39;focusout&#39; event, we can see that event get 
triggered when:
* The window is moved with the mouse &#40;but not when it is moved using the 
keyboard!&#41;.
* The window control menu is invoked &#40;i.e. the menu that is invoked by 
clicking the icon that is typically at the left-hand end of the title 
bar, or typically by pressing Alt-Space&#41;.
* The window is &#34;rolled up&#34;, so that only its title bar is visible.
* The window is minimised.
* The window itself loses focus.

A sample program to create a Tk window in which this behaviour can be 
reproduced is as follows.

#!/usr/bin/perl

use strict;
use warnings FATAL =&gt; &#39;all&#39;;
use diagnostics;

use Tk;

my $mw = MainWindow -&gt; new;
$mw -&gt; Entry
   &#40;-validate =&gt; &#39;focusout&#39;, -validatecommand =&gt; sub {print 
&#34;Validating...\n&#34;}&#41;
   -&gt; pack -&gt; focus;
MainLoop;


I suppose I can see a kind of logic in the current behaviour: in any of 
those window operations listed above, either the &#34;body&#34; of the window 
loses focus, or the window itself does.  However, I believe this defeats 
the purpose of the validation command, which is surely to enable a 
command to be run when the focus changes /within the window/.  If the 
user switches focus to a window decoration, to another window, or to the 
desktop, the focus is not changed in the context of their Tk 
application, and, indeed, when they return the focus to that 
application, the focus is still within the Entry widget.

I hope this makes some sense.

FYI I am using:
* CentOS 6.5 x86_64
* XFCE &#40;xfdesktop 4.8.2 release 2.el6 for x86_64&#41;
* Perl &#34;v5.10.1 &#40;*&#41; built for x86_64-linux-thread-multi&#34;
* Tk module 804.028503

Regards
Ed

Graphic PLC
Tel. +44 &#40;0&#41; 1363 774874
Fax. +44 &#40;0&#41; 1363 775753
Website: www.graphic.plc.uk

Before printing this email, please consider the environment.

This e-mail and any files transmitted with it are intended for the exclusive use of the addressee only and may be confidential. If you are not the intended recipient, you should not use the contents nor disclose them to any other person, and you are requested to notify the sender and delete the email.

Please note that design advice is given in good faith and without prejudice. Graphic cannot be held responsible for any product failure, or if systems do not perform as expected. Information given is for the use of the recipient only and others within their organisation; it should not be given to a third party without express authorisation from Graphic plc.

ITAR regulations stipulate that customers must inform their suppliers if their products are subject to ITAR regulations. If no mention of the ITAR regulations is made on the quote request or the order then Graphic PLC will assume that the ITAR regulations do not apply.

Internet communications are not secure, and Graphic PLC is not responsible for any changes made to the message after it was sent. Although steps have been taken to ensure that this email and any attachments are virus-free, Graphic plc cannot guarantee this, or accept liability for any damage sustained as a result of a virus. Recipients are advised to carry out their own virus checking, especially before opening an attachment.

Graphic PLC, registered in England no. 1036230.
Registered office: Graphic PLC, Down End, Lords Meadow Industrial Estate, Crediton, Devon, EX17 1HN, England.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;04&nbsp;03:44:58&nbsp;2014</span>
    <span class="description">eeyles [...] graphic.plc.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #96909]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 04 Jul 2014 08:44:20 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ed Eyles &lt;eeyles [...] graphic.plc.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[I apologise for the lengthy e-mail footer - I cannot control this.]

I have discovered a workaround for this issue: the validation command 
can check the value of &#40;in the example script&#41; $mw-&gt;focusCurrent.  If 
the value is &#39;undef&#39;, that indicates that the focus has left the body of 
the Tk window.  If the value is defined, the focus is still within the 
body of the Tk window.

This won&#39;t stop the validation command firing unnecessarily, but it can 
be used to stop it doing anything when it doesn&#39;t need to.

I feel this issue as reported is still a valid and significant one.

Ed

Graphic PLC
Tel. +44 &#40;0&#41; 1363 774874
Fax. +44 &#40;0&#41; 1363 775753
Website: www.graphic.plc.uk

Before printing this email, please consider the environment.

This e-mail and any files transmitted with it are intended for the exclusive use of the addressee only and may be confidential. If you are not the intended recipient, you should not use the contents nor disclose them to any other person, and you are requested to notify the sender and delete the email.

Please note that design advice is given in good faith and without prejudice. Graphic cannot be held responsible for any product failure, or if systems do not perform as expected. Information given is for the use of the recipient only and others within their organisation; it should not be given to a third party without express authorisation from Graphic plc.

ITAR regulations stipulate that customers must inform their suppliers if their products are subject to ITAR regulations. If no mention of the ITAR regulations is made on the quote request or the order then Graphic PLC will assume that the ITAR regulations do not apply.

Internet communications are not secure, and Graphic PLC is not responsible for any changes made to the message after it was sent. Although steps have been taken to ensure that this email and any attachments are virus-free, Graphic plc cannot guarantee this, or accept liability for any damage sustained as a result of a virus. Recipients are advised to carry out their own virus checking, especially before opening an attachment.

Graphic PLC, registered in England no. 1036230.
Registered office: Graphic PLC, Down End, Lords Meadow Industrial Estate, Crediton, Devon, EX17 1HN, England.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
