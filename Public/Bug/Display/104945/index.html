<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #104945 for MIME-Types: Can&#39;t find types.db when inside a PAR</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #104945 for MIME-Types: Can&#39;t find types.db when inside a PAR</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/MIME-Types/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/MIME-Types/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/MIME-Types/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/MIME-Types/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/MIME-Types">MIME-Types CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">104945</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/MIME-Types/Active/">MIME-Types</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
perl [...] pied.nu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-21376-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-21377-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




inc<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1506791/803146/inc">
Thu Jun 11 15:07:55 2015 (368b) by perl [...] pied.nu
</a>
</font></li>
</ul>


Philip_Gwyn-MIME_Types-DB_FILE.01.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1506847/803184/Philip_Gwyn-MIME_Types-DB_FILE.01.patch">
Thu Jun 11 19:41:20 2015 (2.7k) by perl [...] pied.nu
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;16:15:45&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Can&#39;t find types.db when inside a PAR</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">PAR::Packer adds 

   #line 1 &#34;MIME/Types.pm&#34;

to Types.pm when packing.  This means that MIME::Types can&#39;t find types.db 

The line :
      || File::Spec-&gt;catfile&#40;dirname&#40;__FILE__&#41;, &#39;types.db&#39;&#41;;

Should be replaced with
      || File::Spec-&gt;catfile&#40;dirname&#40; $INC{&#39;MIME/Types.pm&#39;} &#41;, &#39;types.db&#39;&#41;;

Or better yet, a global $MIME::Types::DB should be available so the default types.db can be set.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;17:19:38&nbsp;2015</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 3 Jun 2015 23:19:20 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150603 20:16]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Wed Jun 03 16:15:45 2015: Request 104945 was acted upon.
&gt; Transaction: Ticket created by GWYN
&gt;        Queue: MIME-Types
&gt;      Subject: Can&#39;t find types.db when inside a PAR
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; PAR::Packer adds 
&gt;    #line 1 &#34;MIME/Types.pm&#34;
&gt; 
&gt; to Types.pm when packing.  This means that MIME::Types can&#39;t find types.db 
</div>
You answer this bug-report yourself: MIME::Types is not doing anything
wrong.  The content of __FILE__ is clearly defined by Perl, so I can
use it.  If PAR::Packer feels the need to mutulate my package, then it
&#40;its users&#41; suffer the consequences, not me.

It would be possible to fix PAR::Packer to add the correct path name.
Or to remove that line

I found some &#40;older&#41; nodes on PerlMonks about the subject.
For instance <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=925167">http://www.perlmonks.org/?node_id=925167</a></span>
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;17:19:39&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;14:03:08&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perl 5.10.1 doco :

Special Literals

       The special literals __FILE__, __LINE__, and __PACKAGE__ represent the current
       filename, line number, and package name at that point in your program.  They
       may be used only as separate tokens; they will not be interpolated into
       strings.  

I see no hard guarantee in that description.

And, in general, a library that allows its user to specify where it will find its data files.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;14:11:54&nbsp;2015</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 11 Jun 2015 20:11:33 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150611 18:04]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; Perl 5.10.1 doco :
&gt; 
&gt; Special Literals
&gt;   The special literals __FILE__, [...] represent the current
&gt;   filename, [...]
&gt; 
&gt; I see no hard guarantee in that description.
</div>
There is a very hard definition what a filename means in the OS context.
A filename points to a sequence of bytes on disk.  So, &#34;current filename&#34;
means &#34;the location of this sequences of bytes on disk&#34;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And, in general, a library that allows its user to specify where
&gt; it will find its data files.
</div>
I do not understand this sentence.
-- 
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;14:42:57&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jun 11 14:03:08 2015, GWYN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And, in general, a library that allows its user to specify where it
&gt; will find its data files.
</div>
Gah!  You have db_file... so this comment is irrelevant.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;14:54:51&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jun 11 14:11:54 2015, Mark@Overmeer.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; There is a very hard definition what a filename means in the OS context.
&gt; A filename points to a sequence of bytes on disk.  So, &#34;current filename&#34;
&gt; means &#34;the location of this sequences of bytes on disk&#34;
</div>
What happens if @INC contains a code ref that loads the code from &#40;eg&#41; a database?

From perlvar: 
               You can also insert hooks into the file inclusion system by putting
               Perl code directly into @INC.  Those hooks may be subroutine refer-
               ences, array references or blessed objects.  See &#34;require&#34; in perlfunc
               for details.

From perlfunc:
               Subroutine references are the simplest case.  When the inclusion system walks
               through @INC and encounters a subroutine, this subroutine gets called with
               two parameters, the first being a reference to itself, and the second the
               name of the file to be included &#40;e.g. &#34;Foo/Bar.pm&#34;&#41;.  The subroutine should
               return &#34;undef&#34; or a filehandle, from which the file to include will be read.
               If &#34;undef&#34; is returned, &#34;require&#34; will look at the remaining elements of
               @INC.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;15:07:55&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">To satisfy my curiosity, I cooked up the attached test.  It outputs the following:

 including Something
 This is /loader/0x57247a0/Something line 4
 This is a warning at /loader/0x57247a0/Something line 5.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> inc</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1506791/803146/inc">Download inc</a><br />
<span class="downloadcontenttype">application/octet-stream 368b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;15:25:17&nbsp;2015</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-06-03 17:19:38, Mark@Overmeer.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150603 20:16]:
<div class="message-stanza open">&gt; &gt; Wed Jun 03 16:15:45 2015: Request 104945 was acted upon.
&gt; &gt; Transaction: Ticket created by GWYN
&gt; &gt;        Queue: MIME-Types
&gt; &gt;      Subject: Can&#39;t find types.db when inside a PAR
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; &gt;
&gt; &gt; PAR::Packer adds
&gt; &gt;   #line 1 &#34;MIME/Types.pm&#34;
&gt; &gt;
&gt; &gt; to Types.pm when packing.  This means that MIME::Types can&#39;t find
&gt; &gt; types.db
</div>&gt; 
&gt; You answer this bug-report yourself: MIME::Types is not doing anything
&gt; wrong.  The content of __FILE__ is clearly defined by Perl, so I can
&gt; use it.  If PAR::Packer feels the need to mutulate my package, then it
&gt; &#40;its users&#41; suffer the consequences, not me.
</div>
If I may interfere --- I don&#39;t think the question is whether MIME::Types is doing something wrong or not. The question is whether PAR is popular or important enough so it deserves some help from CPAN modules to do the job right. And I think the answer is yes.

Regards,
    Slaven
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;15:54:46&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Currently, inside a PAR, you have to use MIME::Types-&gt;new&#40;db_file=&gt;$file&#41;.  This is a problem if you use modules &#40;say MIME::Lite&#41; that don&#39;t use the OO interface.  Even if they did, they&#39;d all have to be fixed.  

The solution is to build a MIME::Types object at start up.  This works because MIME::Types caches the parsed types.db in memory.  This is obviously sub-optimal.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;17:30:08&nbsp;2015</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 11 Jun 2015 23:29:50 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150611 19:55]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; Currently, inside a PAR, you have to use
&gt; MIME::Types-&gt;new&#40;db_file=&gt;$file&#41;.  This is a problem if you use modules
&gt; &#40;say MIME::Lite&#41; that don&#39;t use the OO interface.  Even if they did,
&gt; they&#39;d all have to be fixed.
&gt; 
&gt; The solution is to build a MIME::Types object at start up.  This works
&gt; because MIME::Types caches the parsed types.db in memory.  This is
&gt; obviously sub-optimal.
</div>
Actually, in the current implementation, it is quite efficient in
memory.  If you program uses forks, it is certainly also smart to
start initializing the object early.

There are more modules which expect external files.  For instance,
my XML::Compile modules need xsd and wsdl files to initialize itself.

I do not know how PAR mimics the structure of installed modules.  Does
it expect to see only pm files?

If you have a solutions, of course I can add a section in the man-page
how to correctly use it with PAR, just like there is a section about
mod_perl.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;18:01:39&nbsp;2015</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 12 Jun 2015 00:01:20 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Slaven_Rezic via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Slaven_Rezic via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150611 19:25]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; I don&#39;t think the question is whether MIME::Types is doing something
&gt; wrong or not. The question is whether PAR is popular or important enough
&gt; so it deserves some help from CPAN modules to do the job right. And I
&gt; think the answer is yes.
</div>
The statement &#34;MIME::Types is wrongly using __FILE__, because PAR breaks&#34;,
as the report says, is incorrect.   PAR is playing tricks, and those
tricks cause __FILE__ to have a different content than the perl docs say.
I don&#39;t think the %INC trick is correct either.

Of course, if there is a solution which does not punish other users of
the module --and which is maintainable-- then I would add that.  For
instance, if you can tell me where PAR stores the table file, I could
add something like

   my $file = $ENV{PAR_RUN} ? ....
           : &#40;dirname __FILE__&#41;.&#39;types.db&#39;;


It may also be possible to change PAR to fill __FILE__ correctly.  The
problem is caused by the     #line 1 &#34;MIME/Types.pm&#34;  Probably only
used for error messages?


Another solution I can think of: the first loader of the module can
specify the database file.  But you do not always have access to that
source to adapt it to the needs of PAR.  So, it could also be solved
via an environment variable.

   my $file = $ENV{PERL_MIME_TYPES_DB} || &#40;dirname __FILE__&#41;.&#39;types.db&#39;;


I think the last option is the best.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;19:37:28&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Jeu 11 Juin 2015 17:30:08, Mark@Overmeer.net a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Actually, in the current implementation, it is quite efficient in
&gt; memory.  If you program uses forks, it is certainly also smart to
&gt; start initializing the object early.
</div>
The inefficiency is having to load and parse a text file every time the program is run, just in case the program might use MIME::Types&#39; functionnal API.

The in-memory representation is compact.  And given that it is subsequently a &#40;mostly&#41; read-only structure, any sane OS will share the memory between parent and forked children.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;19:39:09&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Jeu 11 Juin 2015 18:01:39, Mark@Overmeer.net a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    my $file = $ENV{PERL_MIME_TYPES_DB} || &#40;dirname __FILE__&#41;.&#39;types.db&#39;;
&gt; 
&gt; 
&gt; I think the last option is the best.
</div>
The attached patch implements $MIME::Types::DB_FILE, including a small test case and documentation patch.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;11&nbsp;19:41:20&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I clicked Submit to early.  Here is the actual patch.

What&#39;s more, I think this patch has a surprise : If types.db is cached in-memory, then $DB_FILE is change, the new $DB_FILE won&#39;t be loaded.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Philip_Gwyn-MIME_Types-DB_FILE.01.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -rubN MIME-Types-2.09-orig/lib/MIME/Types.pm MIME-Types-2.09-PG/lib/MIME/Types.pm
--- MIME-Types-2.09-orig/lib/MIME/Types.pm	2014-09-14 12:12:24.000000000 -0400
+++ MIME-Types-2.09-PG/lib/MIME/Types.pm	2015-06-11 14:18:33.000000000 -0400
@@ -19,6 +19,8 @@
 my %typedb;
 sub new&#40;@&#41; { &#40;bless {}, shift&#41;-&gt;init&#40; {@_} &#41; }
 
+our $DB_FILE;
+
 sub init&#40;$&#41;
 {   my &#40;$self, $args&#41; = @_;
     keys %typedb or $self-&gt;_read_db&#40;$args&#41;;
@@ -32,6 +34,7 @@
     my $only_iana       = $args-&gt;{only_iana};
 
     my $db              = $args-&gt;{db_file}
+      || $DB_FILE
       || File::Spec-&gt;catfile&#40;dirname&#40;__FILE__&#41;, &#39;types.db&#39;&#41;;
 
     local *DB;
diff -rubN MIME-Types-2.09-orig/lib/MIME/Types.pod MIME-Types-2.09-PG/lib/MIME/Types.pod
--- MIME-Types-2.09-orig/lib/MIME/Types.pod	2014-09-14 12:12:24.000000000 -0400
+++ MIME-Types-2.09-PG/lib/MIME/Types.pod	2015-06-11 14:40:50.000000000 -0400
@@ -244,6 +244,23 @@
 
 =back
 
+=head1 VARIABLES
+
+=over 4
+
+=item B&lt;$MIME::Types::DB_FILE&gt;
+
+Location of C&lt;types.db&gt;, the database of known extensions.  Normally,
+MIME::Types looks in the directory were C&lt;Types.pm&gt; is installed.  You may
+use this variable to specify another location for C&lt;types.db&gt;.
+
+example:
+
+    $MIME::Types::DB_FILE = File::Spec-&gt;catfile&#40; $datadir, &#34;types.db&#34; &#41;;
+
+=back
+
+
 =head1 SEE ALSO
 
 This module is part of MIME-Types distribution version 2.09,
diff -rubN MIME-Types-2.09-orig/t/20types.t MIME-Types-2.09-PG/t/20types.t
--- MIME-Types-2.09-orig/t/20types.t	2014-09-14 12:12:24.000000000 -0400
+++ MIME-Types-2.09-PG/t/20types.t	2015-06-11 14:34:26.000000000 -0400
@@ -98,3 +98,5 @@
 ok&#40;$r7, &#39;type sheet&#39;&#41;;
 ok&#40;$r7-&gt;isBinary&#41;;
 ok&#40;!$r7-&gt;isText&#41;;
+
+
diff -rubN MIME-Types-2.09-orig/t/23db_file.t MIME-Types-2.09-PG/t/23db_file.t
--- MIME-Types-2.09-orig/t/23db_file.t	1969-12-31 19:00:00.000000000 -0500
+++ MIME-Types-2.09-PG/t/23db_file.t	2015-06-11 14:26:46.000000000 -0400
@@ -0,0 +1,22 @@
+#!/usr/bin/env perl
+#
+# Test reporting warnings, errors and family.
+#
+
+use strict;
+use warnings;
+
+use lib qw&#40;lib t&#41;;
+
+use Test::More tests =&gt; 3;
+
+use FindBin;
+use File::Spec;
+use MIME::Types;
+
+local $MIME::Types::DB_FILE = File::Spec-&gt;catfile&#40; $FindBin::Bin, &#39;fake-types.db&#39; &#41;;
+my $a = MIME::Types-&gt;new;
+isa_ok&#40; $a, &#39;MIME::Types&#39; &#41;;
+   
+is&#40;$a-&gt;mimeTypeOf&#40;&#39;my.honk&#39;&#41;-&gt;type, &#39;application/x-honk&#39;&#41;;
+is&#40;$a-&gt;mimeTypeOf&#40;&#39;my.pdf&#39;&#41;-&gt;type, &#39;application/x-not-pdf&#39;&#41;;
diff -rubN MIME-Types-2.09-orig/t/fake-types.db MIME-Types-2.09-PG/t/fake-types.db
--- MIME-Types-2.09-orig/t/fake-types.db	1969-12-31 19:00:00.000000000 -0500
+++ MIME-Types-2.09-PG/t/fake-types.db	2015-06-11 14:32:51.000000000 -0400
@@ -0,0 +1,8 @@
+2:EXTENSIONS
+honk;application/x-honk
+pdf;application/x-not-pdf
+
+2:application::
+x-honk;honk;
+x-not-pdf;pdf;
+
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;04:47:06&nbsp;2015</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 12 Jun 2015 10:46:43 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150611 18:55]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; On Thu Jun 11 14:11:54 2015, Mark@Overmeer.net wrote:
<div class="message-stanza open">&gt; &gt; There is a very hard definition what a filename means in the OS context.
&gt; &gt; A filename points to a sequence of bytes on disk.  So, &#34;current filename&#34;
&gt; &gt; means &#34;the location of this sequences of bytes on disk&#34;
</div>&gt; 
&gt; What happens if @INC contains a code ref that loads the code from &#40;eg&#41; a
&gt; database?
</div>
I do not see any relation between your description of @INC &#40;which I
alreay knew&#41; and my quoted remark about the strict meaning of the
word &#34;filename&#34;.
-- 
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;04:57:21&nbsp;2015</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 12 Jun 2015 10:57:10 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150611 23:37]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; Le Jeu 11 Juin 2015 17:30:08, Mark@Overmeer.net a écrit :
<div class="message-stanza open">&gt; &gt; Actually, in the current implementation, it is quite efficient in
&gt; &gt; memory.  If you program uses forks, it is certainly also smart to
&gt; &gt; start initializing the object early.
</div>&gt; 
&gt; The inefficiency is having to load and parse a text file every time
&gt; the program is run, just in case the program might use MIME::Types&#39;
&gt; functionnal API.
</div>
It is more inefficient to do it once, than in every thread of a daemon.

The core problem is that look-ups require an index, so you have to build
that first, before you can use the data.  Of course, this can be solved
by using a real database... which gives so many extra complications.

The functional API is a wrapper around the OO implementation.
Is see no way why a functional interface could avoid reading the
whole file.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The in-memory representation is compact.  And given that it is
&gt; subsequently a &#40;mostly&#41; read-only structure, any sane OS will share the
&gt; memory between parent and forked children.
</div>
Well... reference counting in Perl seriously hinders page sharing.
-- 
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;05:08:34&nbsp;2015</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 12 Jun 2015 11:08:21 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150611 23:39]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; Le Jeu 11 Juin 2015 18:01:39, Mark@Overmeer.net a écrit :
<div class="message-stanza open">&gt; &gt;    my $file = $ENV{PERL_MIME_TYPES_DB} || &#40;dirname __FILE__&#41;.&#39;types.db&#39;;
&gt; &gt; 
&gt; &gt; 
&gt; &gt; I think the last option is the best.
</div>&gt; 
&gt; The attached patch implements $MIME::Types::DB_FILE, including a small
&gt; test case and documentation patch.
</div>
Having a global variable is not a sufficient solution.  At least two
situations are not covered:

  1&#41;   when your script starts with

          local $MIME::Types::DB = &#39;/tmp/types.db&#39;;
          use Some::Types::Module;

       and that other module initializes the table inside a BEGIN, it
       will already have attempted to read the file from the original
       location before it is set.

  2&#41;   it will not help enough in the PAR case.  All scripts in the PAR
       archive must be aware that one of their modules may use MIME::Types,
       and set the variable accordingly.  It is far much safer when the
       PAR environment hides that for all.

I am unsure whether it is useful to add both options, because of the
first problem.  I think that only an environment variable can be useful.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;11:43:13&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Ven 12 Juin 2015 04:47:06, solutions@overmeer.net a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I do not see any relation between your description of @INC &#40;which I
&gt; alreay knew&#41; and my quoted remark about the strict meaning of the
&gt; word &#34;filename&#34;.
</div>
It was more of a rhetorical question, which I answered with my short test.

The point I am trying to make is that while the docs say &#34;__FILE__ is a filename&#34;, and &#40;as you point out&#41; &#34;filename are indexes to bytes on a disk.&#34;  It is trivial form __FILE__ to contain a string that doesn&#39;t usefully index any bytes on a disk.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;11:45:15&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Ven 12 Juin 2015 05:08:34, solutions@overmeer.net a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am unsure whether it is useful to add both options, because of the
&gt; first problem.  I think that only an environment variable can be useful.
</div>
If this is the sole option you are prepared to implement, I will not complain.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;12:00:20&nbsp;2015</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 12 Jun 2015 17:59:59 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150612 15:43]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; The point I am trying to make is that while the docs say &#34;__FILE__
&gt; is a filename&#34;, and &#40;as you point out&#41; &#34;filename are indexes to bytes on
&gt; a disk.&#34;  It is trivial form __FILE__ to contain a string that doesn&#39;t
&gt; usefully index any bytes on a disk.
</div>
But that case is clearly not according to the specification of __FILE__
to use it differently than to contain a filename with perl source,
hence a bug &#40;either a bug in the code, or a bug in the specification&#41;
if it is not.

So, in my opinion, PAR is in conflict with the perl5 &#34;specification&#34;,
which is its manual pages.  With the environment variable we introduce,
we let get PAR away with its bug.  Which is not that much of a problem
for me.

Can you tell me where PAR puts my type.db file, so that I can include
that in the docs?
-- 
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;12:50:18&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Ven 12 Juin 2015 12:00:20, Mark@Overmeer.net a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But that case is clearly not according to the specification of __FILE__
&gt; to use it differently than to contain a filename with perl source,
&gt; hence a bug &#40;either a bug in the code, or a bug in the specification&#41;
&gt; if it is not.
</div>
I was referring to this test, that does not use PAR
<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945#txn-1506791">https://rt.cpan.org/Ticket/Display.html?id=104945#txn-1506791</a></span>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you tell me where PAR puts my type.db file, so that I can include
&gt; that in the docs?
</div>
PAR does not &#40;that I know of&#41; do anything special with types.db.  If one is packing MIME::Types, one has to explicitly include it with -a lib/MIME/types.db.  Other modules &#40;like PDF::API2&#41; must also have their data files explicitly included &#40;eg unipaper.txt&#41;.

PAR creates a zip file.  This file has a directory structure similar to how perl install modules.  So types.db would be lib/MIME/types.db within the zip file.  At execution, PAR unpacks the zip into a cache directory.  The rules for generating this directory name are convoluted.  The full path to the cache directory is in $ENV{PAR_TEMP} so code inside the PAR may access files in the cache directory.  

Examples of where types.db might end up: 

    /tmp/par-USER/cache-HASH/inc/lib/MIME/types.db
    /tmp/USER/private/PAR/user-USER/cache-HASH/inc/lib/MIME/types.db

Where USER is the current user name and HASH is a crypto-hash of the entire PAR file, or a string specified when the PAR is created.

PAR files can also be self-extracting executable.

What this means for MIME::Types is that you would use the following to find types.db when running
from a PAR.

    $db_file = File::Spec-&gt;catfile&#40; $ENV{PAR_TEMP}, qw&#40; inc lib MIME types.db &#41; &#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;16:03:17&nbsp;2015</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-06-12 12:50:18, GWYN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Le Ven 12 Juin 2015 12:00:20, Mark@Overmeer.net a écrit :
<div class="message-stanza open">&gt; &gt; But that case is clearly not according to the specification of
&gt; &gt; __FILE__
&gt; &gt; to use it differently than to contain a filename with perl source,
&gt; &gt; hence a bug &#40;either a bug in the code, or a bug in the specification&#41;
&gt; &gt; if it is not.
</div>&gt; 
&gt; I was referring to this test, that does not use PAR
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945#txn-1506791">https://rt.cpan.org/Ticket/Display.html?id=104945#txn-1506791</a></span>
&gt; 
<div class="message-stanza open">&gt; &gt; Can you tell me where PAR puts my type.db file, so that I can include
&gt; &gt; that in the docs?
</div>&gt; 
&gt; PAR does not &#40;that I know of&#41; do anything special with types.db.  If
&gt; one is packing MIME::Types, one has to explicitly include it with -a
&gt; lib/MIME/types.db.  Other modules &#40;like PDF::API2&#41; must also have
&gt; their data files explicitly included &#40;eg unipaper.txt&#41;.
</div>
This is not what I observe. types.db is automatically included. The sample script

#!perl
use MIME::Types;
for &#40;@INC&#41; {
    my $candidate = &#34;$_/MIME/types.db&#34;;
    warn $candidate if -r $candidate;
}
__END__

outputs the following after being packed with &#34;pp&#34; and no extra arguments:

/tmp/par-657365727465/cache-3737f86569047eebe851dce4bdcd739615edb166/inc/lib/MIME/types.db at script/test.pl line 5.

The exception list seems to be in Module::ScanDeps, which has this line:

    &#39;MIME/Types.pm&#39;                 =&gt; [qw&#40; MIME/types.db &#41;],

BTW, for Tk scripts the inclusion of icon images works with PAR because Tk modules usually walk @INC in the search for the icon images &#40;using the Tk-&gt;findINC&#40;&#34;imagename.suffix&#34;&#41; call&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;16:20:22&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Ven 12 Juin 2015 16:03:17, SREZIC a écrit :

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is not what I observe. types.db is automatically included. 
</div>
My Makefile was written years ago, back before Module::ScanDeps had a special case for types.db

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; BTW, for Tk scripts the inclusion of icon images works with PAR
&gt; because Tk modules usually walk @INC in the search for the icon images
&gt; &#40;using the Tk-&gt;findINC&#40;&#34;imagename.suffix&#34;&#41; call&#41;.
</div>
That seems wasteful.  What&#39;s more, Tk-&gt;findINC will not respect coderefs in @INC.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;16:32:49&nbsp;2015</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-06-12 16:20:22, GWYN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Le Ven 12 Juin 2015 16:03:17, SREZIC a écrit :
&gt; 
</div>[...]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; BTW, for Tk scripts the inclusion of icon images works with PAR
&gt; &gt; because Tk modules usually walk @INC in the search for the icon
&gt; &gt; images
&gt; &gt; &#40;using the Tk-&gt;findINC&#40;&#34;imagename.suffix&#34;&#41; call&#41;.
</div>&gt; 
&gt; That seems wasteful.  What&#39;s more, Tk-&gt;findINC will not respect
&gt; coderefs in @INC.
</div>
This was meant just as another example module where something INC-like was used for locating extra non-pm files &#40;OK, this is @INC and not %INC&#41;.

And why should this be wasteful? In a typical custom perl installation the arch sitelib is the first one in @INC, and even if it was the last directory in @INC --- a few stat&#40;&#41; calls a hardly performance-relevant these days. But this probably belongs to the Tk RT queue...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;17:03:42&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Ven 12 Juin 2015 16:32:49, SREZIC a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This was meant just as another example module where something INC-like
&gt; was used for locating extra non-pm files &#40;OK, this is @INC and not
&gt; %INC&#41;.
&gt; 
&gt; And why should this be wasteful? In a typical custom perl installation
&gt; the arch sitelib is the first one in @INC, and even if it was the last
&gt; directory in @INC --- a few stat&#40;&#41; calls a hardly performance-relevant
&gt; these days. But this probably belongs to the Tk RT queue...
</div>
Everybody has their own idea about where to install data files and how to find them.  Everybody implements these ideas seperately.  IMHO, everybody should be using File::ShareDir and File::ShareDir::Install.  Doing so would mean Module::ScanDeps could Just Work, rather then maintaining a list of special cases.

But yes, we are getting very far away from the initial discussion.  I agree that $ENV{PERL_MIME_TYPES_DB} is an adequate solution for this problem.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;15&nbsp;11:34:17&nbsp;2015</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104945] Can&#39;t find types.db when inside a PAR</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 15 Jun 2015 17:33:58 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Philip Gwyn via RT &lt;bug-MIME-Types [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Philip Gwyn via RT &#40;bug-MIME-Types@rt.cpan.org&#41; [150612 15:45]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: MIME-Types
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104945">https://rt.cpan.org/Ticket/Display.html?id=104945</a></span> &gt;
&gt; 
&gt; Le Ven 12 Juin 2015 05:08:34, solutions@overmeer.net a écrit :
<div class="message-stanza open">&gt; &gt; I am unsure whether it is useful to add both options, because of the
&gt; &gt; first problem.  I think that only an environment variable can be useful.
</div>&gt; 
&gt; If this is the sole option you are prepared to implement, I will not complain.
</div>
Released as MIME::Types version 2.10
Thanks for your contribution.
-- 
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;17&nbsp;03:06:51&nbsp;2015</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;17&nbsp;12:02:08&nbsp;2015</span>
    <span class="description">perl [...] pied.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Lun 15 Juin 2015 11:34:17, solutions@overmeer.net a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Released as MIME::Types version 2.10
&gt; Thanks for your contribution.
</div>

Cheers.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
