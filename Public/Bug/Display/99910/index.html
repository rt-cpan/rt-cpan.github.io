<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #99910 for IO-Socket-SSL: possible bug/issue in IO::Socket::SSL v1.94</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #99910 for IO-Socket-SSL: possible bug/issue in IO::Socket::SSL v1.94</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=IO-Socket-SSL">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=IO-Socket-SSL">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=IO-Socket-SSL">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=IO-Socket-SSL">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Socket-SSL">IO-Socket-SSL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">99910</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=IO-Socket-SSL">IO-Socket-SSL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
brian.biggs [...] sonoma.edu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-17228-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-17229-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=99910">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1427078" href="/Public/Bug/Display.html?id=99910#txn-1427078">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;30&nbsp;12:08:19&nbsp;2014</span>
    <span class="description">brian.biggs [...] sonoma.edu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> possible bug/issue in IO::Socket::SSL v1.94</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Oct 2014 09:08:00 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Brian Biggs &lt;brian.biggs [...] sonoma.edu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1427078/758147/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/758147">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I&#39;ve run into an issue where it seems that the use of certain global 
variables in IO::Socket::SSL have caused failures under certain 
circumstances. Specifically when a second SSL connection is made within 
the same program to a different host with a different SSL cert.

I was able to mitigate the problem by clearing the globals like this:

         # Call this to mitigate a bug in IO::Socket::SSL which has some
         # global settings that don&#39;t get cleaned up between connections.
         # We also check for set_defaults&#40;&#41; because the RHEL6 version of
         # IO::Socket::SSL doesn&#39;t have a set_defaults&#40;&#41; function.
         defined&#40;&#38;IO::Socket::SSL::set_defaults&#41; &#38;&#38;
         IO::Socket::SSL::set_defaults&#40;
                 verifycn_name           =&gt;      undef,
                 SSL_verifycn_name       =&gt;      undef,
                 SSL_verifycn_scheme     =&gt;      undef,
                 SSL_verify_mode         =&gt;      undef
         &#41;;

This program &#40;a CGI&#41; first makes a connection to LDAP and then makes a 
call to CAS to authenticate a user.

This program is running fine on a RHEL6 distro using the following versions:

perl v5.10.1
IO::Socket::SSL v1.31
Linux redacted_name 2.6.32-431.29.2.el6.x86_64 #1 SMP Sun Jul 27 
15:55:46 EDT 2014 x86_64 x86_64 x86_64 GNU/Linux

Migrating to RHEL7 caused this problem to exhibit. Our RHEL7 environment 
has the following versions:

perl v5.16.3
IO::Socket::SSL v1.94
Linux redacted_name 3.10.0-123.8.1.el7.x86_64 #1 SMP Mon Aug 11 13:37:49 
EDT 2014 x86_64 x86_64 x86_64 GNU/Linux

The error message we received when we migrated to RHEL7 was:
Not a GLOB reference at /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm 
line 1377

With the mitigation code in place we see the following issues in the web 
server logs:

Use of uninitialized value $verify_mode in numeric ne &#40;!=&#41; at 
/usr/share/perl5/vendor_perl/IO/Socket/SSL.pm line 1649

and

Use of uninitialized value in subroutine entry at 
/usr/share/perl5/vendor_perl/IO/Socket/SSL.pm line 1776

but the code runs successfully.

If this is not a bug/issue with IO::Socket::SSL I do apologize.

-Brian

-- 

Brian Biggs
Sonoma State University
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1427125" href="/Public/Bug/Display.html?id=99910#txn-1427125">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;30&nbsp;13:19:42&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1427125/758181/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/758181">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Brian,

the release of 1.94 was 06/2013. Since then 50 new versions were released. Please understand that I will not put too much effort into supporting such old versions. But of course I will look into the issue to see if it applies to current versions too.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ve run into an issue where it seems that the use of certain global 
&gt; variables in IO::Socket::SSL have caused failures under certain 
&gt; circumstances. Specifically when a second SSL connection is made within 
&gt; the same program to a different host with a different SSL cert.
</div>
Unfortunately this report does not contain enough information to reproduce the problem. Having multiple connections with different certificates at the same time is definitely supported, but there are issues when using threads. Please provide a test program or description, which is as simple as possible but clear enough to make the issue reproducible.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I was able to mitigate the problem by clearing the globals like this:
&gt; 
&gt;          # Call this to mitigate a bug in IO::Socket::SSL which has some
&gt;          # global settings that don&#39;t get cleaned up between connections.
&gt;          # We also check for set_defaults&#40;&#41; because the RHEL6 version of
&gt;          # IO::Socket::SSL doesn&#39;t have a set_defaults&#40;&#41; function.
&gt;          defined&#40;&#38;IO::Socket::SSL::set_defaults&#41; &#38;&#38;
&gt;          IO::Socket::SSL::set_defaults&#40;
&gt;                  verifycn_name           =&gt;      undef,
&gt;                  SSL_verifycn_name       =&gt;      undef,
&gt;                  SSL_verifycn_scheme     =&gt;      undef,
&gt;                  SSL_verify_mode         =&gt;      undef
&gt;          &#41;;
</div>
There is no verifycn_name option.
Apart from that this just disables any verification your LDAP or CAS connections might want to do, so it might just be that there is a problem with certificate validation. A detailed description what kind of failures you get would be definitely helpful.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This program is running fine on a RHEL6 distro using the following versions:
&gt; ....
&gt; IO::Socket::SSL v1.31
&gt; ....
&gt; Migrating to RHEL7 caused this problem to exhibit. Our RHEL7 environment 
&gt; has the following versions:
&gt; 
&gt; IO::Socket::SSL v1.94
</div>
Please note that apart from IO::Socket::SSL and the Perl version there were probably also changes with other modules you use and which might affect the behavior. IO::Socket::SSL itself uses at least Net::SSLeay, but you use probably also Net::LDAP and other modules.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ...
&gt; The error message we received when we migrated to RHEL7 was:
&gt; Not a GLOB reference at /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm 
&gt; line 1377
</div>
I don&#39;t see anything obviously wrong in this line. I would argue that it is simply called the wrong way &#40;that is not with an IO::Socket::SSL object&#41;, but I would need to see the code which triggers the problem. It might just be that some &#40;certificate verification&#41; error occurred and that some code failed to catch the error properly, but this is just a wild guess.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; With the mitigation code in place we see the following issues in the web 
&gt; server logs:
&gt; 
&gt; Use of uninitialized value $verify_mode in numeric ne &#40;!=&#41; at 
&gt; /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm line 1649
&gt; ...
&gt; Use of uninitialized value in subroutine entry at 
&gt; /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm line 1776
</div>
That is because you set SSL_verify_mode to undef, which is not a supported value &#40;see documentation for the supported values&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If this is not a bug/issue with IO::Socket::SSL I do apologize.
</div>
I don&#39;t know yet.
If you would provide me a way to reproduce the problem I could have a look if this is a bug in IO::Socket::SSL and if this bug is fixed in the current version.

Regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1427126" href="/Public/Bug/Display.html?id=99910#txn-1427126">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;30&nbsp;13:19:42&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1427136" href="/Public/Bug/Display.html?id=99910#txn-1427136">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;30&nbsp;13:44:27&nbsp;2014</span>
    <span class="description">brian.biggs [...] sonoma.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;behroozi [...] www.pls.uni.edu&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #99910] possible bug/issue in IO::Socket::SSL v1.94</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Oct 2014 10:44:02 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Brian Biggs &lt;brian.biggs [...] sonoma.edu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1427136/758187/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/758187">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Steffan,

Thank you for your reply. I completely understand that you will not put 
much effort into this. I will attempt to create some code which will 
exhibit this problem. I cannot provide you with the existing program as 
it includes code we would not want public.

This may really be a Redhat issue since v1.94 is old and that is what 
they are distributing.

I may try to get our sys admins to give me a RHEL7 system with the 
latest version of this library to see if the problem exists there.

Thanks again,

-Brian

On 10/30/2014 10:19 AM, Steffen Ullrich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=99910">https://rt.cpan.org/Ticket/Display.html?id=99910</a></span> &gt;
&gt;
&gt; Hi Brian,
&gt;
&gt; the release of 1.94 was 06/2013. Since then 50 new versions were released. Please understand that I will not put too much effort into supporting such old versions. But of course I will look into the issue to see if it applies to current versions too.
&gt;
<div class="message-stanza open">&gt;&gt; I&#39;ve run into an issue where it seems that the use of certain global
&gt;&gt; variables in IO::Socket::SSL have caused failures under certain
&gt;&gt; circumstances. Specifically when a second SSL connection is made within
&gt;&gt; the same program to a different host with a different SSL cert.
</div>&gt; Unfortunately this report does not contain enough information to reproduce the problem. Having multiple connections with different certificates at the same time is definitely supported, but there are issues when using threads. Please provide a test program or description, which is as simple as possible but clear enough to make the issue reproducible.
&gt;
<div class="message-stanza open">&gt;&gt; I was able to mitigate the problem by clearing the globals like this:
&gt;&gt;
&gt;&gt;           # Call this to mitigate a bug in IO::Socket::SSL which has some
&gt;&gt;           # global settings that don&#39;t get cleaned up between connections.
&gt;&gt;           # We also check for set_defaults&#40;&#41; because the RHEL6 version of
&gt;&gt;           # IO::Socket::SSL doesn&#39;t have a set_defaults&#40;&#41; function.
&gt;&gt;           defined&#40;&#38;IO::Socket::SSL::set_defaults&#41; &#38;&#38;
&gt;&gt;           IO::Socket::SSL::set_defaults&#40;
&gt;&gt;                   verifycn_name           =&gt;      undef,
&gt;&gt;                   SSL_verifycn_name       =&gt;      undef,
&gt;&gt;                   SSL_verifycn_scheme     =&gt;      undef,
&gt;&gt;                   SSL_verify_mode         =&gt;      undef
&gt;&gt;           &#41;;
</div>&gt; There is no verifycn_name option.
&gt; Apart from that this just disables any verification your LDAP or CAS connections might want to do, so it might just be that there is a problem with certificate validation. A detailed description what kind of failures you get would be definitely helpful.
&gt;
<div class="message-stanza open">&gt;&gt; This program is running fine on a RHEL6 distro using the following versions:
&gt;&gt; ....
&gt;&gt; IO::Socket::SSL v1.31
&gt;&gt; ....
&gt;&gt; Migrating to RHEL7 caused this problem to exhibit. Our RHEL7 environment
&gt;&gt; has the following versions:
&gt;&gt;
&gt;&gt; IO::Socket::SSL v1.94
</div>&gt; Please note that apart from IO::Socket::SSL and the Perl version there were probably also changes with other modules you use and which might affect the behavior. IO::Socket::SSL itself uses at least Net::SSLeay, but you use probably also Net::LDAP and other modules.
&gt;
<div class="message-stanza open">&gt;&gt; ...
&gt;&gt; The error message we received when we migrated to RHEL7 was:
&gt;&gt; Not a GLOB reference at /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm
&gt;&gt; line 1377
</div>&gt; I don&#39;t see anything obviously wrong in this line. I would argue that it is simply called the wrong way &#40;that is not with an IO::Socket::SSL object&#41;, but I would need to see the code which triggers the problem. It might just be that some &#40;certificate verification&#41; error occurred and that some code failed to catch the error properly, but this is just a wild guess.
&gt;
<div class="message-stanza open">&gt;&gt; With the mitigation code in place we see the following issues in the web
&gt;&gt; server logs:
&gt;&gt;
&gt;&gt; Use of uninitialized value $verify_mode in numeric ne &#40;!=&#41; at
&gt;&gt; /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm line 1649
&gt;&gt; ...
&gt;&gt; Use of uninitialized value in subroutine entry at
&gt;&gt; /usr/share/perl5/vendor_perl/IO/Socket/SSL.pm line 1776
</div>&gt; That is because you set SSL_verify_mode to undef, which is not a supported value &#40;see documentation for the supported values&#41;.
&gt;
<div class="message-stanza open">&gt;&gt; If this is not a bug/issue with IO::Socket::SSL I do apologize.
</div>&gt; I don&#39;t know yet.
&gt; If you would provide me a way to reproduce the problem I could have a look if this is a bug in IO::Socket::SSL and if this bug is fixed in the current version.
&gt;
&gt; Regards,
&gt; Steffen
&gt;
&gt;
</div>
-- 

Brian Biggs
Sonoma State University
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1495962" href="/Public/Bug/Display.html?id=99910#txn-1495962">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;13&nbsp;16:55:58&nbsp;2015</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1495962/796816/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/796816">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 267b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ...I will attempt to create some code which will
&gt; exhibit this problem. I cannot provide you with the existing program
&gt; as it includes code we would not want public...
</div>
I will close this bug because of missing input. Maybe the problem was solved in the mean time.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1495965" href="/Public/Bug/Display.html?id=99910#txn-1495965">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;13&nbsp;16:56:00&nbsp;2015</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1496222" href="/Public/Bug/Display.html?id=99910#txn-1496222">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;14&nbsp;11:25:00&nbsp;2015</span>
    <span class="description">brian.biggs [...] sonoma.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;behroozi [...] www.pls.uni.edu&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #99910] possible bug/issue in IO::Socket::SSL v1.94</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 14 May 2015 08:24:28 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Brian Biggs &lt;brian.biggs [...] sonoma.edu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1496222/796959/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/796959">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 601b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Bug was never solved; however it was brought to the attention of Redhat 
who filed a bug for it for RHEL7.

<span class="clickylink"><a target="new" rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=1210032">https://bugzilla.redhat.com/show_bug.cgi?id=1210032</a></span>

-Brian

On 05/13/2015 01:55 PM, Steffen Ullrich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=99910">https://rt.cpan.org/Ticket/Display.html?id=99910</a></span> &gt;
&gt;
<div class="message-stanza open">&gt;&gt; ...I will attempt to create some code which will
&gt;&gt; exhibit this problem. I cannot provide you with the existing program
&gt;&gt; as it includes code we would not want public...
</div>&gt; I will close this bug because of missing input. Maybe the problem was solved in the mean time.
&gt;
</div>
-- 

Brian Biggs
Sonoma State University
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1496598" href="/Public/Bug/Display.html?id=99910#txn-1496598">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;15&nbsp;02:52:15&nbsp;2015</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1496598/797163/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/797163">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 447b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu May 14 11:25:00 2015, brian.biggs@sonoma.edu wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Bug was never solved; however it was brought to the attention of
&gt; Redhat
&gt; who filed a bug for it for RHEL7.
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=1210032">https://bugzilla.redhat.com/show_bug.cgi?id=1210032</a></span>
</div>
If I understand this right then this was not a bug in IO::Socket::SSL at all but in Net::LDAP, it was already fixed there two years ago and the only thing missing was the inclusion of the fix in RHEL7. Is this correct?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1496740" href="/Public/Bug/Display.html?id=99910#txn-1496740">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;15&nbsp;09:57:57&nbsp;2015</span>
    <span class="description">brian.biggs [...] sonoma.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;behroozi [...] www.pls.uni.edu&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #99910] possible bug/issue in IO::Socket::SSL v1.94</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 15 May 2015 06:57:29 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Brian Biggs &lt;brian.biggs [...] sonoma.edu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1496740/797244/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/797244">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 695b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I believe that is correct. My apologies for not following up with you.

-Brian

On 05/14/2015 11:52 PM, Steffen Ullrich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=99910">https://rt.cpan.org/Ticket/Display.html?id=99910</a></span> &gt;
&gt;
&gt; On Thu May 14 11:25:00 2015, brian.biggs@sonoma.edu wrote:
<div class="message-stanza open">&gt;&gt; Bug was never solved; however it was brought to the attention of
&gt;&gt; Redhat
&gt;&gt; who filed a bug for it for RHEL7.
&gt;&gt;
&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=1210032">https://bugzilla.redhat.com/show_bug.cgi?id=1210032</a></span>
</div>&gt; If I understand this right then this was not a bug in IO::Socket::SSL at all but in Net::LDAP, it was already fixed there two years ago and the only thing missing was the inclusion of the fix in RHEL7. Is this correct?
&gt;
</div>
-- 

Brian Biggs
Sonoma State University
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.429761</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
