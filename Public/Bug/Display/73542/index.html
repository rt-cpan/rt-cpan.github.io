<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #73542 for Test-Simple: Crash in 5.8.9</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #73542 for Test-Simple: Crash in 5.8.9</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Test-Simple/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Test-Simple/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Test-Simple/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Test-Simple/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/Test-More/test-more/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Test-Simple">Test-Simple CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">73542</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Test-Simple/Active/">Test-Simple</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
&#39;spro^^*%*^6ut# [...] &#38;$%*c

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-31590-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-31591-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;28&nbsp;19:48:40&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Crash in 5.8.9</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I tried installing MSCHWERN/Test-Simple-1.005000_002.tar.gz in 5.8.9 to test my modules 
against it.

I got crashes during testing:

t/diag.....................................dubious                           
        Test returned status 0 &#40;wstat 10, 0xa&#41;
        after all the subtests completed successfully
t/overload_threads.........................dubious                           
        Test returned status 0 &#40;wstat 10, 0xa&#41;
        after all the subtests completed successfully
t/subtest/threads..........................dubious                           
        Test returned status 0 &#40;wstat 10, 0xa&#41;
        after all the subtests completed successfully

Do some tests need to be skipped?

$ perl5.8.9 -V
Summary of my perl5 &#40;revision 5 version 8 subversion 9&#41; configuration:
  Platform:
    osname=darwin, osvers=10.0, archname=darwin-thread-multi-2level
    uname=&#39;darwin neige.apple.com 10.0 darwin kernel version 10.0.0d8: tue may 5 19:29:59 
pdt 2009; root:xnu-1437.2~2release_i386 i386 &#39;
    config_args=&#39;-ds -e -Dprefix=/usr -Dccflags=-g  -pipe  -Dldflags= -Dman3ext=3pm -
Duseithreads -Duseshrplib -Dinc_version_list=none -Dcc=gcc-4.2&#39;
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=define use5005threads=undef useithreads=define usemultiplicity=define
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=define use64bitall=define uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;gcc-4.2&#39;, ccflags =&#39;-arch i386 -arch ppc -g -pipe -fno-common -DPERL_DARWIN -
fno-strict-aliasing -I/usr/local/include&#39;,
    optimize=&#39;-Os&#39;,
    cppflags=&#39;-g -pipe -fno-common -DPERL_DARWIN -fno-strict-aliasing -
I/usr/local/include&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.2.1 &#40;Apple Inc. build 5646&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;gcc-4.2 -mmacosx-version-min=10.6&#39;, ldflags =&#39;-arch i386 -arch ppc -
L/usr/local/lib&#39;
    libpth=/usr/local/lib /usr/lib
    libs=-ldbm -ldl -lm -lutil -lc
    perllibs=-ldl -lm -lutil -lc
    libc=/usr/lib/libc.dylib, so=dylib, useshrplib=true, libperl=libperl.dylib
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=bundle, d_dlsymun=undef, ccdlflags=&#39; &#39;
    cccdlflags=&#39; &#39;, lddlflags=&#39;-arch i386 -arch ppc -bundle -undefined dynamic_lookup -
L/usr/local/lib&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: MULTIPLICITY PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP
                        USE_FAST_STDIO USE_ITHREADS USE_LARGE_FILES
                        USE_PERLIO USE_REENTRANT_API
  Locally applied patches:
        /Library/Perl/Updates/&lt;version&gt; comes before system perl directories
        installprivlib and installarchlib points to the Updates directory
        6576362: fixed 5.8.9 binary compatibility issue: perlio mutex not initialized
  Built under darwin
  Compiled at Jun 24 2009 00:35:17
  @INC:
    /Library/Perl/Updates/5.8.9/darwin-thread-multi-2level
    /Library/Perl/Updates/5.8.9
    /System/Library/Perl/5.8.9/darwin-thread-multi-2level
    /System/Library/Perl/5.8.9
    /Library/Perl/5.8.9/darwin-thread-multi-2level
    /Library/Perl/5.8.9
    /Network/Library/Perl/5.8.9/darwin-thread-multi-2level
    /Network/Library/Perl/5.8.9
    /Network/Library/Perl
    /System/Library/Perl/Extras/5.8.9/darwin-thread-multi-2level
    /System/Library/Perl/Extras/5.8.9
    /Library/Perl/5.8.8
    /Library/Perl/5.8.6
    /Library/Perl/5.8.1
    .
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;29&nbsp;06:00:57&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #73542] Crash in 5.8.9</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 29 Dec 2011 03:00:50 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Test-Simple [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2011.12.28 4:48 PM, Father Chrysostomos via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I got crashes during testing:
&gt; 
&gt; t/diag.....................................dubious                           
&gt;       Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt;       after all the subtests completed successfully
&gt; t/overload_threads.........................dubious                           
&gt;       Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt;       after all the subtests completed successfully
&gt; t/subtest/threads..........................dubious                           
&gt;       Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt;       after all the subtests completed successfully
&gt; 
&gt; Do some tests need to be skipped?
</div>
Thanks for the report.

That likely indicates it tickled a threading bug in your copy of Perl, looks
like during process shutdown.  Do they fail fairly consistently?

I&#39;m giving serious consideration to skipping threading tests for Perl &lt; 5.10.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;29&nbsp;06:00:58&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;29&nbsp;12:42:55&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 29 06:00:57 2011, schwern@pobox.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 2011.12.28 4:48 PM, Father Chrysostomos via RT wrote:
<div class="message-stanza open">&gt; &gt; I got crashes during testing:
&gt; &gt;
&gt; &gt; t/diag.....................................dubious
&gt; &gt;     Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt;     after all the subtests completed successfully
&gt; &gt; t/overload_threads.........................dubious
&gt; &gt;     Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt;     after all the subtests completed successfully
&gt; &gt; t/subtest/threads..........................dubious
&gt; &gt;     Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt;     after all the subtests completed successfully
&gt; &gt;
&gt; &gt; Do some tests need to be skipped?
</div>&gt; 
&gt; Thanks for the report.
&gt; 
&gt; That likely indicates it tickled a threading bug in your copy of Perl,
&gt; looks
&gt; like during process shutdown.  Do they fail fairly consistently?
</div>
I just ran the tests again and got exactly the same failures, so that’s two out of two.

BTW, this is the 5.8.9 that comes with Snow Leopard, so if you happen to have a 32-bit Intel 
Mac running Snow Leopard you should be able to reproduce it yourself.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I&#39;m giving serious consideration to skipping threading tests for Perl
&gt; &lt; 5.10.
</div>
That’s probably a good idea.  I’m not sure it’s even worth trying to track this down.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;29&nbsp;12:56:29&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 29 12:42:55 2011, SPROUT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Dec 29 06:00:57 2011, schwern@pobox.com wrote:
<div class="message-stanza open">&gt; &gt; On 2011.12.28 4:48 PM, Father Chrysostomos via RT wrote:
<div class="message-stanza open">&gt; &gt; &gt; I got crashes during testing:
&gt; &gt; &gt;
&gt; &gt; &gt; t/diag.....................................dubious
&gt; &gt; &gt;   Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt;   after all the subtests completed successfully
&gt; &gt; &gt; t/overload_threads.........................dubious
&gt; &gt; &gt;   Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt;   after all the subtests completed successfully
&gt; &gt; &gt; t/subtest/threads..........................dubious
&gt; &gt; &gt;   Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt;   after all the subtests completed successfully
&gt; &gt; &gt;
&gt; &gt; &gt; Do some tests need to be skipped?
</div>&gt; &gt;
&gt; &gt; Thanks for the report.
&gt; &gt;
&gt; &gt; That likely indicates it tickled a threading bug in your copy of
</div>&gt; Perl,
<div class="message-stanza open">&gt; &gt; looks
&gt; &gt; like during process shutdown.  Do they fail fairly consistently?
</div>&gt; 
&gt; I just ran the tests again and got exactly the same failures, so
&gt; that’s two out of two.
&gt; 
&gt; BTW, this is the 5.8.9 that comes with Snow Leopard, so if you happen
&gt; to have a 32-bit Intel
&gt; Mac running Snow Leopard you should be able to reproduce it yourself.
&gt; 
<div class="message-stanza open">&gt; &gt;
&gt; &gt; I&#39;m giving serious consideration to skipping threading tests for
</div>&gt; Perl
<div class="message-stanza open">&gt; &gt; &lt; 5.10.
</div>&gt; 
&gt; That’s probably a good idea.  I’m not sure it’s even worth trying to
&gt; track this down.
</div>
FYI, I get the same failure in 5.8.8, 5.10.0 and 5.10.1.  I haven’s tried 5.12+ yet.

It’s definitely worth trying to track this down. :-&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;29&nbsp;13:18:04&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 29 12:56:29 2011, SPROUT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Dec 29 12:42:55 2011, SPROUT wrote:
<div class="message-stanza open">&gt; &gt; On Thu Dec 29 06:00:57 2011, schwern@pobox.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; On 2011.12.28 4:48 PM, Father Chrysostomos via RT wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; I got crashes during testing:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; t/diag.....................................dubious
&gt; &gt; &gt; &gt;         Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt; &gt;         after all the subtests completed successfully
&gt; &gt; &gt; &gt; t/overload_threads.........................dubious
&gt; &gt; &gt; &gt;         Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt; &gt;         after all the subtests completed successfully
&gt; &gt; &gt; &gt; t/subtest/threads..........................dubious
&gt; &gt; &gt; &gt;         Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt; &gt;         after all the subtests completed successfully
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Do some tests need to be skipped?
</div>&gt; &gt; &gt;
&gt; &gt; &gt; Thanks for the report.
&gt; &gt; &gt;
&gt; &gt; &gt; That likely indicates it tickled a threading bug in your copy of
</div>&gt; &gt; Perl,
<div class="message-stanza open">&gt; &gt; &gt; looks
&gt; &gt; &gt; like during process shutdown.  Do they fail fairly consistently?
</div>&gt; &gt;
&gt; &gt; I just ran the tests again and got exactly the same failures, so
&gt; &gt; that’s two out of two.
&gt; &gt;
&gt; &gt; BTW, this is the 5.8.9 that comes with Snow Leopard, so if you
</div>&gt; happen
<div class="message-stanza open">&gt; &gt; to have a 32-bit Intel
&gt; &gt; Mac running Snow Leopard you should be able to reproduce it
</div>&gt; yourself.
<div class="message-stanza open">&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; I&#39;m giving serious consideration to skipping threading tests for
</div>&gt; &gt; Perl
<div class="message-stanza open">&gt; &gt; &gt; &lt; 5.10.
</div>&gt; &gt;
&gt; &gt; That’s probably a good idea.  I’m not sure it’s even worth trying to
&gt; &gt; track this down.
</div>&gt; 
&gt; FYI, I get the same failure in 5.8.8, 5.10.0 and 5.10.1.  I haven’s
&gt; tried 5.12+ yet.
&gt; 
&gt; It’s definitely worth trying to track this down. :-&#41;
</div>
I get the same crash with 5.12, which includes threads::shared 1.32.

I tried installing JDHEDDEN/threads-shared-1.33.tar.gz on 5.8.9 &#40;after trying 1.32&#41;, and the 
crash went away.

The changelog isn’t too helpful as to what is happening, but may it will tell you how to work 
around it:

1.33 Tue Mar  9 14:03:47 EST 2010
        - Handle shared object reference during global destruction
        - Document that changing array length via $#array doesn&#39;t work

On the other hand, maybe you should just skip those three tests, or skip loading 
threads::shared if the version is too low &#40;hmmm, bootstrapping that would be interesting; I 
suppose you would have to start a child process to output the version number&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;29&nbsp;13:19:05&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 29 13:18:04 2011, SPROUT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Dec 29 12:56:29 2011, SPROUT wrote:
<div class="message-stanza open">&gt; &gt; On Thu Dec 29 12:42:55 2011, SPROUT wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Thu Dec 29 06:00:57 2011, schwern@pobox.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; On 2011.12.28 4:48 PM, Father Chrysostomos via RT wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; I got crashes during testing:
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; t/diag.....................................dubious
&gt; &gt; &gt; &gt; &gt;       Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt; &gt; &gt;       after all the subtests completed successfully
&gt; &gt; &gt; &gt; &gt; t/overload_threads.........................dubious
&gt; &gt; &gt; &gt; &gt;       Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt; &gt; &gt;       after all the subtests completed successfully
&gt; &gt; &gt; &gt; &gt; t/subtest/threads..........................dubious
&gt; &gt; &gt; &gt; &gt;       Test returned status 0 &#40;wstat 10, 0xa&#41;
&gt; &gt; &gt; &gt; &gt;       after all the subtests completed successfully
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; Do some tests need to be skipped?
</div>&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Thanks for the report.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; That likely indicates it tickled a threading bug in your copy of
</div>&gt; &gt; &gt; Perl,
<div class="message-stanza open">&gt; &gt; &gt; &gt; looks
&gt; &gt; &gt; &gt; like during process shutdown.  Do they fail fairly consistently?
</div>&gt; &gt; &gt;
&gt; &gt; &gt; I just ran the tests again and got exactly the same failures, so
&gt; &gt; &gt; that’s two out of two.
&gt; &gt; &gt;
&gt; &gt; &gt; BTW, this is the 5.8.9 that comes with Snow Leopard, so if you
</div>&gt; &gt; happen
<div class="message-stanza open">&gt; &gt; &gt; to have a 32-bit Intel
&gt; &gt; &gt; Mac running Snow Leopard you should be able to reproduce it
</div>&gt; &gt; yourself.
<div class="message-stanza open">&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I&#39;m giving serious consideration to skipping threading tests for
</div>&gt; &gt; &gt; Perl
<div class="message-stanza open">&gt; &gt; &gt; &gt; &lt; 5.10.
</div>&gt; &gt; &gt;
&gt; &gt; &gt; That’s probably a good idea.  I’m not sure it’s even worth trying
</div></div>&gt; to
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; track this down.
</div>&gt; &gt;
&gt; &gt; FYI, I get the same failure in 5.8.8, 5.10.0 and 5.10.1.  I haven’s
&gt; &gt; tried 5.12+ yet.
&gt; &gt;
&gt; &gt; It’s definitely worth trying to track this down. :-&#41;
</div>&gt; 
&gt; I get the same crash with 5.12, which includes threads::shared 1.32.
&gt; 
&gt; I tried installing JDHEDDEN/threads-shared-1.33.tar.gz on 5.8.9 &#40;after
&gt; trying 1.32&#41;, and the
&gt; crash went away.
&gt; 
&gt; The changelog isn’t too helpful as to what is happening, but may it
&gt; will tell you how to work
&gt; around it:
&gt; 
&gt; 1.33 Tue Mar  9 14:03:47 EST 2010
&gt;         - Handle shared object reference during global destruction
&gt;         - Document that changing array length via $#array doesn&#39;t work
&gt; 
&gt; On the other hand, maybe you should just skip those three tests, or
&gt; skip loading
&gt; threads::shared if the version is too low &#40;hmmm, bootstrapping that
&gt; would be interesting; I
&gt; suppose you would have to start a child process to output the version
&gt; number&#41;.
</div>
BTW, I thought to check threads::shared, as a gdb backtrace in 5.10.1 gave me this:

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x00000008
0x001e104f in sharedsv_elem_mg_FETCH &#40;&#41;
&#40;gdb&#41; bt
#0  0x001e104f in sharedsv_elem_mg_FETCH &#40;&#41;
#1  0x0008a362 in Perl_mg_get &#40;&#41;
#2  0x000abc3b in Perl_sv_setsv_flags &#40;&#41;
#3  0x000b65d2 in Perl_sv_mortalcopy &#40;&#41;
#4  0x00098e68 in Perl_pp_helem &#40;&#41;
#5  0x0009581b in Perl_runops_standard &#40;&#41;
#6  0x00021387 in Perl_call_sv &#40;&#41;
#7  0x000ad904 in Perl_sv_clear &#40;&#41;
#8  0x000ae790 in Perl_sv_free &#40;&#41;
#9  0x000a03c9 in Perl_sv_clean_objs &#40;&#41;
#10 0x00022cf7 in perl_destruct &#40;&#41;
#11 0x00001e49 in main &#40;&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;29&nbsp;23:24:12&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #73542] Crash in 5.8.9</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 29 Dec 2011 20:23:58 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Test-Simple [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2011.12.29 10:18 AM, Father Chrysostomos via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I tried installing JDHEDDEN/threads-shared-1.33.tar.gz on 5.8.9
&gt; &#40;after trying 1.32&#41;, and the crash went away.
&gt; 
&gt; The changelog isn’t too helpful as to what is happening, but may
&gt; it will tell you how to work  around it:
&gt; 
&gt; 1.33 Tue Mar  9 14:03:47 EST 2010
&gt;         - Handle shared object reference during global destruction
</div>
Well that looks like it right there.  Thanks for the research!


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On the other hand, maybe you should just skip those three tests, or skip loading 
&gt; threads::shared if the version is too low &#40;hmmm, bootstrapping that would be
&gt; interesting; I suppose you would have to start a child process to output the
&gt; version number&#41;.
</div>
I could screw around with a DESTROY method to try and chop bits off of objects
in a way that will please threads::shared... but if 1.33 fixes it I can add a
&#34;recommends&#34; dependency on it.

As for skipping, the simplicity of TAP makes it easy.

    use threads;  # ignoring the check for threads support for clarity
    use threads::shared;

    BEGIN {
        if&#40; $threads::shared::VERSION &lt; 1.33 &#41; {
            print &#34;1..0 SKIP # threads shared 1.33 or greater required for
stable threads\n&#34;;
            exit 0;
        }
    }

    use Test::More;


-- 
Stabbing you in the face so you don&#39;t have to.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;28&nbsp;15:56:08&nbsp;2016</span>
    <span class="description">exodist7 [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is files against a dead branch of Test-Simple, closing.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;28&nbsp;15:56:13&nbsp;2016</span>
    <span class="description">exodist7 [...] gmail.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
