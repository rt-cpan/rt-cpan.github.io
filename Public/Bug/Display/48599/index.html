<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #48599 for Perl-Dist-WiX: Strawverry MSI of July 2009 is SLOOOW</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #48599 for Perl-Dist-WiX: Strawverry MSI of July 2009 is SLOOOW</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Dist-WiX/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Dist-WiX/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Dist-WiX/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Dist-WiX/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Dist-WiX">Perl-Dist-WiX CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">48599</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Dist-WiX/Active/">Perl-Dist-WiX</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
matthew.persico [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-226206-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-226207-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;10&nbsp;14:40:31&nbsp;2009</span>
    <span class="description">matthew.persico [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Strawverry MSI of July 2009 is SLOOOW</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 Aug 2009 14:40:01 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-WiX [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Matthew Persico &lt;matthew.persico [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The calc&#39;ing space component took four minutes. And a Vista UAC
authorization box popped up inthe middle. I thought that would have
popped up at the start.

Once installation began, it looks like it took only 30 seconds to complete

Are there tunable portions of the MSi you can adjust to give better
indication of what&#39;s really going on?

Are there tests I can perform for you to help with diagnosis?

-- 
Matthew O. Persico
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;10&nbsp;15:14:28&nbsp;2009</span>
    <span class="description">csjewell [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Strawberry MSI of July 2009 is SLOOOW</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 10 14:40:31 2009, matthew.persico@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The calc&#39;ing space component took four minutes. And a Vista UAC
&gt; authorization box popped up inthe middle. I thought that would have
&gt; popped up at the start.
&gt; 
&gt; Once installation began, it looks like it took only 30 seconds to complete
&gt; 
&gt; Are there tunable portions of the MSi you can adjust to give better
&gt; indication of what&#39;s really going on?
&gt; 
&gt; Are there tests I can perform for you to help with diagnosis?
</div>
I do need a few questions answered. They&#39;re within *xxx*.

I&#39;ll explain why the questions as well.

The &#39;calculating space&#39;: *Were you installing over a previous version of
Strawberry or were there leftover files?* If anything was left over in
the Strawberry directory, then it needs to check if the files are the
same, and that&#39;s what takes multiple minutes on install. It goes a lot
faster when the directory is cleared. There is a similar problem during
the uninstall &#40;see below&#41;, but I&#39;ll have to ask about what to do on
install, as that&#39;s a basic Windows Installer action. I may or may not be
able to do anything about it.

Note that when the new version of Strawberry is uninstalled or upgraded,
it cleans up after itself &#40;which I know is slow in and of itself, and I
plan to give more feedback in the October 2009 version, as I write the
code for that myself - can&#39;t make it faster, really, but feedback is
good&#41; so that this problem will only exist on install when upgrading
from non-MSI versions.

As for the UAC box: Apparently it doesn&#39;t grab administrator rights
until it needs them &#40;good programming practice, but makes for a clumsy
UI for UAC-enabled Windows versions.&#41; When I tried the MSI on the test
VM&#39;s, the &#34;Install&#34; button after the license screen had the UAC shield
on it, and it asked when that button was clicked. *Was that your
experience?*

I&#39;ll ask and see if there is a way that I can set the UAC check earlier
in the mailing list.

--Curtis
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;10&nbsp;15:14:28&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;10&nbsp;16:38:20&nbsp;2009</span>
    <span class="description">matthew.persico [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48599] Strawberry MSI of July 2009 is SLOOOW</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 Aug 2009 16:37:58 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-WiX [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Matthew Persico &lt;matthew.persico [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Aug 10, 2009 at 3:14 PM, Curtis Jewell via
RT&lt;bug-Perl-Dist-WiX@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=48599">https://rt.cpan.org/Ticket/Display.html?id=48599</a></span> &gt;
&gt;
&gt; On Mon Aug 10 14:40:31 2009, matthew.persico@gmail.com wrote:
<div class="message-stanza open">&gt;&gt; The calc&#39;ing space component took four minutes. And a Vista UAC
&gt;&gt; authorization box popped up inthe middle. I thought that would have
&gt;&gt; popped up at the start.
&gt;&gt;
&gt;&gt; Once installation began, it looks like it took only 30 seconds to complete
&gt;&gt;
&gt;&gt; Are there tunable portions of the MSi you can adjust to give better
&gt;&gt; indication of what&#39;s really going on?
&gt;&gt;
&gt;&gt; Are there tests I can perform for you to help with diagnosis?
</div>&gt;
&gt; I do need a few questions answered. They&#39;re within *xxx*.
&gt;
&gt; I&#39;ll explain why the questions as well.
&gt;
&gt; The &#39;calculating space&#39;: *Were you installing over a previous version of
&gt; Strawberry or were there leftover files?* If anything was left over in
&gt; the Strawberry directory, then it needs to check if the files are the
&gt; same, and that&#39;s what takes multiple minutes on install. It goes a lot
&gt; faster when the directory is cleared. There is a similar problem during
&gt; the uninstall &#40;see below&#41;, but I&#39;ll have to ask about what to do on
&gt; install, as that&#39;s a basic Windows Installer action. I may or may not be
&gt; able to do anything about it.
</div>
Yes, I was installing over a previous version of April 2009 which may
NOT have been MSI-installed. Slowness explained.

If you could config the message to be something like &#34;Comparing old
and new files to see which to install...&#34; instead of the generic
&#34;Calculating space requirements&#34;, that would be a big help. After all,
if I know how big my files are and I get the free space on the disk,
that&#39;s under a one second calc! Since that is not what you are doing,
it&#39;s misleading.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Note that when the new version of Strawberry is uninstalled or upgraded,
&gt; it cleans up after itself &#40;which I know is slow in and of itself, and I
&gt; plan to give more feedback in the October 2009 version, as I write the
&gt; code for that myself - can&#39;t make it faster, really, but feedback is
&gt; good&#41; so that this problem will only exist on install when upgrading
&gt; from non-MSI versions.
</div>
Feedback is all that&#39;s really needed. If a scrolling list of files was
flying by, I never would have complained. Total install time of five
minutes is ok, but when the thing is thrashing the disk with no
indication - it worries you!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; As for the UAC box: Apparently it doesn&#39;t grab administrator rights
&gt; until it needs them &#40;good programming practice, but makes for a clumsy
&gt; UI for UAC-enabled Windows versions.&#41; When I tried the MSI on the test
&gt; VM&#39;s, the &#34;Install&#34; button after the license screen had the UAC shield
&gt; on it, and it asked when that button was clicked. *Was that your
&gt; experience?*
</div>
Yes. That&#39;s ok - just wanted to make sure it was the expected behavior
- most msi-s grab rights as soon as possible.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; I&#39;ll ask and see if there is a way that I can set the UAC check earlier
&gt; in the mailing list.
</div>
No, leave it be...Your practice IS the better one.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; --Curtis
&gt;
</div>


-- 
Matthew O. Persico
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
