<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76929 for IO-Socket-SSL: strengthening server SSL</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76929 for IO-Socket-SSL: strengthening server SSL</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Socket-SSL">IO-Socket-SSL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76929</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/IO-Socket-SSL/Active/">IO-Socket-SSL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
d.thomas [...] its.uq.edu.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-17228-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.62    </td>
  </tr>
  <tr id="CF-17229-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;01&nbsp;18:51:55&nbsp;2012</span>
    <span class="description">d.thomas [...] its.uq.edu.au -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> strengthening server SSL</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I recently made use of the SSL Pulse tool to report on some of
our https servers. Most of these are apache but I did test
Mojolicious which is a perl event-based server making use of
IO::Socket::SSL.

Before I mention the specific items reported, would it make
sense for the IO::Socket::SSL docs to include a section mentioning
configuration items that could improve security ?
Perhaps one section for client and another for server.
It&#39;s the latter I&#39;m most interested in.

Then again maybe there&#39;s some debate about the significance
of what they choose to report.

Rather than change current defaults or have other authors
setting up options, maybe you could add something like:
  use_more_secure_server_defaults
That&#39;s if you were happy accepting that responsibility.
One advantage of providing such functionality could be
if the best options needed to be based on the openssl
version/capabilities.


So on RHEL5 with OpenSSL 0.9.8e-fips-rhel5 01 Jul 2008.
perl 5.14.2, IO::Socket::SSL 1.62, Net::SSLeay 1.47,
Mojolicious 2.8.5
<span class="clickylink"><a target="new" rel="nofollow" href="https://www.ssllabs.com/ssltest/analyze.html?d=mojo-ssl-test.its.uq.edu.au">https://www.ssllabs.com/ssltest/analyze.html?d=mojo-ssl-test.its.uq.edu.au</a></span>
  TLS 1.2        No
  TLS 1.1        No
  SSL 2.0   INSECURE
  SSL_RC4_128_EXPORT40_WITH_MD5 &#40;0x20080&#41;   WEAK
  SSL_RC2_128_CBC_EXPORT40_WITH_MD5 &#40;0x40080&#41;   WEAK
  SSL_DES_64_CBC_WITH_MD5 &#40;0x60040&#41;   WEAK
  TLS_RSA_WITH_DES_CBC_SHA &#40;0x9&#41;   WEAK
  Session resumption    No &#40;IDs assigned but not accepted&#41;
  BEAST attack  Vulnerable   INSECURE &#40;more info&#41;
  Secure Renegotiation  Supported, with client-initiated renegotiation enabled   DoS 
DANGER &#40;more info&#41;
The first 2 slightly reduce the rating but are not considered
significant because a lot of deployed software doesn&#39;t
support versions of TLS past 1.0

The WEAK ciphers were removed by adding this to mojolicious
  SSL_cipher_list =&gt; &#39;ALL:!LOW:!EXP:!ADH&#39;,
  taken from IO::Socket::SSL docs

However attempts to remove SSLv2 by trying things like this
in the options mojolicious uses
  SSL_version =&gt; &#39;SSLv3&#39;,
  SSL_version =&gt; &#39;TLSv1&#39;,
  SSL_version =&gt; &#39;SSLv3 TLSv1&#39;,
  SSL_version =&gt; &#39;!SSLv2,SSLv3,TLSv1&#39;, # based on OpenSSL docs
didn&#39;t work. In fact the first 2 resulted in the mojolicious
server not responding to https. That could be a problem with
that software, but is there some way to be as flexible with
SSL_version as openssl itself is, as is the case with 
SSL_cipher_list ?
If that was the case you could use something like
  SSL_version =&gt; &#39;-ALL -SSLv2 +SSLv3 +TLSv1&#39;

However I think 
  Session resumption
  BEAST attack
  Secure Renegotiation
need low-level access and I&#39;m not sure Net::SSLeay provides all
of these, e.g. BEAST mitigation requires the server to use
it&#39;s cipher order rather than what client offers.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;02&nbsp;19:45:34&nbsp;2012</span>
    <span class="description">d.thomas [...] its.uq.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> d.thomas [...] its.uq.edu.au</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However I think
&gt;   Session resumption
</div>just to show my ignorance, on apache this
becomes enabled by
  SSLSessionCache shm:/var/tmp/ssl_gcache_data&#40;512000&#41;
which allows the processes to share SSL
session info. So this is really something in
the application rather than SSL
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;05:45:22&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However attempts to remove SSLv2 by trying things like this
&gt; in the options mojolicious uses
&gt;   SSL_version =&gt; &#39;SSLv3&#39;,
&gt;   SSL_version =&gt; &#39;TLSv1&#39;,
&gt;   SSL_version =&gt; &#39;SSLv3 TLSv1&#39;,
&gt;   SSL_version =&gt; &#39;!SSLv2,SSLv3,TLSv1&#39;, # based on OpenSSL docs
&gt; didn&#39;t work. In fact the first 2 resulted in the mojolicious
&gt; server not responding to https. That could be a problem with
&gt; that software, but is there some way to be as flexible with
&gt; SSL_version as openssl itself is, as is the case with
&gt; SSL_cipher_list ?
&gt; If that was the case you could use something like
&gt;   SSL_version =&gt; &#39;-ALL -SSLv2 +SSLv3 +TLSv1&#39;
</div>
they key is to use SSL_cipher_list.
I made the default for 1.67 now to ALL:!LOW which gives me a good
picture with SSL pulse.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   BEAST attack
</div>
I&#39;ve added a new configuration key SSL_honor_cipher_order which can be
used to mitigate
BEAST attack. Example is in the documentation.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   Session resumption
&gt;   Secure Renegotiation
</div>
I will look into these later
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;05:45:23&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;07:31:10&nbsp;2012</span>
    <span class="description">paul [...] city-fan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> paul [...] city-fan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon May 07 05:45:22 2012, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; However attempts to remove SSLv2 by trying things like this
&gt; &gt; in the options mojolicious uses
&gt; &gt;   SSL_version =&gt; &#39;SSLv3&#39;,
&gt; &gt;   SSL_version =&gt; &#39;TLSv1&#39;,
&gt; &gt;   SSL_version =&gt; &#39;SSLv3 TLSv1&#39;,
&gt; &gt;   SSL_version =&gt; &#39;!SSLv2,SSLv3,TLSv1&#39;, # based on OpenSSL docs
&gt; &gt; didn&#39;t work. In fact the first 2 resulted in the mojolicious
&gt; &gt; server not responding to https. That could be a problem with
&gt; &gt; that software, but is there some way to be as flexible with
&gt; &gt; SSL_version as openssl itself is, as is the case with
&gt; &gt; SSL_cipher_list ?
&gt; &gt; If that was the case you could use something like
&gt; &gt;   SSL_version =&gt; &#39;-ALL -SSLv2 +SSLv3 +TLSv1&#39;
</div>&gt; 
&gt; they key is to use SSL_cipher_list.
&gt; I made the default for 1.67 now to ALL:!LOW which gives me a good
&gt; picture with SSL pulse.
</div>
The changes in 1.67 appear to have broken t/dhe.t and t/npn.t with
openssl 1.0.1 &#40;attached build log is with 1.0.1b&#41;.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> build.log</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;09:03:37&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; The changes in 1.67 appear to have broken t/dhe.t and t/npn.t with
&gt; openssl 1.0.1 &#40;attached build log is with 1.0.1b&#41;.
</div>
Thanks for reporting.
After disabling SSLv2 in default cipher list also it seems to work again.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;14:54:19&nbsp;2012</span>
    <span class="description">paul [...] city-fan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> paul [...] city-fan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon May 07 09:03:37 2012, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; The changes in 1.67 appear to have broken t/dhe.t and t/npn.t with
&gt; &gt; openssl 1.0.1 &#40;attached build log is with 1.0.1b&#41;.
</div>&gt; 
&gt; Thanks for reporting.
&gt; After disabling SSLv2 in default cipher list also it seems to work again.
</div>
t/dhe.t still not working but restoring the fix from RT#75165 &#40;attached&#41;
fixes it for me.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> IO-Socket-SSL-1.68-dhe.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- t/dhe.t
+++ t/dhe.t
@@ -32,6 +32,11 @@
     SSL_cert_file =&gt; &#34;certs/server-rsa384-dh.pem&#34;,
     SSL_key_file  =&gt; &#34;certs/server-rsa384-dh.pem&#34;,
     SSL_dh_file   =&gt; &#34;certs/server-rsa384-dh.pem&#34;,
+    # openssl 1.0.1&#40;beta2&#41; complains about the rsa key too small, unless
+    # we explicitly set version to tlsv1 or sslv3
+    # unfortunatly the workaround fails for older openssl versions :&#40;
+    &#40;Net::SSLeay::OPENSSL_VERSION_NUMBER&#40;&#41; &gt;= 0x10001000&#41;
+        ? &#40; SSL_version   =&gt; &#39;tlsv1&#39; &#41;:&#40;&#41;
 &#41; || do {
     notok&#40;$!&#41;;
     exit
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;15:11:28&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 7 May 2012 21:11:12 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;paul [...] city-fan.org via RT&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Ullrich &lt;Steffen_Ullrich [...] genua.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Thanks for reporting.
&gt; &gt; After disabling SSLv2 in default cipher list also it seems to work again.
</div>&gt; 
&gt; t/dhe.t still not working but restoring the fix from RT#75165 &#40;attached&#41;
&gt; fixes it for me.
</div>
strange.
But this fix seems to make problems for others, so I was happy to get rid of it.
It looks like that it depends somehow on the openssl built options.
I did a built on linux with default settings and it works for me &#40;openssl 1.01 
release&#41;, what are your settings?

Regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;15:43:50&nbsp;2012</span>
    <span class="description">paul [...] city-fan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> paul [...] city-fan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon May 07 15:11:28 2012, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; Thanks for reporting.
&gt; &gt; &gt; After disabling SSLv2 in default cipher list also it seems to work
</div></div>&gt; again.
<div class="message-stanza open">&gt; &gt;
&gt; &gt; t/dhe.t still not working but restoring the fix from RT#75165
</div>&gt; &#40;attached&#41;
<div class="message-stanza open">&gt; &gt; fixes it for me.
</div>&gt; 
&gt; strange.
&gt; But this fix seems to make problems for others, so I was happy to get
&gt; rid of it.
&gt; It looks like that it depends somehow on the openssl built options.
&gt; I did a built on linux with default settings and it works for me
&gt; &#40;openssl 1.01 release&#41;, what are your settings?
</div>
It&#39;s the Fedora Rawhide build, whcih is quite heavily patched:
<span class="clickylink"><a target="new" rel="nofollow" href="http://pkgs.fedoraproject.org/gitweb/?p=openssl.git;a=tree">http://pkgs.fedoraproject.org/gitweb/?p=openssl.git;a=tree</a></span>
&#40;the build process is contained in the openssl.spec file&#41;.

Here&#39;s the ciphers list:
$ openssl ciphers
DHE-DSS-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA256:DHE-RSA-AES256-SHA:DHE-DSS-AES256-SHA:DHE-RSA-CAMELLIA256-SHA:DHE-DSS-CAMELLIA256-SHA:AES256-GCM-SHA384:AES256-SHA256:AES256-SHA:CAMELLIA256-SHA:PSK-AES256-CBC-SHA:EDH-RSA-DES-CBC3-SHA:EDH-DSS-DES-CBC3-SHA:DES-CBC3-SHA:PSK-3DES-EDE-CBC-SHA:KRB5-DES-CBC3-SHA:KRB5-DES-CBC3-MD5:DHE-DSS-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-SHA256:DHE-DSS-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA:DHE-RSA-SEED-SHA:DHE-DSS-SEED-SHA:DHE-RSA-CAMELLIA128-SHA:DHE-DSS-CAMELLIA128-SHA:AES128-GCM-SHA256:AES128-SHA256:AES128-SHA:SEED-SHA:CAMELLIA128-SHA:IDEA-CBC-SHA:PSK-AES128-CBC-SHA:KRB5-IDEA-CBC-SHA:KRB5-IDEA-CBC-MD5:RC4-SHA:RC4-MD5:PSK-RC4-SHA:KRB5-RC4-SHA:KRB5-RC4-MD5:EDH-RSA-DES-CBC-SHA:EDH-DSS-DES-CBC-SHA:DES-CBC-SHA:KRB5-DES-CBC-SHA:KRB5-DES-CBC-MD5:EXP-EDH-RSA-DES-CBC-SHA:EXP-EDH-DSS-DES-CBC-SHA:EXP-DES-CBC-SHA:EXP-RC2-CBC-MD5:EXP-KRB5-RC2-CBC-SHA:EXP-KRB5-DES-CBC-SHA:EXP-KRB5-RC2-CBC-MD5:EXP-KRB5-DES-CBC-MD5:EXP-RC4-MD5:EXP-KRB5-RC4-SHA:EXP-KRB5-RC4-MD5
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;07&nbsp;17:28:10&nbsp;2012</span>
    <span class="description">d.thomas [...] its.uq.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 7 May 2012 21:27:56 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;&lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Danny Thomas &lt;d.thomas [...] its.uq.edu.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">have just tried 1.68


On 07/05/2012, at 7:45 PM, Steffen Ullrich via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;  BEAST attack
</div>&gt; 
&gt; I&#39;ve added a new configuration key SSL_honor_cipher_order which can be
&gt; used to mitigate BEAST attack. Example is in the documentation.
</div>works for me


the example for SSL_honor_cipher_order
  SSL_cipher_list =&gt; &#39;RC4-SHA:ALL:!ADH:!LOW&#39;,
I think this is OK but it&#39;s better to put the negated
items first so they can never get used


Previously reported that setting SSL_version did not
work. It&#39;s possible this happened because the cipher
list at that time did not include any ciphers the
protocol could use.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;v1.68 2012.05.07
&gt;- remove SSLv2 from default cipher list
</div>Currently not setting SSL_version still seems to 
have SSLv2 enabled as reported by SSL Pulse
  SSL 2.0       Yes N
  &#40;*&#41; N next to protocol version means the protocol has no cipher suites enabled

NB in this case the &#34;N&#34; comes from the list suggested
by our local expert explicitly excluding SSLv2 ciphers
  &#39;!aNULL:!eNULL:!EXPORT:!DSS:!DES:!SSLv2:!LOW:RC4-SHA:RC4-MD5:ALL&#39;


SSLv2 disappears completely from the report when I use
  SSL_version =&gt; &#39;SSLv3&#39;,
but that also means TLSv1.0 not offered which decreases
score by 5, see my posting
  <span class="clickylink"><a target="new" rel="nofollow" href="https://community.qualys.com/message/14184">https://community.qualys.com/message/14184</a></span>
and in any case for now I would like SSLv3 AND TLSv1.0.


thanks
Danny


FYI from the author of Net::SSLeay

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; and Secure Renegotiation with Net::SSLeay, because I have
&gt;&gt; another app that uses those features.
</div>&gt; 
&gt; how do you do that, i.e. disable client-initiated renegotiation
</div>
There are a few options that are relevant:
SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION 
SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;02:05:51&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 8 May 2012 08:05:25 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;d.thomas [...] its.uq.edu.au via RT&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Ullrich &lt;Steffen_Ullrich [...] genua.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; the example for SSL_honor_cipher_order
&gt;   SSL_cipher_list =&gt; &#39;RC4-SHA:ALL:!ADH:!LOW&#39;,
&gt; I think this is OK but it&#39;s better to put the negated
&gt; items first so they can never get used
</div>
If I understand <span class="clickylink"><a target="new" rel="nofollow" href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_STRINGS">http://www.openssl.org/docs/apps/ciphers.html#CIPHER_STRINGS</a></span>
right the order does not matter for the &#34;!&#34; modifier. Otherwise things
like ALL:!LOW would not work &#40;but they do&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Previously reported that setting SSL_version did not
&gt; work. It&#39;s possible this happened because the cipher
&gt; list at that time did not include any ciphers the
&gt; protocol could use.
</div>
SSL_version is not the same as SSL_cipher_list and can not be 
a combination of multiple versions, so only SSLv3, SSLv2 or
TLSv1 can be specified &#40;this is documented this way&#41;.
All what it does is to create an SSL_context so that it will only
speak the specified version and nothing else, see 
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.openssl.org/docs/ssl/SSL_CTX_new.html">http://www.openssl.org/docs/ssl/SSL_CTX_new.html</a></span>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;v1.68 2012.05.07
&gt; &gt;- remove SSLv2 from default cipher list
</div>&gt; Currently not setting SSL_version still seems to 
&gt; have SSLv2 enabled as reported by SSL Pulse
&gt;   SSL 2.0     Yes N
&gt;   &#40;*&#41; N next to protocol version means the protocol has no cipher suites enabled
</div>
I don&#39;t get this with my tests, I get &#34;SSL 2.0 No&#34;, but 
&#34;SSL 2.0+ upgrade support YES&#34;. 
I don&#39;t know why you get something else, maybe it depends on
the used openssl version.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; NB in this case the &#34;N&#34; comes from the list suggested
&gt; by our local expert explicitly excluding SSLv2 ciphers
&gt;   &#39;!aNULL:!eNULL:!EXPORT:!DSS:!DES:!SSLv2:!LOW:RC4-SHA:RC4-MD5:ALL&#39;
&gt; 
&gt; 
&gt; SSLv2 disappears completely from the report when I use
&gt;   SSL_version =&gt; &#39;SSLv3&#39;,
&gt; but that also means TLSv1.0 not offered which decreases
&gt; score by 5, see my posting
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="https://community.qualys.com/message/14184">https://community.qualys.com/message/14184</a></span>
&gt; and in any case for now I would like SSLv3 AND TLSv1.0.
</div>
SSLv2 is more than just ciphers.
I think it is quite common to be able to speak the SSLv2 base
protocol but don&#39;t offer SSLv2 ciphers and then upgrade the
protocol. This is &#34;SSL 2.0+ upgrade support&#34; and even sslabs.com
itself offers it.

But yes, SSL isn&#39;t easy to understand and the OpenSSL documentation
might profite from improvements too :&#41;

Regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;03:09:32&nbsp;2012</span>
    <span class="description">d.thomas [...] its.uq.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 8 May 2012 07:09:06 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;&lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Danny Thomas &lt;d.thomas [...] its.uq.edu.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 08/05/2012, at 4:05 PM, Steffen Ullrich via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If I understand <span class="clickylink"><a target="new" rel="nofollow" href="http://www.openssl.org/docs/apps/ciphers.html#CIPHER_STRINGS">http://www.openssl.org/docs/apps/ciphers.html#CIPHER_STRINGS</a></span>
&gt; right the order does not matter for the &#34;!&#34; modifier. Otherwise things
&gt; like ALL:!LOW would not work &#40;but they do&#41;.
</div>I thought wrong


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; SSL_version is not the same as SSL_cipher_list and can not be 
&gt; a combination of multiple versions, so only SSLv3, SSLv2 or
&gt; TLSv1 can be specified &#40;this is documented this way&#41;.
&gt; All what it does is to create an SSL_context so that it will only
&gt; speak the specified version and nothing else, see 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.openssl.org/docs/ssl/SSL_CTX_new.html">http://www.openssl.org/docs/ssl/SSL_CTX_new.html</a></span>
</div>I had noticed the regex being used to choose a context so
couldn&#39;t understand how you&#39;d be able to support multiple
protocols. Things make a bit more sense now

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.openssl.org/docs/ssl/SSL_CTX_new.html">http://www.openssl.org/docs/ssl/SSL_CTX_new.html</a></span>
------------------------------------------------
SSLv23_method&#40;void&#41;, SSLv23_server_method&#40;void&#41;, SSLv23_client_method&#40;void&#41;
A TLS/SSL connection established with these methods will understand the SSLv2, SSLv3, and TLSv1 protocol. A client will send out SSLv2 client hello messages and will indicate that it also understands SSLv3 and TLSv1. A server will understand SSLv2, SSLv3, and TLSv1 client hello messages. This is the best choice when compatibility is a concern.

The list of protocols available can later be limited using the SSL_OP_NO_SSLv2, SSL_OP_NO_SSLv3, SSL_OP_NO_TLSv1 options of the SSL_CTX_set_options&#40;&#41; or SSL_set_options&#40;&#41; functions. Using these options it is possible to choose e.g. SSLv23_server_method&#40;&#41; and be able to negotiate with all possible clients, but to only allow newer protocols like SSLv3 or TLSv1.
------------------------------------------------

so I think we want to keep the default SSLv23_method for SSL_version
but apply
  CTX_set_options&#40;SSL_OP_NO_SSLv2&#41;
similar to what was just added
  Net::SSLeay::CTX_set_options&#40;$ctx, Net::SSLeay::OP_ALL&#40;&#41;&#41;;
  if &#40; $arg_hash-&gt;{SSL_honor_cipher_order} &#41; {
    Net::SSLeay::CTX_set_options&#40;$ctx, 0x00400000&#41;;
  }

but not sure how that would appear in API




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt;&gt;&gt; v1.68 2012.05.07
&gt;&gt;&gt; - remove SSLv2 from default cipher list
</div>&gt;&gt; Currently not setting SSL_version still seems to 
&gt;&gt; have SSLv2 enabled as reported by SSL Pulse
&gt;&gt;  SSL 2.0     Yes N
&gt;&gt;  &#40;*&#41; N next to protocol version means the protocol has no cipher suites enabled
</div>&gt; 
&gt; I don&#39;t get this with my tests, I get &#34;SSL 2.0 No&#34;, but 
&gt; &#34;SSL 2.0+ upgrade support YES&#34;. 
&gt; I don&#39;t know why you get something else, maybe it depends on
&gt; the used openssl version.
</div>could be but that&#39;s another reason I want to
be sure I&#39;m really disabling SSLv2



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; SSLv2 is more than just ciphers.
&gt; I think it is quite common to be able to speak the SSLv2 base
&gt; protocol but don&#39;t offer SSLv2 ciphers and then upgrade the
&gt; protocol. This is &#34;SSL 2.0+ upgrade support&#34; and even sslabs.com
&gt; itself offers it.
</div>excluding the SSLv2 ciphers when supporting SSLv2 protocol
is treated by ssllabs as being safe. I think this is useful
when you can&#39;t be sure you&#39;ve disabled the SSLv2 protocol


Danny
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;04:25:58&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 8 May 2012 10:25:31 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;paul [...] city-fan.org via RT&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Ullrich &lt;Steffen_Ullrich [...] genua.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; t/dhe.t still not working but restoring the fix from RT#75165
</div>&gt; &gt; &#40;attached&#41;
<div class="message-stanza open">&gt; &gt; &gt; fixes it for me.
</div></div>
I&#39;ve reenabled the fix in 1.69.
Thanks,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;05:24:02&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 8 May 2012 11:23:41 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;d.thomas [...] its.uq.edu.au via RT&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Ullrich &lt;Steffen_Ullrich [...] genua.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; so I think we want to keep the default SSLv23_method for SSL_version
&gt; but apply
&gt;   CTX_set_options&#40;SSL_OP_NO_SSLv2&#41;
&gt; similar to what was just added
&gt;   Net::SSLeay::CTX_set_options&#40;$ctx, Net::SSLeay::OP_ALL&#40;&#41;&#41;;
&gt;   if &#40; $arg_hash-&gt;{SSL_honor_cipher_order} &#41; {
&gt;     Net::SSLeay::CTX_set_options&#40;$ctx, 0x00400000&#41;;
&gt;   }
&gt; 
&gt; but not sure how that would appear in API
</div>
with 1.70 you should now be able to set SSL_version to &#39;SSLv23:!SSLv2&#39;
&#40;which is now the default&#41;, so that it can talk SSLv2, SSLv3 and TLSv1
during the initial handshake but will not commit to SSLv2, so that the
peer needs to speak SSLv3 or TLSv1.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;13:32:58&nbsp;2012</span>
    <span class="description">paul [...] city-fan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> paul [...] city-fan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue May 08 04:25:58 2012, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; t/dhe.t still not working but restoring the fix from RT#75165
</div>&gt; &gt; &gt; &#40;attached&#41;
<div class="message-stanza open">&gt; &gt; &gt; &gt; fixes it for me.
</div></div>&gt; 
&gt; I&#39;ve reenabled the fix in 1.69.
</div>
Works for me, thanks &#40;1.70 too&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;19:03:44&nbsp;2012</span>
    <span class="description">d.thomas [...] its.uq.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;behroozi [...] www.pls.uni.edu&#34; &lt;behroozi [...] www.pls.uni.edu&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 8 May 2012 23:03:28 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;&lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Danny Thomas &lt;d.thomas [...] its.uq.edu.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 08/05/2012, at 7:24 PM, Steffen Ullrich via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; with 1.70 you should now be able to set SSL_version to &#39;SSLv23:!SSLv2&#39;
&gt; &#40;which is now the default&#41;, so that it can talk SSLv2, SSLv3 and TLSv1
&gt; during the initial handshake but will not commit to SSLv2, so that the
&gt; peer needs to speak SSLv3 or TLSv1.
</div>just tried 1.70

out of box reported
  SSL v2.0  Yes N
  BEAST vulnerable

adding these to Mojolicious
  SSL_version =&gt; &#39;SSLv23:!SSLv2&#39;,
  SSL_cipher_list =&gt; &#39;!aNULL:!eNULL:!EXPORT:!DSS:!DES:!SSLv2:!LOW:RC4-SHA:RC4-MD5:ALL&#39;,
  SSL_honor_cipher_order =&gt; 1,
only removed BEAST vulnerability &#40;as well as adding 2 extra ciphers&#41;



however SSLv2 was disabled by changing
  Net::SSLeay::CTX_set_options&#40;$ctx, Net::SSLeay::OP_ALL&#40;&#41; &#38; ! $disable_ver &#41;;
to
  Net::SSLeay::CTX_set_options&#40;$ctx, 0x01000000&#41;;
or
  Net::SSLeay::CTX_set_options&#40;$ctx, $disable_ver &#41; if $disable_ver;


Danny


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I don&#39;t know why you get something else, maybe it depends on
&gt; the used openssl version.
</div>also some people, probably an increasing number, build
openssl without SSLv2 at all. I doubt that&#39;s the case on
RHEL5 unless RedHat did this in a patch.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;09&nbsp;04:42:16&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 9 May 2012 10:41:54 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;d.thomas [...] its.uq.edu.au via RT&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Ullrich &lt;Steffen_Ullrich [...] genua.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
issue should be fixed with 1.71.
I tested it was various OpenSSL versions.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; just tried 1.70
&gt; 
&gt; out of box reported
&gt;   SSL v2.0  Yes N
&gt;   BEAST vulnerable
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;09&nbsp;17:22:42&nbsp;2012</span>
    <span class="description">d.thomas [...] its.uq.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 9 May 2012 21:22:21 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;&lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Danny Thomas &lt;d.thomas [...] its.uq.edu.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 09/05/2012, at 6:42 PM, Steffen Ullrich via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; issue should be fixed with 1.71.
</div>unfortunately not


let&#39;s see exactly what options are set
---------------------------------------------------
open my $fh99, &#34;&gt;/tmp/ctx.options&#34;  or  die &#34;ctx.options $!&#34;;
printf $fh99 &#34;after context init: options 0x%08x\n&#34;, Net::SSLeay::CTX_get_options&#40;$ctx&#41;;

        Net::SSLeay::CTX_set_options&#40;$ctx, Net::SSLeay::OP_ALL&#40;&#41; | $disable_ver &#41;;
printf $fh99 &#34;after disable_ver: options 0x%08x\n&#34;, Net::SSLeay::CTX_get_options&#40;$ctx&#41;;
        if &#40; $arg_hash-&gt;{SSL_honor_cipher_order} &#41; {
            Net::SSLeay::CTX_set_options&#40;$ctx, 0x00400000&#41;;
        }
printf $fh99 &#34;after &#40;possible&#41; SSL_honor_cipher_order: options 0x%08x\n&#34;, Net::SSLeay::CTX_get_options&#40;$ctx&#41;;
close $fh99;



straight 1.71, Mojolicious uses its default options
---------------------------------------------------
after context init: options 0x00000004
  SSL_OP_LEGACY_SERVER_CONNECT
after disable_ver: options 0x01000ff7
  SSL_OP_ALL - SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG, i.e.
    SSL_OP_MICROSOFT_SESS_ID_BUG
    SSL_OP_NETSCAPE_CHALLENGE_BUG
    SSL_OP_LEGACY_SERVER_CONNECT
    SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG
    SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER
    SSL_OP_MSIE_SSLV2_RSA_PADDING
    SSL_OP_SSLEAY_080_CLIENT_DH_BUG
    SSL_OP_TLS_D5_BUG
    SSL_OP_TLS_BLOCK_PADDING_BUG
    SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
    SSL_OP_NO_SSLv2
after &#40;possible&#41; SSL_honor_cipher_order: options 0x01000ff7
  &lt;no-change&gt;

SSL Pulse reports
  TLS 1.0: Yes  &#40;just FYI&#41;
  SSL 3.0: Yes  &#40;just FYI&#41;
  SSL 2.0: No
  BEAST attack: Vulnerable
The vulnerability happens because there are no RC4 ciphers from
  use constant DEFAULT_CIPHER_LIST =&gt; &#39;HIGH:!LOW&#39;;
at least in RHEL5 openssl. The report lists 3 ciphers all of
them CBC which are the ones vulnerable; RC4 must be there &#38; first
  TLS_RSA_WITH_AES_256_CBC_SHA
  TLS_RSA_WITH_AES_128_CBC_SHA
  TLS_RSA_WITH_3DES_EDE_CBC_SHA




set SSL_honor_cipher_order in Mojolicious
---------------------------------------------------
after context init: options 0x00000004
  &lt;as-originally&gt;
after disable_ver: options 0x01000ff7
  &lt;as-originally&gt;
after &#40;possible&#41; SSL_honor_cipher_order: options 0x01400ff7
  +SSL_OP_CIPHER_SERVER_PREFERENCE

SSL Pulse reports
  TLS 1.0: Yes  &#40;just FYI&#41;
  SSL 3.0: Yes  &#40;just FYI&#41;
  SSL 2.0: No
  BEAST attack: Vulnerable




set SSL_honor_cipher_order in Mojolicious
from <span class="clickylink"><a target="new" rel="nofollow" href="https://community.qualys.com/message/12570">https://community.qualys.com/message/12570</a></span>
DEFAULT_CIPHER_LIST =&gt; &#39;RC4-SHA:HIGH:!ADH&#39;;
---------------------------------------------------
after context init: options 0x00000004
  &lt;as-originally&gt;
after disable_ver: options 0x01000ff7
  &lt;as-originally&gt;
after &#40;possible&#41; SSL_honor_cipher_order: options 0x01400ff7
  +SSL_OP_CIPHER_SERVER_PREFERENCE

SSL Pulse reports
  TLS 1.0: Yes  &#40;just FYI&#41;
  SSL 3.0: Yes  &#40;just FYI&#41;
  SSL 2.0: No
  BEAST attack: Not vulnerable
The report now lists 4 ciphers
  TLS_RSA_WITH_RC4_128_SHA
  TLS_RSA_WITH_AES_256_CBC_SHA
  TLS_RSA_WITH_AES_128_CBC_SHA
  TLS_RSA_WITH_3DES_EDE_CBC_SHA




now disable SSL_honor_cipher_order in Mojolicious
from <span class="clickylink"><a target="new" rel="nofollow" href="https://community.qualys.com/message/12570">https://community.qualys.com/message/12570</a></span>
DEFAULT_CIPHER_LIST =&gt; &#39;RC4-SHA:HIGH:!ADH&#39;;
---------------------------------------------------
after context init: options 0x00000004
  &lt;as-originally&gt;
after disable_ver: options 0x01000ff7
  &lt;as-originally&gt;
after &#40;possible&#41; SSL_honor_cipher_order: options 0x01000ff7
  &lt;as-originally&gt;

SSL Pulse reports
  TLS 1.0: Yes  &#40;just FYI&#41;
  SSL 3.0: Yes  &#40;just FYI&#41;
  SSL 2.0: No
  BEAST attack: Vulnerable
The report still lists 4 ciphers, but &#34;server has no preference&#34;
  TLS_RSA_WITH_RC4_128_SHA
  TLS_RSA_WITH_AES_256_CBC_SHA
  TLS_RSA_WITH_AES_128_CBC_SHA
  TLS_RSA_WITH_3DES_EDE_CBC_SHA




just for the fun of it, let&#39;s try disabling TLSv1.0
set SSL_honor_cipher_order in Mojolicious
DEFAULT_CIPHER_LIST =&gt; &#39;RC4-SHA:HIGH:!ADH&#39;;
SSL_version =&gt; &#39;SSLv23:!TLSv1&#39;, &#40;set in Mojolicious&#41;
---------------------------------------------------
after context init: options 0x00000004
  &lt;as-originally&gt;
after disable_ver: options 0x04000ff7
  SSL_OP_NO_TLSv1
  SSL_OP_ALL - SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG
after &#40;possible&#41; SSL_honor_cipher_order: options 0x04400ff7
  +SSL_OP_CIPHER_SERVER_PREFERENCE

SSL Pulse reports
  TLS 1.0: No
  SSL 3.0: Yes  &#40;just FYI&#41;
  SSL 2.0: Yes
  BEAST attack: Vulnerable




set SSL_honor_cipher_order in Mojolicious
DEFAULT_CIPHER_LIST =&gt; &#39;RC4-SHA:HIGH:!ADH&#39;;
replace
  Net::SSLeay::CTX_set_options&#40;$ctx, Net::SSLeay::OP_ALL&#40;&#41; | $disable_ver &#41;;
by
  Net::SSLeay::CTX_set_options&#40;$ctx, $disable_ver &#41; if $disable_ver;
---------------------------------------------------
after context init: options 0x00000004
  &lt;as-originally&gt;
after disable_ver: options 0x01000004
  SSL_OP_LEGACY_SERVER_CONNECT
  SSL_OP_NO_SSLv2
after &#40;possible&#41; SSL_honor_cipher_order: options 0x01400004
  +SSL_OP_CIPHER_SERVER_PREFERENCE

SSL Pulse reports
  TLS 1.0: Yes  &#40;just FYI&#41;
  SSL 3.0: Yes  &#40;just FYI&#41;
  SSL 2.0: No
  BEAST attack: Not vulnerable

That one-line change removes these options &#40;which don&#39;t sound good&#41;
  SSL_OP_MICROSOFT_SESS_ID_BUG
  SSL_OP_NETSCAPE_CHALLENGE_BUG
  SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG
  SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER
  SSL_OP_MSIE_SSLV2_RSA_PADDING
  SSL_OP_SSLEAY_080_CLIENT_DH_BUG
  SSL_OP_TLS_D5_BUG
  SSL_OP_TLS_BLOCK_PADDING_BUG
  SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;10&nbsp;01:39:45&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 10 May 2012 07:39:20 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;d.thomas [...] its.uq.edu.au via RT&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Ullrich &lt;Steffen_Ullrich [...] genua.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, May 09, 2012 at 05:22:43PM -0400, &#34;d.thomas@its.uq.edu.au via RT&#34; &lt;bug-IO-Socket-SSL@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: IO-Socket-SSL
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76929">https://rt.cpan.org/Ticket/Display.html?id=76929</a></span> &gt;
&gt; 
&gt; 
&gt; On 09/05/2012, at 6:42 PM, Steffen Ullrich via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; issue should be fixed with 1.71.
</div>&gt; unfortunately not
</div>
I ment the issue with not disabling SSLv2, which was fixed:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; after disable_ver: options 0x01000ff7
&gt; ...
&gt;     SSL_OP_NO_SSLv2
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; set SSL_honor_cipher_order in Mojolicious
&gt; DEFAULT_CIPHER_LIST =&gt; &#39;RC4-SHA:HIGH:!ADH&#39;;
&gt; replace
&gt;   Net::SSLeay::CTX_set_options&#40;$ctx, Net::SSLeay::OP_ALL&#40;&#41; | $disable_ver &#41;;
&gt; by
&gt;   Net::SSLeay::CTX_set_options&#40;$ctx, $disable_ver &#41; if $disable_ver;
</div>
The BEAST attack will not be protected against by default &#40;but it is 
documented in SSL.pm how to protect yourself&#41;, and I better still use all 
the workarounds included in Net::SSLeay::OP_ALL. 

While it would be nice to throw all the legacy stuff and workarounds
over board it would probably break some systems, which is not what I
want. I think disabling SSLv2 and weak ciphers is necessary &#40;newer 
openssl versions have SSLv2 disabled by default&#41;, but everything else 
might have unintended consequences.

As for taming the BEAST: not everyone likes RC4 and some might have
it disabled. In this case the workaround would just cause connection
failures, and other workarounds needs to be used.
See <span class="clickylink"><a target="new" rel="nofollow" href="http://www.net-security.org/article.php?id=1638">http://www.net-security.org/article.php?id=1638</a></span>.
Therefore I don&#39;t like the workaround included by default.

Regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;10&nbsp;14:56:31&nbsp;2012</span>
    <span class="description">paul [...] city-fan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> paul [...] city-fan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue May 08 13:32:58 2012, paul@city-fan.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue May 08 04:25:58 2012, SULLR wrote:
<div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; t/dhe.t still not working but restoring the fix from RT#75165
</div>&gt; &gt; &gt; &gt; &#40;attached&#41;
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; fixes it for me.
</div></div>&gt; &gt; 
&gt; &gt; I&#39;ve reenabled the fix in 1.69.
</div>&gt; 
&gt; Works for me, thanks &#40;1.70 too&#41;.
</div>
t/dhe.t is failing for me with 1.72 on a small range of openssl
versions. Symptoms are:

t/dhe......................1..3
ok # [server] Server Initialization
not ok # [client] connect failed: IO::Socket::INET6 configuration failed
error:00000000:lib&#40;0&#41;:func&#40;0&#41;:reason&#40;0&#41;
not ok # [server] accept failed: SSL connect accept failed because of
handshake problems error:00000000:lib&#40;0&#41;:func&#40;0&#41;:reason&#40;0&#41;
FAILED tests 2-3
        Failed 2/3 tests, 33.33% okay

0.9.7f PASSES
0.9.8a FAILS
0.9.8b FAILS
0.9.8g PASSES

Unfortunately I don&#39;t have any other versions between 0.9.7f and 0.9.8g
to test with.

1.71 passes in all of these environments.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;01:57:11&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76929] strengthening server SSL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 11 May 2012 07:56:45 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;paul [...] city-fan.org via RT&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Ullrich &lt;Steffen_Ullrich [...] genua.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 0.9.8a FAILS
&gt; 0.9.8b FAILS
</div>
which Net::SSLeay versions did you use in this cases?
The latest Net::SSLeay fails some tests if I try to use it with 0.9.8b
on x64_86. And 0.9.8k passes for me the tests.

Or can you give me access to a system using this old version or link
me to an image or OS, which I can run/install in a VM, which uses this
version?

Regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;06:36:59&nbsp;2012</span>
    <span class="description">paul [...] city-fan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> paul [...] city-fan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri May 11 01:57:11 2012, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; 0.9.8a FAILS
&gt; &gt; 0.9.8b FAILS
</div>&gt; 
&gt; which Net::SSLeay versions did you use in this cases?
&gt; The latest Net::SSLeay fails some tests if I try to use it with 0.9.8b
&gt; on x64_86. And 0.9.8k passes for me the tests.
</div>
I&#39;ve been building with 1.48 &#40;latest&#41; on x86_64 but I got the same
result with 1.30. I also got the same result building on i386 and when
using IO::Socket::INET instead of IO::Socket::INET6.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Or can you give me access to a system using this old version or link
&gt; me to an image or OS, which I can run/install in a VM, which uses this
&gt; version?
</div>
I do my builds in a chroot&#39;ed build environment. The target OS releases
with the problems are Fedora releases 5, 6, 7 and 8. Older and newer
releases all work OK. I&#39;ve also done builds on CentOS 5, which is of a
similar age to these builds and uses OpenSSL 0.9.8e and that works OK.

If you have IPv6 connectivity I can give you a shell on my build machine
and tell you how to run builds. It&#39;s possible to poke around the chroot
environment and try things for debugging purposes.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;02:48:48&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think the problem should be closed now.
There are sane defaults and better documentation
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;02:48:49&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
