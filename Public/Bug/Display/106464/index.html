<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #106464 for Perl-Tidy-Sweetened: Breaks with anonymous subs in sub calls without parens</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #106464 for Perl-Tidy-Sweetened: Breaks with anonymous subs in sub calls without parens</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Tidy-Sweetened/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Tidy-Sweetened/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Tidy-Sweetened/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Tidy-Sweetened/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/mvgrimes/Perl-Tidy-Sweetened/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Tidy-Sweetened">Perl-Tidy-Sweetened CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">106464</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Tidy-Sweetened/Active/">Perl-Tidy-Sweetened</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
OSCHWALD [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-248162-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.04    </td>
  </tr>
  <tr id="CF-248163-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.07    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;14&nbsp;17:31:30&nbsp;2015</span>
    <span class="description">OSCHWALD [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Breaks with anonymous subs in sub calls without parens</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Using the 1.04 and the latest Perl::Tidy, tidying of:

method _path =&gt; sub { $path };

fails with:

expecting &#39;:&#39; or &#39;;&#39; or &#39;{&#39; after definition or declaration of sub &#39;_path&#39; but saw &#39;=&#39;

Adding parens to method&#40;&#41; stops the error from occurring.

Greg
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;17&nbsp;11:20:26&nbsp;2015</span>
    <span class="description">mgrimes [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Greg,

Can you give me some more color on where this would be used? I am aware of issues with anonymous subs, ie:

   my $x = { 
       bar =&gt; func &#40;$param&#41; { say $param },
   };

I would really like to get this working, but it doesn&#39;t really fit into the existing solution. I&#39;ve got an open GitHub issue for it.

I&#39;m not certain where the syntax in your example would be used? Which package are you getting the method keyword from? How is that different from:

   method _path { $path }

Thanks,
Mark


On Fri Aug 14 17:31:30 2015, OSCHWALD wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Using the 1.04 and the latest Perl::Tidy, tidying of:
&gt; 
&gt; method _path =&gt; sub { $path };
&gt; 
&gt; fails with:
&gt; 
&gt; expecting &#39;:&#39; or &#39;;&#39; or &#39;{&#39; after definition or declaration of sub
&gt; &#39;_path&#39; but saw &#39;=&#39;
&gt; 
&gt; Adding parens to method&#40;&#41; stops the error from occurring.
&gt; 
&gt; Greg
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;17&nbsp;11:20:27&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;17&nbsp;12:14:08&nbsp;2015</span>
    <span class="description">OSCHWALD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark,

It would affect any sub called without parens that takes an anonymous subroutine as a parameter. However, this particular example hit our code using parameterized roles with Moose:

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/MooseX::Role::Parameterized">https://metacpan.org/pod/MooseX::Role::Parameterized</a></span>

which provides the method sub to declare methods.

Are you suggesting that the parameterized role module should use prototypes so that it can take code blocks without the `sub`? That seems possible, although not currently implemented in it, but ideally this module should run on most valid Perl and not require awkward workarounds or modifying of third party modules.

Thanks!

Greg

On Mon Aug 17 11:20:26 2015, MGRIMES wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Greg,
&gt; 
&gt; Can you give me some more color on where this would be used? I am
&gt; aware of issues with anonymous subs, ie:
&gt; 
&gt; my $x = {
&gt;    bar =&gt; func &#40;$param&#41; { say $param },
&gt; };
&gt; 
&gt; I would really like to get this working, but it doesn&#39;t really fit
&gt; into the existing solution. I&#39;ve got an open GitHub issue for it.
&gt; 
&gt; I&#39;m not certain where the syntax in your example would be used? Which
&gt; package are you getting the method keyword from? How is that different
&gt; from:
&gt; 
&gt; method _path { $path }
&gt; 
&gt; Thanks,
&gt; Mark
&gt; 
&gt; 
&gt; On Fri Aug 14 17:31:30 2015, OSCHWALD wrote:
<div class="message-stanza open">&gt; &gt; Using the 1.04 and the latest Perl::Tidy, tidying of:
&gt; &gt;
&gt; &gt; method _path =&gt; sub { $path };
&gt; &gt;
&gt; &gt; fails with:
&gt; &gt;
&gt; &gt; expecting &#39;:&#39; or &#39;;&#39; or &#39;{&#39; after definition or declaration of sub
&gt; &gt; &#39;_path&#39; but saw &#39;=&#39;
&gt; &gt;
&gt; &gt; Adding parens to method&#40;&#41; stops the error from occurring.
&gt; &gt;
&gt; &gt; Greg
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;17&nbsp;13:22:15&nbsp;2015</span>
    <span class="description">mgrimes [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I see. MooseX::Role::Parameterized provides a function named &#34;method&#34;. Unlike the method &#40;pseudo&#41; keyword provided by Method::Signatures::Simple, MooseX::Method::Signatures, etc, this doesn&#39;t need any special processing. Perl::Tidy::Sweet should just ignore this. Unfortunately, that&#39;s easier said than done. A simple work around is to quote the hash key &#40;&#34;_path&#34; in your example&#41;.

On Mon Aug 17 12:14:08 2015, OSCHWALD wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Mark,
&gt; 
&gt; It would affect any sub called without parens that takes an anonymous
&gt; subroutine as a parameter. However, this particular example hit our
&gt; code using parameterized roles with Moose:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/MooseX::Role::Parameterized">https://metacpan.org/pod/MooseX::Role::Parameterized</a></span>
&gt; 
&gt; which provides the method sub to declare methods.
&gt; 
&gt; Are you suggesting that the parameterized role module should use
&gt; prototypes so that it can take code blocks without the `sub`? That
&gt; seems possible, although not currently implemented in it, but ideally
&gt; this module should run on most valid Perl and not require awkward
&gt; workarounds or modifying of third party modules.
&gt; 
&gt; Thanks!
&gt; 
&gt; Greg
&gt; 
&gt; On Mon Aug 17 11:20:26 2015, MGRIMES wrote:
<div class="message-stanza open">&gt; &gt; Greg,
&gt; &gt;
&gt; &gt; Can you give me some more color on where this would be used? I am
&gt; &gt; aware of issues with anonymous subs, ie:
&gt; &gt;
&gt; &gt; my $x = {
&gt; &gt;    bar =&gt; func &#40;$param&#41; { say $param },
&gt; &gt; };
&gt; &gt;
&gt; &gt; I would really like to get this working, but it doesn&#39;t really fit
&gt; &gt; into the existing solution. I&#39;ve got an open GitHub issue for it.
&gt; &gt;
&gt; &gt; I&#39;m not certain where the syntax in your example would be used? Which
&gt; &gt; package are you getting the method keyword from? How is that
&gt; &gt; different
&gt; &gt; from:
&gt; &gt;
&gt; &gt; method _path { $path }
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Mark
&gt; &gt;
&gt; &gt;
&gt; &gt; On Fri Aug 14 17:31:30 2015, OSCHWALD wrote:
<div class="message-stanza open">&gt; &gt; &gt; Using the 1.04 and the latest Perl::Tidy, tidying of:
&gt; &gt; &gt;
&gt; &gt; &gt; method _path =&gt; sub { $path };
&gt; &gt; &gt;
&gt; &gt; &gt; fails with:
&gt; &gt; &gt;
&gt; &gt; &gt; expecting &#39;:&#39; or &#39;;&#39; or &#39;{&#39; after definition or declaration of sub
&gt; &gt; &gt; &#39;_path&#39; but saw &#39;=&#39;
&gt; &gt; &gt;
&gt; &gt; &gt; Adding parens to method&#40;&#41; stops the error from occurring.
&gt; &gt; &gt;
&gt; &gt; &gt; Greg
</div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;27&nbsp;18:08:16&nbsp;2016</span>
    <span class="description">mgrimes [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fix was released as 1.07. Thanks for the report and patch.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;27&nbsp;18:08:22&nbsp;2016</span>
    <span class="description">mgrimes [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;27&nbsp;18:08:23&nbsp;2016</span>
    <span class="description">mgrimes [...] cpan.org -  Fixed in 1.07 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;27&nbsp;19:13:25&nbsp;2016</span>
    <span class="description">OSCHWALD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 27 18:08:16 2016, MGRIMES wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Fix was released as 1.07. Thanks for the report and patch.
</div>
Thanks!
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
