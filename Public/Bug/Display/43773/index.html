<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #43773 for MooseX-Declare: Problems playing with MooseX::ClassAttribute</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #43773 for MooseX-Declare: Problems playing with MooseX::ClassAttribute</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/MooseX-Declare/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/MooseX-Declare/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/MooseX-Declare/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/MooseX-Declare/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/MooseX-Declare">MooseX-Declare CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">43773</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/MooseX-Declare/Active/">MooseX-Declare</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
nelo.onyiah [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-224930-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.07    </td>
  </tr>
  <tr id="CF-224931-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




MXDeclare.pm<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/571931/288524/MXDeclare.pm">
Mon Mar 02 10:55:57 2009 (312b) by nelo.onyiah [...] gmail.com
</a>
</font></li>
</ul>


mxdeclare.t<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/571931/288521/mxdeclare.t">
Mon Mar 02 10:55:57 2009 (102b) by nelo.onyiah [...] gmail.com
</a>
</font></li>
</ul>


signature.asc<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/572242/288697/signature.asc">
Mon Mar 02 19:12:16 2009 (189b) by rafl [...] debian.org
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/572120/288621/signature.asc">
Mon Mar 02 16:44:16 2009 (189b) by rafl [...] debian.org
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/571963/288548/signature.asc">
Mon Mar 02 11:53:49 2009 (189b) by rafl [...] debian.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;10:55:57&nbsp;2009</span>
    <span class="description">nelo.onyiah [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Problems playing with MooseX::ClassAttribute</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I noticed that the following use case will not compile:

use MooseX::Declare;
use MooseX::ClassAttribute;
class MXDeclare with MooseX::Getopt {
    class_has ID =&gt; &#40;
        isa     =&gt; &#39;Int&#39;,
        is      =&gt; &#39;ro&#39;,
        default =&gt; sub { int rand 1000 },
    &#41;;
    has name =&gt; &#40;
        isa      =&gt; &#39;Str&#39;,
        is       =&gt; &#39;ro&#39;,
        required =&gt; 1,
    &#41;;
}

However when I move the &#34;use MooseX::ClassAttribute&#34; into the class
definition it works:

use MooseX::Declare;
class MXDeclare with MooseX::Getopt {
    use MooseX::ClassAttribute; # this works
    class_has ID =&gt; &#40;
        isa     =&gt; &#39;Int&#39;,
        is      =&gt; &#39;ro&#39;,
        default =&gt; sub { int rand 1000 },
    &#41;;
    has name =&gt; &#40;
        isa      =&gt; &#39;Str&#39;,
        is       =&gt; &#39;ro&#39;,
        required =&gt; 1,
    &#41;;
}

I realize this is not really a bug, more like a feature request as it
would not stop me from writing code wit this module. I just think it
would be nice to keep all the imports in the same place and it may well
point to something going on behind the scenes that you may or may not be
aware of.

I have attached the failing test and the example code. Thank you for a
great module!
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> mxdeclare.t</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/env perl
use strict;
use warnings;
use Test::More &#39;no_plan&#39;;

use_ok&#40;&#39;MXDeclare&#39;&#41; or exit;
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> MXDeclare.pm</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use MooseX::Declare;
use MooseX::ClassAttribute;
class MXDeclare with MooseX::Getopt {
    class_has ID =&gt; &#40;
        isa     =&gt; &#39;Int&#39;,
        is      =&gt; &#39;ro&#39;,
        default =&gt; sub { int rand 1000 },
    &#41;;
    has name =&gt; &#40;
        isa      =&gt; &#39;Str&#39;,
        is       =&gt; &#39;ro&#39;,
        required =&gt; 1,
    &#41;;
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;11:53:49&nbsp;2009</span>
    <span class="description">rafl [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43773] Problems playing with MooseX::ClassAttribute</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Mar 2009 17:52:44 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;nelo.onyiah [...] gmail.com via RT&#34; &lt;bug-MooseX-Declare [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Florian Ragwitz &lt;rafl [...] debian.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

thanks for your report!


On Mon, Mar 02, 2009 at 10:55:58AM -0500, nelo.onyiah@gmail.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I noticed that the following use case will not compile:
&gt; 
&gt; use MooseX::Declare;
&gt; use MooseX::ClassAttribute;
&gt; class MXDeclare with MooseX::Getopt {
&gt;     class_has ID =&gt; &#40;
&gt;         isa     =&gt; &#39;Int&#39;,
&gt;         is      =&gt; &#39;ro&#39;,
&gt;         default =&gt; sub { int rand 1000 },
&gt;     &#41;;
&gt;     has name =&gt; &#40;
&gt;         isa      =&gt; &#39;Str&#39;,
&gt;         is       =&gt; &#39;ro&#39;,
&gt;         required =&gt; 1,
&gt;     &#41;;
&gt; }
&gt; 
&gt; However when I move the &#34;use MooseX::ClassAttribute&#34; into the class
&gt; definition it works:
&gt; 
&gt; use MooseX::Declare;
&gt; class MXDeclare with MooseX::Getopt {
&gt;     use MooseX::ClassAttribute; # this works
&gt;     class_has ID =&gt; &#40;
&gt;         isa     =&gt; &#39;Int&#39;,
&gt;         is      =&gt; &#39;ro&#39;,
&gt;         default =&gt; sub { int rand 1000 },
&gt;     &#41;;
&gt;     has name =&gt; &#40;
&gt;         isa      =&gt; &#39;Str&#39;,
&gt;         is       =&gt; &#39;ro&#39;,
&gt;         required =&gt; 1,
&gt;     &#41;;
&gt; }
&gt; 
&gt; I realize this is not really a bug, more like a feature request as it
&gt; would not stop me from writing code wit this module. I just think it
&gt; would be nice to keep all the imports in the same place and it may well
&gt; point to something going on behind the scenes that you may or may not be
&gt; aware of.
</div>
What actually happens when you&#39;re doing class Foo { ... } is something like

  {
        package Foo;
        use Moose;
        ...
  }

So what your first example does is importing class_has into the main::
package and then trying to use it from another package, which isn&#39;t
going to work.

I can see why this can be confusing, but I&#39;m afraid I can&#39;t change that.

However, I&#39;m planning on adding a new piece of syntax that will allow
you to import symbols from somewhere else and have them automatically
cleaned from your namespace at the end of compilation. That already
happens for Moose and Moose::Role keywords, but wouldn&#39;t work for
importing MooseX::ClassAttribute, unless you namespace::clean yourself
afterwards.

I think it&#39;ll look something like

  class Foo with Baz {
        using MooseX::ClassAttribute;
        using MooseX::Types::Structured qw&#40;Tuple Dict&#41;;
        ...
  }

That way it&#39;d be easier to keep track of imports and having them all in
the same place, per class.

Would that count as fulfilling your feature request?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have attached the failing test and the example code.
</div>
Thanks. I don&#39;t think I will apply it tho, because it&#39;s unlikely that it
will ever pass, for the above reasons.

What I&#39;d love to apply is a small change to the documentation,
explaining why the first example you gave doesn&#39;t work and why the
second one does. The git repository is at
<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/rafl/moosex-declare">http://github.com/rafl/moosex-declare</a></span>


-- 
BOFH excuse #36:
dynamic software linking table corrupted
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/571963/288548/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 189b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;11:53:50&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;15:25:06&nbsp;2009</span>
    <span class="description">nelo.onyiah [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43773] Problems playing with MooseX::ClassAttribute</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Mar 2009 20:24:10 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MooseX-Declare [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ifejinelo Onyiah &lt;nelo.onyiah [...] googlemail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for your prompt response. I have provided a draft documentation
which I hope meets your specification. Your plans for the new syntax looks
great to me and certainly meets my feature request.

In essence, only MooseX::Declare would get imported outside the class
definition &#40;as it needs to be&#41; and everything else gets imported inside the
class with the keyword &#34;using&#34;:

use MooseX::Declare;
class Foo {
  use Data::Dumper &#39;Dumper&#39;;
  # using Data::Dumper -- future
syntax

  method dumper &#40;&#41; { print Dumper @_ }
}

Perhaps I should put that in the docs :&#41;

2009/3/2 Florian Ragwitz via RT &lt;bug-MooseX-Declare@rt.cpan.org&gt;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43773">https://rt.cpan.org/Ticket/Display.html?id=43773</a></span> &gt;
&gt;
&gt; Hi,
&gt;
&gt; thanks for your report!
&gt;
&gt;
&gt; On Mon, Mar 02, 2009 at 10:55:58AM -0500, nelo.onyiah@gmail.com via RT
&gt; wrote:
<div class="message-stanza open">&gt; &gt; I noticed that the following use case will not compile:
&gt; &gt;
&gt; &gt; use MooseX::Declare;
&gt; &gt; use MooseX::ClassAttribute;
&gt; &gt; class MXDeclare with MooseX::Getopt {
&gt; &gt;     class_has ID =&gt; &#40;
&gt; &gt;         isa     =&gt; &#39;Int&#39;,
&gt; &gt;         is      =&gt; &#39;ro&#39;,
&gt; &gt;         default =&gt; sub { int rand 1000 },
&gt; &gt;     &#41;;
&gt; &gt;     has name =&gt; &#40;
&gt; &gt;         isa      =&gt; &#39;Str&#39;,
&gt; &gt;         is       =&gt; &#39;ro&#39;,
&gt; &gt;         required =&gt; 1,
&gt; &gt;     &#41;;
&gt; &gt; }
&gt; &gt;
&gt; &gt; However when I move the &#34;use MooseX::ClassAttribute&#34; into the class
&gt; &gt; definition it works:
&gt; &gt;
&gt; &gt; use MooseX::Declare;
&gt; &gt; class MXDeclare with MooseX::Getopt {
&gt; &gt;     use MooseX::ClassAttribute; # this works
&gt; &gt;     class_has ID =&gt; &#40;
&gt; &gt;         isa     =&gt; &#39;Int&#39;,
&gt; &gt;         is      =&gt; &#39;ro&#39;,
&gt; &gt;         default =&gt; sub { int rand 1000 },
&gt; &gt;     &#41;;
&gt; &gt;     has name =&gt; &#40;
&gt; &gt;         isa      =&gt; &#39;Str&#39;,
&gt; &gt;         is       =&gt; &#39;ro&#39;,
&gt; &gt;         required =&gt; 1,
&gt; &gt;     &#41;;
&gt; &gt; }
&gt; &gt;
&gt; &gt; I realize this is not really a bug, more like a feature request as it
&gt; &gt; would not stop me from writing code wit this module. I just think it
&gt; &gt; would be nice to keep all the imports in the same place and it may well
&gt; &gt; point to something going on behind the scenes that you may or may not be
&gt; &gt; aware of.
</div>&gt;
&gt; What actually happens when you&#39;re doing class Foo { ... } is something like
&gt;
&gt;  {
&gt;        package Foo;
&gt;        use Moose;
&gt;        ...
&gt;  }
&gt;
&gt; So what your first example does is importing class_has into the main::
&gt; package and then trying to use it from another package, which isn&#39;t
&gt; going to work.
&gt;
&gt; I can see why this can be confusing, but I&#39;m afraid I can&#39;t change that.
&gt;
&gt; However, I&#39;m planning on adding a new piece of syntax that will allow
&gt; you to import symbols from somewhere else and have them automatically
&gt; cleaned from your namespace at the end of compilation. That already
&gt; happens for Moose and Moose::Role keywords, but wouldn&#39;t work for
&gt; importing MooseX::ClassAttribute, unless you namespace::clean yourself
&gt; afterwards.
&gt;
&gt; I think it&#39;ll look something like
&gt;
&gt;  class Foo with Baz {
&gt;        using MooseX::ClassAttribute;
&gt;        using MooseX::Types::Structured qw&#40;Tuple Dict&#41;;
&gt;        ...
&gt;  }
&gt;
&gt; That way it&#39;d be easier to keep track of imports and having them all in
&gt; the same place, per class.
&gt;
&gt; Would that count as fulfilling your feature request?
&gt;
<div class="message-stanza open">&gt; &gt; I have attached the failing test and the example code.
</div>&gt;
&gt; Thanks. I don&#39;t think I will apply it tho, because it&#39;s unlikely that it
&gt; will ever pass, for the above reasons.
&gt;
&gt; What I&#39;d love to apply is a small change to the documentation,
&gt; explaining why the first example you gave doesn&#39;t work and why the
&gt; second one does. The git repository is at
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/rafl/moosex-declare">http://github.com/rafl/moosex-declare</a></span>
&gt;
&gt;
&gt; --
&gt; BOFH excuse #36:
&gt; dynamic software linking table corrupted
&gt;
&gt;
&gt; -----BEGIN PGP SIGNATURE-----
&gt; Version: GnuPG v1.4.6 &#40;GNU/Linux&#41;
&gt;
&gt; iD8DBQFJrA7bdC8qQo5jWl4RAuvQAJ0ehPMq9uwtX8+jUgeILp+OcXFc2gCfXqAn
&gt; K/cxD4GCWo3HzqBnyKGdn3Q=
&gt; =GwAs
&gt; -----END PGP SIGNATURE-----
&gt;
&gt;
</div>

-- 
Nelo Onyiah
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;16:44:16&nbsp;2009</span>
    <span class="description">rafl [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43773] Problems playing with MooseX::ClassAttribute</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Mar 2009 22:05:31 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Ifejinelo Onyiah via RT &lt;bug-MooseX-Declare [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Florian Ragwitz &lt;rafl [...] debian.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Mar 02, 2009 at 03:25:08PM -0500, Ifejinelo Onyiah via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thank you for your prompt response. I have provided a draft documentation
&gt; which I hope meets your specification. Your plans for the new syntax looks
&gt; great to me and certainly meets my feature request.
</div>
Cool, thanks for the input on this.

I&#39;ve reviewed your patch and it looks good to me. I&#39;m planning on
implementing the &#39;using&#39; keyword today or tomorrow and will apply your
patch as soon as I&#39;m done.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In essence, only MooseX::Declare would get imported outside the class
&gt; definition &#40;as it needs to be&#41; and everything else gets imported inside the
&gt; class with the keyword &#34;using&#34;:
</div>
Exactly.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; use MooseX::Declare;
&gt; class Foo {
&gt;   use Data::Dumper &#39;Dumper&#39;;
&gt;   # using Data::Dumper -- future
&gt; syntax
&gt;
&gt;   method dumper &#40;&#41; { print Dumper @_ }
&gt; }
</div>
Yes. &#39;using&#39; is really just an alternative syntax for &#39;use&#39;, except it
also cleans all imports automatically.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perhaps I should put that in the docs :&#41;
</div>
I think it&#39;s a good example. It might also be good to choose an example
where the import has the same name as a method, to illustrate how both
can co-exist without a problem.

  class MyDumper {
    using Data::Dump qw/dump/;
    method dump &#40;$value&#41; { return dump&#40;$value&#41; } # calls the imported dump with $value
    method pp   &#40;$value&#41; { $self-&gt;dump&#40;$value&#41; } # alias for the dump method
  }

  MyDumper-&gt;new-&gt;dump&#40;$some_value&#41;;
  MyDumper-&gt;new-&gt;pp&#40;$some_value&#41;;


probably not a good example, but i believe it makes the point quite
clear.


-- 
BOFH excuse #90:
Budget cuts
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/572120/288621/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 189b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;19:07:45&nbsp;2009</span>
    <span class="description">nelo.onyiah [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43773] Problems playing with MooseX::ClassAttribute</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Mar 2009 00:07:33 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MooseX-Declare [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ifejinelo Onyiah &lt;nelo.onyiah [...] googlemail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Okay. I&#39;ll add those doc changes when you&#39;re finished with your
&#34;using_keyword&#34; branch off github.

2009/3/2 Florian Ragwitz via RT &lt;bug-MooseX-Declare@rt.cpan.org&gt;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43773">https://rt.cpan.org/Ticket/Display.html?id=43773</a></span> &gt;
&gt;
&gt; On Mon, Mar 02, 2009 at 03:25:08PM -0500, Ifejinelo Onyiah via RT wrote:
<div class="message-stanza open">&gt; &gt; Thank you for your prompt response. I have provided a draft documentation
&gt; &gt; which I hope meets your specification. Your plans for the new syntax
</div>&gt; looks
<div class="message-stanza open">&gt; &gt; great to me and certainly meets my feature request.
</div>&gt;
&gt; Cool, thanks for the input on this.
&gt;
&gt; I&#39;ve reviewed your patch and it looks good to me. I&#39;m planning on
&gt; implementing the &#39;using&#39; keyword today or tomorrow and will apply your
&gt; patch as soon as I&#39;m done.
&gt;
<div class="message-stanza open">&gt; &gt; In essence, only MooseX::Declare would get imported outside the class
&gt; &gt; definition &#40;as it needs to be&#41; and everything else gets imported inside
</div>&gt; the
<div class="message-stanza open">&gt; &gt; class with the keyword &#34;using&#34;:
</div>&gt;
&gt; Exactly.
&gt;
<div class="message-stanza open">&gt; &gt; use MooseX::Declare;
&gt; &gt; class Foo {
&gt; &gt;   use Data::Dumper &#39;Dumper&#39;;
&gt; &gt;   # using Data::Dumper -- future
&gt; &gt; syntax
&gt; &gt;
&gt; &gt;   method dumper &#40;&#41; { print Dumper @_ }
&gt; &gt; }
</div>&gt;
&gt; Yes. &#39;using&#39; is really just an alternative syntax for &#39;use&#39;, except it
&gt; also cleans all imports automatically.
&gt;
<div class="message-stanza open">&gt; &gt; Perhaps I should put that in the docs :&#41;
</div>&gt;
&gt; I think it&#39;s a good example. It might also be good to choose an example
&gt; where the import has the same name as a method, to illustrate how both
&gt; can co-exist without a problem.
&gt;
&gt;  class MyDumper {
&gt;    using Data::Dump qw/dump/;
&gt;    method dump &#40;$value&#41; { return dump&#40;$value&#41; } # calls the imported dump
&gt; with $value
&gt;    method pp   &#40;$value&#41; { $self-&gt;dump&#40;$value&#41; } # alias for the dump method
&gt;  }
&gt;
&gt;  MyDumper-&gt;new-&gt;dump&#40;$some_value&#41;;
&gt;  MyDumper-&gt;new-&gt;pp&#40;$some_value&#41;;
&gt;
&gt;
&gt; probably not a good example, but i believe it makes the point quite
&gt; clear.
&gt;
&gt;
&gt; --
&gt; BOFH excuse #90:
&gt; Budget cuts
&gt;
&gt;
&gt; -----BEGIN PGP SIGNATURE-----
&gt; Version: GnuPG v1.4.6 &#40;GNU/Linux&#41;
&gt;
&gt; iD8DBQFJrEoadC8qQo5jWl4RAh5EAJ9/y2ndp3V15fM1jvzYdeci+ISwlACcDO79
&gt; aEOR8Ot+GOSdBiFfwrg/G90=
&gt; =7dT6
&gt; -----END PGP SIGNATURE-----
&gt;
&gt;
</div>

-- 
Nelo Onyiah
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;19:12:16&nbsp;2009</span>
    <span class="description">rafl [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43773] Problems playing with MooseX::ClassAttribute</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Mar 2009 01:11:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Ifejinelo Onyiah via RT &lt;bug-MooseX-Declare [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Florian Ragwitz &lt;rafl [...] debian.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Mar 02, 2009 at 07:07:46PM -0500, Ifejinelo Onyiah via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Okay. I&#39;ll add those doc changes
</div>
Awesome, thanks!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; when you&#39;re finished with your &#34;using_keyword&#34; branch off github.
</div>
which I just did, although with a slightly different result than I
initially expected. See the commit messages and the message I just sent
you on github.  Sorry for the inconvenience.


-- 
BOFH excuse #253:
We&#39;ve run out of licenses
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/572242/288697/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 189b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;02&nbsp;21:18:50&nbsp;2009</span>
    <span class="description">rafl [...] debian.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
