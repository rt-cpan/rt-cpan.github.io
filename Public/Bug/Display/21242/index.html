<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21242 for Cache-FastMmap: *** glibc detected *** double free or corruption &#40;!prev&#41;: 0x00000000017e8d00 ***</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21242 for Cache-FastMmap: *** glibc detected *** double free or corruption &#40;!prev&#41;: 0x00000000017e8d00 ***</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Cache-FastMmap">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Cache-FastMmap">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Cache-FastMmap">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Cache-FastMmap">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Cache-FastMmap">Cache-FastMmap CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21242</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Cache-FastMmap">Cache-FastMmap</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
melazyboy [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-4856-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.09    </td>
  </tr>
  <tr id="CF-4857-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




out<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/236337/99475/out">
Wed Aug 30 12:15:58 2006 (475.2k) by melazyboy [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=21242">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-236337" href="/Public/Bug/Display.html?id=21242#txn-236337">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;30&nbsp;12:15:58&nbsp;2006</span>
    <span class="description">melazyboy [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> *** glibc detected *** double free or corruption &#40;!prev&#41;:
 0x00000000017e8d00 ***</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/236337/99472/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/99472">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On the following apache2 mpm configuration:

root@nox:/var/log/apache2# apache2 -V
Server version: Apache/2.0.55
Server built:   Jul 26 2006 17:53:44
Server&#39;s Module Magic Number: 20020903:11
Architecture:   64-bit
Server compiled with....
 -D APACHE_MPM_DIR=&#34;server/mpm/worker&#34;
 -D APR_HAS_SENDFILE
 -D APR_HAS_MMAP
 -D APR_HAVE_IPV6 &#40;IPv4-mapped addresses enabled&#41;
 -D APR_USE_SYSVSEM_SERIALIZE
 -D APR_USE_PTHREAD_SERIALIZE
 -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
 -D APR_HAS_OTHER_CHILD
 -D AP_HAVE_RELIABLE_PIPED_LOGS
 -D HTTPD_ROOT=&#34;&#34;
 -D SUEXEC_BIN=&#34;/usr/lib/apache2/suexec2&#34;
 -D DEFAULT_PIDLOG=&#34;/var/run/apache2.pid&#34;
 -D DEFAULT_SCOREBOARD=&#34;logs/apache_runtime_status&#34;
 -D DEFAULT_ERRORLOG=&#34;logs/error_log&#34;
 -D AP_TYPES_CONFIG_FILE=&#34;/etc/apache2/mime.types&#34;
 -D SERVER_CONFIG_FILE=&#34;/etc/apache2/apache2.conf&#34;


I get the following error msg: 
root@nox:/var/log/apache2# /etc/init.d/apache2 restart
 * Forcing reload of apache 2.0 web server...
*** glibc detected *** double free or corruption &#40;!prev&#41;:
0x00000000017e9d80 ***
/usr/sbin/apache2ctl: line 78: 19643 Aborted                 $HTTPD -k
start -DSSL
   ...fail!


The strace is attached as &#39;out&#39; as follows.

If there is *any* way i can assist you in solving this bug message me at
evan@dealermade.com. This is all the info I knew to attach.

Evan Carroll
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> out</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/236337/99475/out">Download out</a><br />
<span class="downloadcontenttype">application/octet-stream 475.2k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-244597" href="/Public/Bug/Display.html?id=21242#txn-244597">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;25&nbsp;20:35:26&nbsp;2006</span>
    <span class="description">robm [...] fastmail.fm -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;evan [...] dealermade.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21242] *** glibc detected *** double free or corruption &#40;!prev&#41;: 0x00000000017e8d00 *** </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Sep 2006 10:33:37 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Cache-FastMmap [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Robert Mueller&#34; &lt;robm [...] fastmail.fm&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/244597/104311/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/104311">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1002b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi

I&#39;ve been on vacation for a couple of weeks, so I&#39;m only now back and have a 
chance to look at this.

I haven&#39;t actually seen this problem before, and am not sure what would be 
causing it. A couple of things to check first:
1. I presume if you cache the session caching to something other that 
Cache::FastMmap, the problem goes away?
2. Can you get an ltrace rather than strace. That should list all the 
library calls which might help some more.

Thanks

Rob

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I get the following error msg:
&gt; root@nox:/var/log/apache2# /etc/init.d/apache2 restart
&gt; * Forcing reload of apache 2.0 web server...
&gt; *** glibc detected *** double free or corruption &#40;!prev&#41;:
&gt; 0x00000000017e9d80 ***
&gt; /usr/sbin/apache2ctl: line 78: 19643 Aborted                 $HTTPD -k
&gt; start -DSSL
&gt;   ...fail!
&gt;
&gt;
&gt; The strace is attached as &#39;out&#39; as follows.
&gt;
&gt; If there is *any* way i can assist you in solving this bug message me at
&gt; evan@dealermade.com. This is all the info I knew to attach.
&gt;
&gt; Evan Carroll
&gt;
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-244598" href="/Public/Bug/Display.html?id=21242#txn-244598">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;25&nbsp;20:35:27&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-245247" href="/Public/Bug/Display.html?id=21242#txn-245247">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;28&nbsp;10:38:07&nbsp;2006</span>
    <span class="description">melazyboy [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21242] *** glibc detected *** double free or corruption &#40;!prev&#41;: 0x00000000017e8d00 ***</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Sep 2006 09:37:44 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Cache-FastMmap [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Evan Carroll&#34; &lt;melazyboy [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/245247/104679/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/104679">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 45.8k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/245247/104680/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/104680">with headers</a>
<br />
<span class="downloadcontenttype">text/html 101.1k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-305695" href="/Public/Bug/Display.html?id=21242#txn-305695">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;02&nbsp;04:46:56&nbsp;2007</span>
    <span class="description">cpan [...] robm.fastmail.fm -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/305695/138815/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/138815">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 762b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Replying to this from a while back. I&#39;m not convinced this is
Cache::FastMmaps fault in any way. From the ltrace there&#39;s no hint of
Cache::FastMmap being loaded, it seems to occur immediately after
something to do with mod_so

apr_array_push&#40;0x57a308, 0, 0x45a9d0, 10, 79&#41;    = 0x580d40
apr_array_push&#40;0x57a638, 0, 0, 10, 0&#41;            = 0x580e08
strrchr&#40;&#34;/build/buildd/apache2-2.0.55/bui&#34;..., &#39;/&#39;&#41; = &#34;/mod_so.c&#34;
strrchr&#40;&#34;mod_so.c&#34;, &#39;\\&#39;&#41;                        = NULL
apr_hook_sort_all&#40;0, 0x57a138, 0xfefefefefefefeff, 0, 0xfefefefefefefeff
&lt;unfinished ...&gt;
--- SIGSEGV &#40;Segmentation fault&#41; ---
+++ killed by SIGSEGV +++

I&#39;ll mark this as rejected for now. If you can still reproduce it and
know it&#39;s related to Cache::FastMmap, please reopen the ticket.

Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-305697" href="/Public/Bug/Display.html?id=21242#txn-305697">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;02&nbsp;04:46:58&nbsp;2007</span>
    <span class="description">cpan [...] robm.fastmail.fm -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-305947" href="/Public/Bug/Display.html?id=21242#txn-305947">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;02&nbsp;23:20:03&nbsp;2007</span>
    <span class="description">melazyboy [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21242] *** glibc detected *** double free or corruption &#40;!prev&#41;: 0x00000000017e8d00 ***</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Apr 2007 22:19:49 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Cache-FastMmap [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Evan Carroll&#34; &lt;melazyboy [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/305947/138936/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/138936">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It&#39;s Cache::FastMmap *related* because if I don&#39;t use Cache::FastMmap and
use a different Catalyst store I get no error or crash. The condition is
dependent on Cache::FastMmap. Now, whether or not Cache::FastMmap can place
the blame on another component it uses is beyond me. The condition is still
reproducible to date, on any Apache2-mpm-worker install w/ Cache::FastMmap
and Catalyst. &lt;wisper&gt;A few Catalyst devs pointed the finger here.&lt;/wisper&gt;

Evan

On 4/2/07, via RT &lt;bug-Cache-FastMmap@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=21242">http://rt.cpan.org/Ticket/Display.html?id=21242</a></span> &gt;
&gt;
&gt; Replying to this from a while back. I&#39;m not convinced this is
&gt; Cache::FastMmaps fault in any way. From the ltrace there&#39;s no hint of
&gt; Cache::FastMmap being loaded, it seems to occur immediately after
&gt; something to do with mod_so
&gt;
&gt; apr_array_push&#40;0x57a308, 0, 0x45a9d0, 10, 79&#41;    = 0x580d40
&gt; apr_array_push&#40;0x57a638, 0, 0, 10, 0&#41;            = 0x580e08
&gt; strrchr&#40;&#34;/build/buildd/apache2-2.0.55/bui&#34;..., &#39;/&#39;&#41; = &#34;/mod_so.c&#34;
&gt; strrchr&#40;&#34;mod_so.c&#34;, &#39;\\&#39;&#41;                        = NULL
&gt; apr_hook_sort_all&#40;0, 0x57a138, 0xfefefefefefefeff, 0, 0xfefefefefefefeff
&gt; &lt;unfinished ...&gt;
&gt; --- SIGSEGV &#40;Segmentation fault&#41; ---
&gt; +++ killed by SIGSEGV +++
&gt;
&gt; I&#39;ll mark this as rejected for now. If you can still reproduce it and
&gt; know it&#39;s related to Cache::FastMmap, please reopen the ticket.
&gt;
&gt; Rob
&gt;
&gt;
</div>

-- 
Evan Carroll
System Lord of the Internets
832-445-8877
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/305947/138937/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/138937">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-305948" href="/Public/Bug/Display.html?id=21242#txn-305948">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;02&nbsp;23:20:07&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-306012" href="/Public/Bug/Display.html?id=21242#txn-306012">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;03&nbsp;07:52:07&nbsp;2007</span>
    <span class="description">cpan [...] robm.fastmail.fm -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/306012/138972/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/138972">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 668b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; reproducible to date, on any Apache2-mpm-worker install w/ Cache::FastMmap
</div>
Ah, I just checked. I hadn&#39;t realised that mpm was a
multi-process/multi-threaded hybrid.

Cache::FastMmap does not natively support a multi-threaded environment
at the moment. If you&#39;re so inclined, you could hack in your own CLONE
sub so that it reopens the cache file anew in the cloned thread, but
otherwise the current way perl clones objects when creating threads will
result in a double free when it tries to clean up.

If you have a patch to make it work I&#39;ll look at adding it back, but for
now all I&#39;m going to do is add a note in the next version that it&#39;s not
thread safe.

Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-306142" href="/Public/Bug/Display.html?id=21242#txn-306142">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;03&nbsp;18:54:22&nbsp;2007</span>
    <span class="description">melazyboy [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21242] *** glibc detected *** double free or corruption &#40;!prev&#41;: 0x00000000017e8d00 ***</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Apr 2007 17:54:06 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Cache-FastMmap [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Evan Carroll&#34; &lt;melazyboy [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/306142/139039/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/139039">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Rob,

Your repsonse is most apreciated. After having the &#34;bug&#34; open for such a
long time, I&#39;m glad it&#39;s acknolwedged that it isn&#39;t thread safe. I&#39;m not
sure with my knowledge of ithreads, I could write a patch, but I do know
that after one is written many will rejoyce. Currently, this leaves the
mod_perl Catalyst folks in a bind, using the higher perf. build of Apache2
results in a lower performance version of a Cache &#40;file-based&#41; while using
the better cache requires the lower perf. build of Apache2.

Unitl the day of the next version, I would suggest this be added as a
makeshift or something of the like to eliminate any confusion on the
end-user.
sub CLONE { die __PACKAGE__ . &#39;does not support threads&#39; }

Thanks again, I look forward to the new version,

Evan

On 4/3/07, via RT &lt;bug-Cache-FastMmap@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=21242">http://rt.cpan.org/Ticket/Display.html?id=21242</a></span> &gt;
&gt;
<div class="message-stanza open">&gt; &gt; reproducible to date, on any Apache2-mpm-worker install w/
</div>&gt; Cache::FastMmap
&gt;
&gt; Ah, I just checked. I hadn&#39;t realised that mpm was a
&gt; multi-process/multi-threaded hybrid.
&gt;
&gt; Cache::FastMmap does not natively support a multi-threaded environment
&gt; at the moment. If you&#39;re so inclined, you could hack in your own CLONE
&gt; sub so that it reopens the cache file anew in the cloned thread, but
&gt; otherwise the current way perl clones objects when creating threads will
&gt; result in a double free when it tries to clean up.
&gt;
&gt; If you have a patch to make it work I&#39;ll look at adding it back, but for
&gt; now all I&#39;m going to do is add a note in the next version that it&#39;s not
&gt; thread safe.
&gt;
&gt; Rob
&gt;
&gt;
</div>

-- 
Evan Carroll
System Lord of the Internets
832-445-8877
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/306142/139040/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/139040">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-317660" href="/Public/Bug/Display.html?id=21242#txn-317660">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;07:35:05&nbsp;2007</span>
    <span class="description">cpan [...] robm.fastmail.fm -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/317660/144904/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/144904">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 619b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve just released 1.15 which adds the die in the CLONE sub. That at
least will stop people getting strange double free errors.

I thought about threads support, but it&#39;s a bit of a pain. Also I&#39;m not
really convinced that perl threads support where everything has to be
manually cloned makes the mixed process/thread model actually perform
better? I would have thought with the work that has gone into most OS&#39;s
with their COW forking and O&#40;1&#41; schedulers that the standard per-process
model would be actually better. Is there some benchmarks which show that
the mixed thread/process model does actually perform better?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-317662" href="/Public/Bug/Display.html?id=21242#txn-317662">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;07:35:22&nbsp;2007</span>
    <span class="description">cpan [...] robm.fastmail.fm -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318087" href="/Public/Bug/Display.html?id=21242#txn-318087">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;09&nbsp;01:59:53&nbsp;2007</span>
    <span class="description">melazyboy [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21242] *** glibc detected *** double free or corruption &#40;!prev&#41;: 0x00000000017e8d00 ***</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 9 May 2007 00:58:51 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Cache-FastMmap [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Evan Carroll&#34; &lt;melazyboy [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/318087/145158/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/145158">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It is well accepted that the threaded apache model is better, and more
flexible, whether there are advantages in perl is unknown by me. Though I
concede to having been told by others that ithreads aren&#39;t worth the time
for any advantage they might have over fork.

Evan


On 5/8/07, via RT &lt;bug-Cache-FastMmap@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=21242">http://rt.cpan.org/Ticket/Display.html?id=21242</a></span> &gt;
&gt;
&gt; I&#39;ve just released 1.15 which adds the die in the CLONE sub. That at
&gt; least will stop people getting strange double free errors.
&gt;
&gt; I thought about threads support, but it&#39;s a bit of a pain. Also I&#39;m not
&gt; really convinced that perl threads support where everything has to be
&gt; manually cloned makes the mixed process/thread model actually perform
&gt; better? I would have thought with the work that has gone into most OS&#39;s
&gt; with their COW forking and O&#40;1&#41; schedulers that the standard per-process
&gt; model would be actually better. Is there some benchmarks which show that
&gt; the mixed thread/process model does actually perform better?
&gt;
</div>


-- 
Evan Carroll
System Lord of the Internets
832-445-8877
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/318087/145159/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/145159">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.4k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318088" href="/Public/Bug/Display.html?id=21242#txn-318088">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;09&nbsp;01:59:56&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318478" href="/Public/Bug/Display.html?id=21242#txn-318478">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;10&nbsp;02:43:54&nbsp;2007</span>
    <span class="description">cpan [...] robm.fastmail.fm -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/318478/145355/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/145355">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 204b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Because this bug has a cryptic subject and information that&#39;s not
relevant, I&#39;ve created a new ticket related to threads support and I&#39;m
closing this one.

<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=27050">http://rt.cpan.org/Ticket/Display.html?id=27050</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318480" href="/Public/Bug/Display.html?id=21242#txn-318480">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;10&nbsp;02:43:56&nbsp;2007</span>
    <span class="description">cpan [...] robm.fastmail.fm -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.72144</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
