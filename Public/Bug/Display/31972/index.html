<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #31972 for Perl-Critic: PodSpelling/Open2 Kills Critic on Win32</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #31972 for Perl-Critic: PodSpelling/Open2 Kills Critic on Win32</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Critic/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/Perl-Critic/Perl-Critic/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Critic">Perl-Critic CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">31972</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Critic/Active/">Perl-Critic</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
claco [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-25198-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
1.07</li>
<li>
1.071</li>
<li>
1.072</li>
<li>
1.073</li>
<li>
1.074</li>
<li>
1.075_001</li>
<li>
1.076</li>
<li>
1.077</li>
<li>
1.078</li>
<li>
1.079_001</li>
<li>
1.079_002</li>
<li>
1.079_003</li>
<li>
1.080</li>
</ul>
    </td>
  </tr>
  <tr id="CF-25199-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




signature.asc<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/432814/211864/signature.asc">
Mon Mar 10 10:18:16 2008 (187b) by claco [...] chrislaco.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/432805/211855/signature.asc">
Mon Mar 10 10:09:28 2008 (187b) by claco [...] chrislaco.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/432441/211674/signature.asc">
Sun Mar 09 18:12:32 2008 (249b) by claco [...] chrislaco.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/404855/197278/signature.asc">
Wed Jan 02 14:57:18 2008 (187b) by claco [...] chrislaco.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/404798/197242/signature.asc">
Wed Jan 02 08:59:23 2008 (187b) by claco [...] chrislaco.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/404538/197082/signature.asc">
Tue Jan 01 12:11:08 2008 (249b) by claco [...] chrislaco.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;28&nbsp;14:16:31&nbsp;2007</span>
    <span class="description">claco [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The addition if the PodSpelling policy in 1.07+ has killed running
critic tests [with that policy enabled by default] on Win32 when aspell
is installed. The test script, and other critic scripts just hang,
waiting for a response it never gets. As far as I can tell, IPC::Open2
on win32 is borked.

If I rename/hide/uninstall aspell, the policy_podspelling.t tests
curiously pass. I&#39;d think those should fail since no spelling checking
was done. These passes I assume explain the PASS reports for win32 in
testers.

This was the same problem, from the Test::Spelling Changelog:

0.11  2005-11-15
        - Some documentation fixes.
        - Added note about per-file stopwords by Chris Dolan.
        - Use a temporary file instead of open2&#40;&#41; to solve win32 portability
          issues. &#40;Thanks to Chris Laco!&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;29&nbsp;21:45:51&nbsp;2007</span>
    <span class="description">ELLIOTJS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 29 Dec 2007 20:45:39 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;elliotjs [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Christopher H. Laco via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The addition if the PodSpelling policy in 1.07+ has killed running
&gt; critic tests [with that policy enabled by default] on Win32 when aspell
&gt; is installed. The test script, and other critic scripts just hang,
&gt; waiting for a response it never gets. As far as I can tell, IPC::Open2
&gt; on win32 is borked.
</div>
Joyous.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If I rename/hide/uninstall aspell, the policy_podspelling.t tests
&gt; curiously pass. I&#39;d think those should fail since no spelling checking
&gt; was done. These passes I assume explain the PASS reports for win32 in
&gt; testers.
</div>
Yup.  This policy looks for its configured spelling program &#40;which defaults to aspell&#41; and disables itself if it can&#39;t find it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;29&nbsp;21:45:53&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;01&nbsp;00:44:58&nbsp;2008</span>
    <span class="description">thaljef [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">So if I understand this correctly, we should not load this policy
$OSNAME eq &#39;win32&#39; &#38;&#38; $Pod::Spelling::VERSION &lt; 0.11.  Is that right?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;01&nbsp;12:11:08&nbsp;2008</span>
    <span class="description">claco [...] chrislaco.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> claco [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 01 Jan 2008 12:10:33 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christopher Laco &lt;claco [...] chrislaco.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Jeffrey Ryan Thalhammer via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=31972">http://rt.cpan.org/Ticket/Display.html?id=31972</a></span> &gt;
&gt; 
&gt; So if I understand this correctly, we should not load this policy
&gt; $OSNAME eq &#39;win32&#39; &#38;&#38; $Pod::Spelling::VERSION &lt; 0.11.  Is that right?
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
</div>

Based on a quick look at the source, Pod::Spelling does nothing but
extract words. It&#39;s the use of IPC::Open2 talking to aspell.exe that
kills iton win32. This is the same problem that Test::Spelling had with
it&#39;s use of Open2-&gt;aspell.exe.

The use of Open2 was ditchd in favor of temp files:

<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/diff?from=Test-Spelling-0.10&#38;to=Test-Spelling-0.11">http://search.cpan.org/diff?from=Test-Spelling-0.10&#38;to=Test-Spelling-0.11</a></span>

Now, I&#39;m not sure if there&#39;s a way to use Open2/Open3 or some other
method for win32, this is certainly one way.

I would think that an evev better way might be to use Text::Aspell
instead, which appears to use the aspell XS/lib rather than the
executable. Not sue the status of that module on win32.

-=Chris
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/404538/197082/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 249b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;01&nbsp;18:32:21&nbsp;2008</span>
    <span class="description">thaljef [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in svn revision 2087.  If it isn&#39;t too much trouble, could you try
it out for me?  Thanks.  Here&#39;s the url to the trunk:

<span class="clickylink"><a target="new" rel="nofollow" href="http://perlcritic.tigris.org/svn/perlcritic/trunk/Perl-Critic">http://perlcritic.tigris.org/svn/perlcritic/trunk/Perl-Critic</a></span>

login=&#34;guest&#34;
password=&#34;&#34;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;02&nbsp;08:59:21&nbsp;2008</span>
    <span class="description">claco [...] chrislaco.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> claco [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 02 Jan 2008 08:58:45 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Christopher H. Laco&#34; &lt;claco [...] chrislaco.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Jeffrey Ryan Thalhammer via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=31972">http://rt.cpan.org/Ticket/Display.html?id=31972</a></span> &gt;
&gt; 
&gt; Fixed in svn revision 2087.  If it isn&#39;t too much trouble, could you try
&gt; it out for me?  Thanks.  Here&#39;s the url to the trunk:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://perlcritic.tigris.org/svn/perlcritic/trunk/Perl-Critic">http://perlcritic.tigris.org/svn/perlcritic/trunk/Perl-Critic</a></span>
&gt; 
&gt; login=&#34;guest&#34;
&gt; password=&#34;&#34;
&gt; 
&gt; 
</div>

Looks like something isn&#39;t happy about spaces in the path to aspell:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; C:\Perl-Critic&gt;prove -l t/*spelling*.t
&gt; t/20_policy_podspelling......&#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; 
&gt; t/20_policy_podspelling......1/4 #   Failed test &#39;Mispelled header&#39;
&gt; #   at t/20_policy_podspelling.t line 55.
&gt; #          got: &#39;0&#39;
&gt; #     expected: &#39;1&#39;
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; 
&gt; #   Failed test &#39;Mispelled body&#39;
&gt; #   at t/20_policy_podspelling.t line 67.
&gt; #          got: &#39;0&#39;
&gt; #     expected: &#39;1&#39;
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; # Looks like you failed 2 tests of 4.
&gt; t/20_policy_podspelling...... Dubious, test returned 2 &#40;wstat 512, 0x200&#41;
&gt;  Failed 2/4 subtests
&gt; 
&gt; Test Summary Report
&gt; -------------------
&gt; t/20_policy_podspelling.t &#40;Wstat: 512 Tests: 4 Failed: 2&#41;
&gt;   Failed test number&#40;s&#41;:  1-2
&gt;   Non-zero exit status: 2
&gt; Files=1, Tests=4,  3 wallclock secs &#40; 0.01 usr +  0.01 sys =  0.02 CPU&#41;
&gt; Result: FAIL
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/404798/197242/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 187b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;02&nbsp;14:57:12&nbsp;2008</span>
    <span class="description">claco [...] chrislaco.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 02 Jan 2008 14:56:18 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Christopher H. Laco&#34; &lt;claco [...] chrislaco.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This fixes the error for me. No idea how portable this is:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; C:\Perl-Critic&gt;svn diff
&gt; Index: lib/Perl/Critic/Policy/Documentation/PodSpelling.pm
&gt; ===================================================================
&gt; --- lib/Perl/Critic/Policy/Documentation/PodSpelling.pm &#40;revision 2087&#41;
&gt; +++ lib/Perl/Critic/Policy/Documentation/PodSpelling.pm &#40;working copy&#41;
&gt; @@ -153,7 +153,7 @@
&gt;  sub _set_spell_command {
&gt;      my &#40; $self, $spell_command &#41; = @_;
&gt; 
&gt; -    $self-&gt;{_spell_command} = $spell_command;
&gt; +    $self-&gt;{_spell_command} = &#34;\&#34;$spell_command\&#34;&#34;;
&gt; 
&gt;      return;
&gt;  }
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/404855/197278/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 187b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;03&nbsp;00:04:58&nbsp;2008</span>
    <span class="description">ELLIOTJS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 02 Jan 2008 23:04:39 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;elliotjs [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">claco@chrislaco.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Perl-Critic
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=31972">http://rt.cpan.org/Ticket/Display.html?id=31972</a></span> &gt;
&gt; 
&gt; This fixes the error for me. No idea how portable this is:
</div>
Oog.  Not at all portable.  On Unix, this will attempt to invoke a command that has quotes in the name.  Not very likely to be correct.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;03&nbsp;00:09:07&nbsp;2008</span>
    <span class="description">jeffrey_thalhammer [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 3 Jan 2008 05:05:13 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org,undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jeffrey_thalhammer [...] yahoo.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I was thinking of using the shellwords&#40;&#41; function but I haven&#39;t tried it yet. 

Sent via BlackBerry by AT&#38;T
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;17:39:55&nbsp;2008</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 09 Mar 2008 16:39:35 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Kindly test v1.082.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;18:12:32&nbsp;2008</span>
    <span class="description">claco [...] chrislaco.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 09 Mar 2008 18:11:38 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christopher Laco &lt;claco [...] chrislaco.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Elliot Shank via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=31972">http://rt.cpan.org/Ticket/Display.html?id=31972</a></span> &gt;
&gt; 
&gt; Kindly test v1.082.
&gt; 
&gt; 
</div>
Having build problems.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; C:\Handel&gt;cpan -i Perl::Critic
&gt; CPAN: File::HomeDir loaded ok &#40;v0.67&#41;
&gt; Database was generated on Sun, 09 Mar 2008 21:57:15 GMT
&gt; Running install for module &#39;Perl::Critic&#39;
&gt; Running make for E/EL/ELLIOTJS/Perl-Critic-1.082.tar.gz
&gt; Checksum for C:\strawberry\cpan\sources\authors\id\E\EL\ELLIOTJS\Perl-Critic-1.082.tar.gz ok
&gt; 
&gt;   CPAN.pm: Going to build E/EL/ELLIOTJS/Perl-Critic-1.082.tar.gz
&gt; 
&gt; Checking whether your kit is complete...
&gt; Looks good
&gt; 
&gt; Checking prerequisites...
&gt; Looks good
&gt; 
&gt; Creating new &#39;Build&#39; script for &#39;Perl-Critic&#39; version &#39;1.082&#39;
&gt; 
&gt; Versions of optional/unlisted/indirect dependencies:
&gt; 
&gt;     Exporter = 5.62
&gt;     File::HomeDir = 0.67
&gt;     File::Which = 0.05
&gt;     IPC::Open2 = 1.02
&gt;     Perl::Tidy = 20071205
&gt;     Pod::Spell = 1.01
&gt;     Readonly::XS = not installed
&gt; Variable &#34;$nest&#34; is not available at &#40;re_eval 68&#41; line 2, &lt;DATA&gt; line 1002.
&gt; Variable &#34;$nest&#34; is not available at &#40;re_eval 69&#41; line 2, &lt;DATA&gt; line 1002.
&gt;     Regexp::Parser = 0.20
&gt;     Text::ParseWords = 3.26
&gt; 
&gt; C:\strawberry\perl\bin\perl.exe t\generate_without_optional_dependencies_wrappers.PL t\00_modules.t_without_optional_dependencies.t t\01_con
&gt; fig.t_without_optional_dependencies.t t\01_config_bad_perlcriticrc.t_without_optional_dependencies.t t\02_policy.t_without_optional_dependen
&gt; cies.t t\03_pragmas.t_without_optional_dependencies.t t\04_defaults.t_without_optional_dependencies.t t\05_utils.t_without_optional_dependen
&gt; cies.t t\05_utils_ppi.t_without_optional_dependencies.t t\06_violation.t_without_optional_dependencies.t t\07_perlcritic.t_without_optional_
&gt; dependencies.t t\08_document.t_without_optional_dependencies.t t\09_theme.t_without_optional_dependencies.t t\10_userprofile.t_without_optio
&gt; nal_dependencies.t t\11_policyfactory.t_without_optional_dependencies.t t\12_policylisting.t_without_optional_dependencies.t t\13_bundled_po
&gt; licies.t_without_optional_dependencies.t t\14_policy_parameters.t_without_optional_dependencies.t t\15_statistics.t_without_optional_depende
&gt; ncies.t t\20_policy_podspelling.t_without_optional_dependencies.t t\20_policy_requiretidycode.t_without_optional_dependencies.t t\80_policys
&gt; ummary.t_without_optional_dependencies.t t\92_memory_leaks.t_without_optional_dependencies.t t\94_includes.t_without_optional_dependencies.t
&gt; 
&gt; 
&gt; 
&gt; Generating tests that hide modules and then run other tests.
&gt; Could not figure out the name of the test to wrap from &#34;t\00_modules.t_without_optional_dependencies.t&#34;. at t\generate_without_optional_depe
&gt; ndencies_wrappers.PL line 39
&gt; t\generate_without_optional_dependencies_wrappers.PL failed at C:/strawberry/perl/lib/Module/Build/Base.pm line 2276.
&gt;   ELLIOTJS/Perl-Critic-1.082.tar.gz
&gt;   C:\strawberry\perl\bin\perl.exe ./Build -- NOT OK
&gt; Running Build test
&gt;   Can&#39;t test without successful make
&gt; Running Build install
&gt;   Make had returned bad status, install seems impossible
</div>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; C:\Handel&gt;perl -V
&gt; Summary of my perl5 &#40;revision 5 version 10 subversion 0&#41; configuration:
&gt;   Platform:
&gt;     osname=MSWin32, osvers=5.1, archname=MSWin32-x86-multi-thread
&gt;     uname=&#39;&#39;
&gt;     config_args=&#39;undef&#39;
&gt;     hint=recommended, useposix=true, d_sigaction=undef
&gt;     useithreads=define, usemultiplicity=define
&gt;     useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
&gt;     use64bitint=undef, use64bitall=undef, uselongdouble=undef
&gt;     usemymalloc=n, bincompat5005=undef
&gt;   Compiler:
&gt;     cc=&#39;gcc&#39;, ccflags =&#39; -s -O2 -DWIN32 -DHAVE_DES_FCRYPT  -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -fno-strict-aliasing -DPERL_MSVCRT_RE
&gt; ADFIX&#39;,
&gt;     optimize=&#39;-s -O2&#39;,
&gt;     cppflags=&#39;-DWIN32&#39;
&gt;     ccversion=&#39;&#39;, gccversion=&#39;3.4.5&#39;, gccosandvers=&#39;&#39;
&gt;     intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
&gt;     d_longlong=undef, longlongsize=8, d_longdbl=define, longdblsize=12
&gt;     ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;long long&#39;, lseeksize=8
&gt;     alignbytes=8, prototype=define
&gt;   Linker and Libraries:
&gt;     ld=&#39;g++&#39;, ldflags =&#39;-s -L&#34;C:\strawberry\perl\lib\CORE&#34; -L&#34;C:\strawberry\c\lib&#34;&#39;
&gt;     libpth=C:\strawberry\c\lib
&gt;     libs= -lmsvcrt -lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -l
&gt; ws2_32 -lmpr -lwinmm -lversion -lodbc32 -lodbccp32
&gt;     perllibs= -lmsvcrt -lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luui
&gt; d -lws2_32 -lmpr -lwinmm -lversion -lodbc32 -lodbccp32
&gt;     libc=-lmsvcrt, so=dll, useshrplib=true, libperl=libperl510.a
&gt;     gnulibc_version=&#39;&#39;
&gt;   Dynamic Linking:
&gt;     dlsrc=dl_win32.xs, dlext=dll, d_dlsymun=undef, ccdlflags=&#39; &#39;
&gt;     cccdlflags=&#39; &#39;, lddlflags=&#39;-mdll -s -L&#34;C:\strawberry\perl\lib\CORE&#34; -L&#34;C:\strawberry\c\lib&#34;&#39;
&gt; 
&gt; 
&gt; Characteristics of this binary &#40;from libperl&#41;:
&gt;   Compile-time options: MULTIPLICITY PERL_DONT_CREATE_GVSV
&gt;                         PERL_IMPLICIT_CONTEXT PERL_IMPLICIT_SYS
&gt;                         PERL_MALLOC_WRAP PL_OP_SLAB_ALLOC USE_ITHREADS
&gt;                         USE_LARGE_FILES USE_PERLIO
&gt;   Built under MSWin32
&gt;   Compiled at Dec 21 2007 14:11:41
&gt;   @INC:
&gt;     C:/strawberry/perl/lib
&gt;     C:/strawberry/perl/site/lib
&gt;     .
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/432441/211674/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 249b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;18:45:44&nbsp;2008</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 09 Mar 2008 17:45:27 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">claco@chrislaco.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Elliot Shank via RT wrote:
<div class="message-stanza open">&gt;&gt; Kindly test v1.082.
</div>&gt; 
&gt; Having build problems.
</div>
Why are you running author tests?  Author tests are not supported outside of our own environments.  Kindly unset TEST_AUTHOR and run again.

Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;10:09:27&nbsp;2008</span>
    <span class="description">claco [...] chrislaco.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 Mar 2008 10:08:23 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Christopher H. Laco&#34; &lt;claco [...] chrislaco.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here&#39;s sometime more real that works for me, after -x is checked:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; sub _derive_spell_command_line {
&gt;     my &#40;$self&#41; = @_;
&gt; 
&gt;     my @words = Text::ParseWords::shellwords&#40;$self-&gt;_get_spell_command&#40;&#41;&#41;;
&gt;     if &#40;!@words&#41; {
&gt;         return;
&gt;     }
&gt;     if &#40;! File::Spec-&gt;file_name_is_absolute&#40;$words[0]&#41;&#41; {
&gt;        $words[0] = File::Which::which&#40;$words[0]&#41;;
&gt;     }
&gt;     if &#40;! $words[0] || ! -x $words[0]&#41; {
&gt;         return;
&gt;     } else {
&gt;         $words[0] = &#39;&#34;&#39; . $words[0] . &#39;&#34;&#39;;
&gt;     }
&gt;     $self-&gt;_set_spell_command_line&#40;\@words&#41;;
&gt; 
&gt;     return $self-&gt;_get_spell_command_line&#40;&#41;;
&gt; }
</div>

That&#39;s probably not cross platform friendly...probably needs a Win32 
check around it. But it works for me. The warnings are gone, the tests 
pass &#40;and fail if I alter them&#41;, so I know aspell is actually being used.

-=Chris
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/432805/211855/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 187b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;10:18:13&nbsp;2008</span>
    <span class="description">claco [...] chrislaco.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 Mar 2008 09:46:36 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Christopher H. Laco&#34; &lt;claco [...] chrislaco.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Elliot Shank via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=31972">http://rt.cpan.org/Ticket/Display.html?id=31972</a></span> &gt;
&gt; 
&gt; claco@chrislaco.com via RT wrote:
<div class="message-stanza open">&gt;&gt; Elliot Shank via RT wrote:
<div class="message-stanza open">&gt;&gt;&gt; Kindly test v1.082.
</div>&gt;&gt; Having build problems.
</div>&gt; 
&gt; Why are you running author tests?  Author tests are not supported outside of our own environments.  Kindly unset TEST_AUTHOR and run again.
</div>
Well, because, I&#39;m an author on my machine...so TEST_AUTHOR=1 in my 
shell. Now interestingly enough, this didn&#39;t cause problems on OSX or 
*nix...only goes boom on Win32 with TEST_AUTHOR=1. But I digress....

With TEST_AUTHOR=0...

make test yields plenty of these:

     &#39;C:\Program&#39; is not recognized as an internal or external command

And my own critic tests no longer hang...but they also yield the 
warnings above, so I&#39;m not sure if they&#39;re really being spell checked at 
all.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; t/00_modules....................................ok
&gt; t/01_config.....................................&#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................5/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................18/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................21/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................31/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................34/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................58/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................66/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................71/? &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/01_config.....................................ok
&gt; t/01_config_bad_perlcriticrc....................ok
</div>[big snip]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; t/20_policy_podspelling......&#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/20_policy_podspelling......1/4 &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; t/20_policy_podspelling......ok
&gt; All tests successful.
&gt; Files=1, Tests=4,  2 wallclock secs &#40; 0.02 usr +  0.01 sys =  0.03 CPU&#41;
&gt; Result: PASS
</div>
In fact, I suspect this test unexpectedly succeeds when spelling isn&#39;t 
working:

I changed this:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; $code = &lt;&lt;&#39;END_PERL&#39;;
&gt; =head1 Test
&gt; 
&gt; arglbargl
&gt; 
&gt; =cut
&gt; END_PERL
&gt; 
&gt; is&#40; pcritique&#40;$policy, \$code, \%config&#41;, can_podspell&#40;&#41; ? 1 : 0, &#39;Mispelled body&#39; &#41;;
</div>
to this:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; $code = &lt;&lt;&#39;END_PERL&#39;;
&gt; =head1 Test
&gt; 
&gt; first
&gt; 
&gt; =cut
&gt; END_PERL
&gt; 
&gt; is&#40; pcritique&#40;$policy, \$code, \%config&#41;, can_podspell&#40;&#41; ? 1 : 0, &#39;Mispelled body&#39; &#41;;
</div>
in 20_policy_podspelling.t and the test still passes. No clue what that 
means. In the end, it looks like the spelling command is not being 
quoted... so open $command_line is running C:\Program, since there&#39;s a 
space in there...

This hackishly fixes the warning problem for me...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; sub _derive_spell_command_line {
&gt;     my &#40;$self&#41; = @_;
&gt; 
&gt;     my @words = Text::ParseWords::shellwords&#40;$self-&gt;_get_spell_command&#40;&#41;&#41;;
&gt;     if &#40;!@words&#41; {
&gt;         return;
&gt;     }
&gt;     if &#40;! File::Spec-&gt;file_name_is_absolute&#40;$words[0]&#41;&#41; {
&gt;        $words[0] = &#39;&#34;&#39; . File::Which::which&#40;$words[0]&#41; . &#39;&#34;&#39;;
&gt;     }
&gt;     if &#40;! $words[0] || ! -x $words[0]&#41; {
&gt;         return;
&gt;     }
&gt;     
&gt;     $self-&gt;_set_spell_command_line&#40;\@words&#41;;
&gt; 
&gt;     return $self-&gt;_get_spell_command_line&#40;&#41;;
&gt; }
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/432814/211864/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 187b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;16:41:44&nbsp;2008</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31972] PodSpelling/Open2 Kills Critic on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 Mar 2008 15:41:23 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">claco@chrislaco.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In fact, I suspect this test unexpectedly succeeds when spelling isn&#39;t 
&gt; working:
&gt; 
&gt; I changed this:
&gt; 
<div class="message-stanza open">&gt;&gt; $code = &lt;&lt;&#39;END_PERL&#39;;
&gt;&gt; =head1 Test
&gt;&gt;
&gt;&gt; arglbargl
&gt;&gt;
&gt;&gt; =cut
&gt;&gt; END_PERL
&gt;&gt;
&gt;&gt; is&#40; pcritique&#40;$policy, \$code, \%config&#41;, can_podspell&#40;&#41; ? 1 : 0, &#39;Mispelled body&#39; &#41;;
</div>&gt; 
&gt; to this:
&gt; 
<div class="message-stanza open">&gt;&gt; $code = &lt;&lt;&#39;END_PERL&#39;;
&gt;&gt; =head1 Test
&gt;&gt;
&gt;&gt; first
&gt;&gt;
&gt;&gt; =cut
&gt;&gt; END_PERL
&gt;&gt;
&gt;&gt; is&#40; pcritique&#40;$policy, \$code, \%config&#41;, can_podspell&#40;&#41; ? 1 : 0, &#39;Mispelled body&#39; &#41;;
</div>&gt; 
&gt; in 20_policy_podspelling.t and the test still passes. No clue what that 
&gt; means. In the end, it looks like the spelling command is not being 
&gt; quoted... so open $command_line is running C:\Program, since there&#39;s a 
&gt; space in there...
</div>
Oh, it most definitely will pass if P::C thinks spelling is broken.  It&#39;s designed to.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
