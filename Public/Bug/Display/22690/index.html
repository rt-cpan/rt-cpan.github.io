<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #22690 for Net-SNMP: get_table returns some junk entries</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #22690 for Net-SNMP: get_table returns some junk entries</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Net-SNMP">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Net-SNMP">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Net-SNMP">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Net-SNMP">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-SNMP">Net-SNMP CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">22690</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">15 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Net-SNMP">Net-SNMP</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">dtown [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
siemsen [...] ucar.edu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-23238-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
5.2.0    </td>
  </tr>
  <tr id="CF-23239-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
5.2.0    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




GetArpNew.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/257025/111343/GetArpNew.pl">
Sat Oct 28 19:46:01 2006 (5.1k) by siemsen [...] ucar.edu
</a>
</font></li>
</ul>


out.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/257025/111346/out.txt">
Sat Oct 28 19:46:01 2006 (5.7k) by siemsen [...] ucar.edu
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=22690">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257025" href="/Public/Bug/Display.html?id=22690#txn-257025">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;28&nbsp;19:46:01&nbsp;2006</span>
    <span class="description">siemsen [...] ucar.edu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> get_table returns some junk entries</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/257025/111340/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/111340">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The attached file named GetArpNew.pl contains a program that reliably
demonstrates the problem.  The comment at the top of the file describes
the problem.  The program contains some hard-coded device names and a
community string that you&#39;ll have to change.  I attached the output
of a run.  It shows that get_table basically works, and works
without error when talking to some of my routers.  When it fails,
some of the values in the table it returns are junk.  Most of the
table is fine - it&#39;s just some entries that are junk.  It produces
the same output on multiple runs.

Here&#39;s some details about my system:

$ perl -V
Summary of my perl5 &#40;revision 5 version 8 subversion 4&#41; configuration:
  Platform:
    osname=linux, osvers=2.6.15.6, archname=i386-linux-thread-multi
    uname=&#39;linux ernie 2.6.15.6 #1 thu mar 16 13:11:55 est 2006 i686
gnulinux &#39;
    config_args=&#39;-Dusethreads -Duselargefiles -Dccflags=-DDEBIAN
-Dcccdlflags=-fPIC -Darchname=i386-linux -Dprefix=/usr
-Dprivlib=/usr/share/perl/5.8 -Darchlib=/usr/lib/perl/5.8
-Dvendorprefix=/usr -Dvendorlib=/usr/share/perl5
-Dvendorarch=/usr/lib/perl5 -Dsiteprefix=/usr/local
-Dsitelib=/usr/local/share/perl/5.8.4
-Dsitearch=/usr/local/lib/perl/5.8.4 -Dman1dir=/usr/share/man/man1
-Dman3dir=/usr/share/man/man3 -Dsiteman1dir=/usr/local/man/man1
-Dsiteman3dir=/usr/local/man/man3 -Dman1ext=1 -Dman3ext=3perl
-Dpager=/usr/bin/sensible-pager -Uafs -Ud_csh -Uusesfio -Uusenm
-Duseshrplib -Dlibperl=libperl.so.5.8.4 -Dd_dosuid -des&#39;
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=define use5005threads=undef useithreads=define
usemultiplicity=define
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=undef use64bitall=undef uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS
-DDEBIAN -fno-strict-aliasing -I/usr/local/include -D_LARGEFILE_SOURCE
-D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-O2&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS -DDEBIAN
-fno-strict-aliasing -I/usr/local/include&#39;
    ccversion=&#39;&#39;, gccversion=&#39;3.3.5 &#40;Debian 1:3.3.5-13&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;,
lseeksize=8
    alignbytes=4, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39; -L/usr/local/lib&#39;
    libpth=/usr/local/lib /lib /usr/lib
    libs=-lgdbm -lgdbm_compat -ldb -ldl -lm -lpthread -lc -lcrypt
    perllibs=-ldl -lm -lpthread -lc -lcrypt
    libc=/lib/libc-2.3.2.so, so=so, useshrplib=true,
libperl=libperl.so.5.8.4
    gnulibc_version=&#39;2.3.2&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -L/usr/local/lib&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: MULTIPLICITY USE_ITHREADS USE_LARGE_FILES
PERL_IMPLICIT_CONTEXT
  Built under linux
  Compiled at May 10 2006 03:55:26
  @INC:
    /etc/perl
    /usr/local/lib/perl/5.8.4
    /usr/local/share/perl/5.8.4
    /usr/lib/perl5
    /usr/share/perl5
    /usr/lib/perl/5.8
    /usr/share/perl/5.8
    /usr/local/lib/site_perl
    .


The devices that I am accessing are Cisco routers.

If I can get past this bug, I&#39;d like to replace SNMP_Session
with Net::SNMP throughout my program.  It is faster than SNMP_Session.
One interesting thing: when I change the first argument from &#39;snmpv2&#39;
to &#39;snmpv1&#39;, Net::SNMP is significantly slower than SNMP_Session. I
would&#39;ve assumed that they&#39;d run with similar times.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> GetArpNew.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/257025/111343/GetArpNew.pl">Download GetArpNew.pl</a><br />
<span class="downloadcontenttype">text/x-perl 5.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w
#
#	GetArpWithNetSnmp.pl
#
# This program demonstrates a bug in the Net::SNMP Perl module.
#
# The program is a simplified version of a production program called
# GetArp.pl.  The real GetArp program has been running successfully
# for years.  It uses SNMP to retrieve ARP information from routers.
# It uses the SNMP_Session module to do the actual SNMP communication.
# The SNMP_Session module works fine, but it doesn&#39;t directly support
# GETBULK, or SNMPv3, and the API is cumbersome.  The Net::SNMP module
# seems to be more popular and more current, and it supports GETBULK
# and SNMPv3, and it has a much more convenient API.  I want to
# convert GetArp to use Net::SNMP.  I want the basic function of
# GetArp to stay the same, except that it might run faster due to
# GETBULK suppert.
#
# I&#39;m a suspicious person, so I wrote this progrom to test that
# Net::SNMP actually returns the same data as SNMP_Session.  This
# program does the same SNMP access using both modules.  The results
# should be the same.  They aren&#39;t.  Net::SNMP seems to have a bug.
#
# I&#39;ve removed all the extraneous stuff that doesn&#39;t have to do with SNMP.


use strict;
use FindBin;
use lib $FindBin::Bin;	   # find modules in the same dir as this file
use lib &#34;SNMP_Session-1.08/lib&#34;;  # find modules in SNMP lib directory
use SNMP_Session;
use BER;
use Net::SNMP 5.2.0 qw&#40;:snmp&#41;;
use Data::Dumper;
use Time::HiRes;


sub GetRouterArpTableUsingSnmpSession &#40;$$$&#41; {
  my $session = shift;
  my $routername = shift;
  my $Oid = shift;
  print &#34;Getting ARPs from $routername using SNMP_Session...\n&#34;;

  my&#40;$nxt_oid, $bindings, $binding, $value&#41;;
  my $orig_oid = encode_oid&#40;split /\./, $Oid&#41;;
  my $enoid = $orig_oid;
  my %table = &#40;&#41;;
  my $counter = 0;
  while &#40;$session-&gt;getnext_request_response&#40;&#40;$enoid&#41;&#41;&#41; {
    $counter ++;
    my $response = $session-&gt;pdu_buffer;
    &#40;$bindings&#41; = $session-&gt;decode_get_response &#40;$response&#41;;
    &#40;$binding, $bindings&#41; = decode_sequence &#40;$bindings&#41;;
    &#40;$nxt_oid, $value&#41; = decode_by_template &#40;$binding, &#34;%O%@&#34;&#41;;
    last unless BER::encoded_oid_prefix_p&#40;$orig_oid, $nxt_oid&#41;;
    my $p_oid = BER::pretty_oid $nxt_oid;
    my @snmpid = split /\./, $p_oid;
    my $mac=&#39;&#39;;
    foreach &#40;unpack &#34;xxCCCCCC&#34;, $value&#41; {
      $mac = $mac . sprintf &#34;%02x&#34;, $_;
    }
    my $ip = &#34;$snmpid[12].$snmpid[13].$snmpid[14].$snmpid[15]&#34;;
    $table{$ip} = $mac;
    $enoid = $nxt_oid;
  }
  print &#34;returning success, did $counter requests\n&#34;;
  return &#40;%table&#41;;
}


sub GetRouterArpTableUsingNetSnmp &#40;$$$&#41; {
  my $Session = shift;
  my $RouterName = shift;
  my $Oid = shift;
  print &#34;Getting ARPs from $RouterName using Net::Snmp...\n&#34;;
  my $Arps = $Session-&gt;get_table&#40;$Oid&#41;;
  if &#40;!defined&#40;$Arps&#41;&#41; {
    my $tmp = $Session-&gt;error&#40;&#41;;
    print &#34;couldn&#39;t get SNMP values, $tmp\n&#34;;
  }
  my %table = &#40;&#41;;
  foreach my $RetOid &#40;keys %{$Arps}&#41; {
    my $newoid = $RetOid;
    $newoid =~ s/^\.1\.3\.6\.1\.2\.1\.3\.1\.1\.2\.\d+\.\d+\.//;  # strip off the leading oid octets
    my $newmac = $$Arps{$RetOid};
    $newmac =~ s/^0x//;   # strip aff the leading &#34;0x&#34;
    $table{$newoid} = $newmac;
  }
  print &#34;returning success\n&#34;;
  return &#40;%table&#41;;
}


#
# Main.  ======================================================================
#

my @routers = &#40;&#41;;
push @routers, &#39;blura&#39;;
push @routers, &#39;cg-voipr&#39;;
push @routers, &#39;cgra&#39;;
push @routers, &#39;cgrb&#39;;
push @routers, &#39;fl-voipr&#39;;
push @routers, &#39;flra&#39;;
push @routers, &#39;flrb&#39;;
push @routers, &#39;jef-voipr&#39;;
push @routers, &#39;jeffcor&#39;;
push @routers, &#39;marshallr&#39;;
push @routers, &#39;mlra&#39;;
push @routers, &#39;voip1r&#39;;
foreach my $RouterName &#40;@routers&#41; {
  print &#34;reading ARP table from $RouterName...\n&#34;;

  my $Community = &#39;ncar-read&#39;;
  my $Oid = &#39;.1.3.6.1.2.1.3.1.1.2&#39;;   # the ARP table

#=============================================================================
#  Try it using SNMP_Session
  my &#40;$seconds, $microseconds&#41; = Time::HiRes::gettimeofday;
  my $session = SNMP_Session-&gt;open&#40;$RouterName,
				   $Community,
				   161&#41;;
  if &#40;!$session&#41; {
    die &#34;couldn&#39;t open SNMP session to $RouterName, returning\n&#34;;
  }
  my %Arp = GetRouterArpTableUsingSnmpSession&#40;$session, $RouterName, $Oid&#41;;
  $session-&gt;close&#40;&#41;;
  my $elapsed = Time::HiRes::tv_interval&#40;[$seconds, $microseconds]&#41;;
  print &#34;SNMP_Session took $elapsed seconds\n&#34;;
#  print Dumper \%Arp;

#=============================================================================
# Try it using Net::SNMP
  &#40;$seconds, $microseconds&#41; = Time::HiRes::gettimeofday;
  my &#40;$Session, $Error&#41; = Net::SNMP-&gt;session&#40;
					     -version   =&gt; &#39;snmpv2&#39;,
					     -timeout   =&gt; 2,
					     -hostname  =&gt; $RouterName,
					     -community =&gt; $Community
					    &#41;;
  if &#40;!defined&#40;$Session&#41;&#41; {
    die &#34;couldn&#39;t open SNMP session to $RouterName: $Error&#34;;
  }
  my %Arp2 = GetRouterArpTableUsingNetSnmp&#40;$Session, $RouterName, $Oid&#41;;
  $Session-&gt;close;
  my $elapsed = Time::HiRes::tv_interval&#40;[$seconds, $microseconds]&#41;;
  print &#34;Net::SNMP took $elapsed seconds\n&#34;;
#  print Dumper \%Arp2;

#=============================================================================
# compare the results
  foreach my $Ip &#40;keys %Arp&#41; {
    if &#40;$Arp{$Ip} ne $Arp2{$Ip}&#41; {
      my $tmp1 = $Arp{$Ip};
      my $tmp2 = $Arp2{$Ip};
      print &#34;Arp{$Ip} = \&#34;$tmp1\&#34;, NOT EQUAL TO Arp2{$Ip} = \&#34;$tmp2\&#34;\n&#34;;
    }
  }
}
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> out.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/257025/111346/out.txt">Download out.txt</a><br />
<span class="downloadcontenttype">text/plain 5.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">���������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Give even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257157" href="/Public/Bug/Display.html?id=22690#txn-257157">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;09:17:34&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Given to DTOWN</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257165" href="/Public/Bug/Display.html?id=22690#txn-257165">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;09:29:14&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">5 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/257165/111413/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/111413">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 850b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">What you are seeing is the expected behavior of the module. The
Net::SNMP module has translation enabled by default. When an OCTET
STRING is received, the contents of the string are checked to make sure
that all octets are printable. If any octet is not printable, the string
is translated into the hexadecimal representation.  If all of the octets
are considered printable by the module, then no translation takes place
&#40;which is what is happening in your case&#41;.  See ticket #18699
&#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=18699&#41;">https://rt.cpan.org/Ticket/Display.html?id=18699&#41;</a></span> for a more detailed
explanation.

Without further examination of what is going on, I can only guess on why
SNMPv2c is faster than SNMPv1.  The underlying framework for both v1 and
v2 is the same, however the get_table&#40;&#41; method uses get-bulk-requests
when the version is set to v2 instead of get-next-request.

-David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257166" href="/Public/Bug/Display.html?id=22690#txn-257166">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;09:29:15&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257168" href="/Public/Bug/Display.html?id=22690#txn-257168">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;09:29:15&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257170" href="/Public/Bug/Display.html?id=22690#txn-257170">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;09:30:06&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Fixed in 5.2.0 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257171" href="/Public/Bug/Display.html?id=22690#txn-257171">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;09:31:23&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Reference to https://rt.cpan.org/Ticket/Display.html?id=18699 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257277" href="/Public/Bug/Display.html?id=22690#txn-257277">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;15:17:26&nbsp;2006</span>
    <span class="description">siemsen [...] ucar.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #22690] get_table returns some junk entries </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Oct 2006 13:16:47 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SNMP [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Pete Siemsen &lt;siemsen [...] ucar.edu&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/257277/111492/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/111492">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">That explains the problem, and the solution described in ticket  
#18699 fixes the problem.

Thank you very much!

-- Pete



On Oct 30, 2006, at 7:29 AM, via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=22690">http://rt.cpan.org/Ticket/Display.html?id=22690</a></span> &gt;
&gt;
&gt; What you are seeing is the expected behavior of the module. The
&gt; Net::SNMP module has translation enabled by default. When an OCTET
&gt; STRING is received, the contents of the string are checked to make  
&gt; sure
&gt; that all octets are printable. If any octet is not printable, the  
&gt; string
&gt; is translated into the hexadecimal representation.  If all of the  
&gt; octets
&gt; are considered printable by the module, then no translation takes  
&gt; place
&gt; &#40;which is what is happening in your case&#41;.  See ticket #18699
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=18699&#41;">https://rt.cpan.org/Ticket/Display.html?id=18699&#41;</a></span> for a more detailed
&gt; explanation.
&gt;
&gt; Without further examination of what is going on, I can only guess  
&gt; on why
&gt; SNMPv2c is faster than SNMPv1.  The underlying framework for both  
&gt; v1 and
&gt; v2 is the same, however the get_table&#40;&#41; method uses get-bulk-requests
&gt; when the version is set to v2 instead of get-next-request.
&gt;
&gt; -David
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/257277/111493/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/111493">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257278" href="/Public/Bug/Display.html?id=22690#txn-257278">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;30&nbsp;15:17:28&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257624" href="/Public/Bug/Display.html?id=22690#txn-257624">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;31&nbsp;22:28:19&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257635" href="/Public/Bug/Display.html?id=22690#txn-257635">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;31&nbsp;22:33:00&nbsp;2006</span>
    <span class="description">siemsen [...] ucar.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #22690] Resolved: get_table returns some junk entries </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 31 Oct 2006 20:32:19 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SNMP [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Pete Siemsen &lt;siemsen [...] ucar.edu&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/257635/111715/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/111715">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 301b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">My request has been resolved.  Thanks!

-- Pete



On Oct 31, 2006, at 8:28 PM, via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=22690">http://rt.cpan.org/Ticket/Display.html?id=22690</a></span> &gt;
&gt;
&gt; According to our records, your request has been resolved. If you  
&gt; have any
&gt; further questions or concerns, please respond to this message.
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/257635/111716/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/111716">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.5k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-257636" href="/Public/Bug/Display.html?id=22690#txn-257636">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;31&nbsp;22:33:03&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-277461" href="/Public/Bug/Display.html?id=22690#txn-277461">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;20&nbsp;08:44:53&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">10 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/277461/124120/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/124120">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 50b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Closing ticket which I thought was already closed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-277463" href="/Public/Bug/Display.html?id=22690#txn-277463">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;20&nbsp;08:44:58&nbsp;2006</span>
    <span class="description">dtown [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.58892</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
