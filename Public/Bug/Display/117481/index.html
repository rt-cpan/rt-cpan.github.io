<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #117481 for Crypt-OpenSSL-RSA: Compiliation fails with OpenSSL 1.1</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #117481 for Crypt-OpenSSL-RSA: Compiliation fails with OpenSSL 1.1</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Crypt-OpenSSL-RSA/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Crypt-OpenSSL-RSA/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Crypt-OpenSSL-RSA/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Crypt-OpenSSL-RSA/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Crypt-OpenSSL-RSA">Crypt-OpenSSL-RSA CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">117481</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Crypt-OpenSSL-RSA/Active/">Crypt-OpenSSL-RSA</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
KENTNL [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
gregoa [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8536-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8537-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;04&nbsp;01:56:48&nbsp;2016</span>
    <span class="description">KENTNL [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Compiliation fails with OpenSSL 1.1</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza"><p>
	OpenSSL 1.1 is breaking all the things without warning and its a $adjectives{big}[int(rand*1000)] map { $expletives[int(rand*1000)] } 1, 2</p>

<p>
	Attached is the build log from gentoo building it showing the compile failure ( cf: <span class="clickylink"><a target="new" rel="nofollow" href="https://bugs.gentoo.org/show_bug.cgi?id=592534">https://bugs.gentoo.org/show_bug.cgi?id=592534</a></span> )</p>

<p>
	&nbsp;</p>

<p>
	&nbsp;</p>

<p>
	&nbsp;</p>

<p>
	&nbsp;</p>


</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> build.log</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"> * Package:    dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2
 * Repository: gentoo
 * Maintainer: perl@gentoo.org
 * USE:        abi_x86_64 amd64 elibc_glibc kernel_linux userland_GNU
 * FEATURES:   preserve-libs sandbox userpriv usersandbox
&gt;&gt;&gt; Unpacking source...
&gt;&gt;&gt; Unpacking Crypt-OpenSSL-RSA-0.28.tar.gz to /var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/work
&gt;&gt;&gt; Source unpacked in /var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/work
&gt;&gt;&gt; Preparing source in /var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/work/Crypt-OpenSSL-RSA-0.28 ...
&gt;&gt;&gt; Source prepared.
&gt;&gt;&gt; Configuring source in /var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/work/Crypt-OpenSSL-RSA-0.28 ...
 * Using ExtUtils::MakeMaker
 * perl Makefile.PL PREFIX=/usr INSTALLDIRS=vendor INSTALLMAN3DIR=none DESTDIR=/var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/image/
Checking if your kit is complete...
Looks good
Generating a Unix-style Makefile
Writing Makefile for Crypt::OpenSSL::RSA
Writing MYMETA.yml and MYMETA.json
&gt;&gt;&gt; Source configured.
&gt;&gt;&gt; Compiling source in /var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/work/Crypt-OpenSSL-RSA-0.28 ...
 * emake OTHERLDFLAGS=-Wl,-O1 -Wl,--hash-style=gnu -Wl,--sort-common -Wl,--as-needed
make -j1 &#39;OTHERLDFLAGS=-Wl,-O1 -Wl,--hash-style=gnu -Wl,--sort-common -Wl,--as-needed&#39; 
cp RSA.pm blib/lib/Crypt/OpenSSL/RSA.pm
AutoSplitting blib/lib/Crypt/OpenSSL/RSA.pm &#40;blib/lib/auto/Crypt/OpenSSL/RSA&#41;
Running Mkbootstrap for Crypt::OpenSSL::RSA &#40;&#41;
chmod 644 &#34;RSA.bs&#34;
&#34;/usr/bin/perl&#34; &#34;/usr/lib64/perl5/5.24.0/ExtUtils/xsubpp&#34;  -typemap &#34;/usr/lib64/perl5/5.24.0/ExtUtils/typemap&#34; -typemap &#34;typemap&#34;  RSA.xs &gt; RSA.xsc &#38;&#38; mv RSA.xsc RSA.c
x86_64-pc-linux-gnu-gcc -c   -fwrapv -fno-strict-aliasing -pipe -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -march=native -mtune=native -O2 -pipe   -DVERSION=\&#34;0.28\&#34; -DXS_VERSION=\&#34;0.28\&#34; -fPIC &#34;-I/usr/lib64/perl5/5.24.0/x86_64-linux/CORE&#34;  -DPERL5 -DOPENSSL_NO_KRB5 RSA.c
RSA.xs: In function â_is_privateâ:
RSA.xs:52:22: error: dereferencing pointer to incomplete type âRSA {aka struct rsa_st}â
     return&#40;p_rsa-&gt;rsa-&gt;d != NULL&#41;;
                      ^
RSA.xs: In function âXS_Crypt__OpenSSL__RSA_generate_keyâ:
RSA.xs:301:26: warning: implicit declaration of function âRSA_generate_keyâ [-Wimplicit-function-declaration]
     CHECK_OPEN_SSL&#40;rsa = RSA_generate_key&#40;SvIV&#40;bitsSV&#41;, exponent, NULL, NULL&#41;&#41;;
                          ^
RSA.xs:41:40: note: in definition of macro âCHECK_OPEN_SSLâ
 #define CHECK_OPEN_SSL&#40;p_result&#41; if &#40;!&#40;p_result&#41;&#41; croakSsl&#40;__FILE__, __LINE__&#41;;
                                        ^
RSA.xs:301:24: warning: assignment makes pointer from integer without a cast [-Wint-conversion]
     CHECK_OPEN_SSL&#40;rsa = RSA_generate_key&#40;SvIV&#40;bitsSV&#41;, exponent, NULL, NULL&#41;&#41;;
                        ^
RSA.xs:41:40: note: in definition of macro âCHECK_OPEN_SSLâ
 #define CHECK_OPEN_SSL&#40;p_result&#41; if &#40;!&#40;p_result&#41;&#41; croakSsl&#40;__FILE__, __LINE__&#41;;
                                        ^
RSA.xs: In function âboot_Crypt__OpenSSL__RSAâ:
RSA.xs:214:5: warning: implicit declaration of function âERR_load_crypto_stringsâ [-Wimplicit-function-declaration]
     ERR_load_crypto_strings&#40;&#41;;
     ^
make: *** [Makefile:349: RSA.o] Error 1
 * ERROR: dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2::gentoo failed &#40;compile phase&#41;:
 *   emake failed
 * 
 * If you need support, post the output of `emerge --info &#39;=dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2::gentoo&#39;`,
 * the complete build log and the output of `emerge -pqv &#39;=dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2::gentoo&#39;`.
 * The complete build log is located at &#39;/var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/temp/build.log&#39;.
 * The ebuild environment file is located at &#39;/var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/temp/environment&#39;.
 * Working directory: &#39;/var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/work/Crypt-OpenSSL-RSA-0.28&#39;
 * S: &#39;/var/tmp/portage/dev-perl/Crypt-OpenSSL-RSA-0.280.0-r2/work/Crypt-OpenSSL-RSA-0.28&#39;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;04&nbsp;01:57:00&nbsp;2016</span>
    <span class="description">KENTNL [...] cpan.org -  Reference to https://bugs.gentoo.org/show_bug.cgi?id=592534 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;13&nbsp;12:43:02&nbsp;2016</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ppisar [...] redhat.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dne Ne 04.zář.2016 01:56:48, KENTNL napsal&#40;a&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; OpenSSL 1.1 is breaking all the things
</div>
Attached patch fixes it for me. I did not addressed the warning about deprecated RSA_generate_key&#40;&#41;.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0001-Adapt-to-OpenSSL-1.1.0.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From b3747e625780be90dcff11c2d9e91048016bb4d0 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Petr=20P=C3=ADsa=C5=99?= &lt;ppisar@redhat.com&gt;
Date: Thu, 13 Oct 2016 18:14:17 +0200
Subject: [PATCH] Adapt to OpenSSL 1.1.0
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

OpenSSL 1.1.0 hid structure internals and provided methods for getting
and settting the internal values. This patch modifes the code so that
it can be built with OpenSSL 1.1.0 as well as with the older one.

CPAN RT#117481

Signed-off-by: Petr PÃ­saÅ &lt;ppisar@redhat.com&gt;
---
 RSA.xs | 89 ++++++++++++++++++++++++++++++++++++++++++++++++++++++------------
 1 file changed, 73 insertions&#40;+&#41;, 16 deletions&#40;-&#41;

diff --git a/RSA.xs b/RSA.xs
index de512e7..9bf6f01 100644
--- a/RSA.xs
+++ b/RSA.xs
@@ -49,7 +49,13 @@ void croakSsl&#40;char* p_file, int p_line&#41;
 
 char _is_private&#40;rsaData* p_rsa&#41;
 {
-    return&#40;p_rsa-&gt;rsa-&gt;d != NULL&#41;;
+    const BIGNUM *d;
+#if OPENSSL_VERSION_NUMBER &lt; 0x10100000L
+    d = p_rsa-&gt;rsa-&gt;d;
+#else
+    RSA_get0_key&#40;p_rsa-&gt;rsa, NULL, NULL, &#38;d&#41;;
+#endif
+    return&#40;d != NULL&#41;;
 }
 
 SV* make_rsa_obj&#40;SV* p_proto, RSA* p_rsa&#41;
@@ -136,7 +142,7 @@ unsigned char* get_message_digest&#40;SV* text_SV, int hash_method&#41;
     }
 }
 
-SV* bn2sv&#40;BIGNUM* p_bn&#41;
+SV* bn2sv&#40;const BIGNUM* p_bn&#41;
 {
     return p_bn != NULL
         ? sv_2mortal&#40;newSViv&#40;&#40;IV&#41; BN_dup&#40;p_bn&#41;&#41;&#41;
@@ -317,6 +323,9 @@ _new_key_from_parameters&#40;proto, n, e, d, p, q&#41;
     BN_CTX* ctx;
     BIGNUM* p_minus_1 = NULL;
     BIGNUM* q_minus_1 = NULL;
+    BIGNUM* dmp1 = NULL;
+    BIGNUM* dmq1 = NULL;
+    BIGNUM* iqmp = NULL;
     int error;
   CODE:
 {
@@ -325,8 +334,10 @@ _new_key_from_parameters&#40;proto, n, e, d, p, q&#41;
         croak&#40;&#34;At least a modulous and public key must be provided&#34;&#41;;
     }
     CHECK_OPEN_SSL&#40;rsa = RSA_new&#40;&#41;&#41;;
+#if OPENSSL_VERSION_NUMBER &lt; 0x10100000L
     rsa-&gt;n = n;
     rsa-&gt;e = e;
+#endif
     if &#40;p || q&#41;
     {
         error = 0;
@@ -341,8 +352,12 @@ _new_key_from_parameters&#40;proto, n, e, d, p, q&#41;
             q = BN_new&#40;&#41;;
             THROW&#40;BN_div&#40;q, NULL, n, p, ctx&#41;&#41;;
         }
+#if OPENSSL_VERSION_NUMBER &lt; 0x10100000L
         rsa-&gt;p = p;
         rsa-&gt;q = q;
+#else
+        THROW&#40;RSA_set0_factors&#40;rsa, p, q&#41;&#41;;
+#endif
         THROW&#40;p_minus_1 = BN_new&#40;&#41;&#41;;
         THROW&#40;BN_sub&#40;p_minus_1, p, BN_value_one&#40;&#41;&#41;&#41;;
         THROW&#40;q_minus_1 = BN_new&#40;&#41;&#41;;
@@ -353,17 +368,32 @@ _new_key_from_parameters&#40;proto, n, e, d, p, q&#41;
             THROW&#40;BN_mul&#40;d, p_minus_1, q_minus_1, ctx&#41;&#41;;
             THROW&#40;BN_mod_inverse&#40;d, e, d, ctx&#41;&#41;;
         }
+#if OPENSSL_VERSION_NUMBER &lt; 0x10100000L
         rsa-&gt;d = d;
-        THROW&#40;rsa-&gt;dmp1 = BN_new&#40;&#41;&#41;;
-        THROW&#40;BN_mod&#40;rsa-&gt;dmp1, d, p_minus_1, ctx&#41;&#41;;
-        THROW&#40;rsa-&gt;dmq1 = BN_new&#40;&#41;&#41;;
-        THROW&#40;BN_mod&#40;rsa-&gt;dmq1, d, q_minus_1, ctx&#41;&#41;;
-        THROW&#40;rsa-&gt;iqmp = BN_new&#40;&#41;&#41;;
-        THROW&#40;BN_mod_inverse&#40;rsa-&gt;iqmp, q, p, ctx&#41;&#41;;
+#else
+        THROW&#40;RSA_set0_key&#40;rsa, n, e, d&#41;&#41;;
+#endif
+        THROW&#40;dmp1 = BN_new&#40;&#41;&#41;;
+        THROW&#40;BN_mod&#40;dmp1, d, p_minus_1, ctx&#41;&#41;;
+        THROW&#40;dmq1 = BN_new&#40;&#41;&#41;;
+        THROW&#40;BN_mod&#40;dmq1, d, q_minus_1, ctx&#41;&#41;;
+        THROW&#40;iqmp = BN_new&#40;&#41;&#41;;
+        THROW&#40;BN_mod_inverse&#40;iqmp, q, p, ctx&#41;&#41;;
+#if OPENSSL_VERSION_NUMBER &lt; 0x10100000L
+        rsa-&gt;dmp1 = dmp1;
+        rsa-&gt;dmq1 = dmq1;
+        rsa-&gt;iqmp = iqmp;
+#else
+        THROW&#40;RSA_set0_crt_params&#40;rsa, dmp1, dmq1, iqmp&#41;&#41;;
+#endif
+        dmp1 = dmq1 = iqmp = NULL;
         THROW&#40;RSA_check_key&#40;rsa&#41; == 1&#41;;
      err:
         if &#40;p_minus_1&#41; BN_clear_free&#40;p_minus_1&#41;;
         if &#40;q_minus_1&#41; BN_clear_free&#40;q_minus_1&#41;;
+        if &#40;dmp1&#41; BN_clear_free&#40;dmp1&#41;;
+        if &#40;dmq1&#41; BN_clear_free&#40;dmq1&#41;;
+        if &#40;iqmp&#41; BN_clear_free&#40;iqmp&#41;;
         if &#40;ctx&#41; BN_CTX_free&#40;ctx&#41;;
         if &#40;error&#41;
         {
@@ -373,7 +403,11 @@ _new_key_from_parameters&#40;proto, n, e, d, p, q&#41;
     }
     else
     {
+#if OPENSSL_VERSION_NUMBER &lt; 0x10100000L
         rsa-&gt;d = d;
+#else
+        CHECK_OPEN_SSL&#40;RSA_set0_key&#40;rsa, n, e, d&#41;&#41;;
+#endif
     }
     RETVAL = make_rsa_obj&#40;proto, rsa&#41;;
 }
@@ -383,18 +417,41 @@ _new_key_from_parameters&#40;proto, n, e, d, p, q&#41;
 void
 _get_key_parameters&#40;p_rsa&#41;
     rsaData* p_rsa;
+PREINIT:
+    const BIGNUM* n;
+    const BIGNUM* e;
+    const BIGNUM* d;
+    const BIGNUM* p;
+    const BIGNUM* q;
+    const BIGNUM* dmp1;
+    const BIGNUM* dmq1;
+    const BIGNUM* iqmp;
 PPCODE:
 {
     RSA* rsa;
     rsa = p_rsa-&gt;rsa;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;n&#41;&#41;;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;e&#41;&#41;;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;d&#41;&#41;;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;p&#41;&#41;;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;q&#41;&#41;;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;dmp1&#41;&#41;;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;dmq1&#41;&#41;;
-    XPUSHs&#40;bn2sv&#40;rsa-&gt;iqmp&#41;&#41;;
+#if OPENSSL_VERSION_NUMBER &lt; 0x10100000L
+    n = rsa-&gt;n;
+    e = rsa-&gt;e;
+    d = rsa-&gt;d;
+    p = rsa-&gt;p;
+    q = rsa-&gt;q;
+    dmp1 = rsa-&gt;dmp1;
+    dmq1 = rsa-&gt;dmq1;
+    iqmp = rsa-&gt;iqmp;
+#else
+    RSA_get0_key&#40;rsa, &#38;n, &#38;e, &#38;d&#41;;
+    RSA_get0_factors&#40;rsa, &#38;p, &#38;q&#41;;
+    RSA_get0_crt_params&#40;rsa, &#38;dmp1, &#38;dmq1, &#38;iqmp&#41;;
+#endif
+    XPUSHs&#40;bn2sv&#40;n&#41;&#41;;
+    XPUSHs&#40;bn2sv&#40;e&#41;&#41;;
+    XPUSHs&#40;bn2sv&#40;d&#41;&#41;;
+    XPUSHs&#40;bn2sv&#40;p&#41;&#41;;
+    XPUSHs&#40;bn2sv&#40;q&#41;&#41;;
+    XPUSHs&#40;bn2sv&#40;dmp1&#41;&#41;;
+    XPUSHs&#40;bn2sv&#40;dmq1&#41;&#41;;
+    XPUSHs&#40;bn2sv&#40;iqmp&#41;&#41;;
 }
 
 SV*
-- 
2.7.4

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;13&nbsp;12:43:03&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;28&nbsp;18:16:59&nbsp;2016</span>
    <span class="description">gregoa [...] cpan.org -  Cc GREGOA added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;28&nbsp;18:17:00&nbsp;2016</span>
    <span class="description">gregoa [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The Debian bug tracker also has patches:
<span class="clickylink"><a target="new" rel="nofollow" href="https://bugs.debian.org/828387">https://bugs.debian.org/828387</a></span>

Cheers,
gregor, Debian Perl Group
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;26&nbsp;10:16:50&nbsp;2016</span>
    <span class="description">gregoa [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Any news here? Is either Petr&#39;s patch from here or Sebastian&#39;s patch from the Debian bug tracker or something else going to be applied to the upstream code? Or can we at least come to a common patch applied downstream in various Linux distributions?

Cheers,
gregor
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;23&nbsp;03:24:03&nbsp;2017</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2016-09-04 01:56:48, KENTNL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; OpenSSL 1.1 is breaking all the things without warning and its a
&gt; $adjectives{big}[int&#40;rand*1000&#41;] map { $expletives[int&#40;rand*1000&#41;] }
&gt; 1, 2
</div>
CPAN.pm users may install the following distroprefs file for automatically applying PPISAR&#39;s patch:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/eserte/srezic-cpan-distroprefs/blob/master/Crypt-OpenSSL-RSA.yml">https://github.com/eserte/srezic-cpan-distroprefs/blob/master/Crypt-OpenSSL-RSA.yml</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;17&nbsp;05:35:48&nbsp;2017</span>
    <span class="description">ANDK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> mbradshaw [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Meanwhile CPAN user MBRADSHAW stepped forward with disputable idea to upload MBRADSHAW/Crypt-OpenSSL-RSA-0.28.tar.gz.

Now we have two implamentations with same version number on CPAN, one authorized, the other not, one broken, one probably not.

The CPAN does not forbid such an upload, but nonetheless it can cause confusion and should at least be backed by appropriate communication. Maybe that communication took place?

My plea: could one of the people with upload permissions &#40;IROBERTS,PERLER,TODDR&#41; make a new authorized release with a bumped version number, or develop another idea how to resolve the issue to the effect that end users can use CPAN with a less frustrating experience?

Thanks,
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;17&nbsp;06:02:00&nbsp;2017</span>
    <span class="description">mbradshaw [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Apoligies for the confusion.
MBRADSHAW/Crypt-OpenSSL-RSA-0.28.tar.gz should not have been indexed, and was already deleted some time ago, curious to know how and where you found it?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;17&nbsp;09:49:26&nbsp;2018</span>
    <span class="description">RANDIR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve sent email with the current status, patch links and request for an update to all module&#39;s CPAN maintainers.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;12&nbsp;18:02:12&nbsp;2018</span>
    <span class="description">NERDVANA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Arch Linux now requires the patch as well.

I was trying to reinstall Crypt::LE and is module is a dependency.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;04&nbsp;07:45:55&nbsp;2018</span>
    <span class="description">onken [...] netcubed.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">version 0.29 was just released to CPAN
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;04&nbsp;07:45:57&nbsp;2018</span>
    <span class="description">onken [...] netcubed.de -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
