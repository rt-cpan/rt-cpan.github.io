<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #49303 for devel-nytprof: Option to force NYTProf to survive truncation</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #49303 for devel-nytprof: Option to force NYTProf to survive truncation</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/devel-nytprof/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/devel-nytprof/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/devel-nytprof/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/devel-nytprof/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/timbunce/devel-nytprof/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/devel-nytprof">devel-nytprof CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">49303</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/devel-nytprof/Active/">devel-nytprof</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
adamk [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-221012-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-221013-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;31&nbsp;21:05:54&nbsp;2009</span>
    <span class="description">adamk [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Option to force NYTProf to survive truncation</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">During a significant production performance event yesterday, we
attempted to diagnose the problem by replicating the production dataset
to a test environment and running the same code &#40;a batch-mode
application&#41; for the previous and current releases under NYTProf.

Since the size of the performance problem was 2 orders of magnitude
&#40;someone allowed an O&#40;n^2&#41; to slip into some ancillary code&#41; it should
have been easy to find the problem with only a minute or two out of the
2 hour batch run.

However, we encountered problems with nytprofhtml during this process,
because the mechanism by which we aborted the batch result seemed to
result in an immediate exit that somehow failed to cleanup properly.

Despite having all of the data from the run, nytprofhtml refused to
generate the report because the file was &#34;truncated&#34;.

In many scenarios, this kind of thing is actually likely. NYTProf runs
on applications that end with a segfault or some other kind of failure,
for example.

If there is any way to allow it, we would greatly appreciate some kind
of --force style option that tells NYTProf to NOT fail on truncated dump
files, and at least make a &#34;best guess&#34; of how the program ended.

If it can survive unclean exits up to and including a seg fault or hard
power failure, that would be awesome.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;01&nbsp;04:48:07&nbsp;2009</span>
    <span class="description">Tim.Bunce [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49303] Option to force NYTProf to survive truncation</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 1 Sep 2009 09:47:08 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Adam Kennedy via RT &lt;bug-devel-nytprof [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tim Bunce &lt;Tim.Bunce [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Aug 31, 2009 at 09:06:01PM -0400, Adam Kennedy via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; However, we encountered problems with nytprofhtml during this process,
&gt; because the mechanism by which we aborted the batch result seemed to
&gt; result in an immediate exit that somehow failed to cleanup properly.
&gt; 
&gt; Despite having all of the data from the run, nytprofhtml refused to
&gt; generate the report because the file was &#34;truncated&#34;.
</div>
Strictly speaking &#34;somehow failed to cleanup properly&#34; means that it
didn&#39;t have &#34;all of the data from the run&#34;. I presume you&#39;re refering to
the pre-END phase, or perhaps pre-global-destruction.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In many scenarios, this kind of thing is actually likely. NYTProf runs
&gt; on applications that end with a segfault or some other kind of failure,
&gt; for example.
</div>
There&#39;s a fair bit of data that can only be written to the file when the
profile is being completed.

A simple workaround could be just adding:

    END { DB::finish_profile&#40;&#41; }

<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~timb/Devel-NYTProf-2.10/lib/Devel/NYTProf.pm#RUN-TIME_CONTROL_OF_PROFILING">http://search.cpan.org/~timb/Devel-NYTProf-2.10/lib/Devel/NYTProf.pm#RUN-TIME_CONTROL_OF_PROFILING</a></span>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If there is any way to allow it, we would greatly appreciate some kind
&gt; of --force style option that tells NYTProf to NOT fail on truncated dump
&gt; files, and at least make a &#34;best guess&#34; of how the program ended.
</div>
Try hacking it to not croak and see how far you get. It might not take much.

&#40;I&#39;m swamped at the moment trying to find an elegant solution to the
exception-thrown-from-xsub road block I&#39;m currently facing.&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If it can survive unclean exits up to and including a seg fault or hard
&gt; power failure, that would be awesome.
</div>
You might want to also use compress=0 so you loose less unflushed data.

Tim.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;01&nbsp;04:48:08&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;01&nbsp;20:55:27&nbsp;2009</span>
    <span class="description">adam [...] ali.as -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49303] Option to force NYTProf to survive  truncation</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 2 Sep 2009 10:55:08 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-devel-nytprof [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">2009/9/1 Tim Bunce via RT &lt;bug-devel-nytprof@rt.cpan.org&gt;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Strictly speaking &#34;somehow failed to cleanup properly&#34; means that it
&gt; didn&#39;t have &#34;all of the data from the run&#34;. I presume you&#39;re refering to
&gt; the pre-END phase, or perhaps pre-global-destruction.
</div>
Possibly. Wearing the hat of a naive user, all I&#39;m seeing is that I
CTRL-C or SIGHUP or SIGKILL or segfault or $whatever, and it doesn&#39;t
work.

A lack of knowledge of the internal state and the failure mode for the
software is part of the reason that I&#39;m using NYTPRof in the first
place.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; In many scenarios, this kind of thing is actually likely. NYTProf runs
&gt;&gt; on applications that end with a segfault or some other kind of failure,
&gt;&gt; for example.
</div>&gt;
&gt; There&#39;s a fair bit of data that can only be written to the file when the
&gt; profile is being completed.
&gt;
&gt; A simple workaround could be just adding:
&gt;
&gt;    END { DB::finish_profile&#40;&#41; }
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~timb/Devel-NYTProf-2.10/lib/Devel/NYTProf.pm#RUN-TIME_CONTROL_OF_PROFILING">http://search.cpan.org/~timb/Devel-NYTProf-2.10/lib/Devel/NYTProf.pm#RUN-TIME_CONTROL_OF_PROFILING</a></span>
&gt;
<div class="message-stanza open">&gt;&gt; If there is any way to allow it, we would greatly appreciate some kind
&gt;&gt; of --force style option that tells NYTProf to NOT fail on truncated dump
&gt;&gt; files, and at least make a &#34;best guess&#34; of how the program ended.
</div>&gt;
&gt; Try hacking it to not croak and see how far you get. It might not take much.
</div>
It&#39;s a 250k line of code bohemoth, &#34;hacking it not to croak&#34; is a
little tricky :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#40;I&#39;m swamped at the moment trying to find an elegant solution to the
&gt; exception-thrown-from-xsub road block I&#39;m currently facing.&#41;
</div>
There is no urgency to this request, we worked around the problem and
got our results. But while the problem of profiling runs aborting for
uncontrolled reasons was fresh in my mind, I wanted to dump it into RT
so it could be addressed at a later time.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; If it can survive unclean exits up to and including a seg fault or hard
&gt;&gt; power failure, that would be awesome.
</div>&gt;
&gt; You might want to also use compress=0 so you loose less unflushed data.
</div>
I&#39;ll have a look at that and see if it helps.

Adam K
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;27&nbsp;22:11:33&nbsp;2009</span>
    <span class="description">hanenkamp [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Sep 01 20:55:27 2009, adam@ali.as wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2009/9/1 Tim Bunce via RT &lt;bug-devel-nytprof@rt.cpan.org&gt;:
<div class="message-stanza open">&gt; &gt;
&gt; &gt; A simple workaround could be just adding:
&gt; &gt;
&gt; &gt;    END { DB::finish_profile&#40;&#41; }
&gt; &gt;
</div></div>
I&#39;ve found it may also help to do this in $SIG{INT}:

$SIG{INT} = sub { DB::finish_profile&#40;&#41;; exit 1; };

This was helpful while debugging a Catalyst HTTP server. It might be
useful to document this clearly in the CAVEAT section or somewhere
obvious. The existing documentation on finish_profile&#40;&#41; doesn&#39;t really
make it clear that this is the solution to many database file errors.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;28&nbsp;05:03:05&nbsp;2009</span>
    <span class="description">Tim.Bunce [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49303] Option to force NYTProf to survive truncation</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 28 Sep 2009 10:02:39 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Andrew Sterling Hanenkamp via RT &lt;bug-devel-nytprof [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tim Bunce &lt;Tim.Bunce [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, Sep 27, 2009 at 10:11:34PM -0400, Andrew Sterling Hanenkamp via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I&#39;ve found it may also help to do this in $SIG{INT}:
&gt; 
&gt; $SIG{INT} = sub { DB::finish_profile&#40;&#41;; exit 1; };
&gt; 
&gt; This was helpful while debugging a Catalyst HTTP server. It might be
&gt; useful to document this clearly in the CAVEAT section or somewhere
&gt; obvious. The existing documentation on finish_profile&#40;&#41; doesn&#39;t really
&gt; make it clear that this is the solution to many database file errors.
</div>
Great idea. Thanks.

Taking that a little further, it would be handy to have an option to
enable that for INT and perhaps some other signals. Something like this:

--- lib/Devel/NYTProf/Core.pm   &#40;revision 862&#41;
+++ lib/Devel/NYTProf/Core.pm   &#40;working copy&#41;
@@ -22,6 +22,13 @@
     for my $optval &#40; $NYTPROF =~ /&#40;&#40;?:[^\\:]+|\\.&#41;+&#41;/g&#41; {
         my &#40;$opt, $val&#41; = $optval =~ /^&#40;&#40;?:[^\\=]+|\\.&#41;+&#41;=&#40;&#40;?:[^\\=]+|\\.&#41;+&#41;\z/;
         s/\\&#40;.&#41;/$1/g for $opt, $val;
+
+        if &#40;$opt eq &#39;sigend&#39; &#38;&#38; $val&#41; {
+            my @sigs = &#40;$val eq &#39;1&#39;&#41; ? qw&#40;INT HUP PIPE BUS SEGV&#41; : split&#40;/,/, $val&#41;;
+            $SIG{uc $_} = sub { DB::finish_profile&#40;&#41;; exit 1; } for @sigs;
+            next;
+        }
+
         DB::set_option&#40;$opt, $val&#41;;
     }
 }

Then you wouldn&#39;t have to mess with the code.

Tim.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;24&nbsp;10:31:27&nbsp;2009</span>
    <span class="description">TIMB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m going to call this ticket resolved by the addition of the sigexit option.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;24&nbsp;10:31:28&nbsp;2009</span>
    <span class="description">TIMB [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
