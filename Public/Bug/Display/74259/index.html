<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #74259 for Perl-Dist-Strawberry: Better handling of MSI upgrading</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #74259 for Perl-Dist-Strawberry: Better handling of MSI upgrading</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Dist-Strawberry/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Dist-Strawberry/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Dist-Strawberry/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Dist-Strawberry/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Dist-Strawberry">Perl-Dist-Strawberry CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">74259</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Dist-Strawberry/Active/">Perl-Dist-Strawberry</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
willi.weikum [...] googlemail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40214-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40215-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;23&nbsp;07:17:50&nbsp;2012</span>
    <span class="description">willi.weikum [...] googlemail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> strawberry-perl-5.14.2.0-64bit.msi</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 23 Jan 2012 13:17:42 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Willi Weikum &lt;willi.weikum [...] googlemail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I tried to install the beta package
strawberry-perl-5.14.2.0-64bit.msi&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://strawberry-perl.googlecode.com/files/strawberry-perl-5.14.2.0-64bit.msi">http://strawberry-perl.googlecode.com/files/strawberry-perl-5.14.2.0-64bit.msi</a></span>&gt;
but
failed. CPAN installed complained about missing perl512.dll. First i tried
to update my existing installation of 5.12.2 then tried to remove both
installation and clean install but it did&#39;t helped. The error was allways
the same. Now I moved to 5.12.3 which is working fine.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;25&nbsp;16:57:04&nbsp;2012</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza">Could you please try 5.14.2.1 from <span class="clickylink"><a target="new" rel="nofollow" href="http://strawberryperl.com/">http://strawberryperl.com/</a></span><br>

<br>

--<br>

kmx<br>

<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;25&nbsp;16:57:06&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;04:41:05&nbsp;2012</span>
    <span class="description">willi.weikum [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #74259] strawberry-perl-5.14.2.0-64bit.msi</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 27 Feb 2012 10:40:52 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Willi Weikum &lt;willi.weikum [...] googlemail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">5.14.2.1 istalled without any errors but the installation is brocken.
First I tried to update my installation the msi package installed without
errors perl -v started fine and displayed perl 5.12.2 but cpan started but
failed with following error when you call &lt;i module&gt;:

The crash data is:

Problemsignatur:
  Problemereignisname: APPCRASH
  Anwendungsname: perl.exe
  Anwendungsversion: 0.0.0.0
  Anwendungszeitstempel: 4ecc19ef
  Fehlermodulname: perl512.dll
  Fehlermodulversion: 0.0.0.0
  Fehlermodulzeitstempel: 4dcff714
  Ausnahmecode: c0000005
  Ausnahmeoffset: 00000000000b52d5
  Betriebsystemversion: 6.1.7601.2.1.0.256.4
  Gebietsschema-ID: 1031
  Zusatzinformation 1: 722e
  Zusatzinformation 2: 722e045be211e93d1f7ff7b00a916a1a
  Zusatzinformation 3: db7f
  Zusatzinformation 4: db7fe216ea465604d4b5ae737369b8d4

just wondering why perl512.dll is still in use...

Next I removed previous strawberry installation and installed
strawberry-perl-5.14.2.1-64bit.msi. The istallation finished without errors
again.
This time cpan client starts but displays following error wenn you call &lt;i
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">module&gt;:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">cpan&gt; i Win32::guitest
</div>Database was generated on Mon, 27 Feb 2012 09:10:18 GMT
Catching error: &#34;install_driver&#40;SQLite&#41; failed: Can&#39;t load
&#39;C:\\strawberry\\perl
\\site\\lib/auto/DBD/SQLite/SQLite.dll&#39; for module DBD::SQLite:
load_file:Das an
gegebene Modul wurde nicht gefunden at
C:\\strawberry\\perl\\lib/DynaLoader.pm l
ine 190, &lt;IN&gt; line 1.\cJ at &#40;eval 44&#41; line 3\cJCompilation failed in
require at
&#40;eval 44&#41; line 3, &lt;IN&gt; line 1.\cJPerhaps a required shared library or dll
isn&#39;t
installed where expected\cJ at
C:\\strawberry\\perl\\vendor\\lib/CPAN/SQLite/DBI
.pm line 78\cJ&#34; at C:/strawberry/perl/lib/CPAN.pm line 392
        CPAN::shell&#40;&#41; called at C:/strawberry/perl/lib/App/Cpan.pm line 295
        App::Cpan::_process_options&#40;&#39;App::Cpan&#39;&#41; called at
C:/strawberry/perl/li
b/App/Cpan.pm line 364
        App::Cpan::run&#40;&#39;App::Cpan&#39;&#41; called at
C:\strawberry\perl\bin\cpan.bat li
ne 21



On Sat, Feb 25, 2012 at 10:57 PM, kmx via RT &lt;
bug-Perl-Dist-Strawberry@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=74259">https://rt.cpan.org/Ticket/Display.html?id=74259</a></span> &gt;
&gt;
&gt; Could you please try 5.14.2.1 from <span class="clickylink"><a target="new" rel="nofollow" href="http://strawberryperl.com/">http://strawberryperl.com/</a></span>
&gt;
&gt; --
&gt; kmx
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;05:11:25&nbsp;2012</span>
    <span class="description">willi.weikum [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #74259] strawberry-perl-5.14.2.0-64bit.msi</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 27 Feb 2012 11:11:14 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Willi Weikum &lt;willi.weikum [...] googlemail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The problem is caused by a c:\strawberry folder which exists even after
deinstallation of strawberry. After the folder has been deleted strawberry
5.14.2.1 and cpan clients work fine.

Could you please check if the package can be changed in a was you can
update the previous release. It&#39;s allways a pain to reinstall all the
modules.

On Mon, Feb 27, 2012 at 10:40 AM, Willi Weikum
&lt;willi.weikum@googlemail.com&gt;wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 5.14.2.1 istalled without any errors but the installation is brocken.
&gt; First I tried to update my installation the msi package installed without
&gt; errors perl -v started fine and displayed perl 5.12.2 but cpan started but
&gt; failed with following error when you call &lt;i module&gt;:
&gt;
&gt; The crash data is:
&gt;
&gt; Problemsignatur:
&gt;   Problemereignisname: APPCRASH
&gt;   Anwendungsname: perl.exe
&gt;   Anwendungsversion: 0.0.0.0
&gt;   Anwendungszeitstempel: 4ecc19ef
&gt;   Fehlermodulname: perl512.dll
&gt;   Fehlermodulversion: 0.0.0.0
&gt;   Fehlermodulzeitstempel: 4dcff714
&gt;   Ausnahmecode: c0000005
&gt;   Ausnahmeoffset: 00000000000b52d5
&gt;   Betriebsystemversion: 6.1.7601.2.1.0.256.4
&gt;   Gebietsschema-ID: 1031
&gt;   Zusatzinformation 1: 722e
&gt;   Zusatzinformation 2: 722e045be211e93d1f7ff7b00a916a1a
&gt;   Zusatzinformation 3: db7f
&gt;   Zusatzinformation 4: db7fe216ea465604d4b5ae737369b8d4
&gt;
&gt; just wondering why perl512.dll is still in use...
&gt;
&gt; Next I removed previous strawberry installation and installed
&gt; strawberry-perl-5.14.2.1-64bit.msi. The istallation finished without errors
&gt; again.
&gt; This time cpan client starts but displays following error wenn you call &lt;i
<div class="message-stanza open">&gt; module&gt;:
</div>&gt;
<div class="message-stanza open">&gt; cpan&gt; i Win32::guitest
</div>&gt; Database was generated on Mon, 27 Feb 2012 09:10:18 GMT
&gt; Catching error: &#34;install_driver&#40;SQLite&#41; failed: Can&#39;t load
&gt; &#39;C:\\strawberry\\perl
&gt; \\site\\lib/auto/DBD/SQLite/SQLite.dll&#39; for module DBD::SQLite:
&gt; load_file:Das an
&gt; gegebene Modul wurde nicht gefunden at
&gt; C:\\strawberry\\perl\\lib/DynaLoader.pm l
&gt; ine 190, &lt;IN&gt; line 1.\cJ at &#40;eval 44&#41; line 3\cJCompilation failed in
&gt; require at
&gt; &#40;eval 44&#41; line 3, &lt;IN&gt; line 1.\cJPerhaps a required shared library or dll
&gt; isn&#39;t
&gt; installed where expected\cJ at
&gt; C:\\strawberry\\perl\\vendor\\lib/CPAN/SQLite/DBI
&gt; .pm line 78\cJ&#34; at C:/strawberry/perl/lib/CPAN.pm line 392
&gt;         CPAN::shell&#40;&#41; called at C:/strawberry/perl/lib/App/Cpan.pm line 295
&gt;         App::Cpan::_process_options&#40;&#39;App::Cpan&#39;&#41; called at
&gt; C:/strawberry/perl/li
&gt; b/App/Cpan.pm line 364
&gt;         App::Cpan::run&#40;&#39;App::Cpan&#39;&#41; called at
&gt; C:\strawberry\perl\bin\cpan.bat li
&gt; ne 21
&gt;
&gt;
&gt;
&gt; On Sat, Feb 25, 2012 at 10:57 PM, kmx via RT &lt;
&gt; bug-Perl-Dist-Strawberry@rt.cpan.org&gt; wrote:
&gt;
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=74259">https://rt.cpan.org/Ticket/Display.html?id=74259</a></span> &gt;
&gt;&gt;
&gt;&gt; Could you please try 5.14.2.1 from <span class="clickylink"><a target="new" rel="nofollow" href="http://strawberryperl.com/">http://strawberryperl.com/</a></span>
&gt;&gt;
&gt;&gt; --
&gt;&gt; kmx
&gt;&gt;
&gt;&gt;
</div>&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction other SystemError even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;05:11:26&nbsp;2012</span>
    <span class="description">The RT System itself -  System error</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sending the previous mail has failed.  Please contact your admin, they can find more details in the logs.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;06:00:21&nbsp;2012</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Better handle MSI upgrading</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Could you please check if the package can be changed in a was you can <br>

&gt; update the previous release. It's allways a pain to reinstall all the <br>

&gt; modules. <br>
</div><br>

What should be possible is to upgrade 5.12.x to 5.12.y<br>

<br>

If changing 5.12.x to 5.14.x it is necessary to reinstall all XS modules as they are simply not binary compatible.<br>

<br>

Definitely upgrading part of MSI needs some improvements.<br>

<br>

--<br>

kmx<br>

<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;27&nbsp;06:00:47&nbsp;2012</span>
    <span class="description">kmx [...] cpan.org -  Subject changed from &#39;strawberry-perl-5.14.2.0-64bit.msi&#39; to &#39;Better handling of MSI upgrading&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;04&nbsp;05:15:37&nbsp;2012</span>
    <span class="description">willi.weikum [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #74259] Better handle MSI upgrading</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 4 Mar 2012 11:15:27 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Willi Weikum &lt;willi.weikum [...] googlemail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ok I understand. What do think about automatic deinstalltion of previous
version the user is going to do a major update? I know it&#39;s possible to
detect installed product versions via MSI.

On Mon, Feb 27, 2012 at 12:00 PM, kmx via RT &lt;
bug-Perl-Dist-Strawberry@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=74259">https://rt.cpan.org/Ticket/Display.html?id=74259</a></span> &gt;
&gt;
<div class="message-stanza open">&gt; &gt; Could you please check if the package can be changed in a was you can
&gt; &gt; update the previous release. It&#39;s allways a pain to reinstall all the
&gt; &gt; modules.
</div>&gt;
&gt; What should be possible is to upgrade 5.12.x to 5.12.y
&gt;
&gt; If changing 5.12.x to 5.14.x it is necessary to reinstall all XS modules as
&gt; they are simply not binary compatible.
&gt;
&gt; Definitely upgrading part of MSI needs some improvements.
&gt;
&gt; --
&gt; kmx
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;20&nbsp;14:16:45&nbsp;2012</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza">On Sun Mar 04 05:15:37 2012, willi.weikum@googlemail.com wrote: <br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Ok I understand. What do think about automatic deinstalltion of <br>

&gt; previous&nbsp; version the user is going to do a major update? <br>

&gt; I know it's possible to detect installed product versions via MSI. <br>
</div><br>

In 5.16.x series I&nbsp;have fixed this, the MSi installer works like this:<br>

<br>

1/ if you have too old version (5.14.x) already installed, installer shows error message saying &quot;uninstall first&quot; end exits (I was not able to properly manage automatic uninstall)<br>

<br>

2/ if you have a version that can bu upgraded it is automatically uninstalled first - the &quot;perl/site&quot; directory is not deleted; then the new version is installed (modules previously installed into &quot;perl/site&quot; should work after this upgrade)<br>

<br>

3/ If you choose to uninstall manually (via Control Panel)&nbsp; it now correctly also deletes &quot;perl/site&quot; directory and the whole c:\strawberry dir.<br>

<br>

4/ MSI's marked as &quot;BETA&quot; have intentionally disabled upgrade feature described in 2/ (as for betas it IMHO makes more troubles than added value)<br>

<br>

Unfortunately this is not gonna work if you are upgrading from old buggy MSI's (e.g. 5.14.2.1)<br>

<br>

After releasing 5.16.0.1 I am gonna close this RT.<br>

<br>

Anyway thanks for your time spent on this issue.<br>

<br>

--<br>

kmx<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;25&nbsp;08:35:01&nbsp;2012</span>
    <span class="description">kmx [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
