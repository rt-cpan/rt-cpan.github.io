<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #62018 for Workflow: feature request - specify &#34;static&#34; arguments to the actions</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #62018 for Workflow: feature request - specify &#34;static&#34; arguments to the actions</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Workflow/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Workflow/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Workflow/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Workflow/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/jonasbn/perl-workflow/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Workflow">Workflow CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">62018</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Workflow/Active/">Workflow</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">jonasbn [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
luismiguelferreirasilva [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35958-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35959-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;09&nbsp;14:55:10&nbsp;2010</span>
    <span class="description">luismiguelferreirasilva [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> feature request - specify &#34;static&#34; arguments to the actions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 9 Oct 2010 12:54:42 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Workflow [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Luis Miguel Silva &lt;luismiguelferreirasilva [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear Pel Workflow devs,

I would like to start by thanking you all for the awesome job you did
with the Perl Workflow module.
I&#39;ve been researching for a workflow engine i could use in my projects
and your module is really sweet!

I just recently started using it so i&#39;m still getting to know all the details.
But one of the things i noticed is that i could not find any
documentation &#40;or even figure out how to do it, even browsing through
the code&#41; is the ability to specify static arguments to the actions!

I was really excited to find out how powerful the module already is as
i could easily create loop and if conditions with it.
But what i&#39;m really needing right now is the ability to do something like this:
&lt;workflow&gt;
  &lt;type&gt;myworkflow&lt;/type&gt;
  &lt;description&gt;This is my workflow.&lt;/description&gt;
  &lt;persister&gt;MainPersister&lt;/persister&gt;
  &lt;state name=&#34;INITIAL&#34;&gt;
    &lt;description&gt;this is the initial state&lt;/description&gt;
    &lt;action name=&#34;create file&#34;&gt;
        &lt;resulting_state return=&#34;OK&#34; state=&#34;created file&#34; /&gt;
        &lt;resulting_state return=&#34;*&#34; state=&#34;error_handler&#34; /&gt;
    &lt;/action&gt;
  &lt;/state&gt;
  &lt;state name=&#34;error_handler&#34; autorun=&#34;yes&#34;&gt;
    &lt;action name=&#34;log_error&#34; resulting_state=&#34;failed&#34;&gt;
      &lt;condition test=&#34;defined $context-&gt;{error_message}&#34; /&gt;
    &lt;/action&gt;
    &lt;!-- even if we cant find anything to log, we still want to fail! --&gt;
    &lt;action name=&#34;null&#34; resulting_state=&#34;failed&#34;&gt;
      &lt;condition test=&#34;!defined $context-&gt;{error_message}&#34; /&gt;
    &lt;/action&gt;
  &lt;/state&gt;
&lt;/workflow&gt;

And then have my log_error action configured like this:
&lt;actions&gt;
  &lt;action name=&#34;log_error&#34; class=&#34;MyApp::Action::LogError&#34;&gt;
     &lt;param name=&#34;log_message&#34; value=&#34;An error occurred:
$context-&gt;{error_message}&#34;/&gt;
  &lt;/action&gt;
&lt;/actions&gt;

Just so you better understand what i&#39;m trying to do, i&#39;m basically
creating a bunch of reutilizable modules and trying to create a
project that will allow people to either develop extra modules OR use
the pre existing ones and not have to develop a single line of code!

The objective is that people can fully customize their workflow logic,
just by editing the xml flows &#40;which, in my opinion, is the whole
purpose of using a workflow engine ;o&#41;&#41;.

Another really cool feature would be the ability to run multiple
actions when &#34;autorun&#34; is specified:
  &lt;state name=&#34;verified file&#34; autorun=&#34;yes&#34;&gt;
    &lt;action name=&#34;always_gets_run&#34; resulting_state=&#34;verified file&#34;
run_order=&#34;1&#34;/&gt;
    &lt;action name=&#34;does_not_get_run&#34; resulting_state=&#34;loop_example&#34;
run_order=&#34;2&#34;/&gt;
  &lt;/state&gt;

Right now, when autorun is activated, the flow will only run one if
there is only one action inside OR multiple actions do not conflict
with each other.
It would be a HUGE enhancement to be able to specify a &#34;run_order&#34; so
that individual states could have multiple actions!

I obviously understand this is a community so...if we want something
done, we should try and do it ourselves heheh ;o&#41;
But i thought i would send out an email to send all you guys my
appreciation and try to understand if this already exists? &#40;also
because i really believe it would be really useful for other users and
because i&#39;m a novice perl coder and don&#39;t want to write something that
will never make it to the official repo :oP&#41;.

Thanks a lot!
Luis
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;09&nbsp;20:46:06&nbsp;2010</span>
    <span class="description">luismiguelferreirasilva [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62018] AutoReply: feature request - specify &#34;static&#34; arguments to the actions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 9 Oct 2010 18:45:37 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Workflow [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Luis Miguel Silva &lt;luismiguelferreirasilva [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oh k, so i just found out how to pass static parameters to actions! :o&#41;&#41;

It turns out you can ALSO use &lt;param&gt; tags inside &lt;action&gt; tags! :o&#41;&#41;

Here it is &#40;in case anybody else needs this in the future&#41;:
  &lt;action name=&#34;log_error&#34; class=&#34;MyApp::Action::LogError&#34; &gt;
    &lt;field name=&#34;error_message&#34;
           description=&#34;template error message&#34;
           is_required=&#34;yes&#34; /&gt;
    &lt;param name=&#34;message_format&#34; value=&#34;here is what i saw: %s&#34;/&gt;
    &lt;param name=&#34;something&#34; value=&#34;else&#34; /&gt;
    &lt;param name=&#34;else&#34; value=&#34;something&#34; /&gt;
  &lt;/action&gt;

And your action can access it like this:
[root@xcat workflow_tests]# cat MyApp/Action/LogError.pm
package MyApp::Action::LogError;

use strict;
use base qw&#40; Workflow::Action &#41;;
use Log::Log4perl qw&#40; get_logger &#41;;
use Workflow::History;
use Workflow::Exception qw&#40;
          condition_error
          workflow_error&#41;;
#use Workflow::Exception qw&#40; workflow_error &#41;;

$MyApp::Action::LogError::VERSION = &#39;1.00&#39;;

sub execute {
    my &#40; $self, $wf &#41; = @_;
    my $log = get_logger&#40;&#41;;
    $log-&gt;debug&#40; &#34;Action &#39;&#34;, $self-&gt;name, &#34;&#39; with class &#34;,
                 &#34;&#39;&#34;, ref&#40; $self &#41;, &#34;&#39; executing...&#34; &#41;;
    ####################### THE PARAMETERS ARE AVAILABLE INSIDE THE
$self hash &#40;$self-&gt;{&#39;PARAMS&#39;}&#41;
    #print Data::Dumper-&gt;Dump&#40;[$self]&#41;;
    ####################### SO HERE IS AN EXAMPLE ON HOW TO ACCESS THE
FIRST PARAMETER...
    #print &#34;param key is: &#34; . $self-&gt;{&#39;PARAMS&#39;}{&#39;param&#39;}[0]{&#39;name&#39;} . &#34;\n&#34;;
    #print &#34;param value is: &#34; . $self-&gt;{&#39;PARAMS&#39;}{&#39;param&#39;}[0]{&#39;value&#39;} . &#34;\n&#34;;
    ####################### OR COUNT HOW MANY PARAMETERS THERE ARE...
    #my $count = scalar &#40;@{$self-&gt;{&#39;PARAMS&#39;}{&#39;param&#39;}}&#41;;
    #print &#34;there are &#34; . $count . &#34; parameters!\n&#34;;


    # OR CYCLE THROUGH THEM ALL UNTIL YOU FIND THE ONE YOU ARE LOOKING FOR ;o&#41;
    my $message_format;

    foreach &#40;@{$self-&gt;{&#39;PARAMS&#39;}{&#39;param&#39;}}&#41;
    {
      my %tmp_hash = %{$_};
      #print &#34;\tname: &#34; . $tmp_hash{&#39;name&#39;} . &#34;\n&#34;;
      #print &#34;\tvalue: &#34; . $tmp_hash{&#39;value&#39;} . &#34;\n&#34;;
      #print &#34;\t######################\n&#34;;
      if &#40;$tmp_hash{&#39;name&#39;} eq &#39;message_format&#39;&#41;
      {
        $message_format = $tmp_hash{&#39;value&#39;};
      }
    }

    my $error_message = sprintf&#40;$message_format, $wf-&gt;context-&gt;param&#40;
&#39;error_message&#39; &#41;&#41;;
}

1;
[root@xcat workflow_tests]#

Pardon my awful code but, like i mentioned in my previous email, i
don&#39;t usually code in Perl :o&#41;

Thanks,
Luis
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;14&nbsp;11:33:51&nbsp;2010</span>
    <span class="description">jonasbn [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;14&nbsp;11:38:20&nbsp;2010</span>
    <span class="description">jonasbn [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Luis,

I understand from your second response you figured it out yourself?

It is nice you use the RT system, but fell free to use the mailing list in the future, both for 
speedier feedback and wider communication.

<span class="clickylink"><a target="new" rel="nofollow" href="http://sourceforge.net/mail/?group_id=177533">http://sourceforge.net/mail/?group_id=177533</a></span>

You have provided us with material, which should go into a FAQ or similar - thanks for taking 
the time to write.

Please let me/us know if there is anything else,

jonasbn, current maintainer of Workflow
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;14&nbsp;11:38:21&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;14&nbsp;11:38:22&nbsp;2010</span>
    <span class="description">jonasbn [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
