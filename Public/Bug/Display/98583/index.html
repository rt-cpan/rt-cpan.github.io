<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #98583 for List-MoreUtils: Feature: new routine count&#40;&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #98583 for List-MoreUtils: Feature: new routine count&#40;&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=List-MoreUtils">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=List-MoreUtils">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=List-MoreUtils">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=List-MoreUtils">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/List-MoreUtils">List-MoreUtils CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">98583</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=List-MoreUtils">List-MoreUtils</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
EDAVIS [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-19166-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.33    </td>
  </tr>
  <tr id="CF-19167-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=98583">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406783" href="/Public/Bug/Display.html?id=98583#txn-1406783">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;07:55:58&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Feature: new routine count&#40;&#41;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406783/746748/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746748">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 756b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It would be useful to have a routine count&#40;&#41; which counts the number of elements in a list.  The simplest implementation is as

    sub count { scalar @_ }

Further optimizations are possible with XS code, but the above should be enough.

You may wonder why this is necessary - there is some discussion at
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://thread.gmane.org/gmane.comp.lang.perl.perl5.porters/134968/">http://thread.gmane.org/gmane.comp.lang.perl.perl5.porters/134968/</a></span>&gt;.
Long story short, most of the idioms or tricks suggested to get the number of elements in a list don&#39;t actually work for all cases.  This can lead to fragile code
when beginners pick up scalar&#40;...&#41; or other not-quite-working constructs and think
that this is the way to count elements.  A guaranteed working way to count a list
would be a most welcome addition to List::MoreUtils.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406786" href="/Public/Bug/Display.html?id=98583#txn-1406786">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;08:03:47&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406786/746751/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746751">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 247b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I do not agree. I do not understand why using scalar context isn&#39;t sufficient and by throwing an eye on <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=96596">https://rt.cpan.org/Ticket/Display.html?id=96596</a></span> I tend to reject this wish. You should absolutely better reason for such a misleading routine.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406787" href="/Public/Bug/Display.html?id=98583#txn-1406787">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;08:03:47&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406790" href="/Public/Bug/Display.html?id=98583#txn-1406790">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;08:34:34&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406790/746754/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746754">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 955b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I used to think that using scalar&#40;&#41; was sufficient and I have written lots of code like that.
But it is not, and this can trip you up.  For example suppose you have the following code:

    my @got = &#40;@first_part, @second_part&#41;;
    if &#40;scalar&#40;@got&#41; != scalar&#40;@expected_lines&#41;&#41; { die &#39;wrong number of lines&#39; }

That works - but if you then decide to remove the intermediate @got variable the code becomes wrong:

    if &#40;scalar&#40;@first_part, @second_part&#41; != scalar&#40;@expected_lines&#41;&#41; { ... }

This is because scalar&#40;&#41; is not, in fact, a routine that returns the number of elements in a list.
Many programmers may assume that it is, but that is incorrect.  It just returns the result in scalar
context, whatever that may be.

If you want to get the count of elements in a list then you have to write something like

    scalar&#40; &#40;&#41;= foo &#41;

which, to my eyes, is just the kind of thing that would usefully be wrapped up in a one-word List::MoreUtils function.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406792" href="/Public/Bug/Display.html?id=98583#txn-1406792">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;08:42:30&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406792/746756/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746756">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 296b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">But this leads to count&#40;\@;\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@\@&#41; - and will fail when one list to much is given.

Further: count&#40;@&#41; ... doesn&#39;t save anything but creates a temporary list - one can do it by hand either.

I disagree that the concept matches List::MoreUtils.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406795" href="/Public/Bug/Display.html?id=98583#txn-1406795">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;08:55:41&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406795/746759/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746759">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I believe that count&#40;&#41; does not require any prototype, or simply a prototype of &#40;@&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;Further: count&#40;@&#41; ... doesn&#39;t save anything but creates a temporary
&gt;list - one can do it by hand either.
</div>
That&#39;s right; although an XS implementation can be used to avoid the temporary.  However, the motivation is not for efficiency but as a way to say what you mean and have code which will work without surprises.

What is scalar&#40;&#41;?  It coerces its argument list to scalar context.  Sometimes this gives the count of items in the list, but sometimes it doesn&#39;t.  Surely it is not a good idea to say &#39;scalar&#39; when what you really want is not the behaviour of scalar&#40;&#41; but just a count of items.  

I would suggest that count&#40;&#41; is a cousin of true&#40;&#41; and false&#40;&#41;, just without the first BLOCK argument.
Then, for example, you have a recipe to see the proportion of items matching some test:

    my $p = &#40;true { $_ &gt; 0 } foo&#41; / count&#40;foo&#41;;
    say int&#40;$p * 100&#41;, &#39;% of the items are positive&#39;;

If you use scalar&#40;&#41; instead of count&#40;&#41; then the code will work for some values of foo but not for others.

Note that true&#40;&#41; and false&#40;&#41; do not have any problem with arbitrary lists:

    my $count = true { 1 } @a, @b, @c; # works correctly

Whereas scalar&#40;@a, @b, @c&#41; does not do what you expected, if you were hoping to use scalar&#40;&#41; as the way to count a list.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406797" href="/Public/Bug/Display.html?id=98583#txn-1406797">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;08:58:56&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406797/746761/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746761">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 182b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">All questions aside why scalar&#40;@L1,L2&#41; won&#39;t behave expected - you want a scalar_but_merges_lists&#40;@L1,@L2&#41;.

But what you lurk for is not a list util - you lurk for a syntax helper!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406800" href="/Public/Bug/Display.html?id=98583#txn-1406800">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;09:06:30&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406800/746764/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746764">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 03 08:58:56 2014, REHSACK wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;you want a scalar_but_merges_lists&#40;@L1,@L2&#41;.
</div>
That is exactly right but I think that &#39;count&#39; is a better name.
However, if you think that &#39;count&#39; is misleading it could be called something else.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;But what you lurk for is not a list util - you lurk for a syntax
&gt;helper!
</div>
I agree that a source filter or the equivalent would let this be implemented without losing efficiency.  It could convert count&#40;foo&#41; into scalar&#40; &#40;&#41;= foo &#41; or something equivalent.

However, I think that efficiency is secondary and the first priority is to write code that clearly expresses what&#39;s wanted, and not to use the wrong tool for the job &#40;as scalar&#40;&#41; is the wrong tool to use for counting elements in a list&#41;.

Clearly the definition of count&#40;&#41; is trivial and could be implemented separately in each project, or even in each source file.  But there is value in having an agreed name and common location.  The same is true of most of the routines in List::MoreUtils, they are often one-liners &#40;in pure-Perl implementation at least&#41;, but having them collected together with known names and documentation means that different programmers can read each others&#39; code and know exactly what is intended.  That is what makes List::MoreUtils such a valuable module.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406802" href="/Public/Bug/Display.html?id=98583#txn-1406802">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;09:25:16&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406802/746766/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746766">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 188b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">My point is: this is not a list util - it doesn&#39;t improve dealing with lists, it improves dealing with Perl&#40;5&#41; syntax.

I&#39;m open for other arguements - but at this point I reject the wish.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406805" href="/Public/Bug/Display.html?id=98583#txn-1406805">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;09:25:19&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406814" href="/Public/Bug/Display.html?id=98583#txn-1406814">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;09:55:49&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406814/746774/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746774">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 459b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">But isn&#39;t

    true BLOCK foo

just a more convenient syntax for

    scalar grep BLOCK foo

Again, it is something which could equally be implemented as a source filter &#40;and might even be a bit faster that way, in the absence of XS code&#41; but it is useful to have as a named function.

To my mind, &#39;count the number of elements in list L&#39; is just as much a list function as &#39;count the number of elements in list L matching condition P&#39;... don&#39;t you think?

  
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1407044" href="/Public/Bug/Display.html?id=98583#txn-1407044">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;04&nbsp;01:31:39&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1407044/746884/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746884">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 150b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">No - I don&#39;t think ;&#41;

I rate some functions as not so useful placeholders - but I do not intend to waste names for shortcuts with questionable value.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1407160" href="/Public/Bug/Display.html?id=98583#txn-1407160">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;04&nbsp;09:19:55&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1407160/746947/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746947">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 630b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for your reply.  You are right that a naive implementation

   sub count { scalar @_ }

does not add much value, just because it is so easy to write for those who want it - and also because it imposes a performance penalty.  Using count&#40;foo&#41; will require making a copy of the list foo, whereas scalar&#40;@x&#41; does not take a copy of @x.

It is possible to write a more efficient implementation of count&#40;&#41; in XS code, so it can be just as fast as scalar&#40;&#41; while not having scalar&#40;&#41;&#39;s gotchas.  Then it becomes a bit more useful I think.  If I can provide a patch with a fast XS implementation, would you consider adding count&#40;&#41;?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1408238" href="/Public/Bug/Display.html?id=98583#txn-1408238">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;07&nbsp;09:46:26&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1408238/747439/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/747439">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 200b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The most powerful implementation is the right use of scalar.
Nothing can beat a native operator. I explained a bit above why every XS implementation is worse than scalar and where the bottlenecks are.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1408474" href="/Public/Bug/Display.html?id=98583#txn-1408474">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;08&nbsp;09:49:33&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1408474/747558/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/747558">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;Nothing can beat a native operator. I explained a bit above why every
&gt;XS implementation is worse than scalar and where the bottlenecks are.
</div>
You make a valid point about needing to take a copy of the array &#40;if called on a single array&#41;.
On p5p, Zefram suggested a solution to this:

<span class="clickylink"><a target="new" rel="nofollow" href="http://article.gmane.org/gmane.comp.lang.perl.perl5.porters/135045">http://article.gmane.org/gmane.comp.lang.perl.perl5.porters/135045</a></span>

Following this approach, I believe it is possible to make a count&#40;&#41; routine which

- always returns the number of items in the list, with no funny cases

- is just as fast as scalar&#40;@x&#41; for the common case of a single array &#40;in fact, compiles to the same bytecode&#41;

- lets the programmer say what he or she means - &#39;I want the count of items in this list&#39; - rather than relying on Perl&#39;s scalar conversion rules, which do not do what&#39;s wanted when the list is something other than a single array.

In the same thread on p5p, a couple of other contributors suggested that the routine belonged in List::Util or List::MoreUtils.  It would not need to be called count&#40;&#41; if that name is too general.  What do you think?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1408489" href="/Public/Bug/Display.html?id=98583#txn-1408489">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;08&nbsp;11:01:36&nbsp;2014</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1408489/747566/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/747566">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Sep 08 09:49:33 2014, EDAVIS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Nothing can beat a native operator. I explained a bit above why every
&gt; &gt; XS implementation is worse than scalar and where the bottlenecks are.
</div>&gt; 
&gt; You make a valid point about needing to take a copy of the array &#40;if
&gt; called on a single array&#41;.
&gt; On p5p, Zefram suggested a solution to this:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://article.gmane.org/gmane.comp.lang.perl.perl5.porters/135045">http://article.gmane.org/gmane.comp.lang.perl.perl5.porters/135045</a></span>
&gt; 
&gt; Following this approach, I believe it is possible to make a count&#40;&#41;
&gt; routine which
&gt; 
&gt; - always returns the number of items in the list, with no funny cases
&gt; 
&gt; - is just as fast as scalar&#40;@x&#41; for the common case of a single array
&gt; &#40;in fact, compiles to the same bytecode&#41;
&gt; 
&gt; - lets the programmer say what he or she means - &#39;I want the count of
&gt; items in this list&#39; - rather than relying on Perl&#39;s scalar conversion
&gt; rules, which do not do what&#39;s wanted when the list is something other
&gt; than a single array.
&gt; 
&gt; In the same thread on p5p, a couple of other contributors suggested
&gt; that the routine belonged in List::Util or List::MoreUtils.  It would
&gt; not need to be called count&#40;&#41; if that name is too general.  What do
&gt; you think?
</div>
Patches welcome! Including tests and XS ;&#41;

Cheers
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1408852" href="/Public/Bug/Display.html?id=98583#txn-1408852">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;09&nbsp;05:13:03&nbsp;2014</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1408852/747745/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/747745">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 24b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Great, I&#39;ll get started.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.673233</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
