<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #30677 for Spreadsheet-ParseExcel: 0xEF PHONETIC in BIFF8</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #30677 for Spreadsheet-ParseExcel: 0xEF PHONETIC in BIFF8</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">30677</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cpan [...] pjedwards.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.33    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;12&nbsp;13:55:23&nbsp;2007</span>
    <span class="description">cpan [...] pjedwards.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0xEF PHONETIC in BIFF8</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for working on Spreadsheet::ParseExcel

0xEF is PHONETIC in BIFF8
See: <span class="clickylink"><a target="new" rel="nofollow" href="http://sc.openoffice.org/excelfileformat.pdf">http://sc.openoffice.org/excelfileformat.pdf</a></span>
I can&#39;t find when it may have been an EOF, but in sub Parse in
ParseExcel.pm this code:

        #Check EF, EOF
        if&#40;$bOp == 0xEF&#41; {    #EF
            $iEfFlg = $bOp;

exists, and it&#39;s taken me a while to get here, but it&#39;s the reason a
file I have from a vendor &#40;that I can&#39;t attach here, but could email&#41;
does not parse.  I am able to open the file correctly in MS Excel,
OpenOffice and Gnumeric.  My fix is to remove the check for 0xEF.

Cheers,

Peter &#40;Stig&#41; Edwards
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:35&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.33 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.25 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.26 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.2601 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.2602 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.2603 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.27 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.27_01 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:36&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.27_02 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:37&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.27_03 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:37&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.28 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:37&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.29 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:37&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.30 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:37&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.31 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;28&nbsp;12:51:37&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Broken in 0.32 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;08:15:24&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Nov 12 13:55:23 2007, cpan@pjedwards.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for working on Spreadsheet::ParseExcel
&gt; 
&gt; 0xEF is PHONETIC in BIFF8
&gt; See: <span class="clickylink"><a target="new" rel="nofollow" href="http://sc.openoffice.org/excelfileformat.pdf">http://sc.openoffice.org/excelfileformat.pdf</a></span>
&gt; I can&#39;t find when it may have been an EOF, but in sub Parse in
&gt; ParseExcel.pm this code:
&gt; 
&gt;         #Check EF, EOF
&gt;         if&#40;$bOp == 0xEF&#41; {    #EF
&gt;             $iEfFlg = $bOp;
&gt; 
&gt; exists, and it&#39;s taken me a while to get here, but it&#39;s the reason a
&gt; file I have from a vendor &#40;that I can&#39;t attach here, but could email&#41;
&gt; does not parse.  I am able to open the file correctly in MS Excel,
&gt; OpenOffice and Gnumeric.  My fix is to remove the check for 0xEF.
</div>
Hi Peter,

I am the new maintainer of Spreadsheet::WriteExcel.

I know that it has been a while since you reported this but if you could
send me the/an Excel file that demonstrates this problem I&#39;ll have a
look at it.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;08:15:25&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;08:17:50&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jan 12 08:15:24 2009, JMCNAMARA wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Nov 12 13:55:23 2007, cpan@pjedwards.co.uk wrote:
<div class="message-stanza open">&gt; &gt; Thanks for working on Spreadsheet::ParseExcel
&gt; &gt; 
&gt; &gt; 0xEF is PHONETIC in BIFF8
&gt; &gt; See: <span class="clickylink"><a target="new" rel="nofollow" href="http://sc.openoffice.org/excelfileformat.pdf">http://sc.openoffice.org/excelfileformat.pdf</a></span>
&gt; &gt; I can&#39;t find when it may have been an EOF, but in sub Parse in
&gt; &gt; ParseExcel.pm this code:
&gt; &gt; 
&gt; &gt;         #Check EF, EOF
&gt; &gt;         if&#40;$bOp == 0xEF&#41; {    #EF
&gt; &gt;             $iEfFlg = $bOp;
&gt; &gt; 
&gt; &gt; exists, and it&#39;s taken me a while to get here, but it&#39;s the reason a
&gt; &gt; file I have from a vendor &#40;that I can&#39;t attach here, but could email&#41;
&gt; &gt; does not parse.  I am able to open the file correctly in MS Excel,
&gt; &gt; OpenOffice and Gnumeric.  My fix is to remove the check for 0xEF.
</div>&gt; 
&gt; Hi Peter,
&gt; 
&gt; I am the new maintainer of Spreadsheet::WriteExcel.
</div>
Or Spreadsheet::rather ParseExcel. Sorry, muscle memory. :-&#41;

John.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;10:05:52&nbsp;2009</span>
    <span class="description">cpan [...] pjedwards.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I managed to find the file, I&#39;ll email it to you.
I&#39;ve attached to this update a version of xls2csv.pl
used to demonstrate the problem, call it thus:

  perl xls2csv.pl rt_30677.xls 3-A1:H10

Compare this to the contents of sheet 3 if opened in
MS Excel, OpenOffice, Gnumeric.  Also with the check for
0xEF commented out in ParseExcel.pm

  make
  perl -Mblib xls2csv.pl rt_30677.xls 3-A1:H10

Thanks.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"># script to extract a range of colums/rows from an excel spreadsheet
# and present it as a csv, there is also the option to rotate the
# output,
#
# &#40;c&#41; kevin Mulholland 2002, kevin@moodfarm.demon.co.uk
# this code is released under the Perl Artistic License
use strict ;
use Spreadsheet::ParseExcel;
use Spreadsheet::ParseExcel::FmtUnicode;
use Spreadsheet::ParseExcel::Utility qw&#40;xls2csv&#41;;

if&#40;!&#40;defined $ARGV[0]&#41;&#41; {
 usage&#40; &#34;Bad Args&#34;&#41; ;
 exit;
}

my $rotate = 0 ;
my $filename = $ARGV[0] ;
my $coords = $ARGV[1] ;

$rotate = 1 if&#40; defined $ARGV[2] &#38;&#38; $ARGV[2] eq &#34;-rotate&#34;&#41; ;

my $codepage = $ARGV[3];

if&#40; !$coords&#41; {
   usage&#40; &#34;No co-ordinates defined&#34;&#41; ;
   exit ;
}

if&#40; ! -f $filename&#41; {
   usage&#40; &#34;File $filename does not exist&#34;&#41; ;
   exit ;
}

printf xls2csv&#40; $filename, $coords, $rotate, $codepage&#41; ;

# -----------------------------------------------------------------------------
# error
# writes a message to STDERR
#
sub error {
   printf STDERR shift ;
}
# -----------------------------------------------------------------------------
# usage
# this decribes how the program as a whole is to be used
#
sub usage {
 my $errmsg = shift ;

 error&#40; &#34;\n&#34; . $errmsg . &#34;\n&#34;&#41; if&#40; $errmsg&#41; ;

 error&#40; &#34;
Usage: $0 filename sheet-colrow:colrow [-rotate]
   eg: $0 filename.xls 1-A1:B12
       $0 filename.xls A1:M1 -rotate\n\n&#34;&#41; ;
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;10:18:26&nbsp;2009</span>
    <span class="description">cpan [...] pjedwards.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Just looking at my local edits to Spreadsheet-ParseExcel-
0.32/lib/Spreadsheet/ParseExcel.pm

I also added some entries to %ProcTbl and corresponding subroutines 
when working on this.
&#40;The 3 #s are because at the time I was using Smart::Comments&#41;

Here they are, they might be helpful, sorry I&#39;ve not looked at any more 
recent versions than 0.32.

    0x00    =&gt; \&#38;_subDimensions,        # Dimensions
    0x01    =&gt; \&#38;_subBlank,             # Blank
    0x02    =&gt; \&#38;_subInteger,           # Integer
    0x03    =&gt; \&#38;_subNumber,            # Number
    0x04    =&gt; \&#38;_subLabel,             # Label
    0x05    =&gt; \&#38;_subBoolErr,           # Bool Err
    0x06    =&gt; \&#38;_subFormula,           # Formula
    0x09    =&gt; \&#38;_subBOF,               # BOF&#40;BIFF2&#41;

    0x0A    =&gt; \&#38;_subEOF,               # EOF
    0x0B    =&gt; \&#38;_subIndex,             # Index
    0x0C    =&gt; \&#38;_subCalcCount,         # Calc Count
    0x0D    =&gt; \&#38;_subCalcMode,          # Calc Mode
    0x0E    =&gt; \&#38;_subPrecision,         # Precision
    0x0F    =&gt; \&#38;_subRefMode,           # Ref Mode

    0x10    =&gt; \&#38;_subDelta,             # Delta
    0x11    =&gt; \&#38;_subIteration,         # Iteration
    0x12    =&gt; \&#38;_subProtect,           # Protect
    0x13    =&gt; \&#38;_subPassword,          # Password

    0x16    =&gt; \&#38;_subExternCount,       # Extern Count
    0x17    =&gt; \&#38;_subExternSheet,       # Extern Sheet

    0x19    =&gt; \&#38;_subWindowProtect,     # Window Protect

    0x1C    =&gt; \&#38;_subNote,              # Note
    0x1D    =&gt; \&#38;_subSelection,         # Selection
    0x1E    =&gt; \&#38;_subFormat,            # Format
    0x1F    =&gt; \&#38;_subBuiltInFmtCount,   # Built in Format Count
    0x20    =&gt; \&#38;_subColumnDefualt,     # Column Default
    0x21    =&gt; \&#38;_subArray,             # Array

    0x23    =&gt; \&#38;_subExternName,        # Extern Name
    0x24    =&gt; \&#38;_subColWidth,          # Col Width
    0x25    =&gt; \&#38;_subDefaultRowHeight,  # Default Row Height

    0x2F    =&gt; \&#38;_subFilePass,          # File Pass
    0x31    =&gt; \&#38;_subFont,              # Font
    0x32    =&gt; \&#38;_subFont2,             # Font2
    0x36    =&gt; \&#38;_subTableOp,           # TableOp
    0x37    =&gt; \&#38;_subTableOp2,          # TableOp2

    0x3D    =&gt; \&#38;_subWindow1,           # Window1
    0x3E    =&gt; \&#38;_subWindow2,           # Window2
    0x40    =&gt; \&#38;_subBackup,            # Backup
    0x41    =&gt; \&#38;_subPane,              # Pane
    0x42    =&gt; \&#38;_subCodepage,          # Codepage

    0x44    =&gt; \&#38;_subIXFE,              # IXFE
    0x45    =&gt; \&#38;_subEFont,             # EFont
    0x51    =&gt; \&#38;_subDCONREF,           # DCONREF

    0x56    =&gt; \&#38;_subBuiltInFmtCount,   # Built in Fmt Count
    0x59    =&gt; \&#38;_subXCT,               # XCT
    0x5A    =&gt; \&#38;_subCRN,               # CRN
    0x5B    =&gt; \&#38;_subFileSharing,       # File Sharing

    0x5E    =&gt; \&#38;_subUnCalced,          # UnCalced
    0x5F    =&gt; \&#38;_subSaverECalc,        # Saver ECalc
    0x63    =&gt; \&#38;_subOjectProtect,      # Object Protect

    0x80    =&gt; \&#38;_subGUTS,              # GUTS

    0x82    =&gt; \&#38;_subGridSet,           # Grid Set

    0x86    =&gt; \&#38;_subWriteProt,         # Write Prot
    0x8C    =&gt; \&#38;_subCountry,           # Country
    0x8D    =&gt; \&#38;_subHideObj,           # Hide Object
    0x90    =&gt; \&#38;_subSort,              # Sort

    0xA0    =&gt; \&#38;_subSCL,               # SCL

    0xAB    =&gt; \&#38;_subGCW,               # GCW

    0xD7    =&gt; \&#38;_subDBCell,            # DBCell
    0xDA    =&gt; \&#38;_subBookBool,          # BookBool
    0xDD    =&gt; \&#38;_subScenProtect,       # Scen Protect

    0xE9    =&gt; \&#38;_subBitMap,            # Bit Map
    0xEF    =&gt; \&#38;_subPhonetic,          # Phonetic

    0xFF    =&gt; \&#38;_subEXTSST,            # EXTSST

    0x15F   =&gt; \&#38;_subLabelRanges,       # Label Ranges
    0x160   =&gt; \&#38;_subUseSelfs,          # Use Selfs
    0x161   =&gt; \&#38;_subDSF,               # DSF

    0x1AE   =&gt; \&#38;_subSupBook,           # Sup Book
    0x1B0   =&gt; \&#38;_subCondFmt,           # Cond Fmt
    0x1B2   =&gt; \&#38;_subDVAL,              # DVAL
    0x1B8   =&gt; \&#38;_subHLINK,             # HLINK
    0x1BE   =&gt; \&#38;_subDV,                # DV

    0x200   =&gt; \&#38;_subDimensions,        # Dimensions

    0x206   =&gt; \&#38;_subFormula,           # Formula

    0x209   =&gt; \&#38;_subBOF,               # BOF&#40;BIFF3&#41;
    0x20B   =&gt; \&#38;_subIndex,             # Index
    0x218   =&gt; \&#38;_subName,              # Name

    0x223   =&gt; \&#38;_subExternName,        # Extern Name

    0x231   =&gt; \&#38;_subFont,              # Font

    0x236   =&gt; \&#38;_subTableOp,           # TableOp
    0x23E   =&gt; \&#38;_subWindow2,           # Window2
    0x243   =&gt; \&#38;_subXF,                # XF

    0x293   =&gt; \&#38;_subStyle,             # Style

    0x409   =&gt; \&#38;_subBOF,               # BOF&#40;BIFF4&#41;
    0x41E   =&gt; \&#38;_subFormat,            # Format
    0x443   =&gt; \&#38;_subXF,                # XF
    0x4BC   =&gt; \&#38;_subShrFmla,           # Shared Formula

    0x800   =&gt; \&#38;_subQuickTip,          # Quick Tip

    0x862   =&gt; \&#38;_subSheetLayout,       # Sheet Layout
    0x867   =&gt; \&#38;_subSheetProtection,   # Sheet Protection
    0x868   =&gt; \&#38;_subRangeProtection,   # Range Protection


sub _subCodepage {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subCodepage&#40;&#41;
}

sub _subDSF {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subDSF&#40;&#41;
}

sub _subWindowProtect {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subWindowProtect&#40;&#41;
}

sub _subWindow1 {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subWindow1&#40;&#41;
}

sub _subBackup {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subBackup&#40;&#41;
}

sub _subHideObj {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subHideObj&#40;&#41;
}

sub _subBookBool {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subBookBool&#40;&#41;
}

sub _subStyle {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subStyle&#40;&#41;
}

sub _subUseSelfs {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subUseSelfs&#40;&#41;
}

sub _subCountry {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subCountry&#40;&#41;
}

sub _subSupBook {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSupBook&#40;&#41;
}

sub _subExternSheet {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subExternSheet&#40;&#41;
}

sub _subEXTSST {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subEXTSST&#40;&#41;
}

sub _subIndex {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subIndex&#40;&#41;
}

sub _subSaverECalc {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSaverECalcb&#40;&#41;
}

sub _subGridSet {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subGridSet&#40;&#41;
}

sub _subGUTS {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subGUTS&#40;&#41;
}

sub _subProtect {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subProtect&#40;&#41;
}

sub _subPassword {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subPassword&#40;&#41;
}

sub _subPrecision {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subPrecision&#40;&#41;
}

sub _subEOF {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subEOF&#40;&#41;
}

sub _subCalcMode {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subCalcMode&#40;&#41;
}

sub _subCalcCount {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subCalcCount&#40;&#41;
}

sub _subRefMode {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subRefMode&#40;&#41;
}

sub _subIteration {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subIteration&#40;&#41;
}

sub _subDelta {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subDelta&#40;&#41;
}

sub _subDimensions {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subDimensions&#40;&#41;
}

sub _subDBCell {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subDBCell&#40;&#41;
}

sub _subWindow2 {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subWindow2&#40;&#41;
}

sub _subSCL {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSCL&#40;&#41;
}

sub _subSelection {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSelection&#40;&#41;
}

sub _subSort {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSort&#41;
}

sub _subPane {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subPane&#40;&#41;
}

sub _subGCW {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subGCW&#40;&#41;
}

sub _subBitMap {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subBitMap&#40;&#41;
}

sub _subCRN {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subCRN&#40;&#41;
}

sub _subColWidth {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subColWidth&#40;&#41;
}

sub _subColumnDefault {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subColumnDefault&#40;&#41;
}

sub _subCondFmt {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subCondFmt&#40;&#41;
}

sub _subCONREF {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subCONREF&#40;&#41;
}

sub _subDV {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subDV&#40;&#41;
}

sub _subDVAL {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subDVAL&#40;&#41;
}

sub _subEFont {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subEFont&#40;&#41;
}

sub _subExternCount {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subExternCount&#40;&#41;
}

sub _subFilePass {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subFilePass&#40;&#41;
}

sub _subFileSharing {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subFileSharing&#40;&#41;
}

sub _subFont2 {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subFont2&#40;&#41;
}

sub _subHLINK {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subHLINK&#40;&#41;
}

sub _subIXFE {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subIXFE&#40;&#41;
}

sub _subLabelRanges {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subLabelRanges&#40;&#41;
}

sub _subNote {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subNote&#40;&#41;
}

sub _subObjectProtect {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subObjectProtect&#40;&#41;
}

sub _subPhonetic {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subPhonetic&#40;&#41;
}

sub _subQuickTip {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subQuickTip&#40;&#41;
}

sub _subRangeProtection {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subRangeProtection&#40;&#41;
}

sub _subSaverECalcb {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSaverECalcb&#40;&#41;
}

sub _subScenProtect {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subScenProtect&#40;&#41;
}

sub _subSheetLayout {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSheetLayout&#40;&#41;
}

sub _subSheetProtection {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subSheetProtection&#40;&#41;
}

sub _subShrFmla {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subShrFmla&#40;&#41;
}

sub _subTableOp2 {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subTableOp2&#40;&#41;
}

sub _subUnCalced {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subUnCalced&#40;&#41;
}

sub _subWriteProt {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subWriteProt&#40;&#41;
}

sub _subXCT {
    my&#40;$oBook, $bOp, $bLen, $sWk&#41; = @_;
    ### _subXCT&#40;&#41;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;10:26:43&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Peter,

Thanks for that.

I tested the file that you sent against the latest version of
Spreadsheet::ParseExcel and it seemed to parse correctly. Can you test
it and let me know.

    #!/usr/bin/perl

    use strict;
    use warnings;
    use Spreadsheet::ParseExcel 0.44;

    my $parser   = Spreadsheet::ParseExcel-&gt;new&#40;&#41;;
    my $workbook = $parser-&gt;Parse&#40;&#39;rt_30677.xls&#39;&#41;;

    for my $worksheet &#40; $workbook-&gt;worksheets&#40;&#41; &#41; {
        print &#34;Sheet = &#34;, $worksheet-&gt;{Name}, &#34;\n&#34;;

        my &#40; $row_min, $row_max &#41; = $worksheet-&gt;row_range&#40;&#41;;
        my &#40; $col_min, $col_max &#41; = $worksheet-&gt;col_range&#40;&#41;;

        for my $row &#40; $row_min .. $row_max &#41; {
            for my $col &#40; $col_min .. $col_max &#41; {

                my $cell = $worksheet-&gt;get_cell&#40; $row, $col &#41;;
                next unless $cell;

                print &#34;  Row, Col    = &#40;$row, $col&#41;, &#34;, $cell-&gt;value&#40;&#41;,
&#34;\n&#34;;
                print &#34;  Value       = &#34;, $cell-&gt;value&#40;&#41;,       &#34;\n&#34;;
                print &#34;  Unformatted = &#34;, $cell-&gt;unformatted&#40;&#41;, &#34;\n&#34;;
                print &#34;\n&#34;;
            }
        }
    }
    __END__

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;11:58:20&nbsp;2009</span>
    <span class="description">cpan [...] pjedwards.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for the lack of detail.
Slightly modified to narrow down output:

cat rt_30677.pl

#!/usr/bin/perl

use strict;
use warnings;
use Spreadsheet::ParseExcel 0.44;

my $parser   = Spreadsheet::ParseExcel-&gt;new&#40;&#41;;
my $workbook = $parser-&gt;Parse&#40;&#39;rt_30677.xls&#39;&#41;;

for my $worksheet &#40; $workbook-&gt;worksheets&#40;&#41; &#41; {

    next if &#40;2 != $worksheet&#41;;

    print &#34;Sheet = &#34;, $worksheet-&gt;{Name}, &#34;\n&#34;;

    my &#40; $row_min, $row_max &#41; = &#40; 0, 8 &#41;;
    my &#40; $col_min, $col_max &#41; = &#40; 0, 5 &#41;;

    for my $row &#40; $row_min .. $row_max &#41; {
        for my $col &#40; $col_min .. $col_max &#41; {

            my $cell = $worksheet-&gt;get_cell&#40; $row, $col &#41;;
            next unless $cell;

            print &#34;  Row, Col    = &#40;$row, $col&#41;, &#34;, $cell-&gt;value&#40;&#41;,&#34;\n&#34;;
            print &#34;  Value       = &#34;, $cell-&gt;value&#40;&#41;,       &#34;\n&#34;;
            print &#34;  Unformatted = &#34;, $cell-&gt;unformatted&#40;&#41;, &#34;\n&#34;;
            print &#34;\n&#34;;
        }
    }
}
__END__

Using original version of 0.44, the last data from the script above is 
row 3, col 0.

Comment out line 230 of lib/Spreadsheet/ParseExcel.pm

#Check EF, EOF
        if &#40; $bOp == 0xEF &#41; {    #EF
            #$iEfFlg = $bOp; # &lt;- line 230
        }

make
make test
perl -Mblib rt_30677.pl

Now I see data for:

  Row, Col    = &#40;4, 2&#41;
  Row, Col    = &#40;6, 5&#41;
  Row, Col    = &#40;7, 1&#41;
  Row, Col    = &#40;7, 2&#41;
  Row, Col    = &#40;7, 3&#41;
  Row, Col    = &#40;7, 4&#41;
  Row, Col    = &#40;7, 5&#41;
  Row, Col    = &#40;8, 1&#41;
  Row, Col    = &#40;8, 2&#41;
  Row, Col    = &#40;8, 3&#41;
  Row, Col    = &#40;8, 4&#41;
  Row, Col    = &#40;8, 5&#41;
  
Using MS Excel, OpenOffice and Gnumeric all also displayed this data 
for sheet 2 &#40;0 based counting, sheet 3 if starting with 1&#41;.

Thanks again.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;12&nbsp;18:30:10&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jan 12 11:58:20 2009, cpan@pjedwards.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sorry for the lack of detail.
</div>
Hi Peter,

That&#39;s fine. I&#39;d initially checked the last worksheet of workbook, which &#40;sod&#39;s law&#41; doesn&#39;t 
exhibit  the problem so I&#39;d missed it. :-&#40;

Anyway, thanks for that. You are also correct that the problem is with the 0xEF handling. I&#39;ll 
fix it in the next release.

One last question. Do you know if the file was initially produced by Excel, OpenOffice.org, 
Gnumeric, programiatically or otherwise?

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;13&nbsp;05:38:51&nbsp;2009</span>
    <span class="description">cpan [...] pjedwards.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jan 12 18:30:10 2009, JMCNAMARA wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Do you know if the file was initially produced by
&gt; Excel, OpenOffice.org,
&gt; Gnumeric, programiatically or otherwise?
</div>
I don&#39;t know, but when I look at File-&gt;Properties in
Microsoft Office Excel 2003 I see some info in the
General, Summary and Statistics tabs, and when I view
the raw binary file I do see &#34;Microsoft Excel&#34;, in additon
to &#34;Microsoft Photo Editor 3.0 Picture&#34;, &#34;MSPhotoEditor&#34;
and &#34;VBAProj&#34;, I also see 2 empty macros when using OpenOffice,
these are listed as Microsoft Excel Objects in Excel 2003.

I&#39;m guessing the file is produced programmatically,
it is produced at least once a day, possibly using VBA.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;14&nbsp;04:09:56&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Hi,

This issue has been fixed in Spreadsheet::ParseExcel version 0.45.

I think the original author may have been trying to avoid certain
worksheet records that fell between PHONETICINFO record and the
worksheet EOF. In older versions of Excel these 2 records were close
together. Or else he was trying to avoid some snafu between PHONETICINFO
and Unicode formula STRING records.

Either way it was badly wrong for the more general case.

Thanks for your help,

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;14&nbsp;04:09:57&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
