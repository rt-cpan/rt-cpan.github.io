<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #90774 for Moose: Make it possible to disable Moose&#39;s export of warnings into Moose-using packages</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #90774 for Moose: Make it possible to disable Moose&#39;s export of warnings into Moose-using packages</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Moose/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Moose/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Moose/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Moose/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Moose">Moose CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">90774</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">stalled</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Moose/Active/">Moose</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ZDM [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-38786-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38787-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;11:47:22&nbsp;2013</span>
    <span class="description">ZDM [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> possibility to turn off automtic warnings import</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please, add possibility to switch off automatic import of warnings pragma into the packages that use Moose.

For example, we use following code:

warnings-&gt;unimport&#40;qw&#40;experimental&#41;&#41; if $] &gt;= 5.018;

to disable experimental warnings in perl 5.18, but Moose override our settings when we use it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;11:55:31&nbsp;2013</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #90774] possibility to turn off automtic warnings import</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 24 Nov 2013 08:55:18 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Dmytro Zagashev via RT &lt;bug-Moose [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karen Etheridge &lt;ether [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, Nov 24, 2013 at 11:47:23AM -0500, Dmytro Zagashev via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Please, add possibility to switch off automatic import of warnings pragma into the packages that use Moose.
&gt; 
&gt; For example, we use following code:
&gt; 
&gt; warnings-&gt;unimport&#40;qw&#40;experimental&#41;&#41; if $] &gt;= 5.018;
&gt; 
&gt; to disable experimental warnings in perl 5.18, but Moose override our settings when we use it.
</div>
If you put that line after &#39;use Moose&#39; in your module, it should work &#40;you
may need to put it in a BEGIN block, depending on the warning you want to
disable&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;11:55:31&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;12:07:30&nbsp;2013</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I know, but we have own core package, which manage all our automatic imports and other configuration settings for packages that use it. 
This package always used first in all our huge number of modules.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;13:02:47&nbsp;2013</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2013-11-24 09:07:30, ZDM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I know, but we have own core package, which manage all our automatic
&gt; imports and other configuration settings for packages that use it.
&gt; This package always used first in all our huge number of modules.
</div>
Can you be more specific with an example?  I am having trouble seeing why your original code snippet is not adequate.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;13:09:12&nbsp;2013</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">We have P::Core package:

package P::Core;

#configure console
BEGIN {
    use English;
    use IO::Handle;
    use Encode&#40;&#41;;
    use Encode::Locale&#40;&#41;;
    use PerlIO::encoding;
    use Term::ANSIColor&#40;&#41;;
    require Win32::Console::ANSI if $OSNAME =~ /MSWin/;

    die &#39;Console input encoding &#34;&#39; . $Encode::Locale::ENCODING_CONSOLE_IN . &#39;&#34;is not supported!&#39; unless Encode::perlio_ok&#40;$Encode::Locale::ENCODING_CONSOLE_IN&#41;;
    local $PerlIO::encoding::fallback = Encode::FB_CROAK;
    binmode STDIN, &#34;:encoding&#40;$Encode::Locale::ENCODING_CONSOLE_IN&#41;&#34;;

    die &#39;Console output encoding &#34;&#39; . $Encode::Locale::ENCODING_CONSOLE_OUT . &#39;&#34;is not supported!&#39; unless Encode::perlio_ok&#40;$Encode::Locale::ENCODING_CONSOLE_OUT&#41;;
    local $PerlIO::encoding::fallback = Encode::FB_PERLQQ &#38; ~Encode::LEAVE_SRC;
    binmode STDOUT, &#34;:encoding&#40;$Encode::Locale::ENCODING_CONSOLE_OUT&#41;&#34;;
    binmode STDERR, &#34;:encoding&#40;$Encode::Locale::ENCODING_CONSOLE_OUT&#41;&#34;;

    STDOUT-&gt;autoflush&#40;1&#41;;
    STDERR-&gt;autoflush&#40;1&#41;;

    #decode @ARGV
    Encode::Locale::decode_argv&#40;Encode::FB_CROAK&#41;;
}

use v5.18.1;
use utf8;
use strict;
use warnings &#40; qw&#40;all&#41;, FATAL =&gt; qw&#40;utf8&#41;, NONFATAL =&gt; qw&#40;&#41; &#41;;
no if $] &gt;= 5.018, warnings =&gt; qw&#40;experimental&#41;;
use feature qw&#40;:all&#41;;
use mro qw&#40;c3&#41;;
use autodie qw&#40;:all&#41;;
use threads &#40; exit =&gt; &#39;threads_only&#39; &#41;;
use threads::shared;

use namespace::sweep&#40;&#41;;
use Devel::Hook&#40;&#41;;
use B::Hooks::EndOfScope::XS&#40;&#41;;
use Hook::AfterRuntime&#40;&#41;;

sub import {
    my &#40; $class, @import &#41; = @_;
    my @tags = grep { substr&#40; $_, 0, 1 &#41; ne q{-} } @import;
    my $caller = caller;

    utf8-&gt;import&#40;&#41;;
    strict-&gt;import&#40;&#41;;
    warnings-&gt;import&#40; &#39;all&#39;, FATAL =&gt; qw&#40;utf8&#41;, NONFATAL =&gt; qw&#40;&#41; &#41;;
    warnings-&gt;unimport&#40;qw&#40;experimental&#41;&#41; if $] &gt;= 5.018;
    feature-&gt;import&#40; &#40; version-&gt;new&#40;$]&#41;-&gt;normal &#41; =~ s/^v/:/r &#41;;
    mro::set_mro&#40; $caller, &#39;c3&#39; &#41;;

    P::Core::Config-&gt;import&#40;@tags&#41;;
    P::Core::Constants-&gt;import&#40;@tags&#41;;
    P::Core::Dump-&gt;import&#40;@tags&#41;;
    P::Core::Exceptions-&gt;import&#40;@tags&#41;;
    P::Core::Events-&gt;import&#40;@tags&#41;;
    P::Core::Functions-&gt;import&#40;@tags&#41;;
    P::Core::GO-&gt;import&#40;@tags&#41;;
    P::Core::Log-&gt;import&#40;@tags&#41;;
    P::Core::I18N-&gt;import&#40;@tags&#41;;

    unless &#40; &#39;-config&#39; ~~ @_ &#41; {
        unless &#40; &#39;-no-autoclean&#39; ~~ @_ &#41; {
            namespace::sweep-&gt;import&#40; -cleanee =&gt; $caller, -also =&gt; [] &#41;;
        }

        if &#40; $caller eq &#39;main&#39; &#41; {    #main namespace

            #install CORE::CLI event caller
            unless &#40; &#39;-no-cli&#39; ~~ @import &#41; {
                Devel::Hook-&gt;push_INIT_hook&#40;
                    sub {
                        P::throw_event&#40;&#39;CORE::CLI&#39;&#41;;
                    }
                &#41;;
            }

            #install CORE::RUNTIME event caller
            Devel::Hook-&gt;push_INIT_hook&#40;
                sub {
                    P::throw_event&#40;&#39;CORE::RUNTIME&#39;&#41;;
                }
            &#41;;
        }
        else {    #non-main namespace

            #cli for non-main namespace
            if &#40; &#39;-cli&#39; ~~ @import &#41; {
                push @P::Core::CLI::PACKAGES, $caller;
            }

            #apply exception and log roles to moose classes
            B::Hooks::EndOfScope::on_scope_end {
                if &#40; $caller-&gt;can&#40;&#39;meta&#39;&#41; &#38;&#38; $caller-&gt;meta-&gt;isa&#40;&#39;Moose::Meta::Class&#39;&#41; &#41; {
                    Moose::Util::apply_all_roles&#40; $caller-&gt;meta, &#39;P::Core::Exceptions::Role&#39; &#41;;
                    Moose::Util::apply_all_roles&#40; $caller-&gt;meta, &#39;P::Core::Log::Role&#39; &#41;;
                }
            };

            #make moose classes immutable
            unless &#40; &#39;-no-immutable&#39; ~~ @_ &#41; {
                Hook::AfterRuntime::after_runtime {
                    if &#40; $caller-&gt;can&#40;&#39;meta&#39;&#41; &#38;&#38; $caller-&gt;meta-&gt;isa&#40;&#39;Moose::Meta::Class&#39;&#41; &#41; {
                        $caller-&gt;meta-&gt;make_immutable;
                    }
                };
            }
        }
    }

    #export autodie pragma
    unless &#40; &#39;-no-autodie&#39; ~~ @import &#41; {
        @_ = &#40; &#39;autodie&#39;, Fatal::LEXICAL_TAG, &#39;:all&#39; &#41;;
        goto &#38;Fatal::import;
    }
    return;
}

This package used first in all other our modules. As you can see it imports all needed functionality automatically, install hooks, etc...

We use Moose and other modules after our core package used. And now Moose override our warning policy.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;13:28:26&nbsp;2013</span>
    <span class="description">doy [...] tozt.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #90774] possibility to turn off automtic warnings import</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 24 Nov 2013 13:28:12 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Dmytro Zagashev via RT &lt;bug-Moose [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jesse Luehrs &lt;doy [...] tozt.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">In recent versions of perl, you can detect whether strict or warnings
has been loaded manually &#40;either enabled or disabled&#41;, so that
&#34;no strict; use 5.018&#34; doesn&#39;t end up reenabling strict. We could
probably hook into that in more recent versions of perl, to not do the
reexporting of strict or warnings if they have already been loaded.

-doy

On Sun, Nov 24, 2013 at 01:09:12PM -0500, Dmytro Zagashev via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Moose
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=90774">https://rt.cpan.org/Ticket/Display.html?id=90774</a></span> &gt;
&gt; 
&gt; We have P::Core package:
&gt; 
&gt; package P::Core;
&gt; 
&gt; #configure console
&gt; BEGIN {
&gt;     use English;
&gt;     use IO::Handle;
&gt;     use Encode&#40;&#41;;
&gt;     use Encode::Locale&#40;&#41;;
&gt;     use PerlIO::encoding;
&gt;     use Term::ANSIColor&#40;&#41;;
&gt;     require Win32::Console::ANSI if $OSNAME =~ /MSWin/;
&gt; 
&gt;     die &#39;Console input encoding &#34;&#39; . $Encode::Locale::ENCODING_CONSOLE_IN . &#39;&#34;is not supported!&#39; unless Encode::perlio_ok&#40;$Encode::Locale::ENCODING_CONSOLE_IN&#41;;
&gt;     local $PerlIO::encoding::fallback = Encode::FB_CROAK;
&gt;     binmode STDIN, &#34;:encoding&#40;$Encode::Locale::ENCODING_CONSOLE_IN&#41;&#34;;
&gt; 
&gt;     die &#39;Console output encoding &#34;&#39; . $Encode::Locale::ENCODING_CONSOLE_OUT . &#39;&#34;is not supported!&#39; unless Encode::perlio_ok&#40;$Encode::Locale::ENCODING_CONSOLE_OUT&#41;;
&gt;     local $PerlIO::encoding::fallback = Encode::FB_PERLQQ &#38; ~Encode::LEAVE_SRC;
&gt;     binmode STDOUT, &#34;:encoding&#40;$Encode::Locale::ENCODING_CONSOLE_OUT&#41;&#34;;
&gt;     binmode STDERR, &#34;:encoding&#40;$Encode::Locale::ENCODING_CONSOLE_OUT&#41;&#34;;
&gt; 
&gt;     STDOUT-&gt;autoflush&#40;1&#41;;
&gt;     STDERR-&gt;autoflush&#40;1&#41;;
&gt; 
&gt;     #decode @ARGV
&gt;     Encode::Locale::decode_argv&#40;Encode::FB_CROAK&#41;;
&gt; }
&gt; 
&gt; use v5.18.1;
&gt; use utf8;
&gt; use strict;
&gt; use warnings &#40; qw&#40;all&#41;, FATAL =&gt; qw&#40;utf8&#41;, NONFATAL =&gt; qw&#40;&#41; &#41;;
&gt; no if $] &gt;= 5.018, warnings =&gt; qw&#40;experimental&#41;;
&gt; use feature qw&#40;:all&#41;;
&gt; use mro qw&#40;c3&#41;;
&gt; use autodie qw&#40;:all&#41;;
&gt; use threads &#40; exit =&gt; &#39;threads_only&#39; &#41;;
&gt; use threads::shared;
&gt; 
&gt; use namespace::sweep&#40;&#41;;
&gt; use Devel::Hook&#40;&#41;;
&gt; use B::Hooks::EndOfScope::XS&#40;&#41;;
&gt; use Hook::AfterRuntime&#40;&#41;;
&gt; 
&gt; sub import {
&gt;     my &#40; $class, @import &#41; = @_;
&gt;     my @tags = grep { substr&#40; $_, 0, 1 &#41; ne q{-} } @import;
&gt;     my $caller = caller;
&gt; 
&gt;     utf8-&gt;import&#40;&#41;;
&gt;     strict-&gt;import&#40;&#41;;
&gt;     warnings-&gt;import&#40; &#39;all&#39;, FATAL =&gt; qw&#40;utf8&#41;, NONFATAL =&gt; qw&#40;&#41; &#41;;
&gt;     warnings-&gt;unimport&#40;qw&#40;experimental&#41;&#41; if $] &gt;= 5.018;
&gt;     feature-&gt;import&#40; &#40; version-&gt;new&#40;$]&#41;-&gt;normal &#41; =~ s/^v/:/r &#41;;
&gt;     mro::set_mro&#40; $caller, &#39;c3&#39; &#41;;
&gt; 
&gt;     P::Core::Config-&gt;import&#40;@tags&#41;;
&gt;     P::Core::Constants-&gt;import&#40;@tags&#41;;
&gt;     P::Core::Dump-&gt;import&#40;@tags&#41;;
&gt;     P::Core::Exceptions-&gt;import&#40;@tags&#41;;
&gt;     P::Core::Events-&gt;import&#40;@tags&#41;;
&gt;     P::Core::Functions-&gt;import&#40;@tags&#41;;
&gt;     P::Core::GO-&gt;import&#40;@tags&#41;;
&gt;     P::Core::Log-&gt;import&#40;@tags&#41;;
&gt;     P::Core::I18N-&gt;import&#40;@tags&#41;;
&gt; 
&gt;     unless &#40; &#39;-config&#39; ~~ @_ &#41; {
&gt;         unless &#40; &#39;-no-autoclean&#39; ~~ @_ &#41; {
&gt;             namespace::sweep-&gt;import&#40; -cleanee =&gt; $caller, -also =&gt; [] &#41;;
&gt;         }
&gt; 
&gt;         if &#40; $caller eq &#39;main&#39; &#41; {    #main namespace
&gt; 
&gt;             #install CORE::CLI event caller
&gt;             unless &#40; &#39;-no-cli&#39; ~~ @import &#41; {
&gt;                 Devel::Hook-&gt;push_INIT_hook&#40;
&gt;                     sub {
&gt;                         P::throw_event&#40;&#39;CORE::CLI&#39;&#41;;
&gt;                     }
&gt;                 &#41;;
&gt;             }
&gt; 
&gt;             #install CORE::RUNTIME event caller
&gt;             Devel::Hook-&gt;push_INIT_hook&#40;
&gt;                 sub {
&gt;                     P::throw_event&#40;&#39;CORE::RUNTIME&#39;&#41;;
&gt;                 }
&gt;             &#41;;
&gt;         }
&gt;         else {    #non-main namespace
&gt; 
&gt;             #cli for non-main namespace
&gt;             if &#40; &#39;-cli&#39; ~~ @import &#41; {
&gt;                 push @P::Core::CLI::PACKAGES, $caller;
&gt;             }
&gt; 
&gt;             #apply exception and log roles to moose classes
&gt;             B::Hooks::EndOfScope::on_scope_end {
&gt;                 if &#40; $caller-&gt;can&#40;&#39;meta&#39;&#41; &#38;&#38; $caller-&gt;meta-&gt;isa&#40;&#39;Moose::Meta::Class&#39;&#41; &#41; {
&gt;                     Moose::Util::apply_all_roles&#40; $caller-&gt;meta, &#39;P::Core::Exceptions::Role&#39; &#41;;
&gt;                     Moose::Util::apply_all_roles&#40; $caller-&gt;meta, &#39;P::Core::Log::Role&#39; &#41;;
&gt;                 }
&gt;             };
&gt; 
&gt;             #make moose classes immutable
&gt;             unless &#40; &#39;-no-immutable&#39; ~~ @_ &#41; {
&gt;                 Hook::AfterRuntime::after_runtime {
&gt;                     if &#40; $caller-&gt;can&#40;&#39;meta&#39;&#41; &#38;&#38; $caller-&gt;meta-&gt;isa&#40;&#39;Moose::Meta::Class&#39;&#41; &#41; {
&gt;                         $caller-&gt;meta-&gt;make_immutable;
&gt;                     }
&gt;                 };
&gt;             }
&gt;         }
&gt;     }
&gt; 
&gt;     #export autodie pragma
&gt;     unless &#40; &#39;-no-autodie&#39; ~~ @import &#41; {
&gt;         @_ = &#40; &#39;autodie&#39;, Fatal::LEXICAL_TAG, &#39;:all&#39; &#41;;
&gt;         goto &#38;Fatal::import;
&gt;     }
&gt;     return;
&gt; }
&gt; 
&gt; This package used first in all other our modules. As you can see it imports all needed functionality automatically, install hooks, etc...
&gt; 
&gt; We use Moose and other modules after our core package used. And now Moose override our warning policy.
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;19:55:21&nbsp;2013</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please, add some package variable to Moose or Moose::Exporter namespaces, which can be used to turn off warnings export.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;17&nbsp;01:11:40&nbsp;2014</span>
    <span class="description">DROLSKY [...] cpan.org -  Subject changed from &#39;possibility to turn off automtic warnings import&#39; to &#39;Make it possible to disable Moose&#39;s export of warnings into Moose-using packages&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;27&nbsp;13:36:22&nbsp;2014</span>
    <span class="description">DROLSKY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Nov 24 19:55:21 2013, ZDM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Please, add some package variable to Moose or Moose::Exporter
&gt; namespaces, which can be used to turn off warnings export.
</div>
I doubt we will add a package variable to do this.

I think you could work around this by making your own core package for Moose, like P::Moose. We&#39;ve done this for Moose, Moose::Role, MX::Role::Parameterized, and Test::Class::Moose at my work place, and it gives us full control over when Moose is exported, as well as warnings, strict, autodie, etc. You can also include various MX modules by default, like MooseX::StrictConstructor.

Also, BTW, you can use Import::Into to export autodie rather than the goto hack. Just make sure that you pass a numeric caller level to autodie-&gt;import::into.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;27&nbsp;13:36:29&nbsp;2014</span>
    <span class="description">DROLSKY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;27&nbsp;13:48:22&nbsp;2014</span>
    <span class="description">dzagashev [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #90774] Make it possible to disable Moose&#39;s export of warnings into Moose-using packages</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 27 Nov 2014 20:48:06 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Moose [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;dzagashev [...] gmail.com&#34; &lt;dzagashev [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the advice.
I already have moved on Moo.

On 27.11.2014 20:36, Dave Rolsky via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=90774">https://rt.cpan.org/Ticket/Display.html?id=90774</a></span> &gt;
&gt;
&gt; On Sun Nov 24 19:55:21 2013, ZDM wrote:
<div class="message-stanza open">&gt;&gt; Please, add some package variable to Moose or Moose::Exporter
&gt;&gt; namespaces, which can be used to turn off warnings export.
</div>&gt; I doubt we will add a package variable to do this.
&gt;
&gt; I think you could work around this by making your own core package for Moose, like P::Moose. We&#39;ve done this for Moose, Moose::Role, MX::Role::Parameterized, and Test::Class::Moose at my work place, and it gives us full control over when Moose is exported, as well as warnings, strict, autodie, etc. You can also include various MX modules by default, like MooseX::StrictConstructor.
&gt;
&gt; Also, BTW, you can use Import::Into to export autodie rather than the goto hack. Just make sure that you pass a numeric caller level to autodie-&gt;import::into.
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;27&nbsp;13:48:22&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;27&nbsp;15:00:07&nbsp;2014</span>
    <span class="description">DROLSKY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
