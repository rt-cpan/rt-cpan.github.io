<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21727 for HTTP-Server-Simple: [PATCH] Support for Perl 5.004</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21727 for HTTP-Server-Simple: [PATCH] Support for Perl 5.004</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=HTTP-Server-Simple">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=HTTP-Server-Simple">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=HTTP-Server-Simple">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=HTTP-Server-Simple">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/HTTP-Server-Simple">HTTP-Server-Simple CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21727</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=HTTP-Server-Simple">HTTP-Server-Simple</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
SAPER [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Unimportant    </td>
  </tr>
  <tr id="CF-16414-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.20    </td>
  </tr>
  <tr id="CF-16415-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




HTTP-Server-Simple-0.20-perl5.004-02.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/251279/107999/HTTP-Server-Simple-0.20-perl5.004-02.diff">
Wed Oct 18 18:31:53 2006 (7k) by maddingue [...] free.fr
</a>
</font></li>
</ul>


HTTP-Server-Simple-0.20-perl5.004.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/244742/104392/HTTP-Server-Simple-0.20-perl5.004.diff">
Tue Sep 26 09:36:43 2006 (7.2k) by SAPER [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=21727">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-244742" href="/Public/Bug/Display.html?id=21727#txn-244742">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;26&nbsp;09:36:43&nbsp;2006</span>
    <span class="description">SAPER [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Support for Perl 5.004</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/244742/104389/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/104389">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 591b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I can already hear you shout in a mix of horror and anger &#34;Why are 
you still using a version of Perl that should be only talked about 
in archeology class?&#34;

And I agree, Perl should be upgraded, but there are cases where you 
just can&#39;t do that. And I wanted to use HTTP::Server::Simple. So I 
patched it and as I expected it was quite short and easy. Hence this 
ticket, mostly for the records in case someone else wants to use the 
module on an older Perl. 

With this patch, HTTP::Server::Simple 0.20 passes all tests on 
Perl 5.004_05. 


Regards, 

-- 
Close the world, txEn eht nepO.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> HTTP-Server-Simple-0.20-perl5.004.diff</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/244742/104392/HTTP-Server-Simple-0.20-perl5.004.diff">Download HTTP-Server-Simple-0.20-perl5.004.diff</a><br />
<span class="downloadcontenttype">text/x-diff 7.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ru HTTP-Server-Simple-0.20-orig/lib/HTTP/Server/Simple/CGI/Environment.pm HTTP-Server-Simple-0.20-perl5.004/lib/HTTP/Server/Simple/CGI/Environment.pm
--- HTTP-Server-Simple-0.20-orig/lib/HTTP/Server/Simple/CGI/Environment.pm	2006-06-07 21:26:29.000000000 +0200
+++ HTTP-Server-Simple-0.20-perl5.004/lib/HTTP/Server/Simple/CGI/Environment.pm	2006-09-26 15:18:17.853103679 +0200
@@ -2,10 +2,11 @@
 package HTTP::Server::Simple::CGI::Environment;
 
 use strict;
-use warnings;
+#use warnings;
 use HTTP::Server::Simple;
 
-our $VERSION = $HTTP::Server::Simple::VERSION;
+use vars qw&#40;$VERSION %ENV_MAPPING&#41;;
+$VERSION = $HTTP::Server::Simple::VERSION;
 
 my %clean_env = %ENV;
 
@@ -56,7 +57,7 @@
 
 =cut
 
-our %ENV_MAPPING = &#40;
+%ENV_MAPPING = &#40;
     protocol     =&gt; &#34;SERVER_PROTOCOL&#34;,
     localport    =&gt; &#34;SERVER_PORT&#34;,
     localname    =&gt; &#34;SERVER_NAME&#34;,
@@ -69,7 +70,7 @@
 &#41;;
 
 sub setup_environment_from_metadata {
-    no warnings &#39;uninitialized&#39;;
+    #no warnings &#39;uninitialized&#39;;
     my $self = shift;
 
     # XXX TODO: rather than clone functionality from the base class,
diff -ru HTTP-Server-Simple-0.20-orig/lib/HTTP/Server/Simple/CGI.pm HTTP-Server-Simple-0.20-perl5.004/lib/HTTP/Server/Simple/CGI.pm
--- HTTP-Server-Simple-0.20-orig/lib/HTTP/Server/Simple/CGI.pm	2006-06-07 21:26:29.000000000 +0200
+++ HTTP-Server-Simple-0.20-perl5.004/lib/HTTP/Server/Simple/CGI.pm	2006-09-26 14:38:00.091744446 +0200
@@ -3,11 +3,12 @@
 
 use base qw&#40;HTTP::Server::Simple HTTP::Server::Simple::CGI::Environment&#41;;
 use strict;
-use warnings;
+#use warnings;
 
 use CGI &#40;&#41;;
 
-our $VERSION = $HTTP::Server::Simple::VERSION;
+use vars qw&#40;$VERSION $default_doc&#41;;
+$VERSION = $HTTP::Server::Simple::VERSION;
 
 =head1 NAME
 
@@ -69,7 +70,6 @@
 
 =cut
 
-our $default_doc;
 $default_doc = &#40; join &#34;&#34;, &lt;DATA&gt; &#41;;
 
 sub handle_request {
diff -ru HTTP-Server-Simple-0.20-orig/lib/HTTP/Server/Simple.pm HTTP-Server-Simple-0.20-perl5.004/lib/HTTP/Server/Simple.pm
--- HTTP-Server-Simple-0.20-orig/lib/HTTP/Server/Simple.pm	2006-06-15 16:05:14.000000000 +0200
+++ HTTP-Server-Simple-0.20-perl5.004/lib/HTTP/Server/Simple.pm	2006-09-26 15:09:51.738877196 +0200
@@ -1,15 +1,16 @@
 package HTTP::Server::Simple;
-use 5.006;
 use strict;
-use warnings;
+use FileHandle;
 use Socket;
 use Carp;
 
-our $VERSION = &#39;0.20&#39;;
+use vars qw&#40;$VERSION $bad_request_doc&#41;;
+$VERSION = &#39;0.20&#39;;
+
 
 =head1 NAME
 
-HTTP::Server::Simple
+HTTP::Server::Simple - Lightweight HTTP server
 
 
 =head1 SYNOPSIS
@@ -253,7 +254,7 @@
             local $SIG{PIPE} = &#39;IGNORE&#39;;    # If we don&#39;t ignore SIGPIPE, a
                  # client closing the connection before we
                  # finish sending will cause the server to exit
-            while &#40; accept&#40; my $remote, HTTPDaemon &#41; &#41; {
+            while &#40; accept&#40; my $remote = new FileHandle, HTTPDaemon &#41; &#41; {
                 $self-&gt;stdio_handle&#40;$remote&#41;;
                 $self-&gt;lookup_localhost&#40;&#41; unless &#40;$self-&gt;host&#41;;
                 $self-&gt;accept_hook if $self-&gt;can&#40;&#34;accept_hook&#34;&#41;;
@@ -604,7 +605,7 @@
 
 =cut
 
-our $bad_request_doc = join &#34;&#34;, &lt;DATA&gt;;
+$bad_request_doc = join &#34;&#34;, &lt;DATA&gt;;
 
 sub bad_request {
     my $self = shift;
diff -ru HTTP-Server-Simple-0.20-orig/t/01live.t HTTP-Server-Simple-0.20-perl5.004/t/01live.t
--- HTTP-Server-Simple-0.20-orig/t/01live.t	2006-06-07 21:26:29.000000000 +0200
+++ HTTP-Server-Simple-0.20-perl5.004/t/01live.t	2006-09-26 14:49:57.293865190 +0200
@@ -19,12 +19,12 @@
 
     my $pid=$s-&gt;background&#40;&#41;;
 
-    like&#40;$pid, qr/^-?\d+$/,&#39;pid is numeric&#39;&#41;;
+    like&#40;$pid, &#39;/^-?\d+$/&#39;, &#39;pid is numeric&#39;&#41;;
     select&#40;undef,undef,undef,0.2&#41;; # wait a sec
 
     my $content=fetch&#40;&#34;GET / HTTP/1.1&#34;, &#34;&#34;&#41;;
 
-    like&#40;$content, qr/Congratulations/, &#34;Returns a page&#34;&#41;;
+    like&#40;$content, &#39;/Congratulations/&#39;, &#34;Returns a page&#34;&#41;;
     is&#40;kill&#40;9,$pid&#41;,1,&#39;Signaled 1 process successfully&#39;&#41;;
     wait or die &#34;couldn&#39;t wait for sub-process completion&#34;;
 }
@@ -35,22 +35,22 @@
     my $pid=$s-&gt;background&#40;&#41;;
     diag&#40;&#34;started server on $pid&#34;&#41;;
     select&#40;undef,undef,undef,0.2&#41;; # wait a sec
-    like&#40;$pid, qr/^-?\d+$/,&#39;pid is numeric&#39;&#41;;
+    like&#40;$pid, &#39;/^-?\d+$/&#39;, &#39;pid is numeric&#39;&#41;;
 
     my $content=fetch&#40;&#34;GET / HTTP/1.1&#34;, &#34;&#34;&#41;;
-    like&#40;$content,qr/Congratulations/,&#34;Returns a page&#34;&#41;;
+    like&#40;$content, &#39;/Congratulations/&#39;, &#34;Returns a page&#34;&#41;;
 
     eval {
 	like&#40;fetch&#40;&#34;GET your mum wet&#34;&#41;,  # anything does!
-	     qr/bad request/i,
+	     &#39;/bad request/i&#39;,
 	     &#34;knows what a request isn&#39;t&#34;&#41;;
     };
     fail&#40;&#34;got exception in client: $@&#34;&#41; if $@;
 
-    like&#40;fetch&#40;&#34;GET / HTTP/1.1&#34;, &#34;&#34;&#41;, qr/Congratulations/,
+    like&#40;fetch&#40;&#34;GET / HTTP/1.1&#34;, &#34;&#34;&#41;, &#39;/Congratulations/&#39;,
 	 &#34;HTTP/1.1 request&#34;&#41;;
 
-    like&#40;fetch&#40;&#34;GET /&#34;&#41;, qr/Congratulations/,
+    like&#40;fetch&#40;&#34;GET /&#34;&#41;, &#39;/Congratulations/&#39;,
 	 &#34;HTTP/0.9 request&#34;&#41;;
 
     is&#40;kill&#40;9,$pid&#41;,1,&#39;Signaled 1 process successfully&#39;&#41;;
diff -ru HTTP-Server-Simple-0.20-orig/t/03podcoverage.t HTTP-Server-Simple-0.20-perl5.004/t/03podcoverage.t
--- HTTP-Server-Simple-0.20-orig/t/03podcoverage.t	2006-06-07 21:26:29.000000000 +0200
+++ HTTP-Server-Simple-0.20-perl5.004/t/03podcoverage.t	2006-09-26 14:38:44.570557947 +0200
@@ -5,5 +5,5 @@
 
 eval &#34;use Test::Pod::Coverage 1.04&#34;;
 plan skip_all =&gt; &#34;Test::Pod::Coverage 1.04 required for testing POD coverage&#34; if $@;
-all_pod_coverage_ok&#40;{  also_private =&gt; [ qr/^[A-Z_]+$/ ], }&#41;;
+all_pod_coverage_ok&#40;{  also_private =&gt; [ &#39;/^[A-Z_]+$/&#39; ], }&#41;;
 
diff -ru HTTP-Server-Simple-0.20-orig/t/04cgi.t HTTP-Server-Simple-0.20-perl5.004/t/04cgi.t
--- HTTP-Server-Simple-0.20-orig/t/04cgi.t	2006-06-07 21:26:29.000000000 +0200
+++ HTTP-Server-Simple-0.20-perl5.004/t/04cgi.t	2006-09-26 15:24:24.409878637 +0200
@@ -5,7 +5,7 @@
 use constant PORT =&gt; 13432;
 my $host = gethostbyaddr&#40;inet_aton&#40;&#39;localhost&#39;&#41;, AF_INET&#41;;
 
-our %methods=&#40;
+my %methods=&#40;
               url =&gt; &#34;url: http://$host:&#34;.PORT,
               path_info =&gt; &#39;path_info: /cgitest/path_info&#39;,
               server_name =&gt; &#34;server_name: $host&#34;,
@@ -14,7 +14,7 @@
               request_method =&gt; &#39;request_method: GET&#39;,
             &#41;;
 
-our %envvars=&#40;
+my %envvars=&#40;
               SERVER_URL =&gt; &#34;SERVER_URL: http://$host:&#34;.PORT.&#39;/&#39;,
               SERVER_PORT =&gt; &#39;SERVER_PORT: &#39;.PORT,
               REQUEST_METHOD =&gt; &#39;REQUEST_METHOD: GET&#39;,
@@ -34,15 +34,15 @@
 
   my $pid=$server-&gt;background;
 
-  like&#40;$pid,qr/^-?\d+$/,&#39;pid is numeric&#39;&#41;;
+  like&#40;$pid, &#39;/^-?\d+$/&#39;, &#39;pid is numeric&#39;&#41;;
 
   select&#40;undef,undef,undef,0.2&#41;; # wait a sec
-  like&#40;fetch&#40;&#34;GET / HTTP/1.1&#34;,&#34;&#34;&#41;,qr&#40;NOFILE&#41;,&#39;no file&#39;&#41;;
+  like&#40;fetch&#40;&#34;GET / HTTP/1.1&#34;,&#34;&#34;&#41;, &#39;/NOFILE/&#39;, &#39;no file&#39;&#41;;
 
   foreach my $method &#40;keys&#40;%methods&#41;&#41; {
     like&#40;
           fetch&#40;&#34;GET /cgitest/$method HTTP/1.1&#34;,&#34;&#34;&#41;,
-          qr&#40;$methods{$method}&#41;,
+          &#34;/$methods{$method}/&#34;,
           &#34;method - $method&#34;
         &#41;;
     select&#40;undef,undef,undef,0.2&#41;; # wait a sec
@@ -51,7 +51,7 @@
   foreach my $envvar &#40;keys&#40;%envvars&#41;&#41; {
     like&#40;
           fetch&#40;&#34;GET /cgitest/$envvar HTTP/1.1&#34;,&#34;&#34;&#41;,
-          qr&#40;$envvars{$envvar}&#41;,
+          &#34;/$envvars{$envvar}/&#34;,
           &#34;Environment - $envvar&#34;
         &#41;;
     select&#40;undef,undef,undef,0.2&#41;; # wait a sec
@@ -149,7 +149,7 @@
     print &#34;Content-Type: text/html\r\nContent-Length: &#34;;
     my $response;
     if&#40;$methods{$file}&#41; {
-      $response=&#34;$file: &#34;.$cgi-&gt;$file;
+      $response = &#34;$file: &#34;.$cgi-&gt;$file&#40;&#41;;
     } elsif&#40;$envvars{$file}&#41; {
       $response=&#34;$file: $ENV{$file}&#34;;
     } else {
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-245267" href="/Public/Bug/Display.html?id=21727#txn-245267">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;28&nbsp;13:05:52&nbsp;2006</span>
    <span class="description">jesse [...] fsck.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21727] [PATCH] Support for Perl 5.004</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Sep 2006 13:05:05 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> S [...] bestpractical.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jesse &lt;jesse [...] fsck.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/245267/104691/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/104691">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 754b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I can already hear you shout in a mix of horror and anger &#34;Why are 
&gt; you still using a version of Perl that should be only talked about 
&gt; in archeology class?&#34;
</div>
Nope. I totally understand the requirement. I just wish there were a way
to apply this without killing warnings ;&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; And I agree, Perl should be upgraded, but there are cases where you 
&gt; just can&#39;t do that. And I wanted to use HTTP::Server::Simple. So I 
&gt; patched it and as I expected it was quite short and easy. Hence this 
&gt; ticket, mostly for the records in case someone else wants to use the 
&gt; module on an older Perl. 
&gt; 
&gt; With this patch, HTTP::Server::Simple 0.20 passes all tests on 
&gt; Perl 5.004_05. 
&gt; 
&gt; 
&gt; Regards, 
&gt; 
&gt; -- 
&gt; Close the world, txEn eht nepO.
</div>


-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-245268" href="/Public/Bug/Display.html?id=21727#txn-245268">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;28&nbsp;13:05:54&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-247204" href="/Public/Bug/Display.html?id=21727#txn-247204">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;04&nbsp;07:14:38&nbsp;2006</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21727] [PATCH] Support for Perl 5.004</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 04 Oct 2006 13:14:17 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-HTTP-Server-Simple [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/247204/105764/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/105764">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 558b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Jesse wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I can already hear you shout in a mix of horror and anger &#34;Why are
&gt; &gt; you still using a version of Perl that should be only talked about
&gt; &gt; in archeology class?&#34;
</div>&gt;
&gt; Nope. I totally understand the requirement. I just wish there were a way
&gt; to apply this without killing warnings ;&#41;
</div>
I was pondering a warnings.pm emulation for older Perl, and recently JFDI:
  » <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/warnings-compat/">http://search.cpan.org/dist/warnings-compat/</a></span>

Now I can rewrite the patch so it doesn&#39;t remove the warnings.

--
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-251279" href="/Public/Bug/Display.html?id=21727#txn-251279">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;18&nbsp;18:31:53&nbsp;2006</span>
    <span class="description">maddingue [...] free.fr -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21727] [PATCH] Support for Perl 5.004</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 19 Oct 2006 00:31:32 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-HTTP-Server-Simple [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;maddingue [...] free.fr&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/251279/107998/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/107998">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 100b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

Here is a new patch which keeps the warnings and also eval-use  
Data::Dumper in the tests.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/251279/107999/HTTP-Server-Simple-0.20-perl5.004-02.diff">Download HTTP-Server-Simple-0.20-perl5.004-02.diff</a><br />
<span class="downloadcontenttype">text/x-diff 7k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/251279/108000/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/108000">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 66b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">

-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-251569" href="/Public/Bug/Display.html?id=21727#txn-251569">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;18&nbsp;23:40:12&nbsp;2006</span>
    <span class="description">jesse [...] fsck.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21727] [PATCH] Support for Perl 5.004</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Oct 2006 23:40:04 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-HTTP-Server-Simple [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jesse &lt;jesse [...] fsck.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/251569/108190/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/108190">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 500b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Thanks! Applied. 0.22 is on its way to cpan right now.

On Wed, Oct 18, 2006 at 06:31:54PM -0400, S?bastien Aperghis-Tramoni via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt;        Queue: HTTP-Server-Simple
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=21727">http://rt.cpan.org/Ticket/Display.html?id=21727</a></span> &gt;
&gt; 
&gt; Hello,
&gt; 
&gt; Here is a new patch which keeps the warnings and also eval-use  
&gt; Data::Dumper in the tests.
</div>
That needed a tiny bit of a patch, but it&#39;s taken care of.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 
&gt; -- 
&gt; S?bastien Aperghis-Tramoni
&gt; 
&gt; Close the world, txEn eht nepO.
</div>
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-536398" href="/Public/Bug/Display.html?id=21727#txn-536398">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;23&nbsp;02:00:14&nbsp;2008</span>
    <span class="description">cpan [...] chmrr.net -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.483894</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
