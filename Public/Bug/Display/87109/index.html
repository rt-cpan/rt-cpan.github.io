<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #87109 for File-KeePass: [PATCH] Use Crypt::Salsa20</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #87109 for File-KeePass: [PATCH] Use Crypt::Salsa20</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/File-KeePass/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/File-KeePass/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/File-KeePass/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/File-KeePass/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/File-KeePass">File-KeePass CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">87109</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/File-KeePass/Active/">File-KeePass</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cjm [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-233724-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-233725-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;20&nbsp;13:35:19&nbsp;2013</span>
    <span class="description">cjm [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Use Crypt::Salsa20</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">As reported in RT#82582, File::KeePass&#39;s Salsa20 implementation is buggy.  And anyway, Salsa20 should be a separate CPAN module; File::KeePass shouldn&#39;t have its own private implementation.

Accordingly, I&#39;ve just released Crypt::Salsa20 to CPAN.  It works properly on both 32 and 64 bit Perls, and includes the complete test vectors from ECRYPT to ensure that.

Here&#39;s a patch to make File::KeePass use Crypt::Salsa20.  This fixes RT#82582.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Crypt-Salsa20.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/File/KeePass.pm	2012-09-15 17:09:42.000000000 -0500
+++ lib/File/KeePass.pm	2013-07-20 12:20:36.548187805 -0500
@@ -9,6 +9,7 @@
 use strict;
 use warnings;
 use Crypt::Rijndael;
+use Crypt::Salsa20;
 use Digest::SHA qw&#40;sha256&#41;;
 
 use constant DB_HEADSIZE_V1   =&gt; 124;
@@ -237,7 +238,7 @@
 
     # parse the XML - use our own parser since XML::Simple does not do event based actions
     my $tri = sub { return !defined&#40;$_[0]&#41; ? undef : &#40;&#39;true&#39; eq lc $_[0]&#41; ? 1 : &#40;&#39;false&#39; eq lc $_[0]&#41; ? 0 : undef };
-    my $s20_stream = $self-&gt;salsa20_stream&#40;{key =&gt; sha256&#40;$head-&gt;{&#39;protected_stream_key&#39;}&#41;, iv =&gt; $salsa20_iv, rounds =&gt; 20}&#41;;
+    my $s20_stream = Crypt::Salsa20-&gt;new&#40;key =&gt; sha256&#40;$head-&gt;{&#39;protected_stream_key&#39;}&#41;, iv =&gt; $salsa20_iv&#41;-&gt;cryptor;
     my %BIN;
     my $META;
     my @GROUPS;
@@ -962,7 +963,7 @@
         }
     }
 
-    my $s20_stream = $self-&gt;salsa20_stream&#40;{key =&gt; sha256&#40;$head-&gt;{&#39;protected_stream_key&#39;}&#41;, iv =&gt; $salsa20_iv, rounds =&gt; 20}&#41;;
+    my $s20_stream = Crypt::Salsa20-&gt;new&#40;key =&gt; sha256&#40;$head-&gt;{&#39;protected_stream_key&#39;}&#41;, iv =&gt; $salsa20_iv&#41;-&gt;cryptor;
     for my $ref &#40;@PROTECT_BIN, @PROTECT_STR&#41; {
         $$ref = $self-&gt;encode_base64&#40;$s20_stream-&gt;&#40;$$ref&#41;&#41;;
     }
@@ -1490,102 +1491,6 @@
 }
 
 ###----------------------------------------------------------------###
-
-sub salsa20_stream {
-    my &#40;$self, $args&#41; = @_;
-    delete $args-&gt;{&#39;data&#39;};
-    my $salsa20 = $self-&gt;salsa20&#40;$args&#41;;
-    my $buffer = &#39;&#39;;
-    return sub {
-        my $enc = shift;
-        $buffer .= $salsa20-&gt;&#40;&#34;\0&#34; x 64&#41; while length&#40;$buffer&#41; &lt; length&#40;$enc&#41;;
-        my $data = join &#39;&#39;, map {chr&#40;ord&#40;substr $enc, $_, 1&#41; ^ ord&#40;substr $buffer, $_, 1&#41;&#41;} 0 .. length&#40;$enc&#41;-1;
-        substr $buffer, 0, length&#40;$enc&#41;, &#39;&#39;;
-        return $data;
-    };
-}
-
-
-sub salsa20 { # <span class="clickylink"><a target="new" rel="nofollow" href="http://cr.yp.to/snuffle/salsa20/regs/salsa20.c">http://cr.yp.to/snuffle/salsa20/regs/salsa20.c</a></span>
-    my &#40;$self, $args&#41; = @_;
-    my &#40;$key, $iv, $rounds&#41; = @$args{qw&#40;key iv rounds&#41;};
-    $rounds ||= 20;
-
-    my &#40;@k, @c&#41;;
-    if &#40;32 == length $key&#41; {
-        @k = unpack &#39;L8&#39;, $key;
-        @c = &#40;0x61707865, 0x3320646e, 0x79622d32, 0x6b206574&#41;; # SIGMA
-    } elsif &#40;16 == length $key&#41; {
-        @k = unpack &#39;L8&#39;, $key x 2;
-        @c = &#40;0x61707865, 0x3120646e, 0x79622d36, 0x6b206574&#41;; # TAU
-    } else {
-        die &#34;Salsa20 key length must be 16 or 32\n&#34;;
-    }
-    die &#34;Salsa20 IV length must be 8\n&#34; if length&#40;$iv&#41; != 8;
-    die &#34;Salsa20 rounds must be 8, 12, or 20.\n&#34; if !grep {$rounds != $_} 8, 12, 20;
-    my @v = unpack&#40;&#39;L2&#39;, $iv&#41;;
-
-    #            0                                  5      6      7            10                                 # 15
-    my @state = &#40;$c[0], $k[0], $k[1], $k[2], $k[3], $c[1], $v[0], $v[1], 0, 0, $c[2], $k[4], $k[5], $k[6], $k[7], $c[3]&#41;;
-
-    my $rotl32 = sub { return &#40;&#40;$_[0] &lt;&lt; $_[1]&#41; | &#40;$_[0] &gt;&gt; &#40;32 - $_[1]&#41;&#41;&#41; &#38; 0xffffffff };
-    my $word_to_byte = sub {
-        my @x = @state;
-        for &#40;1 .. $rounds/2&#41; {
-            $x[ 4] ^= $rotl32-&gt;&#40;&#40;$x[ 0] + $x[12]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[ 8] ^= $rotl32-&gt;&#40;&#40;$x[ 4] + $x[ 0]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[12] ^= $rotl32-&gt;&#40;&#40;$x[ 8] + $x[ 4]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[ 0] ^= $rotl32-&gt;&#40;&#40;$x[12] + $x[ 8]&#41; &#38; 0xffffffff, 18&#41;;
-            $x[ 9] ^= $rotl32-&gt;&#40;&#40;$x[ 5] + $x[ 1]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[13] ^= $rotl32-&gt;&#40;&#40;$x[ 9] + $x[ 5]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[ 1] ^= $rotl32-&gt;&#40;&#40;$x[13] + $x[ 9]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[ 5] ^= $rotl32-&gt;&#40;&#40;$x[ 1] + $x[13]&#41; &#38; 0xffffffff, 18&#41;;
-            $x[14] ^= $rotl32-&gt;&#40;&#40;$x[10] + $x[ 6]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[ 2] ^= $rotl32-&gt;&#40;&#40;$x[14] + $x[10]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[ 6] ^= $rotl32-&gt;&#40;&#40;$x[ 2] + $x[14]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[10] ^= $rotl32-&gt;&#40;&#40;$x[ 6] + $x[ 2]&#41; &#38; 0xffffffff, 18&#41;;
-            $x[ 3] ^= $rotl32-&gt;&#40;&#40;$x[15] + $x[11]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[ 7] ^= $rotl32-&gt;&#40;&#40;$x[ 3] + $x[15]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[11] ^= $rotl32-&gt;&#40;&#40;$x[ 7] + $x[ 3]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[15] ^= $rotl32-&gt;&#40;&#40;$x[11] + $x[ 7]&#41; &#38; 0xffffffff, 18&#41;;
-
-            $x[ 1] ^= $rotl32-&gt;&#40;&#40;$x[ 0] + $x[ 3]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[ 2] ^= $rotl32-&gt;&#40;&#40;$x[ 1] + $x[ 0]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[ 3] ^= $rotl32-&gt;&#40;&#40;$x[ 2] + $x[ 1]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[ 0] ^= $rotl32-&gt;&#40;&#40;$x[ 3] + $x[ 2]&#41; &#38; 0xffffffff, 18&#41;;
-            $x[ 6] ^= $rotl32-&gt;&#40;&#40;$x[ 5] + $x[ 4]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[ 7] ^= $rotl32-&gt;&#40;&#40;$x[ 6] + $x[ 5]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[ 4] ^= $rotl32-&gt;&#40;&#40;$x[ 7] + $x[ 6]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[ 5] ^= $rotl32-&gt;&#40;&#40;$x[ 4] + $x[ 7]&#41; &#38; 0xffffffff, 18&#41;;
-            $x[11] ^= $rotl32-&gt;&#40;&#40;$x[10] + $x[ 9]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[ 8] ^= $rotl32-&gt;&#40;&#40;$x[11] + $x[10]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[ 9] ^= $rotl32-&gt;&#40;&#40;$x[ 8] + $x[11]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[10] ^= $rotl32-&gt;&#40;&#40;$x[ 9] + $x[ 8]&#41; &#38; 0xffffffff, 18&#41;;
-            $x[12] ^= $rotl32-&gt;&#40;&#40;$x[15] + $x[14]&#41; &#38; 0xffffffff,  7&#41;;
-            $x[13] ^= $rotl32-&gt;&#40;&#40;$x[12] + $x[15]&#41; &#38; 0xffffffff,  9&#41;;
-            $x[14] ^= $rotl32-&gt;&#40;&#40;$x[13] + $x[12]&#41; &#38; 0xffffffff, 13&#41;;
-            $x[15] ^= $rotl32-&gt;&#40;&#40;$x[14] + $x[13]&#41; &#38; 0xffffffff, 18&#41;;
-        }
-        return pack &#39;L16&#39;, map {&#40;$x[$_] + $state[$_]&#41; &#38; 0xffffffff} 0 .. 15;
-    };
-
-    my $encoder = sub {
-        my $enc = shift;
-        my $out = &#39;&#39;;
-        while &#40;length $enc&#41; {
-            my $stream = $word_to_byte-&gt;&#40;&#41;;
-            $state[8] = &#40;$state[8] + 1&#41; &#38; 0xffffffff;
-            $state[9] = &#40;$state[9] + 1&#41; &#38; 0xffffffff if $state[8] == 0;
-            my $chunk = substr $enc, 0, 64, &#39;&#39;;
-            $out .= join &#39;&#39;, map {chr&#40;ord&#40;substr $stream, $_, 1&#41; ^ ord&#40;substr $chunk, $_, 1&#41;&#41;} 0 .. length&#40;$chunk&#41;-1;
-        }
-        return $out;
-    };
-    return $encoder if !exists $args-&gt;{&#39;data&#39;};
-    return $encoder-&gt;&#40;defined&#40;$args-&gt;{&#39;data&#39;}&#41; ? $args-&gt;{&#39;data&#39;} : &#39;&#39;&#41;;
-}
-
-###----------------------------------------------------------------###
 
 1;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;20&nbsp;13:37:37&nbsp;2013</span>
    <span class="description">cjm [...] cpan.org -  Reference to ticket #82582 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;20&nbsp;13:44:46&nbsp;2013</span>
    <span class="description">cjm [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The first patch neglected to remove the documentation relating to Salsa20.  This second patch is just for that.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Crypt-Salsa20-docs.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/File/KeePass.pm	2012-09-15 17:09:42.000000000 -0500
+++ lib/File/KeePass.pm	2013-07-20 12:40:09.213266655 -0500
@@ -2158,38 +2063,6 @@
 to order the tags of a node and __attr__ can be used to indicate which
 items of a node are attributes.
 
-=item salsa20
-
-Takes a hashref containing a salsa20 key string &#40;length 32 or 16&#41;, a
-salsa20 iv string &#40;length 8&#41;, number of salsa20 rounds &#40;8, 12, or 20 -
-default 20&#41;, and an optional data string.  The key and iv are used to
-initialize the salsa20 encryption.
-
-If a data string is passed, the string is salsa20 encrypted and
-returned.
-
-If no data string is passed a salsa20 encrypting coderef is returned.
-
-    my $encoded = $self-&gt;salsa20&#40;{key =&gt; $key, iv =&gt; $iv, data =&gt; $data}&#41;;
-    my $uncoded = $self-&gt;salsa20&#40;{key =&gt; $key, iv =&gt; $iv, data =&gt; $encoded}&#41;;
-    # $data eq $uncoded
-
-    my $encoder = $self-&gt;salsa20&#40;{key =&gt; $key, iv =&gt; $Iv}&#41;; # no data
-    my $encoded = $encoder-&gt;&#40;$data&#41;;
-    my $part2   = $encoder-&gt;&#40;$more_data&#41;; # continues from previous state
-
-=item salsa20_stream
-
-Takes a hashref that will be passed to salsa20.  Uses the resulting
-encoder to generate a more continuous encoded stream.  The salsa20
-method encodes in chunks of 64 bytes.  If a string is not a multiple
-of 64, then some of the xor bytes are unused.  The salsa20_stream
-method maintains a buffer of xor bytes to ensure that none are wasted.
-
-    my $encoder = $self-&gt;salsa20_stream&#40;{key =&gt; $key, iv =&gt; $Iv}&#41;; # no data
-    my $encoded = $encoder-&gt;&#40;&#34;1234&#34;&#41;;   # calls salsa20-&gt;&#40;&#41;
-    my $part2   = $encoder-&gt;&#40;&#34;1234&#34;&#41;;   # uses the same pad until 64 bytes are used
-
 =back
 
 =head1 OTHER METHODS
@@ -2296,10 +2169,6 @@
     Copyright: 2010-2012, Felix Geyer &lt;debfx@fobos.de&gt;
                2011-2012, Florian Geyer &lt;blueice@fobos.de&gt;
 
-The salsa20 algorithm is based on
-<span class="clickylink"><a target="new" rel="nofollow" href="http://cr.yp.to/snuffle/salsa20/regs/salsa20.c">http://cr.yp.to/snuffle/salsa20/regs/salsa20.c</a></span> which is listed as
-Public domain &#40;D. J. Bernstein&#41;.
-
 The ordering and layering of encryption/decryption algorithms of
 File::KeePass are of derivative nature from KeePassX and could not
 have been created without this insight - though the perl code is from
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
