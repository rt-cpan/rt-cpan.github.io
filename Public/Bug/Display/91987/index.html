<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #91987 for version: Scripts using version-0.9904+ are broken under locales with decimal comma</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #91987 for version: Scripts using version-0.9904+ are broken under locales with decimal comma</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=version">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=version">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=version">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=version">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/version">version CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">91987</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=version">version</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
contyk [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-34940-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.9904    </td>
  </tr>
  <tr id="CF-34941-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=91987">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1310035" href="/Public/Bug/Display.html?id=91987#txn-1310035">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;09&nbsp;11:40:15&nbsp;2014</span>
    <span class="description">contyk [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Scripts using version-0.9904+ are broken under locales with
 decimal comma</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1310035/694279/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/694279">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 404b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The subject says it all.  This issue can be easily reproduced with the code below:

LC_NUMERIC=hu_HU.utf8 perl -e &#39;use Gtk2 -init; use DBD::Pg;&#39;
Invalid version format &#40;non-numeric data&#41; at /usr/share/perl5/vendor_perl/Exporter/Heavy.pm line 237.
Compilation failed in require at -e line 1.
BEGIN failed--compilation aborted at -e line 1.

This runs just fine with &lt;=0.9903 or with decimal point locales.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1310379" href="/Public/Bug/Display.html?id=91987#txn-1310379">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;10&nbsp;07:07:26&nbsp;2014</span>
    <span class="description">john.peacock [...] havurah-software.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #91987] Scripts using version-0.9904+ are broken under locales with  decimal comma</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 10 Jan 2014 07:07:13 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-version [...] rt.cpan.org, undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Peacock &lt;john.peacock [...] havurah-software.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1310379/694475/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/694475">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 01/09/2014 11:40 AM, Petr Šabata via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thu Jan 09 11:40:15 2014: Request 91987 was acted upon.
&gt; Transaction: Ticket created by contyk
&gt;         Queue: version
&gt;       Subject: Scripts using version-0.9904+ are broken under locales with
&gt;   decimal comma
&gt;     Broken in: 0.9904
&gt;      Severity: &#40;no value&#41;
&gt;         Owner: Nobody
&gt;    Requestors: contyk@redhat.com
&gt;        Status: new
&gt;   Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=91987">https://rt.cpan.org/Ticket/Display.html?id=91987</a></span> &gt;
&gt;
&gt;
&gt; The subject says it all.  This issue can be easily reproduced with the code below:
&gt;
&gt; LC_NUMERIC=hu_HU.utf8 perl -e &#39;use Gtk2 -init; use DBD::Pg;&#39;
&gt; Invalid version format &#40;non-numeric data&#41; at /usr/share/perl5/vendor_perl/Exporter/Heavy.pm line 237.
&gt; Compilation failed in require at -e line 1.
&gt; BEGIN failed--compilation aborted at -e line 1.
&gt;
&gt; This runs just fine with &lt;=0.9903 or with decimal point locales.
&gt;
</div>
I am unable to replicate this using 0.9906 &#40;current&#41; or anything 
earlier.  NOTE: because you are not explicitly using version in your 
example, you are in fact using whatever version.pm is currently in the 
core code for your Perl &#40;which you didn&#39;t tell me about&#41;.

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1310380" href="/Public/Bug/Display.html?id=91987#txn-1310380">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;10&nbsp;07:07:26&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1310391" href="/Public/Bug/Display.html?id=91987#txn-1310391">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;10&nbsp;08:14:40&nbsp;2014</span>
    <span class="description">contyk [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> contyk [...] redhat.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1310391/694481/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/694481">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 10 07:07:26 2014, john.peacock@havurah-software.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 01/09/2014 11:40 AM, Petr Šabata via RT wrote:
<div class="message-stanza open">&gt; &gt; Thu Jan 09 11:40:15 2014: Request 91987 was acted upon.
&gt; &gt; Transaction: Ticket created by contyk
&gt; &gt;         Queue: version
&gt; &gt;       Subject: Scripts using version-0.9904+ are broken under locales
&gt; &gt; with
&gt; &gt;   decimal comma
&gt; &gt;     Broken in: 0.9904
&gt; &gt;      Severity: &#40;no value&#41;
&gt; &gt;         Owner: Nobody
&gt; &gt;    Requestors: contyk@redhat.com
&gt; &gt;        Status: new
&gt; &gt;   Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=91987">https://rt.cpan.org/Ticket/Display.html?id=91987</a></span> &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; The subject says it all.  This issue can be easily reproduced with
&gt; &gt; the code below:
&gt; &gt;
&gt; &gt; LC_NUMERIC=hu_HU.utf8 perl -e &#39;use Gtk2 -init; use DBD::Pg;&#39;
&gt; &gt; Invalid version format &#40;non-numeric data&#41; at
&gt; &gt; /usr/share/perl5/vendor_perl/Exporter/Heavy.pm line 237.
&gt; &gt; Compilation failed in require at -e line 1.
&gt; &gt; BEGIN failed--compilation aborted at -e line 1.
&gt; &gt;
&gt; &gt; This runs just fine with &lt;=0.9903 or with decimal point locales.
&gt; &gt;
</div>&gt; 
&gt; I am unable to replicate this using 0.9906 &#40;current&#41; or anything
&gt; earlier.  NOTE: because you are not explicitly using version in your
&gt; example, you are in fact using whatever version.pm is currently in the
&gt; core code for your Perl &#40;which you didn&#39;t tell me about&#41;.
&gt; 
&gt; John
</div>
I&#39;m running perl 5.18.1 but I&#39;m not using the `version&#39; bundled with it &#40;0.9902&#41;; I only have CPAN `version&#39; installed [0] and this issue appears with 0.9904 or newer, without any other changes on the system, every time.  Even though the reproducer doesn&#39;t use version directly, I assume it&#39;s used somewhere in Gtk2 or DBD::Pg, or modules used by them.

This was originally reported for Fedora here:
<span class="clickylink"><a target="new" rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=1050042">https://bugzilla.redhat.com/show_bug.cgi?id=1050042</a></span>

[0] Fedora replaces the core packages with updates from CPAN, if available.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1310582" href="/Public/Bug/Display.html?id=91987#txn-1310582">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;10&nbsp;19:11:39&nbsp;2014</span>
    <span class="description">john.peacock [...] havurah-software.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #91987] Scripts using version-0.9904+ are broken under locales with decimal comma</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 10 Jan 2014 19:11:29 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-version [...] rt.cpan.org, undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Peacock &lt;john.peacock [...] havurah-software.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1310582/694604/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/694604">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 01/10/2014 08:14 AM, Petr Šabata via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m running perl 5.18.1 but I&#39;m not using the `version&#39; bundled with
&gt; it &#40;0.9902&#41;; I only have CPAN `version&#39; installed [0] and this issue
&gt; appears with 0.9904 or newer, without any other changes on the
&gt; system, every time.  Even though the reproducer doesn&#39;t use version
&gt; directly, I assume it&#39;s used somewhere in Gtk2 or DBD::Pg, or modules
&gt; used by them.
</div>
It is not possible to separate the version C/XS code from the core; if 
they have just eliminated the version.pm file, they are not doing 
anything useful &#40;it is just a stub in the core&#41;.  The C/XS code is part 
of util.c/universal.c and it is not severable.

Similarly, just installing the cpan version.pm distribution doesn&#39;t 
replace the core XS code until something calls &#39;use version;&#39; at which 
point the cpan code overrides the core code for most purposes.  In this 
case, it appears that DBD::Pg is the one that is calling the CPAN 
version code.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
</div>This was originally reported for Fedora here
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=1050042">https://bugzilla.redhat.com/show_bug.cgi?id=1050042</a></span>
&gt;
&gt; [0] Fedora replaces the core packages with updates from CPAN, if available.
&gt;
</div>
It is far more likely that Fedora&#39;s usual interference in Perl packaging 
has broken something.  It isn&#39;t the first time and it won&#39;t be the last. 
  To some extent, I can understand their desire to have smaller more 
modular packaging, but it makes life hard for everyone else.

I suppose I&#39;ll have to set up a VM running Fedora 20 and see if I can 
figure out what is going on...

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1310653" href="/Public/Bug/Display.html?id=91987#txn-1310653">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;11&nbsp;12:17:29&nbsp;2014</span>
    <span class="description">john.peacock [...] havurah-software.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #91987] Scripts using version-0.9904+ are broken under locales with decimal comma</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 11 Jan 2014 12:17:18 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-version [...] rt.cpan.org, undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Peacock &lt;john.peacock [...] havurah-software.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1310653/694645/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/694645">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 01/10/2014 07:11 PM, John Peacock via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It is far more likely that Fedora&#39;s usual interference in Perl packaging
&gt; has broken something.  It isn&#39;t the first time and it won&#39;t be the last.
&gt;    To some extent, I can understand their desire to have smaller more
&gt; modular packaging, but it makes life hard for everyone else.
&gt;
&gt; I suppose I&#39;ll have to set up a VM running Fedora 20 and see if I can
&gt; figure out what is going on...
</div>
I have managed to replicate it on my system running the moral equivalent 
of the originally reported command:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; $ LC_NUMERIC=hu_HU.utf8 perl -I blib/lib/ -I blib/arch/ -Mversion -e &#39;use POSIX qw/locale_h/; use locale; setlocale&#40;LC_NUMERIC,&#34;hu_HU.utf8&#34;&#41;; print version-&gt;VERSION&#40;0.9902&#41;;&#39;
&gt; Invalid version format &#40;non-numeric data&#41; at -e line 1.
</div>
Removing either the setlocale&#40;&#41; or the LC_NUMERIC from the environment 
causes the problem to go away.  I&#39;ve only managed to replicate this 
under 5.18.1 so far.  I&#39;m going to try and add this to my test suite and 
see if it is specific to 5.18.x or not &#40;I suspect it is&#41;.

So I cannot directly blame Fedora&#39;s disregard for CPAN authors for 
/this/ bug, though I can complain that the perl-version RPM you are 
shipping has its package Version listed as 0.99.04, which I can assure 
you has never existed.

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1310767" href="/Public/Bug/Display.html?id=91987#txn-1310767">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;11&nbsp;17:00:22&nbsp;2014</span>
    <span class="description">john.peacock [...] havurah-software.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #91987] Scripts using version-0.9904+ are broken under locales with decimal comma</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 11 Jan 2014 17:00:11 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-version [...] rt.cpan.org, undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Peacock &lt;john.peacock [...] havurah-software.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1310767/694690/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/694690">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 952b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 01/11/2014 12:17 PM, John Peacock via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Removing either the setlocale&#40;&#41; or the LC_NUMERIC from the environment
&gt; causes the problem to go away.  I&#39;ve only managed to replicate this
&gt; under 5.18.1 so far.  I&#39;m going to try and add this to my test suite and
&gt; see if it is specific to 5.18.x or not &#40;I suspect it is&#41;.
</div>
I&#39;ve tracked this down ultimately to a bug in Perl itself.  version.pm 
used to &#40;pre 0.9904&#41; always save the current locale and switch to &#39;C&#39;, 
then switch back.  Starting with 0.9904, the version.pm code attempted 
to only switch the locale when necessary.  But that turns out to not be 
reliable with older Perls.

Improvements have been made to Perl, so it is now possible to 
consistently determine whether a non-C locale is in force.  I have a 
patch that restores the old behavior for the Perl releases prior to 
5.19.0, which appears to fix the problem everywhere.

I&#39;ll try and push a new release soonish...

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1311580" href="/Public/Bug/Display.html?id=91987#txn-1311580">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;13&nbsp;06:49:10&nbsp;2014</span>
    <span class="description">jpeacock [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1311580/695070/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/695070">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 15b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in 0.9907
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1311582" href="/Public/Bug/Display.html?id=91987#txn-1311582">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;13&nbsp;06:49:11&nbsp;2014</span>
    <span class="description">jpeacock [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1312278" href="/Public/Bug/Display.html?id=91987#txn-1312278">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;10:53:37&nbsp;2014</span>
    <span class="description">contyk [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> contyk [...] redhat.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1312278/695507/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/695507">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 472b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jan 13 06:49:10 2014, JPEACOCK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Fixed in 0.9907
</div>
Thank you, I&#39;m looking forward to the release :&#41;

To explain the version string in Fedora -- this is a hack for RPM introduced with the 0.7701, I assume.  RPM compares versions by splitting the version string by periods and then comparing the numbers.  This guaranteed a clean upgrade path for 0.78.  It&#39;s obviously unneeded for 0.99* but it doesn&#39;t break anything either.

Thanks again for a quick fix,
Petr
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.497349</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
