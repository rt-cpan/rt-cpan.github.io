<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #93393 for Spreadsheet-ParseExcel: Unable to determine active worksheet</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #93393 for Spreadsheet-ParseExcel: Unable to determine active worksheet</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-ParseExcel">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-ParseExcel">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-ParseExcel">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-ParseExcel">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">93393</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-ParseExcel">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
tlhackque [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.59    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.61    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=93393">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331375" href="/Public/Bug/Display.html?id=93393#txn-1331375">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;26&nbsp;13:30:11&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Unable to determine active worksheet</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331375/706260/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706260">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Another in the series:

It turns out to be useful to know which worksheet was active &#40;open&#41; when the workbook was saved, as users may expect this to be the default worksheet that is processed by the application.

Turns out to be easy to get.  &#40;Actually, the WINDOW1 and WINDOW2 records have other interesting data, but they&#39;ll wait until I need them.&#41;

Adds $workbook-&gt;get_active_sheet; returns sheet number &#40;or, rarely: undef - workbooks that don&#39;t have the record field include those prior to BIFF5&#41;.

This is a new record type &#40;to S:P:E&#41;, so it&#39;s another easy addition.

Usual patch:

package ExcelToHtml::Parser;

# Hacks to get additional information from the spreadsheets
#
# These use the Spreadsheet::ParseExcel routines for everything
# else to ensure that any bugs there aren&#39;t replicated.

our @ISA = &#40;qw/Spreadsheet::ParseExcel/&#41;;

sub new {
    my $class = shift;

    $Spreadsheet::ParseExcel::ProcTbl{0x3D} = \&#38;_subWindow1;
    return $class-&gt;SUPER::new&#40;@_&#41;;
}

sub _subWindow1 {
    my &#40; $oBook, $bOp, $bLen, $sWk &#41; = @_;

    return if &#40; $oBook-&gt;{BIFFVersion} &lt;= Spreadsheet::ParseExcel::verBIFF4&#40;&#41; &#41;;

    my&#40;$iHpos, $iVpos, $iWidth, $iHeight, $iOptions, $iActive, $iFirstTab,
       $iNumSelected, $iTabBarWidth &#41; = unpack&#40; &#34;v9&#34;, $sWk &#41;;

    $oBook-&gt;{ActiveSheet} = $iActive;
}

package Spreadsheet::ParseExcel::Workbook;

=head2 get_active_sheet&#40;&#41;

Return the &#40;0-based&#41; number of the active &#40;open&#41; worksheet &#40;at the time the workbook
was saved.  May return undef.

=cut

sub get_active_sheet {
    my $workbook = shift;

    return $workbook-&gt;{ActiveSheet} ;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331775" href="/Public/Bug/Display.html?id=93393#txn-1331775">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;27&nbsp;13:46:20&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331775/706510/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706510">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 499b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Feb 26 13:30:11 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Another in the series:
</div>
I think for this and all of the other &#39;expose another attribute&#39; enhancements that require handling another event, there should be some kind of plugin rather than unconditionally adding more events to the global event handler since 99% of the time this is not needed, so why slow down the parsing 100% of the time. I&#39;m not yet sure exactly what kind of plugin should be implemented, but will think about it for the time being.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331776" href="/Public/Bug/Display.html?id=93393#txn-1331776">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;27&nbsp;13:46:20&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331885" href="/Public/Bug/Display.html?id=93393#txn-1331885">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;27&nbsp;22:27:16&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93393] Unable to determine active worksheet</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 27 Feb 2014 22:26:55 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque &lt;tlhackque [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331885/706556/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706556">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 27-Feb-14 13:46, Douglas Wilson via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93393">https://rt.cpan.org/Ticket/Display.html?id=93393</a></span> &gt;
&gt;
&gt; On Wed Feb 26 13:30:11 2014, tlhackque wrote:
<div class="message-stanza open">&gt;&gt; Another in the series:
</div>&gt; I think for this and all of the other &#39;expose another attribute&#39; enhancements that require handling another event, there should be some kind of plugin rather than unconditionally adding more events to the global event handler since 99% of the time this is not needed, so why slow down the parsing 100% of the time. I&#39;m not yet sure exactly what kind of plugin should be implemented, but will think about it for the time being.
&gt;
</div>Most don&#39;t require another event - I simply had to hook the existing 
ones.  Two do.

I doubt that the slowdown is measurable, but I&#39;m open to another 
approach.  These are pretty much check a bit, store a value - it&#39;s not 
that the routines do a lot of work.

A plugin with &#39;register_handler&#40;code, \&#38;sub&#41; could be done.  But the 
result will be hard to document if it&#39;s to stay compatible with the 
current API.  It will seem arbitrary which routines need the plugin to 
be active, and which don&#39;t.

Autoload won&#39;t help, because by the time someone calls get_foo, the 
parsing has been done.

Note that there are many less useful items in the current code - e.g. 
is_print_comments, when comment&#39;s can&#39;t be retrieved.  &#39;new&#39; and &#39;old&#39; 
may make sense to PSE maintainers, but not to users.

So I don&#39;t think there&#39;s a lot of payback for adding that complexity; 
personally I&#39;d rather you invest in the harder issues - like making the 
parser in P:S:E:Utility work.



-- 
This communication may not represent my employer&#39;s views,
if any, on the matters discussed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331991" href="/Public/Bug/Display.html?id=93393#txn-1331991">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;06:52:57&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331991/706603/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706603">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 462b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Feb 27 13:46:20 2014, DOUGW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think for this and all of the other &#39;expose another attribute&#39;
&gt; enhancements that require handling another event, there should be some
&gt; kind of plugin
</div>
Hi,

I think that is a very good idea.

There could be a public method to add callbacks to the %ProcTbl hash. The %ProcTbl hash should then be localised to the object rather than the class.

That way users don&#39;t need a maintainer to add/fix functionality.

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331994" href="/Public/Bug/Display.html?id=93393#txn-1331994">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;06:56:26&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331994/706606/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706606">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 463b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Feb 26 13:30:11 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Adds $workbook-&gt;get_active_sheet; returns sheet number &#40;or, rarely:
&gt; undef - workbooks that don&#39;t have the record field include those prior
&gt; to BIFF5&#41;.
</div>
Hi Timothe,

I think that code changes like this should be accompanied by tests cases. Especially if you want the changes to be upstreamed into the CPAN module.

There are several similar test cases that you could copy and use with sample Excel files.

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331997" href="/Public/Bug/Display.html?id=93393#txn-1331997">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;06:59:59&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331997/706609/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706609">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 166b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Doug, Timothe,

BTW just a general point.

Most of the existing code style is inherited ugly camelcase.

Feel free to improve the style as you modify the code.

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1332062" href="/Public/Bug/Display.html?id=93393#txn-1332062">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;10:09:31&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93393] Unable to determine active worksheet</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Feb 2014 10:09:21 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque &lt;tlhackque [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1332062/706657/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706657">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 28-Feb-14 06:56, John McNamara via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93393">https://rt.cpan.org/Ticket/Display.html?id=93393</a></span> &gt;
&gt;
&gt; On Wed Feb 26 13:30:11 2014, tlhackque wrote:
<div class="message-stanza open">&gt;&gt; Adds $workbook-&gt;get_active_sheet; returns sheet number &#40;or, rarely:
&gt;&gt; undef - workbooks that don&#39;t have the record field include those prior
&gt;&gt; to BIFF5&#41;.
</div>&gt; Hi Timothe,
&gt;
&gt; I think that code changes like this should be accompanied by tests cases. Especially if you want the changes to be upstreamed into the CPAN module.
&gt;
&gt; There are several similar test cases that you could copy and use with sample Excel files.
&gt;
&gt; John
</div>Yes, I would like the changes upstreamed into CPAN - otherwise I 
wouldn&#39;t bother publishing them.  If they&#39;re in CPAN, I don&#39;t have to 
patch S:P:E at runtime in my application; other users get the benefit of 
the features; and everyone&#39;s life is simpler.

I created test cases for get_active_sheet, color_idx_to_rgb, 
get_tab_color, is_sheet_hidden, is_row_hidden, is_col_hidden and 
committed them to my github repo. 
&#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/tlhackque/spreadsheet-parseexcel&#41;">https://github.com/tlhackque/spreadsheet-parseexcel&#41;</a></span>

I&#39;m a bit confused - who is maintaining the module?

John - you wrote that you&#39;d put it up for adoption and it was 
unmaintained due to lack of time; I assumed Doug took it on when he 
started responding to my tickets.

I&#39;d like a plan.  I really don&#39;t want to do everything three times - 
once as a runtime patch in my project, once in a ticket, and again in git.

I&#39;m really focused on my project - but happy to contribute S:P:E 
patches, since if they will drive a release, I won&#39;t have to patch S:P:E 
when I release my code.

It sounds as though you both prefer patches in git, which is fine. Who 
should get pull requests? Do you want every issue in an rt ticket?  If a 
ticket, do you also want pull requests?  Can we keep it simple?

What&#39;s the easiest for everyone?  I vote for just git... if one or the 
other of you will commit to releasing P:S:E with the &#40;agreed-upon&#41; 
patches when my work stabilizes and is ready for release.  I hope in the 
next few days - I&#39;m getting close.

Then I can do my work against my git repo, you can easily merge patches, 
and everyone else will get a release sometime soon.

Second choice would be patches in git, with a copy of the commit message 
in rt.

Third choice is just focus on my project - and forget upstreaming patches.

To simplify my list of open tickets:

  * It would be a big help if rt#93142 &#40;Date format strings&#41; could be
    addressed.  I have work-arounds or patches for everything else.

  * The work-around for 93067 &#40;api for accurate width and height&#41; is
    imperfect.  I could develop a real patch.

Thanks.

-- 
This communication may not represent my employer&#39;s views,
if any, on the matters discussed.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1332062/706658/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706658">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.6k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1333665" href="/Public/Bug/Display.html?id=93393#txn-1333665">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;19:00:43&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1333665/707515/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/707515">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 13b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in 0.61
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1333668" href="/Public/Bug/Display.html?id=93393#txn-1333668">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;19:00:45&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1333670" href="/Public/Bug/Display.html?id=93393#txn-1333670">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;19:01:23&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Fixed in 0.61 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.475457</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
