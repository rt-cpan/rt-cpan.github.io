<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #132973 for Term-Detect-Software: Term::Detect::Software v0.222 Bug Report</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #132973 for Term-Detect-Software: Term::Detect::Software v0.222 Bug Report</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Term-Detect-Software/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Term-Detect-Software/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Term-Detect-Software/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Term-Detect-Software/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Term-Detect-Software">Term-Detect-Software CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">132973</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Term-Detect-Software/Active/">Term-Detect-Software</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
vanw [...] sabalcore.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-251814-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-251815-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;09&nbsp;08:49:33&nbsp;2020</span>
    <span class="description">vanw [...] sabalcore.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> perlancar [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Term::Detect::Software v0.222 Bug Report</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 9 Jul 2020 08:49:10 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Term-Detect-Software [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Van Workum &lt;vanw [...] sabalcore.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Summary:

Running Term::Detect::Software:detect_terminal&#40;&#41; in a Docker container
emits an &#34;uninitialized value&#34; warning.

Reproduce:

# docker run --rm -t perl:latest bash -c &#34;cpanm --notest --quiet
Term::Detect::Software; perl -MTerm::Detect::Software=detect_terminal -e
detect_terminal&#34;
Successfully installed Proc-ProcessTable-0.59
Successfully installed Proc-Find-Parents-0.631
Successfully installed File-Which-1.23
Successfully installed Term-Detect-Software-0.222
4 distributions installed
*Use of uninitialized value $proc in string eq at
/usr/local/lib/perl5/site_perl/5.32.0/Term/Detect/Software.pm line 156.*

Bug:

detect_terminal assumes the perl process has a parent process, but under
docker, this is not always true. It can be PID 1.

Patch:

*** /usr/local/share/perl5/Term/Detect/Software.pm      2019-08-20
19:28:53.000000000 +0000
--- Software.pm 2020-07-09 11:04:33.461206097 +0000
***************
*** 138,144 ****
              }

              # [0] is shell
!             my $proc = @$ppids &gt;= 1 ? $ppids-&gt;[1]{name} : &#39;&#39;;
              #say &#34;D:proc=$proc&#34;;
              if &#40;$proc ~~ $gnome_terminal_terms&#41; {
                  push @dbg, &#34;detect: gnome-terminal via procname &#40;$proc&#41;&#34;;
--- 138,144 ----
              }

              # [0] is shell
!             my $proc = @$ppids &gt;= 2 ? $ppids-&gt;[1]{name} : &#39;&#39;;
              #say &#34;D:proc=$proc&#34;;
              if &#40;$proc ~~ $gnome_terminal_terms&#41; {
                  push @dbg, &#34;detect: gnome-terminal via procname &#40;$proc&#41;&#34;;

-- 
*Kevin Van Workum, PhD*
*Principal, Sabalcore*

*P*   877-492-8027 x1011
*W*  www.sabalcore.com   *E* vanw@sabalcore.com
*A   *3505 Lake Lynda Drive Suite 200, Orlando, FL 32817

-- 




*Disclaimer* 
The information contained in this communication from the 
sender is confidential. It is intended solely for use by the recipient and 
others authorized to receive it. If you are not the recipient, you are 
hereby notified that any disclosure, copying, distribution or taking action 
in relation of the contents of this information is strictly prohibited and 
may be unlawful.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;09&nbsp;17:50:46&nbsp;2020</span>
    <span class="description">PERLANCAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks, applied and released 0.223.

On Thu, 9 Jul 2020 12:49:33 GMT, vanw@sabalcore.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Summary:
&gt; 
&gt; Running Term::Detect::Software:detect_terminal&#40;&#41; in a Docker container
&gt; emits an &#34;uninitialized value&#34; warning.
&gt; 
&gt; Reproduce:
&gt; 
&gt; # docker run --rm -t perl:latest bash -c &#34;cpanm --notest --quiet
&gt; Term::Detect::Software; perl -MTerm::Detect::Software=detect_terminal -e
&gt; detect_terminal&#34;
&gt; Successfully installed Proc-ProcessTable-0.59
&gt; Successfully installed Proc-Find-Parents-0.631
&gt; Successfully installed File-Which-1.23
&gt; Successfully installed Term-Detect-Software-0.222
&gt; 4 distributions installed
&gt; *Use of uninitialized value $proc in string eq at
&gt; /usr/local/lib/perl5/site_perl/5.32.0/Term/Detect/Software.pm line 156.*
&gt; 
&gt; Bug:
&gt; 
&gt; detect_terminal assumes the perl process has a parent process, but under
&gt; docker, this is not always true. It can be PID 1.
&gt; 
&gt; Patch:
&gt; 
&gt; *** /usr/local/share/perl5/Term/Detect/Software.pm      2019-08-20
&gt; 19:28:53.000000000 +0000
&gt; --- Software.pm 2020-07-09 11:04:33.461206097 +0000
&gt; ***************
&gt; *** 138,144 ****
&gt;               }
&gt; 
&gt;               # [0] is shell
&gt; !             my $proc = @$ppids &gt;= 1 ? $ppids-&gt;[1]{name} : &#39;&#39;;
&gt;               #say &#34;D:proc=$proc&#34;;
&gt;               if &#40;$proc ~~ $gnome_terminal_terms&#41; {
&gt;                   push @dbg, &#34;detect: gnome-terminal via procname &#40;$proc&#41;&#34;;
&gt; --- 138,144 ----
&gt;               }
&gt; 
&gt;               # [0] is shell
&gt; !             my $proc = @$ppids &gt;= 2 ? $ppids-&gt;[1]{name} : &#39;&#39;;
&gt;               #say &#34;D:proc=$proc&#34;;
&gt;               if &#40;$proc ~~ $gnome_terminal_terms&#41; {
&gt;                   push @dbg, &#34;detect: gnome-terminal via procname &#40;$proc&#41;&#34;;
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;09&nbsp;17:50:47&nbsp;2020</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;09&nbsp;17:50:47&nbsp;2020</span>
    <span class="description">PERLANCAR [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
