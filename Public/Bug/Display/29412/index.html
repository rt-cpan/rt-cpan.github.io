<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #29412 for JavaScript: &#34;this can&#39;t happen&#34; happens just too often</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #29412 for JavaScript: &#34;this can&#39;t happen&#34; happens just too often</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/JavaScript/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/JavaScript/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/JavaScript/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/JavaScript/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/JavaScript">JavaScript CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">29412</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/JavaScript/Active/">JavaScript</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">CLAESJAC [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
agentzh [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-17548-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.03    </td>
  </tr>
  <tr id="CF-17549-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;04:59:19&nbsp;2007</span>
    <span class="description">agentzh [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Claes Jakobsson&#34; &lt;claesjac [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> &#34;this can&#39;t happen&#34; happens just too often</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Sep 2007 16:54:12 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-javascript [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agent Zhang&#34; &lt;agentzh [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, Claes

I&#39;m writing something big atop this module &#40;integrating HTML::DOM into
JS&#41;. First of all I must say JavaScript.pm is really a great module;
thank you for your excellent work ;&#41;

However, I just get the following error too often today:

&#34;this can&#39;t happen.&#34;

I&#39;d expect if JavaScript.xs fails to convert a JS object to a Perl
hash, it should simply convert it to a string &#40;by calling the JS obj&#39;s
toString method or some such&#41;.

Also, it seems to me, calling die in Perl callbacks also triggers this
error message, for example:

$context-&gt;bind_function&#40;&#39;die&#39; =&gt; sub { die &#34;@_&#34; }&#41;;

I&#39;d expect it to propagate the Perl exception instead of simply
ignoring the detailed message and giving a helpless &#34;this can&#39;t
happen&#34; hint.

Currently I have to use &#34;warn&#34; everywhere in my Perl callbacks :&#40;

Hopefully these will get fixed soon :&#41;

Thanks!
agentz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;05:10:53&nbsp;2007</span>
    <span class="description">agentzh [...] yahoo.cn -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oops...I&#39;m very sorry...the RT was just responding too slowly and I
clicked the &#34;Submit&#34; button many times...oh my...they all appeared 18
minutes after...

Sorry again for the inconvenience...

Cheers, agentz

On Mon Sep 17 04:59:19 2007, agentzh@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi, Claes
&gt; 
&gt; I&#39;m writing something big atop this module &#40;integrating HTML::DOM into
&gt; JS&#41;. First of all I must say JavaScript.pm is really a great module;
&gt; thank you for your excellent work ;&#41;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;05:11:23&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;05:20:55&nbsp;2007</span>
    <span class="description">CLAESJAC [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;05:28:04&nbsp;2007</span>
    <span class="description">CLAESJAC [...] cpan.org -  Broken in 1.03 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;05:28:10&nbsp;2007</span>
    <span class="description">CLAESJAC [...] cpan.org -  Severity Important added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;06:45:36&nbsp;2007</span>
    <span class="description">CLAESJAC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Can you supply a test-script that shows the behavior as well as what platform, perl version 
and SpiderMonkey library version &#40;and built options&#41; you&#39;re getting this error with.

I&#39;ve tried the binding die with SpiderMonkey 1.7 version retrieved from 
FIREFOX_2_0_0_7_RELEASE tag in Mozilla CVS and can&#39;t seem to get the error. This is w/ perl 
5.8.6 on Darwin.

Cheers,
Claes

On Mon Sep 17 04:59:19 2007, agentzh@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi, Claes
&gt; 
&gt; I&#39;m writing something big atop this module &#40;integrating HTML::DOM into
&gt; JS&#41;. First of all I must say JavaScript.pm is really a great module;
&gt; thank you for your excellent work ;&#41;
&gt; 
&gt; However, I just get the following error too often today:
&gt; 
&gt; &#34;this can&#39;t happen.&#34;
&gt; 
&gt; I&#39;d expect if JavaScript.xs fails to convert a JS object to a Perl
&gt; hash, it should simply convert it to a string &#40;by calling the JS obj&#39;s
&gt; toString method or some such&#41;.
&gt; 
&gt; Also, it seems to me, calling die in Perl callbacks also triggers this
&gt; error message, for example:
&gt; 
&gt; $context-&gt;bind_function&#40;&#39;die&#39; =&gt; sub { die &#34;@_&#34; }&#41;;
&gt; 
&gt; I&#39;d expect it to propagate the Perl exception instead of simply
&gt; ignoring the detailed message and giving a helpless &#34;this can&#39;t
&gt; happen&#34; hint.
&gt; 
&gt; Currently I have to use &#34;warn&#34; everywhere in my Perl callbacks :&#40;
&gt; 
&gt; Hopefully these will get fixed soon :&#41;
&gt; 
&gt; Thanks!
&gt; agentz
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;07:20:46&nbsp;2007</span>
    <span class="description">agentzh [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #29412] &#34;this can&#39;t happen&#34; happens just too often</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Sep 2007 19:19:59 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JavaScript [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agent Zhang&#34; &lt;agentzh [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 9/17/07, Claes Jakobsson via RT &lt;bug-JavaScript@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt;
&gt; Can you supply a test-script that shows the behavior as well as what platform, perl version
&gt; and SpiderMonkey library version &#40;and built options&#41; you&#39;re getting this error with.
&gt;
</div>
I&#39;ve attached my stuff...sorry, I can&#39;t make it any smaller...die
works fine in small cases. You know, I&#39;m building something really big
here...predictability is very important for me...

please extract the ajaxperl-tmp directory from this .tar.gz, and do
the following:

$ cd ajaxperl-tmp
$ ./test.t
it will gives something like:

1..11
ok 1
ok 2
ok 3
ok 4 - URL works
ok 5
ok 6 - getAttribute works
ok 7 - tagName works
ok 8 - document.write works
ok 9
Can&#39;t convert perl error into JSVAL at
/usr/local/lib/perl/5.8.8/JavaScript/Context.pm line 40, &lt;$fh&gt; line
35.
BEGIN failed--compilation aborted at ./test.t line 4.
# Looks like you planned 11 tests but only ran 9.
# Looks like your test died just after 9.

The error is caused by a die call around AjaxPerl.pm&#39;s line 94. By
commenting out that die statement, all tests are passing for me.

I&#39;m using js-1.60.tar.gz which was downloaded from
ftp://ftp.mozilla.org/pub/mozilla.org/js

And my perl -v shows:

$ perl -v

This is perl, v5.8.8 built for i486-linux-gnu-thread-multi

Hope this helps :&#41;

Cheers, agentz
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;07:26:38&nbsp;2007</span>
    <span class="description">agentzh [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #29412] &#34;this can&#39;t happen&#34; happens just too often</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Sep 2007 19:26:13 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JavaScript [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agent Zhang&#34; &lt;agentzh [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 9/17/07, Agent Zhang &lt;agentzh@gmail.com&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ok 7 - tagName works
&gt; ok 8 - document.write works
&gt; ok 9
&gt; Can&#39;t convert perl error into JSVAL at
&gt; /usr/local/lib/perl/5.8.8/JavaScript/Context.pm line 40, &lt;$fh&gt; line
&gt; 35.
</div>
For this case, I didn&#39;t get &#34;this can&#39;t happen&#34;. What weird error
message I actually get seems to depend on the position of the die call
in my AjaxPerl.pm...and sometimes it just has nothing to do with &#34;die&#34;
at all...It&#39;s very hard to trace...

Seems it has something to do with the JS/Perl type casting
logic...What type of values I pass between JS and Perl really matters
here, which gave me a lot of troubles today...Alas...

Thanks,
agentz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;08:27:55&nbsp;2007</span>
    <span class="description">claes [...] surfar.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #29412] &#34;this can&#39;t happen&#34; happens just too often</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Sep 2007 14:26:47 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-JavaScript [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Claes Jakobsson &lt;claes [...] surfar.nu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hm..

In order to be able to pass Perl blessed object to JavaScript the  
classes must be defined in the context using bind_class. That&#39;s why  
you&#39;re getting the &#34;Can&#39;t convert perl error into JSVAL&#34; error. Maybe  
the error message should say something better tho.

However, I&#39;ll check if it really is necessary in future releases to  
require all classes to be declared.

Would be great if you could supply me with an testcase where the  
other error occurs.

Thanks,
Claes

On 17 sep 2007, at 13.26, agentzh@gmail.com via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;        Queue: JavaScript
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=29412">http://rt.cpan.org/Ticket/Display.html?id=29412</a></span> &gt;
&gt;
&gt; On 9/17/07, Agent Zhang &lt;agentzh@gmail.com&gt; wrote:
<div class="message-stanza open">&gt;&gt; ok 7 - tagName works
&gt;&gt; ok 8 - document.write works
&gt;&gt; ok 9
&gt;&gt; Can&#39;t convert perl error into JSVAL at
&gt;&gt; /usr/local/lib/perl/5.8.8/JavaScript/Context.pm line 40, &lt;$fh&gt; line
&gt;&gt; 35.
</div>&gt;
&gt; For this case, I didn&#39;t get &#34;this can&#39;t happen&#34;. What weird error
&gt; message I actually get seems to depend on the position of the die call
&gt; in my AjaxPerl.pm...and sometimes it just has nothing to do with &#34;die&#34;
&gt; at all...It&#39;s very hard to trace...
&gt;
&gt; Seems it has something to do with the JS/Perl type casting
&gt; logic...What type of values I pass between JS and Perl really matters
&gt; here, which gave me a lot of troubles today...Alas...
&gt;
&gt; Thanks,
&gt; agentz
&gt;
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
