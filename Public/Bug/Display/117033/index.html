<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #117033 for Mail-IMAPClient: accessing messages on an IMAP server by message number</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #117033 for Mail-IMAPClient: accessing messages on an IMAP server by message number</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Mail-IMAPClient">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Mail-IMAPClient">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Mail-IMAPClient">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Mail-IMAPClient">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Mail-IMAPClient">Mail-IMAPClient CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">117033</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Mail-IMAPClient">Mail-IMAPClient</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
hw [...] gc-24.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19960-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19961-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=117033">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1659636" href="/Public/Bug/Display.html?id=117033#txn-1659636">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;18&nbsp;06:29:51&nbsp;2016</span>
    <span class="description">hw [...] gc-24.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> accessing messages on an IMAP server by message number</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 18 Aug 2016 12:29:36 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Perl Beginners &lt;beginners [...] perl.org&gt;, bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> hw &lt;hw [...] gc-24.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1659636/890831/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/890831">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Hi,

how can I access messages residing on an IMAP server by their
message numbers?  &#34;Message number&#34; means what MUAs like the
one built into Seamonkey display as &#39;Order received&#39;.

The IMAP server being used is cyrus, and the message number
corresponds to the name of the file the message is stored in.
IIRC, these numbers never change unless you run some program
that comes with cyrus to re-number the messages.

According to the documentation, Mail::IMAPClient[1] can use
message numbers to access messages, but it does not work in that
it accesses messages that have different numbers than the number
given as parameter to a function Mail::IMAPClient provides.

For example:


$imap-&gt;migrate&#40;$targetaccount, 25, $targetfolder&#41;;


... copies *a* message &#40;apparently a randomly selected one&#41;, but
not the message that has the number 25.

I have no good way to identify messages other their file names and
thus the message numbers derived from them because the virus scanner
gives me the file names.  I can not simply delete the files because
that would screw up the indices and/or whatever cyrus uses to manage
the messages.

Since it´s not feasible to tell the users that they need to delete a
message with a particular number, I´ve written a program to delete
&#40;quarantine, actually&#41; the messages the virus scanner thinks contain
viruses.  It turns out that my program does not work because messages
are quarantined apparently randomly, and the messages that contain the
viruses remain untouched.  I can even run it several times to quarantine
the same messages, and it will quarantine another message every time,
though the message numbers used are the same each time :&#40;

So either Mail::IMAPClient is buggy, or it uses some other, useless way
to enumerate the messages by itself rather than using the message numbers
the IMAP server uses.

&#40;And yes, the UId is set to 0, and I verified that it remains 0.&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1659640" href="/Public/Bug/Display.html?id=117033#txn-1659640">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;18&nbsp;06:39:27&nbsp;2016</span>
    <span class="description">hw [...] gc-24.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Bugs in Mail-IMAPClient via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: accessing messages on an IMAP server by message number [rt.cpan.org #117033]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 18 Aug 2016 12:39:13 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Perl Beginners &lt;beginners [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> hw &lt;hw [...] gc-24.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1659640/890835/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/890835">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
PS:

I forgot to add:

[1]: <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~plobbes/Mail-IMAPClient-3.38/lib/Mail/IMAPClient.pod">http://search.cpan.org/~plobbes/Mail-IMAPClient-3.38/lib/Mail/IMAPClient.pod</a></span>

And the ticket is:

<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=117033">https://rt.cpan.org/Ticket/Display.html?id=117033</a></span>


hw schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Hi,
&gt;
&gt; how can I access messages residing on an IMAP server by their
&gt; message numbers?  &#34;Message number&#34; means what MUAs like the
&gt; one built into Seamonkey display as &#39;Order received&#39;.
&gt;
&gt; The IMAP server being used is cyrus, and the message number
&gt; corresponds to the name of the file the message is stored in.
&gt; IIRC, these numbers never change unless you run some program
&gt; that comes with cyrus to re-number the messages.
&gt;
&gt; According to the documentation, Mail::IMAPClient[1] can use
&gt; message numbers to access messages, but it does not work in that
&gt; it accesses messages that have different numbers than the number
&gt; given as parameter to a function Mail::IMAPClient provides.
&gt;
&gt; For example:
&gt;
&gt;
&gt; $imap-&gt;migrate&#40;$targetaccount, 25, $targetfolder&#41;;
&gt;
&gt;
&gt; ... copies *a* message &#40;apparently a randomly selected one&#41;, but
&gt; not the message that has the number 25.
&gt;
&gt; I have no good way to identify messages other their file names and
&gt; thus the message numbers derived from them because the virus scanner
&gt; gives me the file names.  I can not simply delete the files because
&gt; that would screw up the indices and/or whatever cyrus uses to manage
&gt; the messages.
&gt;
&gt; Since it´s not feasible to tell the users that they need to delete a
&gt; message with a particular number, I´ve written a program to delete
&gt; &#40;quarantine, actually&#41; the messages the virus scanner thinks contain
&gt; viruses.  It turns out that my program does not work because messages
&gt; are quarantined apparently randomly, and the messages that contain the
&gt; viruses remain untouched.  I can even run it several times to quarantine
&gt; the same messages, and it will quarantine another message every time,
&gt; though the message numbers used are the same each time :&#40;
&gt;
&gt; So either Mail::IMAPClient is buggy, or it uses some other, useless way
&gt; to enumerate the messages by itself rather than using the message numbers
&gt; the IMAP server uses.
&gt;
&gt; &#40;And yes, the UId is set to 0, and I verified that it remains 0.&#41;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1683159" href="/Public/Bug/Display.html?id=117033#txn-1683159">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;14&nbsp;10:35:50&nbsp;2016</span>
    <span class="description">PLOBBES [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1683159/903578/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/903578">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m afraid the questions aren&#39;t really within the scope of Mail::IMAPClient per se.

If you really want to understand what is going on here, then it would probably be worthwhile reading and comprehending the IMAP RFC:
  <span class="clickylink"><a target="new" rel="nofollow" href="https://tools.ietf.org/html/rfc3501">https://tools.ietf.org/html/rfc3501</a></span>

In particular, you may find details on message numbers useful:
  <span class="clickylink"><a target="new" rel="nofollow" href="https://tools.ietf.org/html/rfc3501#section-2.3.1">https://tools.ietf.org/html/rfc3501#section-2.3.1</a></span>
 
And then studying the code of whatever MUA &#40;e.g. Seamonkey&#41; you are using to see if the number they display has any correlation with the UID or message sequence numbers.  I wouldn&#39;t be surprised if they have no direct/obvious correlation - without looking at the code anyway.

In addition, then you would likely also want to study the code for the back-end IMAP server and see if they also guarantee that the UID/sequence number corresponds to what you&#39;re trying to get at.

However, after doing all of that what you are more likely to find is that the &#34;message number&#34; you are referring to in the MUA has little, or possibly no, direct meaning/correlation with the IMAP rfc nor with the IMAP server implementation that you are using.

Sorry if this isn&#39;t what you want to hear, but that my gut feeling on this request.  In the end, if you can determine the appropriate rules, then Mail::IMAPClient may be able to help you make programmatic changes to the mailboxes you wish to modify. Determining if it is trivial, or not, to map those &#34;message numbers&#34; from the client to the UID/sequence numbers that the IMAP server understands is something you&#39;ll have to figure out though, sorry.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1683160" href="/Public/Bug/Display.html?id=117033#txn-1683160">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;14&nbsp;10:35:51&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1683163" href="/Public/Bug/Display.html?id=117033#txn-1683163">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;14&nbsp;10:36:01&nbsp;2016</span>
    <span class="description">PLOBBES [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1683208" href="/Public/Bug/Display.html?id=117033#txn-1683208">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;14&nbsp;11:23:21&nbsp;2016</span>
    <span class="description">hw [...] gc-24.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #117033] accessing messages on an IMAP server by message number</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 14 Nov 2016 17:22:59 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> hw &lt;hw [...] gc-24.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1683208/903600/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/903600">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Phil Pearl &#40;Lobbes&#41; via RT schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=117033">https://rt.cpan.org/Ticket/Display.html?id=117033</a></span> &gt;
&gt;
&gt; I&#39;m afraid the questions aren&#39;t really within the scope of Mail::IMAPClient per se.
&gt;
&gt; If you really want to understand what is going on here, then it would probably be worthwhile reading and comprehending the IMAP RFC:
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="https://tools.ietf.org/html/rfc3501">https://tools.ietf.org/html/rfc3501</a></span>
&gt;
&gt; In particular, you may find details on message numbers useful:
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="https://tools.ietf.org/html/rfc3501#section-2.3.1">https://tools.ietf.org/html/rfc3501#section-2.3.1</a></span>
</div>
Thank you very much for the pointers!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And then studying the code of whatever MUA &#40;e.g. Seamonkey&#41; you are using to see if the number they display has any correlation with the UID or message sequence numbers.  I wouldn&#39;t be surprised if they have no direct/obvious correlation - without looking at the code anyway.
&gt;
&gt; In addition, then you would likely also want to study the code for the back-end IMAP server and see if they also guarantee that the UID/sequence number corresponds to what you&#39;re trying to get at.
&gt;
&gt; However, after doing all of that what you are more likely to find is that the &#34;message number&#34; you are referring to in the MUA has little, or possibly no, direct meaning/correlation with the IMAP rfc nor with the IMAP server implementation that you are using.
&gt;
&gt; Sorry if this isn&#39;t what you want to hear, but that my gut feeling on this request.  In the end, if you can determine the appropriate rules, then Mail::IMAPClient may be able to help you make programmatic changes to the mailboxes you wish to modify. Determining if it is trivial, or not, to map those &#34;message numbers&#34; from the client to the UID/sequence numbers that the IMAP server understands is something you&#39;ll have to figure out though, sorry.
</div>
The message numbers I am referring to are the numbers within
the file names cyrus uses to store the messages on disk.

The message numbers are extracted from a clamav scanning report
by a tool I have written to automatically quarantine messages
containing viruses via IMAP.  Doing this via IMAP is required
because simply deleting the files &#40;like with rm&#41; screws up cyrus`
message spool.

The message numbers are the only way I have to identify the messages
that must be quarantined.[1]

AFAICT, the &#39;order received&#39; field Seamonkey displays
gives you the correct &#34;message number&#34;, i. e. the number from the file
name used by cyrus.  Hence when you use Seamonkey to delete a
message, identified by the message number, it does not
show up in the scanning report anymore.

You can also verify this simply by looking at the message in Seamonkey
and directly at the file that is stored in the spool directory.  Messages
with the same number are always identical seen both ways.

IIRC, IMAP requires that message numbers, as seen by IMAP clients,
must never change &#40;because that could confuse the clients&#41;.

So I don´t understand how the perl module can use different,
apparently random, numbers as message numbers.  Doing this seems very
much broken by design and appears to be a bug that needs fixing.

Its message number is *the* identifier, and a unique one per folder, for
each message stored on an IMAP server.  Expecting to get the message #1234
is what can be expected when you access message #1234.


[1]:
Of course, messages are being scanned before they are accepted by the
MTA. With virus detection improving over time, there are always messages
that were previously accepted and only later found to contain viruses.
Such messages need to be automatically quarantined upon detection.

Since I haven´t found a tool that does this, I´ve written one --- only
to find out that it quarantines the wrong messages because the perl module
uses random message numbers instead of the numbers the messages actually
do have.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.318646</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
