<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #13476 for CPANPLUS: Patch to Fix makemakerflags Argument Processing</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #13476 for CPANPLUS: Patch to Fix makemakerflags Argument Processing</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CPANPLUS/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CPANPLUS/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CPANPLUS/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CPANPLUS/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CPANPLUS">CPANPLUS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">13476</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CPANPLUS/Active/">CPANPLUS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
imacat [...] mail.imacat.idv.tw

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-8270-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.055    </td>
  </tr>
  <tr id="CF-8271-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;30&nbsp;00:35:27&nbsp;2005</span>
    <span class="description">imacat [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Patch to Fix makemakerflags Argument Processing</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi.  I submitted a patch to fix the argument processing in IPC::Cmd.  I tried to set makemakerflags with something like

&#34;PREFIX=C:\Document and Settings\user\Application Data&#34;
PREFIX=&#34;/cygdrive/c/Document and Settings/user/Application Data&#34;

and it croaks with

&#39;&#34;PREFIX&#39; is not a known MakeMaker parameter name.

or end up with

#   MakeMaker ARGV: &#40;q[PREFIX=&#34;/cygdrive/c/Document], q[and], q[Settings/user/Application], q[Data&#34;]&#41;
PREFIX = &#34;/cygdrive/c/Document

Although I think there should also some fix in ExtUtils::MakeMaker altogether to deal with paths containing spaces, but CPANPLUS should send a good arguments list, too.

This patch use the local shell backticks to split the arguments list, instead of splitting it by spaces.  The rule is defined by the local shell.  There is still a potential problem that arguments may not contain new line characters in this patch, but I think it is quite enough for daily use.

Please tell me if there is any problem.  Thank you.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

diff -r -u CPANPLUS-0.055.orig/lib/CPANPLUS/inc/IPC/Cmd.pm CPANPLUS-0.055/lib/CPANPLUS/inc/IPC/Cmd.pm
- --- CPANPLUS-0.055.orig/lib/CPANPLUS/inc/IPC/Cmd.pm	Tue Feb 22 22:14:12 2005
+++ CPANPLUS-0.055/lib/CPANPLUS/inc/IPC/Cmd.pm	Wed Jun 29 10:25:08 2005
@@ -149,7 +149,7 @@
             @command = map { if&#40; /[&lt;&gt;|&#38;]/ &#41; {
                                 $special_chars++; $_;
                              } else {                            
- -                                [ split / +/ ]
+                                [ split &#34;\n&#34;, join &#34;&#34;, `perl -e &#34;print join &#39;\n&#39;, \@ARGV;&#34; $_` ]
                              }
                         } split&#40; /\s*&#40;[&lt;&gt;|&#38;]&#41;\s*/, $cmd &#41;;
         }
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 &#40;GNU/Linux&#41;

iD8DBQFCw3Izi9gubzC5S1wRAs19AJ4uRwNASv4phXB+g2WiK2VafPNCxgCfW3tb
iztJaBSrR/Yc96vFDpu4Hcw=
=BezX
-----END PGP SIGNATURE-----
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;27&nbsp;16:10:01&nbsp;2005</span>
    <span class="description">kane [...] cpan.org -  Status changed from &#39;new&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;27&nbsp;16:10:01&nbsp;2005</span>
    <span class="description">kane [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[IMACAT - Thu Jun 30 00:35:27 2005]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi.  I submitted a patch to fix the argument processing in IPC::Cmd.
&gt;    I tried to set makemakerflags with something like
&gt; 
&gt; &#34;PREFIX=C:\Document and Settings\user\Application Data&#34;
&gt; PREFIX=&#34;/cygdrive/c/Document and Settings/user/Application Data&#34;
&gt; 
&gt; and it croaks with
&gt; 
&gt; &#39;&#34;PREFIX&#39; is not a known MakeMaker parameter name.
&gt; 
&gt; or end up with
&gt; 
&gt; #   MakeMaker ARGV: &#40;q[PREFIX=&#34;/cygdrive/c/Document], q[and],
&gt;    q[Settings/user/Application], q[Data&#34;]&#41;
&gt; PREFIX = &#34;/cygdrive/c/Document
&gt; 
&gt; Although I think there should also some fix in ExtUtils::MakeMaker
&gt;    altogether to deal with paths containing spaces, but CPANPLUS
&gt;    should send a good arguments list, too.
&gt; 
&gt; This patch use the local shell backticks to split the arguments list,
&gt;    instead of splitting it by spaces.  The rule is defined by the
&gt;    local shell.  There is still a potential problem that arguments may
&gt;    not contain new line characters in this patch, but I think it is
&gt;    quite enough for daily use.
&gt; 
&gt; Please tell me if there is any problem.  Thank you.
</div>
Thanks for the patch. There&#39;s 2 issues with it though that makes me not able to apply it.

--- CPANPLUS-0.055.orig/lib/CPANPLUS/inc/IPC/Cmd.pm     Tue Feb 22 22:14:12 2005
+++ CPANPLUS-0.055/lib/CPANPLUS/inc/IPC/Cmd.pm  Wed Jun 29 10:25:08 2005
@@ -149,7 +149,7 @@
             @command = map { if&#40; /[&lt;&gt;|&#38;]/ &#41; {
                                 $special_chars++; $_;
                              } else {                            
- -                                [ split / +/ ]
+                                [ split &#34;\n&#34;, join &#34;&#34;, `perl -e &#34;print join &#39;\n&#39;, \@ARGV;&#34; $_` ]
                              }
                         } split&#40; /\s*&#40;[&lt;&gt;|&#38;]&#41;\s*/, $cmd &#41;;

First of all you use &#39;perl&#39; as the command to execute.. this should be $^X. easily fixable,
but the more important issue is the one of quoting; &#34; works on Win32 and possibly VMS
&#40;maybe some other OS&#39;s, i dont know&#41; but not on unix, there we need &#39;, which doesnt work
on Win32. 

So this fix, regardless of which we choose will break at least one platform. We&#39;d need some
way to reliably quote this to have it apply.

In the meantime, i suggest you use the win32 shortname instead of a path with spaces &#40;as is 
what i belive the installer suggests&#41; to make sure no whitespace issues occur.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;27&nbsp;22:33:17&nbsp;2005</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> imacat</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[KANE - Wed Jul 27 16:10:01 2005]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; First of all you use &#39;perl&#39; as the command to execute.. this should be
&gt; $^X. easily fixable,
&gt; but the more important issue is the one of quoting; &#34; works on Win32
&gt; and possibly VMS
&gt; &#40;maybe some other OS&#39;s, i dont know&#41; but not on unix, there we need &#39;,
&gt; which doesnt work
&gt; on Win32.
</div>
    Ah???  No.  Why?  &#34; works on bash, zsh, tcsh and other unix shells.
 That&#39;s why I choose it.  &#39; doesn&#39;t work on MSWin32.  I&#39;m using that
patch for my linux for a month.  I really don&#39;t know which shell are you
talking about.  It works perfectly.

    Could you clarify which shell &#40;or which unix&#41; is not working?  I
would be more than happy to test it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;27&nbsp;22:33:18&nbsp;2005</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;27&nbsp;22:36:42&nbsp;2005</span>
    <span class="description">imacat [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> imacat</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">    Sorry I forgot to log in.  Please reply to this one and ignore the
previous one so that I can receive your reply notification.

[KANE - Wed Jul 27 16:10:01 2005]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; but the more important issue is the one of quoting; &#34; works on Win32
&gt;    and possibly VMS
&gt; &#40;maybe some other OS&#39;s, i dont know&#41; but not on unix, there we need &#39;,
&gt;    which doesnt work
&gt; on Win32.
</div>
    Ah???  No.  Why?  &#34; works on bash, zsh, tcsh and other unix shells.
 That&#39;s why I choose it.  &#39; doesn&#39;t work on MSWin32.  I&#39;m using that
patch for my linux for a month.  I really don&#39;t know which shell are you
talking about.  It works perfectly.

    Could you clarify which shell &#40;or which unix&#41; is not working?  I
would be more than happy to test it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;25&nbsp;16:45:19&nbsp;2005</span>
    <span class="description">kane [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[IMACAT - Wed Jul 27 22:36:42 2005]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     Sorry I forgot to log in.  Please reply to this one and ignore the
&gt; previous one so that I can receive your reply notification.
&gt; 
&gt; [KANE - Wed Jul 27 16:10:01 2005]:
<div class="message-stanza open">&gt; &gt; but the more important issue is the one of quoting; &#34; works on Win32
&gt; &gt;    and possibly VMS
&gt; &gt; &#40;maybe some other OS&#39;s, i dont know&#41; but not on unix, there we need &#39;,
&gt; &gt;    which doesnt work
&gt; &gt; on Win32.
</div>&gt; 
&gt;     Ah???  No.  Why?  &#34; works on bash, zsh, tcsh and other unix shells.
&gt;  That&#39;s why I choose it.  &#39; doesn&#39;t work on MSWin32.  I&#39;m using that
&gt; patch for my linux for a month.  I really don&#39;t know which shell are you
&gt; talking about.  It works perfectly.
&gt; 
&gt;     Could you clarify which shell &#40;or which unix&#41; is not working?  I
&gt; would be more than happy to test it.
</div>
Argh, i see now i&#39;m not the last one to follow up on this -- very sorry about that :&#40;

using &#34; allows for interpolation, where as &#39; doesn&#39;t.. so all characters that can be construed as 
&#39;special&#39; by the shell will be interpolated, which can have some quite annoying side effect i&#39;d 
like to avoid if at all possible
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;06&nbsp;08:53:15&nbsp;2006</span>
    <span class="description">kane [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;31&nbsp;11:37:24&nbsp;2007</span>
    <span class="description">kane [...] cpan.org -  Status changed from &#39;stalled&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
