<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #67807 for Spreadsheet-XLSX: Strange decimal conversion</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #67807 for Spreadsheet-XLSX: Strange decimal conversion</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-XLSX">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-XLSX">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-XLSX">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-XLSX">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-XLSX">Spreadsheet-XLSX CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">67807</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-XLSX">Spreadsheet-XLSX</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
leon.panokarren [...] farmersinsurance.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-221208-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.13    </td>
  </tr>
  <tr id="CF-221209-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




CODE_FRG.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/928833/482019/CODE_FRG.txt">
Wed Apr 27 22:19:07 2011 (1.3k) by leon.panokarren [...] farmersinsurance.com
</a>
</font></li>
</ul>


perl_V.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/928833/482018/perl_V.txt">
Wed Apr 27 22:19:07 2011 (2k) by leon.panokarren [...] farmersinsurance.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=67807">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-928833" href="/Public/Bug/Display.html?id=67807#txn-928833">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;27&nbsp;22:19:07&nbsp;2011</span>
    <span class="description">leon.panokarren [...] farmersinsurance.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Strange decimal conversion</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/928833/482017/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482017">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 885b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

We are using the Spreadsheet-XLSX-0.13 module for converting an Excel 
2007 file into a csv file using the code on the distribution page. The 
problem is, occasionally, the conversion translates a decimal excel 
cell value to have a value which is nearly the same but not exactly. 
For e.g., 0.167 to 0.1670000000001. I say occasionally, as this is very 
erratic. This causes data processing routines that match exact values 
fail assignments that look for certain specific values. Is there a way 
we could fix this?

Here are some general environment details to aid your review - 

1. Distribution Name and Version: Spreadsheet-XLSX-0.13
2. Attached perl_V.txt
3. uname -amvr output: AIX laatdm62 3 5 00C396BC4C00
4. Code fragment that is producing the error - attachment CODE_FRG.txt

Please let me know anything else I could provide to assist your review. 
Thanks for the help!
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> perl_V.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/928833/482018/perl_V.txt">Download perl_V.txt</a><br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Summary of my perl5 &#40;revision 5 version 10 subversion 1&#41; configuration:

  Platform:
    osname=aix, osvers=5.3.0.0, archname=aix
    uname=&#39;aix laatdm62 3 5 00c396bc4c00 &#39;
    config_args=&#39;-de -Dcc=cc_r&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=undef, usemultiplicity=undef
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=undef, use64bitall=undef, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc_r -q32&#39;, ccflags =&#39;-D_ALL_SOURCE -D_ANSI_C_SOURCE -D_POSIX_SOURCE -qmaxmem=-1 -qnoansialias -DUSE_NATIVE_DLOPEN -q32 -D_LARGE_FILES -qlonglong&#39;,
    optimize=&#39;-O&#39;,
    cppflags=&#39;-D_ALL_SOURCE -D_ANSI_C_SOURCE -D_POSIX_SOURCE -qmaxmem=-1 -qnoansialias -DUSE_NATIVE_DLOPEN&#39;
    ccversion=&#39;&#39;, gccversion=&#39;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=4321
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=8
    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;ld&#39;, ldflags =&#39; -brtl -bdynamic -b32 -bmaxdata:0x80000000&#39;
    libpth=/lib /usr/lib /usr/ccs/lib
    libs=-lbind -lnsl -ldbm -ldl -lld -lm -lcrypt -lc
    perllibs=-lbind -lnsl -ldl -lld -lm -lcrypt -lc
    libc=/lib/libc.a, so=a, useshrplib=false, libperl=libperl.a
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_aix.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;  -bE:/usr/local/lib/perl5/5.10.1/aix/CORE/perl.exp&#39;
    cccdlflags=&#39; &#39;, lddlflags=&#39; -bhalt:4 -G -bI:$&#40;PERL_INC&#41;/perl.exp -bE:$&#40;BASEEXT&#41;.exp -bnoentry -lc -lm&#39;


Characteristics of this binary &#40;from libperl&#41;:
  Compile-time options: PERL_DONT_CREATE_GVSV PERL_MALLOC_WRAP
                        USE_LARGE_FILES USE_PERLIO
  Built under aix
  Compiled at Feb 26 2011 02:13:00
  @INC:
    /usr/local/lib/perl5/5.10.1/aix
    /usr/local/lib/perl5/5.10.1
    /usr/local/lib/perl5/site_perl/5.10.1/aix
    /usr/local/lib/perl5/site_perl/5.10.1
    .</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> CODE_FRG.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/928833/482019/CODE_FRG.txt">Download CODE_FRG.txt</a><br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">        $WkS -&gt; {MaxRow} ||= $WkS -&gt; {MinRow};

        foreach $iR &#40;$WkS -&gt; {MinRow} .. $WkS -&gt; {MaxRow}&#41;

        {

                $WkS -&gt; {MaxCol} ||= $WkS -&gt; {MinCol};

                foreach $iC &#40;$WkS -&gt; {MinCol} ..  $WkS -&gt; {MaxCol}&#41;

                {

                      $cell = $WkS -&gt; {Cells} [$iR] [$iC];

                      if &#40;$cell&#41;
                         {
                            print OUT Spreadsheet::XLSX::Utility2007::unescape_HTML&#40;$cell -&gt; {Val}&#41;;
                      }

                      if &#40; &#40; $iR == ${hdr_seq} - 1 &#41; &#41;
                      {

                          $cfgrec .= Spreadsheet::XLSX::Utility2007::unescape_HTML&#40;$cell -&gt; {Val}&#41;;

                      }

                      if &#40; &#40; $iC == 0 &#41; &#38;&#38; &#40; $iR == ${hdr_seq}  &#41; &#41;
                      {

                          $cfgrec = uc &#40; $cfgrec &#41;;
                          $cfgko  = cnt_ocr &#40; $cfgrec, $keyhdr &#41;;
                          $cfgkey = &#34;*,&#34; x &#40; $klm - $cfgko &#41;;

                      }

                      print OUT &#34;,&#34; if &#40; $iC &lt; $WkS-&gt;{MaxCol} &#41;;

                         print OUT $cfgkey if &#40; &#40;$cfgko == $iC + 1&#41; &#38;&#38; &#40;$iR &gt;= $hdrcnt&#41; &#41;;
              }

                      print OUT &#34;\n&#34;;

        }

        print LOG tmstmp&#40;&#41; . &#34;: Worsheet conversion completed successfully      -----  &#34; . $WkS-&gt;{Name}, &#34;\n&#34;;</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-962441" href="/Public/Bug/Display.html?id=67807#txn-962441">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;01&nbsp;15:47:17&nbsp;2011</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/962441/500814/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/500814">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 509b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Apr 27 22:19:07 2011, ETLTCHFIG wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; problem is, occasionally, the conversion translates a decimal excel 
&gt; cell value to have a value which is nearly the same but not exactly. 
&gt; For e.g., 0.167 to 0.1670000000001. I say occasionally, as this is
</div>
This is standard for all floating number comparisions in all programming
languages &#40;you can google for it&#41;. E.g.:
my $nbr = 1.67/10;

my $nbr2 = .167;

if &#40; $nbr != $nbr2 &#41; {
  print &#34;Not equal\n&#34;;
}

Use sprintf to round to the desired precision.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-962444" href="/Public/Bug/Display.html?id=67807#txn-962444">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;01&nbsp;15:48:37&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-962445" href="/Public/Bug/Display.html?id=67807#txn-962445">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;01&nbsp;15:49:38&nbsp;2011</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/962445/500817/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/500817">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 632b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 01 15:47:17 2011, DOUGW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Apr 27 22:19:07 2011, ETLTCHFIG wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; problem is, occasionally, the conversion translates a decimal excel 
&gt; &gt; cell value to have a value which is nearly the same but not exactly. 
&gt; &gt; For e.g., 0.167 to 0.1670000000001. I say occasionally, as this is
</div>&gt; 
&gt; This is standard for all floating number comparisions in all programming
&gt; languages &#40;you can google for it&#41;. E.g.:
&gt; my $nbr = 1.67/10;
&gt; 
&gt; my $nbr2 = .167;
&gt; 
&gt; if &#40; $nbr != $nbr2 &#41; {
&gt;   print &#34;Not equal\n&#34;;
&gt; }
&gt; 
&gt; Use sprintf to round to the desired precision.
&gt; 
</div>...and then do string comparision with &#39;eq&#39;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-962478" href="/Public/Bug/Display.html?id=67807#txn-962478">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;01&nbsp;17:48:03&nbsp;2011</span>
    <span class="description">leon.panokarren [...] farmersinsurance.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Nagaraj Pithana &lt;nagaraj.pithana [...] farmersinsurance.com&gt;, Shreyas Shah &lt;shreyas.shah [...] farmersinsurance.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #67807] Strange decimal conversion</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 1 Aug 2011 14:46:37 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-XLSX [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Leon Panokarren &lt;leon.panokarren [...] farmersinsurance.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/962478/500841/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/500841">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Doug,

I very much appreciate you getting back! We figured the problem is with 
Excel 2007. The spreadsheet that had the value of 0.167 was create by 
another PERL module &#40;author: John McNamara&#41; that is sent to a Windows box 
through FTP. Once on Windows, the file is opened by a desktop user, 
modified and then sent back to Unix where it is converted back to a series 
of CSVs. We determined that even if the user changes a whole another cell 
&#40;or maybe just add a row&#41;, Excel can randomly distort numbers &#40;like change 
0.167 to 0.16700000000001&#41;. The PERL module to convert excel to csv was 
merely manifesting a symptom of the original problem. I confirmed this by 

1. Saving the Excel coming into Windows as a .zip file
2. Uncompressing it
3. Examining the uncompressed xmls before having the desktop user modify 
the spreadsheet
4. having the desktop user modify the spreadsheet
5. Examining the uncompressed xml again

At this time, we believe this is a MS problem - unless you think 
otherwise, or have a solution for this problem. Let me know what you 
think.

Team,

FYI - See CPAN&#39;s response below

Thanks!

Leon Panokarren
Work: 714 - 385 - 3793
Cell:   732 - 692 - 4110



&#34;Douglas Wilson via RT&#34; &lt;bug-Spreadsheet-XLSX@rt.cpan.org&gt; 
08/01/2011 12:49 PM
Please respond to
bug-Spreadsheet-XLSX@rt.cpan.org


To
leon.panokarren@farmersinsurance.com
cc

Subject
[rt.cpan.org #67807] Strange decimal conversion







&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=67807">https://rt.cpan.org/Ticket/Display.html?id=67807</a></span> &gt;

On Mon Aug 01 15:47:17 2011, DOUGW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Apr 27 22:19:07 2011, ETLTCHFIG wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; problem is, occasionally, the conversion translates a decimal excel 
&gt; &gt; cell value to have a value which is nearly the same but not exactly. 
&gt; &gt; For e.g., 0.167 to 0.1670000000001. I say occasionally, as this is
</div>&gt; 
&gt; This is standard for all floating number comparisions in all programming
&gt; languages &#40;you can google for it&#41;. E.g.:
&gt; my $nbr = 1.67/10;
&gt; 
&gt; my $nbr2 = .167;
&gt; 
&gt; if &#40; $nbr != $nbr2 &#41; {
&gt;   print &#34;Not equal\n&#34;;
&gt; }
&gt; 
&gt; Use sprintf to round to the desired precision.
&gt; 
</div>...and then do string comparision with &#39;eq&#39;
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/962478/500842/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/500842">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.4k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1546846" href="/Public/Bug/Display.html?id=67807#txn-1546846">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;21&nbsp;21:01:32&nbsp;2015</span>
    <span class="description">mikeb [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1546846/825940/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/825940">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 94b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is a known issue with floating point numbers, not an issue specific to Spreadsheet::XLSX.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1546849" href="/Public/Bug/Display.html?id=67807#txn-1546849">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;21&nbsp;21:01:36&nbsp;2015</span>
    <span class="description">mikeb [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.467818</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
