<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #38896 for BerkeleyDB: [PATCH] add support for DB_DBT_MULTIPLE</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #38896 for BerkeleyDB: [PATCH] add support for DB_DBT_MULTIPLE</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/BerkeleyDB/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/BerkeleyDB/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/BerkeleyDB/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/BerkeleyDB/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/BerkeleyDB">BerkeleyDB CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">38896</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/BerkeleyDB/Active/">BerkeleyDB</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
NUFFIN [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-3650-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-3651-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.35    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;01&nbsp;08:00:07&nbsp;2008</span>
    <span class="description">NUFFIN [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] add support for DB_DBT_MULTIPLE</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When associating a secondary database with a primary one, this patch will check if the skey_SV 
is a reference to an array and if so use it to insert multiple keys instead of just one per primary 
entry.

The code path for scalar keys could be unified but IMHO the duplication is easier to read. If you 
prefer I can prepare a patch which unifies the 3 different cases to stringify in one place.

BTW, have you considered using Test::More in the test suite? Twiddling the manual test counts 
is very time consuming.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> bdb_dbt_multiple.patch</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mon Sep  1 14:57:41 IDT 2008  Yuval Kogman &lt;nothingmuch@woobling.org&gt;
  * Support for DB_DBT_MULTIPLE in secondary index callback
diff -rN -Nud old-BerkeleyDB-0.34/BerkeleyDB.xs new-BerkeleyDB-0.34/BerkeleyDB.xs
--- old-BerkeleyDB-0.34/BerkeleyDB.xs	2008-09-01 14:58:15.000000000 +0300
+++ new-BerkeleyDB-0.34/BerkeleyDB.xs	2008-09-01 14:58:15.000000000 +0300
@@ -1224,14 +1224,59 @@
     /* retrieve the secondary key */
     DBT_clear&#40;*skey&#41;;
 
-    skey_ptr = SvPV&#40;skey_SV, skey_len&#41;;
-    skey-&gt;flags = DB_DBT_APPMALLOC;
-    /* skey-&gt;size = SvCUR&#40;skey_SV&#41;; */
-    /* skey-&gt;data = &#40;char*&#41;safemalloc&#40;skey-&gt;size&#41;; */
-    skey-&gt;size = skey_len;
-    skey-&gt;data = &#40;char*&#41;safemalloc&#40;skey_len&#41;;
-    memcpy&#40;skey-&gt;data, skey_ptr, skey_len&#41;;
-    Trace&#40;&#40;&#34;key is %d -- %.*s\n&#34;, skey-&gt;size, skey-&gt;size, skey-&gt;data&#41;&#41;;
+    if &#40; SvROK&#40;skey_SV&#41; &#41; {
+        SV *rv = SvRV&#40;skey_SV&#41;;
+
+        if &#40; SvTYPE&#40;rv&#41; == SVt_PVAV &#41; {
+            AV *av = &#40;AV *&#41;rv;
+            SV **svs = AvARRAY&#40;av&#41;;
+            I32 len = av_len&#40;av&#41; + 1;
+            I32 i;
+            DBT *dbts;
+
+            if &#40; len == 0 &#41; {
+                retval = DB_DONOTINDEX;
+            } else if &#40; len == 1 &#41; {
+                skey_ptr = SvPV&#40;svs[0], skey_len&#41;;
+                skey-&gt;flags = DB_DBT_APPMALLOC;
+                skey-&gt;size = skey_len;
+                skey-&gt;data = &#40;char*&#41;safemalloc&#40;skey_len&#41;;
+                memcpy&#40;skey-&gt;data, skey_ptr, skey_len&#41;;
+                Trace&#40;&#40;&#34;key is %d -- %.*s\n&#34;, skey-&gt;size, skey-&gt;size, skey-&gt;data&#41;&#41;;
+            } else {
+                skey-&gt;flags = DB_DBT_MULTIPLE | DB_DBT_APPMALLOC;
+
+                /* FIXME this will leak if safemalloc fails later... do we care? */
+                Newxz&#40;dbts, len, DBT&#41;;
+
+                skey-&gt;size = len;
+                skey-&gt;data = &#40;char *&#41;dbts;
+
+                for &#40; i = 0; i &lt; skey-&gt;size; i ++ &#41; {
+                    skey_ptr = SvPV&#40;svs[i], skey_len&#41;;
+
+                    dbts[i].flags = DB_DBT_APPMALLOC;
+                    dbts[i].size = skey_len;
+                    dbts[i].data = &#40;char *&#41;safemalloc&#40;skey_len&#41;;
+                    memcpy&#40;dbts[i].data, skey_ptr, skey_len&#41;;
+
+                    Trace&#40;&#40;&#34;key is %d -- %.*s\n&#34;, dbts[i].size, dbts[i].size, dbts[i].data&#41;&#41;;
+                }
+                Trace&#40;&#40;&#34;mkey has %d subkeys\n&#34;, skey-&gt;size&#41;&#41;;
+            }
+        } else {
+            croak&#40;&#34;Not an array reference&#34;&#41;;
+        }
+    } else {
+        skey_ptr = SvPV&#40;skey_SV, skey_len&#41;;
+        skey-&gt;flags = DB_DBT_APPMALLOC;
+        /* skey-&gt;size = SvCUR&#40;skey_SV&#41;; */
+        /* skey-&gt;data = &#40;char*&#41;safemalloc&#40;skey-&gt;size&#41;; */
+        skey-&gt;size = skey_len;
+        skey-&gt;data = &#40;char*&#41;safemalloc&#40;skey_len&#41;;
+        memcpy&#40;skey-&gt;data, skey_ptr, skey_len&#41;;
+        Trace&#40;&#40;&#34;key is %d -- %.*s\n&#34;, skey-&gt;size, skey-&gt;size, skey-&gt;data&#41;&#41;;
+    }
 
     FREETMPS ;
     LEAVE ;
diff -rN -Nud old-BerkeleyDB-0.34/t/db-3.3.t new-BerkeleyDB-0.34/t/db-3.3.t
--- old-BerkeleyDB-0.34/t/db-3.3.t	2008-09-01 14:58:15.000000000 +0300
+++ new-BerkeleyDB-0.34/t/db-3.3.t	2008-09-01 14:58:15.000000000 +0300
@@ -18,7 +18,7 @@
 
 umask&#40;0&#41;;
 
-print &#34;1..130\n&#34;;        
+print &#34;1..175\n&#34;;
 
 {
     # db-&gt;truncate
@@ -170,8 +170,6 @@
 }
 
 
-    # db-&gt;associate -- multiple secondary keys
-
 
     # db-&gt;associate -- same again but when DB_DUP is specified.
 
@@ -474,3 +472,128 @@
     ok 130, countRecords&#40;$primary&#41; == 1 ;
 
 }
+
+{
+    # db-&gt;associate -- multiple secondary keys
+
+    sub sec_key_mult
+    {
+        #print &#34;in sec_key\n&#34;;
+        my $pkey = shift ;
+        my $pdata = shift ;
+
+        $_[0] = [ split &#39;,&#39;, $pdata ] ;
+        return 0;
+    }
+
+    my &#40;$Dfile1, $Dfile2&#41;;
+    my $lex = new LexFile $Dfile1, $Dfile2 ;
+    my %hash ;
+    my $status;
+    my &#40;$k, $v, $pk&#41; = &#40;&#39;&#39;,&#39;&#39;,&#39;&#39;&#41;;
+
+    # create primary database
+    ok 131, my $primary = new BerkeleyDB::Hash -Filename =&gt; $Dfile1,
+				     -Flags    =&gt; DB_CREATE ;
+
+    # create secondary database
+    ok 132, my $secondary = new BerkeleyDB::Hash -Filename =&gt; $Dfile2,
+				     -Flags    =&gt; DB_CREATE ;
+
+    # associate primary with secondary
+    ok 133, $primary-&gt;associate&#40;$secondary, \&#38;sec_key_mult&#41; == 0;
+
+    # add data to the primary
+    my %data =  &#40;
+		&#34;red&#34;	=&gt; &#34;flag&#34;,
+		&#34;green&#34;	=&gt; &#34;house&#34;,
+		&#34;blue&#34;	=&gt; &#34;sea&#34;,
+        &#34;foo&#34;   =&gt; &#34;&#34;,
+        &#34;bar&#34;   =&gt; &#34;hello,goodbye&#34;,
+		&#41; ;
+
+    my $ret = 0 ;
+    while &#40;&#40;$k, $v&#41; = each %data&#41; {
+        my $r = $primary-&gt;db_put&#40;$k, $v&#41; ;
+        $ret += $r;
+    }
+    ok 134, $ret == 0 ;
+
+    # check the records in the secondary
+    ok 135, countRecords&#40;$secondary&#41; == 5 ;
+
+    ok 136, $secondary-&gt;db_get&#40;&#34;house&#34;, $v&#41; == 0;
+    ok 137, $v eq &#34;house&#34;;
+
+    ok 138, $secondary-&gt;db_get&#40;&#34;sea&#34;, $v&#41; == 0;
+    ok 139, $v eq &#34;sea&#34;;
+
+    ok 140, $secondary-&gt;db_get&#40;&#34;flag&#34;, $v&#41; == 0;
+    ok 141, $v eq &#34;flag&#34;;
+
+    ok 142, $secondary-&gt;db_get&#40;&#34;hello&#34;, $v&#41; == 0;
+    ok 143, $v eq &#34;hello,goodbye&#34;;
+
+    ok 144, $secondary-&gt;db_get&#40;&#34;goodbye&#34;, $v&#41; == 0;
+    ok 145, $v eq &#34;hello,goodbye&#34;;
+
+    # pget to primary database is illegal
+    ok 146, $primary-&gt;db_pget&#40;&#39;red&#39;, $pk, $v&#41; != 0 ;
+
+    # pget to secondary database is ok
+    ok 147, $secondary-&gt;db_pget&#40;&#39;house&#39;, $pk, $v&#41; == 0 ;
+    ok 148, $pk eq &#39;green&#39;;
+    ok 149, $v  eq &#39;house&#39;;
+
+    # pget to secondary database is ok
+    ok 150, $secondary-&gt;db_pget&#40;&#39;hello&#39;, $pk, $v&#41; == 0 ;
+    ok 151, $pk eq &#39;bar&#39;;
+    ok 152, $v  eq &#39;hello,goodbye&#39;;
+
+    ok 153, my $p_cursor = $primary-&gt;db_cursor&#40;&#41;;
+    ok 154, my $s_cursor = $secondary-&gt;db_cursor&#40;&#41;;
+
+    # c_get from primary
+    $k = &#39;green&#39;;
+    ok 155, $p_cursor-&gt;c_get&#40;$k, $v, DB_SET&#41; == 0;
+    ok 156, $k eq &#39;green&#39;;
+    ok 157, $v eq &#39;house&#39;;
+
+    # c_get from secondary
+    $k = &#39;sea&#39;;
+    ok 158, $s_cursor-&gt;c_get&#40;$k, $v, DB_SET&#41; == 0;
+    ok 159, $k eq &#39;sea&#39;;
+    ok 160, $v eq &#39;sea&#39;;
+
+    # c_pget from primary database should fail
+    $k = 1;
+    ok 161, $p_cursor-&gt;c_pget&#40;$k, $pk, $v, DB_FIRST&#41; != 0;
+
+    # c_pget from secondary database
+    $k = &#39;flag&#39;;
+    ok 162, $s_cursor-&gt;c_pget&#40;$k, $pk, $v, DB_SET&#41; == 0;
+    ok 163, $k eq &#39;flag&#39;;
+    ok 164, $pk eq &#39;red&#39;;
+    ok 165, $v eq &#39;flag&#39;;
+
+    # check put to secondary is illegal
+    ok 166, $secondary-&gt;db_put&#40;&#34;tom&#34;, &#34;dick&#34;&#41; != 0;
+    ok 167, countRecords&#40;$secondary&#41; == 5 ;
+
+    # delete from primary
+    ok 168, $primary-&gt;db_del&#40;&#34;green&#34;&#41; == 0 ;
+    ok 169, countRecords&#40;$primary&#41; == 4 ;
+
+    # check has been deleted in secondary
+    ok 170, $secondary-&gt;db_get&#40;&#34;house&#34;, $v&#41; != 0;
+    ok 171, countRecords&#40;$secondary&#41; == 4 ;
+
+    # delete from secondary
+    ok 172, $secondary-&gt;db_del&#40;&#39;flag&#39;&#41; == 0 ;
+    ok 173, countRecords&#40;$secondary&#41; == 3 ;
+
+
+    # check deleted from primary
+    ok 174, $primary-&gt;db_get&#40;&#34;red&#34;, $v&#41; != 0;
+    ok 175, countRecords&#40;$primary&#41; == 3 ;
+}

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;14&nbsp;04:40:07&nbsp;2008</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Sep 01 08:00:07 2008, NUFFIN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When associating a secondary database with a primary one, this patch
&gt; will check if the skey_SV
&gt; is a reference to an array and if so use it to insert multiple keys
&gt; instead of just one per primary
&gt; entry.
&gt; 
&gt; The code path for scalar keys could be unified but IMHO the
&gt; duplication is easier to read. If you
&gt; prefer I can prepare a patch which unifies the 3 different cases to
&gt; stringify in one place.
</div>
The patch looks fine as it is. Interestingly this is the second patch
I&#39;ve received that implements DB_DBT_MULTIPLE. Of the two I prefer
your&#39;s. You have checked all the edge cases, like the array reference
being empty, and it it only containing one element.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; BTW, have you considered using Test::More in the test suite? Twiddling
&gt; the manual test counts
&gt; is very time consuming.
</div>
Yes, I have. BerkeleyDB is one of the few modules of mine that doesn&#39;t
use Test::More. Been on my list of things to sort out for ages now :-&#41;

Thanks for the patch and sorry for the delay in getting back to you.

cheers
Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;14&nbsp;04:40:09&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;14&nbsp;11:55:22&nbsp;2008</span>
    <span class="description">NUFFIN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Sep 14 04:40:07 2008, PMQS wrote: 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The patch looks fine as it is. Interestingly this is the second patch
&gt; I&#39;ve received that implements DB_DBT_MULTIPLE. Of the two I prefer
&gt; your&#39;s. You have checked all the edge cases, like the array reference
&gt; being empty, and it it only containing one element.
</div>
I looked at the TCL bindings to figure out how it should be done, so I blame them for any bugs 
it may have ;-&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yes, I have. BerkeleyDB is one of the few modules of mine that doesn&#39;t
&gt; use Test::More. Been on my list of things to sort out for ages now :-&#41;
</div>
I might have a few more patches coming soon, will it be OK to submit them with Test::More 
based tests + patches to convert the existing tests?
Cheers
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;14&nbsp;12:34:04&nbsp;2008</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; Yes, I have. BerkeleyDB is one of the few modules of mine that
</div>&gt; doesn&#39;t
<div class="message-stanza open">&gt; &gt; use Test::More. Been on my list of things to sort out for ages now
</div>&gt; :-&#41;
&gt; 
&gt; I might have a few more patches coming soon, will it be OK to submit
&gt; them with Test::More
&gt; based tests + patches to convert the existing tests?
</div>
I forgot that I had already partially converted the tests to use
Test::More, so I&#39;ve just finished the conversion off. That should make
your life easier if you want to supply patches.

I&#39;ll upload to CPAN later today or tomorrow sometime. The other new
functionality included is support for sequences.

Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;29&nbsp;06:37:06&nbsp;2008</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;29&nbsp;06:37:06&nbsp;2008</span>
    <span class="description">pmqs [...] cpan.org -  Fixed in 0.35 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
