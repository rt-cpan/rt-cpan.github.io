<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #13043 for Net_SSLeay.pm: net::ssleay::handle don&#39;t get destroyed properly</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #13043 for Net_SSLeay.pm: net::ssleay::handle don&#39;t get destroyed properly</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net_SSLeay.pm/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net_SSLeay.pm/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net_SSLeay.pm/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net_SSLeay.pm/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net_SSLeay.pm">Net_SSLeay.pm CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">13043</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net_SSLeay.pm/Active/">Net_SSLeay.pm</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">rafl [...] debian.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mrdamnfrenchy [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-23580-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.25    </td>
  </tr>
  <tr id="CF-23581-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;31&nbsp;16:44:26&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> net::ssleay::handle don&#39;t get destroyed properly</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Using POE, which uses Net::SSLeay::Handle for HTTPS request, I noticed that long running processes had way too many file descriptors open.

A bit of investigation later, it turns out that Net::SSLeay::Handle creates circular references to its handles, so a handle that goes out of scope is still stored by the module, which means that unless it was explicitely closed, the socket would stay open.

So, long story short, here&#39;s a patch to fix this. It also fixes the problem mentioned in bug 3920.

The old version used to tie the socket itself, and use the socket&#39;s fileno to lookup the object. I modified it to tie the object directly, hence I don&#39;t need a lookup table...

-Mathieu
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;31&nbsp;16:46:05&nbsp;2005</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> mrdamnfrenchy [...] yahoo.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here&#39;s a test that shows whether file descriptors are retained, and 
when the SSL handles are destroyed. Should be after use, not at the 
end of the test.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"># This test came about when I found out that Poco::Client::HTTP does not
# release file descriptors after an HTTPS fetch.
#
# So to test this, I measure the numbers of open file descriptors when
# starting, and then fetch a URL a number of times. The test passes if the
# number of FDs is the same after all the fetches are done. As a double check,
# I also measure the number of fds opened before starting the kernel, and when
# its done.
#
# You can configure which URLs to fetch, but I just picked one http and one
# https that prove the point.
#
# TODO: Replace the sub &#34;count_fds&#34; with a more platform neutral version. Right
# now, this function only works on platform with the /proc file system.

# Runtime config
our $debuglevel = 2; # 0 none, 1 info, 2 debug

my @urls = &#40; &#34;www.bacus.pt&#34;, &#34;chase.com&#34; &#41;;

#Net::SSLeay::Handle-&gt;debug&#40;100&#41;;
# End of config

use strict;
use warnings;

use Net::SSLeay::Handle qw/shutdown/;
use Symbol qw&#40;gensym&#41;;


use Test::More;

plan tests =&gt; 1+@urls;


sub DEBUG&#40;@&#41; { $debuglevel &gt;= 2 &#38;&#38; print STDERR @_,&#34;\n&#34;; }
sub INFO&#40;@&#41; { $debuglevel &gt;= 1 &#38;&#38; print STDERR @_,&#34;\n&#34;; }

sub Net::SSLeay::Handle::DESTROY { warn &#34;Handle $_[0] being destroyed.\n&#34;; }
sub Net::SSLeay::Handle::UNTIE { warn &#34;Handle $_[0] is untied.\n&#34;; }

my $orig_fdcount = count_fds&#40;&#41;;
DEBUG &#34;Orig fdcound: $orig_fdcount.&#34;;

for my $url &#40; @urls &#41; {
    DEBUG &#34;Getting &#39;$url&#39;.&#34;;
    
    { 
	my &#40;$host, $port&#41; = &#40;$url, 443&#41;;
	my $ssl = gensym&#40;&#41;;
	tie&#40;*$ssl, &#34;Net::SSLeay::Handle&#34;, $host, $port&#41;;
	print $ssl &#34;GET / HTTP/1.0\r\n\r\n&#34;;
	shutdown&#40;$ssl,1&#41;;
    
	my @response = &lt;$ssl&gt;;
	#while &#40;&lt;$ssl&gt;&#41; { push @response, $_; }
	my $total_length = length&#40;join&#40;&#39;&#39;,@response&#41;&#41;;
	DEBUG shift @response;
	DEBUG &#34;Total reponse length: $total_length.&#34;;
	#DEBUG &#34;Response: &#34;.join&#40;&#39;&#39;,@response&#41;;
	#close $ssl;
    }

    # Handle should have been garbage collected
    my $newfdcount = count_fds&#40;&#41;;
    is&#40;$newfdcount, $orig_fdcount, &#34;As many file descriptors as we started with.&#34;&#41;;
}


my $newfdcount = count_fds&#40;&#41;;
is&#40;$newfdcount, $orig_fdcount, &#34;Final: As many file descriptors as we started with.&#34;&#41;;
DEBUG &#34;fdcount: $orig_fdcount/$newfdcount.&#34;;

exit 0;

sub count_fds {
    use File::Spec;
    my $fdpath = File::Spec-&gt;devnull&#40;&#41;;
    open&#40;F, $fdpath&#41; or die &#34;Can&#39;t open &#39;$fdpath&#39;: $!\n&#34;;
    my $count = fileno&#40;F&#41;;
    close&#40;F&#41;;
    return $count;
}



</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;31&nbsp;16:48:17&nbsp;2005</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> mrdamnfrenchy [...] yahoo.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">apparently, the patch did not upload, here it is.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Handle.pm	2003-08-17 03:13:00.000000000 -0400
+++ ..\..\lib\Net\SSLeay\Handle.pm	2005-05-31 16:29:35.277905000 -0400
@@ -24,7 +24,6 @@
 #==============================================================================
 
 my $Initialized;       #-- only _initialize&#40;&#41; once
-my %Filenum_Object;    #-- hash of hashes, keyed by fileno&#40;&#41;
 my $Debug = 0;         #-- pretty hokey
 my %Glob_Ref;          #-- used to make unique \*S names for versions &lt; 5.6
 
@@ -53,20 +52,20 @@
 
     $Debug and print &#34;Cipher &#39;&#34; . Net::SSLeay::get_cipher&#40;$ssl&#41; . &#34;&#39;\n&#34;;
 
-    $Filenum_Object{$fileno} = {
+    my $self = bless {
         ssl    =&gt; $ssl, 
         ctx    =&gt; $ctx,
         socket =&gt; $socket,
         fileno =&gt; $fileno,
-    };
+    }, $class;
 
-    return bless $socket, $class;
+    return $self;
 }
 
 sub PRINT {
-    my $socket = shift;
+    my $self = shift;
 
-    my $ssl  = _get_ssl&#40;$socket&#41;;
+    my $ssl  = _get_ssl&#40;$self&#41;;
     my $resp = 0;
     for my $msg &#40;@_&#41; {
         defined $msg or last;
@@ -76,15 +75,23 @@
 }
 
 sub READLINE {
-    my $socket = shift;
-    my $ssl  = _get_ssl&#40;$socket&#41;;
-    my $line = Net::SSLeay::ssl_read_until&#40;$ssl&#41;; 
-    return $line ? $line : undef;
+    my $self = shift;
+    my $ssl  = _get_ssl&#40;$self&#41;;
+    if &#40; wantarray &#41; {
+        my @lines;
+        while &#40; my $line = Net::SSLeay::ssl_read_until&#40;$ssl&#41; &#41; {
+            push @lines, $line;
+        }
+        return @lines;
+    } else {
+        my $line = Net::SSLeay::ssl_read_until&#40;$ssl&#41;; 
+        return $line ? $line : undef;
+    }
 }
 
 sub READ {
-    my &#40;$socket, $buf, $len, $offset&#41; = \ &#40;@_&#41;;
-    my $ssl = _get_ssl&#40;$$socket&#41;;
+    my &#40;$self, $buf, $len, $offset&#41; = \ &#40;@_&#41;;
+    my $ssl = _get_ssl&#40;$self&#41;;
     defined&#40;$$offset&#41; or 
       return length&#40;$$buf = Net::SSLeay::ssl_read_all&#40;$ssl, $$len&#41;&#41;;
 
@@ -98,28 +105,27 @@
 }
 
 sub WRITE {
-    my $socket = shift;
+    my $self = shift;
     my &#40;$buf, $len, $offset&#41; = @_;
     $offset = 0 unless defined $offset;
 
     # Return number of characters written.
-    my $ssl  = $socket-&gt;_get_ssl&#40;&#41;;
+    my $ssl  = $self-&gt;_get_ssl&#40;&#41;;
     return $len if Net::SSLeay::write&#40;$ssl, substr&#40;$buf, $offset, $len&#41;&#41;;
     return undef;
 }
 
 sub CLOSE {
-    my $socket = shift;
-    my $fileno = fileno&#40;$socket&#41;;
+    my $self = shift;
+    my $fileno = fileno&#40;$self-&gt;{socket}&#41;;
     $Debug &gt; 10 and print &#34;close&#40;$fileno&#41;\n&#34;;
-    my $self = $socket-&gt;_get_self&#40;&#41;;
-    delete $Filenum_Object{$fileno};
+
   Net::SSLeay::free &#40;$self-&gt;{ssl}&#41;;
   Net::SSLeay::CTX_free &#40;$self-&gt;{ctx}&#41;;
-    close $socket;
+    close $self-&gt;{socket};
 }
 
-sub FILENO  { fileno&#40;$_[0]&#41; }
+sub FILENO  { fileno&#40;$_[0]-&gt;{socket}&#41; }
 
 
 #== Exportable Functions  =====================================================
@@ -133,10 +139,10 @@
 #------------------------------------------------------------------------------
 
 sub shutdown {
-    my &#40;$socket, @params&#41; = @_;
+    my &#40;$obj, @params&#41; = @_;
 
-    my $obj = _get_self&#40;$socket&#41;;
-    $obj and $socket = $obj-&gt;{socket};
+    #my $obj = _get_self&#40;$socket&#41;;
+    my $socket = UNIVERSAL::isa&#40;$obj,&#34;Net::SSLeay::Handle&#34;&#41; ? $obj-&gt;{socket} : $obj;
     return shutdown&#40;$socket, @params&#41;;
 }
 
@@ -162,7 +168,7 @@
 
     my $dest_ip     = gethostbyname&#40; $phost || $host&#41;;
     my $host_params = sockaddr_in&#40;$pport, $dest_ip&#41;;
-    my $socket = $^V ? $class-&gt;_glob_ref&#40;&#34;$host:$port&#34;&#41; : undef;
+    my $socket = $^V ? undef : $class-&gt;_glob_ref&#40;&#34;$host:$port&#34;&#41;;
     
     socket&#40;$socket, &#38;PF_INET&#40;&#41;, &#38;SOCK_STREAM&#40;&#41;, 0&#41; or die &#34;socket: $!&#34;;
     connect&#40;$socket, $host_params&#41;                 or die &#34;connect: $!&#34;;
@@ -222,7 +228,7 @@
 #------------------------------------------------------------------------------
 
 sub _get_self {
-    return $Filenum_Object{fileno&#40;shift&#41;};
+    return shift;
 }
 
 #--- _get_ssl&#40;$socket&#41; --------------------------------------------------------
@@ -232,8 +238,7 @@
 #------------------------------------------------------------------------------
 
 sub _get_ssl {
-    my $socket = shift;
-    return $Filenum_Object{fileno&#40;$socket&#41;}-&gt;{ssl};
+    return $_[0]-&gt;{ssl};
 }
 
 1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;21&nbsp;07:05:17&nbsp;2006</span>
    <span class="description">rafl [...] debian.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;21&nbsp;07:05:43&nbsp;2006</span>
    <span class="description">rafl [...] debian.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;21&nbsp;07:08:24&nbsp;2006</span>
    <span class="description">rafl [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue May 31 16:44:26 2005, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Using POE, which uses Net::SSLeay::Handle for HTTPS request, I noticed
&gt;    that long running processes had way too many file descriptors open.
&gt; 
&gt; A bit of investigation later, it turns out that Net::SSLeay::Handle
&gt;    creates circular references to its handles, so a handle that goes
&gt;    out of scope is still stored by the module, which means that unless
&gt;    it was explicitely closed, the socket would stay open.
&gt; 
&gt; So, long story short, here&#39;s a patch to fix this. It also fixes the
&gt;    problem mentioned in bug 3920.
&gt; 
&gt; The old version used to tie the socket itself, and use the socket&#39;s
&gt;    fileno to lookup the object. I modified it to tie the object
&gt;    directly, hence I don&#39;t need a lookup table...
&gt; 
&gt; -Mathieu
</div>
Thanks for your report. I fixed the problem in SVN and it will be part
of the upcoming release.

I pretty much applied your patch with the exception of some minor things
and the fact that I didn&#39;t modify the behaviour of READLINE. I generally
think it&#39;s a good idea, but I fear breaking backwards compatibility. Are
you aware of any piece of software that uses Net::SSLeay::Handle and
relies on the fact that READLINE only returns a single line, even in
list context?

Regards,
Flo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;21&nbsp;16:54:54&nbsp;2006</span>
    <span class="description">mrdamnfrenchy [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13043] net::ssleay::handle don&#39;t get destroyed properly </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 21 Jan 2006 13:54:07 -0800 &#40;PST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net_SSLeay.pm [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mathieu Longtin &lt;mrdamnfrenchy [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">No. I use it has part of POE::Component::HTTP::Client and
LWP::Get. If those were working before, lets leave them as
that.

OTOH, I&#39;ve been using the fixed version of
Net::SSLeay::Handle since I posted that bug, and those two
modules have been working fine.

-Mathieu

--- Florian Ragwitz via RT &lt;bug-Net_SSLeay.pm@rt.cpan.org&gt;
wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for your report. I fixed the problem in SVN and it
&gt; will be part of the upcoming release.
&gt; 
&gt; I pretty much applied your patch with the exception of
&gt; some minor things and the fact that I didn&#39;t modify the 
&gt; behaviour of READLINE. I generally think it&#39;s a good
</div>idea, 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; but I fear breaking backwards compatibility. Are you 
&gt; aware of any piece of software that uses
&gt; Net::SSLeay::Handle and relies on the fact that READLINE 
&gt; only returns a single line, even in list context?
&gt; 
&gt; Regards,
&gt; Flo
</div>


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
<span class="clickylink"><a target="new" rel="nofollow" href="http://mail.yahoo.com">http://mail.yahoo.com</a></span> 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;21&nbsp;18:53:09&nbsp;2006</span>
    <span class="description">rafl [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> net-ssleay-devel [...] lists.alioth.debian.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13043] net::ssleay::handle don&#39;t get destroyed properly</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 22 Jan 2006 01:29:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;mrdamnfrenchy [...] yahoo.com via RT&#34; &lt;bug-Net_SSLeay.pm [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Florian Ragwitz &lt;rafl [...] debian.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, Jan 21, 2006 at 04:54:54PM -0500, mrdamnfrenchy@yahoo.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; No. I use it has part of POE::Component::HTTP::Client and
&gt; LWP::Get. If those were working before, lets leave them as
&gt; that.
&gt; 
&gt; OTOH, I&#39;ve been using the fixed version of
&gt; Net::SSLeay::Handle since I posted that bug, and those two
&gt; modules have been working fine.
&gt; 
</div>
OK, I think I&#39;ll change the behaviour then and leave a note in the
README or the changelog. Your patch will be part of the next release.

Thank you very much.

-Flo

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; --- Florian Ragwitz via RT &lt;bug-Net_SSLeay.pm@rt.cpan.org&gt;
&gt; wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; Thanks for your report. I fixed the problem in SVN and it
&gt; &gt; will be part of the upcoming release.
&gt; &gt; 
&gt; &gt; I pretty much applied your patch with the exception of
&gt; &gt; some minor things and the fact that I didn&#39;t modify the 
&gt; &gt; behaviour of READLINE. I generally think it&#39;s a good
</div>&gt; idea, 
<div class="message-stanza open">&gt; &gt; but I fear breaking backwards compatibility. Are you 
&gt; &gt; aware of any piece of software that uses
&gt; &gt; Net::SSLeay::Handle and relies on the fact that READLINE 
&gt; &gt; only returns a single line, even in list context?
</div></div></div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;21&nbsp;18:58:14&nbsp;2006</span>
    <span class="description">rafl [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> net-ssleay-devel [...] lists.alioth.debian.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Your changes were slightly modified, applied to svn trunk and will be
part of the next release. Therefor I&#39;m closing this bug now.

Thanks,
Flo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;21&nbsp;18:58:15&nbsp;2006</span>
    <span class="description">rafl [...] debian.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
