<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #60189 for Net-OAuth: Bug 60154: Repeated parameters incorrectly handled - patch and test cases</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #60189 for Net-OAuth: Bug 60154: Repeated parameters incorrectly handled - patch and test cases</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-OAuth/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-OAuth/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-OAuth/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-OAuth/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-OAuth">Net-OAuth CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">60189</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-OAuth/Active/">Net-OAuth</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
alasdair.mcintyre [...] lovefilm.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-45572-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-45573-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;09&nbsp;10:03:41&nbsp;2010</span>
    <span class="description">alasdair.mcintyre [...] lovefilm.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug 60154: Repeated parameters incorrectly handled - patch and test cases</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 9 Aug 2010 15:03:14 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Net-OAuth [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Alasdair McIntyre&#34; &lt;alasdair.mcintyre [...] lovefilm.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please find below a patch against Net-OAuth-0.27 in unified diff format,
including test cases.


--- lib/Net/OAuth.old.pm        2010-08-09 12:43:51.000000000 +0100
+++ lib/Net/OAuth.pm    2010-08-09 12:43:17.000000000 +0100
@@ -243,7 +243,9 @@
 
 =head2 API PARAMETERS vs MESSAGE PARAMETERS
 
-Net::OAuth defines &#39;message parameters&#39; as parameters that are part of
the transmitted OAuth message.  These include any protocol parameter
&#40;prefixed with &#39;oauth_&#39; in the message&#41;, and any additional message
parameters &#40;the extra_params hash&#41;.
+Net::OAuth defines &#39;message parameters&#39; as parameters that are part of
the transmitted OAuth message.  These include any protocol parameter
&#40;prefixed with &#39;oauth_&#39; in the message&#41;, and any additional message
parameters &#40;the extra_params hash&#41;. Multiple values can be specified for
the same message parameter by supplying an arrayref of values in the
extra_params hash. E.g. foo=1&#38;bar=2&#38;bar=3 would be specified as:
+
+ extra_params =&gt; { foo =&gt; 1, bar =&gt; [ 2, 3 ] }
 
 &#39;API parameters&#39; are parameters required to build a message object that
are not transmitted with the message, e.g. consumer_secret,
token_secret, request_url, request_method.
 
@@ -280,7 +282,7 @@
 
 =head2 THE REQUEST_URL PARAMETER
 
-Any query parameters in the request_url are removed and added to the
extra_params hash when generating the signature.
+Any query parameters in the request_url are removed and added to the
extra_params hash when generating the signature. &#40;Note: if the same
parameter name appears multiple times, all the values will be
accumulated into an arrayref, instead of a simple scalar&#41;.
 
 E.g. the following requests are pretty much equivalent:
 
--- lib/Net/OAuth/Message.old.pm        2010-06-16 21:46:47.000000000
+0100
+++ lib/Net/OAuth/Message.pm    2010-08-09 14:43:15.000000000 +0100
@@ -123,30 +123,61 @@
     my %opts = @_;
     $opts{quote} = &#34;&#34; unless defined $opts{quote};
     $opts{params} ||= [];
-    my %params;
-    foreach my $k &#40;@{$self-&gt;required_message_params},
@{$self-&gt;optional_message_params}, @{$opts{add}}&#41; {
+
+# CHANGED   - collect params into an array, as extra_params may now
specify multiple values
+#           - using an arrayref, e.g. extra_params =&gt; { x =&gt; 1, y =&gt; 2,
z =&gt; [ 3, 4, 5 ] }
+#   my %params;
+    my @params;
+
+# CHANGED   - deduplicate parameter names &#40;in particular this ensures
that &#39;signature&#39; is not processed twice&#41;
+#   foreach my $k &#40;@{$self-&gt;required_message_params},
@{$self-&gt;optional_message_params}, @{$opts{add}}&#41; {
+    my %want = map {$_=&gt;1} @{$self-&gt;required_message_params},
@{$self-&gt;optional_message_params}, @{$opts{add}};
+    foreach my $k &#40;keys %want&#41; {
+
         next if $k eq &#39;signature&#39; and &#40;!$self-&gt;sign_message or !grep
&#40;$_ eq &#39;signature&#39;, @{$opts{add}}&#41;&#41;;
         my $message_key = $self-&gt;is_extension_param&#40;$k&#41; ? $k :
OAUTH_PREFIX . $k;
         my $v = $self-&gt;$k;
-        $params{$message_key} = $v if defined $v;
+
+# CHANGED   - we&#39;re now collecting into an array
+#       $params{$message_key} = $v if defined $v;
+        push @params, $message_key =&gt; $v if defined $v;
+
     }
     if &#40;$self-&gt;{extra_params} and !$opts{no_extra} and
$self-&gt;allow_extra_params&#41; {
-        foreach my $k &#40;keys %{$self-&gt;{extra_params}}&#41; {
-            $params{$k} = $self-&gt;{extra_params}{$k};
+
+# CHANGED   - collecting into an array
+#       foreach my $k &#40;keys %{$self-&gt;{extra_params}}&#41; {
+#           $params{$k} = $self-&gt;{extra_params}{$k};
+#       }
+        while&#40;my &#40;$k, $v&#41; = each %{$self-&gt;{extra_params}}&#41; {
+            push @params, $k =&gt; $_ foreach ref $v ? @$v : &#40;$v&#41;;
         }
+
         if &#40;$self-&gt;can&#40;&#39;request_url&#39;&#41;&#41; {
             my $url = $self-&gt;request_url;
             _ensure_uri_object&#40;$url&#41;;         
             foreach my $k &#40;$url-&gt;query_param&#41; {
-                $params{$k} = $url-&gt;query_param&#40;$k&#41;;
+
+# CHANGED   - collecting into an array
+#               $params{$k} = $url-&gt;query_param&#40;$k&#41;;
+                push @params, $k =&gt; $_ foreach $url-&gt;query_param&#40;$k&#41;;
+
             }
         }
     }
-    if &#40;$opts{hash}&#41; {
-        return \%params;
+    if &#40;$opts{array}&#41; {
+
+# CHANGED   - we&#39;re now returning an arrayref
+#       return \%params;
+        return \@params;
+
     }
     my @pairs;
-    while &#40;my &#40;$k,$v&#41; = each %params&#41; {
+
+# CHANGED   - we now need to iterate key/values from an array instead
+#   while &#40;my &#40;$k,$v&#41; = each %params&#41; {
+    while &#40;my &#40;$k,$v&#41; = splice&#40;@params, 0, 2&#41;&#41; {
+
         push @pairs, join&#40;&#39;=&#39;, encode&#40;$k&#41;, $opts{quote} . encode&#40;$v&#41; .
$opts{quote}&#41;;
     }
     return sort&#40;@pairs&#41;;
@@ -196,6 +227,21 @@
         join&#40;$sep, $self-&gt;gather_message_parameters&#40;quote =&gt; &#39;&#34;&#39;, add
=&gt; [qw/signature/], no_extra =&gt; 1&#41;&#41;;
 }
 
+# ADDED     - when repeated values for the same param appear,
accumulate them
+#           - into an arrayref, instead of overwriting the same scalar
+sub _accumulate {
+    my &#40;$hash, $k, $v&#41; = @_;
+    foreach&#40;ref $v eq &#39;ARRAY&#39; ? @$v : &#40;$v&#41;&#41; {
+        if &#40;exists $hash-&gt;{$k}&#41; {
+            $hash-&gt;{$k} = [ $hash-&gt;{$k} ] unless ref $hash-&gt;{$k} eq
&#39;ARRAY&#39;;
+            push @{ $hash-&gt;{$k} }, $_;
+        }
+        else {
+            $hash-&gt;{$k} = $_;
+        }
+    }
+}
+
 sub from_authorization_header {
     my $proto = shift;
     my $header = shift;
@@ -218,7 +264,11 @@
         if &#40;defined $k and defined $v&#41; {
             $v =~ s/&#40;^&#34;|&#34;$&#41;//g;
             &#40;$k,$v&#41; = map decode&#40;$_&#41;, $k, $v;
-            $params{$k} = $v;
+
+# CHANGED   - allow for repeated parameters
+#           $params{$k} = $v;
+            _accumulate&#40;\%params, $k, $v&#41;;
+
         }
     }
     return $class-&gt;from_hash&#40;\%params, @_&#41;;
@@ -255,7 +305,11 @@
             }
         }
         else {
-            $msg_params{extra_params}-&gt;{$k} = $hash-&gt;{$k};
+
+# CHANGED   - allow for repeated parameters
+#           $msg_params{extra_params}-&gt;{$k} = $hash-&gt;{$k};
+            _accumulate&#40;\%{ $msg_params{extra_params} }, $k,
$hash-&gt;{$k}&#41;;
+
         }
     }
     $api_params{from_hash} = 1;
@@ -288,7 +342,14 @@
 
 sub to_hash {
     my $self = shift;
-    return $self-&gt;gather_message_parameters&#40;hash =&gt; 1, add =&gt;
[qw/signature/]&#41;;
+# CHANGED   - all for repeated parameters
+#   return $self-&gt;gather_message_parameters&#40;hash =&gt; 1, add =&gt;
[qw/signature/]&#41;;
+    my @params = @{ $self-&gt;gather_message_parameters&#40;array =&gt; 1, add =&gt;
[qw/signature/]&#41; };
+    my %params;
+    while&#40;my &#40;$k, $v&#41; = splice&#40;@params, 0, 2&#41;&#41; {
+        _accumulate&#40;\%params, $k, $v&#41;;
+    }
+    return \%params;
 }
 
 sub to_url {
@@ -301,13 +362,18 @@
         _ensure_uri_object&#40;$url&#41;;
         $url = $url-&gt;clone; # don&#39;t modify the URL that was passed in
         $url-&gt;query&#40;undef&#41;; # remove any existing query params, as
these may cause the signature to break  
-               my $params = $self-&gt;to_hash;
-               my $sep = &#39;?&#39;;
-               foreach my $k &#40;sort keys %$params&#41; {
-                   $url .= $sep . encode&#40;$k&#41; . &#39;=&#39; . encode&#40;
$params-&gt;{$k} &#41;;
-            $sep = &#39;&#38;&#39; if $sep eq &#39;?&#39;;
-               }
-               return $url;
+
+# CHANGED - gather_message_parameters does what we need, and copes with
repeated params, so let&#39;s reuse it...
+#      my $params = $self-&gt;to_hash;
+#      my $sep = &#39;?&#39;;
+#      foreach my $k &#40;sort keys %$params&#41; {
+#          $url .= $sep . encode&#40;$k&#41; . &#39;=&#39; . encode&#40; $params-&gt;{$k} &#41;;
+#           $sep = &#39;&#38;&#39; if $sep eq &#39;?&#39;;
+#      }
+        my $query_string = join &#39;&#38;&#39;,
$self-&gt;gather_message_parameters&#40;add =&gt; [qw/signature/]&#41;;
+               $url .= &#39;?&#39; . $query_string if $query_string ne &#39;&#39;;
+
+        return $url;
        }
        else {
                return $self-&gt;to_post_body;
--- t/10-misc.old.t     2010-08-09 12:53:15.000000000 +0100
+++ t/10-misc.t 2010-08-09 14:51:05.000000000 +0100
@@ -1,6 +1,6 @@
 use strict;
 use warnings;
-use Test::More tests =&gt; 5;
+use Test::More tests =&gt; 9;
 
 BEGIN {
     use Net::OAuth;
@@ -58,3 +58,56 @@
 ok&#40;$request-&gt;verify&#41;;
 
 
+# <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60154">https://rt.cpan.org/Ticket/Display.html?id=60154</a></span>
+# Make sure repeated parameters are handled correctly
+$request = Net::OAuth-&gt;request&#40;&#34;consumer&#34;&#41;-&gt;new&#40;
+    consumer_key =&gt; &#39;dpf43f3p2l4k3l03&#39;,
+    consumer_secret =&gt; &#39;kd94hf93k423kf44&#39;,
+    request_url =&gt; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://photos.example.net/example?xyz=1&#38;xyz=2&#39;">https://photos.example.net/example?xyz=1&#38;xyz=2&#39;</a></span>,
+    request_method =&gt; &#39;GET&#39;,
+    signature_method =&gt; &#39;HMAC-SHA1&#39;,
+    timestamp =&gt; &#39;1191242090&#39;,
+    nonce =&gt; &#39;hsu94j3884jdopsl&#39;,
+&#41;;
+
+$request-&gt;sign;
+
+is&#40;$request-&gt;to_url&#40;&#41;,
&#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://photos.example.net/example?oauth_consumer_key=dpf43f3p2l4k3l03&#38;">https://photos.example.net/example?oauth_consumer_key=dpf43f3p2l4k3l03&#38;</a></span>
oauth_nonce=hsu94j3884jdopsl&#38;oauth_signature=6Z2WZLQCgFW2jFgl3ROTR9LFFxc
%3D&#38;oauth_signature_method=HMAC-SHA1&#38;oauth_timestamp=1191242090&#38;oauth_ve
rsion=1.0&#38;xyz=1&#38;xyz=2&#39;&#41;;
+
+
+$request = Net::OAuth-&gt;request&#40;&#34;consumer&#34;&#41;-&gt;new&#40;
+    consumer_key =&gt; &#39;dpf43f3p2l4k3l03&#39;,
+    consumer_secret =&gt; &#39;kd94hf93k423kf44&#39;,
+    request_url =&gt; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://photos.example.net/example&#39;">https://photos.example.net/example&#39;</a></span>,
+    request_method =&gt; &#39;GET&#39;,
+    signature_method =&gt; &#39;HMAC-SHA1&#39;,
+    timestamp =&gt; &#39;1191242090&#39;,
+    nonce =&gt; &#39;hsu94j3884jdopsl&#39;,
+    extra_params =&gt; { xyz =&gt; [1, 2] },
+&#41;;
+
+$request-&gt;sign;
+
+is&#40;$request-&gt;to_url&#40;&#41;,
&#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://photos.example.net/example?oauth_consumer_key=dpf43f3p2l4k3l03&#38;">https://photos.example.net/example?oauth_consumer_key=dpf43f3p2l4k3l03&#38;</a></span>
oauth_nonce=hsu94j3884jdopsl&#38;oauth_signature=6Z2WZLQCgFW2jFgl3ROTR9LFFxc
%3D&#38;oauth_signature_method=HMAC-SHA1&#38;oauth_timestamp=1191242090&#38;oauth_ve
rsion=1.0&#38;xyz=1&#38;xyz=2&#39;&#41;;
+
+
+$request = Net::OAuth-&gt;request&#40;&#34;consumer&#34;&#41;-&gt;from_url&#40;
+
&#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://photos.example.net/example?oauth_consumer_key=dpf43f3p2l4k3l03&#38;">https://photos.example.net/example?oauth_consumer_key=dpf43f3p2l4k3l03&#38;</a></span>
oauth_nonce=hsu94j3884jdopsl&#38;oauth_signature=6Z2WZLQCgFW2jFgl3ROTR9LFFxc
%3D&#38;oauth_signature_method=HMAC-SHA1&#38;oauth_timestamp=1191242090&#38;oauth_ve
rsion=1.0&#38;xyz=1&#38;xyz=2&#39;,
+    consumer_secret =&gt; &#39;kd94hf93k423kf44&#39;,
+    request_url =&gt; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://photos.example.net/example&#39;">https://photos.example.net/example&#39;</a></span>,
+    request_method =&gt; &#39;GET&#39;,
+&#41;;
+
+ok&#40;$request-&gt;verify&#41;;
+
+
+$request = Net::OAuth-&gt;request&#40;&#34;consumer&#34;&#41;-&gt;from_post_body&#40;
+
&#39;oauth_consumer_key=dpf43f3p2l4k3l03&#38;oauth_nonce=hsu94j3884jdopsl&#38;oauth_
signature=HlCKYbZJCoXRL4G2Qm4sIfI6wK8%3D&#38;oauth_signature_method=HMAC-SHA
1&#38;oauth_timestamp=1191242090&#38;oauth_version=1.0&#38;xyz=1&#38;xyz=2&#39;,
+    consumer_secret =&gt; &#39;kd94hf93k423kf44&#39;,
+    request_url =&gt; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://photos.example.net/example&#39;">https://photos.example.net/example&#39;</a></span>,
+    request_method =&gt; &#39;POST&#39;,
+&#41;;
+
+ok&#40;$request-&gt;verify&#41;;
+
+

-----------------------------------------------------------------------------------------------------------------------------------------
LOVEFiLM UK Limited is a company registered in England and Wales. 
Registered Number: 06528297. 
Registered Office: No.9, 6 Portal Way, London W3 6RU, United Kingdom.

This e-mail is confidential to the ordinary user of the e-mail address to which it was addressed. If you have received it in error, 
please delete it from your system and notify the sender immediately.

This email message has been delivered safely and archived online by Mimecast.
For more information please visit <span class="clickylink"><a target="new" rel="nofollow" href="http://www.mimecast.co.uk">http://www.mimecast.co.uk</a></span> 
-----------------------------------------------------------------------------------------------------------------------------------------
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
