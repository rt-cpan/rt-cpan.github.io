<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #85919 for DBD-mysql: [PATCH] fetch*&#40;&#41; on lost connection wrongly reports &#34;fetch&#40;&#41; without execute&#40;&#41;&#34; instead of &#34;Lost connection to MySQL server during query&#34;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #85919 for DBD-mysql: [PATCH] fetch*&#40;&#41; on lost connection wrongly reports &#34;fetch&#40;&#41; without execute&#40;&#41;&#34; instead of &#34;Lost connection to MySQL server during query&#34;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-mysql">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-mysql">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-mysql">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-mysql">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-mysql">DBD-mysql CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">85919</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-mysql">DBD-mysql</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MICHIELB [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
shay [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10170-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
4.023    </td>
  </tr>
  <tr id="CF-10171-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<ul>
<li>
4.022</li>
<li>
4.023</li>
<li>
4.024</li>
</ul>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




dbd-mysql.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1222553/645693/dbd-mysql.patch">
Mon Jun 10 11:07:03 2013 (1011b) by shay [...] cpan.org
</a>
</font></li>
</ul>


dbtest.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1220946/644811/dbtest.pl">
Thu Jun 06 06:23:16 2013 (1.2k) by shay [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=85919">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1220946" href="/Public/Bug/Display.html?id=85919#txn-1220946">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;06&nbsp;06:23:16&nbsp;2013</span>
    <span class="description">shay [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> fetch*&#40;&#41; on lost connection wrongly reports &#34;fetch&#40;&#41; without
 execute&#40;&#41;&#34; instead of &#34;MySQL server has gone away&#34;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1220946/644810/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/644810">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">If the perl program&#39;s connection to the MySQL server gets timed out and closed by the server then a subsequent prepare&#40;&#41; + execute&#40;&#41; + fetchrow_array&#40;&#41; + finish&#40;&#41; wrongly reports error 19 &#40;&#34;fetch&#40;&#41; without execute&#40;&#41;&#34;&#41; instead of 2006 &#40;&#34;MySQL server has gone away&#34;&#41;. &#40;And, in fact, the error comes from the fetchrow_array&#40;&#41; function, *after* it has &#40;apparently&#41; done a successful execute&#40;&#41;!&#41;

The problem can be easily reproduced with the attached perl program after setting &#34;wait_timeout = 5&#34; in the [mysqld] section of the appropriate my.ini configuration file &#40;and restarting the MySQL server&#41;.

The program establishes a connection to the &#39;mysql&#39; database, waits for 7 seconds to be sure the connection gets timed out, then prepares, excutes, fetches and finishes a simple statement &#40;&#39;SELECT 1&#39;&#41;. I get the following output every time:

Connecting...
Sleeping...
Preparing...
Executing...
Fetching...
Error 19: fetch&#40;&#41; without execute&#40;&#41;

The other three fetch*&#40;&#41; functions commented out in the program behave the same way, but strangely the three select*&#40;&#41; functions in a separate block in the program apparently succeed with no error at all if you adjust the program to run through that block of code instead.

Note that I have previously had a similar issue with &#34;fetch&#40;&#41; without execute&#40;&#41;&#34; being wrongly reported instead of the expected lost connection error. For example, see the following mailing list archive thread from 11 years ago in which I reported the same problem:

<span class="clickylink"><a target="new" rel="nofollow" href="http://grokbase.com/t/mysql/perl/0251jk3kpt/dbd-mysql-fetch-without-execute-error">http://grokbase.com/t/mysql/perl/0251jk3kpt/dbd-mysql-fetch-without-execute-error</a></span>

That discussion resulted in a fix for the problem which I had then, and the fix which it put into dbdimp.c is indeed still there around line 3273. I wonder if there is a similar problem lurking somewhere else in that file?
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dbtest.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1220946/644811/dbtest.pl">Download dbtest.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use warnings;
use DBI;
my&#40;$dbh, $sth&#41;;
my $ok = eval {
    print &#34;Connecting...\n&#34;;
    $dbh = DBI-&gt;connect&#40;&#39;dbi:mysql:database=mysql;mysql_client_found_rows=1&#39;,
        &#39;root&#39;, undef, {PrintError =&gt; 0, RaiseError =&gt; 1, AutoCommit =&gt; 0}&#41;;
    print &#34;Sleeping...\n&#34;;
    sleep 7;
    my $sql = &#39;SELECT 1&#39;;
    if &#40;1&#41; {
        print &#34;Preparing...\n&#34;;
        $sth = $dbh-&gt;prepare&#40;$sql&#41;;
        print &#34;Executing...\n&#34;;
        $sth-&gt;execute&#40;&#41;;
        print &#34;Fetching...\n&#34;;
        my @res = $sth-&gt;fetchrow_array&#40;&#41;;
#       my $res = $sth-&gt;fetchrow_arrayref&#40;&#41;;
#       my $res = $sth-&gt;fetchrow_hashref&#40;&#41;;
#       my $res = $sth-&gt;fetchall_arrayref&#40;&#41;;
        print &#34;Finishing...\n&#34;;
        $sth-&gt;finish&#40;&#41;;
        $sth = undef;
    }
    else {
        print &#34;Selecting...\n&#34;;
        my @res = $dbh-&gt;selectrow_array&#40;$sql&#41;;
#       my $res = $dbh-&gt;selectall_arrayref&#40;$sql&#41;;
#       my $res = $dbh-&gt;selectcol_arrayref&#40;$sql&#41;;
    }
    print &#34;Disconnecting...\n&#34;;
    $dbh-&gt;disconnect&#40;&#41;;
    $dbh = undef;
    1;
};
if &#40;not $ok&#41; {
    printf &#34;Error %d: %s\n&#34;, $DBI::err, $DBI::errstr;
    eval { $sth-&gt;finish&#40;&#41;; } if defined $sth;
    eval { $dbh-&gt;disconnect&#40;&#41;; } if defined $dbh;
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1222553" href="/Public/Bug/Display.html?id=85919#txn-1222553">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;10&nbsp;11:07:03&nbsp;2013</span>
    <span class="description">shay [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] fetch*&#40;&#41; on lost connection wrongly reports &#34;fetch&#40;&#41;
 without execute&#40;&#41;&#34; instead of &#34;Lost connection to MySQL server during
 query&#34;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1222553/645692/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/645692">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jun 06 06:23:16 2013, SHAY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If the perl program&#39;s connection to the MySQL server gets timed out
&gt;    and closed by the server then a subsequent prepare&#40;&#41; + execute&#40;&#41; +
&gt;    fetchrow_array&#40;&#41; + finish&#40;&#41; wrongly reports error 19 &#40;&#34;fetch&#40;&#41;
&gt;    without execute&#40;&#41;&#34;&#41; instead of 2006 &#40;&#34;MySQL server has gone away&#34;&#41;.
&gt;    &#40;And, in fact, the error comes from the fetchrow_array&#40;&#41; function,
&gt;    *after* it has &#40;apparently&#41; done a successful execute&#40;&#41;!&#41;
&gt; 
</div>
I have now debugged this and have a patch which fixes it &#40;attached&#41;.

It turns out that execute&#40;&#41; was returning early because mysql_db_reconnect&#40;&#41; only checked for CR_SERVER_GONE_ERROR &#40;0x000007d6 == 2006&#41;, but the error that it got from mysql_errno&#40;&#41; was actually CR_SERVER_LOST &#40;0x000007dd == 2013&#41;:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       mysql.dll!mysql_db_reconnect&#40;sv * h&#41;  Line 4851 C
</div>        mysql.dll!mysql_st_internal_execute&#40;sv * h, sv * statement, sv * attribs, int num_params, imp_sth_ph_st * params, st_mysql_res * * result, st_mysql * svsock, int use_mysql_use_result&#41;  Line 3269 + 0x1e bytes C
        mysql.dll!mysql_st_execute&#40;sv * sth, imp_sth_st * imp_sth&#41;  Line 3513 + 0x3c bytes      C
        mysql.dll!XS_DBD__mysql__st_execute&#40;interpreter * my_perl, cv * cv&#41;  Line 591 + 0xd bytes       C
        DBI.dll!XS_DBI_dispatch&#40;interpreter * my_perl, cv * cv&#41;  Line 3715 + 0x18 bytes C
        [...]

Checking for either error code allows mysql_db_reconnect&#40;&#41; to proceed further, and it will now succeed if AutoCommit==1 and mysql_auto_reconnect==1.

However, if either of those options are not set &#40;as in my sample program&#41; mysql_db_reconnect&#40;&#41; still returns early without reconnecting: that&#39;s fine in itself, but when execution continues back in the caller it eventually goes into fetch&#40;&#41; and fails exactly as before, claiming that no execute&#40;&#41; has yet been performed!:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       mysql.dll!mysql_st_fetch&#40;sv * sth, imp_sth_st * imp_sth&#41;  Line 3766     C
</div>        mysql.dll!XS_DBD__mysql__st_fetchrow_array&#40;interpreter * my_perl, cv * cv&#41;  Line 639 + 0xd bytes        C
        DBI.dll!XS_DBI_dispatch&#40;interpreter * my_perl, cv * cv&#41;  Line 3715 + 0x18 bytes C
        [...]

I understand why it says this now, but it would be much better if mysql_st_internal_execute&#40;&#41; had caught the error about the connection having been lost earlier, thus giving the correct error in the correct place, before it even goes as far as trying to fetch&#40;&#41; after a failed execute&#40;&#41;.

The attached patch makes both of these changes, and my sample program now outputs the expected:

Connecting...
Sleeping...
Preparing...
Executing...
Error 2013: Lost connection to MySQL server during query

&#40;Well, actually, I was expecting error 2006, just like dbdimp.c evidently was too, but I can work with 2013 just as well ;-&#41;

The test suite also now passes t/91errcheck.t test 1, which previously failed for me. There are no other test failures except t/50chopblanks.t tests 15, 22, 44, 51 and t/76multi_statement.t tests 14, 22-23 which all failed originally anyway.

I would be very grateful if somebody could apply this patch and roll a new DBD-mysql release.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dbd-mysql.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1222553/645693/dbd-mysql.patch">Download dbd-mysql.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1011b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ruN DBD-mysql-4.023.orig/dbdimp.c DBD-mysql-4.023/dbdimp.c
--- DBD-mysql-4.023.orig/dbdimp.c	2013-04-12 22:18:56.000000000 +0100
+++ DBD-mysql-4.023/dbdimp.c	2013-06-10 15:37:59.318939600 +0100
@@ -3268,6 +3268,10 @@
           &#40;!mysql_db_reconnect&#40;h&#41;  ||
            &#40;mysql_real_query&#40;svsock, sbuf, slen&#41;&#41;&#41;&#41;
       {
+        if &#40;mysql_errno&#40;svsock&#41;&#41;
+          do_error&#40;h, mysql_errno&#40;svsock&#41;, mysql_error&#40;svsock&#41;
+                   ,mysql_sqlstate&#40;svsock&#41;&#41;;
+
         rows = -2;
       } else {
           /** Store the result from the Query */
@@ -4836,6 +4840,7 @@
   dTHX;
   D_imp_xxh&#40;h&#41;;
   imp_dbh_t* imp_dbh;
+  unsigned int last_errno;
   MYSQL save_socket;
 
   if &#40;DBIc_TYPE&#40;imp_xxh&#41; == DBIt_ST&#41;
@@ -4846,7 +4851,8 @@
   else
     imp_dbh= &#40;imp_dbh_t*&#41; imp_xxh;
 
-  if &#40;mysql_errno&#40;imp_dbh-&gt;pmysql&#41; != CR_SERVER_GONE_ERROR&#41;
+  last_errno = mysql_errno&#40;imp_dbh-&gt;pmysql&#41;;
+  if &#40;last_errno != CR_SERVER_GONE_ERROR &#38;&#38; last_errno != CR_SERVER_LOST&#41;
     /* Other error */
     return FALSE;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1222562" href="/Public/Bug/Display.html?id=85919#txn-1222562">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;10&nbsp;11:08:42&nbsp;2013</span>
    <span class="description">shay [...] cpan.org -  Subject changed from &#39;fetch*&#40;&#41; on lost connection wrongly reports &#34;fetch&#40;&#41; without execute&#40;&#41;&#34; instead of &#34;MySQL server has gone away&#34;&#39; to &#39;[PATCH] fetch*&#40;&#41; on lost connection wrongly reports &#34;fetch&#40;&#41; without execute&#40;&#41;&#34; instead of &#34;Lost connection to MySQL server during query&#34;&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1270830" href="/Public/Bug/Display.html?id=85919#txn-1270830">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;03&nbsp;14:30:32&nbsp;2013</span>
    <span class="description">MICHIELB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1270830/672932/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/672932">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Steve,

Thanks for filing a bug report, and for providing a patch.
Since you filed it, we released a new version

I&#39;ve rewrote your demo program a little so it can act as a test; here:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perl5-dbi/DBD-mysql/commit/c8f23b7de82a24e034dc9268a8dbd5f41f2a1cd4">https://github.com/perl5-dbi/DBD-mysql/commit/c8f23b7de82a24e034dc9268a8dbd5f41f2a1cd4</a></span>

The thing is, for me the test works, it nicely reports &#39;the server has gone away&#39; - I also tested on older versions of DBD::mysql.
Can you maybe take a brief look and point out where I made a mistake?

--
Mike

On Mon Jun 10 11:07:03 2013, SHAY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Jun 06 06:23:16 2013, SHAY wrote:
<div class="message-stanza open">&gt; &gt; If the perl program&#39;s connection to the MySQL server gets timed out
&gt; &gt;    and closed by the server then a subsequent prepare&#40;&#41; + execute&#40;&#41; +
&gt; &gt;    fetchrow_array&#40;&#41; + finish&#40;&#41; wrongly reports error 19 &#40;&#34;fetch&#40;&#41;
&gt; &gt;    without execute&#40;&#41;&#34;&#41; instead of 2006 &#40;&#34;MySQL server has gone
&gt; &gt; away&#34;&#41;.
&gt; &gt;    &#40;And, in fact, the error comes from the fetchrow_array&#40;&#41; function,
&gt; &gt;    *after* it has &#40;apparently&#41; done a successful execute&#40;&#41;!&#41;
&gt; &gt;
</div>&gt; 
&gt; I have now debugged this and have a patch which fixes it &#40;attached&#41;.
&gt; 
&gt; It turns out that execute&#40;&#41; was returning early because
&gt; mysql_db_reconnect&#40;&#41; only checked for CR_SERVER_GONE_ERROR &#40;0x000007d6
&gt; == 2006&#41;, but the error that it got from mysql_errno&#40;&#41; was actually
&gt; CR_SERVER_LOST &#40;0x000007dd == 2013&#41;:
&gt; 
<div class="message-stanza open">&gt; &gt; mysql.dll!mysql_db_reconnect&#40;sv * h&#41;  Line 4851 C
</div>&gt; mysql.dll!mysql_st_internal_execute&#40;sv * h, sv * statement, sv *
&gt; attribs, int num_params, imp_sth_ph_st * params, st_mysql_res * *
&gt; result, st_mysql * svsock, int use_mysql_use_result&#41;  Line 3269 + 0x1e
&gt; bytes C
&gt; mysql.dll!mysql_st_execute&#40;sv * sth, imp_sth_st * imp_sth&#41;  Line 3513
&gt; + 0x3c bytes      C
&gt; mysql.dll!XS_DBD__mysql__st_execute&#40;interpreter * my_perl, cv * cv&#41;
&gt; Line 591 + 0xd bytes       C
&gt; DBI.dll!XS_DBI_dispatch&#40;interpreter * my_perl, cv * cv&#41;  Line 3715 +
&gt; 0x18 bytes C
&gt; [...]
&gt; 
&gt; Checking for either error code allows mysql_db_reconnect&#40;&#41; to proceed
&gt; further, and it will now succeed if AutoCommit==1 and
&gt; mysql_auto_reconnect==1.
&gt; 
&gt; However, if either of those options are not set &#40;as in my sample
&gt; program&#41; mysql_db_reconnect&#40;&#41; still returns early without
&gt; reconnecting: that&#39;s fine in itself, but when execution continues back
&gt; in the caller it eventually goes into fetch&#40;&#41; and fails exactly as
&gt; before, claiming that no execute&#40;&#41; has yet been performed!:
&gt; 
<div class="message-stanza open">&gt; &gt; mysql.dll!mysql_st_fetch&#40;sv * sth, imp_sth_st * imp_sth&#41;  Line 3766
&gt; &gt; C
</div>&gt; mysql.dll!XS_DBD__mysql__st_fetchrow_array&#40;interpreter * my_perl, cv *
&gt; cv&#41;  Line 639 + 0xd bytes        C
&gt; DBI.dll!XS_DBI_dispatch&#40;interpreter * my_perl, cv * cv&#41;  Line 3715 +
&gt; 0x18 bytes C
&gt; [...]
&gt; 
&gt; I understand why it says this now, but it would be much better if
&gt; mysql_st_internal_execute&#40;&#41; had caught the error about the connection
&gt; having been lost earlier, thus giving the correct error in the correct
&gt; place, before it even goes as far as trying to fetch&#40;&#41; after a failed
&gt; execute&#40;&#41;.
&gt; 
&gt; The attached patch makes both of these changes, and my sample program
&gt; now outputs the expected:
&gt; 
&gt; Connecting...
&gt; Sleeping...
&gt; Preparing...
&gt; Executing...
&gt; Error 2013: Lost connection to MySQL server during query
&gt; 
&gt; &#40;Well, actually, I was expecting error 2006, just like dbdimp.c
&gt; evidently was too, but I can work with 2013 just as well ;-&#41;
&gt; 
&gt; The test suite also now passes t/91errcheck.t test 1, which previously
&gt; failed for me. There are no other test failures except
&gt; t/50chopblanks.t tests 15, 22, 44, 51 and t/76multi_statement.t tests
&gt; 14, 22-23 which all failed originally anyway.
&gt; 
&gt; I would be very grateful if somebody could apply this patch and roll a
&gt; new DBD-mysql release.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1270831" href="/Public/Bug/Display.html?id=85919#txn-1270831">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;03&nbsp;14:30:32&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1270834" href="/Public/Bug/Display.html?id=85919#txn-1270834">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;03&nbsp;14:30:33&nbsp;2013</span>
    <span class="description">MICHIELB [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271182" href="/Public/Bug/Display.html?id=85919#txn-1271182">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;04&nbsp;13:01:27&nbsp;2013</span>
    <span class="description">steve.m.hay [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> shay [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #85919] [PATCH] fetch*&#40;&#41; on lost connection wrongly reports &#34;fetch&#40;&#41; without execute&#40;&#41;&#34; instead of &#34;Lost connection to MySQL server during query&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 4 Oct 2013 18:01:07 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-mysql [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steve Hay &lt;steve.m.hay [...] googlemail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1271182/673132/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/673132">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the heads-up. I&#39;ve just tried the latest version &#40;4.024&#41;
from CPAN and I too find that my original test case no longer exhibits
the problem. Switching back to the version that I was using at the
time &#40;4.021&#41;, I see the problem again so something in 4.022, 4.023 or
4.024 has evidently fixed it anyway. I didn&#39;t bisect to find exactly
what.

On 3 October 2013 19:30, Michiel Beijen via RT
&lt;bug-DBD-mysql@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=85919">https://rt.cpan.org/Ticket/Display.html?id=85919</a></span> &gt;
&gt;
&gt; Hi Steve,
&gt;
&gt; Thanks for filing a bug report, and for providing a patch.
&gt; Since you filed it, we released a new version
&gt;
&gt; I&#39;ve rewrote your demo program a little so it can act as a test; here:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perl5-dbi/DBD-mysql/commit/c8f23b7de82a24e034dc9268a8dbd5f41f2a1cd4">https://github.com/perl5-dbi/DBD-mysql/commit/c8f23b7de82a24e034dc9268a8dbd5f41f2a1cd4</a></span>
&gt;
&gt; The thing is, for me the test works, it nicely reports &#39;the server has gone away&#39; - I also tested on older versions of DBD::mysql.
&gt; Can you maybe take a brief look and point out where I made a mistake?
&gt;
&gt; --
&gt; Mike
&gt;
&gt; On Mon Jun 10 11:07:03 2013, SHAY wrote:
<div class="message-stanza open">&gt;&gt; On Thu Jun 06 06:23:16 2013, SHAY wrote:
<div class="message-stanza open">&gt;&gt; &gt; If the perl program&#39;s connection to the MySQL server gets timed out
&gt;&gt; &gt;    and closed by the server then a subsequent prepare&#40;&#41; + execute&#40;&#41; +
&gt;&gt; &gt;    fetchrow_array&#40;&#41; + finish&#40;&#41; wrongly reports error 19 &#40;&#34;fetch&#40;&#41;
&gt;&gt; &gt;    without execute&#40;&#41;&#34;&#41; instead of 2006 &#40;&#34;MySQL server has gone
&gt;&gt; &gt; away&#34;&#41;.
&gt;&gt; &gt;    &#40;And, in fact, the error comes from the fetchrow_array&#40;&#41; function,
&gt;&gt; &gt;    *after* it has &#40;apparently&#41; done a successful execute&#40;&#41;!&#41;
&gt;&gt; &gt;
</div>&gt;&gt;
&gt;&gt; I have now debugged this and have a patch which fixes it &#40;attached&#41;.
&gt;&gt;
&gt;&gt; It turns out that execute&#40;&#41; was returning early because
&gt;&gt; mysql_db_reconnect&#40;&#41; only checked for CR_SERVER_GONE_ERROR &#40;0x000007d6
&gt;&gt; == 2006&#41;, but the error that it got from mysql_errno&#40;&#41; was actually
&gt;&gt; CR_SERVER_LOST &#40;0x000007dd == 2013&#41;:
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt; mysql.dll!mysql_db_reconnect&#40;sv * h&#41;  Line 4851 C
</div>&gt;&gt; mysql.dll!mysql_st_internal_execute&#40;sv * h, sv * statement, sv *
&gt;&gt; attribs, int num_params, imp_sth_ph_st * params, st_mysql_res * *
&gt;&gt; result, st_mysql * svsock, int use_mysql_use_result&#41;  Line 3269 + 0x1e
&gt;&gt; bytes C
&gt;&gt; mysql.dll!mysql_st_execute&#40;sv * sth, imp_sth_st * imp_sth&#41;  Line 3513
&gt;&gt; + 0x3c bytes      C
&gt;&gt; mysql.dll!XS_DBD__mysql__st_execute&#40;interpreter * my_perl, cv * cv&#41;
&gt;&gt; Line 591 + 0xd bytes       C
&gt;&gt; DBI.dll!XS_DBI_dispatch&#40;interpreter * my_perl, cv * cv&#41;  Line 3715 +
&gt;&gt; 0x18 bytes C
&gt;&gt; [...]
&gt;&gt;
&gt;&gt; Checking for either error code allows mysql_db_reconnect&#40;&#41; to proceed
&gt;&gt; further, and it will now succeed if AutoCommit==1 and
&gt;&gt; mysql_auto_reconnect==1.
&gt;&gt;
&gt;&gt; However, if either of those options are not set &#40;as in my sample
&gt;&gt; program&#41; mysql_db_reconnect&#40;&#41; still returns early without
&gt;&gt; reconnecting: that&#39;s fine in itself, but when execution continues back
&gt;&gt; in the caller it eventually goes into fetch&#40;&#41; and fails exactly as
&gt;&gt; before, claiming that no execute&#40;&#41; has yet been performed!:
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt; mysql.dll!mysql_st_fetch&#40;sv * sth, imp_sth_st * imp_sth&#41;  Line 3766
&gt;&gt; &gt; C
</div>&gt;&gt; mysql.dll!XS_DBD__mysql__st_fetchrow_array&#40;interpreter * my_perl, cv *
&gt;&gt; cv&#41;  Line 639 + 0xd bytes        C
&gt;&gt; DBI.dll!XS_DBI_dispatch&#40;interpreter * my_perl, cv * cv&#41;  Line 3715 +
&gt;&gt; 0x18 bytes C
&gt;&gt; [...]
&gt;&gt;
&gt;&gt; I understand why it says this now, but it would be much better if
&gt;&gt; mysql_st_internal_execute&#40;&#41; had caught the error about the connection
&gt;&gt; having been lost earlier, thus giving the correct error in the correct
&gt;&gt; place, before it even goes as far as trying to fetch&#40;&#41; after a failed
&gt;&gt; execute&#40;&#41;.
&gt;&gt;
&gt;&gt; The attached patch makes both of these changes, and my sample program
&gt;&gt; now outputs the expected:
&gt;&gt;
&gt;&gt; Connecting...
&gt;&gt; Sleeping...
&gt;&gt; Preparing...
&gt;&gt; Executing...
&gt;&gt; Error 2013: Lost connection to MySQL server during query
&gt;&gt;
&gt;&gt; &#40;Well, actually, I was expecting error 2006, just like dbdimp.c
&gt;&gt; evidently was too, but I can work with 2013 just as well ;-&#41;
&gt;&gt;
&gt;&gt; The test suite also now passes t/91errcheck.t test 1, which previously
&gt;&gt; failed for me. There are no other test failures except
&gt;&gt; t/50chopblanks.t tests 15, 22, 44, 51 and t/76multi_statement.t tests
&gt;&gt; 14, 22-23 which all failed originally anyway.
&gt;&gt;
&gt;&gt; I would be very grateful if somebody could apply this patch and roll a
&gt;&gt; new DBD-mysql release.
</div>&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271294" href="/Public/Bug/Display.html?id=85919#txn-1271294">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;05&nbsp;04:05:44&nbsp;2013</span>
    <span class="description">MICHIELB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> steve.m.hay [...] googlemail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1271294/673183/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/673183">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 523b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Steve,

On Fri Oct 04 13:01:27 2013, steve.m.hay@googlemail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for the heads-up. I&#39;ve just tried the latest version &#40;4.024&#41;
&gt; from CPAN and I too find that my original test case no longer exhibits
&gt; the problem. Switching back to the version that I was using at the
&gt; time &#40;4.021&#41;, I see the problem again so something in 4.022, 4.023 or
&gt; 4.024 has evidently fixed it anyway. I didn&#39;t bisect to find exactly
&gt; what.
</div>
Great, thanks for the confirmation. I&#39;m setting this RT ticket to resolved now.

--
Mike
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271298" href="/Public/Bug/Display.html?id=85919#txn-1271298">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;05&nbsp;04:05:45&nbsp;2013</span>
    <span class="description">MICHIELB [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271300" href="/Public/Bug/Display.html?id=85919#txn-1271300">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;05&nbsp;04:05:46&nbsp;2013</span>
    <span class="description">MICHIELB [...] cpan.org -  Fixed in 4.022 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271301" href="/Public/Bug/Display.html?id=85919#txn-1271301">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;05&nbsp;04:05:46&nbsp;2013</span>
    <span class="description">MICHIELB [...] cpan.org -  Fixed in 4.023 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1271302" href="/Public/Bug/Display.html?id=85919#txn-1271302">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;05&nbsp;04:05:46&nbsp;2013</span>
    <span class="description">MICHIELB [...] cpan.org -  Fixed in 4.024 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.588883</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
