<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #44899 for XML-Feed: Information lost in convert process</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #44899 for XML-Feed: Information lost in convert process</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/XML-Feed/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/XML-Feed/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/XML-Feed/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/XML-Feed/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-Feed">XML-Feed CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">44899</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/XML-Feed/Active/">XML-Feed</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dave [...] dave.org.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
SHLOMIF [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-37100-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.42    </td>
  </tr>
  <tr id="CF-37101-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;09&nbsp;10:09:51&nbsp;2009</span>
    <span class="description">DAVECROSS [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Information lost in convert process</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">There seems to be a problem in the conversion from RSS to Atom. The
attached test demonstrates it. In the original RSS feed, the entry
contains HTML formatting. When I convert the feed to Atom that
formatting vanishes.

Let me know if you need any more details.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> rss.xml</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;

&lt;rdf:RDF
 xmlns:rdf=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;">http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;</a></span>
 xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/">http://purl.org/rss/1.0/</a></span>&#34;
 xmlns:slash=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/slash/">http://purl.org/rss/1.0/modules/slash/</a></span>&#34;
 xmlns:taxo=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/taxonomy/">http://purl.org/rss/1.0/modules/taxonomy/</a></span>&#34;
 xmlns:dc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></span>&#34;
 xmlns:syn=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/syndication/">http://purl.org/rss/1.0/modules/syndication/</a></span>&#34;
 xmlns:admin=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://webns.net/mvcb/">http://webns.net/mvcb/</a></span>&#34;
&gt;

&lt;channel rdf:about=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/">http://use.perl.org/~davorg/journal/</a></span>&#34;&gt;
&lt;title&gt;davorg&#39;s Journal&lt;/title&gt;
&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/">http://use.perl.org/~davorg/journal/</a></span>&lt;/link&gt;
&lt;description&gt;davorg&#39;s use Perl Journal&lt;/description&gt;
&lt;dc:language&gt;en-us&lt;/dc:language&gt;
&lt;dc:rights&gt;use Perl; is Copyright 1998-2006, Chris Nandor. Stories, comments, journals, and other submissions posted on use Perl; are Copyright their respective owners.&lt;/dc:rights&gt;
&lt;dc:date&gt;2009-04-09T12:53:36+00:00&lt;/dc:date&gt;
&lt;dc:publisher&gt;pudge&lt;/dc:publisher&gt;
&lt;dc:creator&gt;pudge@perl.org&lt;/dc:creator&gt;
&lt;dc:subject&gt;Technology&lt;/dc:subject&gt;
&lt;syn:updatePeriod&gt;hourly&lt;/syn:updatePeriod&gt;
&lt;syn:updateFrequency&gt;1&lt;/syn:updateFrequency&gt;
&lt;syn:updateBase&gt;1970-01-01T00:00+00:00&lt;/syn:updateBase&gt;
&lt;items&gt;
 &lt;rdf:Seq&gt;
  &lt;rdf:li rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/38730?from=rss">http://use.perl.org/~davorg/journal/38730?from=rss</a></span>&#34; /&gt;
 &lt;/rdf:Seq&gt;
&lt;/items&gt;
&lt;image rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/images/topics/useperl.gif">http://use.perl.org/images/topics/useperl.gif</a></span>&#34; /&gt;
&lt;/channel&gt;

&lt;image rdf:about=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/images/topics/useperl.gif">http://use.perl.org/images/topics/useperl.gif</a></span>&#34;&gt;
&lt;title&gt;davorg&#39;s Journal&lt;/title&gt;
&lt;url&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/images/topics/useperl.gif">http://use.perl.org/images/topics/useperl.gif</a></span>&lt;/url&gt;
&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/">http://use.perl.org/~davorg/journal/</a></span>&lt;/link&gt;
&lt;/image&gt;

&lt;item rdf:about=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/38730?from=rss">http://use.perl.org/~davorg/journal/38730?from=rss</a></span>&#34;&gt;
&lt;title&gt;Task::Kensho RPMs&lt;/title&gt;
&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/38730?from=rss">http://use.perl.org/~davorg/journal/38730?from=rss</a></span>&lt;/link&gt;
&lt;description&gt;&#38;lt;p&#38;gt;One of the first concrete outputs from the &#38;lt;a href=&#34;http://www.enlightenedperl.org/&#34;&#38;gt;Enlightened Perl Organisation&#38;lt;/a&#38;gt; has been &#38;lt;a href=&#34;http://search.cpan.org/dist/Task-Kensho/&#34;&#38;gt;Task::Kensho&#38;lt;/a&#38;gt; - a CPAN module which exists to list a number of other CPAN modules that modern Perl programmers should consider using. if you install Task::Kensho then all of the included modules will automatically be pulled down from CPAN and installed.&#38;lt;/p&#38;gt;&#38;lt;p&#38;gt;I don&#39;t install my modules from CPAN. As I live in the Red Hat world, I like to install RPMs of modules. And I build RPMs for modules that aren&#39;t already available in that format &#40;and then I &#38;lt;a href=&#34;http://rpm.mag-sol.com/&#34;&#38;gt;make them available to everyone&#38;lt;/a&#38;gt;&#41;.&#38;lt;/p&#38;gt;&#38;lt;p&#38;gt;So last night I created an RPM for Task::Kensho. This also involved building RPMs for about half of the modules it include which didn&#39;t already exist as RPMs in the standard repostories. Those RPMs are now available from &#38;lt;a href=&#34;http://rpm.mag-sol.com/&#34;&#38;gt;my repository&#38;lt;/a&#38;gt; so installing them all could be as simple as &#38;lt;tt&#38;gt;sudo yum install perl-Task-Kensho&#38;lt;/tt&#38;gt;. Of course, you can also install individual packages using the appropriate &#38;lt;tt&#38;gt;yum&#38;lt;/tt&#38;gt; command.&#38;lt;/p&#38;gt;&#38;lt;p&#38;gt;Currently the RPMs are only available for Fedora 10. I&#39;ll build versions for Centos 5 over the next couple of days.&#38;lt;/p&#38;gt;&lt;/description&gt;
&lt;dc:creator&gt;davorg&lt;/dc:creator&gt;
&lt;dc:date&gt;2009-03-31T08:02:06+00:00&lt;/dc:date&gt;
&lt;dc:subject&gt;journal&lt;/dc:subject&gt;
&lt;/item&gt;
&lt;/rdf:RDF&gt;
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> convert.t</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use Test::More &#39;no_plan&#39;;

use XML::Feed;

my $rss = XML::Feed-&gt;parse&#40;&#39;rss.xml&#39;&#41;;
isa_ok&#40;$rss, &#39;XML::Feed::Format::RSS&#39;&#41;;
my $rss_entry = &#40;$rss-&gt;entries&#41;[0];
isa_ok&#40;$rss_entry, &#39;XML::Feed::Entry::Format::RSS&#39;&#41;;
my $rss_content = $rss_entry-&gt;content;
isa_ok&#40;$rss_content, &#39;XML::Feed::Content&#39;&#41;;
is&#40;$rss_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;
like&#40;$rss_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;

my $atom = $rss-&gt;convert&#40;&#39;Atom&#39;&#41;;
isa_ok&#40;$atom, &#39;XML::Feed::Format::Atom&#39;&#41;;
my $atom_entry = &#40;$atom-&gt;entries&#41;[0];
isa_ok&#40;$atom_entry, &#39;XML::Feed::Entry::Format::Atom&#39;&#41;;
my $atom_content = $atom_entry-&gt;content;
isa_ok&#40;$atom_content, &#39;XML::Feed::Content&#39;&#41;;
is&#40;$atom_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;
like&#40;$atom_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;14&nbsp;14:28:05&nbsp;2009</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I got bit by this bug too. +1 on it being fixed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;14&nbsp;14:28:06&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;21&nbsp;14:40:34&nbsp;2009</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Apr 09 10:09:51 2009, DAVECROSS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; There seems to be a problem in the conversion from RSS to Atom. The
&gt; attached test demonstrates it. In the original RSS feed, the entry
&gt; contains HTML formatting. When I convert the feed to Atom that
&gt; formatting vanishes.
&gt; 
&gt; Let me know if you need any more details.
</div>
Attached is a patch that fixes the problem against the svn trunk. Please
apply it. I reworked Dave&#39;s testcase into a patch and fixed the problem.

Regards,

-- Shlomi Fish
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: t/samples/rss10-davorg-journal.xml
===================================================================
--- t/samples/rss10-davorg-journal.xml	&#40;revision 0&#41;
+++ t/samples/rss10-davorg-journal.xml	&#40;revision 0&#41;
@@ -0,0 +1,48 @@
+&lt;?xml version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;
+
+&lt;rdf:RDF
+ xmlns:rdf=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;">http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;</a></span>
+ xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/">http://purl.org/rss/1.0/</a></span>&#34;
+ xmlns:slash=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/slash/">http://purl.org/rss/1.0/modules/slash/</a></span>&#34;
+ xmlns:taxo=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/taxonomy/">http://purl.org/rss/1.0/modules/taxonomy/</a></span>&#34;
+ xmlns:dc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></span>&#34;
+ xmlns:syn=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/syndication/">http://purl.org/rss/1.0/modules/syndication/</a></span>&#34;
+ xmlns:admin=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://webns.net/mvcb/">http://webns.net/mvcb/</a></span>&#34;
+&gt;
+
+&lt;channel rdf:about=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/">http://use.perl.org/~davorg/journal/</a></span>&#34;&gt;
+&lt;title&gt;davorg&#39;s Journal&lt;/title&gt;
+&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/">http://use.perl.org/~davorg/journal/</a></span>&lt;/link&gt;
+&lt;description&gt;davorg&#39;s use Perl Journal&lt;/description&gt;
+&lt;dc:language&gt;en-us&lt;/dc:language&gt;
+&lt;dc:rights&gt;use Perl; is Copyright 1998-2006, Chris Nandor. Stories, comments, journals, and other submissions posted on use Perl; are Copyright their respective owners.&lt;/dc:rights&gt;
+&lt;dc:date&gt;2009-04-09T12:53:36+00:00&lt;/dc:date&gt;
+&lt;dc:publisher&gt;pudge&lt;/dc:publisher&gt;
+&lt;dc:creator&gt;pudge@perl.org&lt;/dc:creator&gt;
+&lt;dc:subject&gt;Technology&lt;/dc:subject&gt;
+&lt;syn:updatePeriod&gt;hourly&lt;/syn:updatePeriod&gt;
+&lt;syn:updateFrequency&gt;1&lt;/syn:updateFrequency&gt;
+&lt;syn:updateBase&gt;1970-01-01T00:00+00:00&lt;/syn:updateBase&gt;
+&lt;items&gt;
+ &lt;rdf:Seq&gt;
+  &lt;rdf:li rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/38730?from=rss">http://use.perl.org/~davorg/journal/38730?from=rss</a></span>&#34; /&gt;
+ &lt;/rdf:Seq&gt;
+&lt;/items&gt;
+&lt;image rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/images/topics/useperl.gif">http://use.perl.org/images/topics/useperl.gif</a></span>&#34; /&gt;
+&lt;/channel&gt;
+
+&lt;image rdf:about=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/images/topics/useperl.gif">http://use.perl.org/images/topics/useperl.gif</a></span>&#34;&gt;
+&lt;title&gt;davorg&#39;s Journal&lt;/title&gt;
+&lt;url&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/images/topics/useperl.gif">http://use.perl.org/images/topics/useperl.gif</a></span>&lt;/url&gt;
+&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/">http://use.perl.org/~davorg/journal/</a></span>&lt;/link&gt;
+&lt;/image&gt;
+
+&lt;item rdf:about=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/38730?from=rss">http://use.perl.org/~davorg/journal/38730?from=rss</a></span>&#34;&gt;
+&lt;title&gt;Task::Kensho RPMs&lt;/title&gt;
+&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~davorg/journal/38730?from=rss">http://use.perl.org/~davorg/journal/38730?from=rss</a></span>&lt;/link&gt;
+&lt;description&gt;&#38;lt;p&#38;gt;One of the first concrete outputs from the &#38;lt;a href=&#34;http://www.enlightenedperl.org/&#34;&#38;gt;Enlightened Perl Organisation&#38;lt;/a&#38;gt; has been &#38;lt;a href=&#34;http://search.cpan.org/dist/Task-Kensho/&#34;&#38;gt;Task::Kensho&#38;lt;/a&#38;gt; - a CPAN module which exists to list a number of other CPAN modules that modern Perl programmers should consider using. if you install Task::Kensho then all of the included modules will automatically be pulled down from CPAN and installed.&#38;lt;/p&#38;gt;&#38;lt;p&#38;gt;I don&#39;t install my modules from CPAN. As I live in the Red Hat world, I like to install RPMs of modules. And I build RPMs for modules that aren&#39;t already available in that format &#40;and then I &#38;lt;a href=&#34;http://rpm.mag-sol.com/&#34;&#38;gt;make them available to everyone&#38;lt;/a&#38;gt;&#41;.&#38;lt;/p&#38;gt;&#38;lt;p&#38;gt;So last night I created an RPM for Task::Kensho. This also involved building RPMs for about half of the modules it include which didn&#39;t already exist as RPMs in the standard repostories. Those RPMs are now available from &#38;lt;a href=&#34;http://rpm.mag-sol.com/&#34;&#38;gt;my repository&#38;lt;/a&#38;gt; so installing them all could be as simple as &#38;lt;tt&#38;gt;sudo yum install perl-Task-Kensho&#38;lt;/tt&#38;gt;. Of course, you can also install individual packages using the appropriate &#38;lt;tt&#38;gt;yum&#38;lt;/tt&#38;gt; command.&#38;lt;/p&#38;gt;&#38;lt;p&#38;gt;Currently the RPMs are only available for Fedora 10. I&#39;ll build versions for Centos 5 over the next couple of days.&#38;lt;/p&#38;gt;&lt;/description&gt;
+&lt;dc:creator&gt;davorg&lt;/dc:creator&gt;
+&lt;dc:date&gt;2009-03-31T08:02:06+00:00&lt;/dc:date&gt;
+&lt;dc:subject&gt;journal&lt;/dc:subject&gt;
+&lt;/item&gt;
+&lt;/rdf:RDF&gt;

Property changes on: t/samples/rss10-davorg-journal.xml
___________________________________________________________________
Added: svn:eol-style
   + native

Index: t/16-convert.t
===================================================================
--- t/16-convert.t	&#40;revision 0&#41;
+++ t/16-convert.t	&#40;revision 0&#41;
@@ -0,0 +1,67 @@
+use strict;
+use warnings;
+
+use Test::More tests =&gt; 12;
+
+use XML::Feed;
+use File::Spec;
+
+
+{
+    my $rss = XML::Feed-&gt;parse&#40;
+        File::Spec-&gt;catfile&#40;File::Spec-&gt;curdir&#40;&#41;, 
+            &#34;t&#34;, &#34;samples&#34;, &#34;rss10-davorg-journal.xml&#34;
+        &#41;
+    &#41;;
+
+    # TEST
+    isa_ok&#40;$rss, &#39;XML::Feed::Format::RSS&#39;&#41;;
+    my $rss_entry = &#40;$rss-&gt;entries&#41;[0];
+
+    # TEST
+    isa_ok&#40;$rss_entry, &#39;XML::Feed::Entry::Format::RSS&#39;&#41;;
+
+
+    my $rss_content = $rss_entry-&gt;content;
+
+    # TEST
+    isa_ok&#40;$rss_content, &#39;XML::Feed::Content&#39;&#41;;
+
+    # TEST
+    is&#40;$rss_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;
+
+    # TEST
+    like&#40;$rss_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;
+
+    # TEST
+    like&#40;$rss_content-&gt;body, 
+        qr{\A\Q&lt;p&gt;One of the first concrete outputs from the &lt;a href=&#34;http://www.enlightenedperl.org/&#34;&gt;Enlightened Perl Organisation&lt;/a&gt;\E}, 
+        &#39;Contains HTML tags&#39;&#41;;
+
+
+    my $atom = $rss-&gt;convert&#40;&#39;Atom&#39;&#41;;
+
+    # TEST
+    isa_ok&#40;$atom, &#39;XML::Feed::Format::Atom&#39;&#41;;
+
+    my $atom_entry = &#40;$atom-&gt;entries&#41;[0];
+
+    # TEST
+    isa_ok&#40;$atom_entry, &#39;XML::Feed::Entry::Format::Atom&#39;&#41;;
+
+    my $atom_content = $atom_entry-&gt;content;
+
+    # TEST
+    isa_ok&#40;$atom_content, &#39;XML::Feed::Content&#39;&#41;;
+
+    # TEST
+    is&#40;$atom_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;
+
+    # TEST
+    like&#40;$atom_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;
+
+    # TEST
+    like&#40;$atom_content-&gt;body, 
+        qr{\A\Q&lt;p&gt;One of the first concrete outputs from the &lt;a href=&#34;http://www.enlightenedperl.org/&#34;&gt;Enlightened Perl Organisation&lt;/a&gt;\E}, 
+        &#39;Contains HTML tags&#39;&#41;;
+}
Index: lib/XML/Feed/Format/Atom.pm
===================================================================
--- lib/XML/Feed/Format/Atom.pm	&#40;revision 153&#41;
+++ lib/XML/Feed/Format/Atom.pm	&#40;working copy&#41;
@@ -8,6 +8,7 @@
 use XML::Atom::Util qw&#40; iso2dt &#41;;
 use List::Util qw&#40; first &#41;;
 use DateTime::Format::W3CDTF;
+use HTML::Entities;
 
 use XML::Atom::Entry;
 XML::Atom::Entry-&gt;mk_elem_accessors&#40;qw&#40; lat long &#41;, [&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2003/01/geo/wgs84_pos#&#39;]&#41;">http://www.w3.org/2003/01/geo/wgs84_pos#&#39;]&#41;</a></span>;
@@ -199,6 +200,10 @@
         if &#40;ref&#40;$_[0]&#41; eq &#39;XML::Feed::Content&#39;&#41; {
 			if &#40;defined $_[0]-&gt;type &#38;&#38; defined $types{$_[0]-&gt;type}&#41; {
 	            %param = &#40;Body =&gt; $_[0]-&gt;body, Type =&gt; $types{$_[0]-&gt;type}&#41;;
+
+                if &#40;$param{&#39;Type&#39;} eq &#34;html&#34;&#41; {
+                    $param{&#39;Body&#39;} = HTML::Entities::encode_entities&#40;$param{&#39;Body&#39;}&#41;;
+                }
 			} else {
 	            %param = &#40;Body =&gt; $_[0]-&gt;body&#41;;
 			}
Index: MANIFEST
===================================================================
--- MANIFEST	&#40;revision 153&#41;
+++ MANIFEST	&#40;working copy&#41;
@@ -1,12 +1,12 @@
 Changes
-lib/XML/Feed.pm
 lib/XML/Feed/Content.pm
 lib/XML/Feed/Enclosure.pm
 lib/XML/Feed/Entry.pm
 lib/XML/Feed/Format/Atom.pm
 lib/XML/Feed/Format/RSS.pm
+lib/XML/Feed.pm
+MANIFEST.SKIP
 MANIFEST			This list of files
-MANIFEST.SKIP
 META.yml
 README
 t/00-compile.t
@@ -23,13 +23,14 @@
 t/11-xml-base-atom.t
 t/11-xml-base-rss.t
 t/12-multi-categories-atom.t
+t/12-multi-categories.base
 t/12-multi-categories-rss.t
-t/12-multi-categories.base
 t/12-multi-subjects-rss.t
 t/13-category-hash-bug.t
 t/14-enclosures.t
 t/14-multi-enclosures.t
 t/15-odd-date.t
+t/16-convert.t
 t/pod-coverage.t
 t/pod.t
 t/samples/atom-10-example.xml
@@ -41,8 +42,7 @@
 t/samples/base_atom.xml
 t/samples/base_rss.xml
 t/samples/category-bug.xml
-t/samples/rss-multiple-categories.xml
-t/samples/rss-multiple-subjects.xml
+t/samples/rss10-davorg-journal.xml
 t/samples/rss10-invalid-date.xml
 t/samples/rss10-odd-date.xml
 t/samples/rss10.xml
@@ -50,3 +50,5 @@
 t/samples/rss20-multi-enclosure.xml
 t/samples/rss20-no-summary.xml
 t/samples/rss20.xml
+t/samples/rss-multiple-categories.xml
+t/samples/rss-multiple-subjects.xml
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;25&nbsp;03:56:11&nbsp;2009</span>
    <span class="description">DAVECROSS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jun 21 14:40:34 2009, SHLOMIF wrote:
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Attached is a patch that fixes the problem against the svn trunk. Please
&gt; apply it. I reworked Dave&#39;s testcase into a patch and fixed the problem.
</div>
I suspect that Shlomi&#39;s patch may not fix all issues. I&#39;ve applied it to
my local installation and now in some cases I&#39;m seeing double-encoded
entities.

I&#39;ll try to wrap it up into a test file later today.

Dave...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;30&nbsp;07:54:37&nbsp;2009</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jun 25 03:56:11 2009, DAVECROSS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sun Jun 21 14:40:34 2009, SHLOMIF wrote:
&gt;  
<div class="message-stanza open">&gt; &gt; Attached is a patch that fixes the problem against the svn trunk. Please
&gt; &gt; apply it. I reworked Dave&#39;s testcase into a patch and fixed the problem.
</div>&gt; 
&gt; I suspect that Shlomi&#39;s patch may not fix all issues. I&#39;ve applied it to
&gt; my local installation and now in some cases I&#39;m seeing double-encoded
&gt; entities.
&gt; 
&gt; I&#39;ll try to wrap it up into a test file later today.
&gt; 
</div>
Hi Dave!

Any news regarding it?

Regards,

      Shlomi Fish
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Dave...
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;30&nbsp;08:34:49&nbsp;2009</span>
    <span class="description">DAVECROSS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jun 30 07:54:37 2009, SHLOMIF wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Jun 25 03:56:11 2009, DAVECROSS wrote:
<div class="message-stanza open">&gt; &gt; On Sun Jun 21 14:40:34 2009, SHLOMIF wrote:
&gt; &gt;  
<div class="message-stanza open">&gt; &gt; &gt; Attached is a patch that fixes the problem against the svn trunk.
&gt; &gt; &gt; Please apply it. I reworked Dave&#39;s testcase into a patch and 
&gt; &gt; &gt; fixed the problem.
</div>&gt; &gt; 
&gt; &gt; I suspect that Shlomi&#39;s patch may not fix all issues. I&#39;ve applied 
&gt; &gt; it to my local installation and now in some cases I&#39;m seeing double-
&gt; &gt; encoded entities.
&gt; &gt; 
&gt; &gt; I&#39;ll try to wrap it up into a test file later today.
</div>&gt; 
&gt; Hi Dave!
&gt; 
&gt; Any news regarding it?
</div>
Not yet. Bit busy right now. Might find time this afternoon, otherwise
it&#39;ll be tomorrow evening.

But, in summary, you can have valid feeds where the HTML is already
entity-encoded. Your patch makes them double-encoded.

Dave...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;04&nbsp;16:59:50&nbsp;2009</span>
    <span class="description">simonw [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jun 30 08:34:49 2009, DAVECROSS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Not yet. Bit busy right now. Might find time this afternoon, otherwise
&gt; it&#39;ll be tomorrow evening.
&gt; 
&gt; But, in summary, you can have valid feeds where the HTML is already
&gt; entity-encoded. Your patch makes them double-encoded.
</div>
I&#39;m on holiday at the moment &#40;and will be for 2 more months&#41; but if we get another rain storm 
I&#39;ll have a look at this.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;18&nbsp;17:40:59&nbsp;2009</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jun 30 08:34:49 2009, DAVECROSS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Jun 30 07:54:37 2009, SHLOMIF wrote:
<div class="message-stanza open">&gt; &gt; On Thu Jun 25 03:56:11 2009, DAVECROSS wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Sun Jun 21 14:40:34 2009, SHLOMIF wrote:
&gt; &gt; &gt;  
<div class="message-stanza open">&gt; &gt; &gt; &gt; Attached is a patch that fixes the problem against the svn trunk.
&gt; &gt; &gt; &gt; Please apply it. I reworked Dave&#39;s testcase into a patch and 
&gt; &gt; &gt; &gt; fixed the problem.
</div>&gt; &gt; &gt; 
&gt; &gt; &gt; I suspect that Shlomi&#39;s patch may not fix all issues. I&#39;ve applied 
&gt; &gt; &gt; it to my local installation and now in some cases I&#39;m seeing double-
&gt; &gt; &gt; encoded entities.
&gt; &gt; &gt; 
&gt; &gt; &gt; I&#39;ll try to wrap it up into a test file later today.
</div>&gt; &gt; 
&gt; &gt; Hi Dave!
&gt; &gt; 
&gt; &gt; Any news regarding it?
</div>&gt; 
&gt; Not yet. Bit busy right now. Might find time this afternoon, otherwise
&gt; it&#39;ll be tomorrow evening.
&gt; 
</div>
Hi Dave!

Please send me your test case.

Regards,

-- Shlomi Fish

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But, in summary, you can have valid feeds where the HTML is already
&gt; entity-encoded. Your patch makes them double-encoded.
&gt; 
&gt; Dave...
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;27&nbsp;09:55:06&nbsp;2009</span>
    <span class="description">DAVECROSS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Aug 18 17:40:59 2009, SHLOMIF wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Jun 30 08:34:49 2009, DAVECROSS wrote:
<div class="message-stanza open">&gt; &gt; On Tue Jun 30 07:54:37 2009, SHLOMIF wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Thu Jun 25 03:56:11 2009, DAVECROSS wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; On Sun Jun 21 14:40:34 2009, SHLOMIF wrote:
&gt; &gt; &gt; &gt;  
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; Attached is a patch that fixes the problem against the svn 
&gt; &gt; &gt; &gt; &gt; trunk. Please apply it. I reworked Dave&#39;s testcase into a 
&gt; &gt; &gt; &gt; &gt; patch and fixed the problem.
</div>&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I suspect that Shlomi&#39;s patch may not fix all issues. I&#39;ve 
&gt; &gt; &gt; &gt; applied it to my local installation and now in some cases I&#39;m 
&gt; &gt; &gt; &gt; seeing double-encoded entities.
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; I&#39;ll try to wrap it up into a test file later today.
</div>&gt; &gt; &gt; 
&gt; &gt; &gt; Hi Dave!
&gt; &gt; &gt; 
&gt; &gt; &gt; Any news regarding it?
</div>&gt; &gt; 
&gt; &gt; Not yet. Bit busy right now. Might find time this afternoon, 
&gt; &gt; otherwise it&#39;ll be tomorrow evening.
</div>&gt; 
&gt; Hi Dave!
&gt; 
&gt; Please send me your test case.
</div>
Sorry for tardiness. August seems to have vanished in a haze of YAPC::EU
followed by a two-week holiday with barely any net access.

I remember establishing that the problem wasn&#39;t what I thought it was,
but I didn&#39;t get to working out a decent test case. I hope to have time
to get back to it over the weekend.

But if you want an example of the problem, try taking Dave Cantrell&#39;s
RSS feed &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.cantrell.org.uk/david/journal/index.pl?format=rss&#41;">http://www.cantrell.org.uk/david/journal/index.pl?format=rss&#41;</a></span>
and converting it into an Atom feed.

Dave...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;30&nbsp;09:42:59&nbsp;2009</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> simonw [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Simon!

Did you return from your vacation already? If so, can you please take a
look? This bug is blocking a new release of XML-Grammar-Fortune-Synd.

Regards,

-- Shlomi Fish
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;10&nbsp;13:15:19&nbsp;2009</span>
    <span class="description">DAVECROSS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Aug 18 17:40:59 2009, SHLOMIF wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Hi Dave!
&gt; 
&gt; Please send me your test case.
</div>
Right, here&#39;s a test case for the problem I discovered months ago. Sorry
it&#39;s take me so long to do this.

Basically, if you convert the attached RSS 2.0 feed to Atom, then you
end up with double-encoded HTML entities when you produce the XML output.

This leads to much brokenness when displaying it on a web page. See, for
example, <span class="clickylink"><a target="new" rel="nofollow" href="http://mps.theplanetarium.org/test/">http://mps.theplanetarium.org/test/</a></span>.

And I suspect it&#39;s Shlomi&#39;s previous patch being overzealous.

Dave...
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;?xml-stylesheet type=&#34;text/xsl&#34; media=&#34;screen&#34; href=&#34;/~d/styles/rss2full.xsl&#34;?&gt;&lt;?xml-stylesheet type=&#34;text/css&#34; media=&#34;screen&#34; href=&#34;http://feeds.feedburner.com/~d/styles/itemcontent.css&#34;?&gt;&lt;rss xmlns:content=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/content/">http://purl.org/rss/1.0/modules/content/</a></span>&#34; xmlns:wfw=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://wellformedweb.org/CommentAPI/">http://wellformedweb.org/CommentAPI/</a></span>&#34; xmlns:dc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></span>&#34; xmlns:atom=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2005/Atom">http://www.w3.org/2005/Atom</a></span>&#34; xmlns:sy=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/syndication/">http://purl.org/rss/1.0/modules/syndication/</a></span>&#34; xmlns:slash=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/rss/1.0/modules/slash/">http://purl.org/rss/1.0/modules/slash/</a></span>&#34; xmlns:media=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://search.yahoo.com/mrss/">http://search.yahoo.com/mrss/</a></span>&#34; xmlns:feedburner=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://rssnamespace.org/feedburner/ext/1.0">http://rssnamespace.org/feedburner/ext/1.0</a></span>&#34; version=&#34;2.0&#34;&gt;

&lt;channel&gt;
	&lt;title&gt;David Jones, MP&lt;/title&gt;
	
	&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://davidjonesblog.com">http://davidjonesblog.com</a></span>&lt;/link&gt;
	&lt;description&gt;Conservative Member of Parliament for Clwyd West; Shadow Minister for Wales&lt;/description&gt;
	&lt;lastBuildDate&gt;Sat, 10 Oct 2009 14:44:32 +0000&lt;/lastBuildDate&gt;
	&lt;generator&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://wordpress.com/">http://wordpress.com/</a></span>&lt;/generator&gt;
	&lt;language&gt;en&lt;/language&gt;
	&lt;sy:updatePeriod&gt;hourly&lt;/sy:updatePeriod&gt;
	&lt;sy:updateFrequency&gt;1&lt;/sy:updateFrequency&gt;
	&lt;cloud domain=&#34;davidjonesblog.com&#34; port=&#34;80&#34; path=&#34;/?rsscloud=notify&#34; registerProcedure=&#34;&#34; protocol=&#34;http-post&#34; /&gt;
&lt;image&gt;
		&lt;url&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.gravatar.com/blavatar/a828c934fa71b769302493ee214f134d?s=96&#38;amp;d=http://s.wordpress.com/i/buttonw-com.png">http://www.gravatar.com/blavatar/a828c934fa71b769302493ee214f134d?s=96&#38;amp;d=http://s.wordpress.com/i/buttonw-com.png</a></span>&lt;/url&gt;
		&lt;title&gt;David Jones, MP&lt;/title&gt;
		&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://davidjonesblog.com">http://davidjonesblog.com</a></span>&lt;/link&gt;
	&lt;/image&gt;
			&lt;atom10:link xmlns:atom10=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2005/Atom">http://www.w3.org/2005/Atom</a></span>&#34; rel=&#34;self&#34; href=&#34;http://feeds.feedburner.com/wordpress/GWIK&#34; type=&#34;application/rss+xml&#34; /&gt;&lt;atom10:link xmlns:atom10=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2005/Atom">http://www.w3.org/2005/Atom</a></span>&#34; rel=&#34;hub&#34; href=&#34;http://pubsubhubbub.appspot.com&#34; /&gt;&lt;item&gt;
		&lt;title&gt;Sunny Gordon&lt;/title&gt;
		&lt;link&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://feedproxy.google.com/~r/wordpress/GWIK/~3/YVku-jKELKs/">http://feedproxy.google.com/~r/wordpress/GWIK/~3/YVku-jKELKs/</a></span>&lt;/link&gt;
		&lt;comments&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://davidjonesblog.com/2009/10/10/sunny-gordon/#comments">http://davidjonesblog.com/2009/10/10/sunny-gordon/#comments</a></span>&lt;/comments&gt;
		&lt;pubDate&gt;Sat, 10 Oct 2009 11:57:47 +0000&lt;/pubDate&gt;
		&lt;dc:creator&gt;David Jones&lt;/dc:creator&gt;
				&lt;category&gt;&lt;![CDATA[Conservative Party]]&gt;&lt;/category&gt;
		&lt;category&gt;&lt;![CDATA[Gordon Brown]]&gt;&lt;/category&gt;
		&lt;category&gt;&lt;![CDATA[Labour Party]]&gt;&lt;/category&gt;
		&lt;category&gt;&lt;![CDATA[economy]]&gt;&lt;/category&gt;
		&lt;category&gt;&lt;![CDATA[Politics]]&gt;&lt;/category&gt;

		&lt;guid isPermaLink=&#34;false&#34;&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://davidjonesblog.com/?p=4022">http://davidjonesblog.com/?p=4022</a></span>&lt;/guid&gt;
		&lt;description&gt;&lt;![CDATA[With Gordon at the helm, Labour are going to let the good times roll.&lt;img alt=&#34;&#34; border=&#34;0&#34; src=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://stats.wordpress.com/b.gif?host=davidjonesblog.com&#38;blog=5996455&#38;post=4022&#38;subd=davidjonesmp&#38;ref=&#38;feed=1">http://stats.wordpress.com/b.gif?host=davidjonesblog.com&#38;blog=5996455&#38;post=4022&#38;subd=davidjonesmp&#38;ref=&#38;feed=1</a></span>&#34; /&gt;]]&gt;&lt;/description&gt;
			&lt;content:encoded&gt;&lt;![CDATA[&lt;div class=&#39;snap_preview&#39;&gt;&lt;br /&gt;&lt;p style=&#34;text-align:justify;&#34;&gt;&lt;span style=&#34;color:#000000;&#34;&gt;In an interesting, not to say quixotic, attempt at repositioning, Gordon Brown, in an interview Â in the &lt;em&gt;&lt;a href=&#34;http://www.telegraph.co.uk/news/newstopics/politics/gordon-brown/6286070/Britains-economy-ready-to-bounce-back-says-Gordon-Brown.html&#34;&gt;Telegraph&lt;/a&gt;&lt;/em&gt; this morning, seeks to portray himself as a sunny optimist, in contrast to the doom-and-gloom mongers of the Conservative party.&lt;/span&gt;&lt;/p&gt;
&lt;p style=&#34;text-align:justify;&#34;&gt;&lt;span style=&#34;color:#000000;&#34;&gt;It is âsimply not trueâ, says Mr Brown, that tough economic times lie ahead.Â  No, says the PM, his drive for economic growth will pull the country out of recession; with Gordon at the helm, Labour are going to let the good times roll.&lt;/span&gt;&lt;/p&gt;
&lt;p style=&#34;text-align:justify;&#34;&gt;&lt;span style=&#34;color:#000000;&#34;&gt;Gratifying as it is to see this hitherto unsuspected Louis Armstrong side to the Prime Ministerâs personality, it is unlikely that his new line will cut much ice with an informed electorate.Â  The Treasuryâs own figures indicate that:&lt;/span&gt;&lt;/p&gt;
&lt;ul style=&#34;text-align:justify;&#34;&gt;
&lt;li&gt;&lt;span style=&#34;color:#000000;&#34;&gt;the social security bill will mount to almost Â£200 billion in four yearsâ time â almost twice the NHS budget;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span style=&#34;color:#000000;&#34;&gt;debt interest will rise to Â£63 billion per annum;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span style=&#34;color:#000000;&#34;&gt;the total cost of welfare and debt maintenance will amount to one-third of government expenditure.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p style=&#34;text-align:justify;&#34;&gt;&lt;span style=&#34;color:#000000;&#34;&gt;In the circumstances, itâs rather hard to see that the Tories are being anything other than totally realistic when they warn of hard years to come.Â Â  Giving a cheery whistle, as Gordon appears to be advising, isnât really going to help an awfulÂ lot.&lt;/span&gt;&lt;/p&gt;
Posted in Conservative Party, economy, Gordon Brown, Labour Party Tagged: Politics &lt;a rel=&#34;nofollow&#34; href=&#34;http://feeds.wordpress.com/1.0/gocomments/davidjonesmp.wordpress.com/4022/&#34;&gt;&lt;img alt=&#34;&#34; border=&#34;0&#34; src=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://feeds.wordpress.com/1.0/comments/davidjonesmp.wordpress.com/4022/">http://feeds.wordpress.com/1.0/comments/davidjonesmp.wordpress.com/4022/</a></span>&#34; /&gt;&lt;/a&gt; &lt;a rel=&#34;nofollow&#34; href=&#34;http://feeds.wordpress.com/1.0/godelicious/davidjonesmp.wordpress.com/4022/&#34;&gt;&lt;img alt=&#34;&#34; border=&#34;0&#34; src=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://feeds.wordpress.com/1.0/delicious/davidjonesmp.wordpress.com/4022/">http://feeds.wordpress.com/1.0/delicious/davidjonesmp.wordpress.com/4022/</a></span>&#34; /&gt;&lt;/a&gt; &lt;a rel=&#34;nofollow&#34; href=&#34;http://feeds.wordpress.com/1.0/gostumble/davidjonesmp.wordpress.com/4022/&#34;&gt;&lt;img alt=&#34;&#34; border=&#34;0&#34; src=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://feeds.wordpress.com/1.0/stumble/davidjonesmp.wordpress.com/4022/">http://feeds.wordpress.com/1.0/stumble/davidjonesmp.wordpress.com/4022/</a></span>&#34; /&gt;&lt;/a&gt; &lt;a rel=&#34;nofollow&#34; href=&#34;http://feeds.wordpress.com/1.0/godigg/davidjonesmp.wordpress.com/4022/&#34;&gt;&lt;img alt=&#34;&#34; border=&#34;0&#34; src=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://feeds.wordpress.com/1.0/digg/davidjonesmp.wordpress.com/4022/">http://feeds.wordpress.com/1.0/digg/davidjonesmp.wordpress.com/4022/</a></span>&#34; /&gt;&lt;/a&gt; &lt;a rel=&#34;nofollow&#34; href=&#34;http://feeds.wordpress.com/1.0/goreddit/davidjonesmp.wordpress.com/4022/&#34;&gt;&lt;img alt=&#34;&#34; border=&#34;0&#34; src=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://feeds.wordpress.com/1.0/reddit/davidjonesmp.wordpress.com/4022/">http://feeds.wordpress.com/1.0/reddit/davidjonesmp.wordpress.com/4022/</a></span>&#34; /&gt;&lt;/a&gt; &lt;img alt=&#34;&#34; border=&#34;0&#34; src=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://stats.wordpress.com/b.gif?host=davidjonesblog.com&#38;blog=5996455&#38;post=4022&#38;subd=davidjonesmp&#38;ref=&#38;feed=1">http://stats.wordpress.com/b.gif?host=davidjonesblog.com&#38;blog=5996455&#38;post=4022&#38;subd=davidjonesmp&#38;ref=&#38;feed=1</a></span>&#34; /&gt;&lt;/div&gt;]]&gt;&lt;/content:encoded&gt;
			&lt;wfw:commentRss&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://davidjonesblog.com/2009/10/10/sunny-gordon/feed/">http://davidjonesblog.com/2009/10/10/sunny-gordon/feed/</a></span>&lt;/wfw:commentRss&gt;
		&lt;slash:comments&gt;1&lt;/slash:comments&gt;
	
		&lt;media:content url=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://0.gravatar.com/avatar/aea1b4a642b604d87d34047223aab73b?s=96&#38;amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&#38;amp;r=G">http://0.gravatar.com/avatar/aea1b4a642b604d87d34047223aab73b?s=96&#38;amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D96&#38;amp;r=G</a></span>&#34; medium=&#34;image&#34;&gt;
			&lt;media:title type=&#34;html&#34;&gt;David Jones MP&lt;/media:title&gt;
		&lt;/media:content&gt;
	&lt;feedburner:origLink&gt;<span class="clickylink"><a target="new" rel="nofollow" href="http://davidjonesblog.com/2009/10/10/sunny-gordon/">http://davidjonesblog.com/2009/10/10/sunny-gordon/</a></span>&lt;/feedburner:origLink&gt;&lt;/item&gt;
	&lt;/channel&gt;
&lt;/rss&gt;
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use warnings;

use Test::More tests =&gt; 14;

use XML::Feed;
use File::Spec;


{
    my $rss = XML::Feed-&gt;parse&#40;
        File::Spec-&gt;catfile&#40;File::Spec-&gt;curdir&#40;&#41;, 
            &#34;t&#34;, &#34;samples&#34;, &#34;rss20-david-jones.xml&#34;
        &#41;
    &#41;;

    # TEST
    isa_ok&#40;$rss, &#39;XML::Feed::Format::RSS&#39;&#41;;
    my $rss_entry = &#40;$rss-&gt;entries&#41;[0];

    # TEST
    isa_ok&#40;$rss_entry, &#39;XML::Feed::Entry::Format::RSS&#39;&#41;;


    my $rss_content = $rss_entry-&gt;content;

    # TEST
    isa_ok&#40;$rss_content, &#39;XML::Feed::Content&#39;&#41;;

    # TEST
    is&#40;$rss_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;

    # TEST
    like&#40;$rss_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;

    # TEST
    like&#40;$rss_content-&gt;body, 
         qr{\A\Q&lt;div class=&#39;snap_preview&#39;&gt;&lt;br /&gt;&lt;p style=&#34;text-align:justify;&#34;&gt;&lt;span style=&#34;color:#000000;&#34;&gt;In an interesting, not to say quixotic},
         &#39;Contains HTML tags&#39;&#41;;

    unlike&#40;$rss-&gt;as_xml, qr{&#38;amp;lt;}, &#39;No double encoding&#39;&#41;;

    my $atom = $rss-&gt;convert&#40;&#39;Atom&#39;&#41;;

    # TEST
    isa_ok&#40;$atom, &#39;XML::Feed::Format::Atom&#39;&#41;;

    my $atom_entry = &#40;$atom-&gt;entries&#41;[0];

    # TEST
    isa_ok&#40;$atom_entry, &#39;XML::Feed::Entry::Format::Atom&#39;&#41;;

    my $atom_content = $atom_entry-&gt;content;

    # TEST
    isa_ok&#40;$atom_content, &#39;XML::Feed::Content&#39;&#41;;

    # TEST
    is&#40;$atom_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;

    # TEST
    like&#40;$atom_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;

    # TEST
    like&#40;$atom_content-&gt;body, 
        qr{\A\Q&#38;lt;div class=&#38;#39;snap_preview&#38;#39;&#38;gt;&#38;lt;br /&#38;gt;&#38;lt;p style=&#38;quot;text-align:justify;&#38;quot;&#38;gt;&#38;lt;span style=&#38;quot;color:#000000;&#38;quot;&#38;gt;In an interesting, not to say quixotic},
        &#39;Contains HTML tags&#39;&#41;;

    unlike&#40;$atom-&gt;as_xml, qr{&#38;amp;lt;}, &#39;No double encoding&#39;&#41;;
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;31&nbsp;08:11:22&nbsp;2009</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> simonw [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza">Hi Dave!<br>

<br>

Sorry it took me so long to respond, but I wasn't notified of your comment (god damn rt.cpan.org).<br>

<br>

On Sat Oct 10 13:15:19 2009, DAVECROSS wrote: <br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Aug 18 17:40:59 2009, SHLOMIF wrote: <br>
<div class="message-stanza open">&gt; &gt;  <br>

&gt; &gt; Hi Dave! <br>

&gt; &gt;  <br>

&gt; &gt; Please send me your test case. <br>
</div>&gt;  <br>

&gt; Right, here's a test case for the problem I discovered months ago. Sorry <br>

&gt; it's take me so long to do this. <br>

&gt;  <br>

&gt; Basically, if you convert the attached RSS 2.0 feed to Atom, then you <br>

&gt; end up with double-encoded HTML entities when you produce the XML output. <br>

&gt;  <br>
</div><br>

Thanks!&nbsp;I&nbsp;see it now.<br>

<br>

The attached patch fixes this problem (along with an extra test). It was caused by a strange XML::Atom behaviour. Please let me know if it works for you.<br>

<br>

Regards,<br>

<br>

-- Shlomi Fish<br>

<br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This leads to much brokenness when displaying it on a web page. See, for <br>

&gt; example, <span class="clickylink"><a target="new" rel="nofollow" href="http://mps.theplanetarium.org/test/">http://mps.theplanetarium.org/test/</a></span>. <br>

&gt;  <br>

&gt; And I suspect it's Shlomi's previous patch being overzealous. <br>

&gt;  <br>

&gt; Dave... <br>
</div><br>

<br>
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> XML-Feed-svn-3.diff</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;19:48:21&nbsp;2010</span>
    <span class="description">simonw [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza">Just to let the both of you know - neither patch is working for me. I'm digging into why as we speak.<br>

<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;09&nbsp;07:35:15&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Cc SHLOMIF added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;24&nbsp;06:36:21&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 07 19:48:21 2010, SIMONW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Just to let the both of you know - neither patch is working for me.
&gt; I&#39;m digging
&gt; into why as we speak.
</div>
How does the latest patch not work? What happens? Where have you tried
that? What happens exactly? How did you apply it?

Regards,

-- Shlomi Fish
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;20&nbsp;07:36:54&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jan 24 06:36:21 2010, SHLOMIF wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Jan 07 19:48:21 2010, SIMONW wrote:
<div class="message-stanza open">&gt; &gt; Just to let the both of you know - neither patch is working for me.
&gt; &gt; I&#39;m digging
&gt; &gt; into why as we speak.
</div>&gt; 
&gt; How does the latest patch not work? What happens? Where have you tried
&gt; that? What happens exactly? How did you apply it?
&gt; 
&gt; Regards,
&gt; 
&gt; -- Shlomi Fish
</div>
I&#39;ve said that over two months back. Meanwhile, this bug is not fixed,
while the patch works perfectly fine for Dave and me. If you don&#39;t have
time to work on this module, please give me &#40;SHLOMIF&#41; co-maintainership. 

Regards,

-- Shlomi Fish
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;22&nbsp;17:07:41&nbsp;2010</span>
    <span class="description">simonw [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> dave [...] dave.org.uk</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Mar 20 07:36:54 2010, SHLOMIF wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ve said that over two months back. Meanwhile, this bug is not fixed,
&gt; while the patch works perfectly fine for Dave and me. If you don&#39;t have
&gt; time to work on this module, please give me &#40;SHLOMIF&#41; 
&gt; co-maintainership. 
</div>
Hmm, I could have sworn I&#39;d patched and pushed the changes ages ago.

Please check SVN to make sure the current patch works for you - I was
having problems with the previous patch whereby stuff would come out in
odd encodings and I couldn&#39;t track down why for ages. This version seems
to work with all the test files sent so far.

Simon 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;22&nbsp;17:36:44&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> simonw [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Simon,

Thanks for finally replying.

On Mon Mar 22 17:07:41 2010, SIMONW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sat Mar 20 07:36:54 2010, SHLOMIF wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; I&#39;ve said that over two months back. Meanwhile, this bug is not fixed,
&gt; &gt; while the patch works perfectly fine for Dave and me. If you don&#39;t have
&gt; &gt; time to work on this module, please give me &#40;SHLOMIF&#41; 
&gt; &gt; co-maintainership. 
</div>&gt; 
&gt; Hmm, I could have sworn I&#39;d patched and pushed the changes ages ago.
&gt; 
</div>
Well, you didn&#39;t.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Please check SVN to make sure the current patch works for you - I was
&gt; having problems with the previous patch whereby stuff would come out in
&gt; odd encodings and I couldn&#39;t track down why for ages. This version seems
&gt; to work with all the test files sent so far.
&gt; 
</div>
16-convert.t that is attached to this message still fails and was part
of my patch:

{{{
shlomi:~/progs/perl/cpan/XML/Feed/trunk$ perl -Ilib t/16-convert.t 
1..17
ok 1 - The object isa XML::Feed::Format::RSS
ok 2 - The object isa XML::Feed::Entry::Format::RSS
ok 3 - The object isa XML::Feed::Content
ok 4 - Correct content type
ok 5 - Contains HTML tags
ok 6 - Contains HTML tags
ok 7 - The object isa XML::Feed::Format::Atom
ok 8 - The object isa XML::Feed::Entry::Format::Atom
ok 9 - The object isa XML::Feed::Content
ok 10 - Correct content type
ok 11 - Contains HTML tags
ok 12 - Contains HTML tags
ok 13 - The object isa XML::Feed::Format::RSS
ok 14 - The object isa XML::Feed::Entry::Format::RSS
ok 15 - Correct content type - No. 2
ok 16 - Found content type=html in Atom
not ok 17 - Atom content Followed by non-double encoded HTML.
#   Failed test &#39;Atom content Followed by non-double encoded HTML.&#39;
#   at t/16-convert.t line 97.
#                   &#39;&#38;amp;lt;div
class=&#38;amp;#39;snap_preview&#38;amp;#39;&#38;amp;gt;&#38;amp;lt;br
/&#38;amp;gt;&#38;amp;lt;p style=&#38;amp;quot;text-align:justify;&#38;amp;qu&#39;
#     doesn&#39;t match &#39;&#40;?-xism:\A&#38;lt;div
class=&#40;?:&#38;#39;|&#39;&#41;snap_preview&#40;?:&#38;#39;|&#39;&#41;&#41;&#39;
# Looks like you failed 1 test of 17.
}}}

I also notice you didn&#39;t include regressions tests in the recent
Subversion commits. Why?

Regards,

-- Shlomi Fish

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Simon 
</div></div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 16-convert.t</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use warnings;

use Test::More tests =&gt; 17;

use XML::Feed;
use File::Spec;


{
    my $rss = XML::Feed-&gt;parse&#40;
        File::Spec-&gt;catfile&#40;File::Spec-&gt;curdir&#40;&#41;, 
            &#34;t&#34;, &#34;samples&#34;, &#34;rss10-davorg-journal.xml&#34;
        &#41;
    &#41;;

    # TEST
    isa_ok&#40;$rss, &#39;XML::Feed::Format::RSS&#39;&#41;;
    my $rss_entry = &#40;$rss-&gt;entries&#41;[0];

    # TEST
    isa_ok&#40;$rss_entry, &#39;XML::Feed::Entry::Format::RSS&#39;&#41;;


    my $rss_content = $rss_entry-&gt;content;

    # TEST
    isa_ok&#40;$rss_content, &#39;XML::Feed::Content&#39;&#41;;

    # TEST
    is&#40;$rss_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;

    # TEST
    like&#40;$rss_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;

    # TEST
    like&#40;$rss_content-&gt;body, 
        qr{\A\Q&lt;p&gt;One of the first concrete outputs from the &lt;a href=&#34;http://www.enlightenedperl.org/&#34;&gt;Enlightened Perl Organisation&lt;/a&gt;\E}, 
        &#39;Contains HTML tags&#39;&#41;;


    my $atom = $rss-&gt;convert&#40;&#39;Atom&#39;&#41;;

    # TEST
    isa_ok&#40;$atom, &#39;XML::Feed::Format::Atom&#39;&#41;;

    my $atom_entry = &#40;$atom-&gt;entries&#41;[0];

    # TEST
    isa_ok&#40;$atom_entry, &#39;XML::Feed::Entry::Format::Atom&#39;&#41;;

    my $atom_content = $atom_entry-&gt;content;

    # TEST
    isa_ok&#40;$atom_content, &#39;XML::Feed::Content&#39;&#41;;

    # TEST
    is&#40;$atom_content-&gt;type, &#39;text/html&#39;, &#39;Correct content type&#39;&#41;;

    # TEST
    like&#40;$atom_content-&gt;body, qr&#40;&lt;|&#38;lt;&#41;, &#39;Contains HTML tags&#39;&#41;;

    # TEST
    like&#40;$atom_content-&gt;body, 
        qr{\A\Q&lt;p&gt;One of the first concrete outputs from the &lt;a href=&#34;http://www.enlightenedperl.org/&#34;&gt;Enlightened Perl Organisation&lt;/a&gt;\E}, 
        &#39;Contains HTML tags&#39;&#41;;
}

{
    my $rss = XML::Feed-&gt;parse&#40;
        File::Spec-&gt;catfile&#40;File::Spec-&gt;curdir&#40;&#41;,
            &#34;t&#34;, &#34;samples&#34;, &#34;rss20-david-jones.xml&#34;,
        &#41;
    &#41;;

    # TEST
    isa_ok&#40;$rss, &#39;XML::Feed::Format::RSS&#39;&#41;;
    my $rss_entry = &#40;$rss-&gt;entries&#41;[0];

    # TEST
    isa_ok&#40;$rss_entry, &#39;XML::Feed::Entry::Format::RSS&#39;&#41;;

    my $atom = $rss-&gt;convert&#40;&#39;Atom&#39;&#41;;

    # TEST
    is&#40;&#40;$atom-&gt;entries&#41;[0]-&gt;content-&gt;type, &#39;text/html&#39;, 
        &#39;Correct content type - No. 2&#39;&#41;;
    
    my $atom_text = $atom-&gt;as_xml&#40;&#41;;

    # TEST
    ok &#40;scalar&#40;$atom_text =~ m{&lt;content type=&#34;html&#34;&gt;}g&#41;, 
        &#34;Found content type=html in Atom&#34;,
    &#41;;

    # TEST
    like &#40;
        substr&#40;$atom_text, pos&#40;$atom_text&#41;, 128&#41;,
        qr{\A&#38;lt;div class=&#40;?:&#38;#39;|&#39;&#41;snap_preview&#40;?:&#38;#39;|&#39;&#41;},
        &#34;Atom content Followed by non-double encoded HTML.&#34;
    &#41;;
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;26&nbsp;06:36:30&nbsp;2010</span>
    <span class="description">DAVECROSS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 22 17:07:41 2010, SIMONW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sat Mar 20 07:36:54 2010, SHLOMIF wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; I&#39;ve said that over two months back. Meanwhile, this bug is not 
&gt; &gt; fixed, while the patch works perfectly fine for Dave and me. If you 
&gt; &gt; don&#39;t have time to work on this module, please give me &#40;SHLOMIF&#41; 
&gt; &gt; co-maintainership. 
</div>&gt; 
&gt; Hmm, I could have sworn I&#39;d patched and pushed the changes ages ago.
&gt; 
&gt; Please check SVN to make sure the current patch works for you - I was
&gt; having problems with the previous patch whereby stuff would come out 
&gt; in odd encodings and I couldn&#39;t track down why for ages. This version 
&gt; seems to work with all the test files sent so far.
</div>
Simon,

This has just blown up again:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.illusori.co.uk/perl/2010/04/25/mangled_ironman_feed.html">http://www.illusori.co.uk/perl/2010/04/25/mangled_ironman_feed.html</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://perlhacks.com/2010/04/ironman-and-xmlfeed.php">http://perlhacks.com/2010/04/ironman-and-xmlfeed.php</a></span>

I&#39;ve checked out the latest from SVN &#40;r160&#41; and there still seem to be
problems.

* Test t/16-convert.t is in MANIFEST but not in svn. There&#39;s a
16-convert-mult-categories.t but that seems to be a completely different
test.

* My two new data files &#40;t/samples/rss10-davorg-journal.xml and
t/samples/rss20-david-jones.xml&#41; are missing.

* Having added the missing files, I&#39;m getting test failures in
t/16-convert.t.

not ok 17 - Atom content Followed by non-double encoded HTML.

#   Failed test &#39;Atom content Followed by non-double encoded HTML.&#39;
#   at t/16-convert.t line 97.
#                   &#39;&#38;amp;lt;div
class=&#38;amp;#39;snap_preview&#38;amp;#39;&#38;amp;gt;&#38;amp;lt;br
/&#38;amp;gt;&#38;amp;lt;p style=&#38;amp;quot;text-align:justify;&#38;amp;qu&#39;
#     doesn&#39;t match &#39;&#40;?-xism:\A&#38;lt;div
class=&#40;?:&#38;#39;|&#39;&#41;snap_preview&#40;?:&#38;#39;|&#39;&#41;&#41;&#39;
# Looks like you failed 1 test of 17.
Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
Failed 1/17 subtests 

Hope that&#39;s useful. Let me know if I can be any help.

Cheers,

Dave...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;26&nbsp;11:31:21&nbsp;2011</span>
    <span class="description">DAVECROSS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m pretty sure this is all finally fixed in version 0.45.

Dave...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;26&nbsp;11:31:23&nbsp;2011</span>
    <span class="description">DAVECROSS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
