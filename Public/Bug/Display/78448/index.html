<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #78448 for XML-LibXML: chinese character force a SIGABRT in XS_XML__LibXML__parse_fh and kill perl</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #78448 for XML-LibXML: chinese character force a SIGABRT in XS_XML__LibXML__parse_fh and kill perl</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=XML-LibXML">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=XML-LibXML">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=XML-LibXML">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=XML-LibXML">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-LibXML">XML-LibXML CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">78448</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=XML-LibXML">XML-LibXML</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
wosch [...] freebsd.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-37350-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-37351-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




test-macos.xml<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1100608/578696/test-macos.xml">
Wed Jul 18 09:06:13 2012 (1.7k) by wosch [...] freebsd.org
</a>
</font></li>
</ul>


test.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1100608/578694/test.pl">
Wed Jul 18 09:06:13 2012 (617b) by wosch [...] freebsd.org
</a>
</font></li>
</ul>


test.xml<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1100608/578695/test.xml">
Wed Jul 18 09:06:13 2012 (1.1k) by wosch [...] freebsd.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=78448">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1100608" href="/Public/Bug/Display.html?id=78448#txn-1100608">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;18&nbsp;09:06:13&nbsp;2012</span>
    <span class="description">wosch [...] freebsd.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> chinese character force a SIGABRT in XS_XML__LibXML__parse_fh and kill perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Jul 2012 15:05:46 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-LibXML [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Wolfram Schneider &lt;wosch [...] FreeBSD.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1100608/578693/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/578693">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

one of my CGI scripts crashed when the user submitted chinese
characters. It turns out that a single chinese character crashes
the parse_fh&#40;&#41; function.

The error happens on all perl version up to 5.16, any OS and any
XML::LibXML version up to 2.0002.

gdb perl
GNU gdb 6.3.50-20050815 &#40;Apple version gdb-1708&#41; &#40;Thu Nov  3 21:59:02 UTC 2011&#41;
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type &#34;show copying&#34; to see the conditions.
There is absolutely no warranty for GDB.  Type &#34;show warranty&#34; for details.
This GDB was configured as &#34;x86_64-apple-darwin&#34;...Reading symbols for
shared libraries .... done

&#40;gdb&#41; run test.pl test-macos.xml
Starting program: /opt/local/bin/perl test.pl test-macos.xml
Reading symbols for shared libraries +++.......................... done
Reading symbols for shared libraries . done
Reading symbols for shared libraries . done
Reading symbols for shared libraries . done
Reading symbols for shared libraries . done
Reading symbols for shared libraries .... done
Running with XML::LibXML version: 1.84

Program received signal SIGABRT, Aborted.
0x00007fff8857682a in __kill &#40;&#41;
&#40;gdb&#41; bt
#0  0x00007fff8857682a in __kill &#40;&#41;
#1  0x00007fff90b3fb6c in __abort &#40;&#41;
#2  0x00007fff90b3c070 in __stack_chk_fail &#40;&#41;
#3  0x00000001004078bb in XS_XML__LibXML__parse_fh &#40;&#41;
#4  0x0000000100082abf in Perl_pp_entersub &#40;&#41;
#5  0x000000010007af06 in Perl_runops_standard &#40;&#41;
#6  0x000000010001c5b4 in perl_run &#40;&#41;
#7  0x0000000100000d7d in main &#40;&#41;
&#40;gdb&#41;


attached is a simple perl script and 2 xml files for testing. On
MacOS, it crashes with a single chinese character, on Linux it needs
some more padding characters to get the same effect.

-Wolfram

-- 
Wolfram Schneider &lt;wosch@FreeBSD.org&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://wolfram.schneider.org">http://wolfram.schneider.org</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1100608/578694/test.pl">Download test.pl</a><br />
<span class="downloadcontenttype">text/x-perl 617b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1100608/578695/test.xml">Download test.xml</a><br />
<span class="downloadcontenttype">text/xml 1.1k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1100608/578696/test-macos.xml">Download test-macos.xml</a><br />
<span class="downloadcontenttype">text/xml 1.7k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1100611" href="/Public/Bug/Display.html?id=78448#txn-1100611">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;18&nbsp;09:22:09&nbsp;2012</span>
    <span class="description">christian.glahn [...] lo-f.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #78448] chinese character force a SIGABRT in XS_XML__LibXML__parse_fh and kill perl </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Jul 2012 15:21:49 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-LibXML [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Christian Glahn &lt;christian.glahn [...] lo-f.at&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1100611/578699/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/578699">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">For clarification: Do parse_file&#40;&#41; and parse_string&#40;&#41; work? 

Christian

On 18 Jul 2012, at 15:06, wosch@freebsd.org via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Wed Jul 18 09:06:13 2012: Request 78448 was acted upon.
&gt; Transaction: Ticket created by wosch@freebsd.org
&gt;       Queue: XML-LibXML
&gt;     Subject: chinese character force a SIGABRT in XS_XML__LibXML__parse_fh and kill perl
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: &#40;no value&#41;
&gt;       Owner: Nobody
&gt;  Requestors: wosch@freebsd.org
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=78448">https://rt.cpan.org/Ticket/Display.html?id=78448</a></span> &gt;
&gt; 
&gt; 
&gt; Hi,
&gt; 
&gt; one of my CGI scripts crashed when the user submitted chinese
&gt; characters. It turns out that a single chinese character crashes
&gt; the parse_fh&#40;&#41; function.
&gt; 
&gt; The error happens on all perl version up to 5.16, any OS and any
&gt; XML::LibXML version up to 2.0002.
&gt; 
&gt; gdb perl
&gt; GNU gdb 6.3.50-20050815 &#40;Apple version gdb-1708&#41; &#40;Thu Nov  3 21:59:02 UTC 2011&#41;
&gt; Copyright 2004 Free Software Foundation, Inc.
&gt; GDB is free software, covered by the GNU General Public License, and you are
&gt; welcome to change it and/or distribute copies of it under certain conditions.
&gt; Type &#34;show copying&#34; to see the conditions.
&gt; There is absolutely no warranty for GDB.  Type &#34;show warranty&#34; for details.
&gt; This GDB was configured as &#34;x86_64-apple-darwin&#34;...Reading symbols for
&gt; shared libraries .... done
&gt; 
&gt; &#40;gdb&#41; run test.pl test-macos.xml
&gt; Starting program: /opt/local/bin/perl test.pl test-macos.xml
&gt; Reading symbols for shared libraries +++.......................... done
&gt; Reading symbols for shared libraries . done
&gt; Reading symbols for shared libraries . done
&gt; Reading symbols for shared libraries . done
&gt; Reading symbols for shared libraries . done
&gt; Reading symbols for shared libraries .... done
&gt; Running with XML::LibXML version: 1.84
&gt; 
&gt; Program received signal SIGABRT, Aborted.
&gt; 0x00007fff8857682a in __kill &#40;&#41;
&gt; &#40;gdb&#41; bt
&gt; #0  0x00007fff8857682a in __kill &#40;&#41;
&gt; #1  0x00007fff90b3fb6c in __abort &#40;&#41;
&gt; #2  0x00007fff90b3c070 in __stack_chk_fail &#40;&#41;
&gt; #3  0x00000001004078bb in XS_XML__LibXML__parse_fh &#40;&#41;
&gt; #4  0x0000000100082abf in Perl_pp_entersub &#40;&#41;
&gt; #5  0x000000010007af06 in Perl_runops_standard &#40;&#41;
&gt; #6  0x000000010001c5b4 in perl_run &#40;&#41;
&gt; #7  0x0000000100000d7d in main &#40;&#41;
&gt; &#40;gdb&#41;
&gt; 
&gt; 
&gt; attached is a simple perl script and 2 xml files for testing. On
&gt; MacOS, it crashes with a single chinese character, on Linux it needs
&gt; some more padding characters to get the same effect.
&gt; 
&gt; -Wolfram
&gt; 
&gt; -- 
&gt; Wolfram Schneider &lt;wosch@FreeBSD.org&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://wolfram.schneider.org">http://wolfram.schneider.org</a></span>
&gt; 
&gt; &lt;test.pl&gt;&lt;chinese&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt; 
&gt;   &lt;characters&gt;主題&lt;/characters&gt;
&gt; 
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt; 
&gt;    &lt;characters&gt;關鍵詞&lt;/characters&gt;
&gt; 
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt;  &lt;blob&gt;foooooooooooooooooooooooooooooooooooooooooooooooooooo&lt;/blob&gt;
&gt; &lt;/chinese&gt;
&gt; &lt;chinese&gt;
&gt; &lt;characters&gt;題&lt;/characters&gt;
&gt; &lt;blob&gt;blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob blob&lt;/blob&gt;
&gt; &lt;/chinese&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1100614" href="/Public/Bug/Display.html?id=78448#txn-1100614">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;18&nbsp;09:22:11&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1100618" href="/Public/Bug/Display.html?id=78448#txn-1100618">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;18&nbsp;10:01:37&nbsp;2012</span>
    <span class="description">wosch [...] freebsd.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #78448] chinese character force a SIGABRT in XS_XML__LibXML__parse_fh and kill perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Jul 2012 16:01:11 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-LibXML [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Wolfram Schneider &lt;wosch [...] FreeBSD.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1100618/578705/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/578705">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 441b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 18 July 2012 15:22, Christian Glahn via RT
&lt;bug-XML-LibXML@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=78448">https://rt.cpan.org/Ticket/Display.html?id=78448</a></span> &gt;
&gt;
&gt; For clarification: Do parse_file&#40;&#41; and parse_string&#40;&#41; work?
</div>
yepp, both works fine.

I guess the bug is due a wrong IO handle character set check. Please
note that the file descriptor in the test.pl script has the layer
&#39;:utf8&#39;. If you set it to &#34;raw&#34; it will not crash.

-Wolfram

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Christian
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1100647" href="/Public/Bug/Display.html?id=78448#txn-1100647">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;18&nbsp;12:26:33&nbsp;2012</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1100647/578723/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/578723">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Wolfram,

On Wed Jul 18 10:01:37 2012, wosch@freebsd.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 18 July 2012 15:22, Christian Glahn via RT
&gt; &lt;bug-XML-LibXML@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=78448">https://rt.cpan.org/Ticket/Display.html?id=78448</a></span> &gt;
&gt; &gt;
&gt; &gt; For clarification: Do parse_file&#40;&#41; and parse_string&#40;&#41; work?
</div>&gt; 
&gt; yepp, both works fine.
&gt; 
&gt; I guess the bug is due a wrong IO handle character set check. Please
&gt; note that the file descriptor in the test.pl script has the layer
&gt; &#39;:utf8&#39;. If you set it to &#34;raw&#34; it will not crash.
&gt; 
</div>
In that case, please see:

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/module/XML::LibXML#ENCODINGS-SUPPORT-IN-XML::LIBXML">https://metacpan.org/module/XML::LibXML#ENCODINGS-SUPPORT-IN-XML::LIBXML</a></span>

Namely item #1, which reads:

[QUOTE]
Do NOT apply any encoding-related PerlIO layers &#40;:utf8 or
:encoding&#40;...&#41;&#41; to file handles that are an input for the parses or an
output for a serializer of &#40;full&#41; XML documents. This is because the
conversion of the data to/from the internal character representation is
provided by libxml2 itself which must be able to enforce the encoding
specified by the &lt;?xml version=&#34;1.0&#34; encoding=&#34;...&#34;?&gt; declaration. Here
is an example to follow:
[/QUOTE]

Why are yuo using the &#34;:utf8&#34; layer in the first place? Perhaps the
crash should be fixed though somehow.

Regards,

-- Shlomi Fish
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.423775</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
