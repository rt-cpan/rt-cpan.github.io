<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #72469 for PPIx-Regexp: No modifiers from perl 5.14 &#34;use re &#39;/flags&#39; pragma</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #72469 for PPIx-Regexp: No modifiers from perl 5.14 &#34;use re &#39;/flags&#39; pragma</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/PPIx-Regexp/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/PPIx-Regexp/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/PPIx-Regexp/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/PPIx-Regexp/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please email the <a href="mailto:wyant@cpan.org">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/PPIx-Regexp">PPIx-Regexp CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">72469</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/PPIx-Regexp/Active/">PPIx-Regexp</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mjgardner [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-229860-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
0.021</li>
<li>
0.021_11</li>
</ul>
    </td>
  </tr>
  <tr id="CF-229861-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;16&nbsp;12:26:43&nbsp;2011</span>
    <span class="description">mjgardner [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> No modifiers from perl 5.14 &#34;use re &#39;/flags&#39; pragma</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">PPIx::Regexp doesn&#39;t report modifiers applied by the Perl 5.14 &#34;use re
&#39;/flags&#39;&#34; pragma, e.g. &#34;use re &#39;/xms&#39;&#34;.  This is related to RT#72151
reported on Perl::Critic, but I&#39;m adding the bug here so it&#39;s documented
in the right place.  I&#39;ve attached a small test script.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> re_test.pl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/env perl

use 5.014;
use re &#39;/xms&#39;;
use PPIx::Regexp;

my $regexp = &#39;^testing .* 1 2 3&#39;;
my $match = &lt;&lt;&#39;END_MATCH&#39;;
hello world
testing something
123
END_MATCH

say &#34;implied matched&#34; if $match =~ /$regexp/;
my $ppixr = PPIx::Regexp-&gt;new&#40;&#34;/$regexp/&#34;&#41;;
my %mods = $ppixr-&gt;modifier-&gt;modifiers;
while &#40;my &#40;$mod, $value&#41; = each %mods&#41; { say &#34;implied $mod $value&#34; }    

say &#34;explicit matched&#34; if $match =~ /$regexp/xms;
my $ppixr = PPIx::Regexp-&gt;new&#40;&#34;/$regexp/xms&#34;&#41;;
my %mods = $ppixr-&gt;modifier-&gt;modifiers;
while &#40;my &#40;$mod, $value&#41; = each %mods&#41; { say &#34;explicit $mod $value&#34; }    
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;16&nbsp;12:28:38&nbsp;2011</span>
    <span class="description">mjgardner [...] cpan.org -  Reference to ticket #72151 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;16&nbsp;16:47:34&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Dependency by ticket #72151 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;16&nbsp;17:22:04&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Nov 16 12:26:43 2011, MJGARDNER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; PPIx::Regexp doesn&#39;t report modifiers applied by the Perl 5.14 &#34;use re
&gt; &#39;/flags&#39;&#34; pragma, e.g. &#34;use re &#39;/xms&#39;&#34;.  This is related to RT#72151
&gt; reported on Perl::Critic, but I&#39;m adding the bug here so it&#39;s documented
&gt; in the right place.  I&#39;ve attached a small test script.
</div>
Thank you for your report.

I debated about requeueing 72151 to the PPIx-Regexp queue, and then
shoving it back in the Perl-Critic queue once PPIx-Regexp was up to
snuff, but I was afraid it would get lost in the shuffle. But the Right
Thing To Do is have a ticket against PPIx-Regexp, so now there is one.

That said, PPIx::Regexp is a static analyzer, and will never detect
implicit modifiers in the script where it is running. But even though
that makes this technically a reject, in context the ticket is needed,
and will keep it open at least until I think the PPIx::Regexp part of
the job is done.

The implementation path being taken is to:

1&#41; Provide a way to tell PPIx::Regexp what implicit modifiers are in
effect at the time the object is instantiated;

2&#41; Once this exists, have Perl::Critic figure out what is in scope at
the regular expression under analysis, and feed those to PPIx::Regexp.

Because I have committed to PPIx::Regexp being round-trip safe, the
default modifiers can never show up in $re-&gt;modifiers&#40;&#41;. That object
_must_ represent the modifiers actually present in the regular
expression. So what has actually happened is that there is an argument
to new&#40;&#41; to feed in the required defaults &#40;and the smarts to take a
bunch of them and figure out what the defaults actually are&#41;, and a
separate method to say whether a given modifier is asserted, whether it
is explicit or implicit.

The PPIx::Regexp part of the planned functionality is already mostly in
PPIx::Regexp 0.021_10 - at any rate the interface is there. The 0.021_11
release was fixing a misunderstanding &#40;spelled b-u-g&#41; about what happens
when you say &#39;no re /u&#39; &#40;or any other of the new match semantic
modifiers&#41;. My original plan was to wait a week after the most-recent
development release, and then put out version 0.022. But CPAN testers
has yet to record any tests against either of the development releases,
so I will just make a judgment call the middle of next week about how
thoroughly it has all been tested, and release when I&#39;m happy.

The Perl::Critic modifications based on the PPIx::Regexp modifications
are also already coded up, but I am not going to commit anything to the
SVN repository until the production PPIx::Regexp is out there.

The Perl::Critic changes involve a new method on Perl::Critic::Document
to find out if element Bravo is in-scope from element Alpha. This will
benefit other tickets in the queue, and it goes on the document in case
caching becomes necessary. The other change is machinery in the
ppix_regexp_from_element&#40;&#41; method to find all the relevant &#39;use re&#39;
elements, and spoon-feed them to PPIx::Regexp-&gt;new&#40;&#41;. At the outset I
was worried about wasted motion, but the ppix_regexp_from_element&#40;&#41;
method is cached, so you will only grovel through the document once for
any regular expression no matter how many policies want to take a look
at it.

Tom
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;16&nbsp;17:22:04&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;25&nbsp;12:14:34&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">PPIx-Regexp 0.022 went to CPAN yesterday &#40;24-Nov-2011 23:45 UT&#41;. This
has the fixes I intend to make to support Perl::Critic. I intend to
commit the Perl::Critic changes in a day or two, once the PPIx::Regexp
changes have a chance to flush through the system.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;25&nbsp;12:14:35&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;14&nbsp;10:15:08&nbsp;2011</span>
    <span class="description">wyant [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
