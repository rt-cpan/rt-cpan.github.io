<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #58788 for Test-Harness: Re: Perl 5.12.1 build report</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #58788 for Test-Harness: Re: Perl 5.12.1 build report</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Test-Harness/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Test-Harness/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Test-Harness/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Test-Harness/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Test-Harness">Test-Harness CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">58788</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">deleted</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Test-Harness/Active/">Test-Harness</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mark [...] theberrymans.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-31430-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-31431-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;24&nbsp;15:03:55&nbsp;2010</span>
    <span class="description">mark [...] theberrymans.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> vmsperl [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: Perl 5.12.1 build report</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 24 Jun 2010 13:03:37 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Craig A. Berry&#34; &lt;craigberry [...] mac.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Berryman &lt;mark [...] theberrymans.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 24, 2010, at 12:08 PM, Craig A. Berry wrote:
.
.
.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt;&gt; 4. Too many extensions like to use labels that differ only in case or reference external libraries that are built with /names=&#40;as_is,short&#41;.  By editing 3 include files in Perl, extern.h, perl.h, and xsub.h in PERL_ROOT:[.LIB.VMS_arch.5_12_1.CORE], to set the NAMES pragma to uppercase at the beginning of the file and restore it at the end, I am able to modify the generated DESCRIP.MMS file of the extension being built to include the names=&#40;as_is,short&#41; switch and build the extension without difficulty.  I believe this would be worth doing as part of the standard installation.  It would also be nice if there were an option to add this switch into the generated DESCRIP.MMS automatically.
</div>&gt; 
&gt; You can get /NAMES=AS_IS by configuring the Perl build with:
&gt; 
&gt; $ @configure -&#34;Dbe_case_sensitive=Y&#34; -&#34;des&#34;
</div>
I tried this once.  The build fails to even build miniperl.  Here I can reproduce this fairly quickly...

Link /NoTrace/NoMap/Trace/Exe=MINIPERL.EXE miniperlmain.obj, libperlmini.olb/Library/Include=globals  ,[]crtl.opt/Options
%ILINK-W-NOSUCHMOD, module GLOBALS not found
        in library USERS:[BERRYMAN.PERL-5_12_1]LIBPERLMINI.OLB;1
%ILINK-W-NUDFSYMS, 8 undefined symbols:
%ILINK-I-UDFSYM,        lib$find_image_symbol
%ILINK-I-UDFSYM,        lib$initialize
%ILINK-I-UDFSYM,        lib$rename_file
%ILINK-I-UDFSYM,        sys$filescan
%ILINK-I-UDFSYM,        sys$get_security
%ILINK-I-UDFSYM,        sys$getdviw
%ILINK-I-UDFSYM,        sys$set_security
%ILINK-I-UDFSYM,        sys$sigprc

The missing GLOBALS module is caused by the fact that, when built on an ODS-5 disk, the filenames are all lowercase so they are entered into the library in lowercase.  This doesn&#39;t happen when built on an ODS-2 disk, of course, but the rest of the errors do.  At least some of the errors are caused by VMS.C undefining what it learned from the system include files and then redefining without the lowercase to uppercase definition the include files do.  Here is an extract from the MMS file I use to build libtidy, which is required by HTML::Tidy.  It addresses the first problem regardless of what type of build disk is being used.

.c.obj :
        @ if f$parse&#40;f$search&#40;&#34;$&#40;MMS$SOURCE&#41;&#34;&#41;,,,&#34;NAME&#34;&#41; .nes. f$edit&#40;f$parse&#40;f$search&#40;&#34;$&#40;MMS$SOURCE&#41;&#34;&#41;,,,&#34;NAME&#34;&#41;,&#34;UPCASE&#34;&#41; then rename $&#40;MMS$SOURCE&#41; &#39;f$edit&#40;&#34;$&#40;MMS$SOURCE&#41;&#34;,&#34;UPCASE&#34;&#41;
        $&#40;CC&#41; $&#40;DBGOPT&#41; $&#40;CFLAGS&#41; $&#40;MMS$SOURCE&#41;

.obj.olb :
        $&#40;LIBR&#41;$&#40;LIBRFLAGS&#41; $&#40;MMS$TARGET&#41; $&#40;MMS$SOURCE&#41;

CFLAGS = /NAMES=&#40;AS_IS,SHORT&#41;/FLOAT=IEEE/IEEE=DENORM/OBJ=$&#40;MMS$TARGET_NAME&#41;/INCLUDE=&#40;[-.INCLUDE],[]&#41;

!++
!   Complete application - default build item
!==

COMPLETE_APPLICATION depends_on -
        libtidy.olb&#40;access&#41;,-
        libtidy.olb&#40;alloc&#41;,-
        libtidy.olb&#40;attrask&#41;,-
        libtidy.olb&#40;attrdict&#41;,-
        ...

All this does is tell MMS that, when processing a .C file into a .OBJ file, check to see if the filename is uppercase.  If not, rename it so it is.  The syntax at COMPLETE_APPLICATION tells MMS to compare the module in the library to the source and rebuild it if it has changed but it only works if the module names in the library are all uppercase &#40;otherwise it aborts with an &#34;action did not update target&#34; error&#41;.  Would this help make Perl any more independent of the type of build disk being used?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; xsubpp should do its own name shortening, but that can cause trouble with external libraries.  I&#39;d consider making /NAMES=&#40;AS_IS,SHORTENED&#41; the default for 5.14.0, but need to give some thought to what will break.
</div>
xsubpp seems to shorten names declared in the XS file but it doesn&#39;t seem to touch names that are simply references to something external.  In the list of extensions I gave, there are several instances where some names are shortened and others are not.  This is probably a good thing because I don&#39;t know of anything else that uses the same shortening algorithm used in Perl.  By using /names=&#40;as_is,short&#41; in the extension build process, the names shortened by xsubpp are ignored but the names referencing the external library get shortened the same way they were when the library was built.

The difficulty with compatibility is why I suggested continuing to build Perl as all uppercase but modifying the Perl include files to add a names pragma.  That way, it doesn&#39;t matter how the program referencing Perl is being built, it still gets all of the Perl references in the correct case.  It also means that the MMS files built by makefile.pl when building extensions could include /names=&#40;as_is,short&#41; by default.  The only remaining issue I know of then becomes whether you include a statement like /define=&#34;boot_XML__Parser__Expat=BOOT_XML__PARSER__EXPAT&#34; in the build file or handle it in the dlsym code.

Mark Berryman
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;10&nbsp;13:19:08&nbsp;2010</span>
    <span class="description">andy [...] hexten.net -  Ticket deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
