<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #20418 for File-Find-Rule: File::Find::Rule is not taint-safe</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #20418 for File-Find-Rule: File::Find::Rule is not taint-safe</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=File-Find-Rule">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=File-Find-Rule">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=File-Find-Rule">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=File-Find-Rule">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/File-Find-Rule">File-Find-Rule CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">20418</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=File-Find-Rule">File-Find-Rule</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
zev [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-12796-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-12797-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Rule.pm.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/264082/115305/Rule.pm.diff">
Tue Nov 14 11:06:54 2006 (615b) by dmuey [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=20418">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-221871" href="/Public/Bug/Display.html?id=20418#txn-221871">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;11&nbsp;13:46:10&nbsp;2006</span>
    <span class="description">zev-cpan [...] strangersgate.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> File::Find::Rule is not taint-safe</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/221871/90902/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/90902">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 215b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">To make File::Find::Rule taint-safe, it would require the ability to set
the taint options and pass them to the find call.  I&#39;d be happy to write
the code, but I don&#39;t know the correct way to pass options to ::Rule.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-264082" href="/Public/Bug/Display.html?id=20418#txn-264082">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;14&nbsp;11:06:53&nbsp;2006</span>
    <span class="description">dmuey [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/264082/115302/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/115302">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 51b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This patch makes it work when in taint mode, HTH :&#41;
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/264082/115305/Rule.pm.diff">Download Rule.pm.diff</a><br />
<span class="downloadcontenttype">text/x-diff 615b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- /usr/lib/perl5/site_perl/5.8.7/File/Find/Rule.pm.orig	2006-11-13 22:36:22.000000000 -0600
+++ /usr/lib/perl5/site_perl/5.8.7/File/Find/Rule.pm	2006-11-13 22:36:50.000000000 -0600
@@ -578,6 +578,9 @@
 
     my $sub = eval &#34;$code&#34; or die &#34;compile error &#39;$code&#39; $@&#34;;
     my $cwd = getcwd;
+    $cwd =~ /&#40;.*&#41;/;
+    $cwd = $1;
+
     for my $path &#40;@_&#41; {
         # $topdir is used for relative and maxdepth
         $topdir = $path;
@@ -587,6 +590,7 @@
           unless $topdir eq &#39;/&#39;;
         $self-&gt;_call_find&#40; { %{ $self-&gt;{extras} }, wanted =&gt; $sub }, $path &#41;;
     }
+
     chdir $cwd;
 
     return @found;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-264083" href="/Public/Bug/Display.html?id=20418#txn-264083">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;14&nbsp;11:06:56&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-282245" href="/Public/Bug/Display.html?id=20418#txn-282245">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;19:05:11&nbsp;2007</span>
    <span class="description">GWOLF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> GWOLF [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/282245/126682/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/126682">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This bug was reported as well in the Debian BTS
&#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=406205&#41;">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=406205&#41;</a></span> - I&#39;m pasting
here the user&#39;s report, as well as his proposed patch:

On etch, the taint mode won&#39;t work:

$ perl -MFile::Find::Rule -Tle &#39;$rule=File::Find::Rule-&gt;new-&gt;extras&#40;{
untaint =&gt; 1 }&#41;-&gt;start&#40;$ARGV[0]&#41;; while &#40;$f = $rule-&gt;match &#41; { print $f;
}&#39; .
Insecure dependency in chdir while running with -T switch at
/usr/share/perl5/File/Find/Rule.pm line 591.

This _will_ render alls scripts, program and applications
using taint mode and this module unusable.

The bug is listed at CPAN for about 2 months now:
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=20418">http://rt.cpan.org/Public/Bug/Display.html?id=20418</a></span>
However, the untainting in that patch is just a slob job.
Mine does real untainting.


Patch &#40;taken from working version 0.28 from sarge&#41;:
--- Rule.pm.030 2007-01-09 16:10:53.000000000 +0100
+++ Rule.pm.030.fixed   2007-01-09 16:10:53.000000000 +0100
@@ -575,6 +575,12 @@

     my $sub = eval &#34;$code&#34; or die &#34;compile error &#39;$code&#39; $@&#34;;
     my $cwd = getcwd;
+    # Untaint it
+    if &#40; $cwd =~ qr|^&#40;[-+@\w./]+&#41;$| &#41; {
+        $cwd = $1;
+    } else {
+        die &#34;Couldn&#39;t untaint \$cwd: [$cwd]&#34;;
+    }
     for my $path &#40;@_&#41; {
         # $topdir is used for relative and maxdepth
         $topdir = $path;


-- System Information:
Debian Release: 4.0
  APT prefers testing
  APT policy: &#40;700, &#39;testing&#39;&#41;, &#40;500, &#39;unstable&#39;&#41;
Architecture: i386 &#40;i686&#41;
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.18-3-686
Locale: LANG=en_GB, LC_CTYPE=en_GB &#40;charmap=ISO-8859-15&#41;

Versions of packages libfile-find-rule-perl depends on:
ii  libnumber-compare-perl        0.01-4     Perform numeric comparisons
in Per
ii  libtext-glob-perl             0.07-1     Match globbing patterns
against te
ii  perl                          5.8.8-7    Larry Wall&#39;s Practical
Extraction 
ii  perl-modules                  5.8.8-7    Core Perl modules

libfile-find-rule-perl recommends no packages.

-- no debconf information
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-282248" href="/Public/Bug/Display.html?id=20418#txn-282248">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;09&nbsp;19:07:34&nbsp;2007</span>
    <span class="description">GWOLF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/282248/126685/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/126685">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">And I&#39;m also copying my reply to the user&#39;s bug report in Debian, of course:

tag 406205 + upstream
severity 406205 minor
thanks

Wolfgang Schemmel dijo [Tue, Jan 09, 2007 at 04:17:38PM +0100]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On etch, the taint mode won&#39;t work:
&gt;
&gt; $ perl -MFile::Find::Rule -Tle &#39;$rule=File::Find::Rule-&gt;new-&gt;extras&#40;{
</div>untaint =&gt; 1 }&#41;-&gt;start&#40;$ARGV[0]&#41;; while &#40;$f = $rule-&gt;match &#41; { print $f;
}&#39; .
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Insecure dependency in chdir while running with -T switch at
</div>/usr/share/perl5/File/Find/Rule.pm line 591.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; This _will_ render alls scripts, program and applications
&gt; using taint mode and this module unusable.
&gt;
&gt; The bug is listed at CPAN for about 2 months now:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=20418">http://rt.cpan.org/Public/Bug/Display.html?id=20418</a></span>
&gt; However, the untainting in that patch is just a slob job.
&gt; Mine does real untainting.
</div>
Umh... I&#39;m not sure I like this. I think the taint mode _is_ working
correctly here - You are getting information from outside your
program&#39;s direct control &#40;the result of getcwd&#41;, and that perfectly
qualifies as tainting. And, although you include a check against a
regular expression, AFAICT it&#39;s a pretty arbitrary one:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;      my $cwd = getcwd;
&gt; +    # Untaint it
&gt; +    if &#40; $cwd =~ qr|^&#40;[-+@\w./]+&#41;$| &#41; {
&gt; +        $cwd = $1;
&gt; +    } else {
&gt; +        die &#34;Couldn&#39;t untaint \$cwd: [$cwd]&#34;;
&gt; +    }
</div>
Many users &#40;although it&#39;s against the Unix culture&#41; use spaces inside
files and directories &#40;i.e. many of my users have their &#34;My Documents&#34;
Windows directory backed up in my server&#41;. Or filenames with all kinds
of diacritical marks on them, which would fail your test. But still,
you are not untainting the information - you are just giving a
hopefully correct pattern, still subject to containing wrong
information.

If anything, I would recommend changing the module&#39;s behaviour in a
way that the user should specify that he _knows_ some taintedness will
enter this way &#40;although very probably benign, system-generated
taintedness&#41;, i.e., invoking this way &#40;for the documentation&#39;s first
example&#41;:

my @subdirs = File::Find::Rule-&gt;directory&#40;untaint=&gt;1&#41;-&gt;in&#40; $directory &#41;;

PS- I&#39;m following up this report to the upstream bug you mentioned, as
it belongs to upstream development and not in Debian.

Greetings,

--
Gunnar Wolf - gwolf@gwolf.org - &#40;+52-55&#41;5623-0154 / 1451-2244
PGP key 1024D/8BB527AF 2001-10-23
Fingerprint: 0C79 D2D1 2C4E 9CE4 5973  F800 D80E F35A 8BB5 27AF
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-327647" href="/Public/Bug/Display.html?id=20418#txn-327647">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;19&nbsp;12:19:24&nbsp;2007</span>
    <span class="description">RCLAMP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/327647/150434/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/150434">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 172b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The next release, currently under testing, will be taint-safe by virtue
of being based around File::Next rather than File::Find.

-- 
Richard Clamp &lt;richardc@unixbeard.net&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-617620" href="/Public/Bug/Display.html?id=20418#txn-617620">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;12&nbsp;10:08:00&nbsp;2009</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/617620/313828/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/313828">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 801b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jun 19 12:19:24 2007, RCLAMP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The next release, currently under testing, will be taint-safe by 
</div>virtue
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; of being based around File::Next rather than File::Find.
</div>
OK, it&#39;s 2009 - is there an update on the promised fix?

If the &#39;next release&#39; isn&#39;t finished, it occurs to me that extras&#40;&#41; 
supplies the necessary information to File::Find; all File::Find:Rule 
needs to do is look inside the options hash and obey untaint &#38; 
untaint_pattern &#40;defaulting the latter as FileFind does to qr|^&#40;[-
+@\w./]+&#41;$|. 

E.G. replace the chdir at ~ line 590 with:

    if&#40; $self-&gt;{extras}{untaint} &#41; {
        $cwd =~ &#40; $self-&gt;{extras}{untaint_pattern} || qr|^&#40;[-+@\w./]+&#41;
$| &#41;;
        $cwd = $1;
    }
    chdir $cwd;

This should solve 90% of the problems - for extra credit, one could do 
untaint_skip as well.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-698362" href="/Public/Bug/Display.html?id=20418#txn-698362">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;27&nbsp;18:02:22&nbsp;2009</span>
    <span class="description">RCLAMP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/698362/360129/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/360129">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 132b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">0.31 just released to CPAN makes it as taint-unsafe as the underlying
File::Find module.

-- 
Richard Clamp &lt;richardc@unixbeard.net&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-698364" href="/Public/Bug/Display.html?id=20418#txn-698364">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;27&nbsp;18:02:24&nbsp;2009</span>
    <span class="description">RCLAMP [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.499656</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
