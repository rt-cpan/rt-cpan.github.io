<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #32732 for YAML-Tiny: [PATCH] Support for tied hash &#40;thus ordered data&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #32732 for YAML-Tiny: [PATCH] Support for tied hash &#40;thus ordered data&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/YAML-Tiny/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/YAML-Tiny/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/YAML-Tiny/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/YAML-Tiny/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/YAML-Tiny">YAML-Tiny CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">32732</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/YAML-Tiny/Active/">YAML-Tiny</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
DAMS [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-39260-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39261-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;06:49:08&nbsp;2008</span>
    <span class="description">DAMS [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Support for tied hash &#40;thus ordered data&#41;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi.

This patch allows to use a provided module name to create tied hashes and use them when 
loading a yaml string. That way, the data order can be preserved. The pach includes more POD 
doc.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> YAML-Tiny-1.25_TieHash.patch</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Only in YAML-Tiny-1.25: Makefile
Only in YAML-Tiny-1.25: blib
diff -ru YAML-Tiny-1.25_old/lib/YAML/Tiny.pm YAML-Tiny-1.25/lib/YAML/Tiny.pm
--- YAML-Tiny-1.25_old/lib/YAML/Tiny.pm	2008-01-28 16:39:05.000000000 +0700
+++ YAML-Tiny-1.25/lib/YAML/Tiny.pm	2008-01-28 18:45:54.000000000 +0700
@@ -14,6 +14,18 @@
 		};
 }
 
+our $TieHashModule = undef;
+
+# used to create a hashref, possibly using hash ties &#40;for instance, to get ordered hash&#41;
+sub _create_hashref {
+	$TieHashModule or return {};
+	eval &#40;&#34;require $TieHashModule&#34;&#41;;
+	$@ and die &#34;YAML::Tiny failed requiring &#39;$TieHashModule&#39;, specified to be used as a hash tie&#34;;
+	my %hash;
+	tie %hash, $TieHashModule;
+	return \%hash;
+}
+
 my $ESCAPE_CHAR = &#39;[\\x00-\\x08\\x0b-\\x0d\\x0e-\\x1f\&#34;\n]&#39;;
 
 # Escapes for unprintable characters
@@ -100,7 +112,7 @@
 
 		} elsif &#40; $lines[0] =~ /^&#40;\s*&#41;\w/ &#41; {
 			# A hash at the root
-			my $document = { };
+			my $document = _create_hashref&#40;&#41;;
 			push @$self, $document;
 			$self-&gt;_read_hash&#40; $document, [ length&#40;$1&#41; ], \@lines &#41;;
 
@@ -196,7 +208,7 @@
 			# Inline nested hash
 			my $indent2 = length&#40;&#34;$1&#34;&#41;;
 			$lines-&gt;[0] =~ s/-/ /;
-			push @$array, { };
+			push @$array, _create_hashref&#40;&#41;;
 			$self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, $indent2 ], $lines &#41;;
 
 		} elsif &#40; $lines-&gt;[0] =~ /^\s*\-&#40;\s*&#41;&#40;.+?&#41;\s*$/ &#41; {
@@ -222,7 +234,7 @@
 				}
 
 			} elsif &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;\w/ &#41; {
-				push @$array, { };
+				push @$array, _create_hashref&#40;&#41;;
 				$self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, length&#40;&#34;$1&#34;&#41; ], $lines &#41;;
 
 			} else {
@@ -279,7 +291,7 @@
 					# Null hash entry
 					$hash-&gt;{$key} = undef;
 				} else {
-					$hash-&gt;{$key} = {};
+					$hash-&gt;{$key} = _create_hashref&#40;&#41;;
 					$self-&gt;_read_hash&#40; $hash-&gt;{$key}, [ @$indent, length&#40;$1&#41; ], $lines &#41;;
 				}
 			}
@@ -411,7 +423,7 @@
 		die &#34;YAML::Tiny does not support circular references&#34;;
 	}
 	my @lines  = &#40;&#41;;
-	foreach my $name &#40; sort keys %$hash &#41; {
+	foreach my $name &#40; $TieHashModule ? sort keys %$hash : keys %$hash &#41; {
 		my $el   = $hash-&gt;{$name};
 		my $line = &#40;&#39;  &#39; x $indent&#41; . &#34;$name:&#34;;
 		my $type = ref $el;
@@ -608,8 +620,8 @@
 sense of.
 
 L&lt;YAML::Tiny&gt; does not generate comments, it won&#39;t necesarily preserve the
-order of your hashes, and it will normalise if reading in and writing out
-again.
+order of your hashes &#40;except if you use C&lt;YAML::Tiny::TieHashModule&gt;, see
+below&#41;, and it will normalise if reading in and writing out again.
 
 It only supports a very basic subset of the full YAML specification.
 
@@ -992,6 +1004,19 @@
 
 Reads the YAML stream from a file instead of a string.
 
+=head1 VARIABLES
+
+=head2 C&lt;YAML::Tiny::TieHashModule&gt;
+
+This module variable can be use to specify a module to be used to ie hashes
+against, thus providing more features to the hashes. For instance, using
+Tie::IxHash, Tie::Hash::Indexed or Ties::Hash::Sorted, the order of YAML data
+can be preserved, or sorted. The following example rounds-trip better :
+
+  local $YAML::Tiny::TieHashModule = &#39;Tie::IxHash&#39;;
+  my &#40;$structure&#41; = YAML::Tiny::LoadFile&#40;$filename&#41;;
+  my $output = YAML::Tiny::DumpFile&#40;$filename&#41;;
+
 =head1 SUPPORT
 
 Bugs should be reported via the CPAN bug tracker at
Only in YAML-Tiny-1.25: pm_to_blib
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;16:17:10&nbsp;2008</span>
    <span class="description">adamkennedybackup [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #32732] [PATCH] Support for tied hash &#40;thus ordered data&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 29 Jan 2008 08:16:34 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-YAML-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Adam Kennedy&#34; &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is an interesting patch, but unfortunately I think it adds more
complexity than I would like to see &#40;The mandate of ::Tiny is to be as
small as possible&#41;.

Since mappings in YAML are inherently non-ordered, this is also a
non-spec addition.

I think it might be better to see this added as a sub-class in a
separate distribution... perhaps YAML::Tiny::Tie&#40;d&#41; ?

Adam K

On 28/01/2008, Damien Krotkine via RT &lt;bug-YAML-Tiny@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Mon Jan 28 06:49:08 2008: Request 32732 was acted upon.
&gt; Transaction: Ticket created by DAMS
&gt;        Queue: YAML-Tiny
&gt;      Subject: [PATCH] Support for tied hash &#40;thus ordered data&#41;
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: Normal
&gt;        Owner: Nobody
&gt;   Requestors: DAMS@cpan.org
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=32732">http://rt.cpan.org/Ticket/Display.html?id=32732</a></span> &gt;
&gt;
&gt;
&gt; Hi.
&gt;
&gt; This patch allows to use a provided module name to create tied hashes and use them when
&gt; loading a yaml string. That way, the data order can be preserved. The pach includes more POD
&gt; doc.
&gt;
&gt;
&gt;
&gt;
&gt; Only in YAML-Tiny-1.25: Makefile
&gt; Only in YAML-Tiny-1.25: blib
&gt; diff -ru YAML-Tiny-1.25_old/lib/YAML/Tiny.pm YAML-Tiny-1.25/lib/YAML/Tiny.pm
&gt; --- YAML-Tiny-1.25_old/lib/YAML/Tiny.pm 2008-01-28 16:39:05.000000000 +0700
&gt; +++ YAML-Tiny-1.25/lib/YAML/Tiny.pm     2008-01-28 18:45:54.000000000 +0700
&gt; @@ -14,6 +14,18 @@
&gt;                 };
&gt;  }
&gt;
&gt; +our $TieHashModule = undef;
&gt; +
&gt; +# used to create a hashref, possibly using hash ties &#40;for instance, to get ordered hash&#41;
&gt; +sub _create_hashref {
&gt; +       $TieHashModule or return {};
&gt; +       eval &#40;&#34;require $TieHashModule&#34;&#41;;
&gt; +       $@ and die &#34;YAML::Tiny failed requiring &#39;$TieHashModule&#39;, specified to be used as a hash tie&#34;;
&gt; +       my %hash;
&gt; +       tie %hash, $TieHashModule;
&gt; +       return \%hash;
&gt; +}
&gt; +
&gt;  my $ESCAPE_CHAR = &#39;[\\x00-\\x08\\x0b-\\x0d\\x0e-\\x1f\&#34;\n]&#39;;
&gt;
&gt;  # Escapes for unprintable characters
&gt; @@ -100,7 +112,7 @@
&gt;
&gt;                 } elsif &#40; $lines[0] =~ /^&#40;\s*&#41;\w/ &#41; {
&gt;                         # A hash at the root
&gt; -                       my $document = { };
&gt; +                       my $document = _create_hashref&#40;&#41;;
&gt;                         push @$self, $document;
&gt;                         $self-&gt;_read_hash&#40; $document, [ length&#40;$1&#41; ], \@lines &#41;;
&gt;
&gt; @@ -196,7 +208,7 @@
&gt;                         # Inline nested hash
&gt;                         my $indent2 = length&#40;&#34;$1&#34;&#41;;
&gt;                         $lines-&gt;[0] =~ s/-/ /;
&gt; -                       push @$array, { };
&gt; +                       push @$array, _create_hashref&#40;&#41;;
&gt;                         $self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, $indent2 ], $lines &#41;;
&gt;
&gt;                 } elsif &#40; $lines-&gt;[0] =~ /^\s*\-&#40;\s*&#41;&#40;.+?&#41;\s*$/ &#41; {
&gt; @@ -222,7 +234,7 @@
&gt;                                 }
&gt;
&gt;                         } elsif &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;\w/ &#41; {
&gt; -                               push @$array, { };
&gt; +                               push @$array, _create_hashref&#40;&#41;;
&gt;                                 $self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, length&#40;&#34;$1&#34;&#41; ], $lines &#41;;
&gt;
&gt;                         } else {
&gt; @@ -279,7 +291,7 @@
&gt;                                         # Null hash entry
&gt;                                         $hash-&gt;{$key} = undef;
&gt;                                 } else {
&gt; -                                       $hash-&gt;{$key} = {};
&gt; +                                       $hash-&gt;{$key} = _create_hashref&#40;&#41;;
&gt;                                         $self-&gt;_read_hash&#40; $hash-&gt;{$key}, [ @$indent, length&#40;$1&#41; ], $lines &#41;;
&gt;                                 }
&gt;                         }
&gt; @@ -411,7 +423,7 @@
&gt;                 die &#34;YAML::Tiny does not support circular references&#34;;
&gt;         }
&gt;         my @lines  = &#40;&#41;;
&gt; -       foreach my $name &#40; sort keys %$hash &#41; {
&gt; +       foreach my $name &#40; $TieHashModule ? sort keys %$hash : keys %$hash &#41; {
&gt;                 my $el   = $hash-&gt;{$name};
&gt;                 my $line = &#40;&#39;  &#39; x $indent&#41; . &#34;$name:&#34;;
&gt;                 my $type = ref $el;
&gt; @@ -608,8 +620,8 @@
&gt;  sense of.
&gt;
&gt;  L&lt;YAML::Tiny&gt; does not generate comments, it won&#39;t necesarily preserve the
&gt; -order of your hashes, and it will normalise if reading in and writing out
&gt; -again.
&gt; +order of your hashes &#40;except if you use C&lt;YAML::Tiny::TieHashModule&gt;, see
&gt; +below&#41;, and it will normalise if reading in and writing out again.
&gt;
&gt;  It only supports a very basic subset of the full YAML specification.
&gt;
&gt; @@ -992,6 +1004,19 @@
&gt;
&gt;  Reads the YAML stream from a file instead of a string.
&gt;
&gt; +=head1 VARIABLES
&gt; +
&gt; +=head2 C&lt;YAML::Tiny::TieHashModule&gt;
&gt; +
&gt; +This module variable can be use to specify a module to be used to ie hashes
&gt; +against, thus providing more features to the hashes. For instance, using
&gt; +Tie::IxHash, Tie::Hash::Indexed or Ties::Hash::Sorted, the order of YAML data
&gt; +can be preserved, or sorted. The following example rounds-trip better :
&gt; +
&gt; +  local $YAML::Tiny::TieHashModule = &#39;Tie::IxHash&#39;;
&gt; +  my &#40;$structure&#41; = YAML::Tiny::LoadFile&#40;$filename&#41;;
&gt; +  my $output = YAML::Tiny::DumpFile&#40;$filename&#41;;
&gt; +
&gt;  =head1 SUPPORT
&gt;
&gt;  Bugs should be reported via the CPAN bug tracker at
&gt; Only in YAML-Tiny-1.25: pm_to_blib
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;16:17:26&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;16:18:31&nbsp;2008</span>
    <span class="description">adamkennedybackup [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #32732] [PATCH] Support for tied hash &#40;thus ordered data&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 29 Jan 2008 08:18:07 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-YAML-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Adam Kennedy&#34; &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I should also add that while I&#39;m normally not positive about doing
something like adding a stub method in ::Tiny modules just so people
can extend it, given the nature of YAML I&#39;d be more-inclined to do so
in this case.

Adam K
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;21:54:59&nbsp;2008</span>
    <span class="description">DAMS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I agree and fully understand your position. I had the same opinion and wanted to create 
YAML::Tiny::Tie &#40;or similar name&#41; at the first place, but then I thought you could find it impolite 
to do it so without having your word to say.

However, as we agree, do you mind if I release YAML::Tiny::Tie soon ?

Thanks,
dams
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;22:01:04&nbsp;2008</span>
    <span class="description">adamkennedybackup [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #32732] [PATCH] Support for tied hash &#40;thus ordered data&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 29 Jan 2008 14:00:50 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-YAML-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Adam Kennedy&#34; &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">No problem, go for it.

If you need a one-line patch from me to add support for sub-classing
the hash, resend it.

Adam K

On 29/01/2008, Damien Krotkine via RT &lt;bug-YAML-Tiny@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;        Queue: YAML-Tiny
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=32732">http://rt.cpan.org/Ticket/Display.html?id=32732</a></span> &gt;
&gt;
&gt; I agree and fully understand your position. I had the same opinion and wanted to create
&gt; YAML::Tiny::Tie &#40;or similar name&#41; at the first place, but then I thought you could find it impolite
&gt; to do it so without having your word to say.
&gt;
&gt; However, as we agree, do you mind if I release YAML::Tiny::Tie soon ?
&gt;
&gt; Thanks,
&gt; dams
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;23:45:17&nbsp;2008</span>
    <span class="description">DAMS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> DAMS [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks, the patch is attached.

I added support for _create_arrayref overloading as well. I had to add $DontUseAzOrdering to 
avoid the hash keys hard-coded sorting. It looks a bit ugly to use a module variable for that 
purpose, but as $self is [ @_ ], it&#39;s not easy to add a property to the object without changing 
its internal structure. If you have a better implementation for this, or any suggestion, please 
share them with me :&#41;

Instead of YAML::Tiny::Tie, I&#39;ll probably add YAML::Tiny::Ordered, as What would be 
YAML::Tiny::Tie is really a 5 liner &#40;see the POD part o the supplied patch

Cheers,
dams


Le Lun. Jan. 28 22:01:04 2008, adamkennedybackup@gmail.com a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; No problem, go for it.
&gt; 
&gt; If you need a one-line patch from me to add support for sub-classing
&gt; the hash, resend it.
</div></div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Only in YAML-Tiny-1.25: Makefile
Only in YAML-Tiny-1.25: blib
diff -ru YAML-Tiny-1.25_old/lib/YAML/Tiny.pm YAML-Tiny-1.25/lib/YAML/Tiny.pm
--- YAML-Tiny-1.25_old/lib/YAML/Tiny.pm	2008-01-28 16:39:05.000000000 +0700
+++ YAML-Tiny-1.25/lib/YAML/Tiny.pm	2008-01-29 11:36:04.000000000 +0700
@@ -14,6 +14,13 @@
 		};
 }
 
+our $DontForceAzOrdering = undef;
+
+# used to create new hashrefs and arrayrefs. Can be overloaded to use tied hash
+# and arrays, &#40;for instance, to get ordered hash&#41;
+sub _create_hashref  { {} }
+sub _create_arrayref { [] }
+
 my $ESCAPE_CHAR = &#39;[\\x00-\\x08\\x0b-\\x0d\\x0e-\\x1f\&#34;\n]&#39;;
 
 # Escapes for unprintable characters
@@ -94,13 +101,13 @@
 
 		} elsif &#40; $lines[0] =~ /^\s*\-/ &#41; {
 			# An array at the root
-			my $document = [ ];
+			my $document = $self-&gt;_create_arrayref&#40;&#41;;
 			push @$self, $document;
 			$self-&gt;_read_array&#40; $document, [ 0 ], \@lines &#41;;
 
 		} elsif &#40; $lines[0] =~ /^&#40;\s*&#41;\w/ &#41; {
 			# A hash at the root
-			my $document = { };
+			my $document = $self-&gt;_create_hashref&#40;&#41;;
 			push @$self, $document;
 			$self-&gt;_read_hash&#40; $document, [ length&#40;$1&#41; ], \@lines &#41;;
 
@@ -143,11 +150,11 @@
 	# Null hash and array
 	if &#40; $string eq &#39;{}&#39; &#41; {
 		# Null hash
-		return {};		
+		return $self-&gt;_create_hashref&#40;&#41;;		
 	}
 	if &#40; $string eq &#39;[]&#39; &#41; {
 		# Null array
-		return [];
+		return $self-&gt;_create_arrayref&#40;&#41;;		
 	}
 
 	# Regular unquoted string
@@ -196,7 +203,7 @@
 			# Inline nested hash
 			my $indent2 = length&#40;&#34;$1&#34;&#41;;
 			$lines-&gt;[0] =~ s/-/ /;
-			push @$array, { };
+			push @$array, $self-&gt;_create_hashref&#40;&#41;;
 			$self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, $indent2 ], $lines &#41;;
 
 		} elsif &#40; $lines-&gt;[0] =~ /^\s*\-&#40;\s*&#41;&#40;.+?&#41;\s*$/ &#41; {
@@ -217,12 +224,12 @@
 					push @$array, undef;
 				} else {
 					# Naked indenter
-					push @$array, [ ];
+					push @$array, $self-&gt;_create_arrayref&#40;&#41;;
 					$self-&gt;_read_array&#40; $array-&gt;[-1], [ @$indent, $indent2 ], $lines &#41;;
 				}
 
 			} elsif &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;\w/ &#41; {
-				push @$array, { };
+				push @$array, $self-&gt;_create_hashref&#40;&#41;;
 				$self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, length&#40;&#34;$1&#34;&#41; ], $lines &#41;;
 
 			} else {
@@ -271,7 +278,7 @@
 				return 1;
 			}
 			if &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;-/ &#41; {
-				$hash-&gt;{$key} = [];
+				$hash-&gt;{$key} = $self-&gt;_create_arrayref&#40;&#41;;
 				$self-&gt;_read_array&#40; $hash-&gt;{$key}, [ @$indent, length&#40;$1&#41; ], $lines &#41;;
 			} elsif &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;./ &#41; {
 				my $indent2 = length&#40;&#34;$1&#34;&#41;;
@@ -279,7 +286,7 @@
 					# Null hash entry
 					$hash-&gt;{$key} = undef;
 				} else {
-					$hash-&gt;{$key} = {};
+					$hash-&gt;{$key} = $self-&gt;_create_hashref&#40;&#41;;
 					$self-&gt;_read_hash&#40; $hash-&gt;{$key}, [ @$indent, length&#40;$1&#41; ], $lines &#41;;
 				}
 			}
@@ -411,7 +418,7 @@
 		die &#34;YAML::Tiny does not support circular references&#34;;
 	}
 	my @lines  = &#40;&#41;;
-	foreach my $name &#40; sort keys %$hash &#41; {
+	foreach my $name &#40; $DontForceAzOrdering ? keys %$hash : sort keys %$hash &#41; {
 		my $el   = $hash-&gt;{$name};
 		my $line = &#40;&#39;  &#39; x $indent&#41; . &#34;$name:&#34;;
 		my $type = ref $el;
@@ -607,9 +614,12 @@
 your average manager or secretary should be able to look at and make
 sense of.
 
-L&lt;YAML::Tiny&gt; does not generate comments, it won&#39;t necesarily preserve the
-order of your hashes, and it will normalise if reading in and writing out
-again.
+By default, L&lt;YAML::Tiny&gt; does not generate comments, it won&#39;t necesarily
+preserve the order of your hashes and it will normalise if reading in and
+writing out again. However you can alter this behaviour : see
+C&lt;YAML::Tiny::DontForceAzOrdering&gt; to stop forcing alphabetical reordering of
+hashes on output, and see the I&lt;Overload&gt; section to achieve hashes order
+preservation.
 
 It only supports a very basic subset of the full YAML specification.
 
@@ -992,6 +1002,56 @@
 
 Reads the YAML stream from a file instead of a string.
 
+=head1 OVERLOADING
+
+When loading YAML content, C&lt;YAML::Tiny&gt; returns a new complex data structure.
+To give flexibility on this data structure creation, the following methods are
+called when creating hashes and arrays.
+
+you might want to see also C&lt;YAML::Tiny::DontForceAzOrdering&gt; and L&lt;YAML::Tiny::Ordered&gt;.
+
+=head2 C&lt;_create_hashref&gt;
+
+This method is used when a new hashref is needed to create the new data
+structure or one of its sub component. By default, this method simply returns
+an empty hashref {}. However, you could overload it, use tied hashes and thus
+keep the original hash orders :
+
+  package YAML::Tiny::MyOrdered # your own package
+  use parent qw&#40;YAML::Tiny&#41;;    # inheritance
+  use Tie::IxHash;              # use ordered hash
+  
+  sub _create_hashref {
+    my %hash;
+    tie %hash, &#39;Tie::IxHash&#39;;
+    return \%hash;
+  }
+
+=head2 C&lt;_create_arrayref&gt;
+
+This method is used when a new arrayref is needed to create the new data
+structure or one of its sub component. By default, this method simply returns
+an empty arrayref []. However, you could overload it, and for instance use tied
+arrays.
+
+=head1 VARIABLES
+
+=head2 C&lt;YAML::Tiny::DontForceAzOrdering&gt;
+
+By default, when serializing a structure to a string/file, C&lt;YAML::Tiny&gt;
+reorder the hashes by alphabetical order. If you use overloading to use your
+own hash tie, you probably want to disable this feature. Do so by setting
+C&lt;YAML::Tiny::DontForceAzOrdering&gt; to a true value when using C&lt;write&gt;,
+C&lt;write_string&gt;, C&lt;Dump&gt; or C&lt;DumpFile&gt;. That way, the hash keys order will be
+the one return by the C&lt;keys&gt; function.
+
+  my &#40;$structure&#41; = YAML::Tiny::LoadFile&#40;$filename&#41;;
+  #...
+  {
+    local $YAML::Tiny::DontForceAzOrdering = 1;
+    my $output = YAML::Tiny::DumpFile&#40;$filename&#41;;
+  }
+
 =head1 SUPPORT
 
 Bugs should be reported via the CPAN bug tracker at
Only in YAML-Tiny-1.25: pm_to_blib
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;29&nbsp;00:52:20&nbsp;2008</span>
    <span class="description">adamkennedybackup [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #32732] [PATCH] Support for tied hash &#40;thus ordered data&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 29 Jan 2008 16:52:02 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-YAML-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Adam Kennedy&#34; &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I meant more just the bit with the additions... but I assume that you
want just the &#34;_create_hash&#34; hooks right?

Adam K

On 29/01/2008, Damien Krotkine via RT &lt;bug-YAML-Tiny@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Only in YAML-Tiny-1.25: Makefile
&gt; Only in YAML-Tiny-1.25: blib
&gt; diff -ru YAML-Tiny-1.25_old/lib/YAML/Tiny.pm YAML-Tiny-1.25/lib/YAML/Tiny.pm
&gt; --- YAML-Tiny-1.25_old/lib/YAML/Tiny.pm 2008-01-28 16:39:05.000000000 +0700
&gt; +++ YAML-Tiny-1.25/lib/YAML/Tiny.pm     2008-01-29 11:36:04.000000000 +0700
&gt; @@ -14,6 +14,13 @@
&gt;                 };
&gt;  }
&gt;
&gt; +our $DontForceAzOrdering = undef;
&gt; +
&gt; +# used to create new hashrefs and arrayrefs. Can be overloaded to use tied hash
&gt; +# and arrays, &#40;for instance, to get ordered hash&#41;
&gt; +sub _create_hashref  { {} }
&gt; +sub _create_arrayref { [] }
&gt; +
&gt;  my $ESCAPE_CHAR = &#39;[\\x00-\\x08\\x0b-\\x0d\\x0e-\\x1f\&#34;\n]&#39;;
&gt;
&gt;  # Escapes for unprintable characters
&gt; @@ -94,13 +101,13 @@
&gt;
&gt;                 } elsif &#40; $lines[0] =~ /^\s*\-/ &#41; {
&gt;                         # An array at the root
&gt; -                       my $document = [ ];
&gt; +                       my $document = $self-&gt;_create_arrayref&#40;&#41;;
&gt;                         push @$self, $document;
&gt;                         $self-&gt;_read_array&#40; $document, [ 0 ], \@lines &#41;;
&gt;
&gt;                 } elsif &#40; $lines[0] =~ /^&#40;\s*&#41;\w/ &#41; {
&gt;                         # A hash at the root
&gt; -                       my $document = { };
&gt; +                       my $document = $self-&gt;_create_hashref&#40;&#41;;
&gt;                         push @$self, $document;
&gt;                         $self-&gt;_read_hash&#40; $document, [ length&#40;$1&#41; ], \@lines &#41;;
&gt;
&gt; @@ -143,11 +150,11 @@
&gt;         # Null hash and array
&gt;         if &#40; $string eq &#39;{}&#39; &#41; {
&gt;                 # Null hash
&gt; -               return {};
&gt; +               return $self-&gt;_create_hashref&#40;&#41;;
&gt;         }
&gt;         if &#40; $string eq &#39;[]&#39; &#41; {
&gt;                 # Null array
&gt; -               return [];
&gt; +               return $self-&gt;_create_arrayref&#40;&#41;;
&gt;         }
&gt;
&gt;         # Regular unquoted string
&gt; @@ -196,7 +203,7 @@
&gt;                         # Inline nested hash
&gt;                         my $indent2 = length&#40;&#34;$1&#34;&#41;;
&gt;                         $lines-&gt;[0] =~ s/-/ /;
&gt; -                       push @$array, { };
&gt; +                       push @$array, $self-&gt;_create_hashref&#40;&#41;;
&gt;                         $self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, $indent2 ], $lines &#41;;
&gt;
&gt;                 } elsif &#40; $lines-&gt;[0] =~ /^\s*\-&#40;\s*&#41;&#40;.+?&#41;\s*$/ &#41; {
&gt; @@ -217,12 +224,12 @@
&gt;                                         push @$array, undef;
&gt;                                 } else {
&gt;                                         # Naked indenter
&gt; -                                       push @$array, [ ];
&gt; +                                       push @$array, $self-&gt;_create_arrayref&#40;&#41;;
&gt;                                         $self-&gt;_read_array&#40; $array-&gt;[-1], [ @$indent, $indent2 ], $lines &#41;;
&gt;                                 }
&gt;
&gt;                         } elsif &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;\w/ &#41; {
&gt; -                               push @$array, { };
&gt; +                               push @$array, $self-&gt;_create_hashref&#40;&#41;;
&gt;                                 $self-&gt;_read_hash&#40; $array-&gt;[-1], [ @$indent, length&#40;&#34;$1&#34;&#41; ], $lines &#41;;
&gt;
&gt;                         } else {
&gt; @@ -271,7 +278,7 @@
&gt;                                 return 1;
&gt;                         }
&gt;                         if &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;-/ &#41; {
&gt; -                               $hash-&gt;{$key} = [];
&gt; +                               $hash-&gt;{$key} = $self-&gt;_create_arrayref&#40;&#41;;
&gt;                                 $self-&gt;_read_array&#40; $hash-&gt;{$key}, [ @$indent, length&#40;$1&#41; ], $lines &#41;;
&gt;                         } elsif &#40; $lines-&gt;[0] =~ /^&#40;\s*&#41;./ &#41; {
&gt;                                 my $indent2 = length&#40;&#34;$1&#34;&#41;;
&gt; @@ -279,7 +286,7 @@
&gt;                                         # Null hash entry
&gt;                                         $hash-&gt;{$key} = undef;
&gt;                                 } else {
&gt; -                                       $hash-&gt;{$key} = {};
&gt; +                                       $hash-&gt;{$key} = $self-&gt;_create_hashref&#40;&#41;;
&gt;                                         $self-&gt;_read_hash&#40; $hash-&gt;{$key}, [ @$indent, length&#40;$1&#41; ], $lines &#41;;
&gt;                                 }
&gt;                         }
&gt; @@ -411,7 +418,7 @@
&gt;                 die &#34;YAML::Tiny does not support circular references&#34;;
&gt;         }
&gt;         my @lines  = &#40;&#41;;
&gt; -       foreach my $name &#40; sort keys %$hash &#41; {
&gt; +       foreach my $name &#40; $DontForceAzOrdering ? keys %$hash : sort keys %$hash &#41; {
&gt;                 my $el   = $hash-&gt;{$name};
&gt;                 my $line = &#40;&#39;  &#39; x $indent&#41; . &#34;$name:&#34;;
&gt;                 my $type = ref $el;
&gt; @@ -607,9 +614,12 @@
&gt;  your average manager or secretary should be able to look at and make
&gt;  sense of.
&gt;
&gt; -L&lt;YAML::Tiny&gt; does not generate comments, it won&#39;t necesarily preserve the
&gt; -order of your hashes, and it will normalise if reading in and writing out
&gt; -again.
&gt; +By default, L&lt;YAML::Tiny&gt; does not generate comments, it won&#39;t necesarily
&gt; +preserve the order of your hashes and it will normalise if reading in and
&gt; +writing out again. However you can alter this behaviour : see
&gt; +C&lt;YAML::Tiny::DontForceAzOrdering&gt; to stop forcing alphabetical reordering of
&gt; +hashes on output, and see the I&lt;Overload&gt; section to achieve hashes order
&gt; +preservation.
&gt;
&gt;  It only supports a very basic subset of the full YAML specification.
&gt;
&gt; @@ -992,6 +1002,56 @@
&gt;
&gt;  Reads the YAML stream from a file instead of a string.
&gt;
&gt; +=head1 OVERLOADING
&gt; +
&gt; +When loading YAML content, C&lt;YAML::Tiny&gt; returns a new complex data structure.
&gt; +To give flexibility on this data structure creation, the following methods are
&gt; +called when creating hashes and arrays.
&gt; +
&gt; +you might want to see also C&lt;YAML::Tiny::DontForceAzOrdering&gt; and L&lt;YAML::Tiny::Ordered&gt;.
&gt; +
&gt; +=head2 C&lt;_create_hashref&gt;
&gt; +
&gt; +This method is used when a new hashref is needed to create the new data
&gt; +structure or one of its sub component. By default, this method simply returns
&gt; +an empty hashref {}. However, you could overload it, use tied hashes and thus
&gt; +keep the original hash orders :
&gt; +
&gt; +  package YAML::Tiny::MyOrdered # your own package
&gt; +  use parent qw&#40;YAML::Tiny&#41;;    # inheritance
&gt; +  use Tie::IxHash;              # use ordered hash
&gt; +
&gt; +  sub _create_hashref {
&gt; +    my %hash;
&gt; +    tie %hash, &#39;Tie::IxHash&#39;;
&gt; +    return \%hash;
&gt; +  }
&gt; +
&gt; +=head2 C&lt;_create_arrayref&gt;
&gt; +
&gt; +This method is used when a new arrayref is needed to create the new data
&gt; +structure or one of its sub component. By default, this method simply returns
&gt; +an empty arrayref []. However, you could overload it, and for instance use tied
&gt; +arrays.
&gt; +
&gt; +=head1 VARIABLES
&gt; +
&gt; +=head2 C&lt;YAML::Tiny::DontForceAzOrdering&gt;
&gt; +
&gt; +By default, when serializing a structure to a string/file, C&lt;YAML::Tiny&gt;
&gt; +reorder the hashes by alphabetical order. If you use overloading to use your
&gt; +own hash tie, you probably want to disable this feature. Do so by setting
&gt; +C&lt;YAML::Tiny::DontForceAzOrdering&gt; to a true value when using C&lt;write&gt;,
&gt; +C&lt;write_string&gt;, C&lt;Dump&gt; or C&lt;DumpFile&gt;. That way, the hash keys order will be
&gt; +the one return by the C&lt;keys&gt; function.
&gt; +
&gt; +  my &#40;$structure&#41; = YAML::Tiny::LoadFile&#40;$filename&#41;;
&gt; +  #...
&gt; +  {
&gt; +    local $YAML::Tiny::DontForceAzOrdering = 1;
&gt; +    my $output = YAML::Tiny::DumpFile&#40;$filename&#41;;
&gt; +  }
&gt; +
&gt;  =head1 SUPPORT
&gt;
&gt;  Bugs should be reported via the CPAN bug tracker at
&gt; Only in YAML-Tiny-1.25: pm_to_blib
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;29&nbsp;01:16:03&nbsp;2008</span>
    <span class="description">DAMS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Mar. Jan. 29 00:52:20 2008, adamkennedybackup@gmail.com a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I meant more just the bit with the additions... but I assume that you
&gt; want just the &#34;_create_hash&#34; hooks right?
</div>
yes, the _create_hashref bits is the minimum. I think that it makes sense to add _create_arayref&#41; 
too, but I don&#39;t mind. As soo as _create_hashref is there, I can create YAML::Tiny::Ordered

However, the problem is the &#34;sort keys %$hash&#34;, as it forces the keys reordering on output, 
which ruins the whole purpose of having tied hash

dams
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;20&nbsp;06:54:26&nbsp;2008</span>
    <span class="description">adamk [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sounds like this is going to be enough of a problem that it might be
better to just cut/paste/modify each of the methods that you need to change.

Rejected.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;20&nbsp;06:54:30&nbsp;2008</span>
    <span class="description">adamk [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
