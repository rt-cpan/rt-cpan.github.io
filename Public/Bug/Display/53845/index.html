<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #53845 for DBD-mysql: t/40keyinfo.t fails when default engine NDB cluster</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #53845 for DBD-mysql: t/40keyinfo.t fails when default engine NDB cluster</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBD-mysql/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBD-mysql/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBD-mysql/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBD-mysql/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-mysql">DBD-mysql CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">53845</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBD-mysql/Active/">DBD-mysql</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
paddy [...] firedrake.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-10170-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
4.013    </td>
  </tr>
  <tr id="CF-10171-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;11:17:38&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> t/40keyinfo.t fails when default engine NDB cluster</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Tests fail if database uses NDB as the mysql servers default storage
engine for tables and force install is required.

Failed Test   Stat Wstat Total Fail  Failed  List of Failed
-------------------------------------------------------------------------------
t/40keyinfo.t  255 65280     7   10 142.86%  3-7
1 test skipped.
Failed 1/36 test scripts, 97.22% okay. 5/745 subtests failed, 99.33% okay.
make: *** [test_dynamic] Error 255
  /usr/bin/make test -- NOT OK


The line that causes the issue is :-
CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key &#40;a,b&#40;10&#41;&#41;,
key &#40;c&#41;&#41;;

This returns
ERROR 1089 &#40;HY000&#41;: Incorrect prefix key; the used key part isn&#39;t a
string, the used length is longer than the key part, or the storage
engine doesn&#39;t support unique prefix keys

However the following versions do create the table :-
CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key &#40;a,b&#41;, key
&#40;c&#41;&#41;;

CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key &#40;a,b&#40;10&#41;&#41;,
key &#40;c&#41;&#41; engine=innodb;

So the problem is NDB not supporting partial column primary key indexes.

Hope that helps

Paddy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;11:49:58&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Looking at the version created when using InnoDB we can see the Sub_part
10 for the column in question

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; show table status;
</div>+----------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+-------------+------------+-------------------+----------+----------------+---------+
| Name     | Engine | Version | Row_format | Rows | Avg_row_length |
Data_length | Max_data_length | Index_length | Data_free |
Auto_increment | Create_time         | Update_time | Check_time |
Collation         | Checksum | Create_options | Comment |
+----------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+-------------+------------+-------------------+----------+----------------+---------+
| $table   | InnoDB |      10 | Compact    |    0 |              0 |   
   16384 |               0 |        16384 |   4194304 |           NULL |
2010-01-20 16:41:46 | NULL        | NULL       | latin1_swedish_ci |   
 NULL |                |         |
+----------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+-------------+------------+-------------------+----------+----------------+---------+


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; show indexes from $table;
</div>+--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table  | Non_unique | Key_name | Seq_in_index | Column_name |
Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| $table |          0 | PRIMARY  |            1 | a           | A      
  |           0 |     NULL | NULL   |      | BTREE      |         |
| $table |          0 | PRIMARY  |            2 | b           | A      
  |           0 |       10 | NULL   |      | BTREE      |         |
| $table |          1 | c        |            1 | c           | A      
  |           0 |     NULL | NULL   | YES  | BTREE      |         |
+--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+

But when we look at the returns the test script is expecting we see :-

my $sth= $dbh-&gt;primary_key_info&#40;undef, undef, $table&#41;;
ok&#40;$sth, &#34;Got primary key info&#34;&#41;;

my $expect= [
              [ undef, undef, $table, &#39;a&#39;, &#39;1&#39;, &#39;PRIMARY&#39; ],
              [ undef, undef, $table, &#39;b&#39;, &#39;2&#39;, &#39;PRIMARY&#39; ],
            ];

is_deeply&#40;$key_info, $expect, &#34;Check primary_key_info results&#34;&#41;;

is_deeply&#40;[ $dbh-&gt;primary_key&#40;undef, undef, $table&#41; ], [ &#39;a&#39;, &#39;b&#39; ],
          &#34;Check primary_key results&#34;&#41;;

I see no point in the test script that tests for use of sub_part in the
key. 

Now is this an omission in the test or a limitation of DBD and if it is
a limitation should the table be created using a sub_part in a test?

Any thoughts?

Paddy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:09:54&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 20 11:17:38 2010, UNDERMINE wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However the following versions do create the table :-
&gt; CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key &#40;a,b&#41;,
&gt; key
&gt; &#40;c&#41;&#41;;
&gt; 
&gt; CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key
&gt; &#40;a,b&#40;10&#41;&#41;,
&gt; key &#40;c&#41;&#41; engine=innodb;
&gt; 
&gt; So the problem is NDB not supporting partial column primary key
&gt; indexes.
</div>
engine=MEMORY and engine=MyISAM are also successful for this creation
statement only fails if your default engine is NDB.

Paddy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:09:57&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:11:55&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Status changed from &#39;open&#39; to &#39;new&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:29:45&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">How to detect the use of NDB cluster as the default engine
SHOW VARIABLES has the following values of interest
Variable_name             Value
storage_engine            ndbcluster
have_ndbcluster           YES

t/mysql.dbtest does not currently have a section for ndbcluster under
sub have_transactions &#40;&#41;

Basic patch to t/mysql.dbtest may look like the following but not tested
it atm so got no idea of cascade effect this has.

--- mysql.dbtest        2009-09-15 02:57:53.000000000 +0100
+++ patch/mysql.dbtest  2010-01-20 17:22:32.000000000 +0000
@@ -58,6 +58,11 @@
                 $have_transactions = &#34;gemini&#34;;
                 last;
             }
+            if &#40;$row-&gt;{&#39;Variable_name&#39;} eq &#39;have_ndbcluster&#39;  &#38;&#38;
+                $row-&gt;{&#39;Value&#39;} eq &#39;YES&#39;&#41; {
+                $have_transactions = &#34;ndbcluster&#34;;
+                last;
+            }
         }
     }
     return $have_transactions;


For the initial bug this should be enough :
--- 40keyinfo.t 2009-09-15 02:57:53.000000000 +0100
+++ patch/40keyinfo.t   2010-01-20 17:24:38.000000000 +0000
@@ -26,7 +26,7 @@
 
 # Non-primary key is there as a regression test for Bug #26786.
 ok&#40;$dbh-&gt;do&#40;&#34;CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int,
-                                primary key &#40;a,b&#40;10&#41;&#41;, key &#40;c&#41;&#41;&#34;&#41;,
+                                primary key &#40;a,b&#41;, key &#40;c&#41;&#41;&#34;&#41;,
    &#34;Created table $table&#34;&#41;;
 
 my $sth= $dbh-&gt;primary_key_info&#40;undef, undef, $table&#41;;



Hope this helps

Paddy

On Wed Jan 20 11:17:38 2010, UNDERMINE wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tests fail if database uses NDB as the mysql servers default storage
&gt; engine for tables and force install is required.
&gt; 
&gt; Failed Test   Stat Wstat Total Fail  Failed  List of Failed
&gt;
</div>-------------------------------------------------------------------------------
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; t/40keyinfo.t  255 65280     7   10 142.86%  3-7
&gt; 1 test skipped.
&gt; Failed 1/36 test scripts, 97.22% okay. 5/745 subtests failed, 99.33%
&gt; okay.
&gt; make: *** [test_dynamic] Error 255
&gt;   /usr/bin/make test -- NOT OK
&gt; 
&gt; 
&gt; The line that causes the issue is :-
&gt; CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key
&gt; &#40;a,b&#40;10&#41;&#41;,
&gt; key &#40;c&#41;&#41;;
&gt; 
&gt; This returns
&gt; ERROR 1089 &#40;HY000&#41;: Incorrect prefix key; the used key part isn&#39;t a
&gt; string, the used length is longer than the key part, or the storage
&gt; engine doesn&#39;t support unique prefix keys
&gt; 
&gt; However the following versions do create the table :-
&gt; CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key &#40;a,b&#41;,
&gt; key
&gt; &#40;c&#41;&#41;;
&gt; 
&gt; CREATE TABLE $table &#40;a int, b varchar&#40;20&#41;, c int, primary key
&gt; &#40;a,b&#40;10&#41;&#41;,
&gt; key &#40;c&#41;&#41; engine=innodb;
&gt; 
&gt; So the problem is NDB not supporting partial column primary key
&gt; indexes.
&gt; 
&gt; Hope that helps
&gt; 
&gt; Paddy
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:29:50&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:30:06&nbsp;2010</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If a test fails using a particular engine, it has to be an issue with
the server. The Perl driver has nothing to do with what engine is being
used for the test. I don&#39;t have NDB cluster set up to verify this, but
I&#39;m 99.88% certain this is not a DBD::mysql issue. I would turn on
logging, run the test, capture the SQL the test produces and run it
straight through the MySQL client to check. If it&#39;s a bug in MySQL, log
it at <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.mysql.com">http://bugs.mysql.com</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:34:57&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 20 12:30:06 2010, CAPTTOFU wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If a test fails using a particular engine, it has to be an issue with
&gt; the server. The Perl driver has nothing to do with what engine is being
&gt; used for the test. I don&#39;t have NDB cluster set up to verify this, but
&gt; I&#39;m 99.88% certain this is not a DBD::mysql issue. I would turn on
&gt; logging, run the test, capture the SQL the test produces and run it
&gt; straight through the MySQL client to check. If it&#39;s a bug in MySQL, log
&gt; it at <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.mysql.com">http://bugs.mysql.com</a></span>
</div>
I would agree that NDB not supporting sub_parts in primary keys is a
problem with MySQL NDB cluster engine but should the DBD::mysql driver
installation be dependant on a feature that DBD::mysql&#39;s tests do not
appear use?

Paddy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;12:40:55&nbsp;2010</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 20 12:30:06 2010, CAPTTOFU wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If a test fails using a particular engine, it has to be an issue with
&gt; the server. The Perl driver has nothing to do with what engine is being
&gt; used for the test. I don&#39;t have NDB cluster set up to verify this, but
&gt; I&#39;m 99.88% certain this is not a DBD::mysql issue. I would turn on
&gt; logging, run the test, capture the SQL the test produces and run it
&gt; straight through the MySQL client to check. If it&#39;s a bug in MySQL, log
&gt; it at <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.mysql.com">http://bugs.mysql.com</a></span>
</div>
Ok, thanks for the patch! I&#39;ll test it out. I&#39;ve never dealt with NDB so
I&#39;d have to set it up to test. Though, if this patch fixes things for
you and all tests pass with it applied, I could make a release.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;13:26:36&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">NDB Cluster is not your normal engine ;&#41; 

I&#39;m running with the latest version from mysql.com MySQL Cluster 7.0.9
but you need a mininium of 2 VMs just to install it.

Works really nicely when its set up correctly but need bandwidth between
the nodes.

Will spend some time tomorrow doing some testing and checking everything
passes with all test on all the engines I have.

Not sure how many tests will pass with blackhole engine but we will try
for completeness.

Paddy

On Wed Jan 20 12:40:55 2010, CAPTTOFU wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Jan 20 12:30:06 2010, CAPTTOFU wrote:
<div class="message-stanza open">&gt; &gt; If a test fails using a particular engine, it has to be an issue with
&gt; &gt; the server. The Perl driver has nothing to do with what engine is being
&gt; &gt; used for the test. I don&#39;t have NDB cluster set up to verify this, but
&gt; &gt; I&#39;m 99.88% certain this is not a DBD::mysql issue. I would turn on
&gt; &gt; logging, run the test, capture the SQL the test produces and run it
&gt; &gt; straight through the MySQL client to check. If it&#39;s a bug in MySQL, log
&gt; &gt; it at <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.mysql.com">http://bugs.mysql.com</a></span>
</div>&gt; 
&gt; Ok, thanks for the patch! I&#39;ll test it out. I&#39;ve never dealt with NDB so
&gt; I&#39;d have to set it up to test. Though, if this patch fixes things for
&gt; you and all tests pass with it applied, I could make a release.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;21&nbsp;05:24:33&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;21&nbsp;05:27:04&nbsp;2010</span>
    <span class="description">paddy [...] firedrake.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Summary from previous large post for quick reference
On Wed Jan 20 13:26:36 2010, UNDERMINE wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; NDB Cluster is not your normal engine ;&#41; 
&gt; 
&gt; I&#39;m running with the latest version from mysql.com MySQL Cluster 7.0.9
&gt; but you need a mininium of 2 VMs just to install it.
&gt; 
&gt; Works really nicely when its set up correctly but need bandwidth between
&gt; the nodes.
&gt; 
&gt; Will spend some time tomorrow doing some testing and checking everything
&gt; passes with all test on all the engines I have.
&gt; 
&gt; Not sure how many tests will pass with blackhole engine but we will try
&gt; for completeness.
&gt; 
</div>
So in summary
NDB - Passes &#40;Failed 28/36 when using invalid backed as you would expect&#41;
InnoDB - Passes
MyISAM - Passes
MEMORY - Failed 3/36
BLACKHOLE - Failed 16/36
CSV - Failed 24/36
ARCHIVE - Failed 12/36

Normally you would only consider using NDB, InnoDB, MyISAM, MEMORY and
BLACKHOLE as the defaults. It would be nice if MEMORY could be supported
but BLACKHOLE is a special case anyway.

Hope this covers everything

Paddy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;15&nbsp;02:47:33&nbsp;2017</span>
    <span class="description">MICHIELB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ticket migrated to github as <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perl5-dbi/DBD-mysql/issues/183">https://github.com/perl5-dbi/DBD-mysql/issues/183</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;15&nbsp;02:47:35&nbsp;2017</span>
    <span class="description">MICHIELB [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
