<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #120214 for MarpaX-Languages-C-AST: $token undef @ MarpaX/Languages/C/AST/Scope.pm:205</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #120214 for MarpaX-Languages-C-AST: $token undef @ MarpaX/Languages/C/AST/Scope.pm:205</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/MarpaX-Languages-C-AST/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/MarpaX-Languages-C-AST/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/MarpaX-Languages-C-AST/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/MarpaX-Languages-C-AST/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/MarpaX-Languages-C-AST">MarpaX-Languages-C-AST CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">120214</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/MarpaX-Languages-C-AST/Active/">MarpaX-Languages-C-AST</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
kai.extern [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-249986-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-249987-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;12&nbsp;12:17:02&nbsp;2017</span>
    <span class="description">kai.extern [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> $token undef @ MarpaX/Languages/C/AST/Scope.pm:205</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 12 Feb 2017 18:16:44 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MarpaX-Languages-C-AST [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kai Henningsen &lt;kai.extern [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">So I wondered if I should really be using MarpaX::Languages::C::AST
directly, and not the C::Scan compatibility stuff. However, that also had a
problem.

Perl program used:

#! /usr/bin/perl -w

use strict;
use Data::Dumper::Simple;
$Data::Dumper::Useqq = 1;
$Data::Dumper::Sortkeys = 1;
no warnings qw&#40; qw experimental::smartmatch &#41;;

$| = 1;

use MarpaX::Languages::C::AST;
use Scalar::Util;

my $cc = &#39;c&#39;;
my $src = &#34;uv0.$cc&#34;;
my $ppsrc = &#34;uv1.$cc&#34;;
my $pppsrc = &#34;uv2.$cc&#34;;

open UV0, &#39;&gt;&#39;, $src or die &#34;$src: $!&#34;;
print UV0 &#34;#include &lt;uv.h&gt;\n&#34;;
close UV0 or die &#34;$src: $!&#34;;

system&#40;&#39;gcc&#39;, &#39;-E&#39;, $src, &#39;-o&#39;, $ppsrc&#41; and die &#34;gcc -E $src -o $ppsrc: $!
$?&#34;;

open UV1, &#39;&lt;&#39;, $ppsrc or die &#34;$ppsrc: $!&#34;;
$/ = undef;
my $srcpp = &lt;UV1&gt;;
close UV1 or die &#34;$ppsrc: $!&#34;;

my $parser = MarpaX::Languages::C::AST-&gt;new&#40;lazy =&gt; 1&#41;;

my $ast = $parser-&gt;parse&#40;\$srcpp&#41;-&gt;value&#40;1&#41;;

print Dumper&#40;$ast&#41;;


And this produced:


Use of uninitialized value $token in hash element at
        /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Scope.pm line
205 &#40;#1&#41;
    &#40;W uninitialized&#41; An undefined value was used as if it were already
    defined.  It was interpreted as a &#34;&#34; or a 0, but maybe it was a mistake.
    To suppress this warning assign a defined value to your variables.

    To help you figure out what was undefined, perl will try to tell you
    the name of the variable &#40;if any&#41; that was undefined.  In some cases
    it cannot do this, so it also tells you what operation you used the
    undefined value in.  Note, however, that perl optimizes your program
    and the operation displayed in the warning may not necessarily appear
    literally in your program.  For example, &#34;that $foo&#34; is usually
    optimized into &#34;that &#34; . $foo, and the warning will refer to the
    concatenation &#40;.&#41; operator, even though there is no . in
    your program.

Uncaught exception from user code:
        Use of uninitialized value $token in hash element at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Scope.pm line 205.

MarpaX::Languages::C::AST::Scope::parseObscureTypedef&#40;MarpaX::Languages::C::AST::Scope=HASH&#40;0x55b910e3b8f8&#41;,
undef&#41; called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm line
380

MarpaX::Languages::C::AST::Callback::Events::_enterOrObscureTypedef&#40;MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;,
-1, ARRAY&#40;0x55b91588e590&#41;&#41; called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm line
366

MarpaX::Languages::C::AST::Callback::Events::_declarationCheck&#40;MarpaX::Languages::C::AST::Callback::Method=ARRAY&#40;0x55b915412508&#41;,
MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;,
ARRAY&#40;0x55b91588d950&#41;&#41; called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm line 389

MarpaX::Languages::C::AST::Callback::_fire&#40;MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;&#41;
called at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm
line 204
        MarpaX::Languages::C::AST::Callback::exec&#40;undef, &#34;&lt;process&gt;&#34;&#41;
called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm line
548

MarpaX::Languages::C::AST::Callback::Events::_subFire_optimized&#40;MarpaX::Languages::C::AST::Callback::Method=ARRAY&#40;0x55b91544ded0&#41;,
MarpaX::Languages::C::AST::Callback::Events=ARRAY&#40;0x55b912393150&#41;,
ARRAY&#40;0x55b91588f4e8&#41;, &#34;declarationCheck&#34;,
MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;,
HASH&#40;0x55b912483ac0&#41;, HASH&#40;0x55b9154307f0&#41;&#41; called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm line 389

MarpaX::Languages::C::AST::Callback::_fire&#40;MarpaX::Languages::C::AST::Callback::Events=ARRAY&#40;0x55b912393150&#41;&#41;
called at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm
line 204
        MarpaX::Languages::C::AST::Callback::exec&#40;undef,
&#34;translationUnit\$&#34;, &#34;^externalDeclaration&#34;, &#34;declarationCheck\$&#34;&#41; called
at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST.pm line 262

MarpaX::Languages::C::AST::_doEvents&#40;MarpaX::Languages::C::AST=HASH&#40;0x55b91538b8c8&#41;&#41;
called at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST.pm line 171

MarpaX::Languages::C::AST::parse&#40;MarpaX::Languages::C::AST=HASH&#40;0x55b91538b8c8&#41;,
SCALAR&#40;0x55b9118dd398&#41;&#41; called at ./make_uv_wrapper.pl line 32


Am I doing something wrong? Looking at the source &#40;and a bit of debug
output&#41;, I can&#39;t see how I&#39;d have any influence there. It seems to happen
the very first time it uses this code path.

-- 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GCM/CS/IT d s+: a++ C++ UL++++ P+++ L+++ E--- W++@ N@ !o !K w&#40;++&#41; O-@ M-@
V-- PS++@ PE- Y+ PGP+@ t- 5 X-  !tv b++&gt;+++  D--- G e+ h-- !r y?
------END GEEK CODE BLOCK------
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;12&nbsp;13:44:17&nbsp;2017</span>
    <span class="description">JDDPAUSE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">lazy option is dangerous. You should not send an already preprocessed output, i.e:

perl -Ilib -MMarpaX::Languages::C::AST -e &#39;MarpaX::Languages::C::AST-&gt;new-&gt;parse&#40;\shift&#41;&#39; &#34;#include &lt;uv&gt;&#34;

C::Scan offers a more user-friendly output, at the cost of heavy XML manipulations that make it much slower though:

perl -Ilib -MData::Dumper -MMarpaX::Languages::C::Scan -e &#39;my $this = shift; print Dumper&#40;MarpaX::Languages::C::Scan-&gt;new&#40;filename =&gt; $this, filename_filter =&gt; $this&#41;-&gt;fdecls&#41;&#39; /usr/include/uv.h 

Regards.

On Sun Feb 12 12:17:02 2017, kai.extern@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So I wondered if I should really be using MarpaX::Languages::C::AST
&gt; directly, and not the C::Scan compatibility stuff. However, that also
&gt; had a
&gt; problem.
&gt; 
&gt; Perl program used:
&gt; 
&gt; #! /usr/bin/perl -w
&gt; 
&gt; use strict;
&gt; use Data::Dumper::Simple;
&gt; $Data::Dumper::Useqq = 1;
&gt; $Data::Dumper::Sortkeys = 1;
&gt; no warnings qw&#40; qw experimental::smartmatch &#41;;
&gt; 
&gt; $| = 1;
&gt; 
&gt; use MarpaX::Languages::C::AST;
&gt; use Scalar::Util;
&gt; 
&gt; my $cc = &#39;c&#39;;
&gt; my $src = &#34;uv0.$cc&#34;;
&gt; my $ppsrc = &#34;uv1.$cc&#34;;
&gt; my $pppsrc = &#34;uv2.$cc&#34;;
&gt; 
&gt; open UV0, &#39;&gt;&#39;, $src or die &#34;$src: $!&#34;;
&gt; print UV0 &#34;#include &lt;uv.h&gt;\n&#34;;
&gt; close UV0 or die &#34;$src: $!&#34;;
&gt; 
&gt; system&#40;&#39;gcc&#39;, &#39;-E&#39;, $src, &#39;-o&#39;, $ppsrc&#41; and die &#34;gcc -E $src -o
&gt; $ppsrc: $!
&gt; $?&#34;;
&gt; 
&gt; open UV1, &#39;&lt;&#39;, $ppsrc or die &#34;$ppsrc: $!&#34;;
&gt; $/ = undef;
&gt; my $srcpp = &lt;UV1&gt;;
&gt; close UV1 or die &#34;$ppsrc: $!&#34;;
&gt; 
&gt; my $parser = MarpaX::Languages::C::AST-&gt;new&#40;lazy =&gt; 1&#41;;
&gt; 
&gt; my $ast = $parser-&gt;parse&#40;\$srcpp&#41;-&gt;value&#40;1&#41;;
&gt; 
&gt; print Dumper&#40;$ast&#41;;
&gt; 
&gt; 
&gt; And this produced:
&gt; 
&gt; 
&gt; Use of uninitialized value $token in hash element at
&gt;         /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Scope.pm
&gt; line
&gt; 205 &#40;#1&#41;
&gt;     &#40;W uninitialized&#41; An undefined value was used as if it were
&gt; already
&gt;     defined.  It was interpreted as a &#34;&#34; or a 0, but maybe it was a
&gt; mistake.
&gt;     To suppress this warning assign a defined value to your variables.
&gt; 
&gt; To help you figure out what was undefined, perl will try to tell you
&gt; the name of the variable &#40;if any&#41; that was undefined.  In some cases
&gt; it cannot do this, so it also tells you what operation you used the
&gt; undefined value in.  Note, however, that perl optimizes your program
&gt; and the operation displayed in the warning may not necessarily appear
&gt; literally in your program.  For example, &#34;that $foo&#34; is usually
&gt; optimized into &#34;that &#34; . $foo, and the warning will refer to the
&gt; concatenation &#40;.&#41; operator, even though there is no . in
&gt; your program.
&gt; 
&gt; Uncaught exception from user code:
&gt;         Use of uninitialized value $token in hash element at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Scope.pm line 205.
&gt; 
&gt; MarpaX::Languages::C::AST::Scope::parseObscureTypedef&#40;MarpaX::Languages::C::AST::Scope=HASH&#40;0x55b910e3b8f8&#41;,
&gt; undef&#41; called at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm
&gt; line
&gt; 380
&gt; 
&gt; MarpaX::Languages::C::AST::Callback::Events::_enterOrObscureTypedef&#40;MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;,
&gt; -1, ARRAY&#40;0x55b91588e590&#41;&#41; called at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm
&gt; line
&gt; 366
&gt; 
&gt; MarpaX::Languages::C::AST::Callback::Events::_declarationCheck&#40;MarpaX::Languages::C::AST::Callback::Method=ARRAY&#40;0x55b915412508&#41;,
&gt; MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;,
&gt; ARRAY&#40;0x55b91588d950&#41;&#41; called at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm line
&gt; 389
&gt; 
&gt; MarpaX::Languages::C::AST::Callback::_fire&#40;MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;&#41;
&gt; called at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm
&gt; line 204
&gt;         MarpaX::Languages::C::AST::Callback::exec&#40;undef, &#34;&lt;process&gt;&#34;&#41;
&gt; called at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm
&gt; line
&gt; 548
&gt; 
&gt; MarpaX::Languages::C::AST::Callback::Events::_subFire_optimized&#40;MarpaX::Languages::C::AST::Callback::Method=ARRAY&#40;0x55b91544ded0&#41;,
&gt; MarpaX::Languages::C::AST::Callback::Events=ARRAY&#40;0x55b912393150&#41;,
&gt; ARRAY&#40;0x55b91588f4e8&#41;, &#34;declarationCheck&#34;,
&gt; MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x55b91209b9f0&#41;,
&gt; HASH&#40;0x55b912483ac0&#41;, HASH&#40;0x55b9154307f0&#41;&#41; called at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm line
&gt; 389
&gt; 
&gt; MarpaX::Languages::C::AST::Callback::_fire&#40;MarpaX::Languages::C::AST::Callback::Events=ARRAY&#40;0x55b912393150&#41;&#41;
&gt; called at
&gt; /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm
&gt; line 204
&gt;         MarpaX::Languages::C::AST::Callback::exec&#40;undef,
&gt; &#34;translationUnit\$&#34;, &#34;^externalDeclaration&#34;, &#34;declarationCheck\$&#34;&#41;
&gt; called
&gt; at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST.pm line 262
&gt; 
&gt; MarpaX::Languages::C::AST::_doEvents&#40;MarpaX::Languages::C::AST=HASH&#40;0x55b91538b8c8&#41;&#41;
&gt; called at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST.pm line
&gt; 171
&gt; 
&gt; MarpaX::Languages::C::AST::parse&#40;MarpaX::Languages::C::AST=HASH&#40;0x55b91538b8c8&#41;,
&gt; SCALAR&#40;0x55b9118dd398&#41;&#41; called at ./make_uv_wrapper.pl line 32
&gt; 
&gt; 
&gt; Am I doing something wrong? Looking at the source &#40;and a bit of debug
&gt; output&#41;, I can&#39;t see how I&#39;d have any influence there. It seems to
&gt; happen
&gt; the very first time it uses this code path.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;12&nbsp;13:44:17&nbsp;2017</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;18&nbsp;06:14:02&nbsp;2017</span>
    <span class="description">kai.extern [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #120214] $token undef @ MarpaX/Languages/C/AST/Scope.pm:205</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 18 Feb 2017 11:13:31 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MarpaX-Languages-C-AST [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kai Henningsen &lt;kai.extern [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Jean-Damien Durand via RT &lt;bug-MarpaX-Languages-C-AST@rt.cpan.org&gt; schrieb
am So., 12. Feb. 2017 um 19:44 Uhr:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=120214">https://rt.cpan.org/Ticket/Display.html?id=120214</a></span> &gt;
&gt;
&gt; lazy option is dangerous. You should not send an already preprocessed
&gt; output, i.e:
&gt;
&gt; perl -Ilib -MMarpaX::Languages::C::AST -e
&gt; &#39;MarpaX::Languages::C::AST-&gt;new-&gt;parse&#40;\shift&#41;&#39; &#34;#include &lt;uv&gt;&#34;
&gt;
</div>
Ok, that doesn&#39;t actually do anything useful. C::AST does not seem to know
how to preprocess anything. &#40;Strace shows it doesn&#39;t try to touch uv.h, and
the result doesn&#39;t contain any relevant data.&#41;

Also, from the docs, lazy actually seems like the SAFE option: in case
there is more than one possible parse, show me all of them.

C::Scan offers a more user-friendly output, at the cost of heavy XML
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; manipulations that make it much slower though:
&gt;
</div>
Yeah, tried that, I&#39;m not so sure about the way it returns the data. I
think I&#39;d probably prefer it less postprocessed and turned into strings I&#39;d
then have to parse myself.


In any case, leaving out lazy does not help, it crashes at the exact same
spot:

Use of uninitialized value $token in hash element at
        /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Scope.pm line
205 &#40;#1&#41;
    &#40;W uninitialized&#41; An undefined value was used as if it were already
    defined.  It was interpreted as a &#34;&#34; or a 0, but maybe it was a mistake.
    To suppress this warning assign a defined value to your variables.

    To help you figure out what was undefined, perl will try to tell you
    the name of the variable &#40;if any&#41; that was undefined.  In some cases
    it cannot do this, so it also tells you what operation you used the
    undefined value in.  Note, however, that perl optimizes your program
    and the operation displayed in the warning may not necessarily appear
    literally in your program.  For example, &#34;that $foo&#34; is usually
    optimized into &#34;that &#34; . $foo, and the warning will refer to the
    concatenation &#40;.&#41; operator, even though there is no . in
    your program.

Uncaught exception from user code:
        Use of uninitialized value $token in hash element at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Scope.pm line 205.

MarpaX::Languages::C::AST::Scope::parseObscureTypedef&#40;MarpaX::Languages::C::AST::Scope=HASH&#40;0x5589bb9af820&#41;,
undef&#41; called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm line
380

MarpaX::Languages::C::AST::Callback::Events::_enterOrObscureTypedef&#40;MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x5589bcc0cea0&#41;,
-1, ARRAY&#40;0x5589c03ff3d8&#41;&#41; called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Even

MarpaX::Languages::C::AST::Callback::Events::_declarationCheck&#40;MarpaX::Languages::C::AST::Callback::Method=ARRAY&#40;0x5589bff88268&#41;,
MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x5589bcc0cea0&#41;,
ARRAY&#40;0x5589c03fe750&#41;&#41; called at /usr/lo

MarpaX::Languages::C::AST::Callback::_fire&#40;MarpaX::Languages::C::AST::Callback=ARRAY&#40;0x5589bcc0cea0&#41;&#41;
called at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm
line 204
        MarpaX::Languages::C::AST::Callback::exec&#40;undef, &#34;&lt;process&gt;&#34;&#41;
called at
/usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback/Events.pm line
548

MarpaX::Languages::C::AST::Callback::Events::_subFire_optimized&#40;MarpaX::Languages::C::AST::Callback::Method=ARRAY&#40;0x5589bffc3c18&#41;,
MarpaX::Languages::C::AST::Callback::Events=ARRAY&#40;0x5589bcf04230&#41;,
ARRAY&#40;0x5589c0400378&#41;, &#34;declara

MarpaX::Languages::C::AST::Callback::_fire&#40;MarpaX::Languages::C::AST::Callback::Events=ARRAY&#40;0x5589bcf04230&#41;&#41;
called at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST/Callback.pm
line 204
        MarpaX::Languages::C::AST::Callback::exec&#40;undef,
&#34;translationUnit\$&#34;, &#34;^externalDeclaration&#34;, &#34;declarationCheck\$&#34;&#41; called
at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST.pm line 262

MarpaX::Languages::C::AST::_doEvents&#40;MarpaX::Languages::C::AST=HASH&#40;0x5589bff01610&#41;&#41;
called at /usr/local/share/perl/5.22.2/MarpaX/Languages/C/AST.pm line 171

MarpaX::Languages::C::AST::parse&#40;MarpaX::Languages::C::AST=HASH&#40;0x5589bff01610&#41;,
SCALAR&#40;0x5589bcc46168&#41;&#41; called at ./make_uv_wrapper.pl line 32


So, given that C::Scan and c2ast manage to parse this &#40;although with lots
of callbacks and so on&#41;, what is it missing to actually work?
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
