<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #87784 for Module-Build-Tiny: &#34;Build.PL&#34; options do not persistent for &#34;./Build ...&#34;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #87784 for Module-Build-Tiny: &#34;Build.PL&#34; options do not persistent for &#34;./Build ...&#34;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Module-Build-Tiny">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Module-Build-Tiny">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Module-Build-Tiny">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Module-Build-Tiny">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Module-Build-Tiny">Module-Build-Tiny CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">87784</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Module-Build-Tiny">Module-Build-Tiny</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jrcd83 [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-238392-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-238393-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=87784">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248269" href="/Public/Bug/Display.html?id=87784#txn-1248269">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;11&nbsp;20:14:32&nbsp;2013</span>
    <span class="description">jrcd83 [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> &#34;Build.PL&#34; options do not persistent for &#34;./Build ...&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 11 Aug 2013 20:14:20 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Justin Davis &lt;jrcd83 [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1248269/660366/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660366">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 928b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I noticed a slight discrepancy between MB and MBT&#39;s behavior. MB
behaves in the following way. Options given as command-line arguments
or environment variables during the execution of Build.PL persist for
each call of the generated Build script. The subsequent calls to Build
&#40;eg: ./Build build; ./Build install&#41; behave as if they too were
provided the same options that were provided to the Build.PL script
earlier. MBT does not do any option checking or retention during the
execution of Build.PL.

Personally, I think the option specification in MB is more complicated
than it needs to be. Nonetheless if your goal is to match MB&#39;s
interface as much as possible I would recommend matching this behavior
as well. The current differing behavior caused a surprise in a system
I use for packaging modules.

If you would like I could supply you with a patch. Would you like me
to create a patch for this feature request?

-juster
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248318" href="/Public/Bug/Display.html?id=87784#txn-1248318">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;12&nbsp;03:41:00&nbsp;2013</span>
    <span class="description">LEONT [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87784] &#34;Build.PL&#34; options do not persistent for &#34;./Build ...&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 12 Aug 2013 10:40:25 +0300</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Leon Timmermans &lt;leont [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1248318/660385/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660385">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Aug 12, 2013 at 3:14 AM, Justin Davis via RT
&lt;bug-Module-Build-Tiny@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I noticed a slight discrepancy between MB and MBT&#39;s behavior. MB
&gt; behaves in the following way. Options given as command-line arguments
&gt; or environment variables during the execution of Build.PL persist for
&gt; each call of the generated Build script. The subsequent calls to Build
&gt; &#40;eg: ./Build build; ./Build install&#41; behave as if they too were
&gt; provided the same options that were provided to the Build.PL script
&gt; earlier. MBT does not do any option checking or retention during the
&gt; execution of Build.PL.
</div>
Module::Build::Tiny does retain configuration stage arguments. It
doesn&#39;t interpret it until build time, but that shouldn&#39;t matter.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Personally, I think the option specification in MB is more complicated
&gt; than it needs to be. Nonetheless if your goal is to match MB&#39;s
&gt; interface as much as possible I would recommend matching this behavior
&gt; as well. The current differing behavior caused a surprise in a system
&gt; I use for packaging modules.
</div>
Are you sure this is the cause of your problem, and not something else?

Leon
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248319" href="/Public/Bug/Display.html?id=87784#txn-1248319">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;12&nbsp;03:41:00&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248532" href="/Public/Bug/Display.html?id=87784#txn-1248532">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;12&nbsp;15:07:35&nbsp;2013</span>
    <span class="description">jrcd83 [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87784] &#34;Build.PL&#34; options do not persistent for &#34;./Build ...&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 12 Aug 2013 15:07:19 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Justin Davis &lt;jrcd83 [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1248532/660513/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660513">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oh yes, now I see the parts with the _build_params file. I&#39;m not sure
why that didn&#39;t click. I&#39;m sorry!

The problem I was having is that I have been using environment
variables, which are also retained in MB, and not retained in MBT.

On Mon, Aug 12, 2013 at 3:41 AM, Leon Timmermans via RT
&lt;bug-Module-Build-Tiny@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87784">https://rt.cpan.org/Ticket/Display.html?id=87784</a></span> &gt;
&gt;
&gt; On Mon, Aug 12, 2013 at 3:14 AM, Justin Davis via RT
&gt; &lt;bug-Module-Build-Tiny@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;&gt; I noticed a slight discrepancy between MB and MBT&#39;s behavior. MB
&gt;&gt; behaves in the following way. Options given as command-line arguments
&gt;&gt; or environment variables during the execution of Build.PL persist for
&gt;&gt; each call of the generated Build script. The subsequent calls to Build
&gt;&gt; &#40;eg: ./Build build; ./Build install&#41; behave as if they too were
&gt;&gt; provided the same options that were provided to the Build.PL script
&gt;&gt; earlier. MBT does not do any option checking or retention during the
&gt;&gt; execution of Build.PL.
</div>&gt;
&gt; Module::Build::Tiny does retain configuration stage arguments. It
&gt; doesn&#39;t interpret it until build time, but that shouldn&#39;t matter.
&gt;
<div class="message-stanza open">&gt;&gt; Personally, I think the option specification in MB is more complicated
&gt;&gt; than it needs to be. Nonetheless if your goal is to match MB&#39;s
&gt;&gt; interface as much as possible I would recommend matching this behavior
&gt;&gt; as well. The current differing behavior caused a surprise in a system
&gt;&gt; I use for packaging modules.
</div>&gt;
&gt; Are you sure this is the cause of your problem, and not something else?
&gt;
&gt; Leon
&gt;
</div>


-- 
-Justin
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248699" href="/Public/Bug/Display.html?id=87784#txn-1248699">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;13&nbsp;05:43:11&nbsp;2013</span>
    <span class="description">fawaka [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87784] &#34;Build.PL&#34; options do not persistent for &#34;./Build ...&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Aug 2013 12:42:33 +0300</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Leon Timmermans &lt;fawaka [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1248699/660603/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660603">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 924b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Aug 12, 2013 at 10:07 PM, Justin Davis via RT
&lt;bug-Module-Build-Tiny@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Oh yes, now I see the parts with the _build_params file. I&#39;m not sure
&gt; why that didn&#39;t click. I&#39;m sorry!
&gt;
&gt; The problem I was having is that I have been using environment
&gt; variables, which are also retained in MB, and not retained in MBT.
</div>
MB is applying PERL_MB_OPT twice, once during «perl Build.PL» and once
during the «./Build» stages. This is certainly the wrong thing. We
have had a discussion about that in context of the Build.PL
specification but didn&#39;t reach a firm conclusison, but what you&#39;re
proposing would probably be the right thing &#40;though I don&#39;t think you
should have been changing the environmental variable mid-build in the
first place&#41;

I&#39;ll probably change this in the next release.

Leon

P.S. What are you using for packaging that is causing these issues?
I&#39;m not aware of anything that does.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248769" href="/Public/Bug/Display.html?id=87784#txn-1248769">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;13&nbsp;09:06:33&nbsp;2013</span>
    <span class="description">jrcd83 [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87784] &#34;Build.PL&#34; options do not persistent for &#34;./Build ...&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Aug 2013 09:06:19 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build-Tiny [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Justin Davis &lt;jrcd83 [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1248769/660647/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660647">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I certainly find the environment variable handling kludgey but whether
or not it is &#34;wrong&#34; depends on your definition of &#34;right.&#34; If a
minimalist and transparent design is &#34;right&#34; then I would certainly
agree with you.

CPANPLUS::Dist::Arch is a module I created for automatically packaging
CPAN modules into ArchLinux packages as they are installed. The reason
the environment variables change is because each stage of the
packaging is run in a distinct sub-shell. This means &#34;perl Build.PL&#34;,
&#34;./Build build&#34;, and &#34;./Build install&#34; are all called in a separate
sub-shell. After &#34;Build.PL&#34; is called there is no longer any
environment variable set.

The decision to use environment variables instead of command line
arguments was purely an aesthetic one. I liked having the options all
set in one location instead of spread across the packaging stages.
Another advantage is that this prevents env vars set by users &#40;or
perlbrew&#41; from leaking in and changing the behavior of the build
process. The build process should hopefully be building modules for
use system-wide and act the same for everyone.

The following is a PKGBUILD generated automatically that uses env
vars. This is essentially a fancy bash script which is sourced by
another script that specifies how to build the perl-libwww package.

<span class="clickylink"><a target="new" rel="nofollow" href="https://projects.archlinux.org/svntogit/packages.git/tree/trunk/PKGBUILD?h=packages/perl-libwww&#38;id=3d7b38be80fad5d5292b986a1453f209c838d3cb">https://projects.archlinux.org/svntogit/packages.git/tree/trunk/PKGBUILD?h=packages/perl-libwww&#38;id=3d7b38be80fad5d5292b986a1453f209c838d3cb</a></span>

Thank you for your time and your hard work on this module and all the
many others.

On Tue, Aug 13, 2013 at 5:43 AM, Leon Timmermans via RT
&lt;bug-Module-Build-Tiny@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87784">https://rt.cpan.org/Ticket/Display.html?id=87784</a></span> &gt;
&gt;
&gt; On Mon, Aug 12, 2013 at 10:07 PM, Justin Davis via RT
&gt; &lt;bug-Module-Build-Tiny@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;&gt; Oh yes, now I see the parts with the _build_params file. I&#39;m not sure
&gt;&gt; why that didn&#39;t click. I&#39;m sorry!
&gt;&gt;
&gt;&gt; The problem I was having is that I have been using environment
&gt;&gt; variables, which are also retained in MB, and not retained in MBT.
</div>&gt;
&gt; MB is applying PERL_MB_OPT twice, once during «perl Build.PL» and once
&gt; during the «./Build» stages. This is certainly the wrong thing. We
&gt; have had a discussion about that in context of the Build.PL
&gt; specification but didn&#39;t reach a firm conclusison, but what you&#39;re
&gt; proposing would probably be the right thing &#40;though I don&#39;t think you
&gt; should have been changing the environmental variable mid-build in the
&gt; first place&#41;
&gt;
&gt; I&#39;ll probably change this in the next release.
&gt;
&gt; Leon
&gt;
&gt; P.S. What are you using for packaging that is causing these issues?
&gt; I&#39;m not aware of anything that does.
&gt;
</div>


-- 
-Justin
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1251202" href="/Public/Bug/Display.html?id=87784#txn-1251202">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;19&nbsp;17:23:19&nbsp;2013</span>
    <span class="description">LEONT [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1251202/662061/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/662061">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 359b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 12 15:07:35 2013, jrcd83@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Oh yes, now I see the parts with the _build_params file. I&#39;m not sure
&gt; why that didn&#39;t click. I&#39;m sorry!
&gt; 
&gt; The problem I was having is that I have been using environment
&gt; variables, which are also retained in MB, and not retained in MBT.
&gt; 
</div>
This problem is fixed in Module::Build::Tiny 0.026.

Leon
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1251204" href="/Public/Bug/Display.html?id=87784#txn-1251204">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;19&nbsp;17:23:19&nbsp;2013</span>
    <span class="description">LEONT [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.38591</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
