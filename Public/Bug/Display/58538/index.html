<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #58538 for SOAP-Lite: regression from 0.710.08 soap:Client,Application failed during request deserialization</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #58538 for SOAP-Lite: regression from 0.710.08 soap:Client,Application failed during request deserialization</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/SOAP-Lite/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/SOAP-Lite/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/SOAP-Lite/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/SOAP-Lite/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/SOAP-Lite">SOAP-Lite CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">58538</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/SOAP-Lite/Active/">SOAP-Lite</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
michaelgang [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-29122-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.712    </td>
  </tr>
  <tr id="CF-29123-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;20&nbsp;07:32:03&nbsp;2010</span>
    <span class="description">michaelgang [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> regression from 0.710.08 soap:Client,Application failed during
 request deserialization</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi all,

I have a problem when sending an xml on solaris SunOS 5.9
Generic_122300-29 sun4u sparc SUNW,Sun-Fire-V240
and perl v5.10.1
The xml begins with
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;soap:Envelope
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;
xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
xmlns:apachens=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://xml.apache.org/xml-soap">http://xml.apache.org/xml-soap</a></span>&#34;
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34;
soap:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34;&gt;&lt;soap:Body&gt;&lt;find_services
xmlns=&#34;SFXMenu/SOAP&#34;&gt;
and ends with
&lt;/find_services&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;
In tracing we have 

SOAP::Transport::new: &#40;&#41;
SOAP::Serializer::new: &#40;&#41;
SOAP::Deserializer::new: &#40;&#41;
SOAP::Parser::new: &#40;&#41;
SOAP::Server::new: &#40;&#41;
SOAP::Transport::HTTP::Server::new: &#40;&#41;
SOAP::Transport::HTTP::CGI::new: &#40;&#41;
SOAP::Transport::HTTP::Server::handle: 
SOAP::Server::handle: &#40;&#41;
SOAP::Deserializer::deserialize: &#40;&#41;
SOAP::Parser::decode: &#40;&#41;
SOAP::Serializer::envelope: &#40;&#41;
SOAP::Serializer::envelope: Client Application failed during request
deserialization: 
no element found at line 1, column 0, byte -1 at XML/Parser.pm line 187
  
SOAP::Data::new: &#40;&#41;
SOAP::Data::new: &#40;&#41;
SOAP::Data::new: &#40;&#41;
SOAP::Data::new: &#40;&#41;
SOAP::Data::new: &#40;&#41;
SOAP::Data::new: &#40;&#41;
SOAP::Data::new: &#40;&#41;
SOAP::Transport::HTTP::CGI::DESTROY: &#40;&#41;
SOAP::Serializer::DESTROY: &#40;&#41;
SOAP::Data::DESTROY: &#40;&#41;
SOAP::Data::DESTROY: &#40;&#41;
SOAP::Data::DESTROY: &#40;&#41;
SOAP::Data::DESTROY: &#40;&#41;
SOAP::Data::DESTROY: &#40;&#41;
SOAP::Data::DESTROY: &#40;&#41;
SOAP::Data::DESTROY: &#40;&#41;
SOAP::Transport::DESTROY: &#40;&#41;
SOAP::Deserializer::DESTROY: &#40;&#41;
SOAP::Parser::DESTROY: &#40;&#41;

With version 7.10.08 we have the lines
SOAP::SOM::new: &#40;&#41;

SOAP::Data::new: &#40;&#41;

SOAP::Data::DESTROY: &#40;&#41;

&#40;eval&#41;: ARRAY&#40;0xaa8b9f8&#41; 0 sfxtst4

SOAP::Server::handle: ARRAY&#40;0xa9de3e0&#41;

which are missing from the new version
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;24&nbsp;07:22:18&nbsp;2010</span>
    <span class="description">michaelgang [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> michaelgang [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think I found the problem.
In the function SOAP::Transport::HTTP::CGI::handle  when changing
sysread&#40; STDIN, $buffer, $length &#41;
to read&#40; STDIN, $buffer, $length &#41; everything works perfect.
Interesting why

On Sun Jun 20 07:32:03 2010, michaelg wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi all,
&gt; 
&gt; I have a problem when sending an xml on solaris SunOS 5.9
&gt; Generic_122300-29 sun4u sparc SUNW,Sun-Fire-V240
&gt; and perl v5.10.1
&gt; The xml begins with
&gt; &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;soap:Envelope
&gt; xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;
&gt; xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
&gt; xmlns:apachens=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://xml.apache.org/xml-soap">http://xml.apache.org/xml-soap</a></span>&#34;
&gt; xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34;
&gt; soap:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
&gt;
</div>xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34;&gt;&lt;soap:Body&gt;&lt;find_services
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; xmlns=&#34;SFXMenu/SOAP&#34;&gt;
&gt; and ends with
&gt; &lt;/find_services&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;
&gt; In tracing we have
&gt; 
&gt; SOAP::Transport::new: &#40;&#41;
&gt; SOAP::Serializer::new: &#40;&#41;
&gt; SOAP::Deserializer::new: &#40;&#41;
&gt; SOAP::Parser::new: &#40;&#41;
&gt; SOAP::Server::new: &#40;&#41;
&gt; SOAP::Transport::HTTP::Server::new: &#40;&#41;
&gt; SOAP::Transport::HTTP::CGI::new: &#40;&#41;
&gt; SOAP::Transport::HTTP::Server::handle:
&gt; SOAP::Server::handle: &#40;&#41;
&gt; SOAP::Deserializer::deserialize: &#40;&#41;
&gt; SOAP::Parser::decode: &#40;&#41;
&gt; SOAP::Serializer::envelope: &#40;&#41;
&gt; SOAP::Serializer::envelope: Client Application failed during request
&gt; deserialization:
&gt; no element found at line 1, column 0, byte -1 at XML/Parser.pm line
&gt; 187
&gt; 
&gt; SOAP::Data::new: &#40;&#41;
&gt; SOAP::Data::new: &#40;&#41;
&gt; SOAP::Data::new: &#40;&#41;
&gt; SOAP::Data::new: &#40;&#41;
&gt; SOAP::Data::new: &#40;&#41;
&gt; SOAP::Data::new: &#40;&#41;
&gt; SOAP::Data::new: &#40;&#41;
&gt; SOAP::Transport::HTTP::CGI::DESTROY: &#40;&#41;
&gt; SOAP::Serializer::DESTROY: &#40;&#41;
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; SOAP::Transport::DESTROY: &#40;&#41;
&gt; SOAP::Deserializer::DESTROY: &#40;&#41;
&gt; SOAP::Parser::DESTROY: &#40;&#41;
&gt; 
&gt; With version 7.10.08 we have the lines
&gt; SOAP::SOM::new: &#40;&#41;
&gt; 
&gt; SOAP::Data::new: &#40;&#41;
&gt; 
&gt; SOAP::Data::DESTROY: &#40;&#41;
&gt; 
&gt; &#40;eval&#41;: ARRAY&#40;0xaa8b9f8&#41; 0 sfxtst4
&gt; 
&gt; SOAP::Server::handle: ARRAY&#40;0xa9de3e0&#41;
&gt; 
&gt; which are missing from the new version
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;13&nbsp;23:11:13&nbsp;2010</span>
    <span class="description">http://nneul.myopenid.com/ -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> nneul [...] mst.edu</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The reason it&#39;s a problem is that under mod_perl, STDIN is not a real
filehandle - it&#39;s mapped to the request object. CORE:: file operations
&#40;read/print/etc.&#41; work fine, but sysread specifically tries to treat as
a file handle.

Please fix this... It makes SOAP::Lite unusable as a server under
mod_perl using cgi style code.

On Thu Jun 24 07:22:18 2010, michaelg wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think I found the problem.
&gt; In the function SOAP::Transport::HTTP::CGI::handle  when changing
&gt; sysread&#40; STDIN, $buffer, $length &#41;
&gt; to read&#40; STDIN, $buffer, $length &#41; everything works perfect.
&gt; Interesting why
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;13&nbsp;23:11:14&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;20&nbsp;17:48:02&nbsp;2010</span>
    <span class="description">mkanat [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This bug breaks Bugzilla&#39;s XML-RPC interface, and has been doing so for 
several months at this point. The fix is to delete three characters from 
one file. Any chance of getting this fix into the next release of 
SOAP::Lite?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;05&nbsp;11:59:39&nbsp;2010</span>
    <span class="description">martin.kutter [...] fen-net.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #58538] regression from 0.710.08 soap:Client,Application failed during request deserialization</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 05 Sep 2010 17:59:27 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SOAP-Lite [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Martin Kutter &lt;martin.kutter [...] fen-net.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

it&#39;s not just three characters: The change from read&#40;&#41; to sysread&#40;&#41; was
introduced due to another bug report &#40;have to look up the number&#41;, which
reported read&#40;&#41; to be broken under windows &#40;never returns 0 to indicate
the request was read completely&#41;.

So a correct fix would have to determine whether the current program is
running under mod_perl &#40;and which version of it&#41; and use the appropriate
method for reading input.

Best regards,

Martin

Am Freitag, den 20.08.2010, 17:48 -0400 schrieb Max Kanat-Alexander via
RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Queue: SOAP-Lite
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=58538">https://rt.cpan.org/Ticket/Display.html?id=58538</a></span> &gt;
&gt; 
&gt; This bug breaks Bugzilla&#39;s XML-RPC interface, and has been doing so for 
&gt; several months at this point. The fix is to delete three characters from 
&gt; one file. Any chance of getting this fix into the next release of 
&gt; SOAP::Lite?
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;30&nbsp;06:32:32&nbsp;2010</span>
    <span class="description">mkanat [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Sep 05 11:59:39 2010, martin.kutter@fen-net.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So a correct fix would have to determine whether the current program is
&gt; running under mod_perl &#40;and which version of it&#41; and use the 
</div>appropriate
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; method for reading input.
</div>
  Okay. So that&#39;s perhaps five lines, then. Any hope that somebody will 
do it?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;05&nbsp;11:13:49&nbsp;2010</span>
    <span class="description">vittal.id [...] aithal.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> vittal.id [...] aithal.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   Okay. So that&#39;s perhaps five lines, then. Any hope that somebody will 
&gt; do it?
</div>
Attached is a patch that simply checks for MOD_PERL and if set, uses
read, otherwise uses sysread. Works for me.

Regards
Vittal
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> soap-transport-http-mod-perl-patch.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/SOAP/Transport/HTTP.pm.orig	2010-10-05 16:06:05.563710856 +0100
+++ lib/SOAP/Transport/HTTP.pm	2010-10-05 16:09:20.142813758 +0100
@@ -566,9 +566,16 @@
         if &#40; !$chunked &#41; {
             my $buffer;
             binmode&#40;STDIN&#41;;
-            while &#40; sysread&#40; STDIN, $buffer, $length &#41; &#41; {
-                $content .= $buffer;
-                last if &#40; length&#40;$content&#41; &gt;= $length &#41;;
+            if &#40; defined $ENV{&#39;MOD_PERL&#39;} &#41; {
+                while &#40; read&#40; STDIN, $buffer, $length &#41; &#41; {
+                    $content .= $buffer;
+                    last if &#40; length&#40;$content&#41; &gt;= $length &#41;;
+                }
+            } else {
+                while &#40; sysread&#40; STDIN, $buffer, $length &#41; &#41; {
+                    $content .= $buffer;
+                    last if &#40; length&#40;$content&#41; &gt;= $length &#41;;
+                }
             }
         }
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;20&nbsp;15:03:12&nbsp;2010</span>
    <span class="description">martin.kutter [...] fen-net.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #58538] regression from 0.710.08 soap:Client,Application failed during request deserialization</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 Oct 2010 21:02:55 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SOAP-Lite [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Martin Kutter &lt;martin.kutter [...] fen-net.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

thanks for the patch - which mod_perl versions have you tested with?

Unfortunately, there&#39;s mod_perl 1.x, mod_perl 2, and due to a
infavourable redhat release, mod_perl 1.99. It&#39;s not magic though -
there&#39;s other parts in the code which check for mod_perl &#40;and which
mod_perl version there is&#41;.

Best regards,

Martin

Am Dienstag, den 05.10.2010, 11:13 -0400 schrieb Vittal Aithal via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Queue: SOAP-Lite
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=58538">https://rt.cpan.org/Ticket/Display.html?id=58538</a></span> &gt;
&gt; 
<div class="message-stanza open">&gt; &gt;   Okay. So that&#39;s perhaps five lines, then. Any hope that somebody will 
&gt; &gt; do it?
</div>&gt; 
&gt; Attached is a patch that simply checks for MOD_PERL and if set, uses
&gt; read, otherwise uses sysread. Works for me.
&gt; 
&gt; Regards
&gt; Vittal
&gt; Einfaches Textdokument-Anlage &#40;soap-transport-http-mod-perl-patch.txt&#41;
&gt; --- lib/SOAP/Transport/HTTP.pm.orig   2010-10-05 16:06:05.563710856 +0100
&gt; +++ lib/SOAP/Transport/HTTP.pm        2010-10-05 16:09:20.142813758 +0100
&gt; @@ -566,9 +566,16 @@
&gt;          if &#40; !$chunked &#41; {
&gt;              my $buffer;
&gt;              binmode&#40;STDIN&#41;;
&gt; -            while &#40; sysread&#40; STDIN, $buffer, $length &#41; &#41; {
&gt; -                $content .= $buffer;
&gt; -                last if &#40; length&#40;$content&#41; &gt;= $length &#41;;
&gt; +            if &#40; defined $ENV{&#39;MOD_PERL&#39;} &#41; {
&gt; +                while &#40; read&#40; STDIN, $buffer, $length &#41; &#41; {
&gt; +                    $content .= $buffer;
&gt; +                    last if &#40; length&#40;$content&#41; &gt;= $length &#41;;
&gt; +                }
&gt; +            } else {
&gt; +                while &#40; sysread&#40; STDIN, $buffer, $length &#41; &#41; {
&gt; +                    $content .= $buffer;
&gt; +                    last if &#40; length&#40;$content&#41; &gt;= $length &#41;;
&gt; +                }
&gt;              }
&gt;          }
&gt;  
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;02&nbsp;10:34:33&nbsp;2010</span>
    <span class="description">mkanat [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The mod_perl version shouldn&#39;t make a difference there, they both bind 
STDIN and STDOUT. Also, there are only two mod_perl APIs, 1 and 2. Early 
versions of 1.99 have API 1 and later versions have API 2. So just 
checking for MOD_PERL should be all that&#39;s needed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;23&nbsp;12:48:17&nbsp;2011</span>
    <span class="description">idl0r [...] qasl.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> idl0r [...] qasl.de</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Is there any progress on this issue?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;15&nbsp;13:46:44&nbsp;2011</span>
    <span class="description">kutterma [...] users.sourceforge.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Applied in SVN in #378.

Thanks for reporting, and for the patch.

Best regards,

MArtin
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;15&nbsp;13:46:45&nbsp;2011</span>
    <span class="description">kutterma [...] users.sourceforge.net -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;18&nbsp;16:33:50&nbsp;2011</span>
    <span class="description">kutterma [...] users.sourceforge.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">fixed in &gt;= 0.713
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;18&nbsp;16:33:51&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;18&nbsp;16:33:51&nbsp;2011</span>
    <span class="description">kutterma [...] users.sourceforge.net -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
