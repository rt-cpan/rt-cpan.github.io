<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #44885 for Net-DNS: bug&#40;?&#41;: Net::DNS returns empty string instead of &#34;.&#34; for root</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #44885 for Net-DNS: bug&#40;?&#41;: Net::DNS returns empty string instead of &#34;.&#34; for root</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-DNS/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">44885</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-DNS/Active/">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dlamacchia [...] cloudmark.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;08&nbsp;19:59:17&nbsp;2009</span>
    <span class="description">dlamacchia [...] cloudmark.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> bug&#40;?&#41;: Net::DNS returns empty string instead of &#34;.&#34; for root</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 8 Apr 2009 16:58:51 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Net-DNS [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David LaMacchia &lt;dlamacchia [...] cloudmark.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi there,

According to RFC 2181, &#34;The zero length full name is defined as  
representing the root of the DNS tree, and is typically written and  
displayed as &#34;.&#34; .&#34;  I&#39;ve found that Net::DNS &#40;latest, 0.65&#41; returns  
&#34;&#34; &#40;empty string&#41; instead of &#34;.&#34; for these domains, whereas dig/host/ 
nslookup/etc. return &#34;.&#34;  I work for an anti-spam company and we&#39;ve  
found a lot of spammy IPs that exhibit this issue.

You may disagree that this needs to be fixed -- the RFC says that the  
root is *typically* written but this is not a requirement that MUST be  
followed.  However, due to the disagreement with dig/host/nslookup/etc  
I&#39;m submitting the issue.

Basic information:

Distribution name and version: Net-DNS-0.65 &#40;latest&#41;
Perl version: perl v5.8.8 &#40;i486-linux-gnu-thread-multi&#41;
Operating System vendor and version: Linux freeside 2.6.24-22-generic  
#1 SMP Mon Nov 24 18:32:42 UTC 2008 i686 GNU/Linux &#40;this is Ubuntu,  
hardy heron&#41;.

Sample data:

Here&#39;s an IP and the output from dig:

% dig -x 74.63.95.254

; &lt;&lt;&gt;&gt; DiG 9.4.2-P2 &lt;&lt;&gt;&gt; -x 74.63.95.254
;; global options:  printcmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 20464
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;254.95.63.74.in-addr.arpa.     IN      PTR

;; ANSWER SECTION:
254.95.63.74.in-addr.arpa. 10186 IN     PTR     .

;; Query time: 3 msec
;; SERVER: 172.20.0.21#53&#40;172.20.0.21&#41;
;; WHEN: Wed Apr  8 16:32:22 2009
;; MSG SIZE  rcvd: 56

&#40;note the &#39;.&#39; above&#41;

I ran wireshark an looked at the answer packet data:

Domain Name System &#40;response&#41;
     [Request In: 714]
     [Time: 0.000556000 seconds]
     Transaction ID: 0xcfa1
     Flags: 0x8180 &#40;Standard query response, No error&#41;
     Questions: 1
     Answer RRs: 1
     Authority RRs: 0
     Additional RRs: 0
     Queries
         254.95.63.74.in-addr.arpa: type PTR, class IN
             Name: 254.95.63.74.in-addr.arpa
             Type: PTR &#40;Domain name pointer&#41;
             Class: IN &#40;0x0001&#41;
     Answers
         254.95.63.74.in-addr.arpa: type PTR, class IN, &lt;Root&gt;
             Name: 254.95.63.74.in-addr.arpa
             Type: PTR &#40;Domain name pointer&#41;
             Class: IN &#40;0x0001&#41;
             Time to live: 2 hours, 36 minutes, 24 seconds
             Data length: 1
             Domain name: &lt;Root&gt;

0000  00 0f fe 89 c0 8b 00 11 20 d1 8d c6 08 00 45 00   ........ .....E.
0010  00 54 5a cd 00 00 7f 11 86 0e ac 14 00 15 ac 14   .TZ.............
0020  02 80 00 35 a5 3f 00 40 c3 13 cf a1 81 80 00 01   ...5.?.@........
0030  00 01 00 00 00 00 03 32 35 34 02 39 35 02 36 33   .......254.95.63
0040  02 37 34 07 69 6e 2d 61 64 64 72 04 61 72 70 61   .74.in-addr.arpa
0050  00 00 0c 00 01 c0 0c 00 0c 00 01 00 00 24 a8 00   .............$..
0060  01 00

Those last two bytes are the answer length &#40;01&#41; and the data &#40;00&#41;.

I made a patch for both netdns.c &#40;netdns_dn_expand&#41; and Packet.pm  
&#40;dn_expand_PP&#41;.  I&#39;m not claiming the patch is perfect, but it should  
at least be a start.  I&#39;ve attached the patches.

Thanks!

-dave
</div></div>
</div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza">Hi there,
<div><br></div>
<div>According to RFC 2181, "The zero length full name is defined as representing the root of the DNS tree, and is typically written and displayed as "." ." &nbsp;I've found that Net::DNS (latest, 0.65) returns "" (empty string) instead of "." for these domains, whereas dig/host/nslookup/etc. return "." &nbsp;I work for an anti-spam company and we've found a lot of spammy IPs that exhibit this issue.</div>
<div><br></div>
<div>You may disagree that this needs to be fixed -- the RFC says that the root is *typically* written but this is not a requirement that MUST be followed. &nbsp;However, due to the disagreement with dig/host/nslookup/etc I'm submitting the issue.</div>
<div><br></div>
<div>Basic information:</div>
<div><br></div>
<div>Distribution name and version: Net-DNS-0.65 (latest)</div>
<div>Perl version: perl v5.8.8 (i486-linux-gnu-thread-multi)</div>
<div><font face="Verdana" size="3"><span style="font-size: 11px;">Operating System vendor and version:&nbsp;Linux freeside 2.6.24-22-generic #1 SMP Mon Nov 24 18:32:42 UTC 2008 i686 GNU/Linux (this is Ubuntu, hardy heron).</span></font></div>
<div><font face="Verdana" size="3"><span style="font-size: 11px;"><br></span></font></div>
<div><font face="Verdana" size="3"><span style="font-size: 11px;">Sample data:</span></font></div>
<div><font face="Verdana" size="3"><span style="font-size: 11px;"><br></span></font></div>
<div><font face="Verdana" size="3"><span style="font-size: 11px;">Here's an IP and the output from dig:</span></font></div>
<div><font face="Verdana" size="3"><span style="font-size: 11px;"><br></span></font></div>
<div><font face="Verdana" size="3"><span style="font-size: 11px;"><div>% dig -x 74.63.95.254</div><div><br></div><div>; &lt;&lt;&gt;&gt; DiG 9.4.2-P2 &lt;&lt;&gt;&gt; -x 74.63.95.254</div><div>;; global options: &nbsp;printcmd</div><div>;; Got answer:</div><div>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 20464</div><div>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</div><div><br></div><div>;; QUESTION SECTION:</div><div>;254.95.63.74.in-addr.arpa. &nbsp; &nbsp; IN &nbsp; &nbsp; &nbsp;PTR</div><div><br></div><div>;; ANSWER SECTION:</div><div>254.95.63.74.in-addr.arpa. 10186 IN &nbsp; &nbsp; PTR &nbsp; &nbsp; .</div><div><br></div><div>;; Query time: 3 msec</div><div>;; SERVER: 172.20.0.21#53(172.20.0.21)</div><div>;; WHEN: Wed Apr &nbsp;8 16:32:22 2009</div><div>;; MSG SIZE &nbsp;rcvd: 56</div><div><br></div><div>(note the '.' above)</div><div><br></div><div>I ran wireshark an looked at the answer packet data:</div><div><br></div><div><div><div>Domain Name System (response)</div><div>&nbsp;&nbsp; &nbsp;[Request In: 714]</div><div>&nbsp;&nbsp; &nbsp;[Time: 0.000556000 seconds]</div><div>&nbsp;&nbsp; &nbsp;Transaction ID: 0xcfa1</div><div>&nbsp;&nbsp; &nbsp;Flags: 0x8180 (Standard query response, No error)</div><div>&nbsp;&nbsp; &nbsp;Questions: 1</div><div>&nbsp;&nbsp; &nbsp;Answer RRs: 1</div><div>&nbsp;&nbsp; &nbsp;Authority RRs: 0</div><div>&nbsp;&nbsp; &nbsp;Additional RRs: 0</div><div>&nbsp;&nbsp; &nbsp;Queries</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;254.95.63.74.in-addr.arpa: type PTR, class IN</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Name: 254.95.63.74.in-addr.arpa</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type: PTR (Domain name pointer)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Class: IN (0x0001)</div><div>&nbsp;&nbsp; &nbsp;Answers</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;254.95.63.74.in-addr.arpa: type PTR, class IN, &lt;Root&gt;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Name: 254.95.63.74.in-addr.arpa</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Type: PTR (Domain name pointer)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Class: IN (0x0001)</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Time to live: 2 hours, 36 minutes, 24 seconds</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Data length: 1</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Domain name: &lt;Root&gt;</div><div><br></div><div>0000 &nbsp;00 0f fe 89 c0 8b 00 11 20 d1 8d c6 08 00 45 00 &nbsp; ........ .....E.</div><div>0010 &nbsp;00 54 5a cd 00 00 7f 11 86 0e ac 14 00 15 ac 14 &nbsp; .TZ.............</div><div>0020 &nbsp;02 80 00 35 a5 3f 00 40 c3 13 cf a1 81 80 00 01 &nbsp; ...5.?.@........</div><div>0030 &nbsp;00 01 00 00 00 00 03 32 35 34 02 39 35 02 36 33 &nbsp; .......254.95.63</div><div>0040 &nbsp;02 37 34 07 69 6e 2d 61 64 64 72 04 61 72 70 61 &nbsp; .74.in-addr.arpa</div><div>0050 &nbsp;00 00 0c 00 01 c0 0c 00 0c 00 01 00 00 24 a8 00 &nbsp; .............$..</div><div>0060 &nbsp;01 00 &nbsp; &nbsp;</div><div><br></div><div>Those last two bytes are the answer length (01) and the data (00).</div><div><br></div><div>I made a patch for both netdns.c (netdns_dn_expand) and Packet.pm (dn_expand_PP). &nbsp;I'm not claiming the patch is perfect, but it should at least be a start. &nbsp;I've attached the patches.</div><div><br></div><div>Thanks!</div><div><br></div><div>-dave</div></div></div></span></font></div>
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza"><div><font face="Verdana" size="3"><span style="font-size: 11px;"><div><div><div></div></div></div></span></font></div>
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza"><div><font face="Verdana" size="3"><span style="font-size: 11px;"><div><div><div></div><div><br></div><div><br></div></div><div><br></div></div></span></font></div>
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;09&nbsp;12:42:36&nbsp;2009</span>
    <span class="description">olaf [...] dacht.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #44885] bug&#40;?&#41;: Net::DNS returns empty string instead of &#34;.&#34; for root </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 9 Apr 2009 18:41:23 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Olaf Kolkman &lt;olaf [...] dacht.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Since this is a presentation rather than a parsing issue, the patch is  
actually only needed for PTR.pm.

Internally &#40;and that is a historic artifact&#41; all domain names are  
stored as fully qualified domain names without trailing dots &#40;and as  
strings, not as octet sequences&#41;. Messing with the parsing would not  
help and create inconsistencies.


--- lib/Net/DNS/RR/PTR.pm       &#40;revision 794&#41;
+++ lib/Net/DNS/RR/PTR.pm       &#40;working copy&#41;
@@ -33,8 +33,8 @@

  sub rdatastr {
        my $self = shift;
-
-       return $self-&gt;{&#34;ptrdname&#34;} ? &#34;$self-&gt;{ptrdname}.&#34; : &#39;&#39;;
+       return &#34;&#34; unless defined $self-&gt;{ptrdname};
+       return $self-&gt;{&#34;ptrdname&#34;} ? &#34;$self-&gt;{ptrdname}.&#34; : &#39;.&#39;;
  }

  sub rr_rdata {





Should do the trick.

--Olaf




On 9 apr 2009, at 01:59, David LaMacchia via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Wed Apr 08 19:59:17 2009: Request 44885 was acted upon.
&gt; Transaction: Ticket created by dlamacchia@cloudmark.com
&gt;       Queue: Net-DNS
&gt;     Subject: bug&#40;?&#41;: Net::DNS returns empty string instead of &#34;.&#34;  
&gt; for root
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: &#40;no value&#41;
&gt;       Owner: Nobody
&gt;  Requestors: dlamacchia@cloudmark.com
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=44885">http://rt.cpan.org/Ticket/Display.html?id=44885</a></span> &gt;
&gt;
&gt;
&gt; Hi there,
&gt;
&gt; According to RFC 2181, &#34;The zero length full name is defined as
&gt; representing the root of the DNS tree, and is typically written and
&gt; displayed as &#34;.&#34; .&#34;  I&#39;ve found that Net::DNS &#40;latest, 0.65&#41; returns
&gt; &#34;&#34; &#40;empty string&#41; instead of &#34;.&#34; for these domains, whereas dig/host/
&gt; nslookup/etc. return &#34;.&#34;  I work for an anti-spam company and we&#39;ve
&gt; found a lot of spammy IPs that exhibit this issue.
&gt;
&gt; You may disagree that this needs to be fixed -- the RFC says that the
&gt; root is *typically* written but this is not a requirement that MUST be
&gt; followed.  However, due to the disagreement with dig/host/nslookup/etc
&gt; I&#39;m submitting the issue.
&gt;
&gt; Basic information:
&gt;
&gt; Distribution name and version: Net-DNS-0.65 &#40;latest&#41;
&gt; Perl version: perl v5.8.8 &#40;i486-linux-gnu-thread-multi&#41;
&gt; Operating System vendor and version: Linux freeside 2.6.24-22-generic
&gt; #1 SMP Mon Nov 24 18:32:42 UTC 2008 i686 GNU/Linux &#40;this is Ubuntu,
&gt; hardy heron&#41;.
&gt;
&gt; Sample data:
&gt;
&gt; Here&#39;s an IP and the output from dig:
&gt;
&gt; % dig -x 74.63.95.254
&gt;
&gt; ; &lt;&lt;&gt;&gt; DiG 9.4.2-P2 &lt;&lt;&gt;&gt; -x 74.63.95.254
&gt; ;; global options:  printcmd
&gt; ;; Got answer:
&gt; ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 20464
&gt; ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
&gt;
&gt; ;; QUESTION SECTION:
&gt; ;254.95.63.74.in-addr.arpa.     IN      PTR
&gt;
&gt; ;; ANSWER SECTION:
&gt; 254.95.63.74.in-addr.arpa. 10186 IN     PTR     .
&gt;
&gt; ;; Query time: 3 msec
&gt; ;; SERVER: 172.20.0.21#53&#40;172.20.0.21&#41;
&gt; ;; WHEN: Wed Apr  8 16:32:22 2009
&gt; ;; MSG SIZE  rcvd: 56
&gt;
&gt; &#40;note the &#39;.&#39; above&#41;
&gt;
&gt; I ran wireshark an looked at the answer packet data:
&gt;
&gt; Domain Name System &#40;response&#41;
&gt;     [Request In: 714]
&gt;     [Time: 0.000556000 seconds]
&gt;     Transaction ID: 0xcfa1
&gt;     Flags: 0x8180 &#40;Standard query response, No error&#41;
&gt;     Questions: 1
&gt;     Answer RRs: 1
&gt;     Authority RRs: 0
&gt;     Additional RRs: 0
&gt;     Queries
&gt;         254.95.63.74.in-addr.arpa: type PTR, class IN
&gt;             Name: 254.95.63.74.in-addr.arpa
&gt;             Type: PTR &#40;Domain name pointer&#41;
&gt;             Class: IN &#40;0x0001&#41;
&gt;     Answers
&gt;         254.95.63.74.in-addr.arpa: type PTR, class IN, &lt;Root&gt;
&gt;             Name: 254.95.63.74.in-addr.arpa
&gt;             Type: PTR &#40;Domain name pointer&#41;
&gt;             Class: IN &#40;0x0001&#41;
&gt;             Time to live: 2 hours, 36 minutes, 24 seconds
&gt;             Data length: 1
&gt;             Domain name: &lt;Root&gt;
&gt;
&gt; 0000  00 0f fe 89 c0 8b 00 11 20 d1 8d c6 08 00 45  
&gt; 00   ........ .....E.
&gt; 0010  00 54 5a cd 00 00 7f 11 86 0e ac 14 00 15 ac  
&gt; 14   .TZ.............
&gt; 0020  02 80 00 35 a5 3f 00 40 c3 13 cf a1 81 80 00 01   ... 
&gt; 5.?.@........
&gt; 0030  00 01 00 00 00 00 03 32 35 34 02 39 35 02 36 33   ....... 
&gt; 254.95.63
&gt; 0040  02 37 34 07 69 6e 2d 61 64 64 72 04 61 72 70 61   .74.in- 
&gt; addr.arpa
&gt; 0050  00 00 0c 00 01 c0 0c 00 0c 00 01 00 00 24 a8 00   ............. 
&gt; $..
&gt; 0060  01 00
&gt;
&gt; Those last two bytes are the answer length &#40;01&#41; and the data &#40;00&#41;.
&gt;
&gt; I made a patch for both netdns.c &#40;netdns_dn_expand&#41; and Packet.pm
&gt; &#40;dn_expand_PP&#41;.  I&#39;m not claiming the patch is perfect, but it should
&gt; at least be a start.  I&#39;ve attached the patches.
&gt;
&gt; Thanks!
&gt;
&gt; -dave
&gt;
&gt;
&gt;
&gt;
&gt; Hi there,
&gt;
&gt; According to RFC 2181, &#34;The zero length full name is defined as  
&gt; representing the root of the DNS tree, and is typically written and  
&gt; displayed as &#34;.&#34; .&#34;  I&#39;ve found that Net::DNS &#40;latest, 0.65&#41; returns  
&gt; &#34;&#34; &#40;empty string&#41; instead of &#34;.&#34; for these domains, whereas dig/host/ 
&gt; nslookup/etc. return &#34;.&#34;  I work for an anti-spam company and we&#39;ve  
&gt; found a lot of spammy IPs that exhibit this issue.
&gt;
&gt; You may disagree that this needs to be fixed -- the RFC says that  
&gt; the root is *typically* written but this is not a requirement that  
&gt; MUST be followed.  However, due to the disagreement with dig/host/ 
&gt; nslookup/etc I&#39;m submitting the issue.
&gt;
&gt; Basic information:
&gt;
&gt; Distribution name and version: Net-DNS-0.65 &#40;latest&#41;
&gt; Perl version: perl v5.8.8 &#40;i486-linux-gnu-thread-multi&#41;
&gt; Operating System vendor and version: Linux freeside 2.6.24-22- 
&gt; generic #1 SMP Mon Nov 24 18:32:42 UTC 2008 i686 GNU/Linux &#40;this is  
&gt; Ubuntu, hardy heron&#41;.
&gt;
&gt; Sample data:
&gt;
&gt; Here&#39;s an IP and the output from dig:
&gt;
&gt; % dig -x 74.63.95.254
&gt;
&gt; ; &lt;&lt;&gt;&gt; DiG 9.4.2-P2 &lt;&lt;&gt;&gt; -x 74.63.95.254
&gt; ;; global options:  printcmd
&gt; ;; Got answer:
&gt; ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 20464
&gt; ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
&gt;
&gt; ;; QUESTION SECTION:
&gt; ;254.95.63.74.in-addr.arpa.     IN      PTR
&gt;
&gt; ;; ANSWER SECTION:
&gt; 254.95.63.74.in-addr.arpa. 10186 IN     PTR     .
&gt;
&gt; ;; Query time: 3 msec
&gt; ;; SERVER: 172.20.0.21#53&#40;172.20.0.21&#41;
&gt; ;; WHEN: Wed Apr  8 16:32:22 2009
&gt; ;; MSG SIZE  rcvd: 56
&gt;
&gt; &#40;note the &#39;.&#39; above&#41;
&gt;
&gt; I ran wireshark an looked at the answer packet data:
&gt;
&gt; Domain Name System &#40;response&#41;
&gt;     [Request In: 714]
&gt;     [Time: 0.000556000 seconds]
&gt;     Transaction ID: 0xcfa1
&gt;     Flags: 0x8180 &#40;Standard query response, No error&#41;
&gt;     Questions: 1
&gt;     Answer RRs: 1
&gt;     Authority RRs: 0
&gt;     Additional RRs: 0
&gt;     Queries
&gt;         254.95.63.74.in-addr.arpa: type PTR, class IN
&gt;             Name: 254.95.63.74.in-addr.arpa
&gt;             Type: PTR &#40;Domain name pointer&#41;
&gt;             Class: IN &#40;0x0001&#41;
&gt;     Answers
&gt;         254.95.63.74.in-addr.arpa: type PTR, class IN, &lt;Root&gt;
&gt;             Name: 254.95.63.74.in-addr.arpa
&gt;             Type: PTR &#40;Domain name pointer&#41;
&gt;             Class: IN &#40;0x0001&#41;
&gt;             Time to live: 2 hours, 36 minutes, 24 seconds
&gt;             Data length: 1
&gt;             Domain name: &lt;Root&gt;
&gt;
&gt; 0000  00 0f fe 89 c0 8b 00 11 20 d1 8d c6 08 00 45  
&gt; 00   ........ .....E.
&gt; 0010  00 54 5a cd 00 00 7f 11 86 0e ac 14 00 15 ac  
&gt; 14   .TZ.............
&gt; 0020  02 80 00 35 a5 3f 00 40 c3 13 cf a1 81 80 00 01   ... 
&gt; 5.?.@........
&gt; 0030  00 01 00 00 00 00 03 32 35 34 02 39 35 02 36 33   ....... 
&gt; 254.95.63
&gt; 0040  02 37 34 07 69 6e 2d 61 64 64 72 04 61 72 70 61   .74.in- 
&gt; addr.arpa
&gt; 0050  00 00 0c 00 01 c0 0c 00 0c 00 01 00 00 24 a8 00   ............. 
&gt; $..
&gt; 0060  01 00
&gt;
&gt; Those last two bytes are the answer length &#40;01&#41; and the data &#40;00&#41;.
&gt;
&gt; I made a patch for both netdns.c &#40;netdns_dn_expand&#41; and Packet.pm  
&gt; &#40;dn_expand_PP&#41;.  I&#39;m not claiming the patch is perfect, but it  
&gt; should at least be a start.  I&#39;ve attached the patches.
&gt;
&gt; Thanks!
&gt;
&gt; -dave
&gt; &lt;netdns.c.patch&gt;
&gt; &lt;Packet.pm.patch&gt;
&gt;
&gt;
&gt;
</div></div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;09&nbsp;12:42:37&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;09&nbsp;14:54:21&nbsp;2009</span>
    <span class="description">dlamacchia [...] cloudmark.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #44885] bug&#40;?&#41;: Net::DNS returns empty string instead of &#34;.&#34; for root </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 9 Apr 2009 11:53:35 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-DNS [...] rt.cpan.org&#34; &lt;bug-Net-DNS [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David LaMacchia &lt;dlamacchia [...] cloudmark.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Olaf,

Thanks for the incredibly quick turnaround on this -- I agree, your  
patch &#40;in the presentation layer&#41; makes sense.  I&#39;ll apply it to my  
local 0.65!

-dave

On Apr 9, 2009, at 9:42 AM, Olaf M. Kolkman via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=44885">https://rt.cpan.org/Ticket/Display.html?id=44885</a></span> &gt;
&gt;
&gt;
&gt; Since this is a presentation rather than a parsing issue, the patch is
&gt; actually only needed for PTR.pm.
&gt;
&gt; Internally &#40;and that is a historic artifact&#41; all domain names are
&gt; stored as fully qualified domain names without trailing dots &#40;and as
&gt; strings, not as octet sequences&#41;. Messing with the parsing would not
&gt; help and create inconsistencies.
&gt;
&gt;
&gt; --- lib/Net/DNS/RR/PTR.pm     &#40;revision 794&#41;
&gt; +++ lib/Net/DNS/RR/PTR.pm     &#40;working copy&#41;
&gt; @@ -33,8 +33,8 @@
&gt;
&gt;  sub rdatastr {
&gt;       my $self = shift;
&gt; -
&gt; -     return $self-&gt;{&#34;ptrdname&#34;} ? &#34;$self-&gt;{ptrdname}.&#34; : &#39;&#39;;
&gt; +     return &#34;&#34; unless defined $self-&gt;{ptrdname};
&gt; +     return $self-&gt;{&#34;ptrdname&#34;} ? &#34;$self-&gt;{ptrdname}.&#34; : &#39;.&#39;;
&gt;  }
&gt;
&gt;  sub rr_rdata {
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; Should do the trick.
&gt;
&gt; --Olaf
&gt;
&gt;
&gt;
&gt;
&gt; On 9 apr 2009, at 01:59, David LaMacchia via RT wrote:
&gt;
<div class="message-stanza open">&gt;&gt; Wed Apr 08 19:59:17 2009: Request 44885 was acted upon.
&gt;&gt; Transaction: Ticket created by dlamacchia@cloudmark.com
&gt;&gt;      Queue: Net-DNS
&gt;&gt;    Subject: bug&#40;?&#41;: Net::DNS returns empty string instead of &#34;.&#34;
&gt;&gt; for root
&gt;&gt;  Broken in: &#40;no value&#41;
&gt;&gt;   Severity: &#40;no value&#41;
&gt;&gt;      Owner: Nobody
&gt;&gt; Requestors: dlamacchia@cloudmark.com
&gt;&gt;     Status: new
&gt;&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=44885">http://rt.cpan.org/Ticket/Display.html?id=44885</a></span> &gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Hi there,
&gt;&gt;
&gt;&gt; According to RFC 2181, &#34;The zero length full name is defined as
&gt;&gt; representing the root of the DNS tree, and is typically written and
&gt;&gt; displayed as &#34;.&#34; .&#34;  I&#39;ve found that Net::DNS &#40;latest, 0.65&#41; returns
&gt;&gt; &#34;&#34; &#40;empty string&#41; instead of &#34;.&#34; for these domains, whereas dig/host/
&gt;&gt; nslookup/etc. return &#34;.&#34;  I work for an anti-spam company and we&#39;ve
&gt;&gt; found a lot of spammy IPs that exhibit this issue.
&gt;&gt;
&gt;&gt; You may disagree that this needs to be fixed -- the RFC says that the
&gt;&gt; root is *typically* written but this is not a requirement that MUST  
&gt;&gt; be
&gt;&gt; followed.  However, due to the disagreement with dig/host/nslookup/ 
&gt;&gt; etc
&gt;&gt; I&#39;m submitting the issue.
&gt;&gt;
&gt;&gt; Basic information:
&gt;&gt;
&gt;&gt; Distribution name and version: Net-DNS-0.65 &#40;latest&#41;
&gt;&gt; Perl version: perl v5.8.8 &#40;i486-linux-gnu-thread-multi&#41;
&gt;&gt; Operating System vendor and version: Linux freeside 2.6.24-22-generic
&gt;&gt; #1 SMP Mon Nov 24 18:32:42 UTC 2008 i686 GNU/Linux &#40;this is Ubuntu,
&gt;&gt; hardy heron&#41;.
&gt;&gt;
&gt;&gt; Sample data:
&gt;&gt;
&gt;&gt; Here&#39;s an IP and the output from dig:
&gt;&gt;
&gt;&gt; % dig -x 74.63.95.254
&gt;&gt;
&gt;&gt; ; &lt;&lt;&gt;&gt; DiG 9.4.2-P2 &lt;&lt;&gt;&gt; -x 74.63.95.254
&gt;&gt; ;; global options:  printcmd
&gt;&gt; ;; Got answer:
&gt;&gt; ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 20464
&gt;&gt; ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
&gt;&gt;
&gt;&gt; ;; QUESTION SECTION:
&gt;&gt; ;254.95.63.74.in-addr.arpa.     IN      PTR
&gt;&gt;
&gt;&gt; ;; ANSWER SECTION:
&gt;&gt; 254.95.63.74.in-addr.arpa. 10186 IN     PTR     .
&gt;&gt;
&gt;&gt; ;; Query time: 3 msec
&gt;&gt; ;; SERVER: 172.20.0.21#53&#40;172.20.0.21&#41;
&gt;&gt; ;; WHEN: Wed Apr  8 16:32:22 2009
&gt;&gt; ;; MSG SIZE  rcvd: 56
&gt;&gt;
&gt;&gt; &#40;note the &#39;.&#39; above&#41;
&gt;&gt;
&gt;&gt; I ran wireshark an looked at the answer packet data:
&gt;&gt;
&gt;&gt; Domain Name System &#40;response&#41;
&gt;&gt;    [Request In: 714]
&gt;&gt;    [Time: 0.000556000 seconds]
&gt;&gt;    Transaction ID: 0xcfa1
&gt;&gt;    Flags: 0x8180 &#40;Standard query response, No error&#41;
&gt;&gt;    Questions: 1
&gt;&gt;    Answer RRs: 1
&gt;&gt;    Authority RRs: 0
&gt;&gt;    Additional RRs: 0
&gt;&gt;    Queries
&gt;&gt;        254.95.63.74.in-addr.arpa: type PTR, class IN
&gt;&gt;            Name: 254.95.63.74.in-addr.arpa
&gt;&gt;            Type: PTR &#40;Domain name pointer&#41;
&gt;&gt;            Class: IN &#40;0x0001&#41;
&gt;&gt;    Answers
&gt;&gt;        254.95.63.74.in-addr.arpa: type PTR, class IN, &lt;Root&gt;
&gt;&gt;            Name: 254.95.63.74.in-addr.arpa
&gt;&gt;            Type: PTR &#40;Domain name pointer&#41;
&gt;&gt;            Class: IN &#40;0x0001&#41;
&gt;&gt;            Time to live: 2 hours, 36 minutes, 24 seconds
&gt;&gt;            Data length: 1
&gt;&gt;            Domain name: &lt;Root&gt;
&gt;&gt;
&gt;&gt; 0000  00 0f fe 89 c0 8b 00 11 20 d1 8d c6 08 00 45
&gt;&gt; 00   ........ .....E.
&gt;&gt; 0010  00 54 5a cd 00 00 7f 11 86 0e ac 14 00 15 ac
&gt;&gt; 14   .TZ.............
&gt;&gt; 0020  02 80 00 35 a5 3f 00 40 c3 13 cf a1 81 80 00 01   ...
&gt;&gt; 5.?.@........
&gt;&gt; 0030  00 01 00 00 00 00 03 32 35 34 02 39 35 02 36 33   .......
&gt;&gt; 254.95.63
&gt;&gt; 0040  02 37 34 07 69 6e 2d 61 64 64 72 04 61 72 70 61   .74.in-
&gt;&gt; addr.arpa
&gt;&gt; 0050  00 00 0c 00 01 c0 0c 00 0c 00 01 00 00 24 a8 00   .............
&gt;&gt; $..
&gt;&gt; 0060  01 00
&gt;&gt;
&gt;&gt; Those last two bytes are the answer length &#40;01&#41; and the data &#40;00&#41;.
&gt;&gt;
&gt;&gt; I made a patch for both netdns.c &#40;netdns_dn_expand&#41; and Packet.pm
&gt;&gt; &#40;dn_expand_PP&#41;.  I&#39;m not claiming the patch is perfect, but it should
&gt;&gt; at least be a start.  I&#39;ve attached the patches.
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt;
&gt;&gt; -dave
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Hi there,
&gt;&gt;
&gt;&gt; According to RFC 2181, &#34;The zero length full name is defined as
&gt;&gt; representing the root of the DNS tree, and is typically written and
&gt;&gt; displayed as &#34;.&#34; .&#34;  I&#39;ve found that Net::DNS &#40;latest, 0.65&#41; returns
&gt;&gt; &#34;&#34; &#40;empty string&#41; instead of &#34;.&#34; for these domains, whereas dig/host/
&gt;&gt; nslookup/etc. return &#34;.&#34;  I work for an anti-spam company and we&#39;ve
&gt;&gt; found a lot of spammy IPs that exhibit this issue.
&gt;&gt;
&gt;&gt; You may disagree that this needs to be fixed -- the RFC says that
&gt;&gt; the root is *typically* written but this is not a requirement that
&gt;&gt; MUST be followed.  However, due to the disagreement with dig/host/
&gt;&gt; nslookup/etc I&#39;m submitting the issue.
&gt;&gt;
&gt;&gt; Basic information:
&gt;&gt;
&gt;&gt; Distribution name and version: Net-DNS-0.65 &#40;latest&#41;
&gt;&gt; Perl version: perl v5.8.8 &#40;i486-linux-gnu-thread-multi&#41;
&gt;&gt; Operating System vendor and version: Linux freeside 2.6.24-22-
&gt;&gt; generic #1 SMP Mon Nov 24 18:32:42 UTC 2008 i686 GNU/Linux &#40;this is
&gt;&gt; Ubuntu, hardy heron&#41;.
&gt;&gt;
&gt;&gt; Sample data:
&gt;&gt;
&gt;&gt; Here&#39;s an IP and the output from dig:
&gt;&gt;
&gt;&gt; % dig -x 74.63.95.254
&gt;&gt;
&gt;&gt; ; &lt;&lt;&gt;&gt; DiG 9.4.2-P2 &lt;&lt;&gt;&gt; -x 74.63.95.254
&gt;&gt; ;; global options:  printcmd
&gt;&gt; ;; Got answer:
&gt;&gt; ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 20464
&gt;&gt; ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
&gt;&gt;
&gt;&gt; ;; QUESTION SECTION:
&gt;&gt; ;254.95.63.74.in-addr.arpa.     IN      PTR
&gt;&gt;
&gt;&gt; ;; ANSWER SECTION:
&gt;&gt; 254.95.63.74.in-addr.arpa. 10186 IN     PTR     .
&gt;&gt;
&gt;&gt; ;; Query time: 3 msec
&gt;&gt; ;; SERVER: 172.20.0.21#53&#40;172.20.0.21&#41;
&gt;&gt; ;; WHEN: Wed Apr  8 16:32:22 2009
&gt;&gt; ;; MSG SIZE  rcvd: 56
&gt;&gt;
&gt;&gt; &#40;note the &#39;.&#39; above&#41;
&gt;&gt;
&gt;&gt; I ran wireshark an looked at the answer packet data:
&gt;&gt;
&gt;&gt; Domain Name System &#40;response&#41;
&gt;&gt;    [Request In: 714]
&gt;&gt;    [Time: 0.000556000 seconds]
&gt;&gt;    Transaction ID: 0xcfa1
&gt;&gt;    Flags: 0x8180 &#40;Standard query response, No error&#41;
&gt;&gt;    Questions: 1
&gt;&gt;    Answer RRs: 1
&gt;&gt;    Authority RRs: 0
&gt;&gt;    Additional RRs: 0
&gt;&gt;    Queries
&gt;&gt;        254.95.63.74.in-addr.arpa: type PTR, class IN
&gt;&gt;            Name: 254.95.63.74.in-addr.arpa
&gt;&gt;            Type: PTR &#40;Domain name pointer&#41;
&gt;&gt;            Class: IN &#40;0x0001&#41;
&gt;&gt;    Answers
&gt;&gt;        254.95.63.74.in-addr.arpa: type PTR, class IN, &lt;Root&gt;
&gt;&gt;            Name: 254.95.63.74.in-addr.arpa
&gt;&gt;            Type: PTR &#40;Domain name pointer&#41;
&gt;&gt;            Class: IN &#40;0x0001&#41;
&gt;&gt;            Time to live: 2 hours, 36 minutes, 24 seconds
&gt;&gt;            Data length: 1
&gt;&gt;            Domain name: &lt;Root&gt;
&gt;&gt;
&gt;&gt; 0000  00 0f fe 89 c0 8b 00 11 20 d1 8d c6 08 00 45
&gt;&gt; 00   ........ .....E.
&gt;&gt; 0010  00 54 5a cd 00 00 7f 11 86 0e ac 14 00 15 ac
&gt;&gt; 14   .TZ.............
&gt;&gt; 0020  02 80 00 35 a5 3f 00 40 c3 13 cf a1 81 80 00 01   ...
&gt;&gt; 5.?.@........
&gt;&gt; 0030  00 01 00 00 00 00 03 32 35 34 02 39 35 02 36 33   .......
&gt;&gt; 254.95.63
&gt;&gt; 0040  02 37 34 07 69 6e 2d 61 64 64 72 04 61 72 70 61   .74.in-
&gt;&gt; addr.arpa
&gt;&gt; 0050  00 00 0c 00 01 c0 0c 00 0c 00 01 00 00 24 a8 00   .............
&gt;&gt; $..
&gt;&gt; 0060  01 00
&gt;&gt;
&gt;&gt; Those last two bytes are the answer length &#40;01&#41; and the data &#40;00&#41;.
&gt;&gt;
&gt;&gt; I made a patch for both netdns.c &#40;netdns_dn_expand&#41; and Packet.pm
&gt;&gt; &#40;dn_expand_PP&#41;.  I&#39;m not claiming the patch is perfect, but it
&gt;&gt; should at least be a start.  I&#39;ve attached the patches.
&gt;&gt;
&gt;&gt; Thanks!
&gt;&gt;
&gt;&gt; -dave
&gt;&gt; &lt;netdns.c.patch&gt;
&gt;&gt; &lt;Packet.pm.patch&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
</div>&gt;
&gt;
&gt; &lt;PGP.sig&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;20&nbsp;10:10:38&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">fixed on the trunk in version 801
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;20&nbsp;10:10:44&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;20&nbsp;10:10:46&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">fixed on the trunk in version 801
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;20&nbsp;10:10:47&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;20&nbsp;10:10:51&nbsp;2009</span>
    <span class="description">OLAF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
