<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #9341 for Mail-IMAPClient: fetch_hash BODY[HEADER] void because of a &#41; match force</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #9341 for Mail-IMAPClient: fetch_hash BODY[HEADER] void because of a &#41; match force</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Mail-IMAPClient">Mail-IMAPClient CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">9341</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Mail-IMAPClient/Active/">Mail-IMAPClient</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gilles.lamiral [...] free.fr

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19960-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19961-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




01_connect_2.99_02.dump<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/382734/175326/01_connect_2.99_02.dump">
Tue Nov 13 10:29:18 2007 (35.3k) by gilles.lamiral [...] laposte.net
</a>
</font></li>
</ul>


01_connect_2.99_02.dump_2<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/382734/175327/01_connect_2.99_02.dump_2">
Tue Nov 13 10:29:18 2007 (303.4k) by gilles.lamiral [...] laposte.net
</a>
</font></li>
</ul>


Mail-IMAPClient-2.99_02.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/374882/170805/Mail-IMAPClient-2.99_02.tar.gz">
Wed Oct 24 04:48:22 2007 (165.1k) by Mark [...] Overmeer.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;02&nbsp;20:25:06&nbsp;2005</span>
    <span class="description">gilles.lamiral [...] free.fr -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 03 Jan 2005 01:51:06 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] free.fr&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> fetch_hash BODY[HEADER] void because of a &#41; match force</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello David,

First thanks for this useful module.

$from-&gt;fetch_hash&#40;&#34;BODY[HEADER]&#34;&#41;
doesn&#39;t report anything
but 
$from-&gt;fetch_hash&#40;&#34;BODY[HEADER.FIELDS &#40;Message-ID&#41;]&#34;
does because of the &#41; of &#34;Message-ID&#41;&#34;
so the regex in sub fetch_hash:

my&#40;$uid&#41; = $l =~ /\&#40;&#40;?:.* &#41;?UID &#40;\d+&#41;.*\&#41;/i;
----------------------------------------^

is too hard to match a simple &#34;BODY[HEADER]&#34;.
but the patch is easy:

my&#40;$uid&#41; = $l =~ /\&#40;&#40;?:.* &#41;?UID &#40;\d+&#41;.*/i;

I hope there is no side effect. Seems not.
Do you still maintain this module ?
Happy new year David.

-- 
Au revoir,                                  02 99 78 62 49
                                            06 20 79 76 06
Gilles Lamiral. France, L&#39;Hermitage &#40;35590&#41; 08 70 76 34 16
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;23&nbsp;16:24:42&nbsp;2007</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jan 02 20:25:06 2005, gilles.lamiral@free.fr wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello David,
&gt; 
&gt; First thanks for this useful module.
&gt; 
&gt; $from-&gt;fetch_hash&#40;&#34;BODY[HEADER]&#34;&#41;
&gt; doesn&#39;t report anything
&gt; but 
&gt; $from-&gt;fetch_hash&#40;&#34;BODY[HEADER.FIELDS &#40;Message-ID&#41;]&#34;
&gt; does because of the &#41; of &#34;Message-ID&#41;&#34;
&gt; so the regex in sub fetch_hash:
&gt; 
&gt; my&#40;$uid&#41; = $l =~ /\&#40;&#40;?:.* &#41;?UID &#40;\d+&#41;.*\&#41;/i;
&gt; ----------------------------------------^
&gt; 
&gt; is too hard to match a simple &#34;BODY[HEADER]&#34;.
&gt; but the patch is easy:
&gt; 
&gt; my&#40;$uid&#41; = $l =~ /\&#40;&#40;?:.* &#41;?UID &#40;\d+&#41;.*/i;
</div>
The regex is too complex... &#40;?:.* &#41; is also quite silly.
I have changed it into  /\bUID\s+&#40;\d+&#41;/

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I hope there is no side effect. Seems not.
&gt; Do you still maintain this module ?
</div>
No, I took over, because David could not be contacted anymore.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;23&nbsp;16:24:43&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;23&nbsp;23:33:12&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] fetch_hash BODY[HEADER] void because of a &#41;  match force</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 24 Oct 2007 05:32:37 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Do you still maintain this module ?
</div>&gt; No, I took over, because David could not be contacted anymore.
</div>
This is very good news !
You&#39;ll receive other patch/bug report from me.

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;24&nbsp;02:59:26&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] fetch_hash BODY[HEADER] void because of a &#41;  match force</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 24 Oct 2007 08:59:01 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071024 03:33]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=9341">http://rt.cpan.org/Ticket/Display.html?id=9341</a></span> &gt;
&gt; 
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; Do you still maintain this module ?
</div>&gt; &gt; No, I took over, because David could not be contacted anymore.
</div>&gt; 
&gt; This is very good news !
&gt; You&#39;ll receive other patch/bug report from me.
</div>
Yes please!

Are you still using IMAPClient?  I am looking for people who can
help me checking the massive rework &#40;and I do not use imap myself!&#41;
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;24&nbsp;03:17:16&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] fetch_hash BODY[HEADER] void because of a &#41;   match force</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 24 Oct 2007 09:16:53 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Are you still using IMAPClient?  I am looking for people who can
&gt; help me checking the massive rework &#40;and I do not use imap myself!&#41;
</div>
I wrote and still maintain imapsync:
<span class="clickylink"><a target="new" rel="nofollow" href="http://freshmeat.net/projects/imapsync/">http://freshmeat.net/projects/imapsync/</a></span>

imapsync uses IMAPClient massively. I had to fix some functions.
IMAPClient code is difficult to read and touch for me.
Fixes are at the end of the imapsync script,
I renamed functions, foo&#40;&#41; to foo2&#40;&#41;, to avoid
crushing the real definition.

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;24&nbsp;04:48:18&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] fetch_hash BODY[HEADER] void because of a &#41;   match force</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 24 Oct 2007 10:46:25 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071024 07:17]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Are you still using IMAPClient?  I am looking for people who can
&gt; &gt; help me checking the massive rework &#40;and I do not use imap myself!&#41;
</div>&gt; 
&gt; I wrote and still maintain imapsync:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://freshmeat.net/projects/imapsync/">http://freshmeat.net/projects/imapsync/</a></span>
&gt; 
&gt; imapsync uses IMAPClient massively. I had to fix some functions.
&gt; IMAPClient code is difficult to read and touch for me.
&gt; Fixes are at the end of the imapsync script,
&gt; I renamed functions, foo&#40;&#41; to foo2&#40;&#41;, to avoid
&gt; crushing the real definition.
</div>
I see a few fixes which I have already incuperated.  Please, have
a look at the attached code ;-&#41;  Which is totally untested :&#40; and
see if you can understand it better.

Then, please, try to figure-out which changes you made to the
original code, and wether they are in already.  Provide a bug-report
for each of them.  &#40;The Changes file may clear-up your memory&#41;

For instance, PLAIN authenication is already in.  That author thought
&#39;Proxy&#39; was a good name, where you use &#39;Authuser&#39;.  Changes like that
are still possible... but please tell me asap.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/374882/170805/Mail-IMAPClient-2.99_02.tar.gz">Download Mail-IMAPClient-2.99_02.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gunzip 165.1k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;26&nbsp;05:56:02&nbsp;2007</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] fetch_hash BODY[HEADER] void because of a &#41;   match force</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 26 Oct 2007 11:55:09 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071024 07:17]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Mail-IMAPClient
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=9341">http://rt.cpan.org/Ticket/Display.html?id=9341</a></span> &gt;
</div>
I just release 2.99_02, and it passes all the tests in my enviroment.
Hopefully you find time to test it with your module &#40;and remove the
patches you made yourself&#41;
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;19:56:28&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_02</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 30 Oct 2007 00:55:59 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I just release 2.99_02, and it passes all the tests in my enviroment.
</div>
I doesn&#39;t pass the first one in mine :-&#40;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hopefully you find time to test it with your module &#40;and remove the
&gt; patches you made yourself&#41;
</div>
Can you try this simple script with the old 2.2.9 and the new 2.99_02 lib?
Here, the old one works, the new one doesn&#39;t.

#!/usr/bin/perl -w

use Mail::IMAPClient;

$imap = Mail::IMAPClient-&gt;new&#40;&#41;;
$imap-&gt;Debug&#40;1&#41;;
$imap-&gt;Server&#40;&#39;louloutte.dyndns.org&#39;&#41;;
$imap-&gt;connect&#40;&#41;;
$imap-&gt;User&#40;&#39;MarkOv@est.belle&#39;&#41;;
$imap-&gt;Password&#40;&#39;emhj91ly&#39;&#41;;
$imap-&gt;login&#40;&#41;;
$imap-&gt;logout&#40;&#41;;

Feel free to play with this imap account.
Everyone on this list can do so.
This imap account will stay alive until 
any problem arises.

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;30&nbsp;04:07:34&nbsp;2007</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_02</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 30 Oct 2007 09:07:06 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071029 23:56]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=9341">http://rt.cpan.org/Ticket/Display.html?id=9341</a></span> &gt;
&gt; 
&gt; Hello Mark,
&gt; 
<div class="message-stanza open">&gt; &gt; I just release 2.99_02, and it passes all the tests in my enviroment.
</div>&gt; I doesn&#39;t pass the first one in mine :-&#40;
</div>
Of course, with such an extensive rewrite, some problems will appear.
However, I cannot reproduce your error.  What platform are you using?

My output of your script is:
 Read: * OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA AUTH=PLAIN CRAM-MD5 CRAM-SHA1 IDLE STARTTLS] Courier-IMAP ready. Copyright 1998-2005 Double Precision, Inc.  See COPYING for distribution information.
 Sending: 1 LOGIN &#34;MarkOv@est.belle&#34; emhj91ly
 Sent 37 bytes
 Read: 1 OK LOGIN Ok.
 Sending: 2 LOGOUT
 Sent 10 bytes
 Read: * BYE Courier-IMAP server shutting down
       2 OK LOGOUT completed

Which looks as I expect it.  What&#39;s your output?
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;30&nbsp;09:01:33&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_02</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 30 Oct 2007 14:00:33 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, I cannot reproduce your error.  What platform are you using?
</div>
A classic Debian Etch on Linux.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Sending: 1 LOGIN &#34;MarkOv@est.belle&#34; emhj91ly
&gt;  Sent 37 bytes
&gt;  Read: 1 OK LOGIN Ok.
&gt;  Sending: 2 LOGOUT
&gt;  Sent 10 bytes
&gt;  Read: * BYE Courier-IMAP server shutting down
&gt;        2 OK LOGOUT completed
</div>
Good. 
Outputing the password is often a risky choice.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Which looks as I expect it.  What&#39;s your output?
</div>
$ perl -IMail-IMAPClient-2.99_02/lib t/01_connect 
NO Not connected.       ...propagated at t/01_connect line 9.

Line 9 is now :
$imap-&gt;connect&#40;&#41; or die;

Now with the 2.2.9:

$ perl  t/01_connect 
Read: * OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA AUTH=PLAIN CRAM-MD5 CRAM-SHA1 IDLE STARTTLS] Courier-IMAP ready. Copyright 1998-2005
Double Precision, Inc.  See COPYING for distribution information.

Connect: Received this from readline: 0/OUTPUT/* OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA AUTH=PLAIN CRAM-MD5 CRAM-SHA1 IDLE STARTTLS]
Courier-IMAP ready. Copyright 1998-2005 Double Precision, Inc.  See COPYING for distribution information.

Sending: 1 Login &#34;XXXXXXXX&#34; XXXXXXXX

Sent 37 bytes
Read: 1 OK LOGIN Ok.

Sending: 2 LOGOUT

Sent 10 bytes
Read: * BYE Courier-IMAP server shutting down
2 OK LOGOUT completed





-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;31&nbsp;05:10:22&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_02</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 31 Oct 2007 10:09:12 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071030 13:01]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; However, I cannot reproduce your error.  What platform are you using?
</div></div>
Still cannot reproduce the error.
Could you please have a look at error messages produced by your
server.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Outputing the password is often a risky choice.
</div>
While testing, I want to see exactly what is happening, not some
weak derivation of the reality

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Line 9 is now :
&gt; $imap-&gt;connect&#40;&#41; or die;
&gt; NO Not connected.       ...propagated at t/01_connect line 9.
</div>
Please change the first two lines of your script into
  my $imap = Mail::IMAPClient-&gt;new&#40;Debug =&gt; 1&#41;;

Then we have a few more lines of output.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;31&nbsp;09:50:26&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_02</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 31 Oct 2007 14:49:43 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Still cannot reproduce the error.
&gt; Could you please have a look at error messages produced by your
&gt; server.
</div>
$ perl t/01_connect
Using Mail::IMAPClient version 2.2.9 and perl version 5.8.8 &#40;5.008008&#41;
Read: * OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA AUTH=PLAIN CRAM-MD5 CRAM-SHA1 IDLE STARTTLS] Courier-IMAP ready. Copyright 1998-2005
Double Precision, Inc.  See COPYING for distribution information.
Connect: Received this from readline: 0/OUTPUT/* OK [CAPA
...

gives:

Oct 31 14:37:41 plume couriertcpd: Connection, ip=[::ffff:192.168.68.7]
Oct 31 14:37:41 plume couriertcpd: LOGIN: ip=[::ffff:192.168.68.7], command=LOGIN
Oct 31 14:37:41 plume couriertcpd: LOGIN: ip=[::ffff:192.168.68.7], username=MarkOv@est.belle
Oct 31 14:37:41 plume couriertcpd: LOGIN, user=MarkOv@est.belle, ip=[::ffff:192.168.68.7], protocol=IMAP
Oct 31 14:37:41 plume couriertcpd: LOGOUT, user=MarkOv@est.belle, ip=[::ffff:192.168.68.7], headers=0, body=0, rcvd=10, sent=80, time=0


$ perl -I Mail-IMAPClient-2.99_02/lib t/01_connect
Using Mail::IMAPClient version 2.99_02 and perl version 5.8.8 &#40;5.008008&#41;
NO Not connected.       ...propagated at t/01_connect line 9.

gives

Oct 31 14:39:47 plume couriertcpd: Connection, ip=[::ffff:192.168.68.7]
Oct 31 14:39:47 plume couriertcpd: Disconnected, ip=[::ffff:192.168.68.7], time=0


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Please change the first two lines of your script into
&gt;   my $imap = Mail::IMAPClient-&gt;new&#40;Debug =&gt; 1&#41;;
&gt; Then we have a few more lines of output.
</div>
See above

The connect&#40;&#41; fails.

Last lines of system calls :

$ strace -f perl -I Mail-IMAPClient-2.99_02/lib t/01_connect
...
open&#40;&#34;/etc/host.conf&#34;, O_RDONLY&#41;        = 3
fstat64&#40;3, {st_mode=S_IFREG|0644, st_size=9, ...}&#41; = 0
mmap2&#40;NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0&#41; = 0xb7be5000
read&#40;3, &#34;multi on\n&#34;, 4096&#41;             = 9
read&#40;3, &#34;&#34;, 4096&#41;                       = 0
close&#40;3&#41;                                = 0
munmap&#40;0xb7be5000, 4096&#41;                = 0
futex&#40;0xb7f74ac0, FUTEX_WAKE, 2147483647&#41; = 0
open&#40;&#34;/etc/hosts&#34;, O_RDONLY&#41;            = 3
fcntl64&#40;3, F_GETFD&#41;                     = 0
fcntl64&#40;3, F_SETFD, FD_CLOEXEC&#41;         = 0
fstat64&#40;3, {st_mode=S_IFREG|0644, st_size=1034, ...}&#41; = 0
mmap2&#40;NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0&#41; = 0xb7be5000
read&#40;3, &#34;# /etc/hosts\n\n127.0.0.1\tlocalhos&#34;..., 4096&#41; = 1034
read&#40;3, &#34;&#34;, 4096&#41;                       = 0
close&#40;3&#41;                                = 0
munmap&#40;0xb7be5000, 4096&#41;                = 0
socket&#40;PF_INET, SOCK_STREAM, IPPROTO_TCP&#41; = 3
ioctl&#40;3, SNDCTL_TMR_TIMEBASE or TCGETS, 0xbfbe8618&#41; = -1 EINVAL &#40;Invalid argument&#41;
_llseek&#40;3, 0, 0xbfbe8660, SEEK_CUR&#41;     = -1 ESPIPE &#40;Illegal seek&#41;
ioctl&#40;3, SNDCTL_TMR_TIMEBASE or TCGETS, 0xbfbe8618&#41; = -1 EINVAL &#40;Invalid argument&#41;
_llseek&#40;3, 0, 0xbfbe8660, SEEK_CUR&#41;     = -1 ESPIPE &#40;Illegal seek&#41;
fcntl64&#40;3, F_SETFD, FD_CLOEXEC&#41;         = 0
connect&#40;3, {sa_family=AF_INET, sin_port=htons&#40;143&#41;, sin_addr=inet_addr&#40;&#34;192.168.68.7&#34;&#41;}, 16&#41; = 0
write&#40;2, &#34;NO Not connected.\t...propagated &#34;..., 56NO Not connected.    ...propagated at t/01_connect line 9.
&#41; = 56
close&#40;3&#41;                                = 0
exit_group&#40;29&#41;                          = ?
Process 24455 detached


May be a problem with the IO::Socket

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;10&nbsp;15:10:32&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_02</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 10 Nov 2007 21:09:47 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071031 13:50]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Still cannot reproduce the error.
&gt; &gt; Could you please have a look at error messages produced by your
&gt; &gt; server.
</div>&gt; 
&gt; Oct 31 14:39:47 plume couriertcpd: Connection, ip=[::ffff:192.168.68.7]
</div>
IPv6 address?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; read&#40;3, &#34;# /etc/hosts\n\n127.0.0.1\tlocalhos&#34;..., 4096&#41; = 1034
&gt; read&#40;3, &#34;&#34;, 4096&#41;                       = 0
&gt; close&#40;3&#41;                                = 0
&gt; munmap&#40;0xb7be5000, 4096&#41;                = 0
&gt; socket&#40;PF_INET, SOCK_STREAM, IPPROTO_TCP&#41; = 3
&gt; ioctl&#40;3, SNDCTL_TMR_TIMEBASE or TCGETS, 0xbfbe8618&#41; = -1 EINVAL &#40;Invalid argument&#41;
&gt; _llseek&#40;3, 0, 0xbfbe8660, SEEK_CUR&#41;     = -1 ESPIPE &#40;Illegal seek&#41;
&gt; ioctl&#40;3, SNDCTL_TMR_TIMEBASE or TCGETS, 0xbfbe8618&#41; = -1 EINVAL &#40;Invalid argument&#41;
&gt; _llseek&#40;3, 0, 0xbfbe8660, SEEK_CUR&#41;     = -1 ESPIPE &#40;Illegal seek&#41;
&gt; fcntl64&#40;3, F_SETFD, FD_CLOEXEC&#41;         = 0
&gt; connect&#40;3, {sa_family=AF_INET, sin_port=htons&#40;143&#41;, sin_addr=inet_addr&#40;&#34;192.168.68.7&#34;&#41;}, 16&#41; = 0
&gt; write&#40;2, &#34;NO Not connected.\t...propagated &#34;..., 56NO Not connected.    ...propagated at t/01_connect line 9.
&gt; &#41; = 56
</div>
Apparently, the connection fails on a very low level, before any data
is exchanged.

Anyway... there are a few things fixed in 2.99_04 by Flavio Poletti.  I hope
you find time to investigate your problem a little further.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;12&nbsp;22:58:16&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_04</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Nov 2007 04:57:51 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; IPv6 address?
</div>
No. Linux kernel can do IPV6 so system call show this &#40;libc&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Apparently, the connection fails on a very low level, before any data
&gt; is exchanged.
</div>
Yes. it fails on:

sub connect
...
while&#40;my $output = $self-&gt;_read_line&#41;
...

because $self-&gt;_read_line returns undef
and $self-&gt;_read_line returns undef because

sub _read_line
...
unless&#40;$self-&gt;IsConnected &#38;&#38; $self-&gt;Socket&#41;
...

$self-&gt;Socket is undef

and $self-&gt;Socket is undef because :
sub Socket&#40;;$&#41;
{   my &#40;$self, $sock&#41; = @_;
    defined $sock
       or return $self-&gt;{Socket};

$self-&gt;Socket is called without any arg so
$sock is undef so $self-&gt;{Socket} is return
but $self-&gt;{Socket} is undef.

I didn&#39;t find where $self-&gt;{Socket} is set in 2.99_02

So I understand why this code doesn&#39;t work here.
But I don&#39;t understand why this code works with you :-&#40;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Anyway... there are a few things fixed in 2.99_04 by Flavio Poletti.  
</div>
Where is 2.99_04 ?

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;13&nbsp;02:49:32&nbsp;2007</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_04</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Nov 2007 08:49:09 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071113 03:58]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yes. it fails on:
&gt; 
&gt; sub connect
&gt; ...
</div>
     Connect creates and sets the Socket in line 254.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; while&#40;my $output = $self-&gt;_read_line&#41;
&gt; ...
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; because $self-&gt;_read_line returns undef
&gt; and $self-&gt;_read_line returns undef because
&gt; 
&gt; sub _read_line
&gt; ...
&gt; unless&#40;$self-&gt;IsConnected &#38;&#38; $self-&gt;Socket&#41;
</div>
    So this should be true, the first pass.

I have had patches from at four different people, and for them the
initiation all work.  When I run your script, connecting to your
server, it also works.   The flow of the program also indicates that
the connecting must be present.

Interesting things are happening, probably with your environment.
Hum.

Is your server running on the same system as you run your script?
I did remove a
           $sock-&gt;autoflush&#40;1&#41;;
after the socket is created, because the manual page of
IO::Socket::INET states:

    NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE
    As of VERSION 1.18 all IO::Socket objects have autoflush turned on
    by default. This was not the case with earlier releases.
    NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE

However, this might not be done correctly, where local sockets are
a bit different from network sockets.  [I require IO::Socket::INET
version 1.26, and run version 1.28]
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;13&nbsp;10:29:17&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_04</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Nov 2007 16:26:45 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Yes. it fails on:
&gt; &gt; sub connect
&gt; &gt; ...
</div>&gt; 
&gt;      Connect creates and sets the Socket in line 254.
</div>
It seems you don&#39;t use the same Mail-IMAPClient-2.99_02 I use,
since line 254 is :
$ cat -n Mail-IMAPClient-2.99_02/lib/Mail/IMAPClient.pm
...
   252  
   253  sub login
   254  {   my $self = shift;
   255      return $self-&gt;authenticate&#40;$self-&gt;Authmechanism, $self-&gt;Authcallback&#41;
   256          if $self-&gt;{Authmechanism} &#38;&#38; $self-&gt;{Authmechanism} ne &#39;LOGIN&#39;;
   257  


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; while&#40;my $output = $self-&gt;_read_line&#41;
&gt; &gt; ...
</div>&gt; 
<div class="message-stanza open">&gt; &gt; because $self-&gt;_read_line returns undef
&gt; &gt; and $self-&gt;_read_line returns undef because
&gt; &gt;
&gt; &gt; sub _read_line
&gt; &gt; ...
&gt; &gt; unless&#40;$self-&gt;IsConnected &#38;&#38; $self-&gt;Socket&#41;
</div>&gt; 
&gt;     So this should be true, the first pass.
</div>
It is not and we have to understand why.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have had patches from at four different people, and for them the
&gt; initiation all work. 
</div>
Can you make them test the connect script :

85$ cat  t/01_connect
#!/usr/bin/perl -w

use Carp;
use Mail::IMAPClient;

$imap = Mail::IMAPClient-&gt;new&#40;Debug =&gt; 1&#41;;
$imap-&gt;Debug&#40;1&#41;;
$imap-&gt;Server&#40;&#39;louloutte.dyndns.org&#39;&#41;;
$imap-&gt;connect&#40;&#41; or croak &#34;Error connecting @!&#34;;
$imap-&gt;User&#40;&#39;MarkOv@est.belle&#39;&#41;;
$imap-&gt;Password&#40;&#39;emhj91ly&#39;&#41;;
$imap-&gt;login&#40;&#41;;
$imap-&gt;logout&#40;&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When I run your script, connecting to your server, it also works. 
</div>
Yes. You can stop to convince me it works for you.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The flow of the program also indicates that
&gt; the connecting must be present.
</div>
I don&#39;t see where.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Interesting things are happening, probably with your environment.
&gt; Hum.
</div>
Yes. 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is your server running on the same system as you run your script?
</div>
Yes.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I did remove a
&gt;            $sock-&gt;autoflush&#40;1&#41;;
&gt; after the socket is created, 
</div>
I still have this line :

   205  sub connect
   206  {   my $self = shift;
   ...
   222      $self-&gt;Socket&#40;$sock&#41;;
   223      $self-&gt;State&#40;Connected&#41;;
   224      $sock-&gt;autoflush&#40;1&#41;;
   

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [I require IO::Socket::INET
&gt; version 1.26, and run version 1.28]
</div>
I run 1.29

Attached two perl debug outputs :

a&#41; # 01_connect_2.99_02.dump

  perl -d -I Mail-IMAPClient-2.99_02/lib t/01_connect 

b&#41; # 01_connect_2.99_02.dump_2

  PERLDB_OPTS=&#34;NonStop frame=1 AutoTrace LineInfo=t/01_connect_2.99_02.dump_2&#34;  perl -d -I Mail-IMAPClient-2.99_02/lib  t/01_connect


Where is the lib 2.99_04 or the one you work on ?

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;14&nbsp;03:50:14&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_04</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 14 Nov 2007 09:49:30 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071113 15:29]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Mail-IMAPClient
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=9341">http://rt.cpan.org/Ticket/Display.html?id=9341</a></span> &gt;
&gt; 
&gt; Hello Mark,
&gt; 
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; Yes. it fails on:
&gt; &gt; &gt; sub connect
&gt; &gt; &gt; ...
</div>&gt; &gt; 
&gt; &gt;      Connect creates and sets the Socket in line 254.
</div>&gt; 
&gt; It seems you don&#39;t use the same Mail-IMAPClient-2.99_02 I use,
&gt; since line 254 is :
&gt; $ cat -n Mail-IMAPClient-2.99_02/lib/Mail/IMAPClient.pm
&gt; ...
&gt;    252  
&gt;    253  sub login
&gt;    254  {   my $self = shift;
&gt;    255      return $self-&gt;authenticate&#40;$self-&gt;Authmechanism, $self-&gt;Authcallback&#41;
&gt;    256          if $self-&gt;{Authmechanism} &#38;&#38; $self-&gt;{Authmechanism} ne &#39;LOGIN&#39;;
&gt;    257  
</div>
Ok, that&#39;s understandable: I have found the cause of our problems.
I sent you a kind of unofficial pre-release of _02, which differs from
the _02 final as found on CPAN.  Quite a bit even: the diff is over 2000
lines. That might also be the reason that our output differs.

One of the things you miss is a crucial
      $self-&gt;{Socket} = $sock;

Have you tried any newer version already?  We are up to _06 on the
moment. <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~markov/Mail-IMAPClient-2.99_06/">http://search.cpan.org/~markov/Mail-IMAPClient-2.99_06/</a></span>

Thanks for taking the time to help me get to the bottom of this.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;13:21:14&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_07</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 15:53:08 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Have you tried any newer version already?  We are up to _06 on the
&gt; moment. <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~markov/Mail-IMAPClient-2.99_06/">http://search.cpan.org/~markov/Mail-IMAPClient-2.99_06/</a></span>
</div>
I tried Mail-IMAPClient-2.99_07/
The connect works.
I tried it with imapsync, 2.99_07 lacks Mail::IMAPClient::Ssl&#40;&#41;
2.2.9 hadn&#39;t Ssl but I added it.


-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;17&nbsp;04:56:20&nbsp;2007</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_07</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 17 Nov 2007 10:54:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071116 18:21]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Mail-IMAPClient
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=9341">http://rt.cpan.org/Ticket/Display.html?id=9341</a></span> &gt;
&gt; 
&gt; Hello Mark,
&gt; 
<div class="message-stanza open">&gt; &gt; Have you tried any newer version already?  We are up to _06 on the
&gt; &gt; moment. <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~markov/Mail-IMAPClient-2.99_06/">http://search.cpan.org/~markov/Mail-IMAPClient-2.99_06/</a></span>
</div>&gt; I tried Mail-IMAPClient-2.99_07/
&gt; The connect works.
</div>
Pfffeeew... good, fixed that one ;-b

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I tried it with imapsync, 2.99_07 lacks Mail::IMAPClient::Ssl&#40;&#41;
&gt; 2.2.9 hadn&#39;t Ssl but I added it.
</div>
Or did it work with AUTOLOAD?  I removed a lot that that mess.

Probably, the easiest way to use SSL, is the same ways as other
people are doing:
  my $ssl  = IO::Socket::SSL-&gt;new&#40;...&#41;;
  my $imap = Mail::IMAPClient-&gt;new&#40;RawSocket =&gt; $ssl&#41;;

I also got reports from someone who tried to use your imapsync
script: a few extra warnings are given because you write
  close $fh;
Those should be rewritten into
  $fh-&gt;close;      # or
  CORE::close&#40;$fh&#41;;

I hope you find more errors in Mail::IMAPClient: I prefer to be able
to fix errors, over having errors which I do not know of :-b
-- 
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;17&nbsp;22:07:09&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_07</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 18 Nov 2007 04:06:46 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I tried it with imapsync, 2.99_07 lacks Mail::IMAPClient::Ssl&#40;&#41;
&gt; &gt; 2.2.9 hadn&#39;t Ssl but I added it.
</div>&gt; Or did it work with AUTOLOAD?  
</div>
May be.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I removed a lot that that mess.
</div>
Good remove. 
I don&#39;t like heavy magic.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Probably, the easiest way to use SSL, is the same ways as other
&gt; people are doing:
&gt;   my $ssl  = IO::Socket::SSL-&gt;new&#40;...&#41;;
&gt;   my $imap = Mail::IMAPClient-&gt;new&#40;RawSocket =&gt; $ssl&#41;;
</div>
You&#39;re right, and that is already what imapsync is doing.
I think I just have to remove useless Ssl calls.
I&#39;ve just checked that, it works with the old lib.

Now I&#39;m on the authenticate passage.
imapsync authenticate2&#40;&#41; from old lib doesn&#39;t work
with the new one. For now I don&#39;t know why.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I also got reports from someone who tried to use your imapsync
&gt; script: a few extra warnings are given because you write
&gt;   close $fh;
&gt; Those should be rewritten into
&gt;   $fh-&gt;close;      # or
</div>
I saw that and fixed it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I hope you find more errors in Mail::IMAPClient: I prefer to be able
&gt; to fix errors, over having errors which I do not know of.
</div>
I will. To support the new Mail::IMAPClient I need to run imapsync 
with both old and new Mail::IMAPClient until the new one is 
available on every standard Unix distribution.

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;18&nbsp;04:16:48&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] new lib 2.99_07</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 18 Nov 2007 10:16:25 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071118 03:07]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I hope you find more errors in Mail::IMAPClient: I prefer to be able
&gt; &gt; to fix errors, over having errors which I do not know of.
</div>&gt; 
&gt; I will. To support the new Mail::IMAPClient I need to run imapsync 
&gt; with both old and new Mail::IMAPClient until the new one is 
&gt; available on every standard Unix distribution.
</div>
It has many benefits to try to avoid the old code: your script will
be much simpler... so smaller chance on bugs.  So, if it was my
package, I whould either
 - included Mail::IMAPClient newest version in your package
 - explain how people can upgrade their perl modules
 - start an imapsync 2.xxx sequence, and maintain 1.xxx for the
   old client when there are bugs.  Distribution packagers may
   understand this move.

Sorry that my changes cost you time.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;03:55:17&nbsp;2007</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Nov 18 04:16:48 2007, Mark@Overmeer.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It has many benefits to try to avoid the old code: your script will
&gt; be much simpler... so smaller chance on bugs.  So, if it was my
&gt; package, I whould either
&gt;  - included Mail::IMAPClient newest version in your package
&gt;  - explain how people can upgrade their perl modules
&gt;  - start an imapsync 2.xxx sequence, and maintain 1.xxx for the
&gt;    old client when there are bugs.  Distribution packagers may
&gt;    understand this move.
&gt; 
&gt; Sorry that my changes cost you time.
</div>
Already decided what you will do?  Fork or stick to the old code?
Meanwhile, I have released the module as 3.00
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;29&nbsp;21:42:57&nbsp;2007</span>
    <span class="description">gilles.lamiral [...] laposte.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] fetch_hash BODY[HEADER] void because of a &#41;  match force</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 30 Dec 2007 03:42:44 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gilles LAMIRAL &lt;gilles.lamiral [...] laposte.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,

Sorry for the delay.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Already decided what you will do?  Fork or stick to the old code?
&gt; Meanwhile, I have released the module as 3.00
</div>
I&#39;ll do what I&#39;ve said, no fork, 
stick to the working codes, old and new.
I&#39;m paid to maintain imapsync usage, 
not to break it :-&#41;

-- 
Au revoir,                                02 99 64 31 77
                                          06 20 79 76 06
Gilles Lamiral. France, Chavagne &#40;35310&#41;  09 52 27 33 66
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;30&nbsp;03:54:20&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #9341] fetch_hash BODY[HEADER] void because of a &#41;  match force</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 30 Dec 2007 09:54:05 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gilles LAMIRAL via RT &lt;bug-Mail-IMAPClient [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Gilles LAMIRAL via RT &#40;bug-Mail-IMAPClient@rt.cpan.org&#41; [071230 02:42]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Already decided what you will do?  Fork or stick to the old code?
&gt; &gt; Meanwhile, I have released the module as 3.00
</div>&gt; 
&gt; I&#39;ll do what I&#39;ve said, no fork, 
&gt; stick to the working codes, old and new.
</div>
ok.
Please send bug-reports instead of implementing work-arounds.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m paid to maintain imapsync usage, 
&gt; not to break it :-&#41;
</div>
hum... I&#39;m not paid for this project.  So you can fix my bugs?  :-b
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;25&nbsp;03:36:15&nbsp;2008</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">problem fixed in 3.04
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;25&nbsp;03:36:18&nbsp;2008</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
