<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #128063 for CPAN: MacOS 10.13 looks for gzip in /opt/local/bin not /usr/bin</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #128063 for CPAN: MacOS 10.13 looks for gzip in /opt/local/bin not /usr/bin</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CPAN">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CPAN">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CPAN">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CPAN">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CPAN">CPAN CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">128063</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CPAN">CPAN</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
bill.cattey [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
CAC [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8164-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8165-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=128063">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825398" href="/Public/Bug/Display.html?id=128063#txn-1825398">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;17:54:57&nbsp;2018</span>
    <span class="description">bill.cattey [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> MacOS 10.13 looks for gzip in /opt/local/bin not /usr/bin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bill.cattey [...] gmail.com</td>
  </tr>
</table>
<div class="messagebody">
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825401" href="/Public/Bug/Display.html?id=128063#txn-1825401">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;18:03:32&nbsp;2018</span>
    <span class="description">bill.cattey [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825401/981932/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/981932">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 9.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#40;I&#39;m new to RT and not being efficient about getting this submission right. Sorry.&#41;

In using cpan to perform an install of the cpanm module
It worked fine under Mac OS 10.11, but after updating to 10.13, the cpanm install seemed to succeed, but actually failed, and root cause was that it was failing to find /opt/local/bin/gzip.

I originally thought root cause would like in the cpanm manifest, and opened a bug there. But I was told that the problem is with cpan.

&#40;I will include platform and version info at the bottom of this note.&#41;

There are two problems:

It should find gzip in /usr/bin/gzip, and not blow out failing to find it in /opt/local/bin/gzip
It should say that it failed, not end with the misleading:
&#34; /usr/bin/make install -- OK&#34;
Output of failed run:

wdc-home2:~ wdc$ sudo cpan install App::cpanminus
Password:
Reading &#39;/Users/wdc/.cpan/Metadata&#39;
  Database was generated on Sun, 16 Dec 2018 10:17:03 GMT
Running install for module &#39;App::cpanminus&#39;
Running make for M/MI/MIYAGAWA/App-cpanminus-1.7044.tar.gz
Checksum for /Users/wdc/.cpan/sources/authors/id/M/MI/MIYAGAWA/App-cpanminus-1.7044.tar.gz ok
sh: /opt/local/bin/gzip: No such file or directory
Package seems to come without Makefile.PL.
  &#40;The test -f &#34;/Users/wdc/.cpan/build/MIYAGAWA-zGPbQP/Makefile.PL&#34; returned false.&#41;
  Writing one on our own &#40;setting NAME to Appcpanminus&#41;

  CPAN.pm: Building M/MI/MIYAGAWA/App-cpanminus-1.7044.tar.gz

Generating a Unix-style Makefile
Writing Makefile for Appcpanminus
Writing MYMETA.yml and MYMETA.json
  MIYAGAWA/App-cpanminus-1.7044.tar.gz
  /usr/bin/make -- OK
&#39;YAML&#39; not installed, will not store persistent state
Running make test
No tests defined for Appcpanminus extension.
  MIYAGAWA/App-cpanminus-1.7044.tar.gz
  /usr/bin/make test -- OK
Running make install
Appending installation info to /Library/Perl/Updates/5.18.2/darwin-thread-multi-2level/perllocal.pod
  MIYAGAWA/App-cpanminus-1.7044.tar.gz
  /usr/bin/make install  -- OK
Proof of failure &#40;in another terminal window&#41;:

wdc-home2:trunk wdc$ sudo cpanm --installdeps .
sudo: cpanm: command not found

Corrective action:

wdc-home2:~ wdc$ sudo ln -s /usr/bin/gzip /opt/local/bin/gzip 
Output of successful install after giving a gzip for it to find:

wdc-home2:~ wdc$ sudo cpan install App::cpanminus
Reading &#39;/Users/wdc/.cpan/Metadata&#39;
  Database was generated on Sun, 16 Dec 2018 10:17:03 GMT
Running install for module &#39;App::cpanminus&#39;
Running make for M/MI/MIYAGAWA/App-cpanminus-1.7044.tar.gz
Checksum for /Users/wdc/.cpan/sources/authors/id/M/MI/MIYAGAWA/App-cpanminus-1.7044.tar.gz ok

  CPAN.pm: Building M/MI/MIYAGAWA/App-cpanminus-1.7044.tar.gz

Checking if your kit is complete...
Looks good
Generating a Unix-style Makefile
Writing Makefile for App::cpanminus
Writing MYMETA.yml and MYMETA.json
cp lib/App/cpanminus/fatscript.pm blib/lib/App/cpanminus/fatscript.pm
cp lib/App/cpanminus.pm blib/lib/App/cpanminus.pm
cp bin/cpanm blib/script/cpanm
&#34;/usr/bin/perl&#34; -MExtUtils::MY -e &#39;MY-&gt;fixin&#40;shift&#41;&#39; -- blib/script/cpanm
Manifying 1 pod document
Manifying 2 pod documents
  MIYAGAWA/App-cpanminus-1.7044.tar.gz
  /usr/bin/make -- OK
&#39;YAML&#39; not installed, will not store persistent state
Running make test
PERL_DL_NONLAZY=1 &#34;/usr/bin/perl&#34; &#34;-MExtUtils::Command::MM&#34; &#34;-MTest::Harness&#34; &#34;-e&#34; &#34;undef *Test::Harness::Switches; test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/happy_cpantesters.t .. 1/1 # App::cpanminus/1.7044
t/happy_cpantesters.t .. ok   
All tests successful.
Files=1, Tests=1,  0 wallclock secs &#40; 0.03 usr  0.01 sys +  0.03 cusr  0.01 csys =  0.08 CPU&#41;
Result: PASS
  MIYAGAWA/App-cpanminus-1.7044.tar.gz
  /usr/bin/make test -- OK
Running make install
Manifying 1 pod document
Manifying 2 pod documents
Installing /Library/Perl/5.18/App/cpanminus.pm
Installing /Library/Perl/5.18/App/cpanminus/fatscript.pm
Installing /usr/local/share/man/man1/cpanm.1
Installing /usr/local/share/man/man3/App::cpanminus.3pm
Installing /usr/local/share/man/man3/App::cpanminus::fatscript.3pm
Installing /usr/local/bin/cpanm
Appending installation info to /Library/Perl/Updates/5.18.2/darwin-thread-multi-2level/perllocal.pod
  MIYAGAWA/App-cpanminus-1.7044.tar.gz
  /usr/bin/make install  -- OK
wdc-home2:~ wdc$ which cpanm
/usr/local/bin/cpanm

Proof of success:

wdc-home2:trunk wdc$ sudo cpanm --installdeps .
--&gt; Working on .
Configuring /Users/wdc/src/pidp8i/trunk ... OK
==&gt; Found dependencies: inc::Module::Install, Parallel::Loops, Math::Subsets::List
--&gt; Working on inc::Module::Install
...


wdc-home2:~ wdc$ perl -V
Summary of my perl5 &#40;revision 5 version 18 subversion 2&#41; configuration:
   
  Platform:
    osname=darwin, osvers=17.0, archname=darwin-thread-multi-2level
    uname=&#39;darwin osx357.sd.apple.com 17.0 darwin kernel version 16.1.0: mon oct 9 13:05:29 pdt 2017; root:xnu-3789.21.4.1.7~1development_x86_64 x86_64 &#39;
    config_args=&#39;-ds -e -Dprefix=/usr -Dccflags=-g  -pipe  -Dldflags= -Dman3ext=3pm -Duseithreads -Duseshrplib -Dinc_version_list=none -Dcc=cc&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=define, usemultiplicity=define
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=define, use64bitall=define, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-arch x86_64 -arch i386 -g -pipe -fno-common -DPERL_DARWIN -fno-strict-aliasing -fstack-protector&#39;,
    optimize=&#39;-Os&#39;,
    cppflags=&#39;-g -pipe -fno-common -DPERL_DARWIN -fno-strict-aliasing -fstack-protector&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.2.1 Compatible Apple LLVM 9.0.0 &#40;clang-900.0.31&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39;-arch x86_64 -arch i386 -fstack-protector&#39;
    libpth=/usr/lib /usr/local/lib
    libs= 
    perllibs=
    libc=, so=dylib, useshrplib=true, libperl=libperl.dylib
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=bundle, d_dlsymun=undef, ccdlflags=&#39; &#39;
    cccdlflags=&#39; &#39;, lddlflags=&#39;-arch x86_64 -arch i386 -bundle -undefined dynamic_lookup -fstack-protector&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: HAS_TIMES MULTIPLICITY PERLIO_LAYERS
                        PERL_DONT_CREATE_GVSV
                        PERL_HASH_FUNC_ONE_AT_A_TIME_HARD
                        PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP
                        PERL_PRESERVE_IVUV PERL_SAWAMPERSAND USE_64_BIT_ALL
                        USE_64_BIT_INT USE_ITHREADS USE_LARGE_FILES
                        USE_LOCALE USE_LOCALE_COLLATE USE_LOCALE_CTYPE
                        USE_LOCALE_NUMERIC USE_PERLIO USE_PERL_ATOF
                        USE_REENTRANT_API
  Locally applied patches:
        /Library/Perl/Updates/&lt;version&gt; comes before system perl directories
        installprivlib and installarchlib points to the Updates directory
  Built under darwin
  Compiled at Apr 30 2018 20:18:52
  %ENV:
    PERL_MB_OPT=&#34;--install_base &#34;/Users/wdc/perl5&#34;&#34;
    PERL_MM_OPT=&#34;INSTALL_BASE=/Users/wdc/perl5&#34;
  @INC:
    /Library/Perl/5.18/darwin-thread-multi-2level
    /Library/Perl/5.18
    /Network/Library/Perl/5.18/darwin-thread-multi-2level
    /Network/Library/Perl/5.18
    /Library/Perl/Updates/5.18.2/darwin-thread-multi-2level
    /Library/Perl/Updates/5.18.2
    /System/Library/Perl/5.18/darwin-thread-multi-2level
    /System/Library/Perl/5.18
    /System/Library/Perl/Extras/5.18/darwin-thread-multi-2level
    /System/Library/Perl/Extras/5.18
    .

---
cpan -D option:

wdc-home2:~ wdc$ cpan -D cpanm
Reading &#39;/Users/wdc/.cpan/Metadata&#39;
  Database was generated on Sun, 16 Dec 2018 10:17:03 GMT
Warning: You are not allowed to write into directory &#34;/Users/wdc/.cpan/sources/authors&#34;.
    I&#39;ll continue, but if you encounter problems, they may be due
    to insufficient permissions.
Fetching with LWP:
<span class="clickylink"><a target="new" rel="nofollow" href="http://cpan.erlbaum.net/authors/01mailrc.txt.gz">http://cpan.erlbaum.net/authors/01mailrc.txt.gz</a></span>
LWP failed with code[500] message[Can&#39;t connect to cpan.erlbaum.net:80 &#40;Operation timed out&#41;]

Trying with
    /usr/local/bin/wget -O &#34;/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832&#34;
to get
    <span class="clickylink"><a target="new" rel="nofollow" href="http://cpan.erlbaum.net/authors/01mailrc.txt.gz">http://cpan.erlbaum.net/authors/01mailrc.txt.gz</a></span>
sh: /usr/local/bin/wget: Bad CPU type in executable

    Function system&#40;&#34;/usr/local/bin/wget -O &#34;/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832&#34; &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://cpan.erlbaum.net/authors/01mailrc.txt.gz">http://cpan.erlbaum.net/authors/01mailrc.txt.gz</a></span>&#34; &#34;&#41;
    returned status 126 &#40;wstat 32256&#41;
Warning: expected file [/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832] doesn&#39;t exist
    Warning: no success downloading &#39;/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832&#39;. Giving up on it.
Fetching with LWP:
<span class="clickylink"><a target="new" rel="nofollow" href="http://httpupdate40.cpanel.net/CPAN/authors/01mailrc.txt.gz">http://httpupdate40.cpanel.net/CPAN/authors/01mailrc.txt.gz</a></span>
LWP failed with code[500] message[Can&#39;t connect to httpupdate40.cpanel.net:80 &#40;Bad hostname&#41;]

Trying with
    /usr/local/bin/wget -O &#34;/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832&#34;
to get
    <span class="clickylink"><a target="new" rel="nofollow" href="http://httpupdate40.cpanel.net/CPAN/authors/01mailrc.txt.gz">http://httpupdate40.cpanel.net/CPAN/authors/01mailrc.txt.gz</a></span>
sh: /usr/local/bin/wget: Bad CPU type in executable

    Function system&#40;&#34;/usr/local/bin/wget -O &#34;/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832&#34; &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://httpupdate40.cpanel.net/CPAN/authors/01mailrc.txt.gz">http://httpupdate40.cpanel.net/CPAN/authors/01mailrc.txt.gz</a></span>&#34; &#34;&#41;
    returned status 126 &#40;wstat 32256&#41;
Warning: expected file [/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832] doesn&#39;t exist
    Warning: no success downloading &#39;/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832&#39;. Giving up on it.
Fetching with LWP:
<span class="clickylink"><a target="new" rel="nofollow" href="http://cpan.mirror.clemson.edu/authors/01mailrc.txt.gz">http://cpan.mirror.clemson.edu/authors/01mailrc.txt.gz</a></span>
Can&#39;t write to &#39;/Users/wdc/.cpan/sources/authors/01mailrc.txt.gz.tmp55832-55832&#39;: Permission denied at /System/Library/Perl/Extras/5.18/LWP/Protocol.pm line 105. at /System/Library/Perl/Extras/5.18/LWP/UserAgent.pm line 915.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825434" href="/Public/Bug/Display.html?id=128063#txn-1825434">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;20:49:52&nbsp;2018</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825434/981953/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/981953">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 708b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2018-12-19 15:03:32, bill.cattey@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In using cpan to perform an install of the cpanm module
&gt; It worked fine under Mac OS 10.11, but after updating to 10.13, the
&gt; cpanm install seemed to succeed, but actually failed, and root cause
&gt; was that it was failing to find /opt/local/bin/gzip.
</div>
What is the value of your $PATH? If /opt/local/bin is in $PATH, everything
should work properly.

CPAN.pm should not look in that directory normally; this directory is added to
$PATH via macports &#40;/opt/local is the directory that macports uses for its
installations&#41;. Likewise other package installers have their own custom
directories for their installations and will update $PATH to include them.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825435" href="/Public/Bug/Display.html?id=128063#txn-1825435">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;20:49:52&nbsp;2018</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825446" href="/Public/Bug/Display.html?id=128063#txn-1825446">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;22:42:50&nbsp;2018</span>
    <span class="description">ANDK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825446/981961/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/981961">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 348b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Or maybe your config needs to be adjusted? If the cpan shell once was configured that path to gzip is /opt/local/bin/gzip, it will continue to look there. Maybe try &#39;o conf init gzip&#39; in the cpan shell or edit the config file directly.

I have no OSX box myself, so I need your help to identify what the problem is. Thanks to Karen for stepping in.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825449" href="/Public/Bug/Display.html?id=128063#txn-1825449">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;23:08:41&nbsp;2018</span>
    <span class="description">bill.cattey [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825449/981964/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/981964">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Dec 19 20:49:52 2018, ETHER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 2018-12-19 15:03:32, bill.cattey@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; In using cpan to perform an install of the cpanm module
&gt; &gt; It worked fine under Mac OS 10.11, but after updating to 10.13, the
&gt; &gt; cpanm install seemed to succeed, but actually failed, and root cause
&gt; &gt; was that it was failing to find /opt/local/bin/gzip.
</div>&gt; 
&gt; What is the value of your $PATH? If /opt/local/bin is in $PATH,
&gt; everything
&gt; should work properly.
&gt; 
&gt; CPAN.pm should not look in that directory normally; this directory is
&gt; added to
&gt; $PATH via macports &#40;/opt/local is the directory that macports uses for
&gt; its
&gt; installations&#41;. Likewise other package installers have their own
&gt; custom
&gt; directories for their installations and will update $PATH to include
&gt; them.
</div>

/opt/local/bin is in my path:

wdc-home2:~ wdc$ echo $PATH
/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/usr/local/git/bin:/usr/local/bin:/opt/local/bin:/opt/local/sbin:/opt/local/libexec/qt4/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin

But the problem was that, cpan was looking ONLY in /opt/local/bin for gzip.  On Mac OS 10.13, gzip is in /usr/bin &#40;which is also in my PATH.&#41;

So cpan was using some funky path, not related to my shell path.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825452" href="/Public/Bug/Display.html?id=128063#txn-1825452">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;23:22:17&nbsp;2018</span>
    <span class="description">bill.cattey [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825452/981966/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/981966">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Dec 19 22:42:50 2018, ANDK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Or maybe your config needs to be adjusted? If the cpan shell once was
&gt; configured that path to gzip is /opt/local/bin/gzip, it will continue
&gt; to look there. Maybe try &#39;o conf init gzip&#39; in the cpan shell or edit
&gt; the config file directly.
&gt; 
&gt; I have no OSX box myself, so I need your help to identify what the
&gt; problem is. Thanks to Karen for stepping in.
</div>
It is possible that cpan had a stale configuration from the old Mac OS install.

Here is what I get when I run the cpan shell, and try &#34;o conf init gzip&#34; as you suggest.
I find it odd that it complained about not being able to write 
/Users/wdc/.cpan/CPAN/MyConfig.pm the first time, but was able to do so
when I did &#34;su cpan&#34;.

However I see that root owns my .cpan directory.  I have no idea how that could have happened.

wdc-home2:trunk wdc$ ls -ld ~/.cpan
drwxr-xr-x  8 root  staff  256 Dec 19 23:16 /Users/wdc/.cpan

There&#39;s a TON of stuff in there owned by root.  Why is cpan creating a system-level
hierarchy of installation under a user home directory???

I also don&#39;t understand what the complaints are about unknown config variables.

I can look for a global config file, if you have suggestions about where to look.

Here is the output:

wdc-home2:~ wdc$ cpan
Terminal does not support AddHistory.


Your configuration suggests that CPAN.pm should use a working
directory of
    /Users/wdc/.cpan
Unfortunately we could not create the lock file
    /Users/wdc/.cpan/.lock
due to &#39;Permission denied&#39;.

Please make sure that the configuration variable
    $CPAN::Config-&gt;{cpan_home}
points to a directory where you can write a .lock file. You can set
this variable in either a CPAN/MyConfig.pm or a CPAN/Config.pm in your
@INC path;

cpan shell -- CPAN exploration and modules installation &#40;v2.00&#41;
Enter &#39;h&#39; for help.

nolock_cpan[1]&gt; o conf init gzip
 &lt;gzip&gt;
Where is your gzip program? [/opt/local/bin/gzip] /usr/bin/gzip

Please remember to call &#39;o conf commit&#39; to make the config permanent!

nolock_cpan[2]&gt; o conf commit
WARNING: CPAN.pm is unable to write a configuration file.  You
must be able to create and write to &#39;/Users/wdc/.cpan/CPAN/MyConfig.pm&#39;.

Aborting configuration.

nolock_cpan[3]&gt; quit
wdc-home2:~ wdc$ sudo cpan
Terminal does not support AddHistory.

cpan shell -- CPAN exploration and modules installation &#40;v2.00&#41;
Enter &#39;h&#39; for help.

cpan[1]&gt; o conf init gzip
 &lt;gzip&gt;
Where is your gzip program? [/opt/local/bin/gzip] /usr/bin/gzip

Please remember to call &#39;o conf commit&#39; to make the config permanent!

cpan[2]&gt; o conf commit
Unknown config variable &#39;recommends_policy&#39;
Unknown config variable &#39;suggests_policy&#39;
Unknown config variable &#39;use_prompt_default&#39;
commit: wrote &#39;/Users/wdc/.cpan/CPAN/MyConfig.pm&#39;

cpan[3]&gt; quit
Terminal does not support GetHistory.
Lockfile removed.
wdc-home2:~ wdc$ 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825580" href="/Public/Bug/Display.html?id=128063#txn-1825580">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;20&nbsp;16:22:11&nbsp;2018</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #128063] MacOS 10.13 looks for gzip in /opt/local/bin not /usr/bin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 20 Dec 2018 22:21:58 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Bill Cattey via RT&#34; &lt;bug-CPAN [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andreas Koenig &lt;andreas.koenig.7os6VVqR [...] franz.ak.mind.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825580/982020/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/982020">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; On Wed, 19 Dec 2018 23:22:18 -0500, &#34;Bill Cattey via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; said:
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt;        Queue: CPAN
  &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=128063">https://rt.cpan.org/Ticket/Display.html?id=128063</a></span> &gt;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; On Wed Dec 19 22:42:50 2018, ANDK wrote:
<div class="message-stanza open"> &gt;&gt; Or maybe your config needs to be adjusted? If the cpan shell once was
 &gt;&gt; configured that path to gzip is /opt/local/bin/gzip, it will continue
 &gt;&gt; to look there. Maybe try &#39;o conf init gzip&#39; in the cpan shell or edit
 &gt;&gt; the config file directly.
 &gt;&gt; 
 &gt;&gt; I have no OSX box myself, so I need your help to identify what the
 &gt;&gt; problem is. Thanks to Karen for stepping in.
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; It is possible that cpan had a stale configuration from the old Mac OS install.
</div>
That&#39;s what I guessed, glad you confirm it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Here is what I get when I run the cpan shell, and try &#34;o conf init gzip&#34; as you suggest.
  &gt; I find it odd that it complained about not being able to write 
  &gt; /Users/wdc/.cpan/CPAN/MyConfig.pm the first time, but was able to do so
  &gt; when I did &#34;su cpan&#34;.
</div>
I think it&#39;s crucial that you make up your own rules under which circumstances
you use sudo. The cpan shell is not going to tell you.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; However I see that root owns my .cpan directory.  I have no idea how
  &gt; that could have happened.
</div>
Better you watch who accesses your keyboard!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; wdc-home2:trunk wdc$ ls -ld ~/.cpan
  &gt; drwxr-xr-x  8 root  staff  256 Dec 19 23:16 /Users/wdc/.cpan
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; There&#39;s a TON of stuff in there owned by root.  Why is cpan creating a system-level
  &gt; hierarchy of installation under a user home directory???
</div>
There seem to be &#40;at least&#41; two questions asked at once. One is that the
tool cpan requires space to to its duty. When you go through the
configuration procedure step by step you can configure many aspects of
where and how it has to do it.

The second question is about the permissions of these files. Seriously,
the permissions depend on how you were using the cpan shell. When you
switched between your user identity and sudo to root a lot, then it of
course happened that files were created sometimes as you and sometimes
as root. That&#39;s something you need to understand properly. And when a
directory belongs to root and later you act as yourself, it of course
can easily happen that you have no permissions to use your system.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I also don&#39;t understand what the complaints are about unknown config
  &gt; variables.
</div>
I also don&#39;t know. Looks like at some point you upgraded cpan and later
downgraded it again. But I&#39;m not sure. But this is certainly something
you can ignore for now. Better you concentrate on permissions first.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I can look for a global config file, if you have suggestions about
  &gt; where to look.
</div>
It is /Users/wdc/.cpan/CPAN/MyConfig.pm, you mentioned it yourself
several time.

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825591" href="/Public/Bug/Display.html?id=128063#txn-1825591">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;20&nbsp;18:04:54&nbsp;2018</span>
    <span class="description">bill.cattey [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825591/982026/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/982026">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 20 16:22:11 2018, andreas.koenig.7os6VVqR@franz.ak.mind.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt; On Wed, 19 Dec 2018 23:22:18 -0500, &#34;Bill Cattey via RT&#34; &lt;bug-
&gt; &gt;&gt;&gt;&gt;&gt; CPAN@rt.cpan.org&gt; said:
</div></div>&gt; 
<div class="message-stanza open">&gt; &gt; Queue: CPAN
&gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=128063">https://rt.cpan.org/Ticket/Display.html?id=128063</a></span> &gt;
</div>&gt; 
<div class="message-stanza open">&gt; &gt; On Wed Dec 19 22:42:50 2018, ANDK wrote:
<div class="message-stanza open">&gt; &gt;&gt; Or maybe your config needs to be adjusted? If the cpan shell once
&gt; &gt;&gt; was
&gt; &gt;&gt; configured that path to gzip is /opt/local/bin/gzip, it will
&gt; &gt;&gt; continue
&gt; &gt;&gt; to look there. Maybe try &#39;o conf init gzip&#39; in the cpan shell or
&gt; &gt;&gt; edit
&gt; &gt;&gt; the config file directly.
&gt; &gt;&gt;
&gt; &gt;&gt; I have no OSX box myself, so I need your help to identify what the
&gt; &gt;&gt; problem is. Thanks to Karen for stepping in.
</div></div>&gt; 
<div class="message-stanza open">&gt; &gt; It is possible that cpan had a stale configuration from the old Mac
&gt; &gt; OS install.
</div>&gt; 
&gt; That&#39;s what I guessed, glad you confirm it.
&gt; 
<div class="message-stanza open">&gt; &gt; Here is what I get when I run the cpan shell, and try &#34;o conf init
&gt; &gt; gzip&#34; as you suggest.
&gt; &gt;  I find it odd that it complained about not being able to write
&gt; &gt; /Users/wdc/.cpan/CPAN/MyConfig.pm the first time, but was able to do
&gt; &gt; so
&gt; &gt; when I did &#34;su cpan&#34;.
</div>&gt; 
&gt; I think it&#39;s crucial that you make up your own rules under which
&gt; circumstances
&gt; you use sudo. The cpan shell is not going to tell you.
&gt; 
<div class="message-stanza open">&gt; &gt; However I see that root owns my .cpan directory.  I have no idea how
&gt; &gt; that could have happened.
</div>&gt; 
&gt; Better you watch who accesses your keyboard!
&gt; 
<div class="message-stanza open">&gt; &gt; wdc-home2:trunk wdc$ ls -ld ~/.cpan
&gt; &gt; drwxr-xr-x  8 root  staff  256 Dec 19 23:16 /Users/wdc/.cpan
</div>&gt; 
<div class="message-stanza open">&gt; &gt; There&#39;s a TON of stuff in there owned by root.  Why is cpan creating
&gt; &gt; a system-level
&gt; &gt; hierarchy of installation under a user home directory???
</div>&gt; 
&gt; There seem to be &#40;at least&#41; two questions asked at once. One is that
&gt; the
&gt; tool cpan requires space to to its duty. When you go through the
&gt; configuration procedure step by step you can configure many aspects of
&gt; where and how it has to do it.
&gt; 
&gt; The second question is about the permissions of these files.
&gt; Seriously,
&gt; the permissions depend on how you were using the cpan shell. When you
&gt; switched between your user identity and sudo to root a lot, then it of
&gt; course happened that files were created sometimes as you and sometimes
&gt; as root. That&#39;s something you need to understand properly. And when a
&gt; directory belongs to root and later you act as yourself, it of course
&gt; can easily happen that you have no permissions to use your system.
&gt; 
<div class="message-stanza open">&gt; &gt; I also don&#39;t understand what the complaints are about unknown config
&gt; &gt; variables.
</div>&gt; 
&gt; I also don&#39;t know. Looks like at some point you upgraded cpan and
&gt; later
&gt; downgraded it again. But I&#39;m not sure. But this is certainly something
&gt; you can ignore for now. Better you concentrate on permissions first.
&gt; 
<div class="message-stanza open">&gt; &gt; I can look for a global config file, if you have suggestions about
&gt; &gt; where to look.
</div>&gt; 
&gt; It is /Users/wdc/.cpan/CPAN/MyConfig.pm, you mentioned it yourself
&gt; several time.
</div>
Thank you, Andreas, for taking the time to answer my question point by point.

I think I had an over-arching question that I asked poorly.  Before I ask the question,
I would like to air a misunderstanding I have about how cpan does its work.

I will also note in passing that I have two parallel perl systems installed, and maybe that&#39;s ok,
but I&#39;m hoping that, as I understand better, I&#39;ll be able to better control whether or not the second one
is actually kept and/or used.

So I have two perl systems installed, the one that came with Mac OS. The main perl executable
lives in /usr/bin/perl. &#40;version 5.18&#41;

The other lives in /opt/local.  &#40;version 5.26&#41; It got installed when, after my 10.13 upgrade, I tried to use
macports to install cpanminus.  I did &#34;sudo port install p5-app-cpanminus&#34;.  Oddly, that install didn&#39;t
create a link from /opt/local/bin/perl to /opt/local/bin/perl5.26.   

Indeed I have /opt/local/bin/cpan-5.26 and  /opt/local/bin/cpanm-5.26, but no perl, cpan, or cpanm
in /opt/localbin.  &#40;I shall have to take this up with the macports folk to understand why that is so,
since I did the macports install first, and expected it to shadow my system perl with a newer
version and just work.

My expectation was that I needed to run cpan as root, because I expected it would be 
performing installs into system directories, &#40;as Macports did when it installed stuff in
/opt/local.&#41;

&#40;We&#39;re getting to my question.  Thanks for your patience this far.&#41;

QUESTION:

Is cpan intended for use by people who do not have access to system directories so that
they can install Perl modules for themselves without bothering system administrators?

I.E. Is it a mistake ever to run cpan as root?

I think this means that my bug report should be closed as &#34;Not a Bug&#34;, but also brings up 
a couple questions:

1. What document should I have read to have understood how to use cpan correctly?

2. Given that I have a cpan install in two places with inconsistent and broken legacy configurations,
how do I clean this up?

I apologize in advance for needing support instead of a bug fix.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1825604" href="/Public/Bug/Display.html?id=128063#txn-1825604">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;21&nbsp;00:02:46&nbsp;2018</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #128063] MacOS 10.13 looks for gzip in /opt/local/bin not /usr/bin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 21 Dec 2018 06:02:27 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Bill Cattey via RT&#34; &lt;bug-CPAN [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andreas Koenig &lt;andreas.koenig.7os6VVqR [...] franz.ak.mind.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1825604/982035/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/982035">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; On Thu, 20 Dec 2018 18:04:55 -0500, &#34;Bill Cattey via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; said:
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Thank you, Andreas, for taking the time to answer my question point by point.
</div>
You&#39;re welcome!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I think I had an over-arching question that I asked poorly.  Before I ask the question,
  &gt; I would like to air a misunderstanding I have about how cpan does its work.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I will also note in passing that I have two parallel perl systems installed, and maybe that&#39;s ok,
  &gt; but I&#39;m hoping that, as I understand better, I&#39;ll be able to better control whether or not the second one
  &gt; is actually kept and/or used.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; So I have two perl systems installed, the one that came with Mac OS. The main perl executable
  &gt; lives in /usr/bin/perl. &#40;version 5.18&#41;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; The other lives in /opt/local.  &#40;version 5.26&#41; It got installed when, after my 10.13 upgrade, I tried to use
  &gt; macports to install cpanminus.  I did &#34;sudo port install p5-app-cpanminus&#34;.  Oddly, that install didn&#39;t
  &gt; create a link from /opt/local/bin/perl to /opt/local/bin/perl5.26.   
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Indeed I have /opt/local/bin/cpan-5.26 and  /opt/local/bin/cpanm-5.26, but no perl, cpan, or cpanm
  &gt; in /opt/localbin.  &#40;I shall have to take this up with the macports folk to understand why that is so,
  &gt; since I did the macports install first, and expected it to shadow my system perl with a newer
  &gt; version and just work.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; My expectation was that I needed to run cpan as root, because I expected it would be 
  &gt; performing installs into system directories, &#40;as Macports did when it installed stuff in
  &gt; /opt/local.&#41;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; &#40;We&#39;re getting to my question.  Thanks for your patience this far.&#41;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; QUESTION:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Is cpan intended for use by people who do not have access to system directories so that
  &gt; they can install Perl modules for themselves without bothering
  &gt; system administrators?
</div>
For every single thing it works on it has two types of phases, one for
downloading, building and testing stuff and one to install. Only the
installation phase is a candidate that may require root permissions.
Since perl knowns where to install, cpan and cpanm let other perl and
system tools do the installation. When root permissions are required for
the installation step, you can configure how to switch user which you
normally do with sudo. If root permissions are not required, you can
configure to not use sudo.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I.E. Is it a mistake ever to run cpan as root?
</div>
Given that it downloads and installs software from the internet for you,
it is inherently dangerous and should not be run as root. Same for
cpanm.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I think this means that my bug report should be closed as &#34;Not a Bug&#34;, but also brings up 
  &gt; a couple questions:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; 1. What document should I have read to have understood how to use
  &gt; cpan correctly?
</div>
I think the CPAN.pm manpage has everything you need. Then start learning
about other tools like probably local::lib. Your complications seem to
have their root in having to deal with two perls which may need some
extra knowledge about those.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; 2. Given that I have a cpan install in two places with inconsistent
  &gt; and broken legacy configurations, how do I clean this up?
</div>
chown -R you:you ~/.cpan

might be good enough. Whenever you have doubts that the system operates
the way you expect it to run, take a step back and find out what&#39;s
wrong. Backup your system and fix the problem before you continue using
the cpan shell. Reconfiguring your cpan installation is done with

o conf init

from the cpan shell.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I apologize in advance for needing support instead of a bug fix.
</div>
np:&#41;
-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1852573" href="/Public/Bug/Display.html?id=128063#txn-1852573">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;15&nbsp;18:42:25&nbsp;2019</span>
    <span class="description">CAC [...] cpan.org -  Cc CAC added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1852843" href="/Public/Bug/Display.html?id=128063#txn-1852843">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;18&nbsp;15:01:34&nbsp;2019</span>
    <span class="description">CAC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1852843/995551/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/995551">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza"><span style="font-family:arial,helvetica,sans-serif;">I am another MacPorts user, and have encountered a similar issue. I want to try clarifying some things here.</span>

<div>
	&nbsp;</div>


<div>
	<span style="font-family:arial,helvetica,sans-serif;">If I understand correctly, CPAN.pm requires gzip. If that is correct, then I think there are actually two issues noticed here: one being that CPAN shell will continue with installing a module even if the gzip is missing (i.e. it should instead fail early and not continue), and the other being that MacPorts installs CPAN.pm configured to use gzip from MacPorts, but does not ensure that it installs gzip. For this second issue I have opened a ticket: <span class="clickylink"><a target="new" rel="nofollow" href="https://trac.macports.org/ticket/58610">https://trac.macports.org/ticket/58610</a></span></span></div>


<div>
	&nbsp;</div>


<div>
	<span style="font-family:arial,helvetica,sans-serif;">Some more notes on MacPorts:</span></div>


<div>
	&nbsp;</div>


<div>
	<span style="font-family:arial,helvetica,sans-serif;">MacPorts has a policy to minimize dependency on software outside of its control, so it may be intentional that it configures CPAN.pm to **only** use /opt/local/bin/gzip, and avoid using gzip from /usr/bin or from the PATH; if this is the case, then MacPorts needs to adjust the perl5.xx port to also install gzip. However if this policy does not apply to gzip, then CPAN.pm presumably needs to be configured with the system gzip (and probably still not from PATH to reduce potential issues or confusion).</span></div>


<div>
	&nbsp;</div>


<div>
	<span style="font-family:arial,helvetica,sans-serif;">The perl5 port is what to install in order to have unversioned aliases for perl, cpan, and quite few other commands. Installing p5-app-cpanminus does not automatically install the perl5 port (p5-app-cpanminus installs p5.xx-app-cpanminus, which installs perl5.xx; perl5 installs perl5.xx, but perl5.xx does not install perl5). However, there does not appear to be a way to automatically have an unversioned alias for cpanm (I suggest filing a bug/feature request if that&#39;s desirable).</span></div>


<div>
	&nbsp;</div>


<div>
	<span style="font-family:arial,helvetica,sans-serif;">One main argument for MacPorts only providing versioned commands by default is to allow specifying different Perl versions among multiple ones provided by MacPorts, or alongside installations outside MacPorts (e.g. the system Perl bundled with macOS).</span></div>


<div>
	&nbsp;</div>


<div>
	<span style="font-family:arial,helvetica,sans-serif;">If there is a port p5-foo-bar for a module Foo::Bar, it is probably recommended to try installing it through MacPorts before trying through cpan/cpanm.</span></div>


</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.591253</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
