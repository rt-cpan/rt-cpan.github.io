<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #20028 for Mac-Carbon: AppleEvents/t/desc.t, event.t failing</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #20028 for Mac-Carbon: AppleEvents/t/desc.t, event.t failing</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Mac-Carbon/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Mac-Carbon/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Mac-Carbon/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Mac-Carbon/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Mac-Carbon">Mac-Carbon CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">20028</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Mac-Carbon/Active/">Mac-Carbon</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dha [...] panix.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-19732-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.75    </td>
  </tr>
  <tr id="CF-19733-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.76    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;21&nbsp;12:37:42&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AppleEvents/t/desc.t, event.t failing</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mac OS 10.4.6

-----

~/Mac-Carbon-0.75 12:33:36% perl -v

This is perl, v5.8.8 built for darwin-2level

Copyright 1987-2006, Larry Wall

Perl may be copied only under the terms of either the Artistic License
or the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using &#34;man perl&#34; or &#34;perldoc perl&#34;.  If you have access to the
Internet, point your browser at <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perl.org/">http://www.perl.org/</a></span>, the Perl Home Page.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> desc.out</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> event.out</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;21&nbsp;12:46:21&nbsp;2006</span>
    <span class="description">cnandor [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks ... my copy of Test::More was old and incompatible.  Try these new tests.  I&#39;ll do another 
release today &#40;trying to nail down one more problem someone is having with Mac::Speech&#41;.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl
use warnings;
use strict;
use FindBin &#39;$Bin&#39;;

use Test::More tests =&gt; 1 + 22 + &#40;8+1146+14+715+495+8&#41; + &#40;13+13+13&#41;;

BEGIN {
	use_ok&#40;&#39;Mac::AppleEvents&#39;&#41;;
	require &#34;$Bin/helper.pl&#34;;
}

use Mac::Types;
use MacPerl &#39;MakePath&#39;;

my $fourcharcode = [&#39;abcd&#39;, &#39;1   &#39;, &#34;\0\0\0\0&#34;];
my $stringdata   = [&#39;a&#39;, &#39;ab&#39;, &#39;abc&#39;, @$fourcharcode, &#39;abcde&#39;, &#39;abcdef&#39;, &#34;this is some random text I am just gonna add here OK?&#34;];

# 15
my %types = &#40;
	# 3 * 5 = 15
	typeEnumerated&#40;&#41;	=&gt; $fourcharcode,
 	typeType&#40;&#41;		=&gt; $fourcharcode,
 	typeKeyword&#40;&#41;		=&gt; $fourcharcode,
 	typeApplSignature&#40;&#41;	=&gt; $fourcharcode,
 	typeProperty&#40;&#41;		=&gt; $fourcharcode,

	# 9
 	typeChar&#40;&#41;		=&gt; $stringdata,

	# 2, 3 * 5 = 17
 	typeBoolean&#40;&#41;		=&gt; [0, 1],
 	typeShortInteger&#40;&#41;	=&gt; [0, 123, -1234],
 	typeInteger&#40;&#41;		=&gt; [0, -2**24, 2**31-1],
 	typeShortFloat&#40;&#41;	=&gt; [0, 123.45, -1234.56],
 	typeFloat&#40;&#41;		=&gt; [0, 12345678.91, &#40;-2**24 + .234234&#41;],
 	typeMagnitude&#40;&#41;		=&gt; [0, 2**32-1, 2**31],

	# 1
	typeFSS&#40;&#41;		=&gt; [&#39;/System/Library/CoreServices/Finder.app&#39;],
	typeQDRectangle&#40;&#41;	=&gt; [ [1, 240, 320, 2000] ],
	typeRGBColor&#40;&#41;		=&gt; [ [65535, 0, 0] ],

	# qdrt, cRGB, STR, STR#
&#41;; # = 44

SKIP: {
#	skip &#34;Basic AEDesc tests&#34;, 22;

	my $desc = AEDesc-&gt;new&#40;typeChar&#41;;
	is&#40;ref&#40;$desc&#41;, &#39;AEDesc&#39;,				&#39;Create AEDesc&#39;&#41;;
	is&#40;$desc-&gt;type, typeChar,				&#39;Check type&#39;&#41;;
	ok&#40;!defined&#40;$desc-&gt;get&#41;,				&#39;No data&#39;&#41;;

	my $hand = Handle-&gt;new&#40;&#39;something&#39;&#41;;
	is&#40;$desc-&gt;type&#40;typeType&#41;, typeType,			&#39;Change type&#39;&#41;;
	ok&#40;!defined&#40;$desc-&gt;get&#41;,				&#39;No data&#39;&#41;;
	is&#40;ref&#40;$hand&#41;, &#39;Handle&#39;,				&#39;Create handle&#39;&#41;;
	ok&#40;$desc-&gt;data&#40;$hand&#41;,					&#39;Add handle&#39;&#41;;
	is&#40;$desc-&gt;get, &#39;some&#39;,					&#39;Check value&#39;&#41;; # truncated due to typeType

	is&#40;$desc-&gt;type&#40;typeChar&#41;, typeChar,			&#39;Change type&#39;&#41;;
	# 6 * 2 = 12
	for my $i &#40;0, 1, 10, 100, 1000, 10000&#41; {
		ok&#40;$desc-&gt;data&#40;Handle-&gt;new&#40;$i&#41;&#41;,		&#39;Add handle&#39;&#41;;
		is&#40;$desc-&gt;get, $i,				&#39;Check value&#39;&#41;;
	}

	ok&#40;AEDisposeDesc&#40;$desc&#41;,				&#39;Dispose&#39;&#41;;
}

SKIP: {
#	skip &#34;AEDesc and AEList tests&#34;, 8+1146+14+715+495+8;

	# 8
	my $list = AECreateList&#40;&#39;&#39;, 0&#41;;
	is&#40;$list-&gt;type, typeAEList,					&#39;Create AEList&#39;&#41;;
	my $reco = AECreateList&#40;&#39;&#39;, 1&#41;;
	is&#40;$reco-&gt;type, typeAERecord,					&#39;Create AERecord&#39;&#41;;

	my $list2 = AECreateList&#40;&#39;&#39;, 0&#41;;
	is&#40;$list2-&gt;type, typeAEList,					&#39;Create AEList&#39;&#41;;
	my $reco2 = AECreateList&#40;&#39;&#39;, 1&#41;;
	is&#40;$reco2-&gt;type, typeAERecord,					&#39;Create AERecord&#39;&#41;;

	my $lists = AEStream-&gt;new;
	is&#40;ref $lists, &#39;AEStream&#39;,					&#39;Create AEStream list&#39;&#41;;
	ok&#40;$lists-&gt;OpenList,						&#39;OpenList&#39;&#41;;
	my $recos = AEStream-&gt;new;
	is&#40;ref $recos, &#39;AEStream&#39;,					&#39;Create AEStream list&#39;&#41;;
	ok&#40;$recos-&gt;OpenRecord,						&#39;OpenRecord&#39;&#41;;

	my&#40;$listg_fmt, $recog_fmt, @g_param&#41; = &#40;&#39;&#39;, &#39;&#39;&#41;;

	# 44 * 4 * 5 = 880, + 44, + 33 * 4 = 132, + 15 * 6 = 90 = 1146
	for my $type &#40;sort keys %types&#41; {
		my $data = $types{$type};
		for my $datum &#40;@$data&#41; {
			my $packed = exists&#40;$MacPack{$type}&#41; ? MacPack&#40;$type, &#40;ref $datum ? @$datum : $datum&#41;&#41; : $datum;

			my $desc1 = AEDesc-&gt;new&#40;$type, $packed&#41;;
			my $desc2 = AEKeyDesc-&gt;new&#40;$type, $type, $packed&#41;;
			my $desc3 = AECreateDesc&#40;$type, $packed&#41;;
			my $desc4 = AEDuplicateDesc&#40;$desc1&#41;;

			# <span class="clickylink"><a target="new" rel="nofollow" href="http://developer.apple.com/technotes/tn/tn2045.html">http://developer.apple.com/technotes/tn/tn2045.html</a></span>
			my $builddata = $datum;
			my $lit = 0;
			my $skip = 0;
			my $hand = 0;
			if &#40;$type eq typeFSS&#41; {
				$builddata = $packed;
			} elsif &#40;$datum =~ /\0/&#41; {
				$builddata = MakeHex&#40;$datum&#41;;
				$lit = 1;
			} elsif &#40;$type eq typeType&#41; {
				$builddata = Handle-&gt;new&#40;MakeFourChar&#40;$datum&#41;&#41;;
				$hand = 1;
			} elsif &#40;$type eq typeKeyword&#41; {
				$builddata = MakeFourChar&#40;$datum&#41;;
			} elsif &#40;$type eq typeApplSignature || $type eq typeProperty || $type eq typeEnumerated&#41; {
				$builddata = &#34;&#39;$datum&#39;&#34;;
				$lit = 1;
			} elsif &#40;$type eq typeBoolean&#41; {
				$builddata = MakeNumHex&#40;$datum&#41;;
				$lit = 1;
			} elsif &#40;$type eq typeShortInteger || $type eq typeInteger&#41; {
				$lit = 1;
			} elsif &#40;SkipType&#40;$type&#41;&#41; {
				# no idea why this doesn&#39;t work, oh well
				$skip = 1;
			}

			my $desc5 = $skip ? &#39;&#39; :
				$lit  ? AEBuild&#40;&#34;$type&#40;$builddata&#41;&#34;&#41; :
				$hand ? AEBuild&#40;&#34;$type&#40;\@@&#41;&#34;, $builddata&#41; :
				        AEBuild&#40;&#34;$type&#40;\@&#41;&#34;,  $builddata&#41;;

			# <span class="clickylink"><a target="new" rel="nofollow" href="http://developer.apple.com/technotes/tn/tn2046.html">http://developer.apple.com/technotes/tn/tn2046.html</a></span>
			my $stream = AEStream-&gt;new;
			$stream-&gt;WriteDesc&#40;$type, $packed&#41;;
			my $desc6 = $stream-&gt;Close;

			#diag&#40;&#34;$type: $datum&#34;&#41;;

			if &#40;$datum eq $data-&gt;[-1]&#41; {
				ok&#40;AEPut&#40;$list, AECountItems&#40;$list&#41;+1, $type, $packed&#41;,	&#39;AEPut&#39;&#41;;
				ok&#40;AEPutKey&#40;$reco, $type, $type, $packed&#41;, 		&#39;AEPutKey&#39;&#41;;

				ok&#40;AEPutDesc&#40;$list2, AECountItems&#40;$list2&#41;+1, $desc4&#41;,	&#39;AEPutDesc&#39;&#41;;
				ok&#40;AEPutKeyDesc&#40;$reco2, $type, $desc4&#41;, 		&#39;AEPutKeyDesc&#39;&#41;;

				ok&#40;$lists-&gt;WriteDesc&#40;$type, $packed&#41;,			&#39;WriteDesc list&#39;&#41;;
				ok&#40;$recos-&gt;WriteKeyDesc&#40;$type, $type, $packed&#41;,		&#39;WriteKeyDesc record&#39;&#41;;

				unless &#40;$skip&#41; {
					if &#40;$lit&#41; {
						$listg_fmt .= &#34;$type&#40;$builddata&#41;, &#34;;
						$recog_fmt .= &#34;$type : $type&#40;$builddata&#41;, &#34;;
					} else {
						my $at = $hand ? &#39;@@&#39; : &#39;@&#39;;
						$listg_fmt .= &#34;$type&#40;$at&#41;, &#34;;
						$recog_fmt .= &#34;$type : $type&#40;$at&#41;, &#34;;
						push @g_param, $builddata;
					}
				}
			}

			#diag&#40;&#34;$type&#40;$builddata&#41;&#34;&#41;;
			#diag&#40;AEPrint&#40;$desc4&#41;&#41;;
			#diag&#40;AEPrint&#40;$desc5&#41;&#41; if $desc5;
			for my $desc &#40;$desc1, $desc2, $desc3, $desc4, $desc5, $desc6&#41; {
				next unless $desc;
				CheckDesc&#40;$desc, $type, $datum&#41;;
			}
		}
	}

	# 14
	s/, $// for &#40;$listg_fmt, $recog_fmt&#41;;
	my $listg = AEBuild&#40;&#34;[$listg_fmt]&#34;, @g_param&#41;;
	is&#40;$listg-&gt;type, typeAEList,			&#39;Create AEList&#39;&#41;;
	my $recog = AEBuild&#40;&#34;{$recog_fmt}&#34;, @g_param&#41;;
	is&#40;$recog-&gt;type, typeAERecord,			&#39;Create AERecord&#39;&#41;;

	ok&#40;$lists-&gt;CloseList,				&#39;CloseList&#39;&#41;;
	ok&#40;$recos-&gt;CloseRecord,				&#39;CloseRecord&#39;&#41;;

	ok&#40;my $list3 = $lists-&gt;Close,			&#39;Close list&#39;&#41;;
	ok&#40;my $reco3 = $recos-&gt;Close,			&#39;Close record&#39;&#41;;

	my $count = scalar keys %types;
	for my $L &#40;$list, $list2, $list3, $reco, $reco2, $reco3&#41; {
		is&#40;AECountItems&#40;$L&#41;, $count,		&#39;Count list items&#39;&#41;;
	}

	my $countg = $count - 5;
	for my $L &#40;$listg, $recog&#41; {
		is&#40;AECountItems&#40;$L&#41;, $countg,		&#39;Count list items&#39;&#41;;
	}

	# 15 * 13 * 3 = 585, + 13 * 10 = 715
	my $i = 0;
	my $g = 0;
	for my $type &#40;sort keys %types&#41; {
		$i++; $g++;
		my $datum = $types{$type}[-1];
		#diag&#40;&#34;AEList: $type: $datum&#34;&#41;;

		my $j = 0;
		for my $L &#40;$list, $list2, $list3, $listg&#41; {
			my $k = $i;
			if &#40;++$j == 4&#41; {
				#diag&#40;&#34;ok!: $type: $g&#34;&#41;;
				if &#40;SkipType&#40;$type&#41;&#41; {
					$g--;
					next;
				}
				$k = $g;
			}
			my $desc = AEGetNthDesc&#40;$L, $k&#41;;
			CheckDesc&#40;$desc, $type, $datum&#41;;
		}

		$j = 0;
		for my $L &#40;$reco, $reco2, $reco3, $recog&#41; {
			my $k = $i;
			if &#40;++$j == 4&#41; {
				#diag&#40;&#34;ok!!: $type: $g&#34;&#41;;
				if &#40;SkipType&#40;$type&#41;&#41; {
					next;
				}
				$k = $g;
			}
			my $desc = AEGetKeyDesc&#40;$L, $type&#41;;
			CheckDesc&#40;$desc, $type, $datum&#41;;

			# same as above, but fetch by index
			&#40;$desc, my&#40;$key&#41;&#41; = AEGetNthDesc&#40;$L, $k&#41;;
			is&#40;$key, $type,			&#39;Check key&#39;&#41;;
			CheckDesc&#40;$desc, $type, $datum&#41;;
		}
	}

	# 15 * 11 * 3 = 495
	$i = 0;
	for my $type &#40;sort keys %types&#41; {
		$i++;
		my $datum = $types{$type}[-1];
		#diag&#40;&#34;AEDelete: $type: $datum&#34;&#41;;

		for my $L &#40;$list, $list2, $list3&#41; {
			my $desc = AEGetNthDesc&#40;$L, 1&#41;;
			CheckDesc&#40;$desc, $type, $datum&#41;;
			AEDeleteItem&#40;$L, 1&#41;;
			my $tab = AECountItems&#40;$L&#41;;
			cmp_ok&#40;$tab, &#39;==&#39;, $count-$i,	&#39;Count items remaining&#39;&#41;;
		}

		for my $L &#40;$reco, $reco2, $reco3&#41; {
			my&#40;$desc, $key&#41; = AEGetNthDesc&#40;$L, 1&#41;;
			is&#40;$key, $type,			&#39;Check key&#39;&#41;;
			CheckDesc&#40;$desc, $type, $datum&#41;;
			AEDeleteItem&#40;$L, 1&#41;;
			my $tab = AECountItems&#40;$L&#41;;
			$tab =~ s/\D+//;
			is&#40;$tab, $count-$i,		&#39;Count items remaining&#39;&#41;;
		}
	}

	# 8
	for my $L &#40;$list, $list2, $list3, $listg, $reco, $reco2, $reco3, $recog&#41; {
		ok&#40;AEDisposeDesc&#40;$L&#41;, 			&#39;Dispose list&#39;&#41;;
	}
}

SKIP: {
#	skip &#34;AECoerce tests&#34;, 13+13+13;

	my $string = &#34;abcdef&#34;;
	my $desc = AEDesc-&gt;new&#40;typeChar, $string&#41;;
	my $desc2 = AECoerceDesc&#40;$desc, typeUnicodeText&#41;;
	my $desc3 = AECoerce&#40;typeChar, $string, typeUnicodeText&#41;;

	# 13
	CheckDesc&#40;$desc, typeChar, $string&#41;;

	CheckRef&#40;$desc2, typeUnicodeText&#41;;
	CheckType&#40;$desc2, typeUnicodeText&#41;;
	is&#40;length&#40;$desc2-&gt;get&#41;, 2*length&#40;$string&#41;,		&#39;Length check&#39;&#41;;

	CheckRef&#40;$desc3, typeUnicodeText&#41;;
	CheckType&#40;$desc3, typeUnicodeText&#41;;
	is&#40;length&#40;$desc3-&gt;get&#41;, 2*length&#40;$string&#41;,		&#39;Length check&#39;&#41;;

	is&#40;$desc2-&gt;get, $desc3-&gt;get,				&#39;Value check&#39;&#41;;

	CheckDispose&#40;$desc2&#41;;
	CheckDispose&#40;$desc3&#41;;


	my $keyw = &#34;abcd&#34;;
	$desc = AEDesc-&gt;new&#40;typeKeyword, $keyw&#41;;
	$desc2 = AECoerceDesc&#40;$desc, typeChar&#41;;
	$desc3 = AECoerce&#40;typeKeyword, $keyw, typeChar&#41;;

	# 13
	CheckDesc&#40;$desc, typeKeyword, $keyw&#41;;
	is&#40;$desc2-&gt;get, $desc3-&gt;get,				&#39;Value check&#39;&#41;;
	CheckDesc&#40;$desc2, typeChar, $keyw&#41;;
	CheckDesc&#40;$desc3, typeChar, $keyw&#41;;



	my $num = 2**18;
	my $num2 = $num + .45;
	$desc = AEDesc-&gt;new&#40;typeFloat, MacPack&#40;typeFloat, $num2&#41;&#41;;
	$desc2 = AECoerceDesc&#40;$desc, typeInteger&#41;;
	$desc3 = AECoerce&#40;typeFloat, MacPack&#40;typeFloat, $num2&#41;, typeInteger&#41;;

	# 13
	CheckDesc&#40;$desc, typeFloat, $num2&#41;;

	CheckRef&#40;$desc2, typeInteger&#41;;
	CheckType&#40;$desc2, typeInteger&#41;;
	is&#40;$desc2-&gt;get, $num,					&#39;Value check&#39;&#41;;

	CheckRef&#40;$desc3, typeInteger&#41;;
	CheckType&#40;$desc3, typeInteger&#41;;
	is&#40;$desc3-&gt;get, $num,					&#39;Value check&#39;&#41;;

	is&#40;$desc2-&gt;get, $desc3-&gt;get,				&#39;Value check&#39;&#41;;

	CheckDispose&#40;$desc2&#41;;
	CheckDispose&#40;$desc3&#41;;
}

sub MakeFourChar {
	pack &#34;N&#34;, unpack &#34;L&#34;, $_[0];
}

sub MakeHex {
	&#39;$&#39; . join&#40;&#39;&#39;, map { sprintf&#40;&#34;%02X&#34;, ord&#41; } split //, MakeFourChar&#40;$_[0]&#41;&#41; . &#39;$&#39;;
}

sub MakeNumHex {
	my $hex = &#39;$&#39; . sprintf&#40;&#34;%02X&#34;, $_[0]&#41; . &#39;$&#39;;
	if &#40;length&#40;$hex&#41; % 2&#41; {
		$hex =~ s/^\$/\$0/;
	}
	return $hex;
}

sub SkipType {
	my&#40;$type&#41; = @_;
	return 1 if $type eq typeShortFloat || $type eq typeFloat || $type eq typeMagnitude || $type eq typeQDRectangle || $type eq typeRGBColor;
	return 0;
}

=pod

=head1 TODO

=over 4

* location/range/comparison/logical?

* AEBuild doesn&#39;t work with unsigned 32-bit or floats?

* AEBuild doesn&#39;t automatically handle byteswapping of OSTypes

* AEStream WriteData, same problem

=back



__END__
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl
use warnings;
use strict;
use FindBin &#39;$Bin&#39;;

use Test::More tests =&gt; 1+&#40;42+15&#41;+&#40;37+5&#41;+&#40;4+41+19&#41;+&#40;47*3&#41;;

BEGIN {
	use_ok&#40;&#39;Mac::AppleEvents&#39;&#41;;
	require &#34;$Bin/helper.pl&#34;;
}

use File::Spec::Functions qw&#40;catdir tmpdir&#41;;
use Mac::Files;
use Mac::Types;

my $name = &#39;mac-carbon-aeevent-test&#39;;
my $file = catdir&#40;tmpdir&#40;&#41;, $name&#41;;
my $filehex = MakeHexUTF16&#40;$name&#41;;

my $newname = &#39;mac-carbon-aeevent-test2&#39;;
my $newfile = $file . &#39;2&#39;;

END {
#	unlink $file;
#	unlink $newfile;
}


SKIP: {
#	skip &#34;AECreateAppleEvent&#34;, 42+15+47;

	## reveal file 4+1+15+20+2=42
	# 4
	my $target = AEDesc-&gt;new&#40;typeApplSignature, &#39;MACS&#39;&#41;;
	CheckRefType&#40;$target, typeApplSignature&#41;;
	# misc/mvis = reveal
	my $event = AECreateAppleEvent&#40;&#39;misc&#39;, &#39;mvis&#39;, $target&#41;;
	CheckRefType&#40;$event, typeAppleEvent&#41;;

	# 1
	{ open my $fh, &#39;&gt;&#39;, $file or die $!;
	  print $fh &#34;testing\n&#34;;
	}
	ok&#40;-e $file,							&#39;Check test file exists&#39;&#41;;

	# 15
	my $alias = NewAliasMinimalFromFullPath&#40;$file&#41;;
	is&#40;ref $alias, &#39;Handle&#39;,					&#39;Check Handle ref type&#39;&#41;;

	my $aliasdesc = AEDesc-&gt;new&#40;typeAlias, $alias&#41;;
	CheckRefType&#40;$aliasdesc, typeAlias&#41;;
	ok&#40;AEPutParamDesc&#40;$event, keyDirectObject, $aliasdesc&#41;,		&#39;AEPutParamDesc&#39;&#41;;
	CheckDispose&#40;$aliasdesc&#41;;

	my $reply = AESend&#40;$event, kAEWaitReply&#41;;
	CheckSuccess&#40;$event, $reply&#41;;
	my $filedesc = AEGetParamDesc&#40;$reply, keyDirectObject&#41;;
	CheckRefType&#40;$filedesc, typeObjectSpecifier&#41;;

	# 20
	CheckAttributes&#40;$event, $reply, qw&#40;misc mvis MACS&#41;&#41;;

	# 2
	CheckDispose&#40;$event&#41;;
	CheckDispose&#40;$reply&#41;;

	## change file name 2+2+11=15
	# 2
	$event = AECreateAppleEvent&#40;&#39;core&#39;, &#39;setd&#39;, $target&#41;;
	CheckRefType&#40;$event, typeAppleEvent&#41;;

	# 2
	my $filenamedesc = AECreateList&#40;&#39;&#39;, 1&#41;;
	CheckRefType&#40;$filenamedesc, typeAERecord&#41;;

	# 11
	ok&#40;AEPutKey    &#40;$filenamedesc, keyAEForm,         typeEnumerated, typeProperty&#41;, 	&#39;AEPutKey&#39;&#41;;
	ok&#40;AEPutKey    &#40;$filenamedesc, keyAEDesiredClass, typeType,       typeProperty&#41;, 	&#39;AEPutKey&#39;&#41;;
	ok&#40;AEPutKeyDesc&#40;$filenamedesc, keyAEContainer,    $filedesc&#41;, 				&#39;AEPutKeyDesc&#39;&#41;;
	ok&#40;AEPutKey    &#40;$filenamedesc, keyAEKeyData,      typeType,       &#39;pnam&#39;&#41;, 		&#39;AEPutKey&#39;&#41;; # name
	my $obj = AECoerceDesc&#40;$filenamedesc, typeObjectSpecifier&#41;;
	CheckRefType&#40;$obj, typeObjectSpecifier&#41;;
	CheckDispose&#40;$filenamedesc&#41;;

	ok&#40;AEPutParamDesc&#40;$event, keyDirectObject, $obj&#41;,		&#39;AEPutParamDesc&#39;&#41;;
	ok&#40;AEPutParam&#40;$event, &#39;data&#39;, typeChar, $newname&#41;, 		&#39;AEPutParam&#39;&#41;;

	CheckDispose&#40;$obj&#41;;

	CheckDispose&#40;$target&#41;;

	Finish&#40;$event&#41;;
}

SKIP: {
#	skip &#34;AEBuildAppleEvent&#34;, 37+5+47;

	## reveal file 2+1+12+20+2=37
	# 2
	# misc/mvis = reveal
	my $event = AEBuildAppleEvent&#40;&#39;misc&#39;, &#39;mvis&#39;, typeApplSignature, &#39;MACS&#39;, kAutoGenerateReturnID, kAnyTransactionID, &#39;&#39;&#41;;
	CheckRefType&#40;$event, typeAppleEvent&#41;;

	# 1
	{ open my $fh, &#39;&gt;&#39;, $file or die $!;
	  print $fh &#34;testing\n&#34;;
	}
	ok&#40;-e $file,							&#39;Check test file exists&#39;&#41;;

	# 12
	my $alias = NewAliasMinimalFromFullPath&#40;$file&#41;;
	is&#40;ref $alias, &#39;Handle&#39;,					&#39;Check Handle ref type&#39;&#41;;

	ok&#40;AEBuildParameters&#40;$event, q&#34;&#39;----&#39;:alis&#40;@@&#41;&#34;, $alias&#41;, 	&#39;AEBuildParameters&#39;&#41;;

	my $reply = AESend&#40;$event, kAEWaitReply&#41;;
	CheckSuccess&#40;$event, $reply&#41;;
	my $filedesc = AEGetParamDesc&#40;$reply, keyDirectObject&#41;;
	CheckRefType&#40;$filedesc, typeObjectSpecifier&#41;;

	# 20
	CheckAttributes&#40;$event, $reply, qw&#40;misc mvis MACS&#41;&#41;;

	# 2
	CheckDispose&#40;$event&#41;;
	CheckDispose&#40;$reply&#41;;

	## change file name 2+3=5
	# 2
	$event = AEBuildAppleEvent&#40;&#39;core&#39;, &#39;setd&#39;, typeApplSignature, &#39;MACS&#39;, kAutoGenerateReturnID, kAnyTransactionID, &#39;&#39;&#41;;
	CheckRefType&#40;$event, typeAppleEvent&#41;;

	# 3
	my $filedesc_print = AEPrint&#40;$filedesc&#41;;
	like&#40;$filedesc_print, qr/^&#39;obj &#39;/,				&#39;AEPrint&#39;&#41;;
	#diag&#40;$filedesc_print&#41;;

	# Apple bugs ... really, since the format of AEPrint can change,
	# this might be a bad way to do the tests, but I&#39;ll worry about it
	# when it breaks ... for now, I just need to get it done, and besides,
	# this helped me identify some bugs in AEPrint
	$filedesc_print =~ s/&#39;&#39;null&#39;&#39;/&#39;null&#39;/g;
	$filedesc_print =~ s/&#39;want&#39;:&#39;&#40;\w+&#41;&#39;/&#39;want&#39;:type&#40;$1&#41;/g;
	$filedesc_print =~ s/&#39;seld&#39;:&#39;sdsk&#39;/&#39;seld&#39;:type&#40;sdsk&#41;/g;

	#diag&#40;$filehex&#41;;
	while &#40;$filedesc_print =~ /\&#40;\$&#40;.+?&#41;\$\&#41;/g&#41; {
		my $x = my $y = $1;
		$x =~ s/[^A-F0-9]+//g;
		#diag&#40;$x&#41;;
		next unless $filehex =~ /^\Q$x\E/;
		#diag&#40;&#39;!!&#39;&#41;;
		if &#40;$x ne $y&#41; {
			$filedesc_print =~ s/&#39;utxt&#39;\&#40;\$$y\$\&#41;/&#39;TEXT&#39;&#40;\@&#41;/;
		}
	}
	#diag&#40;$filedesc_print&#41;;

	my $fmt = &#34;&#39;----&#39;:&#39;obj &#39;{ &#39;form&#39;:&#39;prop&#39;, &#39;want&#39;:type&#40;prop&#41;, &#39;from&#39;:$filedesc_print, &#39;seld&#39;:type&#40;pnam&#41; }&#34;;
	# $fmt = q&#34;&#39;----&#39;:&#39;obj &#39;{ &#39;form&#39;:prop, &#39;want&#39;:type&#40;prop&#41;, &#39;from&#39;:&#39;obj &#39;{ &#39;want&#39;:type&#40;docf&#41;, &#39;from&#39;:&#39;obj &#39;{ &#39;want&#39;:type&#40;cfol&#41;, &#39;from&#39;:&#39;obj &#39;{ &#39;want&#39;:type&#40;cobj&#41;, &#39;from&#39;:&#39;obj &#39;{ &#39;want&#39;:type&#40;prop&#41;, &#39;from&#39;:&#39;null&#39;&#40;&#41;, &#39;form&#39;:prop, &#39;seld&#39;:type&#40;sdsk&#41; }, &#39;form&#39;:name, &#39;seld&#39;:&#39;utxt&#39;&#40;$0070007200690076006100740065$&#41; }, &#39;form&#39;:name, &#39;seld&#39;:&#39;utxt&#39;&#40;$0074006D0070$&#41; }, &#39;form&#39;:name, &#39;seld&#39;:&#39;TEXT&#39;&#40;@&#41; }, &#39;seld&#39;:type&#40;pnam&#41; }&#34;;
	#diag&#40;$fmt&#41;;

	ok&#40;AEBuildParameters&#40;$event, $fmt, &#39;mac-carbon-aeevent-test&#39;&#41;,				&#39;AEBuildParameters&#39;&#41;;
	#diag&#40;$@&#41;;

	ok&#40;AEBuildParameters&#40;$event, &#39;data:TEXT&#40;@&#41;&#39;, $newname&#41;,		&#39;AEBuildParameters&#39;&#41;;
	#diag&#40;AEPrint&#40;$event&#41;&#41;;

	Finish&#40;$event&#41;;
}

SKIP: {
#	skip &#34;AEStream&#34;, 4+41+19+47;

	## Quick Abort check 4
	ok&#40;my $stream_abort = AEStream-&gt;new,				&#39;AEStream-&gt;new/Open&#39;&#41;;
	ok&#40;$stream_abort-&gt;OpenDesc&#40;typeInteger&#41;,			&#39;OpenDesc&#39;&#41;;
	ok&#40;$stream_abort-&gt;WriteData&#40;12334567890&#41;,			&#39;WriteData&#39;&#41;;
	is&#40;$stream_abort-&gt;Abort, 0,					&#39;Abort!&#39;&#41;;

	## reveal file 3+1+15+20+2=41
	# 3
	# misc/mvis = reveal
	# OpenEvent
	my $event1 = AEBuildAppleEvent&#40;&#39;misc&#39;, &#39;mvis&#39;, typeApplSignature, &#39;MACS&#39;, kAutoGenerateReturnID, kAnyTransactionID, &#39;&#39;&#41;;
	CheckRefType&#40;$event1, typeAppleEvent&#41;;
	ok&#40;my $stream = AEStream-&gt;new&#40;$event1&#41;,				&#39;AEStream-&gt;new/OpenEvent&#39;&#41;;

	# 1
	{ open my $fh, &#39;&gt;&#39;, $file or die $!;
	  print $fh &#34;testing\n&#34;;
	}
	ok&#40;-e $file,							&#39;Check test file exists&#39;&#41;;

	# 16
	my $alias = NewAliasMinimalFromFullPath&#40;$file&#41;;
	is&#40;ref $alias, &#39;Handle&#39;,					&#39;Check Handle ref type&#39;&#41;;

	ok&#40;$stream-&gt;WriteKey&#40;keyDirectObject&#41;,				&#39;WriteKey keyDirectObject&#39;&#41;;
	ok&#40;$stream-&gt;OpenDesc&#40;typeAlias&#41;, 				&#39;OpenDesc typeAlias&#39;&#41;;
	ok&#40;$stream-&gt;WriteData&#40;$alias-&gt;get&#41;, 				&#39;WriteData alias&#39;&#41;;
	ok&#40;$stream-&gt;CloseDesc,						&#39;CloseDesc&#39;&#41;;

	my $event = $stream-&gt;Close;
	CheckRefType&#40;$event, typeAppleEvent&#41;;

	my $reply = AESend&#40;$event, kAEWaitReply&#41;;
	CheckSuccess&#40;$event, $reply&#41;;
	my $filedesc = AEGetParamDesc&#40;$reply, keyDirectObject&#41;;
	CheckRefType&#40;$filedesc, typeObjectSpecifier&#41;;

	# 20
	CheckAttributes&#40;$event, $reply, qw&#40;misc mvis MACS&#41;&#41;;

	# 2
	CheckDispose&#40;$event&#41;;
	CheckDispose&#40;$reply&#41;;

	## change file name 19
	# CreateEvent
	ok&#40;$stream = AEStream-&gt;new&#40;&#39;core&#39;, &#39;setd&#39;, typeApplSignature, &#39;MACS&#39;&#41;,		&#39;AEStream-&gt;new/CreateEvent&#39;&#41;;

	ok&#40;$stream-&gt;WriteKey&#40;keyDirectObject&#41;,						&#39;WriteKey direct object&#39;&#41;;
	ok&#40;$stream-&gt;OpenRecord&#40;typeLogicalDescriptor&#41;,					&#39;OpenRecord logical typeLogicalDescriptor&#39;&#41;;
	ok&#40;$stream-&gt;WriteKeyDesc&#40;keyAEForm,         typeEnumerated, typeProperty&#41;,	&#39;WriteKeyDesc form prop&#39;&#41;;
	ok&#40;$stream-&gt;WriteKeyDesc&#40;keyAEDesiredClass, typeType,       typeProperty&#41;,	&#39;WriteKeyDesc want prop&#39;&#41;;
	ok&#40;$stream-&gt;WriteKey&#40;keyAEContainer&#41;,						&#39;WriteKeyDesc from&#39;&#41;;
	ok&#40;$stream-&gt;WriteAEDesc&#40;$filedesc&#41;,						&#39;WriteAEDesc from&#39;&#41;;
	ok&#40;$stream-&gt;WriteKeyDesc&#40;keyAEKeyData,      typeType,       &#39;pnam&#39;&#41;,		&#39;WriteKeyDesc seld pnam&#39;&#41;;
	ok&#40;$stream-&gt;SetRecordType&#40;typeObjectSpecifier&#41;,					&#39;SetRecordType keyDirectObject&#39;&#41;;
	ok&#40;$stream-&gt;CloseRecord,							&#39;CloseRecord&#39;&#41;;

	ok&#40;$stream-&gt;OpenKeyDesc&#40;&#39;data&#39;, typeChar&#41;,					&#39;OpenKeyDesc data typeChar&#39;&#41;;
	ok&#40;$stream-&gt;WriteData&#40;$newname&#41;,						&#39;WriteData name&#39;&#41;;
	ok&#40;$stream-&gt;CloseDesc, 								&#39;CloseDesc&#39;&#41;;

	ok&#40;$stream-&gt;WriteKeyDesc&#40;&#39;doof&#39;, typeChar, &#39;floobydoo!&#39;&#41;,			&#39;WriteKeyDesc for optional&#39;&#41;;
	ok&#40;$stream-&gt;OptionalParam&#40;&#39;doof&#39;&#41;,						&#39;OptionalParam&#39;&#41;;

	$event = $stream-&gt;Close;

	CheckRefType&#40;$event, typeAppleEvent&#41;;

	Finish&#40;$event&#41;;
}

# 6+11+28+2=47
sub Finish {
	my&#40;$event&#41; = @_;
	# 6
	ok&#40;AEPutAttribute&#40;$event, keyOptionalKeywordAttr, typeInteger, MacPack&#40;typeInteger, 1&#41;&#41;, 	&#39;AEPutAttribute&#39;&#41;;

	my $vers = &#39;version .129381231&#39;;
	my $miss = AEDesc-&gt;new&#40;typeChar, $vers&#41;;
	ok&#40;AEPutAttributeDesc&#40;$event, keyAEVersion, $miss&#41;,						&#39;AEPutAttributeDesc&#39;&#41;;
	CheckDesc&#40;$miss, typeChar, $vers&#41;;

	# 11
	my $reply = AESend&#40;$event, kAEWaitReply&#41;;
	CheckSuccess&#40;$event, $reply&#41;;

	is&#40;AECountItems&#40;$reply&#41;, 1,					&#39;Count reply&#39;&#41;;
	ok&#40;AEDeleteParam&#40;$reply, keyDirectObject&#41;,			&#39;Delete reply&#39;&#41;;
	cmp_ok&#40;AECountItems&#40;$reply&#41;, &#39;==&#39;, 0,				&#39;Count reply&#39;&#41;;

	# 28
	CheckAttributes&#40;$event, $reply, qw&#40;core setd MACS&#41;&#41;;
	CheckAttribute&#40;$event, keyOptionalKeywordAttr, typeInteger, 1&#41;;
	CheckAttribute&#40;$event, keyAEVersion, typeChar, $vers&#41;;

	# 2
	CheckDispose&#40;$event&#41;;
	CheckDispose&#40;$reply&#41;;

	unlink $file;
	unlink $newfile;
}

# 8
sub CheckSuccess {
	my&#40;$event, $reply&#41; = @_;

	CheckRefType&#40;$event, typeAppleEvent&#41;;
	CheckRefType&#40;$reply, typeAppleEvent&#41;;

	my $errn = AEGetParamDesc&#40;$reply, keyErrorNumber&#41;;
	cmp_ok&#40;$!, &#39;==&#39;, -1701,						&#39;No error&#39;&#41;;

	my $errs = AEGetParamDesc&#40;$reply, keyErrorString&#41;;
	cmp_ok&#40;$!, &#39;==&#39;, -1701,						&#39;No error&#39;&#41;;

	for my $err &#40;$errn, $errs&#41; {
		if &#40;$err&#41; {
			is&#40;$err-&gt;get, 0, &#39;Error?&#39;&#41;;
		} else {
			pass&#40;&#39;Still no error&#39;&#41;;
		}
	}

	#diag&#40;AEPrint&#40;$event&#41;&#41;;
	#diag&#40;AEPrint&#40;$reply&#41;&#41;;
}

# 4
sub CheckAttribute {
	my&#40;$event, $key, $type, $val&#41; = @_;

	my $desc = AEGetAttributeDesc&#40;$event, $key, $type&#41;;
	CheckDesc&#40;$desc, $type, $val&#41;;
}

# 20
sub CheckAttributes {
	my&#40;$event, $reply, @vals&#41; = @_;

	CheckAttribute&#40;$event, keyEventClassAttr, typeType,          $vals[0]&#41;;
	CheckAttribute&#40;$event, keyEventIDAttr,    typeChar,          $vals[1]&#41;; # for fun
	CheckAttribute&#40;$event, keyAddressAttr,    typeApplSignature, $vals[2]&#41;;
	CheckAttribute&#40;$reply, keyEventClassAttr, typeChar,          &#39;aevt&#39;&#41;;
	CheckAttribute&#40;$reply, keyEventIDAttr,    typeType,          &#39;ansr&#39;&#41;;
}

sub MakeHexUTF16 {
	use Config;
	my $fmt = $Config{byteorder} == 4321 ? &#39;00%02X&#39; : &#39;%02X00&#39;;
	join&#40;&#39;&#39;, map { sprintf&#40;$fmt, ord&#41; } split //, $_[0]&#41;;
}

__END__
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;21&nbsp;12:46:23&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;07&nbsp;02:03:27&nbsp;2006</span>
    <span class="description">cnandor [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;07&nbsp;02:03:29&nbsp;2006</span>
    <span class="description">cnandor [...] cpan.org -  Fixed in 0.76 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
