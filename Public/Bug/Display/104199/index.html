<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #104199 for ODF-lpOD: fixed-formula header rows don&#39;t refresh in ODS spreadsheet opening</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #104199 for ODF-lpOD: fixed-formula header rows don&#39;t refresh in ODS spreadsheet opening</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/ODF-lpOD/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/ODF-lpOD/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/ODF-lpOD/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/ODF-lpOD/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/ODF-lpOD">ODF-lpOD CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">104199</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/ODF-lpOD/Active/">ODF-lpOD</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
idallen [...] idallen.ca

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-233578-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.126    </td>
  </tr>
  <tr id="CF-233579-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




bugwriter.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1493208/795256/bugwriter.pl">
Sun May 03 23:23:02 2015 (3.8k) by https://launchpad.net/~idallen
</a>
</font></li>
</ul>


bugwriter.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1493208/795257/bugwriter.png">
Sun May 03 23:23:02 2015 (31.7k) by https://launchpad.net/~idallen
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;03&nbsp;23:23:02&nbsp;2015</span>
    <span class="description">https://launchpad.net/~idallen -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> fixed-formula header rows don&#39;t refresh in ODS spreadsheet opening</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">See attached image and attached Perl script that creates test.ods that,
when opened, displays the bug shown in the image.

The attached Perl script does this:

- Use ODF::lpOD to create a new small spreadsheet, 5x10.
- Allocate the first two rows as header rows.
- Write identical formulae into both header cells and body cells.
- Create the output file &#34;test.ods&#34;.

Now open the &#34;test.ods&#34; file in LibreOffice and see the problem.

Header cells that don&#39;t contain a formula with a dynamic function don&#39;t
refresh on document open and remain blank.  Work around: Adding a useless
dynamic function expression such as 0*RAND&#40;&#41; to the formulae cause the
cells to refresh properly on document open.

Body &#40;non-header&#41; cells always refresh correctly on document open.

This might be a LibreOffice problem, not an ODF::lpOD problem, since older
versions of LibreOffice &#40;e.g. LibreOffice 3.5.7.2 Build ID: 350m1&#40;Build:2&#41;
under Ubuntu 12.04&#41; do correctly refresh all the header cells on document
open; none of the cells are blank.  In any case it would be nice if
ODF::lpOD had a work-around even if it is a LibreOffice problem.

Ubuntu Linux System info:
=========================

Package: JMGDOC/ODF-lpOD-1.126.tar.gz

$ uname -a
Linux linux 3.19.0-15-generic #15-Ubuntu SMP Thu Apr 16 23:32:37 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux

$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 15.04
Release:        15.04
Codename:       vivid

$ perl -v
This is perl 5, version 20, subversion 2 &#40;v5.20.2&#41; built for x86_64-linux-gnu-thread-multi &#40;with 39 registered patches, see perl -V for more detail&#41;

LibreOffice Version Version: 4.4.2.2
Build ID: 40m0&#40;Build:2&#41;
Locale: en_CA
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> bugwriter.pl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w
# Bug in ODF::lpOD or ODF - failure to refresh header row cells containing
# fixed formula on document open.
# Work-around is to add &#34;0*RAND&#40;&#41;&#34; to every header cell formula, to
# make it appear dynamic and need refreshing on document open.
# -Ian! D. Allen - idallen@idallen.ca - www.idallen.com

use strict;
use ODF::lpOD;

# Name of default first sheet in spreadsheet.
# Name of output ODS file generated by this file.
#
my $SHEET1 = &#39;Sheet1&#39;;
my $OUTPUT = &#39;test.ods&#39;;

my $doc = odf_new_document&#40;&#39;spreadsheet&#39;&#41;
    or die &#34;$0: Failed to create new spreadsheet\n   &#34;;

my $content = $doc-&gt;get_body
    or die &#34;$0: cannot get body content\n  &#34;;
my $sheet = $content-&gt;get_table&#40;$SHEET1&#41;
    or die &#34;$0: cannot find &#39;$SHEET1&#39;\n  &#34;;

# Create 5x10 small spreadsheet.
#
$sheet-&gt;add_column&#40;&#39;number&#39;=&gt;10&#41;;
$sheet-&gt;add_row&#40;&#39;number&#39;=&gt;5&#41;;

# Create a two-row header.
#
my $header;
until &#40; $header = $sheet-&gt;get_column_header &#41; {
    warn &#34;$0: Creating header lines\n&#34;;
    $sheet-&gt;set_column_header&#40;2&#41;;  # doesn&#39;t work for 1
}

# Put some numbers and formulae into the header rows.
# Some of these cells do not refresh when the document is opened.
# Cells that have a fixed formula aren&#39;t refreshing on document open.
# The formula without RAND&#40;&#41; don&#39;t work in the header rows - the cells
# are blank when you open the document. Work around: Adding a useless
# RAND&#40;&#41; call makes the cells refresh when opening the document.
#
# &#40;Also, if you interactively modify any formula, even by adding a blank
# and deleting it, or if you modify any cell in the SUM, the blank
# problem is cleared for that header cell, perhaps because the
# modification forces a refresh of the formula.&#41;
#
my $r = $header-&gt;get_row&#40;0&#41; or die;
&#38;FillRow&#40;$r,0&#41;;
$r = $header-&gt;get_row&#40;1&#41; or die;
&#38;FillRow&#40;$r,0&#41;;

# Put some numbers and formulae into the body rows.
# The formula work fine in these body row - the cells show the right
# values when you open the document, as expected.
#
$r = $sheet-&gt;get_row&#40;0&#41; or die;
&#38;FillRow&#40;$r,2&#41;;
$r = $sheet-&gt;get_row&#40;1&#41; or die;
&#38;FillRow&#40;$r,2&#41;;

sub FillRow {
    my &#40;$r,$offset&#41; = @_;
    my $c;
    my $f;

    $r-&gt;clear&#40;&#41;;
    my &#40;$table,$row&#41; = $r-&gt;get_position;
    $row += $offset;

    my @list = &#40;&#41;;
    my $ix = 5;
    for &#40; my $i = 1; $i &lt;= $ix; $i++ &#41; {
	my $c = $r-&gt;get_cell&#40;$i-1&#41;;
	$c-&gt;set_type&#40;&#39;float&#39;&#41;;
	$c-&gt;set_style&#40;&#39;Default&#39;&#41;;
	$c-&gt;set_value&#40;$i&#41;;
	push&#40;@list,&#38;NA&#40;$row,$i-1&#41;&#41;;
    }

    ++$ix;
    $c = $r-&gt;get_cell&#40;$ix-1&#41;;
    $c-&gt;set_style&#40;&#39;Default&#39;&#41;;
    $f = &#39;of:=SUM&#40;&#39; . join&#40;&#39;;&#39;,@list&#41; . &#39;;0*RAND&#40;&#41;&#41;&#39;;
    $c-&gt;set_formula&#40;$f&#41;;
    $c-&gt;set_annotation&#40;&#39;text&#39;=&gt;&#39;Useless call to RAND&#40;&#41;&#39;&#41;;

    ++$ix;
    $c = $r-&gt;get_cell&#40;$ix-1&#41;;
    $c-&gt;set_style&#40;&#39;Default&#39;&#41;;
    $c-&gt;set_formula&#40;&#39;of:=1+2+3+4+0*RAND&#40;&#41;&#39;&#41;;
    $c-&gt;set_annotation&#40;&#39;text&#39;=&gt;&#39;Useless call to RAND&#40;&#41;&#39;&#41;;

    ++$ix;
    $c = $r-&gt;get_cell&#40;$ix-1&#41;;
    $c-&gt;set_style&#40;&#39;Default&#39;&#41;;
    $f = &#39;of:=SUM&#40;&#39; . join&#40;&#39;;&#39;,@list&#41; . &#39;;0*0&#41;&#39;;
    $c-&gt;set_formula&#40;$f&#41;;

    ++$ix;
    $c = $r-&gt;get_cell&#40;$ix-1&#41;;
    $c-&gt;set_style&#40;&#39;Default&#39;&#41;;
    $c-&gt;set_formula&#40;&#39;of:=1+2+3+4+0*0&#39;&#41;;
}

$doc-&gt;save&#40;&#39;target&#39;=&gt;$OUTPUT &#41;;
print &#34;Wrote $OUTPUT\n&#34;;

exit;

############################################################################

# convert numeric zero-offset column into alpha letter, e.g. 0-&gt;&#34;A&#34;, 26-&gt;&#34;AA&#34;
sub AR {
    my $n = $_[0];
    die caller&#40;2&#41; unless defined&#40;$n&#41;;
    my $str = &#39;&#39;;
    while&#40;&#41;{
	my $r = $n % 26;
	$str = chr&#40;ord&#40;&#39;A&#39;&#41;+$r&#41; . $str;
	$n = int&#40;$n / 26&#41;;
	last unless $n;
	--$n;
    }
    return $str;
}
# convert zero-offset &#40;row,col&#41; into alpha, e.g. &#38;NA&#40;9,3&#41;-&gt;&#34;D10&#34;
# if either field starts with a $, use absolute positioning
sub NA {
    my &#40;$r,$c&#41; = @_;
    my @c;
    die @c = caller&#40;&#41;, &#34;NA @c&#34; unless defined&#40;$r&#41;;
    die @c = caller&#40;&#41;, &#34;NA @c&#34; unless defined&#40;$c&#41;;
    if &#40; $r =~ s/^\$// &#41; {
	$r = &#39;$&#39; . &#40;$r+1&#41;;
    } else {
	$r = $r+1;
    }
    if &#40; $c =~ s/^\$// &#41; {
	$c = &#39;$&#39; . &#38;AR&#40;$c&#41;;
    } else {
	$c = &#38;AR&#40;$c&#41;;
    }
    return &#34;$c$r&#34;;
}
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> bugwriter.png</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1493208/795257/bugwriter.png">Download bugwriter.png</a><br />
<span class="downloadcontenttype">image/png 31.7k</span>
</div>
<div class="messagebody">
<img alt="bugwriter.png" title="bugwriter.png" src="/Ticket/Attachment/1493208/795257/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;09&nbsp;15:15:20&nbsp;2016</span>
    <span class="description">https://launchpad.net/~idallen -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ian Allen &lt;idallen [...] idallen.ca&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here is an update on this problem:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Header cells that don&#39;t contain a formula with a dynamic function
&gt; don&#39;t refresh on document open and remain blank.
</div>
Here is where the problem lies in the generated ODS file:

If I go into the generated content.xml file and rename or delete the
attribute table:style-name=&#34;Default&#34; from the cells that do not refresh,
the problem goes away.  For example, change this non-working &#40;blank&#41; cell:

 &lt;table:table-cell table:formula=&#34;of:=1+2+3+4+0*0&#34; table:style-name=&#34;Default&#34;/&gt;

to this content and it works fine &#40;does not open as a blank cell&#41;:

 &lt;table:table-cell table:formula=&#34;of:=1+2+3+4+0*0&#34; table:xstyle-name=&#34;Default&#34;/&gt;

I note that saving the spreadsheet and re-opening it under LibreOffice
5.1.3.2 &#40;Build ID: 1:5.1.3-0ubuntu1&#41; also clears this attribute from
the cells and also fixes the problem.

Perhaps lpOD should not be generating this attribute on cells?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;09&nbsp;15:15:21&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;10&nbsp;03:59:26&nbsp;2016</span>
    <span class="description">https://launchpad.net/~idallen -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ian Allen &lt;idallen [...] idallen.ca&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here is an update on this problem:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Header cells that don&#39;t contain a formula with a dynamic function
&gt; don&#39;t refresh on document open and remain blank.
</div>
I should read my own code.  The sample code I submitted uses
set_style&#40;&#39;Default&#39;&#41; on each cell, and it is this style setting that
is preventing the header cells from being refreshed on document open
&#40;unless the cells contain RAND&#41;.  If you remove the set_style, all the
header cells refresh correctly on document open.

You can also see the problem another way if you add set_value&#40;99&#41; in
each cell.  On document open, the header cells with a set_style and a
fixed formula &#40;no use of RAND&#41; will incorrectly show &#34;99&#34; while all the
other cells will be calculated and show the correct value of the formula.
Remove the set_style, and all the header cells are correct on document
open.

Why does setting a style on a header cell prevent it from showing the
correct formula value on document open?
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
