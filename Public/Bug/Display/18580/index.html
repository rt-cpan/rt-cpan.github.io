<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #18580 for Net-DNS: rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #18580 for Net-DNS: rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Net-DNS">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Net-DNS">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Net-DNS">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Net-DNS">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">18580</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Net-DNS">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
estair [...] ilm.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.57    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




check_dns_host.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/184049/65006/check_dns_host.pl">
Thu Apr 06 22:04:22 2006 (5.6k) by Guest
</a>
</font></li>
</ul>


PGP.sig<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/184537/65317/PGP.sig">
Sat Apr 08 15:35:12 2006 (227b) by olaf [...] dacht.net
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/184435/65241/PGP.sig">
Sat Apr 08 04:31:50 2006 (227b) by olaf [...] dacht.net
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/184069/65028/PGP.sig">
Fri Apr 07 03:16:39 2006 (227b) by olaf [...] dacht.net
</a>
</font></li>
</ul>


winmail.dat<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/184535/65313/winmail.dat">
Sat Apr 08 14:28:18 2006 (4k) by estair [...] ilm.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=18580">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184049" href="/Public/Bug/Display.html?id=18580#txn-184049">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;06&nbsp;22:04:22&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/184049/65003/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/65003">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
v5.8.8 built for x86_64-linux-thread-multi
perl-Net-DNS-0.57-1 
x86-64 both on Fedora5 and RHEL4.2


Net::DNS does not appear to set the value of -&gt;{header}-&gt;{rcode} &#40;or
incidentally -&gt;{header}-&gt;{ancount}&#41; unless the query is successful. 
Inline is the output of this script with the resolver set to debug
output.  You can compare the obviously set rcode values in the header vs
the undefined/empty values in the output.  Attached is a script I&#39;ve
just written with this you can use to verify.

Cheers,

/eli


######### successful query: ############

[estair@adroit bin]$ clear ; ./check_dns_host.pl -q FORWARD -H
google.com  -w 100 -c 200 -r 3

;; search&#40;google.com, A, IN&#41;
;; query&#40;google.com, A, IN&#41;
;; setting up an AF_INET&#40;&#41; family type UDP socket
;; send_udp&#40;10.65.1.108:53&#41;
;; answer from 10.65.1.108:53 : 76 bytes
;; HEADER SECTION
;; id = 15376
;; qr = 1    opcode = QUERY    aa = 0    tc = 0    rd = 0
;; ra = 1    ad = 0    cd = 0    rcode  = NOERROR
;; qdcount = 1  ancount = 3  nscount = 0  arcount = 0

;; QUESTION SECTION &#40;1 record&#41;
;; google.com.  IN      A

;; ANSWER SECTION &#40;3 records&#41;
google.com.     118     IN      A       64.233.187.99
google.com.     118     IN      A       64.233.167.99
google.com.     118     IN      A       72.14.207.99

;; AUTHORITY SECTION &#40;0 records&#41;

;; ADDITIONAL SECTION &#40;0 records&#41;
$query_returncode: NOERROR
$query-&gt;{header}-&gt;{ancount}: 3
$query-&gt;{header}-&gt;{rcode}: NOERROR
$query_returncode: NOERROR
DNS OK: ANSWERS=&#40;3&#41; QUERY_RETURNVAL=&#40;64.233.187.99 64.233.167.99
72.14.207.99&#41; ELAPSED=&#40;5 ms&#41; | DurationMS=5


######### failed query: ############

[estair@adroit bin]$ clear ; ./check_dns_host.pl -q FORWARD -H
blah.google.com  -w 100 -c 200 -r 3

;; search&#40;blah.google.com, A, IN&#41;
;; query&#40;blah.google.com, A, IN&#41;
;; setting up an AF_INET&#40;&#41; family type UDP socket
;; send_udp&#40;10.65.1.108:53&#41;
;; answer from 10.65.1.108:53 : 179 bytes
;; HEADER SECTION
;; id = 4216
;; qr = 1    opcode = QUERY    aa = 0    tc = 0    rd = 0
;; ra = 1    ad = 0    cd = 0    rcode  = NOERROR
;; qdcount = 1  ancount = 0  nscount = 4  arcount = 4

;; QUESTION SECTION &#40;1 record&#41;
;; blah.google.com.     IN      A

;; ANSWER SECTION &#40;0 records&#41;

;; AUTHORITY SECTION &#40;4 records&#41;
google.com.     85856   IN      NS      ns3.google.com.
google.com.     85856   IN      NS      ns4.google.com.
google.com.     85856   IN      NS      ns1.google.com.
google.com.     85856   IN      NS      ns2.google.com.

;; ADDITIONAL SECTION &#40;4 records&#41;
ns3.google.com. 85856   IN      A       216.239.36.10
ns4.google.com. 85856   IN      A       216.239.38.10
ns1.google.com. 85856   IN      A       216.239.32.10
ns2.google.com. 85856   IN      A       216.239.34.10
;; search&#40;blah.google.com.lucasfilm.com, A, IN&#41;
;; query&#40;blah.google.com.lucasfilm.com, A, IN&#41;
;; setting up an AF_INET&#40;&#41; family type UDP socket
;; send_udp&#40;10.65.1.108:53&#41;
;; answer from 10.65.1.108:53 : 132 bytes
;; HEADER SECTION
;; id = 4217
;; qr = 1    opcode = QUERY    aa = 1    tc = 0    rd = 0
;; ra = 1    ad = 0    cd = 0    rcode  = NXDOMAIN
;; qdcount = 1  ancount = 0  nscount = 1  arcount = 0

;; QUESTION SECTION &#40;1 record&#41;
;; blah.google.com.lucasfilm.com.       IN      A

;; ANSWER SECTION &#40;0 records&#41;

;; AUTHORITY SECTION &#40;1 record&#41;
lucasfilm.com.  3600    IN      SOA     lucas-dc2.lucas.alllucas.com.
hostmaster.lucas.alllucas.com. &#40;
                                        2001401971      ; Serial
                                        900     ; Refresh
                                        600     ; Retry
                                        86400   ; Expire
                                        3600 &#41;  ; Minimum TTL

;; ADDITIONAL SECTION &#40;0 records&#41;
$query_returncode:
$query-&gt;{header}-&gt;{ancount}:
$query-&gt;{header}-&gt;{rcode}:
$query_returncode:
DNS : ANSWERS=&#40;&#41; QUERY_RETURNVAL=&#40;&#41; ELAPSED=&#40;9 ms&#41; | DurationMS=9
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> check_dns_host.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/184049/65006/check_dns_host.pl">Download check_dns_host.pl</a><br />
<span class="downloadcontenttype">text/x-perl 5.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl

#FILE: check_dns.pl
#SYNOPSIS: check A/PTR records for a host. Added support for checking matching returnval vs. a string, and #of responses.

#use strict;
#use warnings;
use Net::DNS;
use Getopt::Long;
use Pod::Usage;
use Time::HiRes qw&#40; usleep ualarm gettimeofday tv_interval &#41;;


### Define ARGV options:
my &#40;$host,$match,$server,$timeout,$wlevel,$clevel,$retvalnum,$query_type&#41;;

GetOptions&#40;
	&#34;H=s&#34; =&gt; \$host,
	&#34;m=s&#34; =&gt; \$match,
	&#34;s=s&#34; =&gt; \$server,
	&#34;q=s&#34; =&gt; \$query_type,
	&#34;t=i&#34; =&gt; \$timeout,
	&#34;r=i&#34; =&gt; \$retvalnum,
	&#34;w=i&#34; =&gt; \$wlevel,
	&#34;c=i&#34; =&gt; \$clevel
&#41;;

if&#40;!$timeout&#41;{$timeout=10};
alarm&#40;$timeout&#41;;
$SIG{ALRM} = sub {print &#34;$0 timed out.\n&#34;; exit 2;};

if&#40;!$host || !$wlevel || !$clevel&#41;{
	pod2usage&#40;&#34;$0: fixme&#34;&#41;;
	exit 3;
}

if&#40;$wlevel&gt;=$clevel&#41;{
	pod2usage&#40;&#34;$0: fixme&#34;&#41;;
	exit 3;  # Nagios: unknown
}


######################################################################################
### START code:
######################################################################################

### define program vars:
my &#40;$header,$exitstate,@retval,$checkfailed&#41;;

# Initialize the DNS Resolver package and start timer:
my $res = Net::DNS::Resolver-&gt;new&#40;
  recurse     =&gt; 0,
  debug       =&gt; 1,
&#41;;

my &#40;$t0, $t1&#41;;
$t0 = [gettimeofday];

### define program flow:

&#38;query_run;
&#38;query_lint;
&#38;query_compile;
&#38;eval;


######################################################################################
### Execute defined query:

# Perform the lookup, and set status values:
sub query_run {
  $query = $res-&gt;search&#40;&#34;$host&#34;&#41;;
  # Calculate time elapsed for lookup:
  $t1 = [gettimeofday];
  $elapsed = int &#40;1000 * tv_interval &#40; $t0, $t1&#41;&#41;;
  $query_returncode = &#40;$query-&gt;{header}-&gt;{rcode}&#41;;
  $query_count = &#40;$query-&gt;{header}-&gt;{ancount}&#41;;
} #/sub query_run

sub query_compile {
# Populate comparison array based on query type:

  if &#40;$query_type eq &#34;FORWARD&#34;&#41; { # A queries:
      foreach my $rr &#40;$query-&gt;answer&#41; {
        next unless $rr-&gt;type eq &#34;A&#34;;
        my $ip =  $rr-&gt;address;
            push &#40;@retval, $ip&#41;;
      }
    } #/if &#40;$query_type eq &#34;FORWARD&#34;&#41;

  if &#40;$query_type eq &#34;REVERSE&#34;&#41; { # PTR queries:
    foreach my $rr &#40;$query-&gt;answer&#41; {
      next unless $rr-&gt;type eq &#34;PTR&#34;;
      my $hostname =  $rr-&gt;ptrdname;
      push &#40;@retval, $hostname&#41;;
    }
  } #/if &#40;$query_type eq &#34;REVERSE&#34;&#41;
} #/sub query_compile

sub query_lint {
print &#34;\$query_returncode: $query_returncode \n&#34;;
  unless &#40;$query_returncode&#41; {
  print &#34;\$query-&gt;{header}-&gt;{ancount}: $query-&gt;{header}-&gt;{ancount} \n&#34;;
  print &#34;\$query-&gt;{header}-&gt;{rcode}: $query-&gt;{header}-&gt;{rcode} \n&#34;;
    $querycheck = &#34;FAILED&#34;;
    &#38;exit;
  }
  print &#34;\$query-&gt;{header}-&gt;{ancount}: $query-&gt;{header}-&gt;{ancount} \n&#34;;
  print &#34;\$query-&gt;{header}-&gt;{rcode}: $query-&gt;{header}-&gt;{rcode} \n&#34;;
}

######################################################################################
### FUNCTION: eval
### Check for failure conditions:
sub eval {

# Query failed:
if &#40;$query_returncode ne &#34;NOERROR&#34;&#41; {
  $exitstate = &#34;CRITICAL&#34;;
  &#38;exit;
}

# warn timeout threshhold exceeded:
if &#40;$elapsed &gt; $wlevel&#41; {
  $exitstate = &#34;WARNING&#34;;
  &#38;exit;
}

# crit timeout threshhold exceeded:
if &#40;$elapsed &gt; $clevel&#41; {
  $exitstate = &#34;CRITICAL&#34;;
  &#38;exit;
}

# num query returns out of specified bounds:
if &#40;$retvalnum&#41; {
  &#40;$retvalnum != $query_count&#41; &#38;&#38; &#40;$exitstate = &#34;CRITICAL&#34;&#41;;
  if &#40;$exitstate&#41; {
    $checkfailed = qq{&#34;RETVAL:$retvalnum&#34; != &#34;QUERYCOUNT:$query_count&#34;};
    &#38;exit;
  }
} 

# query return does not match specified string:
if &#40;$match&#41; {
  foreach my $value &#40;@retval&#41; {
  &#40;$match eq $value&#41; || &#40;$exitstate = &#34;CRITICAL&#34;&#41;;
  }
  if &#40;$exitstate&#41; {
    $checkfailed = qq{&#34;MATCH:$match&#34; != &#34;RETVAL:@retval&#34;};
    &#38;exit;
  }
}

# Yay! all seems OK...
$query_returncode eq &#34;NOERROR&#34; &#38;&#38; &#40;$exitstate = &#34;OK&#34;&#41;;
&#38;exit;
}

######################################################################################
### FUNCTION: exit
sub exit {

print &#34;\$query_returncode: $query_returncode \n&#34;;

# Query failures:
if &#40;$queryfailed&#41; {
  die &#34;QUERY FAILED&#34;;
}

# check failures:
if &#40;$checkfailed&#41; {
  print &#34;EXITING ERROR \n&#34;;
  $output = &#34;DNS $exitstate=&#40;$checkfailed&#41; QUERYRETURNCODE=&#40;$query_returncode&#41; ANSWERS=&#40;$query_count&#41; QUERY_RETURNVAL=&#40;@retval&#41; ELAPSED=&#40;${elapsed} ms&#41; | DurationMS=$elapsed&#34;;
} else {
#  print &#34;EXITING NOERROR \n&#34;;
  $output = &#34;DNS $exitstate: ANSWERS=&#40;$query_count&#41; QUERY_RETURNVAL=&#40;@retval&#41; ELAPSED=&#40;${elapsed} ms&#41; | DurationMS=$elapsed&#34;;
  $checkfailed = &#34;&#34;;
}

print &#34;$output \n&#34;;

exit 2 if&#40;!$query_returncode&#41;;            # Nagios: Critical
exit 2 if&#40;$elapsed&gt;$clevel&#41;;   # Nagios: Critical
exit 2 if&#40;$query_count != $retvalnum&#41;;   # Nagios: Critical
exit 2 if&#40;!$checkfailed eq &#34;&#34;&#41;;   # Nagios: Critical
exit 1 if&#40;$elapsed&gt;$wlevel&#41;;   # Nagios: Warning
exit 0;                        # Nagios: OK
}

### perldoc:

=head1 NAME

check_dns.pl - DNS-Query and Statistics

=head1 SYNOPSIS

        check_dns.pl -H host -s server -w wlevel -c clevel [-t timeout]

        host:    The host to be resolved
        server:  The DNS-server to ask
        timeout: Timeout in seconds
        wlevel:  Warning treshhold &#40;milliseconds&#41;
        clevel:  Critical treshhold &#40;milliseconds&#41;

=head1 DESCRIPTION

This asks a server to resolve a host. It returns OK if the process was
successfull and took less than wlevel milliseconds.

It returns a warning if it took less than clevel milliseconds.

Everything else returns critical. &#40;Also, if it takes longer than timeout.&#41;

=head1 PROBLEMS

This contains a hardcoded perl lib directory. Might wanna change this if
running on a machine with only one perl distribution.

Not too reliable timing functions, I suppose.

=head1 AUTHOR

Copyright &#40;c&#41; 2003 Hannes Schulz &lt;mail@hannes-schulz.de&gt;

=cut
#&lt;/perldoc&gt;

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184069" href="/Public/Bug/Display.html?id=18580#txn-184069">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;07&nbsp;03:16:38&nbsp;2006</span>
    <span class="description">olaf [...] dacht.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #18580] rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 7 Apr 2006 09:16:05 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Olaf M. Kolkman&#34; &lt;olaf [...] dacht.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/184069/65027/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/65027">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 771b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
The example you provided does not seem to have a bug.

Both returned packets in the failed query example are protocol  
compliant &#40;rfc1034 and rfc1035&#41;.

The first question &#40;blah.google.com, A&#41; returns a referral message.  
That is not what I would expect from a correctly functioning  
recursive nameserver. But I am not quite sure what kind of server is  
at 10.65.1.108.

The second question &#40;blah.google.com.lucasfilm.com., A&#41; just  
correctly answers that there is no such domain by setting an  
rcode=NXDOMAIN. Note that you use the search function which will try  
to append the default domain &#40;lucasfilm.com in your case&#41; to the name  
if a direct match failed.

--Olaf


------------------------------------------------------
Ik dacht net... heel even maar.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/184069/65028/PGP.sig">Download PGP.sig</a><br />
<span class="downloadcontenttype">application/pgp-signature 227b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184070" href="/Public/Bug/Display.html?id=18580#txn-184070">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;07&nbsp;03:16:40&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184258" href="/Public/Bug/Display.html?id=18580#txn-184258">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;07&nbsp;16:45:26&nbsp;2006</span>
    <span class="description">estair [...] ilm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #18580] rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 07 Apr 2006 13:45:03 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eli Stair &lt;estair [...] ilm.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/184258/65138/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/65138">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
My point was that the array &#34;$query-&gt;{header}-&gt;{rcode}&#34; is not being set
to NXDOMAIN when the rcode on the actual query return IS set to
&#34;NXDOMAIN&#34;... the only value I&#39;ve been able to get rcode set with on a
return is &#34;NOERROR&#34;... I know the return was false, that was the point,
in a failed NXDOMAIN query the &#39;rcode&#39; and &#39;ancount&#39; do not get defined.

As the query return header shows:


  ;; HEADER SECTION
  ;; id = 4217
  ;; qr = 1 opcode = QUERY aa = 1 tc = 0 rd = 0
  ;; ra = 1 ad = 0 cd = 0 rcode = NXDOMAIN
  ;; qdcount = 1 ancount = 0 nscount = 1 arcount = 0


And the output of the &#40;unset&#41; values:


  $query-&gt;{header}-&gt;{ancount}:
  $query-&gt;{header}-&gt;{rcode}:

Versus the successful query:

  ;; ra = 1 ad = 0 cd = 0 rcode = NOERROR
  ;; qdcount = 1 ancount = 3 nscount = 0 arcount = 0


  $query-&gt;{header}-&gt;{ancount}: 3
  $query-&gt;{header}-&gt;{rcode}: NOERROR


/eli

On Fri, 2006-04-07 at 03:16 -0400, Olaf M. Kolkman via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=18580">http://rt.cpan.org/Ticket/Display.html?id=18580</a></span> &gt;
&gt; 
&gt; 
&gt; The example you provided does not seem to have a bug.
&gt; 
&gt; Both returned packets in the failed query example are protocol  
&gt; compliant &#40;rfc1034 and rfc1035&#41;.
&gt; 
&gt; The first question &#40;blah.google.com, A&#41; returns a referral message.  
&gt; That is not what I would expect from a correctly functioning  
&gt; recursive nameserver. But I am not quite sure what kind of server is  
&gt; at 10.65.1.108.
&gt; 
&gt; The second question &#40;blah.google.com.lucasfilm.com., A&#41; just  
&gt; correctly answers that there is no such domain by setting an  
&gt; rcode=NXDOMAIN. Note that you use the search function which will try  
&gt; to append the default domain &#40;lucasfilm.com in your case&#41; to the name  
&gt; if a direct match failed.
&gt; 
&gt; --Olaf
&gt; 
&gt; 
&gt; ------------------------------------------------------
&gt; Ik dacht net... heel even maar.
&gt; 
&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184435" href="/Public/Bug/Display.html?id=18580#txn-184435">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;08&nbsp;04:31:49&nbsp;2006</span>
    <span class="description">olaf [...] dacht.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #18580] rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 8 Apr 2006 10:31:21 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Olaf M. Kolkman&#34; &lt;olaf [...] dacht.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/184435/65240/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/65240">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; My point was that the array &#34;$query-&gt;{header}-&gt;{rcode}&#34; is not  
&gt; being set
&gt; to NXDOMAIN when the rcode on the actual query return IS set to
&gt; &#34;NXDOMAIN&#34;... the only value I&#39;ve been able to get rcode set with on a
&gt; return is &#34;NOERROR&#34;... I know the return was false, that was the  
&gt; point,
&gt; in a failed NXDOMAIN query the &#39;rcode&#39; and &#39;ancount&#39; do not get  
&gt; defined.
&gt;
&gt; As the query return header shows:
&gt;
</div>
Aha... I misread that.

The problem that you encounter is that query and search have been  
tailored towards &#39;positive&#39; answers. That is an early design decision  
that I am hesitant to change.

What happens is that the returned object is only defined when the  
answer count is larger than 0.

This is documented in the Resolver perlpod:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Returns a &#34;Net::DNS::Packet&#34; object, or &#34;undef&#34; if no  
&gt; answers were
&gt;        found.  If you need to examine the response packet whether  
&gt; it contains
&gt;        any answers or not, use the send&#40;&#41; method instead.
</div>
I&#39;d suggest you rewrite your testprogram to use send. The benefit is  
that you have a little more control about the search lists and so on.  
&#40;I reckon that you hardly ever want to use the searchlist for these  
kind of benchmark tests.&#41;


I hope this answers your question.

--Olaf

------------------------------------------------------
Ik dacht net... heel even maar.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/184435/65241/PGP.sig">Download PGP.sig</a><br />
<span class="downloadcontenttype">application/pgp-signature 227b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184521" href="/Public/Bug/Display.html?id=18580#txn-184521">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;08&nbsp;11:14:05&nbsp;2006</span>
    <span class="description">mike [...] fuhr.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #18580] rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 8 Apr 2006 09:13:39 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Olaf M. Kolkman via RT&#34; &lt;bug-Net-DNS [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Fuhr &lt;mike [...] fuhr.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/184521/65301/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/65301">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 696b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, Apr 08, 2006 at 04:31:51AM -0400, Olaf M. Kolkman via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The problem that you encounter is that query and search have been  
&gt; tailored towards &#39;positive&#39; answers. That is an early design decision  
&gt; that I am hesitant to change.
&gt;
&gt; What happens is that the returned object is only defined when the  
&gt; answer count is larger than 0.
</div>
The rationale behind that decision is that it mimics the behavior
of the C resolver functions res_query&#40;&#41; and res_search&#40;&#41;, which
return -1 if the response contained no answer records.  Net::DNS
has behaved that way since the beginning; changing it would break
all the existing code that relies on that documented behavior.

-- 
Michael Fuhr
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184535" href="/Public/Bug/Display.html?id=18580#txn-184535">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;08&nbsp;14:28:18&nbsp;2006</span>
    <span class="description">estair [...] ilm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #18580] rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 8 Apr 2006 11:26:29 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Net-DNS [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Eli Stair&#34; &lt;estair [...] ilm.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/184535/65312/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/65312">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Olaf, thanks for the clarification.  My bad for not _reading_ the perldoc, and assuming the value would be set in all circumstances.

I&#39;ll take that advice.  

Cheers,

/eli



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Olaf M. Kolkman via RT [mailto:bug-Net-DNS@rt.cpan.org]
Sent: Sat 4/8/2006 1:31 AM
To: Eli Stair
Subject: Re: [rt.cpan.org #18580] rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL
 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=18580">http://rt.cpan.org/Ticket/Display.html?id=18580</a></span> &gt;


<div class="message-stanza open">&gt;
&gt; My point was that the array &#34;$query-&gt;{header}-&gt;{rcode}&#34; is not  
&gt; being set
&gt; to NXDOMAIN when the rcode on the actual query return IS set to
&gt; &#34;NXDOMAIN&#34;... the only value I&#39;ve been able to get rcode set with on a
&gt; return is &#34;NOERROR&#34;... I know the return was false, that was the  
&gt; point,
&gt; in a failed NXDOMAIN query the &#39;rcode&#39; and &#39;ancount&#39; do not get  
&gt; defined.
&gt;
&gt; As the query return header shows:
&gt;
</div>
Aha... I misread that.

The problem that you encounter is that query and search have been  
tailored towards &#39;positive&#39; answers. That is an early design decision  
that I am hesitant to change.

What happens is that the returned object is only defined when the  
answer count is larger than 0.

This is documented in the Resolver perlpod:

<div class="message-stanza open">&gt;        Returns a &#34;Net::DNS::Packet&#34; object, or &#34;undef&#34; if no  
&gt; answers were
&gt;        found.  If you need to examine the response packet whether  
&gt; it contains
&gt;        any answers or not, use the send&#40;&#41; method instead.
</div>
I&#39;d suggest you rewrite your testprogram to use send. The benefit is  
that you have a little more control about the search lists and so on.  
&#40;I reckon that you hardly ever want to use the searchlist for these  
kind of benchmark tests.&#41;


I hope this answers your question.

--Olaf

------------------------------------------------------
Ik dacht net... heel even maar.
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/184535/65313/winmail.dat">Download winmail.dat</a><br />
<span class="downloadcontenttype">application/ms-tnef 4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-184537" href="/Public/Bug/Display.html?id=18580#txn-184537">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;08&nbsp;15:35:11&nbsp;2006</span>
    <span class="description">olaf [...] dacht.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #18580] rcode not set if lookup fails and rcode=NXDOMAIN or rcode=SERVFAIL</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 8 Apr 2006 21:34:28 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Olaf M. Kolkman&#34; &lt;olaf [...] dacht.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/184537/65316/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/65316">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 735b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Apr 8, 2006, at 5:14 PM, Michael Fuhr via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; The rationale behind that decision is that it mimics the behavior
&gt; of the C resolver functions res_query&#40;&#41; and res_search&#40;&#41;, which
&gt; return -1 if the response contained no answer records.  Net::DNS
&gt; has behaved that way since the beginning; changing it would break
&gt; all the existing code that relies on that documented behavior.
&gt;
</div>


Hi Michael,

Good to see you&#39;re still keeping an eye on things

&lt;:-&#41;&gt;
&#34;I am hesitant to change&#34; actually means .. &#34;over my dead body&#34; in  
this particular case.
&lt;/:-&#41;

It would mean a major API change and that would be a bad idea indeed.

--Olaf


------------------------------------------------------
Ik dacht net... heel even maar.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/184537/65317/PGP.sig">Download PGP.sig</a><br />
<span class="downloadcontenttype">application/pgp-signature 227b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-187401" href="/Public/Bug/Display.html?id=18580#txn-187401">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;18&nbsp;05:02:36&nbsp;2006</span>
    <span class="description">OLAF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.665611</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
