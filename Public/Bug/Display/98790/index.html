<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #98790 for Qt: Tests fail with perl-5.20.0: &#34;SvREFCNT_inc&#34; is not exported by the Devel::Peek module</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #98790 for Qt: Tests fail with perl-5.20.0: &#34;SvREFCNT_inc&#34; is not exported by the Devel::Peek module</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Qt">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Qt">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Qt">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Qt">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Qt">Qt CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">98790</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Qt">Qt</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ppisar [...] redhat.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-27422-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.96.0    </td>
  </tr>
  <tr id="CF-27423-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




perlqt-4.14.2-Use-a-copy-of-the-Qt-AutoLoad-AUTOLOAD-variable.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1428164/758770/perlqt-4.14.2-Use-a-copy-of-the-Qt-AutoLoad-AUTOLOAD-variable.patch">
Mon Nov 03 04:16:01 2014 (1.7k) by ppisar [...] redhat.com
</a>
</font></li>
</ul>


Qt-0.96.0-Bundle-Devel-Peel-SvREFCNT_inc-removed-from-perl-5.2.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1409909/748384/Qt-0.96.0-Bundle-Devel-Peel-SvREFCNT_inc-removed-from-perl-5.2.patch">
Thu Sep 11 11:14:57 2014 (1.7k) by ppisar [...] redhat.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=98790">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1409879" href="/Public/Bug/Display.html?id=98790#txn-1409879">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;11&nbsp;10:26:46&nbsp;2014</span>
    <span class="description">ppisar [...] redhat.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Tests fail with perl-5.20.0: &#34;SvREFCNT_inc&#34; is not exported by
 the Devel::Peek module</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1409879/748363/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/748363">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perl-5.20&#39;s Devel::Peek removed SvREFCNT_inc and SvREFCNT_dec as commented in &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.perl.org/Public/Bug/Display.html?id=117793#txn-1227501&gt;">https://rt.perl.org/Public/Bug/Display.html?id=117793#txn-1227501&gt;</a></span> by this commit:

commit da1929e7566d4399b20541f8609bd48b40663034
Author: Tony Cook &lt;tony@develop-help.com&gt;
Date:   Fri Aug 9 11:41:26 2013 +1000

    [perl #117793] remove dangerous functions and improve SvREFCNT&#40;&#41;
    
    This allows Devel::Peek::SvREFCNT&#40;&#41; to work on any variable, not just
    scalars, but has a chance of breaking backward compatibility.
    
    Also changes the type of SvREFCNT&#40;&#41; to U32 to match the type returned by
    the underlying macro

This causes Qt tests failure:

$ prove -b -v &#34;/home/test/fedora/perl-Qt/Qt-0.96.0/qtcore/t/a_loading.t&#34; 
/home/test/fedora/perl-Qt/Qt-0.96.0/qtcore/t/a_loading.t .. 
1..2
ok 1 - use QtCore4;
not ok 2 - use QtGui4;

#   Failed test &#39;use QtGui4;&#39;
#   at /home/test/fedora/perl-Qt/Qt-0.96.0/qtcore/t/a_loading.t line 3.
#     Tried to use &#39;QtGui4&#39;.
#     Error:  &#34;SvREFCNT_inc&#34; is not exported by the Devel::Peek module
# Can&#39;t continue after import errors at /home/test/fedora/perl-Qt/Qt-0.96.0/build/blib/lib/QtGui4.pm line 25.
# BEGIN failed--compilation aborted at /home/test/fedora/perl-Qt/Qt-0.96.0/build/blib/lib/QtGui4.pm line 25.
# Compilation failed in require at /home/test/fedora/perl-Qt/Qt-0.96.0/qtcore/t/a_loading.t line 3.
# BEGIN failed--compilation aborted at /home/test/fedora/perl-Qt/Qt-0.96.0/qtcore/t/a_loading.t line 3.
# Looks like you failed 1 test of 2.
Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
Failed 1/2 subtests 

And because the Devel::Peek::SvREFCNT_inc is used by the library code, even the library cannot be compiled.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1409909" href="/Public/Bug/Display.html?id=98790#txn-1409909">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;11&nbsp;11:14:57&nbsp;2014</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ppisar [...] redhat.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1409909/748383/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/748383">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 296b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dne Čt 11.zář.2014 10:26:46, ppisar napsal&#40;a&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perl-5.20&#39;s Devel::Peek removed SvREFCNT_inc and SvREFCNT_dec as
&gt; commented in
&gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.perl.org/Public/Bug/Display.html?id=117793#txn-1227501&gt;">https://rt.perl.org/Public/Bug/Display.html?id=117793#txn-1227501&gt;</a></span> by
&gt; this commit:
&gt; 
</div>Attached patch comes from Ubuntu which reimplements the missing function.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Qt-0.96.0-Bundle-Devel-Peel-SvREFCNT_inc-removed-from-perl-5.2.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1409909/748384/Qt-0.96.0-Bundle-Devel-Peel-SvREFCNT_inc-removed-from-perl-5.2.patch">Download Qt-0.96.0-Bundle-Devel-Peel-SvREFCNT_inc-removed-from-perl-5.2.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 1f62c5d8dd589e7131df0b378513148375e41317 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Petr=20P=C3=ADsa=C5=99?= &lt;ppisar@redhat.com&gt;
Date: Thu, 11 Sep 2014 16:48:39 +0200
Subject: [PATCH] Bundle Devel::Peel::SvREFCNT_inc removed from perl-5.20.0
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Patch taken from Ubuntu:

perlqt &#40;4:4.14.0-0ubuntu4&#41; utopic; urgency=medium

  * Devel::Peek in Perl 5.20 no longer exports SvREFCNT_inc, so put a copy
    in QtGui4::_internal instead.  Fixes perlkde build.

 -- Colin Watson &lt;cjwatson@ubuntu.com&gt;  Tue, 26 Aug 2014 14:13:07 -0700

CPAN RT#98790

Signed-off-by: Petr PÃ­saÅ &lt;ppisar@redhat.com&gt;
---
 qtgui/lib/QtGui4.pm | 3 +--
 qtgui/src/QtGui4.xs | 7 +++++++
 2 files changed, 8 insertions&#40;+&#41;, 2 deletions&#40;-&#41;

diff --git a/qtgui/lib/QtGui4.pm b/qtgui/lib/QtGui4.pm
index a33f66a..2fae3d7 100644
--- a/qtgui/lib/QtGui4.pm
+++ b/qtgui/lib/QtGui4.pm
@@ -22,7 +22,6 @@ use warnings;
 
 use QtCore4;
 use base qw&#40;Qt::_internal&#41;;
-use Devel::Peek qw&#40; SvREFCNT_inc &#41;;
 
 sub init {
     @Qt::_internal::vectorTypes{qw&#40;Qt::Polygon Qt::PolygonF Qt::ItemSelection&#41;}
@@ -76,7 +75,7 @@ sub Qt::GraphicsObject::ON_DESTROY {
 }
 
 sub Qt::UndoCommand::ON_DESTROY {
-    Devel::Peek::SvREFCNT_inc&#40; Qt::this&#40;&#41; &#41;;
+    QtGui4::_internal-&gt;SvREFCNT_inc&#40; Qt::this&#40;&#41; &#41;;
     # XXX is there a better solution here?
     return 1;
 }
diff --git a/qtgui/src/QtGui4.xs b/qtgui/src/QtGui4.xs
index e1a0783..3a23ad4 100644
--- a/qtgui/src/QtGui4.xs
+++ b/qtgui/src/QtGui4.xs
@@ -91,6 +91,13 @@ getEnumList&#40;&#41;
     OUTPUT:
         RETVAL
 
+SV*
+SvREFCNT_inc&#40;sv&#41;
+        SV* sv
+    PPCODE:
+        RETVAL = SvREFCNT_inc&#40;sv&#41;;
+        PUSHs&#40;RETVAL&#41;;
+
 MODULE = QtGui4            PACKAGE = QtGui4
 
 PROTOTYPES: ENABLE
-- 
1.9.3

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1410329" href="/Public/Bug/Display.html?id=98790#txn-1410329">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;12&nbsp;03:57:38&nbsp;2014</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ppisar [...] redhat.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1410329/748623/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/748623">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 908b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dne Čt 11.zář.2014 11:14:57, ppisar napsal&#40;a&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Dne Čt 11.zář.2014 10:26:46, ppisar napsal&#40;a&#41;:
<div class="message-stanza open">&gt; &gt; Perl-5.20&#39;s Devel::Peek removed SvREFCNT_inc and SvREFCNT_dec as
&gt; &gt; commented in
&gt; &gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.perl.org/Public/Bug/Display.html?id=117793#txn-1227501&gt;">https://rt.perl.org/Public/Bug/Display.html?id=117793#txn-1227501&gt;</a></span> by
&gt; &gt; this commit:
&gt; &gt; 
</div>&gt; Attached patch comes from Ubuntu which reimplements the missing function.
</div>
Agter applying the patch, only two tests remain failing. There is a problem when using == operator for the second time:

perl -Ibuild/blib/{arch,lib} -e &#39;use QtGui4; $a = Qt::Point&#40;5,7&#41;; $a == $a; $a == $a;&#39;
--- Error: Method does not exist or not provided by this binding:
QPoint::operator==&#40;&#41;,
called at -e line 1
&#39;use QtCore4::debug qw&#40;ambiguous&#41;&#39; for more information.
--- Error: Method does not exist or not provided by this binding:
QGlobalSpace::QGlobalSpace&#40;&#41;,
called at -e line 1
&#39;use QtCore4::debug qw&#40;ambiguous&#41;&#39; for more information.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1428164" href="/Public/Bug/Display.html?id=98790#txn-1428164">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;03&nbsp;04:16:01&nbsp;2014</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ppisar [...] redhat.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1428164/758769/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/758769">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 709b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dne Pá 12.zář.2014 03:57:38, ppisar napsal&#40;a&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Agter applying the patch, only two tests remain failing. There is a
&gt; problem when using == operator for the second time:
&gt; 
&gt; perl -Ibuild/blib/{arch,lib} -e &#39;use QtGui4; $a = Qt::Point&#40;5,7&#41;; $a
&gt; == $a; $a == $a;&#39;
&gt; --- Error: Method does not exist or not provided by this binding:
&gt; QPoint::operator==&#40;&#41;,
&gt; called at -e line 1
&gt; &#39;use QtCore4::debug qw&#40;ambiguous&#41;&#39; for more information.
&gt; --- Error: Method does not exist or not provided by this binding:
&gt; QGlobalSpace::QGlobalSpace&#40;&#41;,
&gt; called at -e line 1
&gt; &#39;use QtCore4::debug qw&#40;ambiguous&#41;&#39; for more information.
</div>
This can be fixed by an attached commit from &lt;git://anongit.kde.org/perlqt&gt;.

-- Petr
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> perlqt-4.14.2-Use-a-copy-of-the-Qt-AutoLoad-AUTOLOAD-variable.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1428164/758770/perlqt-4.14.2-Use-a-copy-of-the-Qt-AutoLoad-AUTOLOAD-variable.patch">Download perlqt-4.14.2-Use-a-copy-of-the-Qt-AutoLoad-AUTOLOAD-variable.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 1b665848e178301344386717c658386d160d222a Mon Sep 17 00:00:00 2001
From: Chris Burel &lt;chrisburel@gmail.com&gt;
Date: Fri, 31 Oct 2014 11:23:18 -0700
Subject: [PATCH] Use a copy of the Qt::AutoLoad::AUTOLOAD variable.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This appears to be a change in Perl&#39;s behavior.  The way the operator
overloading in PerlQt works is that it first tries to find an operator method
on the class itself, and then next it tries to find one in the so-called
QGlobalSpace, which is a place defined by the smoke library for global Qt
functions.  Perl passes the underlying XS code the full package and function
being called, which PerlQt splits into 2 strings, one for the package name, and
one for the method name.  PerlQt null-terminates the package name string, and
in previous versions of Perl, this modification did not affect the source
$AUTOLOAD variable.  In Perl 5.20.0, it does update the Perl variable, and then
causes confusion down the line.

<span class="clickylink"><a target="new" rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=1136340">https://bugzilla.redhat.com/show_bug.cgi?id=1136340</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="https://bugs.kde.org/show_bug.cgi?id=340518">https://bugs.kde.org/show_bug.cgi?id=340518</a></span>
Signed-off-by: Petr PÃ­saÅ &lt;ppisar@redhat.com&gt;
---
 qtcore/src/util.cpp | 2 +-
 1 file changed, 1 insertion&#40;+&#41;, 1 deletion&#40;-&#41;

diff --git a/qtcore/src/util.cpp b/qtcore/src/util.cpp
index a163e7e..b913af3 100644
--- a/qtcore/src/util.cpp
+++ b/qtcore/src/util.cpp
@@ -2047,7 +2047,7 @@ XS&#40;XS_AUTOLOAD&#41; {
     PERL_SET_CONTEXT&#40;PL_curinterp&#41;;
     // Figure out which package and method is being called, based on the
     // autoload variable
-    SV* autoload = get_sv&#40; &#34;Qt::AutoLoad::AUTOLOAD&#34;, TRUE &#41;;
+    SV* autoload = sv_mortalcopy&#40; get_sv&#40; &#34;Qt::AutoLoad::AUTOLOAD&#34;, TRUE &#41; &#41;;
     char* package = SvPV_nolen&#40; autoload &#41;;
     char* methodname = 0;
     // Splits off the method name from the package
-- 
1.9.3

</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.44833</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
