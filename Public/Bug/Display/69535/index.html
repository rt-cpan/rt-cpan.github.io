<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #69535 for Encode: </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #69535 for Encode: </h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Encode">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Encode">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Encode">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Encode">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Encode">Encode CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">69535</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Encode">Encode</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
VKHERA [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
pali [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-12062-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
2.42</li>
<li>
2.43</li>
</ul>
    </td>
  </tr>
  <tr id="CF-12063-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.83    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=69535">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-956600" href="/Public/Bug/Display.html?id=69535#txn-956600">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;17&nbsp;11:37:42&nbsp;2011</span>
    <span class="description">VKHERA [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/956600/497637/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/497637">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">When encode&#40;&#41; is called to encode a mail header using &#34;MIME-Q&#34;, it breaks the header at 
apostrophes or colons resulting in extra whitespace when the header is unfolded by the MUA.

Example code:


#! /usr/local/bin/perl
use strict;

use Encode qw&#40;encode&#41;;

print &#34;Encode version $Encode::VERSION\n&#34;;

print encode&#40;&#39;MIME-Q&#39;,&#34;Subject: Bla Blahbla blah:Blahbl &#38; Blahbla Bla Blah Bla Can&#39;t Blahb 
Blahbla Bla. blah blah blah&#34;&#41;,&#34;\n&#34;;
print encode&#40;&#39;MIME-Q&#39;,&#34;Subject: Bla Blahbla blah:Blahbl &#38; Blahbla Bla Blah Bla Cant Blahb 
Blahbla Bla. blah blah blah&#34;&#41;,&#34;\n&#34;;
print encode&#40;&#39;MIME-Q&#39;,&#34;Subject: Bla Blahbla blah Blahbl &#38; Blahbla Bla Blah Bla Cant Blahb 
Blahbla Bla. blah blah blah&#34;&#41;,&#34;\n&#34;;


The output of the first line splits the word &#34;Can&#39;t&#34; at the apostrophe, and the second one it 
splits after &#34;blah:&#34;.  In both cases when the MUA unfolds the lines, the extra whitespace 
induced is retained, and the message headers, in this case the Subject, do not match the 
original intent.  The space after the &#34;:&#34; could be ignored, but the one in the middle of the 
contraction &#34;Can&#39;t&#34; is totally wrong.

This seems related to the tickets: 40027, 63387, and 67569

Here&#39;s the output I see with Perl 5.10 and 5.12 on FreeBSD 8.2:


Encode version 2.43
Subject: Bla Blahbla blah:Blahbl &#38; Blahbla Bla Blah Bla Can&#39;
 t Blahb Blahbla Bla. blah blah blah
Subject: Bla Blahbla blah:
 Blahbl &#38; Blahbla Bla Blah Bla Cant Blahb Blahbla Bla. blah blah blah
Subject:
  Bla Blahbla blah Blahbl &#38; Blahbla Bla Blah Bla Cant Blahb Blahbla Bla. blah blah blah
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-965364" href="/Public/Bug/Display.html?id=69535#txn-965364">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;09&nbsp;03:35:46&nbsp;2011</span>
    <span class="description">DANKOGAI [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-990735" href="/Public/Bug/Display.html?id=69535#txn-990735">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;21&nbsp;22:18:50&nbsp;2011</span>
    <span class="description">rjbs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/990735/515841/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/515841">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 202b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I agree with this report.  Line folding should only occur at whitespace.

I&#39;d prefer if there was a mime header encoding routine that did not
fold, but left it up to the message-handling code.

-- 
rjbs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1675804" href="/Public/Bug/Display.html?id=69535#txn-1675804">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;10&nbsp;11:50:20&nbsp;2016</span>
    <span class="description">pali [...] cpan.org -  Cc PALI added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1675806" href="/Public/Bug/Display.html?id=69535#txn-1675806">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;10&nbsp;11:50:33&nbsp;2016</span>
    <span class="description">pali [...] cpan.org -  Fixed in 2.83 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1675807" href="/Public/Bug/Display.html?id=69535#txn-1675807">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;10&nbsp;11:51:35&nbsp;2016</span>
    <span class="description">pali [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> MIME-Q breaks the header at apostrophes or colons</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1675807/899298/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/899298">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Ned JÃºl 17 11:37:42 2011, VKHERA wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When encode&#40;&#41; is called to encode a mail header using &#34;MIME-Q&#34;, it
&gt; breaks the header at
&gt; apostrophes or colons resulting in extra whitespace when the header is
&gt; unfolded by the MUA.
&gt; 
&gt; Example code:
&gt; 
&gt; 
&gt; #! /usr/local/bin/perl
&gt; use strict;
&gt; 
&gt; use Encode qw&#40;encode&#41;;
&gt; 
&gt; print &#34;Encode version $Encode::VERSION\n&#34;;
&gt; 
&gt; print encode&#40;&#39;MIME-Q&#39;,&#34;Subject: Bla Blahbla blah:Blahbl &#38; Blahbla Bla
&gt; Blah Bla Can&#39;t Blahb
&gt; Blahbla Bla. blah blah blah&#34;&#41;,&#34;\n&#34;;
&gt; print encode&#40;&#39;MIME-Q&#39;,&#34;Subject: Bla Blahbla blah:Blahbl &#38; Blahbla Bla
&gt; Blah Bla Cant Blahb
&gt; Blahbla Bla. blah blah blah&#34;&#41;,&#34;\n&#34;;
&gt; print encode&#40;&#39;MIME-Q&#39;,&#34;Subject: Bla Blahbla blah Blahbl &#38; Blahbla Bla
&gt; Blah Bla Cant Blahb
&gt; Blahbla Bla. blah blah blah&#34;&#41;,&#34;\n&#34;;
&gt; 
&gt; 
&gt; The output of the first line splits the word &#34;Can&#39;t&#34; at the
&gt; apostrophe, and the second one it
&gt; splits after &#34;blah:&#34;.  In both cases when the MUA unfolds the lines,
&gt; the extra whitespace
&gt; induced is retained, and the message headers, in this case the
&gt; Subject, do not match the
&gt; original intent.  The space after the &#34;:&#34; could be ignored, but the
&gt; one in the middle of the
&gt; contraction &#34;Can&#39;t&#34; is totally wrong.
&gt; 
&gt; This seems related to the tickets: 40027, 63387, and 67569
&gt; 
&gt; Here&#39;s the output I see with Perl 5.10 and 5.12 on FreeBSD 8.2:
&gt; 
&gt; 
&gt; Encode version 2.43
&gt; Subject: Bla Blahbla blah:Blahbl &#38; Blahbla Bla Blah Bla Can&#39;
&gt;  t Blahb Blahbla Bla. blah blah blah
&gt; Subject: Bla Blahbla blah:
&gt;  Blahbl &#38; Blahbla Bla Blah Bla Cant Blahb Blahbla Bla. blah blah blah
&gt; Subject:
&gt;   Bla Blahbla blah Blahbl &#38; Blahbla Bla Blah Bla Cant Blahb Blahbla
&gt; Bla. blah blah blah
</div>
Fixed in Encode 2.83.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1680076" href="/Public/Bug/Display.html?id=69535#txn-1680076">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;01&nbsp;09:20:41&nbsp;2016</span>
    <span class="description">DANKOGAI [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.367629</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
