<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #67680 for POE: Regression in 1.310?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #67680 for POE: Regression in 1.310?</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=POE">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=POE">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=POE">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=POE">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/POE">POE CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">67680</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=POE">POE</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
troy [...] good.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-26342-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.310    </td>
  </tr>
  <tr id="CF-26343-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




poe-breaker.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1033653/539375/poe-breaker.pl">
Mon Feb 06 19:12:17 2012 (1k) by troy [...] good.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=67680">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-926582" href="/Public/Bug/Display.html?id=67680#txn-926582">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;21&nbsp;19:36:21&nbsp;2011</span>
    <span class="description">troy [...] good.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Regression in 1.310?</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/926582/480812/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/480812">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Grettings, 

I have written a POE FTP server.  Versions up to and including 1.299
seem to work fine.  After upgrading to 1.310,  My uploading seems not to
work.  The inbound data just doesn&#39;t seem to transfer, and eventually, I
get a POE dump when the client times out and closes the tcp connections,
with nothing obvious from my program above.

Let me know if I can do anything to gather more information.

=== &#40;24921&#41; ===
Please address any warnings or errors above this message, and try
again.  If there are none, or those messages are from within POE,
then please mail them along with the following information
to bug-POE@rt.cpan.org:
---
internal inconsistency &#40;/2&#41;
-----
 at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/Sessions.pm line 191
        POE::Kernel::_data_ses_free&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;, 2&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/Sessions.pm
line 587
        POE::Kernel::_data_ses_stop&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;, 2&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/Sessions.pm
line 392
        POE::Kernel::_data_ses_gc_sweep&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41;
called at
/usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/FileHandles.pm line 245
        POE::Kernel::_data_handle_enqueue_ready&#40;undef, undef, 8&#41; called
at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Loop/Select.pm line 285
        POE::Kernel::loop_do_timeslice&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Loop/Select.pm line 314
        POE::Kernel::loop_run&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.2/POE/Kernel.pm line 1210
        POE::Kernel::run&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41; called at
./ftpserver.pl line 612


This is perl 5, version 12, subversion 2 &#40;v5.12.2&#41; built for x86_64-linux
&#40;with 14 registered patches, see perl -V for more detail&#41;

Linux dev-apps-01 2.6.35-vs2.3.0.36.32-gentoo #2 SMP Sat Feb 26 10:41:36
MST 2011 x86_64 Intel&#40;R&#41; Xeon&#40;R&#41; CPU L5410 @ 2.33GHz GenuineIntel GNU/Linux
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-926585" href="/Public/Bug/Display.html?id=67680#txn-926585">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;21&nbsp;19:43:02&nbsp;2011</span>
    <span class="description">troy [...] good.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> troy [...] good.net</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/926585/480815/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/480815">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 170b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">As a side note, the test for POE::Component::Daemon appears to hang
indefinitely on my system while under POE-1.310 but not POE-1.299,
independent of my program.

Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-926632" href="/Public/Bug/Display.html?id=67680#txn-926632">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;21&nbsp;20:11:53&nbsp;2011</span>
    <span class="description">perl [...] 0ne.us -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #67680] Regression in 1.310?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Apr 2011 17:11:44 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-POE [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;perl [...] 0ne.us&#34; &lt;perl [...] 0ne.us&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/926632/480845/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/480845">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Troy Ablan via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thu Apr 21 19:36:21 2011: Request 67680 was acted upon.
&gt; Transaction: Ticket created by tablan
&gt;        Queue: POE
&gt;      Subject: Regression in 1.310?
&gt;    Broken in: 1.310
&gt;     Severity: Important
&gt;        Owner: Nobody
&gt;   Requestors: troy@good.net
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=67680">https://rt.cpan.org/Ticket/Display.html?id=67680</a></span> &gt;
&gt;
&gt;
&gt; Grettings, 
&gt;
&gt; I have written a POE FTP server.  Versions up to and including 1.299
&gt; seem to work fine.  After upgrading to 1.310,  My uploading seems not to
&gt; work.  The inbound data just doesn&#39;t seem to transfer, and eventually, I
&gt; get a POE dump when the client times out and closes the tcp connections,
&gt; with nothing obvious from my program above.
&gt;
&gt; Let me know if I can do anything to gather more information.
&gt;
&gt; === &#40;24921&#41; ===
&gt; Please address any warnings or errors above this message, and try
&gt; again.  If there are none, or those messages are from within POE,
&gt; then please mail them along with the following information
&gt; to bug-POE@rt.cpan.org:
&gt; ---
&gt; internal inconsistency &#40;/2&#41;
&gt; -----
&gt;  at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/Sessions.pm line 191
&gt;         POE::Kernel::_data_ses_free&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;, 2&#41;
&gt; called at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/Sessions.pm
&gt; line 587
&gt;         POE::Kernel::_data_ses_stop&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;, 2&#41;
&gt; called at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/Sessions.pm
&gt; line 392
&gt;         POE::Kernel::_data_ses_gc_sweep&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41;
&gt; called at
&gt; /usr/lib64/perl5/vendor_perl/5.12.2/POE/Resource/FileHandles.pm line 245
&gt;         POE::Kernel::_data_handle_enqueue_ready&#40;undef, undef, 8&#41; called
&gt; at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Loop/Select.pm line 285
&gt;         POE::Kernel::loop_do_timeslice&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41;
&gt; called at /usr/lib64/perl5/vendor_perl/5.12.2/POE/Loop/Select.pm line 314
&gt;         POE::Kernel::loop_run&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41; called at
&gt; /usr/lib64/perl5/vendor_perl/5.12.2/POE/Kernel.pm line 1210
&gt;         POE::Kernel::run&#40;&#39;POE::Kernel=ARRAY&#40;0x3177158&#41;&#39;&#41; called at
&gt; ./ftpserver.pl line 612
&gt;
&gt;
&gt; This is perl 5, version 12, subversion 2 &#40;v5.12.2&#41; built for x86_64-linux
&gt; &#40;with 14 registered patches, see perl -V for more detail&#41;
&gt;
&gt; Linux dev-apps-01 2.6.35-vs2.3.0.36.32-gentoo #2 SMP Sat Feb 26 10:41:36
&gt; MST 2011 x86_64 Intel&#40;R&#41; Xeon&#40;R&#41; CPU L5410 @ 2.33GHz GenuineIntel GNU/Linux
&gt;   
</div>Hello,

    Is it possible for you to provide the ftpserver.pl script &#40; slimmed
down if you can &#41; and a way to trigger the dump? That way we can
reproduce it locally and try to fix it. As a plus we might be able to
integrate it into the testsuite so it&#39;ll never happen again :&#41;

    I see you mentioned POE::Component::Daemon failing it&#39;s tests - do
you use any other module in your server? Can you try each with 1.310 and
see which ones fail?

    I can confirm that poco-daemon FAILs here too, and thats great news
&#40; in a bad way hah &#41; - I&#39;ve reported it:
<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=67685">https://rt.cpan.org/Ticket/Display.html?id=67685</a></span>

    Maybe fixing the poco-daemon error will completely solve it for you,
or not... Let&#39;s hope! :&#41;

    Thanks again for reporting it!

~Apocalypse
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-926635" href="/Public/Bug/Display.html?id=67680#txn-926635">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;21&nbsp;20:11:55&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-931012" href="/Public/Bug/Display.html?id=67680#txn-931012">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;04&nbsp;10:36:07&nbsp;2011</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/931012/483235/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/483235">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 705b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ideally we&#39;d love to see a test case that can reproduce the problem
under testing scenarios.  We can turn around a fix much quicker if we
can break the product at will and examine the pieces.

If a test case can&#39;t be provided, please try running your server with
these environment variables set:

export POE_ASSERT_DATA=1
export POE_CATCH_EXCEPTIONS=0

The first environment variable will enable several runtime internal data
consistency checks---not just on exit.  The second will disable
exception handling, which has been known to hide application errors for
some undiagnosed reason.

The checks and additional error messages may surface the problem quicker
and in a more relevant location.

Thank you.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-931470" href="/Public/Bug/Display.html?id=67680#txn-931470">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;05&nbsp;16:58:40&nbsp;2011</span>
    <span class="description">troy [...] good.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #67680] Regression in 1.310?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 05 May 2011 13:58:28 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-POE [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Troy Ablan &lt;troy [...] good.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/931470/483487/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/483487">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 370b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for the delay.  Just haven&#39;t had a chance to conjure up a suitable
test case quite yet.  The failing app isn&#39;t standalone and I&#39;ll have to
whittle it down into something simpler in order to test separately.  I
have a suspicion it&#39;s related to POE::Component::Daemon, but haven&#39;t
confirmed. 

I hope to have something to offer here by May 9 2011 &#40;Monday&#41;.

Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-932279" href="/Public/Bug/Display.html?id=67680#txn-932279">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;08&nbsp;22:29:46&nbsp;2011</span>
    <span class="description">troy [...] good.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #67680] Regression in 1.310?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 08 May 2011 19:29:34 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-POE [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Troy Ablan &lt;troy [...] good.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/932279/483944/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/483944">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 9.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Two things

1&#41; I have been unable to reproduce the problem after removing our
backend bits.  Something somewhat nonstandard that I do is I attach a
tied filehandle to a ReadWrite wheel.  In the case of reading, the
FILENO method returns a filehandle opened to /dev/zero.  For writing, I
give it one to /dev/null.   The tied filehandle backend streams files
from mogilefs in chunks, from multiple backends, so AFAIK I&#39;m forced to
lie about the fileno in order to use POE wheels.

2&#41; The problem/dump without the env variables shows up only when I try
to retrieve a file.  With these environment variables

export POE_ASSERT_DATA=1
export POE_CATCH_EXCEPTIONS=0

everything still functions properly under POE-1.299, but doesn&#39;t even
allow login as it barfs right away upon client connection under
POE-1.310 with

# ./ftpserver.pl
8484: Accept id: 1 IPv4 69.160.35.99:44792 at ./ftpserver.pl line 284.
=== &#40;8492&#41; ===
Please address any warnings or errors above this message, and try
again.  If there are none, or those messages are from within POE,
then please mail them along with the following information
to bug-POE@rt.cpan.org:
---
&lt;ev&gt; can&#39;t enqueue event ``_sigchld_poll&#39;&#39; for nonexistent session
-----
 at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/Events.pm line 72
        POE::Kernel::_data_ev_enqueue&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, &#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;_sigchld_poll&#39;, 256, &#39;ARRAY&#40;0x34097c0&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/Signals.pm&#39;, 549,
undef, ...&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/Signals.pm line 547
       
POE::Kernel::_data_sig_enqueue_poll_event&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, &#39;CHLD&#39;&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Loop/PerlSignals.pm
line 97
        POE::Kernel::loop_watch_signal&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;CHLD&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/Signals.pm line 295
       
POE::Kernel::_data_sig_signal_watch&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, 2,
&#39;CHLD&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/Signals.pm line 284
        POE::Kernel::_data_sig_add&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;CHLD&#39;, &#39;CHLD&#39;, &#39;ARRAY&#40;0x340a958&#41;&#39;&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 697
        POE::Kernel::sig&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, &#39;CHLD&#39;, &#39;CHLD&#39;&#41;
called at ./ftpserver.pl line 314
        main::__ANON__&#40;undef, &#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, &#39;HASH&#40;0x3408b20&#41;&#39;, &#39;request&#39;,
&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, undef,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;, 700, ...&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Session.pm line 464
        POE::Session::_invoke_state&#40;&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, &#39;request&#39;, &#39;ARRAY&#40;0x340c808&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;, 700,
&#39;update_status&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1028
        eval {...} called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1014
        POE::Kernel::_dispatch_event&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;request&#39;, 2, &#39;ARRAY&#40;0x340c808&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;, 700,
&#39;request&#39;, ...&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1714
        POE::Kernel::call&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, 2, &#39;request&#39;,
&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, &#39;HASH&#40;0x3408790&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 700
       
POE::Component::Daemon::expedite_signal&#40;&#39;POE::Component::Daemon=HASH&#40;0x33fc9d0&#41;&#39;,
&#39;daemon_child&#39;, &#39;HASH&#40;0x3408790&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 712
       
POE::Component::Daemon::inform_others&#40;&#39;POE::Component::Daemon=HASH&#40;0x33fc9d0&#41;&#39;,
&#39;daemon_child&#39;, &#39;HASH&#40;0x3408790&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 644
       
POE::Component::Daemon::become_child&#40;&#39;POE::Component::Daemon=HASH&#40;0x33fc9d0&#41;&#39;,
0, &#39;HASH&#40;0x3408790&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 578
       
POE::Component::Daemon::fork&#40;&#39;POE::Component::Daemon=HASH&#40;0x33fc9d0&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, &#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;HASH&#40;0x33fd9b0&#41;&#39;, &#39;fork&#39;, &#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, undef,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;, 849, ...&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Session.pm line 483
        POE::Session::_invoke_state&#40;&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, &#39;fork&#39;, &#39;ARRAY&#40;0x340bf28&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;, 849,
&#39;request&#39;&#41; called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm
line 1707
        POE::Kernel::call&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, &#39;fork&#39;, &#39;HASH&#40;0x3408790&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 849
       
POE::Component::Daemon::fork_off&#40;&#39;POE::Component::Daemon=HASH&#40;0x33fc9d0&#41;&#39;,
&#39;ARRAY&#40;0x340bbc8&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 1044
       
POE::Component::Daemon::update_status_fork_parent&#40;&#39;POE::Component::Daemon=HASH&#40;0x33fc9d0&#41;&#39;,
&#39;req&#39;, &#39;HASH&#40;0x3408790&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 948
       
POE::Component::Daemon::update_status&#40;&#39;POE::Component::Daemon=HASH&#40;0x33fc9d0&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, &#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;HASH&#40;0x33fd9b0&#41;&#39;, &#39;update_status&#39;, &#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
undef, &#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;,
1099, ...&#41; called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Session.pm
line 483
        POE::Session::_invoke_state&#40;&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;update_status&#39;, &#39;ARRAY&#40;0x3409d48&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;, 1099,
&#39;POE::Wheel::ListenAccept&#40;1&#41; -&gt; select read&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1028
        eval {...} called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1014
        POE::Kernel::_dispatch_event&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x290a038&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;update_status&#39;, 2, &#39;ARRAY&#40;0x3409d48&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm&#39;, 1099,
&#39;request&#39;, ...&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1714
        POE::Kernel::call&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE-Component-Daemon&#39;, &#39;update_status&#39;, &#39;req&#39;, &#39;HASH&#40;0x3408790&#41;&#39;&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm
line 1099
        Daemon::update_status&#40;&#39;Daemon&#39;, &#39;req&#39;, &#39;HASH&#40;0x3408790&#41;&#39;&#41; called
at ./ftpserver.pl line 288
        main::__ANON__&#40;undef, &#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, &#39;HASH&#40;0x3408b20&#41;&#39;, &#39;accept&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, undef,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Wheel/ListenAccept.pm&#39;, 100,
...&#41; called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Session.pm line 464
        POE::Session::_invoke_state&#40;&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;accept&#39;, &#39;ARRAY&#40;0x2f9ed88&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Wheel/ListenAccept.pm&#39;, 100,
&#39;request&#39;&#41; called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm
line 1707
        POE::Kernel::call&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;accept&#39;, &#39;GLOB&#40;0x34071c8&#41;&#39;,
&#39;\x{2}\x{0}\x{ae}\x{f8}E\x{a0}#c\x{0}\x{0}\x{0}\x{0}\x{0}\x{0}\x{0}\x{0}&#39;,
1&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Wheel/ListenAccept.pm line 100
        POE::Wheel::ListenAccept::__ANON__&#40;undef,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;HASH&#40;0x3408b20&#41;&#39;, &#39;POE::Wheel::ListenAccept&#40;1&#41; -&gt; select read&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, undef,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/FileHandles.pm&#39;, 240,
...&#41; called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Session.pm line 464
        POE::Session::_invoke_state&#40;&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;POE::Wheel::ListenAccept&#40;1&#41; -&gt; select
read&#39;, &#39;ARRAY&#40;0x3406ef8&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/FileHandles.pm&#39;, 240,
undef&#41; called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1036
        eval {...} called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1035
        POE::Kernel::_dispatch_event&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;,
&#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;, &#39;POE::Session=ARRAY&#40;0x3408bb0&#41;&#39;,
&#39;POE::Wheel::ListenAccept&#40;1&#41; -&gt; select read&#39;, 1024, &#39;ARRAY&#40;0x3406ef8&#41;&#39;,
&#39;/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/FileHandles.pm&#39;, 240,
undef, ...&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/FileHandles.pm line 238
        POE::Kernel::_data_handle_enqueue_ready&#40;undef, undef, 3&#41; called
at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Loop/Select.pm line 285
        POE::Kernel::loop_do_timeslice&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;&#41;
called at /usr/lib64/perl5/vendor_perl/5.12.3/POE/Loop/Select.pm line 314
        POE::Kernel::loop_run&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Kernel.pm line 1210
        POE::Kernel::run&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;&#41; called at
./ftpserver.pl line 612
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-960655" href="/Public/Bug/Display.html?id=67680#txn-960655">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;27&nbsp;02:19:16&nbsp;2011</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/960655/499859/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/499859">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun May 08 22:29:46 2011, tablan wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Two things
&gt; 
&gt; 1&#41; I have been unable to reproduce the problem after removing our
&gt; backend bits.  Something somewhat nonstandard that I do is I attach a
&gt; tied filehandle to a ReadWrite wheel.  In the case of reading, the
&gt; FILENO method returns a filehandle opened to /dev/zero.  For writing,
&gt; I
&gt; give it one to /dev/null.   The tied filehandle backend streams files
&gt; from mogilefs in chunks, from multiple backends, so AFAIK I&#39;m forced
&gt; to
&gt; lie about the fileno in order to use POE wheels.
</div>
I&#39;m almost certain that your hack to provide fileno&#40;&#41; is *not* the issue
here.  The worst you may have done is turned the once-event-driven
ReadWrite object into a high-CPU poller by watching filehandles that are
always ready for read/write.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2&#41; The problem/dump without the env variables shows up only when I try
&gt; to retrieve a file.  With these environment variables
&gt; 
&gt; export POE_ASSERT_DATA=1
&gt; export POE_CATCH_EXCEPTIONS=0
&gt; 
&gt; everything still functions properly under POE-1.299, but doesn&#39;t even
&gt; allow login as it barfs right away upon client connection under
&gt; POE-1.310 with
</div>
[...]

&lt;ev&gt; can&#39;t enqueue event ``_sigchld_poll&#39;&#39; for nonexistent session at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/Events.pm line 72

POE::Kernel has failed to send itself an event.  POE::Kernel may not
have been created, or it may have self-destructed at an inopportune time.

[...]

POE::Kernel::_data_sig_enqueue_poll_event&#40;...&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Loop/PerlSignals.pm line 97

The event loop POE::Kernel is using has been asked to watch SIGCHLD. 
It&#39;s trying to enqueue &#34;_sigchld_poll&#34; to start that process.

[...]

POE::Kernel::loop_watch_signal&#40;...&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Resource/Signals.pm line 295

POE is trying to defer SIGCHLD by sending an event as part

[...]

POE::Kernel::sig&#40;&#39;POE::Kernel=ARRAY&#40;0x2f16730&#41;&#39;, &#39;CHLD&#39;, &#39;CHLD&#39;&#41; called
at ./ftpserver.pl line 314

Your ftpserver.pl program is calling sig&#40;&#41; to handle SIGCHLD at line
314.  Something about the way you&#39;re calling it may be an issue.  If you
can&#39;t show your whole ftpserver.pl program, then I recommend looking
around there for the issue.

[...]

POE::Kernel::call&#40;...&#41; called at
/usr/lib64/perl5/vendor_perl/5.12.3/POE/Component/Daemon.pm line 700

The problem may have something to do with POE::Component::Daemon.  You
might be able to isolate the problem by focusing on that module&#39;s usage.

I can&#39;t help more than that without more information.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1012028" href="/Public/Bug/Display.html?id=67680#txn-1012028">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;15&nbsp;14:55:43&nbsp;2011</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1012028/527566/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/527566">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 195b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This ticket is at an impasse.  Downgrading to &#34;stalled&#34;.  It may be rejected in the future unless 
the requester &#40;and/or other people&#41; provides enough information to make headway on the 
problem.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1012031" href="/Public/Bug/Display.html?id=67680#txn-1012031">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;15&nbsp;14:55:46&nbsp;2011</span>
    <span class="description">RCAPUTO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1033653" href="/Public/Bug/Display.html?id=67680#txn-1033653">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;06&nbsp;19:12:16&nbsp;2012</span>
    <span class="description">troy [...] good.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> troy [...] good.net</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1033653/539374/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/539374">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 406b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for stalling on this so long.  It&#39;s been easier just to keep
pushing this problem aside and stay on the old version of POE but
finally actively set aside some time for this.

Attached is a minimal demo that demostrates the regression


== 1.289 ==
# ./poe-breaker.pl 
warble
warble
warble
warble
warble
EOF at ./poe-breaker.pl line 32.

== 1.350 ==
# ./poe-breaker.pl 
&lt;hang with no output until ^C&gt;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> poe-breaker.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1033653/539375/poe-breaker.pl">Download poe-breaker.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl

package main;

use warnings;
use strict;
use POE;
use POE::Filter::Stream;
use POE::Wheel::ReadWrite;


POE::Session-&gt;create&#40;
	inline_states =&gt; {
		_start  =&gt; sub {
			my $fh = do { no warnings; local *FH };

			tie $fh, &#39;ReadHandle&#39;;

			$_[HEAP]-&gt;{octagon} = POE::Wheel::ReadWrite-&gt;new&#40;
				Handle =&gt; $fh,
				Filter =&gt; POE::Filter::Stream-&gt;new&#40;&#41;,
				InputEvent =&gt; &#39;file_input&#39;,
				ErrorEvent =&gt; &#39;file_error&#39;,
			&#41;;
		},

		file_input =&gt; sub {
			print $_[ARG0];
		},

		file_error =&gt; sub {
			warn &#34;EOF&#34;;
			delete $_[HEAP]-&gt;{octagon};
		}
	}
&#41;;

$poe_kernel-&gt;run&#40;&#41;;



package ReadHandle;
use warnings;
use strict;

use IO::File;

sub TIEHANDLE {
	my $class = shift;

	my $devzero  = IO::File-&gt;new;
	$devzero-&gt;open&#40;&#34;&lt; /dev/zero&#34;&#41;;

	my $self = { devzero =&gt; $devzero };

	bless $self, $class;
	return $self;
}

sub FILENO {
	return $_[0]-&gt;{devzero}-&gt;fileno;
}

{ # closures are fun
	my $times = 0;
	sub READ {
		my $buff = \$_[1];
		if &#40;$times++ &gt;= 5&#41; {
			return undef;
		} else {
			$$buff = &#34;warble\n&#34;;
			return 7;
		}
	}
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1033655" href="/Public/Bug/Display.html?id=67680#txn-1033655">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;06&nbsp;19:12:18&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1048670" href="/Public/Bug/Display.html?id=67680#txn-1048670">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;10&nbsp;17:43:53&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1048670/548135/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/548135">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 155b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I don&#39;t know why yet, but it works much better when you have C&lt;Handle =&gt; \$fh&gt;.  That is, 
pass in a reference to the filehandle glob; not the glob itself.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1048673" href="/Public/Bug/Display.html?id=67680#txn-1048673">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;10&nbsp;17:46:04&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1048673/548138/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/548138">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 120b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Alternatively:

      use Symbol qw&#40;gensym&#41;; my $fh = gensym&#40;&#41;;
      tie *$fh, &#39;ReadHandle&#39;;

...

      Handle =&gt; $fh,
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1048676" href="/Public/Bug/Display.html?id=67680#txn-1048676">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;10&nbsp;17:47:20&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1048676/548141/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/548141">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 82b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The issue is purely Perl:  One can&#39;t call $fh-&gt;blocking&#40;0&#41; on the $fh you&#39;ve made.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1048911" href="/Public/Bug/Display.html?id=67680#txn-1048911">#</a>      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;11&nbsp;11:36:35&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1048911/548322/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/548322">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 572b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">All that said, I was able to find a work-around that won&#39;t require you to change code.  This will 
be in 1.351.

commit 2dceb43e64faba7df175bdf9ffc0dda7648f0fb6
Author: Rocco Caputo &lt;rcaputo@cpan.org&gt;
Date:   Sun Mar 11 11:32:46 2012 -0400

    [rt.cpan.org 67680] Use IO::Handle::blocking&#40;&#41; rather than $fh-&gt;blocking&#40;&#41;.
    
    Some file handles, such as my $fh = do { no warnings; local *FH };
    can&#39;t be used as IO::Handle objects.  IO::Handle::blocking&#40;$fh&#41; seems
    to work, though.
    
    This was caught by Troy, who was nice enough to open the bug.  Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1048914" href="/Public/Bug/Display.html?id=67680#txn-1048914">#</a>      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;11&nbsp;11:36:37&nbsp;2012</span>
    <span class="description">RCAPUTO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.67135</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
