<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #4390 for String-Approx: perl 5.8.1 core dump using String::Approx version 3.22</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #4390 for String-Approx: perl 5.8.1 core dump using String::Approx version 3.22</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=String-Approx">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=String-Approx">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=String-Approx">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=String-Approx">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/String-Approx">String-Approx CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">4390</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=String-Approx">String-Approx</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
idallen [...] idallen.ca

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-29878-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
3.22    </td>
  </tr>
  <tr id="CF-29879-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
3.23    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=4390">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91547" href="/Public/Bug/Display.html?id=4390#txn-91547">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;14&nbsp;03:55:07&nbsp;2003</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> perl 5.8.1 core dump using String::Approx version 3.22</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91547/13566/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13566">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 984b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The file &#34;test.pl.txt&#34; is at: <span class="clickylink"><a target="new" rel="nofollow" href="http://ian.idallen.ca/test.pl.txt">http://ian.idallen.ca/test.pl.txt</a></span>
The file &#34;input.txt&#34;   is at: <span class="clickylink"><a target="new" rel="nofollow" href="http://ian.idallen.ca/input.txt">http://ian.idallen.ca/input.txt</a></span>

$ gdb /usr/bin/perl 
GNU gdb 5.3-25mdk &#40;Mandrake Linux&#41;
This GDB was configured as &#34;i586-mandrake-linux-gnu&#34;...
&#40;no debugging symbols found&#41;...
&#40;gdb&#41; run -w ~/public_html/test.pl.txt ~/public_html/input.txt 
Starting program: /usr/bin/perl -w ~/public_html/test.pl.txt ~/public_html/input.txt
&#40;no debugging symbols found&#41;...&#40;no debugging symbols found&#41;...
&#40;no debugging symbols found&#41;...&#40;no debugging symbols found&#41;...
&#40;no debugging symbols found&#41;...&#40;no debugging symbols found&#41;...
&#40;no debugging symbols found&#41;...&#40;no debugging symbols found&#41;...
Total questions read: 7
DEBUG1 6
DEBUG2 6
DEBUG3 6
&#40;no debugging symbols found&#41;...
Program received signal SIGSEGV, Segmentation fault.
0x4027cc64 in mallopt &#40;&#41; from /lib/i686/libc.so.6
&#40;gdb&#41; where
#0  0x4027cc64 in mallopt &#40;&#41; from /lib/i686/libc.so.6
#1  0x4027c58a in calloc &#40;&#41; from /lib/i686/libc.so.6
&#40;gdb&#41; 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91548" href="/Public/Bug/Display.html?id=4390#txn-91548">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;17&nbsp;16:17:51&nbsp;2003</span>
    <span class="description">jhi [...] iki.fi -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jarkko.Hietaniemi &lt;jhi [...] iki.fi&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #4390] perl 5.8.1 core dump using String::Approx version 3.22 </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Nov 2003 23:17:16 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-String-Approx [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91548/13630/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13630">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 347b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m afraid this will require a bit more debugging from your side
since I have no problems with test script and input in Mac OS X
with 5.8.2, with either normal Perl and and Perl compiled with -g.

-- 
Jarkko Hietaniemi &lt;jhi@iki.fi&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.iki.fi/jhi/">http://www.iki.fi/jhi/</a></span> &#34;There is this 
special
biologist word we use for &#39;stable&#39;.  It is &#39;dead&#39;.&#34; -- Jack Cohen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91550" href="/Public/Bug/Display.html?id=4390#txn-91550">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;28&nbsp;00:07:25&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/91550/13933/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13933">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 495b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m afraid this will require a bit more debugging from your side
&gt; since I have no problems with test script and input in Mac OS X
&gt; with 5.8.2, with either normal Perl and and Perl compiled with -g.
</div>
I compiled perl 5.8.2 &#40;i586&#41; and ran the same example.  Core dump.

I moved the examples and some &#34;strace&#34; outputs to:

    <span class="clickylink"><a target="new" rel="nofollow" href="http://ian.idallen.ca/perltextbug/">http://ian.idallen.ca/perltextbug/</a></span>

I give a larger program and larger example that also core dumps.
&#40;The larger program was the one where I first noticed the problem.&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91551" href="/Public/Bug/Display.html?id=4390#txn-91551">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;28&nbsp;02:48:06&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/91551/13935/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13935">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I compiled perl 5.8.2 &#40;i586&#41; and ran the same example.
</div>
So I recompiled perl 5.8.2 using just the distribution defaults &#40;no
added Mandrake options such as &#34;i386-linux-thread-multi&#34;&#41;.  Now, perl
runs the small test program with both large and small input files without
core dumps.  It runs the large program with the small input file.  But,
it still core dumps on the big program and the big input file:

    $ ./bigtest.pl.txt ./biginput.txt
    Total questions read: 110
    Segmentation fault &#40;core dumped&#41;
    134.410u 0.090s 2:47.19 80.4%   0+0k 0+0io 406pf+0w
    Exit 139
    $ ls -l core.2826
    -rw-------    1 idallen  idallen  127188992 Nov 28 02:15 core.2826

I got a bigger GDB trace this time &#40;this perl wasn&#39;t stripped&#41;:

    &#40;gdb&#41; where
    #0  0x40105c64 in mallopt &#40;&#41; from /lib/i686/libc.so.6
    #1  0x4010558a in calloc &#40;&#41; from /lib/i686/libc.so.6
    #2  0x40023b3f in apse_set_edit_distance &#40;&#41;
       from
/usr/local/lib/perl5/site_perl/5.8.2/i686-linux/auto/String/Approx/Approx.so
    #3  0x40024db7 in _apse_match &#40;&#41;
       from
/usr/local/lib/perl5/site_perl/5.8.2/i686-linux/auto/String/Approx/Approx.so
    #4  0x40023dbb in apse_slice &#40;&#41;
       from
/usr/local/lib/perl5/site_perl/5.8.2/i686-linux/auto/String/Approx/Approx.so
    #5  0x400218be in XS_String__Approx_slice &#40;&#41;
       from
/usr/local/lib/perl5/site_perl/5.8.2/i686-linux/auto/String/Approx/Approx.so
    #6  0x080c600e in Perl_pp_entersub &#40;&#41;
    #7  0x080bf86d in Perl_runops_standard &#40;&#41;
    #8  0x080616bb in perl_run &#40;&#41;
    #9  0x0805e327 in main &#40;&#41;
    #10 0x400a8c57 in __libc_start_main &#40;&#41; from /lib/i686/libc.so.6

I&#39;ll add some of this to the typescript.txt file, along with another
strace output file &#40;trace8.txt&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91552" href="/Public/Bug/Display.html?id=4390#txn-91552">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;28&nbsp;14:16:45&nbsp;2003</span>
    <span class="description">jhi [...] iki.fi -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jarkko.Hietaniemi &lt;jhi [...] iki.fi&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #4390] perl 5.8.1 core dump using String::Approx version 3.22</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Nov 2003 21:16:10 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-String-Approx [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91552/13954/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13954">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 664b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     &#40;gdb&#41; where
&gt;     #0  0x40105c64 in mallopt &#40;&#41; from /lib/i686/libc.so.6
&gt;     #1  0x4010558a in calloc &#40;&#41; from /lib/i686/libc.so.6
&gt;     #2  0x40023b3f in apse_set_edit_distance &#40;&#41;
&gt;        from
&gt; /usr/local/lib/perl5/site_perl/5.8.2/i686-linux/auto/String/Approx/ 
&gt; Approx.so
&gt;     #3  0x40024db7 in _apse_match &#40;&#41;
</div>
If you could compile a Perl with -Doptimize=-g and reinstall also  
String::Approx
with OPTIMIZE=-g so that we could see the exact line of  
apse_set_edit_distance&#40;&#41;
the crash happens at.

-- 
Jarkko Hietaniemi &lt;jhi@iki.fi&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.iki.fi/jhi/">http://www.iki.fi/jhi/</a></span> &#34;There is this  
special
biologist word we use for &#39;stable&#39;.  It is &#39;dead&#39;.&#34; -- Jack Cohen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91554" href="/Public/Bug/Display.html?id=4390#txn-91554">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;28&nbsp;15:42:04&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/91554/13956/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13956">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 573b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you could compile a Perl with -Doptimize=-g and reinstall also  
&gt; String::Approx
&gt; with OPTIMIZE=-g so that we could see the exact line of  
&gt; apse_set_edit_distance&#40;&#41;
&gt; the crash happens at.
</div>
Before running the big program and the big file, I used valgrind to check
the small program.  Even though the program ran to completion, valgrind
found some memory access errors.  See:

   <span class="clickylink"><a target="new" rel="nofollow" href="http://ian.idallen.ca/perltextbug/README-valgrind.txt">http://ian.idallen.ca/perltextbug/README-valgrind.txt</a></span>

After the warnings about the C library are a few thousand warnings about
&#34;Invalid read&#34; and &#34;Invalid write&#34; by the string library.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91555" href="/Public/Bug/Display.html?id=4390#txn-91555">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;28&nbsp;16:14:22&nbsp;2003</span>
    <span class="description">jhi [...] iki.fi -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jarkko.Hietaniemi &lt;jhi [...] iki.fi&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #4390] perl 5.8.1 core dump using String::Approx version 3.22</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Nov 2003 23:13:48 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-String-Approx [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91555/13957/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13957">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 202b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Okay, thanks, the valgrind errors are a good find.

-- 
Jarkko Hietaniemi &lt;jhi@iki.fi&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.iki.fi/jhi/">http://www.iki.fi/jhi/</a></span> &#34;There is this 
special
biologist word we use for &#39;stable&#39;.  It is &#39;dead&#39;.&#34; -- Jack Cohen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91556" href="/Public/Bug/Display.html?id=4390#txn-91556">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;28&nbsp;16:47:26&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/91556/13958/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13958">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 338b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Okay, thanks, the valgrind errors are a good find.
</div>
I&#39;ve uploaded some other runs of valgrind using the small test program:

  README-valgrind2.txt 
  README-valgrind3.txt 

I&#39;m running a valgrind of the big program on the big input file; that may
take a few hours to finish.  I&#39;ll also do the big prorgram on the small
input file too.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91557" href="/Public/Bug/Display.html?id=4390#txn-91557">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;28&nbsp;23:12:59&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> idallen [...] idallen.ca</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91557/13960/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13960">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 902b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m running a valgrind of the big program on the big input file; that may
&gt; take a few hours to finish.
</div>
After three hours, it finished:

   README-valgrind5.txt

&#40;The program finished! No core dump.&#41;

I ran the same big program with the same big input file but no valgrind:

   README-g.txt

The program core dumped.  As is so often the case with memory errors,
running the program with memory debugging on produced different results
than running without memory debugging.

Knowing nothing about the code, I simply went to where valgrind said the
memory was allocated in apse_set_edit_distance &#40;apse.c:451&#41; and added
one to the first argument to calloc&#40;&#41; and four to the second.

I re-ran the small program against the small input file and got zero
memory errors.  I ran the big program against the big input file without
valgrind &#40;this caused the core dump, above&#41; and it worked fine.

Over to you!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91558" href="/Public/Bug/Display.html?id=4390#txn-91558">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;30&nbsp;04:05:16&nbsp;2003</span>
    <span class="description">jhi [...] iki.fi -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jarkko Hietaniemi &lt;jhi [...] iki.fi&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #4390] perl 5.8.1 core dump using String::Approx version 3.22</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 30 Nov 2003 11:04:42 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-String-Approx [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91558/13988/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13988">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 496b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#40;After some debugging with valgrind&#41;

This is very curious.  I do see the same errors with valgrind -- but 
when
I try to pin them down they are very elusive.  If I set up an assertion 
to
the &#34;reset loop&#34; claimed to be doing the naughty memory accesses, the 
assertion
never fails, i.e. the index never points outside the calloc&#40;&#41;ated 
area...

-- 
Jarkko Hietaniemi &lt;jhi@iki.fi&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.iki.fi/jhi/">http://www.iki.fi/jhi/</a></span> &#34;There is this 
special
biologist word we use for &#39;stable&#39;.  It is &#39;dead&#39;.&#34; -- Jack Cohen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91559" href="/Public/Bug/Display.html?id=4390#txn-91559">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;30&nbsp;04:09:48&nbsp;2003</span>
    <span class="description">jhi [...] iki.fi -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jarkko Hietaniemi &lt;jhi [...] iki.fi&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #4390] perl 5.8.1 core dump using String::Approx version 3.22</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 30 Nov 2003 11:09:13 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-String-Approx [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91559/13989/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13989">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 228b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Scratch my assertion assertion -- I can get it to fail now.  Diving 
back...

-- 
Jarkko Hietaniemi &lt;jhi@iki.fi&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.iki.fi/jhi/">http://www.iki.fi/jhi/</a></span> &#34;There is this 
special
biologist word we use for &#39;stable&#39;.  It is &#39;dead&#39;.&#34; -- Jack Cohen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91560" href="/Public/Bug/Display.html?id=4390#txn-91560">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;30&nbsp;12:26:43&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> idallen [...] idallen.ca</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/91560/13999/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/13999">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 155b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Your mailbox is full:

&#40;host mail.iki.fi[212.16.100.1] said: 452 4.4.5 Insufficient disk space;
try again later &#40;in reply to MAIL FROM command&#41;&#41; jhi@iki.fi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91561" href="/Public/Bug/Display.html?id=4390#txn-91561">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;02&nbsp;13:01:16&nbsp;2003</span>
    <span class="description">JHI [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-91562" href="/Public/Bug/Display.html?id=4390#txn-91562">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;02&nbsp;13:01:16&nbsp;2003</span>
    <span class="description">JHI [...] cpan.org -  Fixed in 3.23 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.302427</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
