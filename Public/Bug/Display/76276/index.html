<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76276 for SQL-Statement: support 0-column input tables?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76276 for SQL-Statement: support 0-column input tables?</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/SQL-Statement/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/SQL-Statement/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/SQL-Statement/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/SQL-Statement/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/SQL-Statement">SQL-Statement CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76276</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">stalled</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/SQL-Statement/Active/">SQL-Statement</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
reinpost [...] win.tue.nl

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-29588-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29589-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




csvsql<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1059219/554451/csvsql">
Thu Apr 05 09:54:29 2012 (2k) by reinpost [...] win.tue.nl
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;03&nbsp;09:53:19&nbsp;2012</span>
    <span class="description">reinpost [...] win.tue.nl -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> support 0-column input tables?</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is not a bug report, but a suggestion.

I have a script, csvsql, that implements a DBD::CSV-based equivalent of 
join, the standard Unix utility.  Example use:

   csvsql -e &#39;SELECT * FROM t1 NATURAL JOIN t2&#39; a.csv b.csv &gt; ab.csv

This will crash when either input file is empty.

Arguably, an input file is a valid CSV file with 0 columns, and that is 
in fact how I would like to be able to treat it in many use cases for my 
script.

So this is a suggestion to add the option to support the recognition of 
0-column CSV files.  When enabled, and the first record fails on end-of-
file, that is no longer an error but instead completes successfully, 
leaving a 0-column table.

Only do this when DBI in general can deal with 0-column tables.  
&#40;Perhaps there exist some fundamental issues with it elsewhere that I&#39;m 
not aware of.&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;04&nbsp;12:55:13&nbsp;2012</span>
    <span class="description">rehsack [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76276] support 0-column input tables?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 4 Apr 2012 17:55:03 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-CSV [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jens Rehsack &lt;rehsack [...] googlemail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 3. April 2012 14:53 schrieb Reinier Post via RT &lt;bug-DBD-CSV@rt.cpan.org&gt;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue Apr 03 09:53:19 2012: Request 76276 was acted upon.
&gt; Transaction: Ticket created by rpost
&gt;       Queue: DBD-CSV
&gt;     Subject: support 0-column input tables?
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: &#40;no value&#41;
&gt;       Owner: Nobody
&gt;  Requestors: reinpost@win.tue.nl
&gt;      Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76276">https://rt.cpan.org/Ticket/Display.html?id=76276</a></span> &gt;
&gt;
&gt;
&gt; This is not a bug report, but a suggestion.
&gt;
&gt; I have a script, csvsql, that implements a DBD::CSV-based equivalent of
&gt; join, the standard Unix utility.  Example use:
&gt;
&gt;   csvsql -e &#39;SELECT * FROM t1 NATURAL JOIN t2&#39; a.csv b.csv &gt; ab.csv
&gt;
&gt; This will crash when either input file is empty.
&gt;
&gt; Arguably, an input file is a valid CSV file with 0 columns, and that is
&gt; in fact how I would like to be able to treat it in many use cases for my
&gt; script.
&gt;
&gt; So this is a suggestion to add the option to support the recognition of
&gt; 0-column CSV files.  When enabled, and the first record fails on end-of-
&gt; file, that is no longer an error but instead completes successfully,
&gt; leaving a 0-column table.
&gt;
&gt; Only do this when DBI in general can deal with 0-column tables.
&gt; &#40;Perhaps there exist some fundamental issues with it elsewhere that I&#39;m
&gt; not aware of.&#41;
</div>
Merjin,

can you throw it over into SQL::Statement Queue? It&#39;s reasonable to
handle it there.

Best regards,
Jens
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;04&nbsp;12:55:15&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;05&nbsp;03:20:28&nbsp;2012</span>
    <span class="description">h.m.brand [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76276] support 0-column input tables?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 5 Apr 2012 09:20:08 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Jens Rehsack &lt;rehsack [...] googlemail.com&gt;, bug-DBD-CSV [...] rt.cpan.org, DBI Developers Mailing List &lt;dbi-dev [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, 4 Apr 2012 12:55:14 -0400, &#34;Jens Rehsack via RT&#34;
&lt;bug-DBD-CSV@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Merjin,
</div>
By now, you&#39;d know how not to switch the i and j, right?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; can you throw it over into SQL::Statement Queue? It&#39;s reasonable to
&gt; handle it there.
</div>
Sure. I thought it would be DBD::File, as the *file* is empty and thus
would do the same for all DBD::File related DBD&#39;s. It might even
warrant a new attribute to allow this as normally in DBI a table always
has columns &#40;but not always rows&#41;. If a file is empty, it doesn&#39;t even
have columns. Not all databases allow the creation of &#34;empty&#34; tables, as
in a table with no rows at all. Postgres does, but Unify and Oracle do
not.

I have included the devel list to see how others think

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Best regards,
&gt; Jens
</div>
-- 
H.Merijn Brand  <span class="clickylink"><a target="new" rel="nofollow" href="http://tux.nl">http://tux.nl</a></span>   Perl Monger  <span class="clickylink"><a target="new" rel="nofollow" href="http://amsterdam.pm.org/">http://amsterdam.pm.org/</a></span>
using perl5.00307 .. 5.14   porting perl5 on HP-UX, AIX, and openSUSE
<span class="clickylink"><a target="new" rel="nofollow" href="http://mirrors.develooper.com/hpux/">http://mirrors.develooper.com/hpux/</a></span>        <span class="clickylink"><a target="new" rel="nofollow" href="http://www.test-smoke.org/">http://www.test-smoke.org/</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://qa.perl.org">http://qa.perl.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.goldmark.org/jeff/stupid-disclaimers/">http://www.goldmark.org/jeff/stupid-disclaimers/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;05&nbsp;04:03:02&nbsp;2012</span>
    <span class="description">rehsack [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> dbi-dev [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76276] support 0-column input tables?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 05 Apr 2012 10:02:35 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-CSV [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jens Rehsack &lt;rehsack [...] googlemail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 05.04.2012 09:20, schrieb h.m.brand@xs4all.nl via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: DBD-CSV
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76276">https://rt.cpan.org/Ticket/Display.html?id=76276</a></span> &gt;
&gt; 
&gt; On Wed, 4 Apr 2012 12:55:14 -0400, &#34;Jens Rehsack via RT&#34;
&gt; &lt;bug-DBD-CSV@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt;&gt; Merjin,
</div>&gt; 
&gt; By now, you&#39;d know how not to switch the i and j, right?
</div>
*whistl*

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; can you throw it over into SQL::Statement Queue? It&#39;s reasonable to
&gt;&gt; handle it there.
</div>&gt; 
&gt; Sure. I thought it would be DBD::File, as the *file* is empty and thus
&gt; would do the same for all DBD::File related DBD&#39;s.
</div>
I do not expect that any DBD::* code is involved in the bug - but
probably it&#39;s an non-instantiated table. I try to create a small
test case and if I can&#39;t figure out what#s going wrong, I ask the
originator for more details ...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It might even
&gt; warrant a new attribute to allow this as normally in DBI a table always
&gt; has columns &#40;but not always rows&#41;. If a file is empty, it doesn&#39;t even
&gt; have columns. Not all databases allow the creation of &#34;empty&#34; tables, as
&gt; in a table with no rows at all. Postgres does, but Unify and Oracle do
&gt; not.
</div>
Well, if the table is created with columns specified, you&#39;re right.
If the originator wants the columns guessed from an empty b.csv, you&#39;re
wrong from my point of view. DBD::CSV is special &#40;as some DBD::AnyData,
too&#41;, because it &#34;guesses&#34; columns from data file.

Probably an $dbh attribute &#34;f_default_columns&#34; can help out, but before
we think further let me dig out the root cause ;&#41;

I&#39;m a bit busy with communion of my younger dauther until end of April
and then something to clarify with our house renter - I expect I can
invest larger blocks of time in mid of May. I hope I can create a
test case before ...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have included the devel list to see how others think
</div>
So did I - good suggestion.

Best,
Jens
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;05&nbsp;05:29:35&nbsp;2012</span>
    <span class="description">HMBRAND [...] cpan.org -  Queue changed from DBD-CSV to SQL-Statement</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;05&nbsp;09:54:29&nbsp;2012</span>
    <span class="description">reinpost [...] win.tue.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> reinpost [...] win.tue.nl</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Apr 05 04:03:02 2012, rehsack@googlemail.com wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Well, if the table is created with columns specified, you&#39;re right.
&gt; If the originator wants the columns guessed from an empty b.csv, you&#39;re
&gt; wrong from my point of view. DBD::CSV is special &#40;as some DBD::AnyData,
&gt; too&#41;, because it &#34;guesses&#34; columns from data file.
</div>
True - this hadn&#39;t occurred to me.

By default, DBD::CSV will read its column names from the first input
line by default - so even without any columns, it should expect an
&#40;empty&#41; first line. And this actually works - see the test output below.
 But the empty file is still unexpected as input.

Only when asked to *infer* its column names should we expect it to
accept the empty file as a valid 0-column input file.  It doesn&#39;t, and
this is something that might be fixed.

Here are my tests &#40;the script is attached&#41;:

/tmp % sh
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sh&gt; : &gt; empty.csv; echo &gt; emptyline.csv
sh&gt; csvsql -e &#39;SELECT * FROM t1&#39; emptyline.csv
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sh&gt; csvsql -e &#39;SELECT * FROM t1&#39; empty.csv
</div>DBD::CSV::st execute failed: 
Execution ERROR: Missing first row due to EOF - End of data in parsing
input stream at /usr/lib/perl5/site_perl/5.10/i686-cygwin/DBD/File.pm
line 730
.

 [for Statement &#34;SELECT * FROM t1&#34;] at /cygdrive/f/scripts/squimp/csvsql
line 80.
fatal error: SQL statement execution failed: 
Execution ERROR: Missing first row due to EOF - End of data in parsing
input stream at /usr/lib/perl5/site_perl/5.10/i686-cygwin/DBD/File.pm
line 730
.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sh&gt; csvsql -ae &#39;SELECT * FROM t1&#39; emptyline.csv
</div>DBD::CSV::st execute failed: 
Execution ERROR: Can&#39;t call method &#34;getline&#34; on an undefined value at
/usr/lib/perl5/site_perl/5.10/DBD/CSV.pm line 433.
.

 [for Statement &#34;SELECT * FROM t1&#34;] at /cygdrive/f/scripts/squimp/csvsql
line 80.
fatal error: SQL statement execution failed: 
Execution ERROR: Can&#39;t call method &#34;getline&#34; on an undefined value at
/usr/lib/perl5/site_perl/5.10/DBD/CSV.pm line 433.
.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sh&gt;
</div></div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> csvsql</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1059219/554451/csvsql">Download csvsql</a><br />
<span class="downloadcontenttype">application/octet-stream 2k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;05&nbsp;16:30:56&nbsp;2012</span>
    <span class="description">darren [...] DarrenDuncan.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Jens Rehsack &lt;rehsack [...] googlemail.com&gt;, bug-DBD-CSV [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76276] support 0-column input tables?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 05 Apr 2012 13:30:35 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;, DBI Developers Mailing List &lt;dbi-dev [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Darren Duncan &lt;darren [...] darrenduncan.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">H.Merijn Brand wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed, 4 Apr 2012 12:55:14 -0400, &#34;Jens Rehsack via RT&#34;
<div class="message-stanza open">&gt;&gt; can you throw it over into SQL::Statement Queue? It&#39;s reasonable to
&gt;&gt; handle it there.
</div>&gt; 
&gt; Sure. I thought it would be DBD::File, as the *file* is empty and thus
&gt; would do the same for all DBD::File related DBD&#39;s. It might even
&gt; warrant a new attribute to allow this as normally in DBI a table always
&gt; has columns &#40;but not always rows&#41;. If a file is empty, it doesn&#39;t even
&gt; have columns. Not all databases allow the creation of &#34;empty&#34; tables, as
&gt; in a table with no rows at all. Postgres does, but Unify and Oracle do
&gt; not.
&gt; 
&gt; I have included the devel list to see how others think
</div>
Damn right that tables/rows/etc with zero columns should be supported!

All SQL or relational databases should support zero-column tables/rows.

Those are very important to *the* relational model.

For example, with &#40;natural&#41; join operations &#40;or product or intersect&#41;, the 
zero-column table is analogous to the number 1 if it has one row and to the 
number 0 if it has none; the one-row version is the identity value for join.

Or, if you define a unique/key constraint that ranges over zero columns, that is 
a simple way to restrict the table to having at most one row, which is useful 
say if you want to have a table storing singleton information.

Practically speaking, supporting zero-column tables/rows just makes sense, it 
makes as much sense as supporting Perl array or hash variables that are allowed 
to be empty, or allowing empty sets, which are identity values for set unions or 
hash/array catenation.

 From DBI&#39;s perspective, as we use Array/Hash to represent rows, it is just the 
empty one of those to represent the zero-column one.

Suffice it to say, if even one DBMS supports this, DBI should too, and this is 
an example others can follow.

-- Darren Duncan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;09:49:17&nbsp;2012</span>
    <span class="description">REHSACK [...] cpan.org -  Severity Wishlist added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;09:49:17&nbsp;2012</span>
    <span class="description">REHSACK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
