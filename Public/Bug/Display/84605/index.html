<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #84605 for App-ArchiveDevelCover: Request inclusion of branch and condition coverage in archive reports</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #84605 for App-ArchiveDevelCover: Request inclusion of branch and condition coverage in archive reports</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/App-ArchiveDevelCover/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/App-ArchiveDevelCover/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/App-ArchiveDevelCover/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/App-ArchiveDevelCover/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/App-ArchiveDevelCover">App-ArchiveDevelCover CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">84605</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/App-ArchiveDevelCover/Active/">App-ArchiveDevelCover</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jkeenan [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
paul [...] pjcj.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-242550-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.002    </td>
  </tr>
  <tr id="CF-242551-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;13&nbsp;05:47:04&nbsp;2013</span>
    <span class="description">jkeenan [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> paul [...] pjcj.net</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Request inclusion of branch and condition coverage in archive reports</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Domm,

Sitting here at the 2013 Perl QA Hackathon in Lancaster.  Sitting across from pjcj.  Talking about how to improve cpancover.pm and how to obtain and report coverage of the Perl 5 core distribution.

Which led me to &#40;finally!&#41; install App-ArchiveDevelCover, about which I hears you speak at the DC-Baltimore Perl Workshop last April &#40;and where I&#39;m speaking next weekend&#41;.

So I gave archive_devel_cover.pl a whirl.  Two points:

1. It would be good to include in the documentation a reminder that you must do &#39;cover -delete&#39; between runs of Devel::Cover and archive_devel_cover.pl.  Otherwise, the latter program says, &#34;This coverage report has already been archived.&#34;

2. More importantly, archive_devel_cover.pl appears to be hard-wired to report only statement, sub and total percentages.  It omits branch and condition coverage -- which I rely heavily on -- as well as Pod and time coverage -- which I personally don&#39;t use.

It would really be good to allow the user the same flexibility with respect to the types of coverage archived that she has when using Devel::Cover itself.  If, however, that is not feasible, then the archive_devel_cover.pl should report all the types of coverage that the user requested when running Devel::Cover over the code base.

See, for example:  <span class="clickylink"><a target="new" rel="nofollow" href="http://thenceforward.net/Data-Dumper/archive/">http://thenceforward.net/Data-Dumper/archive/</a></span>, where I tried out archive_devel_cover.pl for the very first time.

Why would this be valuable?  Two reasons:

a. When I&#39;m trying to boost the coverage of a module, the last, most difficult steps are the tests I write to boost branch and condition coverage.  Right now, when I do a new Devel::Cover run, I have to look at my web site to see the totals for the *previous* cover run, then refresh the browser to see the improvements from the *latest* run.  In the later stages of a coverage-improvement project, I&#39;ve often got all the statement coverage I can possibly get on a given OS, so what I&#39;m looking for are incremental improvements in branch and condition coverage.

b. Here at the hackathon we are discussing how to report test coverage of the Perl 5 core distribution on an ongoing basis.  That would include &#39;gcov&#39; running on the C code and Devel::Cover running on all the Perl modules in cpan/, dist/, ext/, lib/, etc.  We&#39;ll certainly be able to get branch and condition coverage on all the .pm files using Devel::Cover, but it would be very useful as well to be able to track changes in those coverage categories between monthly releases of, say, Perl 5.19.

So, can you give us an idea as to whether archiving of branch and condition coverage is feasible and might be forthcoming?

Thank you very much.
Jim Keenan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;13&nbsp;08:27:18&nbsp;2013</span>
    <span class="description">domm [...] plix.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84605] Request inclusion of branch and condition coverage in archive reports</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 13 Apr 2013 14:27:35 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> James E Keenan via RT &lt;bug-App-ArchiveDevelCover [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Thomas Klausner &lt;domm [...] plix.at&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi!

On Sat, Apr 13, 2013 at 05:47:04AM -0400, James E Keenan via RT wrote:
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Which led me to &#40;finally!&#41; install App-ArchiveDevelCover, about which 
&gt; I hears you speak at the DC-Baltimore Perl Workshop last April &#40;and 
&gt; where I&#39;m speaking next weekend&#41;.
</div>
That was a very nice workshop! And would really like to visit NY again, 
we had a lovely time there...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 1. It would be good to include in the documentation a reminder that 
&gt; you must do &#39;cover -delete&#39; between runs of Devel::Cover and 
&gt; archive_devel_cover.pl.  Otherwise, the latter program says, &#34;This 
&gt; coverage report has already been archived.&#34;
</div>
ok, I wasn&#39;t really aware of that. I usually always delete the old 
coverage report &#40;at least for the project I wrote A-ADC for&#41;, because 
merging coverage takes ages.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2. More importantly, archive_devel_cover.pl appears to be hard-wired 
&gt; to report only statement, sub and total percentages.  It omits branch 
&gt; and condition coverage -- which I rely heavily on -- as well as Pod 
&gt; and time coverage -- which I personally don&#39;t use.
</div>
Yes, I decideed to do that this way for a better overview.

But I agree on all the reasons to provide why including them might be a 
good idea.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So, can you give us an idea as to whether archiving of branch and 
&gt; condition coverage is feasible and might be forthcoming?
</div>
That would be quite easy. I would just need to extract more cols from 
the coverage table, and add those cols to the report.
Of course some kind of user interface/config file would be needed.
And it would make a great deal of sense to use the actual database 
instead of mucking around in the generated HTML...

We currently have the first sunny weekend in Vienna &#40;yay!&#41;, so I wont 
spend much time at the laptop. But if you want to submit a patch/pull 
request, I will most likley merge it. Or I will take a look at 
refactoring the code next week.

If you want to give it a try, please note that the code just grew from a 
quick hack and thus includes a lot of inlined HTML. And adding a new 
report is done by splicing a new line into a html table &#40;which makes it 
rather hard to add a new column&#41; - a better approach would be to rewrite 
the overview table from scratch each time &#40;which would mean we&#39;d have to 
parse the old data again..&#41;

To sum up: Yes, I&#39;d like to &#40;optionally&#41; include more of the Devel-Cover 
metrics. 

Greetings &#38; have a nice hackathon!
domm

-- 
#!/usr/bin/perl                              <span class="clickylink"><a target="new" rel="nofollow" href="http://domm.plix.at">http://domm.plix.at</a></span>
for&#40;ref bless{},just&#39;another&#39;perl&#39;hacker&#41;{s-:+-$&#34;-g&#38;&#38;print$_.$/}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;13&nbsp;08:27:18&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;13&nbsp;12:11:03&nbsp;2013</span>
    <span class="description">jkeenan [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Apr 13 08:27:18 2013, domm@plix.at wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi!
&gt; 
</div>
Domm, thanks for your response, which both Paul and I have read.

Paul observed that it would probably be easier to pull the coverage results directly from the database underneath cover_db/ than by scraping the HTML.  So my new, intermediate goal is to learn how to do that.

Let me ask you if the following is a fair characterization of what the program does *from the user&#39;s point of view* &#40;i.e., abstracting from implementation details&#41;:

##########
What does this package actually do?

On the first run, it copies the .html files
created by a run of Devel::Cover into a
subdirectory named &#39;archive/&lt;DateTime&gt;/&#39;
underneath that designated by the value of the
&#39;to&#39; option. Those files include:

    archive/&lt;DateTime&gt;/coverage.html
    archive/&lt;DateTime&gt;/blib-lib-Data-Dumper-pm.html
    archive/&lt;DateTime&gt;/blib-lib-Data-Dumper-pm--branch.html
    archive/&lt;DateTime&gt;/blib-lib-Data-Dumper-pm--condition.html
    archive/&lt;DateTime&gt;/blib-lib-Data-Dumper-pm--subroutine.html

It also creates the first version of the archive
summary .html file:

    archive/index.html

On the second run, it creates another
&#39;archive/&lt;2nd_DateTime&gt;/&#39; subdirectory and copies
the 5 .html files into it. It then updates
&#39;archive/index.html&#39; by adding the percentages
from the second run to the top of the chart. In
addition, it creates the first instance of the
diff .html file:

    archive/&lt;2nd_DateTime&gt;/diff.html

On the third and subsequent runs, it presumably &#40;I
haven&#39;t tried this yet&#41;, creates yet another
&#39;archive/&lt;3rd_DateTime&gt;&#39; subdirectory, copies 5
.html files into it, updates &#39;archive/index.html&#39;,
and creates the next instance of the diff .html
file:

    archive/&lt;3rd_DateTime&gt;/diff.html  # must verify directory

So, the program has the potential to store *a lot
of* .html files as well as a .diff html file for
each run of the program. Only the
&#39;archive/index.html&#39; file appears to be modified
in place -- but that is probably the most
important output file of all, as it is the one
that logs progress over time.
##########

Thank you very much.
Jim Keenan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;13&nbsp;13:54:32&nbsp;2013</span>
    <span class="description">domm [...] plix.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84605] Request inclusion of branch and condition coverage in archive reports</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 13 Apr 2013 19:54:58 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> James E Keenan via RT &lt;bug-App-ArchiveDevelCover [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Thomas Klausner &lt;domm [...] plix.at&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi!

On Sat, Apr 13, 2013 at 12:11:03PM -0400, James E Keenan via RT wrote:
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Paul observed that it would probably be easier to pull the coverage 
&gt; results directly from the database underneath cover_db/ than by 
&gt; scraping the HTML.  So my new, intermediate goal is to learn how to do 
&gt; that.
</div>
Yes, Paul already suggested that to me some time ago, but I never got 
the tuits...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Let me ask you if the following is a fair characterization of what the 
&gt; program does *from the user&#39;s point of view* &#40;i.e., abstracting from 
&gt; implementation details&#41;:
</div>
Yes, this is correct. It also writes the timestamp and the three 
coverage critieria I care into a file called archive_db. This could be 
used to regenerate the index html file.

If you have any more questions, just ask, though I&#39;m afraid I won&#39;t read 
my email again until tomorrow ~10:00. 

Greetings,
domm

-- 
#!/usr/bin/perl                              <span class="clickylink"><a target="new" rel="nofollow" href="http://domm.plix.at">http://domm.plix.at</a></span>
for&#40;ref bless{},just&#39;another&#39;perl&#39;hacker&#41;{s-:+-$&#34;-g&#38;&#38;print$_.$/}
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
