<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #34216 for CGI-Session: Safari does not handles relative expiration value for cookie</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #34216 for CGI-Session: Safari does not handles relative expiration value for cookie</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CGI-Session/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CGI-Session/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CGI-Session/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CGI-Session/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI-Session">CGI-Session CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">34216</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CGI-Session/Active/">CGI-Session</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MARKSTOS [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
angelospam [...] proofpoint.com

<br />
michael [...] summersault.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-5872-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
4.20_1    </td>
  </tr>
  <tr id="CF-5873-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;02:09:45&nbsp;2008</span>
    <span class="description">angelospam [...] proofpoint.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Safari does not handles relative expiration value for cookie</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m settings an expiration time with a relative time &#40;like &#34;+60&#34;&#41; and it
works fine in IE and Firefox, but Safari does not accept this cookie. I
found out that Safari only accept a absolute time in the format of &#34;Sat,
01-Jan-2000 01:01:01 GMT&#34;. Since this date format is accepted by all
other browsers, i would suggest the sub &#34;cookie&#34; returns this type of date..
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;09:49:58&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;09:52:54&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 19 02:09:45 2008, astar wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m settings an expiration time with a relative time &#40;like &#34;+60&#34;&#41; and it
&gt; works fine in IE and Firefox, but Safari does not accept this cookie. I
&gt; found out that Safari only accept a absolute time in the format of &#34;Sat,
&gt; 01-Jan-2000 01:01:01 GMT&#34;. Since this date format is accepted by all
&gt; other browsers, i would suggest the sub &#34;cookie&#34; returns this type of
</div>date..

I suggest you debug this further. &#34;+60&#34; gets translated into a HTTP
standard date format indicating an expiration time that is 60 seconds
from now. Since you didn&#39;t specify the units, I&#39;m not sure if that&#39;s
what you expected. The docs could be clearer that not specifying a unit
defaults to seconds, if you&#39;d like to patch them. 

To better understand the problem, I suggest that you submit a failing
Test::More style test case that illustrates that the problem. This will
confirm exactly what the issue is, and help us to address the bug if one
is found to exist. 

  Mark
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;09:52:55&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;09:52:56&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;12:12:23&nbsp;2008</span>
    <span class="description">angelospam [...] proofpoint.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> angelospam [...] proofpoint.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 19 09:52:54 2008, MARKSTOS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Mar 19 02:09:45 2008, astar wrote:
<div class="message-stanza open">&gt; &gt; I&#39;m settings an expiration time with a relative time &#40;like &#34;+60&#34;&#41; and it
&gt; &gt; works fine in IE and Firefox, but Safari does not accept this cookie. I
&gt; &gt; found out that Safari only accept a absolute time in the format of &#34;Sat,
&gt; &gt; 01-Jan-2000 01:01:01 GMT&#34;. Since this date format is accepted by all
&gt; &gt; other browsers, i would suggest the sub &#34;cookie&#34; returns this type of
</div>&gt; date..
&gt; 
&gt; I suggest you debug this further. &#34;+60&#34; gets translated into a HTTP
&gt; standard date format indicating an expiration time that is 60 seconds
&gt; from now. Since you didn&#39;t specify the units, I&#39;m not sure if that&#39;s
&gt; what you expected. The docs could be clearer that not specifying a unit
&gt; defaults to seconds, if you&#39;d like to patch them. 
&gt; 
&gt; To better understand the problem, I suggest that you submit a failing
&gt; Test::More style test case that illustrates that the problem. This will
&gt; confirm exactly what the issue is, and help us to address the bug if one
&gt; is found to exist. 
&gt; 
&gt;   Mark
&gt;  
&gt; 
</div>
basically I&#39;m settings the expiration time in seconds:

$session-&gt;expire&#40;&#39;3600s&#39;&#41;;

the cookie will look like:

somekey=somevalue; path=/; expires=+3600s

This is accepted by IE/Firefox, but Safari won&#39;t accept this type of
expiration and will ignore the cookie. Safari will only accept a cookie
with an expiration like this:

somekey=somevalue; path=/; expires=Sat, 01-Jan-2000 01:01:01 GMT
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;12:12:24&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;15:45:53&nbsp;2008</span>
    <span class="description">mark [...] summersault.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34216] Safari does not handles relative expiration value for cookie</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 Mar 2008 15:29:05 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Stosberg &lt;mark [...] summersault.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; basically I&#39;m settings the expiration time in seconds:
&gt; 
&gt; $session-&gt;expire&#40;&#39;3600s&#39;&#41;;
&gt; 
&gt; the cookie will look like:
&gt; 
&gt; somekey=somevalue; path=/; expires=+3600s
&gt; 
&gt; This is accepted by IE/Firefox, but Safari won&#39;t accept this type of
&gt; expiration and will ignore the cookie. Safari will only accept a cookie
&gt; with an expiration like this:
&gt; 
&gt; somekey=somevalue; path=/; expires=Sat, 01-Jan-2000 01:01:01 GMT
</div>
Here&#39;s what I found out with a few minutes of research:

This is the RFC governing cookies and their timestamp formats:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/Protocols/rfc2109/rfc2109">http://www.w3.org/Protocols/rfc2109/rfc2109</a></span>

- It defines &#34;Max-Age&#34; which takes a number of seconds, like &#34;3600&#34;. 
There would be trailing &#34;s&#34; in that case. This the recommended way to 
set cookies.

- For historical reasons, it also defines &#34;Expires&#34;, which expects a 
data in the format above.

- CGI::Session uses CGI.pm to actually set our cookies. CGI.pm supports 
both Expires and Max-Age, but only added Max-Age after 2.83, and still 
doesn&#39;t not document &#34;Max-Age&#34;, even though it is the method recommended 
by the RFC.

It sounds like the CGI.pm docs should be patched, and perhaps our own 
code should be patched so that we generate RFC-compliant cookies that 
set &#34;Max-Age&#34; instead of expires.

Could you help put these patches together since this bug directly 
affects you?

     Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;21&nbsp;14:54:48&nbsp;2008</span>
    <span class="description">michael [...] summersault.com - Ticket #34329:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [patch] use max-age instead of expires</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 21 Mar 2008 14:54:21 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Hampton &lt;michael [...] summersault.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Attached is a patch to generate RFC 2109 compliant cookies that set  
Max-Age instead of Expires.  The patch is for version 4.20.

Reference: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/Protocols/rfc2109/rfc2109">http://www.w3.org/Protocols/rfc2109/rfc2109</a></span>

Michael
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"></div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;21&nbsp;15:07:44&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org - Ticket #34329:  Merged into ticket #34216</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;21&nbsp;15:07:44&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Merged into ticket #34216</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;21&nbsp;21:39:54&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">To the original reporter: 

After reviewing this in detail, I believe this is not a bug in
CGI::Session at all. While the RFC comments on &#34;expire&#34; vs &#34;Max-Age&#34; are
interesting, I don&#39;t believe they are related here. 

To produce the result you saw like &#34;expires=+60s&#34;, CGI::Session would
have had to correctly pass the value &#34;60&#34; to the query object, which is
then responsible for building the cookie text. The following
demonstrates that both the current CGI.pm and CGI::Simple return the
right result. Therefore, I conclude that you were using an older CGI.pm
or CGI::Simple or some other buggy query object. Which query object were
you using, and what version was it? 

###

use CGI::Cookie;
my $cookie = CGI::Cookie-&gt;new&#40;
    &#39;-name&#39;  =&gt; &#39;n&#39;,
    &#39;-value&#39; =&gt; &#39;v&#39;,
    &#39;-expires&#39; =&gt; &#39;+2s&#39;,
&#41;;
print &#34;$cookie\n&#34;;

use CGI::Simple::Cookie;
my $cookie2 = CGI::Simple::Cookie-&gt;new&#40;
    &#39;-name&#39;  =&gt; &#39;n&#39;,
    &#39;-value&#39; =&gt; &#39;v&#39;,
    &#39;-expires&#39; =&gt; &#39;+2s&#39;,
&#41;;
print &#34;$cookie2\n&#34;;

# Result:
# n=v; path=/; expires=Sat, 22-Mar-2008 01:26:57 GMT
# n=v; path=/; expires=Sat, 22-Mar-2008 01:26:57 GMT
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;22&nbsp;00:24:52&nbsp;2008</span>
    <span class="description">angelospam [...] proofpoint.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> angelospam [...] proofpoint.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Mar 21 21:39:54 2008, MARKSTOS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; To the original reporter: 
&gt; 
&gt; After reviewing this in detail, I believe this is not a bug in
&gt; CGI::Session at all. While the RFC comments on &#34;expire&#34; vs &#34;Max-Age&#34; are
&gt; interesting, I don&#39;t believe they are related here. 
&gt; 
&gt; To produce the result you saw like &#34;expires=+60s&#34;, CGI::Session would
&gt; have had to correctly pass the value &#34;60&#34; to the query object, which is
&gt; then responsible for building the cookie text. The following
&gt; demonstrates that both the current CGI.pm and CGI::Simple return the
&gt; right result. Therefore, I conclude that you were using an older CGI.pm
&gt; or CGI::Simple or some other buggy query object. Which query object were
&gt; you using, and what version was it? 
&gt; 
&gt; ###
&gt; 
&gt; use CGI::Cookie;
&gt; my $cookie = CGI::Cookie-&gt;new&#40;
&gt;     &#39;-name&#39;  =&gt; &#39;n&#39;,
&gt;     &#39;-value&#39; =&gt; &#39;v&#39;,
&gt;     &#39;-expires&#39; =&gt; &#39;+2s&#39;,
&gt; &#41;;
&gt; print &#34;$cookie\n&#34;;
&gt; 
&gt; use CGI::Simple::Cookie;
&gt; my $cookie2 = CGI::Simple::Cookie-&gt;new&#40;
&gt;     &#39;-name&#39;  =&gt; &#39;n&#39;,
&gt;     &#39;-value&#39; =&gt; &#39;v&#39;,
&gt;     &#39;-expires&#39; =&gt; &#39;+2s&#39;,
&gt; &#41;;
&gt; print &#34;$cookie2\n&#34;;
&gt; 
&gt; # Result:
&gt; # n=v; path=/; expires=Sat, 22-Mar-2008 01:26:57 GMT
&gt; # n=v; path=/; expires=Sat, 22-Mar-2008 01:26:57 GMT
</div>

okay, got to the bottom of this, i&#39;m using CGI::Util version 1.5 in the
code to calculate time:

 } elsif &#40;$time=~/^&#40;[+-]?&#40;?:\d+|\d*\.\d*&#41;&#41;&#40;[mhdMy]&#41;/&#41; {

as you can see it does not handle seconds! &#40;s&#41;

Looking at the latest CGI::Util 1.5_01 

} elsif &#40;$time=~/^&#40;[+-]?&#40;?:\d+|\d*\.\d*&#41;&#41;&#40;[smhdMy]&#41;/&#41; {

it&#39;s now supporting seconds!

Thanks for your help, greatly appreciated!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;24&nbsp;09:57:41&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> whether or not to require a newer CGI.pm</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> MARKSTOS [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This looks like it was fixed in CGI.pm 3.26:

  Version 3.26
  ...
  6. Fixed bug in seconds calculation in CGI::Util::expire_calc.

We don&#39;t currently require CGI.pm &#40;since other query objects can be
used&#41;, but maybe we should require at least this version to avoid the
error. 

  Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;06&nbsp;20:23:31&nbsp;2008</span>
    <span class="description">RSAVAGE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 24 09:57:41 2008, MARKSTOS wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We don&#39;t currently require CGI.pm &#40;since other query objects can be
&gt; used&#41;, but maybe we should require at least this version to avoid the
&gt; error. 
</div>
Here&#39;s a suggestion: I could patch Makefile.PL and Build.PL to require
CGI V 3.26, and patch to docs to emphasize that this requirement is for
a specific purpose &#40;a pre-emptive defense against Safari&#41;, and that
other modules, e.g. CGI::Simple can still be used. Would that be OK?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;07&nbsp;09:40:15&nbsp;2008</span>
    <span class="description">mark [...] summersault.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #34216] Safari does not handles relative expiration value for cookie</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 07 Apr 2008 09:39:41 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Stosberg &lt;mark [...] summersault.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">RSAVAGE via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CGI-Session
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=34216">http://rt.cpan.org/Ticket/Display.html?id=34216</a></span> &gt;
&gt; 
&gt; On Mon Mar 24 09:57:41 2008, MARKSTOS wrote:
&gt; 
<div class="message-stanza open">&gt;&gt; We don&#39;t currently require CGI.pm &#40;since other query objects can be
&gt;&gt; used&#41;, but maybe we should require at least this version to avoid the
&gt;&gt; error. 
</div>&gt; 
&gt; Here&#39;s a suggestion: I could patch Makefile.PL and Build.PL to require
&gt; CGI V 3.26, and patch to docs to emphasize that this requirement is for
&gt; a specific purpose &#40;a pre-emptive defense against Safari&#41;, and that
&gt; other modules, e.g. CGI::Simple can still be used. Would that be OK?
</div>
That would be fine. I might describe the reason as:

&#34;To insure we generate cookie expiration times which follow the HTTP 
RFC, which Safari in particular is strict about.&#34;

In general, thanks for stepping up with the maintenance, Ron. Just let 
me know when you&#39;d like the next release to be pushed.

Since CGI.pm is in the core, people can&#39;t complain too much about having 
a copy sitting around even if they don&#39;t use, since there&#39;s most likely 
already a copy of it in their distribution anyway.

    Mark

-- 
  . . . . . . . . . . . . . . . . . . . . . . . . . . .
    Mark Stosberg            Principal Developer
    mark@summersault.com     Summersault, LLC
    765-939-9301 ext 202     database driven websites
  . . . . . <span class="clickylink"><a target="new" rel="nofollow" href="http://www.summersault.com/">http://www.summersault.com/</a></span> . . . . . . . .
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;21:25:10&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m going to release the fix Ron Savage recommended for this today. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;21:25:12&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
