<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21091 for Test-Simple: UTF-8 Support</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21091 for Test-Simple: UTF-8 Support</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Test-Simple">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Test-Simple">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Test-Simple">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Test-Simple">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/Test-More/test-more/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Test-Simple">Test-Simple CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21091</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Test-Simple">Test-Simple</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
burak [...] cpan.org

<br />
cornelius.howl [...] gmail.com

<br />
david.buice [...] eds.com

<br />
dom [...] happygiraffe.net

<br />
jdhedden [...] cpan.org

<br />
nospam-abuse [...] bloodgate.com

<br />
schwern [...] pobox.com

<br />
xdaveg [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-31590-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.62    </td>
  </tr>
  <tr id="CF-31591-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=21091">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-146102" href="/Public/Bug/Display.html?id=21091#txn-146102">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;21&nbsp;07:35:12&nbsp;2005</span>
    <span class="description">TELS [...] cpan.org - Ticket #15187:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Test::Builder::is&#40;&#41; trips over utf8 strings in fail reports</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/146102/41769/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/41769">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1007b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w

use Test::More tests =&gt; 1;

sub _u8
  {
  # Converts UTF-16 codepoints in hex &#40;like &#34;2500&#34;&#41; into utf-8
  my &#40;$utf16&#41; = @_;
  require Encode;
  Encode::decode&#40;&#39;UTF-16BE&#39;, pack&#40;&#34;H&#34; . length&#40;$utf16&#41;, $utf16&#41;&#41;;
  }

binmode STDOUT, &#39;:utf8&#39;; # this does not help
binmode STDERR, &#39;:utf8&#39;; # neither does this

my $a = _u8&#40;&#39;2500&#39;&#41;;
my $b = _u8&#40;&#39;2501&#39;&#41;;

print STDERR &#34;# comparing $a to $b\n&#34;;

is &#40;$a, $b, &#34;$a eq $b ?&#34;&#41;;

__END__

The above file will output the following on a console with Unicode support:

1..1
# comparing &#38;#9472; to &#38;#9473;
Wide character in print at /usr/local/lib/perl5/5.8.6/Test/Builder.pm line 1182.
not ok 1 - &#38;#9472; eq &#38;#9473; ?
Wide character in print at /usr/local/lib/perl5/5.8.6/Test/Builder.pm line 1199.
#   Failed test &#39;&#38;#9472; eq &#38;#9473; ?&#39;
#   in utf8.pl at line 30.
Wide character in print at /usr/local/lib/perl5/5.8.6/Test/Builder.pm line 1199.
#          got: &#39;&#38;#9472;&#39;
#     expected: &#39;&#38;#9473;&#39;
# Looks like you failed 1 test of 1.

Best wishes,

Tels
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-146103" href="/Public/Bug/Display.html?id=21091#txn-146103">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;22&nbsp;03:01:18&nbsp;2005</span>
    <span class="description">schwern [...] pobox.com - Ticket #15187:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 22 Oct 2005 00:00:49 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> via RT &lt;bug-Test-Simple [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #15187] Test::Builder::is&#40;&#41; trips over utf8 strings in fail reports</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/146103/41845/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/41845">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 351b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Oct 21, 2005 at 07:35:12AM -0400,  via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The above file will output the following on a console with Unicode support:
</div>
I know pretty much nothing about Unicode.  Suggestions?


-- 
Michael G Schwern     schwern@pobox.com     <span class="clickylink"><a target="new" rel="nofollow" href="http://www.pobox.com/~schwern">http://www.pobox.com/~schwern</a></span>
Just call me &#39;Moron Sugar&#39;.
        <span class="clickylink"><a target="new" rel="nofollow" href="http://www.somethingpositive.net/sp05182002.shtml">http://www.somethingpositive.net/sp05182002.shtml</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-234072" href="/Public/Bug/Display.html?id=21091#txn-234072">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;20&nbsp;11:22:58&nbsp;2006</span>
    <span class="description">HDM [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> UTF-8 Support</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/234072/98159/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/98159">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 484b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">What would you think about some kind of &#34;utf8&#34; import that lets you enable UTF8 support on 
the filehandles that Test::More uses?  At present, I&#39;m having to do things like this:

  use Test::More &#39;no_plan&#39;;
  {
      my $Test = Test::Builder-&gt;new;
      binmode&#40; $Test-&gt;output,         &#34;:utf8&#34; &#41;;
      binmode&#40; $Test-&gt;failure_output, &#34;:utf8&#34; &#41;;
      binmode&#40; $Test-&gt;todo_output,    &#34;:utf8&#34; &#41;;
  }

Ideally, I&#39;d like to be able to say

  use Test::More -utf8, &#39;no_plan&#39;;

Or similar.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-234075" href="/Public/Bug/Display.html?id=21091#txn-234075">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;20&nbsp;11:24:02&nbsp;2006</span>
    <span class="description">HDM [...] cpan.org -  Broken in 0.62 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-234076" href="/Public/Bug/Display.html?id=21091#txn-234076">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;20&nbsp;11:24:02&nbsp;2006</span>
    <span class="description">HDM [...] cpan.org -  Fixed in 0.62 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-318015" href="/Public/Bug/Display.html?id=21091#txn-318015">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;08&nbsp;17:14:03&nbsp;2007</span>
    <span class="description">burak [...] cpan.org - Ticket #27015:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [Test::More] Wide character in print warnings</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/318015/145111/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/145111">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 680b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perl 5.8.8 &#38; Windows XP Pro SP2

Test code:
-----------------------------------------
use 5.008;
use strict;
use warnings;
use Test::More tests =&gt; 1;

my $uni = &#34;\x{11e}&#34;;

ok&#40; $uni eq $uni, &#34;Testing $uni&#34; &#41;;

printf &#34;Test::More is v%s\n&#34;, $Test::More::VERSION;
-----------------------------------------

Output:
-----------------------------------------
1..1
Wide character in print at C:/Perl/lib/Test/Builder.pm line 1245.
ok 1 - Testing Äž
Test::More is v0.7
-----------------------------------------


This warning can be by-passed with this awkward code:

binmode Test::More-&gt;builder-&gt;output, &#39;:utf8&#39;;

Can there be a nicer interface for this? perhaps an import&#40;&#41; parameter?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-379636" href="/Public/Bug/Display.html?id=21091#txn-379636">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;06&nbsp;09:15:28&nbsp;2007</span>
    <span class="description">cornelius.howl [...] gmail.com - Ticket #30518:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Wide character in print</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/379636/173666/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/173666">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 187b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">when i print chinese , it warns:

WARN - Wide character in print at
/usr/local/share/perl/5.8.8/Test/Builder.pm line 1247.

could you add something like:

binmode $fh,&#34;:utf8&#34;;

thanks. :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426192" href="/Public/Bug/Display.html?id=21091#txn-426192">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:19:01&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org - Ticket #15187:  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426193" href="/Public/Bug/Display.html?id=21091#txn-426193">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:19:01&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org -  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426198" href="/Public/Bug/Display.html?id=21091#txn-426198">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:19:10&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org - Ticket #27015:  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426199" href="/Public/Bug/Display.html?id=21091#txn-426199">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:19:10&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org -  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426200" href="/Public/Bug/Display.html?id=21091#txn-426200">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:19:18&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org - Ticket #30518:  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426201" href="/Public/Bug/Display.html?id=21091#txn-426201">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:19:18&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org -  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426202" href="/Public/Bug/Display.html?id=21091#txn-426202">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:43:43&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/426202/208484/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/208484">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 86b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">0.76_01 will use :utf8 on the default output handles.  That should quiet
any warnings.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426203" href="/Public/Bug/Display.html?id=21091#txn-426203">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:43:45&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-426206" href="/Public/Bug/Display.html?id=21091#txn-426206">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;23&nbsp;23:43:45&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-431649" href="/Public/Bug/Display.html?id=21091#txn-431649">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;07&nbsp;13:32:14&nbsp;2008</span>
    <span class="description">jdhedden [...] cpan.org - Ticket #33884:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> t/utf8.t failures under 5.8.8 on Solaris</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/431649/211236/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/211236">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#39;make test&#39; fails with the following:

t/useing..........................ok   
t/utf8............................Cannot find encoding &#34;646&#34; at
/home/jhedden/local/lib/perl5/5.8.8/open.pm line 125.
Cannot find encoding &#34;646&#34; at
/home/jhedden/local/lib/perl5/5.8.8/open.pm line 133.
Out of memory!
Out of memory!
t/utf8............................ Dubious, test returned 1 &#40;wstat 256,
0x100&#41;
 No subtests run 

Test Summary Report
-------------------
t/utf8.t                      &#40;Wstat: 256 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 1
  Parse errors: No plan found in TAP output
Files=73, Tests=521, 102 wallclock secs &#40; 1.09 usr  0.90 sys + 48.10
cusr 45.33 csys = 95.42 CPU&#41;
Result: FAIL


Running the test directly, produces:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl -Mblib t/utf8.t                              
</div>Cannot find encoding &#34;646&#34; at
/home/jhedden/local/lib/perl5/5.8.8/open.pm line 125.
Cannot find encoding &#34;646&#34; at
/home/jhedden/local/lib/perl5/5.8.8/open.pm line 133.
Segmentation Fault


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl -V                                           
</div>Summary of my perl5 &#40;revision 5 version 8 subversion 8&#41; configuration:
  Platform:
    osname=solaris, osvers=2.9, archname=sun4-solaris-thread-multi-64int
    uname=&#39;sunos sundev3 5.9 generic_112233-12 sun4u sparc sunw,sun-fire &#39;
    config_args=&#39;-de -Dusethreads=yes -Duse64bitint=yes -Dusedevel=yes&#39;
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=define use5005threads=undef useithreads=define
usemultiplicity=define
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=define use64bitall=undef uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;/opt/SUNWspro/bin/cc&#39;, ccflags =&#39;-D_REENTRANT
-I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-O&#39;,
    cppflags=&#39;-D_REENTRANT -I/usr/local/include&#39;
    ccversion=&#39;Sun WorkShop 6 update 1 C 5.2 2000/09/11&#39;, gccversion=&#39;&#39;,
gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=87654321
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8,
Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;/opt/SUNWspro/bin/cc&#39;, ldflags =&#39; -L/usr/lib -L/usr/ccs/lib
-L/opt/SUNWspro/WS6U1/lib -L/usr/local/lib &#39;
    libpth=/usr/lib /usr/ccs/lib /opt/SUNWspro/WS6U1/lib /usr/local/lib
    libs=-lsocket -lnsl -lgdbm -ldl -lm -lpthread -lc
    perllibs=-lsocket -lnsl -ldl -lm -lpthread -lc
    libc=/lib/libc.so, so=so, useshrplib=false, libperl=libperl.a
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39; &#39;
    cccdlflags=&#39;-KPIC&#39;, lddlflags=&#39;-G -L/usr/lib -L/usr/ccs/lib
-L/opt/SUNWspro/WS6U1/lib -L/usr/local/lib&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: MULTIPLICITY PERL_IMPLICIT_CONTEXT
                        PERL_MALLOC_WRAP USE_64_BIT_INT USE_ITHREADS
                        USE_LARGE_FILES USE_PERLIO USE_REENTRANT_API
  Built under solaris
  Compiled at May 30 2006 14:17:36
  %ENV:
    PERL5LIB=&#34;/bb/util/common/perlmod/lib/site_perl&#34;
    PERLIO=&#34;perlio&#34;
  @INC:
    /bb/util/common/perlmod/lib/site_perl
    /home/jhedden/local/lib/perl5/5.8.8/sun4-solaris-thread-multi-64int
    /home/jhedden/local/lib/perl5/5.8.8
   
/home/jhedden/local/lib/perl5/site_perl/5.8.8/sun4-solaris-thread-multi-64int
    /home/jhedden/local/lib/perl5/site_perl/5.8.8
    /home/jhedden/local/lib/perl5/site_perl
    .
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-433885" href="/Public/Bug/Display.html?id=21091#txn-433885">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;12&nbsp;17:43:59&nbsp;2008</span>
    <span class="description">david.buice [...] eds.com - Ticket #34035:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> t/utf8.t failures under 5.8.4 on Solaris</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 12 Mar 2008 15:11:13 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Test-Simple [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Buice, David R&#34; &lt;david.buice [...] eds.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/433885/212425/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/212425">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#39;make test&#39; fails with the following:
 
t/useing........................ok
t/utf8..........................Cannot find encoding &#34;646&#34; at
/usr/perl5/5.8.4/lib/open.pm line 126.
Cannot find encoding &#34;646&#34; at /usr/perl5/5.8.4/lib/open.pm line 134.
t/utf8..........................dubious
 
Test Summary Report
----------------------
         Test returned status 0 &#40;wstat 139, 0x8b&#41;
        test program seems to have generated a core
Failed Test Stat Wstat Total Fail  Failed  List of Failed
------------------------------------------------------------------------
-------
t/utf8.t       0   139    ??   ??       %  ??
5 tests and 13 subtests skipped.
Failed 1/73 test scripts, 98.63% okay. 0/515 subtests failed, 100.00%
okay.
*** Error code 2
make: Fatal error: Command failed for target `test_dynamic&#39;
 
Running the test directly produces:
 
 perl -Mblib t/utf8.t
Cannot find encoding &#34;646&#34; at /usr/perl5/5.8.4/lib/open.pm line 126.
Cannot find encoding &#34;646&#34; at /usr/perl5/5.8.4/lib/open.pm line 134.
Segmentation Fault&#40;coredump&#41;

 perl -V
Summary of my perl5 &#40;revision 5 version 8 subversion 4&#41; configuration:
  Platform:
    osname=solaris, osvers=2.10, archname=sun4-solaris-64int
    uname=&#39;sunos localhost 5.10 sun4u sparc SUNW,Ultra-2&#39;
    config_args=&#39;&#39;
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=undef use5005threads=undef useithreads=undef
usemultiplicity=undef
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=define use64bitall=undef uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64
-xarch=v8 -D_TS_ERRNO&#39;,
    optimize=&#39;-xO3 -xspace -xildoff&#39;,
    cppflags=&#39;&#39;
    ccversion=&#39;Sun WorkShop&#39;, gccversion=&#39;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=87654321
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8,
Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39;&#39;
    libpth=/lib /usr/lib /usr/ccs/lib
    libs=-lsocket -lnsl -ldl -lm -lc
    perllibs=-lsocket -lnsl -ldl -lm -lc
    libc=/lib/libc.so, so=so, useshrplib=true, libperl=libperl.so
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-R
/usr/perl5/5.8.4/lib/sun4-solaris-64int/CORE&#39;
    cccdlflags=&#39;-KPIC&#39;, lddlflags=&#39;-G&#39;
 

Characteristics of this binary &#40;from libperl&#41;:
  Compile-time options: USE_64_BIT_INT USE_LARGE_FILES
  Locally applied patches:
        22667 The optree builder was looping when constructing the ops
...
        22715 Upgrade to FileCache 1.04
        22733 Missing copyright in the README.
        22746 fix a coredump caused by rv2gv not fully converting a PV
...
        22755 Fix 29149 - another UTF8 cache bug hit by substr.
        22774 [perl #28938] split could leave an array without ...
        22775 [perl #29127] scalar delete of empty slice returned
garbage
        22776 [perl #28986] perl -e &#34;open m&#34; crashes Perl
        22777 add test for change #22776 &#40;&#34;open m&#34; crashes Perl&#41;
        22778 add test for change #22746 &#40;[perl #29102] Crash on assign
...
        22781 [perl #29340] Bizarre copy of ARRAY make sure a pad op&#39;s
...
        22796 [perl #29346] Double warning for int&#40;undef&#41; and abs&#40;undef&#41;
...
        22818 BOM-marked and &#40;BOMless&#41; UTF-16 scripts not working
        22823 [perl #29581] glob&#40;&#41; misses a lot of matches
        22827 Smoke [5.9.2] 22818 FAIL&#40;F&#41; MSWin32 WinXP/.Net SP1 &#40;x86/1
cpu&#41;
        22830 [perl #29637] Thread creation time is hypersensitive
        22831 improve hashing algorithm for ptr tables in perl_clone:
...
        22839 [perl #29790] Optimization busted: &#39;@a = &#34;b&#34;, sort @a&#39; ...
        22850 [PATCH] &#39;perl -v&#39; fails if local_patches contains code
snippets
        22852 TEST needs to ignore SCM files
        22886 Pod::Find should ignore SCM files and dirs
        22888 Remove redundant %SIG assignments from FileCache
        23006 [perl #30509] use encoding and &#34;eq&#34; cause memory leak
        23074 Segfault using HTML::Entities
        23106 Numeric comparison operators mustn&#39;t compare addresses of
...
        23320 [perl #30066] Memory leak in nested shared data structures
...
        23321 [perl #31459] Bug in read&#40;&#41;
        SPRINTF0 - fixes for sprintf formatting issues - CVE-2005-3962
  Built under solaris
  Compiled at Feb 13 2006 05:12:02
  @INC:
    /usr/perl5/5.8.4/lib/sun4-solaris-64int
    /usr/perl5/5.8.4/lib
    /usr/perl5/site_perl/5.8.4/sun4-solaris-64int
    /usr/perl5/site_perl/5.8.4
    /usr/perl5/site_perl
    /usr/perl5/vendor_perl/5.8.4/sun4-solaris-64int
    /usr/perl5/vendor_perl/5.8.4
    /usr/perl5/vendor_perl
    .
Regards,
 
David Buice
ITIL Foundations Certified
EDS - PSIC
7000 Chicago Road
Warren, MI  48092
 
&#40; Phone:+1-586-575-4525
+ mailto:david.buice@eds.com
cell: 248-249-9122
 
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/433885/212426/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/212426">with headers</a>
<br />
<span class="downloadcontenttype">text/html 9.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-475738" href="/Public/Bug/Display.html?id=21091#txn-475738">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;12:18:02&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org - Ticket #34035:  Severity Wishlist added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-475739" href="/Public/Bug/Display.html?id=21091#txn-475739">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;12:18:15&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org - Ticket #33884:  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-475740" href="/Public/Bug/Display.html?id=21091#txn-475740">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;12:18:15&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org - Ticket #34035:  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-495899" href="/Public/Bug/Display.html?id=21091#txn-495899">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;10&nbsp;06:08:57&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-495900" href="/Public/Bug/Display.html?id=21091#txn-495900">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;10&nbsp;06:11:59&nbsp;2008</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/495900/245467/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/245467">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 102b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry, it didn&#39;t work out.  The necessary IO layer support in Perl is
busted on a number of platforms.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-612247" href="/Public/Bug/Display.html?id=21091#txn-612247">#</a>      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;30&nbsp;15:25:18&nbsp;2009</span>
    <span class="description">schwern [...] pobox.com - Ticket #46542:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [Fwd: copy_io_layers in Test::More]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 30 May 2009 12:24:46 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Test-Simple [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/612247/310632/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/310632">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-------- Original Message --------
Subject: copy_io_layers in Test::More
Date: Mon, 20 Apr 2009 06:58:33 -0400
From: David Golden &lt;xdaveg@gmail.com&gt;
To: Michael G Schwern &lt;schwern@pobox.com&gt;

I see the intent to copy IO layers, but it&#39;s commented out.

Having just wrestled with IO layer copying for Capture::Tiny, I also
see that the code won&#39;t work.  Here&#39;s what I&#39;ve figured out is
required to copy layers -- at least in 5.10.0:

 sub _apply_layers {
  my &#40;$fh, @layers&#41; = @_;
  my %seen;
  my @unique = grep { $_ ne &#39;unix&#39; and !$seen{$_}++ } @layers;
  binmode&#40;$fh, join&#40;&#34;:&#34;, &#34;&#34;, &#34;raw&#34;, @unique&#41;&#41;;
}

This will take layers as given by PerlIO::get_layers&#40;STDOUT&#41; and apply
them to a new file handle.  Stripping unix and duplicates is
apparently necessary.

Hope that helps if it&#39;s still on your todo list.

I&#39;d also welcome an option in Test::Builder to turn utf8 on/off
selectively, not just when Test::Builder loads.  Otherwise, I&#39;m going
to wind up doing this:

my $saved_layers;
BEGIN {  $saved_layers = _save_layers&#40;&#41;; binmode&#40;STDOUT,&#34;:utf8&#34;&#41;;
binmode&#40;STDERR,&#34;:utf8&#34;&#41; }
use Test::More
BEGIN { _restore_layers&#40;$saved_layers&#41; }

I need utf8 to be off during most testing, but I turn it on for a few
tests then turn it back off again.  During those tests, I want
Test::Builder to give me utf8 diagnostics.

What do you think?

-- David


-- 
If you want the truth to stand clear before you, never be for or against.
The struggle between &#34;for&#34; and &#34;against&#34; is the mind&#39;s worst disease.
    -- Sent-ts&#39;an
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823552" href="/Public/Bug/Display.html?id=21091#txn-823552">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;00:28:56&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org - Ticket #46542:  Requestor xdaveg@gmail.com added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823559" href="/Public/Bug/Display.html?id=21091#txn-823559">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;01:01:04&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org - Ticket #46542:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fixing copy_io_layers in Test::More</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/823559/426684/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/426684">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 670b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Let me dig up the details of what the problems were last time I tried
this...

Here&#39;s one report:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-03/msg00278.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-03/msg00278.html</a></span>

And another:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-03/msg00355.html">http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2008-03/msg00355.html</a></span>

&#39;use open &#34;:std&#34;, &#34;:locale&#34;&#39; is not safe on weird platforms.  But
Test::Builder only needs that for testing.  And we only *really* care
about utf8.  So I can remove open.pm from the test and just use
binmode&#40;&#41; directly.  I&#39;ll try that and release it as an alpha and see
what sort of havoc it causes.

Also, a method to apply filehandle disciplines to all the output handles
at once would be appreciated.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823562" href="/Public/Bug/Display.html?id=21091#txn-823562">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;01:01:05&nbsp;2010</span>
    <span class="description">The RT System itself - Ticket #46542:  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823563" href="/Public/Bug/Display.html?id=21091#txn-823563">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;01:03:50&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org - Ticket #46542:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/823563/426687/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/426687">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 127b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve pushed this in as 401fa01bc23c23f79ed0e97dfa7ea79422b3f5a8.  Works
on my machine, but it will need to hit a lot of others.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823573" href="/Public/Bug/Display.html?id=21091#txn-823573">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;01:53:40&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org - Ticket #46542:  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823574" href="/Public/Bug/Display.html?id=21091#txn-823574">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;01:53:40&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org -  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823575" href="/Public/Bug/Display.html?id=21091#txn-823575">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;01:54:20&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org - Ticket #34035:  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-823576" href="/Public/Bug/Display.html?id=21091#txn-823576">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;28&nbsp;01:54:20&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org -  Merged into ticket #21091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1679291" href="/Public/Bug/Display.html?id=21091#txn-1679291">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;28&nbsp;15:48:14&nbsp;2016</span>
    <span class="description">exodist7 [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1679291/901309/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/901309">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 178b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks to the Test2 change UTF8 support is now fairly trivial in a couple ways. I am closing this ticket.

If you have further utf8 issues please open tickets for them on github.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1679294" href="/Public/Bug/Display.html?id=21091#txn-1679294">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;28&nbsp;15:48:20&nbsp;2016</span>
    <span class="description">exodist7 [...] gmail.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.040943</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
