<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #118383 for Config-General: Variables interpolation sometimes doesn&#39;t work</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #118383 for Config-General: Variables interpolation sometimes doesn&#39;t work</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Config-General/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Config-General/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Config-General/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Config-General/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Config-General">Config-General CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">118383</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Config-General/Active/">Config-General</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
justice__8 [...] hotmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-7696-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-7697-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;14&nbsp;05:55:10&nbsp;2016</span>
    <span class="description">justice__8 [...] hotmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;tlinden [...] cpan.org&#34; &lt;tlinden [...] cpan.org&gt;, &#34;valid-until-21-Oct-2016 [...] daemon.de&#34; &lt;valid-until-21-Oct-2016 [...] daemon.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Variables interpolation sometimes doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Oct 2016 09:54:51 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Config-General [...] rt.cpan.org&#34; &lt;bug-Config-General [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JusTiCe 8 &lt;justice__8 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Thomas,


using variables interpolation cause sometimes random failure in the Config::General constructor &#40;probably&#41; caused by Perl hashes randomness.


This sample &#40;see at the bottom&#41; run  a loop 1000 times and here are some results I got:

ok=794 ko=206

ok=673 ko=327

ok=791 ko=209

ok=814 ko=186
ok=999 ko=1
ok=672 ko=328

ok is when vars are correctly interpolated as expected
ko is when the constructor raise an exception


so you can see here it failed from time to time in a very &#40;almost&#41; unpredictable way.


I&#39;ve done myself a dynamic configuration system and my solution to this issue is to make multiple passes to fill a dictionary made of vars&#39; values, until it no longer contains any vars at all, like this


DIC= &#40;after reading config file&#41;

  var1 = 3

  var2 = $var1/$var3

  var3 = something


on a second pass =&gt; var2 = 3/something, dictionary is free of var and we&#39;re good to go


And so do n passes with a maximum of a given number to avoid infinite loop, raise an error only when there are still unknown variables in config after these n passes.



Included is a sample code and a related configuration files.


Regards.
</div></div>

<div class="messagebody">
</div>
</div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;14&nbsp;06:21:16&nbsp;2016</span>
    <span class="description">tlinden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I can&#39;t reproduce this:

% perl ConfigGeneralIssue 
ok=1000 ko=0

So, can you uncomment this line:

#print &#34;CG error: [$@]\n&#34;;

and post the output?

Also, which version are you using? Add:

print &#34;Config::General::Version: $Config::General::VERSION\n&#34;;

And which perl version &#40;perl -v&#41;?


Thanks,
Tom
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;14&nbsp;06:21:17&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;14&nbsp;07:11:45&nbsp;2016</span>
    <span class="description">justice__8 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Oct 2016 11:11:26 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Config-General [...] rt.cpan.org&#34; &lt;bug-Config-General [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JusTiCe 8 &lt;justice__8 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oups, my bad, sorry.


it&#39;s on Debian stretch &#40;current testing&#41;:

perl 5.24.1

Config::General 2.63

&#40;and for what it worth on a VMware guest&#41;


The error msg is:

Use of uninitialized variable &#40;$item&#41; while loading config entry: var = $item
 at ConfigGeneralIssue line 24.

&#40;line 24 is the 1st line of the constructor call&#41;


How many time did you run it ?

I have also got a 1000/0 but it&#39;s quite an anomaly on my setup.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: T. Linden via RT &lt;bug-Config-General@rt.cpan.org&gt;
Sent: Friday, October 14, 2016 12:21 PM
To: justice__8@hotmail.com
Subject: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=118383">https://rt.cpan.org/Ticket/Display.html?id=118383</a></span> &gt;

Hi,

I can&#39;t reproduce this:

% perl ConfigGeneralIssue
ok=1000 ko=0

So, can you uncomment this line:

#print &#34;CG error: [$@]\n&#34;;

and post the output?

Also, which version are you using? Add:

print &#34;Config::General::Version: $Config::General::VERSION\n&#34;;

And which perl version &#40;perl -v&#41;?


Thanks,
Tom
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;14&nbsp;08:23:03&nbsp;2016</span>
    <span class="description">tlinden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; How many time did you run it ?
</div>
1000 times, no problems.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#40;and for what it worth on a VMware guest&#41;
</div>
There we have it. Entropy exhausts sometimes very fast on VMs. Retry on metal and you&#39;ll see no more problems. You might try to workaround the entropy problem a little, e.g. install egd or stuff like that.


Tom
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;14&nbsp;09:36:53&nbsp;2016</span>
    <span class="description">justice__8 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Oct 2016 13:36:26 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Config-General [...] rt.cpan.org&#34; &lt;bug-Config-General [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JusTiCe 8 &lt;justice__8 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">For what it worth, I have installed haveged and, I still got issues with higher available entropy than before.

&#40;report of entropy comes from /proc/sys/kernel/random/entropy_avail&#41;, cf <span class="clickylink"><a target="new" rel="nofollow" href="https://wiki.archlinux.org/index.php/Haveged&#41;">https://wiki.archlinux.org/index.php/Haveged&#41;</a></span>

ok=681 ko=319
1086  &lt;== this is the entropy

ok=1000 ko=0
1108
ok=655 ko=345
1115
ok=808 ko=192
2231
ok=670 ko=330
2236
ok=806 ko=194
2240
ok=801 ko=199
2245

on a Linux physical host &#40;Debian 8.5, kernel 3.16.7-ctk25-2  x64, Perl 5.20.2 and Config::General 2.56&#41;, I got similar results:

666
ok=674 ko=326
ok=661 ko=339
ok=791 ko=209
ok=803 ko=197
ok=672 ko=328
669
670
672
ok=661 ko=339

haveged installed =&gt; entropy grown to 2463 but
ok=664 ko=336
ok=667 ko=333

2308
ok=793 ko=207
2059
ok=657 ko=343

&#40;lonely digits = cat .../entropy_avail&#41;

I&#39;m not really convinced.

IMHO, as variables can be defined and used mostly anywhere, even using any kind of sort, you can&#39;t assume any order between variables declarations and uses, so interpolation cannot be done in a single pass &#40;except when you only allow a single layer of variables, ie bar = $xyz,  foo=$bar not allowed&#41;.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;14&nbsp;15:32:58&nbsp;2016</span>
    <span class="description">tlinden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; on a Linux physical host &#40;Debian 8.5, kernel 3.16.7-ctk25-2  x64, Perl
&gt; 5.20.2 and Config::General 2.56&#41;, I got similar results:
&gt; 
&gt; 666
&gt; ok=674 ko=326
&gt; ok=661 ko=339
&gt; ok=791 ko=209
&gt; ok=803 ko=197
&gt; ok=672 ko=328
</div>
I still can&#39;t reproduce this, not on FreeBSD, not on Arch Linux, not on OpenBSD, not on Cygwin.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; IMHO, as variables can be defined and used mostly anywhere, even using
&gt; any kind of sort, you can&#39;t assume any order between variables
&gt; declarations and uses, so interpolation cannot be done in a single
&gt; pass &#40;except when you only allow a single layer of variables, ie bar =
&gt; $xyz,  foo=$bar not allowed&#41;.
</div>
I don&#39;t understand this sentence.

----

However, I misinterpreted the issue anyway. It doesn&#39;t have anything to do with randomness, since Config::General::Interpolate doesn&#39;t use random things at all. Sorry for the confusion.

So. I&#39;ve got no idea :&#40;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;17&nbsp;08:42:08&nbsp;2016</span>
    <span class="description">justice__8 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Oct 2016 12:41:44 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Config-General [...] rt.cpan.org&#34; &lt;bug-Config-General [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JusTiCe 8 &lt;justice__8 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, I misinterpreted the issue anyway. It doesn&#39;t have anything to do with randomness, since Config::General::Interpolate doesn&#39;t use random things at all. Sorry for the confusion.
</div>

It is, all loop like:


for &#40;keys %{$config}&#41;               especially in &#34;_var_hash_stacker&#34; and &#34;_clean_stack&#34; subs of Interpolated module


get a list of keys in not always the same order each time the test program is run.

&#40;quote from keys function doc: &#34;Hash entries are returned in an apparently random order&#34;&#41;


I have added a call to sort on all loops on keys in Interpolated module, then I got a consistent 500/500 ok/ko result.

If I change sorting order to descending &#40;adding &#34;sort { $b cmp $a } &#34; in loops above&#41;, I got a consistent 1000/0 result &#40;I&#39;m lucky on this, depending on blocks and variables names, it can also failed all the time&#41;.


I have also left only one variable and one config item which use it directly:

myvar = something
/*item = $myvar*/
&lt;blockone&gt;
    foo = notbar
    var = $myvar /* $item */
    another = novar /* $myvar */
&lt;/blockone&gt;


it still failed without sorting keys.


Attached is the result of keys sorting order with no sorting, sorting descending and sort ascending &#40;default&#41; in the two subs given above.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I don&#39;t understand this sentence.
</div>

My bad. I just mean IMHO variable s interpolation in configuration file, using Perl hashes, cannot be done in one single pass while parsing the file, as the usage of a variable can be parsed BEFORE the actual variable declaration, ie:


myvar = 1

...

foobar = $myvar


can be either parsed in the &#34;assumed&#34; order &#40;myvar before foobar = ok&#41;, or the opposite &#40;foobar before myvar = failure&#41; because on how keys and hashes works in Perl.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: T. Linden via RT &lt;bug-Config-General@rt.cpan.org&gt;
Sent: Friday, October 14, 2016 9:32 PM
To: justice__8@hotmail.com
Subject: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=118383">https://rt.cpan.org/Ticket/Display.html?id=118383</a></span> &gt;

<div class="message-stanza open">&gt; on a Linux physical host &#40;Debian 8.5, kernel 3.16.7-ctk25-2  x64, Perl
&gt; 5.20.2 and Config::General 2.56&#41;, I got similar results:
&gt;
&gt; 666
&gt; ok=674 ko=326
&gt; ok=661 ko=339
&gt; ok=791 ko=209
&gt; ok=803 ko=197
&gt; ok=672 ko=328
</div>
I still can&#39;t reproduce this, not on FreeBSD, not on Arch Linux, not on OpenBSD, not on Cygwin.

<div class="message-stanza open">&gt; IMHO, as variables can be defined and used mostly anywhere, even using
&gt; any kind of sort, you can&#39;t assume any order between variables
&gt; declarations and uses, so interpolation cannot be done in a single
&gt; pass &#40;except when you only allow a single layer of variables, ie bar =
&gt; $xyz,  foo=$bar not allowed&#41;.
</div>
I don&#39;t understand this sentence.

----

However, I misinterpreted the issue anyway. It doesn&#39;t have anything to do with randomness, since Config::General::Interpolate doesn&#39;t use random things at all. Sorry for the confusion.

So. I&#39;ve got no idea :&#40;
</div></div></div>

<div class="messagebody">
</div>
</div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;17&nbsp;17:55:08&nbsp;2016</span>
    <span class="description">tlinden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Nope.

Variable parsing of CONFIG FILES happens in the precise order as they are defined in the config file:

Config::General::_parse&#40;&#41;
=&gt; Config::General::_parse_value&#40;&#41;
=&gt; Config::General::Interpolated::_interpolate&#40;&#41;

Variables are not parsed AFTER parsing is done, but line by line. Take a look:

#!/usr/bin/perl
use lib qw&#40;blib/lib&#41;;
use Config::General;
use Data::Dumper;
my $file = shift || die;
my $c = Config::General-&gt;new&#40;
                             -ConfigFile            =&gt; $file,
                             -MergeDuplicateOptions =&gt; 1,
                             -MergeDuplicateBlocks  =&gt; 1,
                             -AllowMultiOptions     =&gt; 1,
                             -AutoTrue              =&gt; 1,
                             -InterPolateVars       =&gt; 1,
                             -SplitPolicy           =&gt; &#39;equalsign&#39;,
                             -UTF8                  =&gt; 1
                            &#41;;
my %h = $c-&gt;getall&#40;&#41;;
print Dumper&#40;\%h&#41;;

Config:

a = 1
b = $a
c = $b
d = $c
e = $d
f = $e
g = $f
h = $g
i = $h

Output:

nubic: % perl t.pl t.cfg 
$VAR1 = {
          &#39;b&#39; =&gt; 1,
          &#39;c&#39; =&gt; 1,
          &#39;h&#39; =&gt; 1,
          &#39;e&#39; =&gt; 1,
          &#39;a&#39; =&gt; 1,
          &#39;f&#39; =&gt; 1,
          &#39;i&#39; =&gt; 1,
          &#39;d&#39; =&gt; 1,
          &#39;g&#39; =&gt; 1
        };

This hasn&#39;t anything to do with hash ordering, only with occurrence in the input file.

Of course it&#39;s a completely different story with default hashes. Since hashes in perl are by definition unordered &#40;which is the &#34;random&#34; thing mentioned in the docs&#41;, keys inside default hashes are put onto the variable stack by chance.

This is, however, no problem at all, unless the config hash ITSELF already uses one of the variables it defines. If it doesn&#39;t &#40;and it shouldn&#39;t&#41;, then order of keys in a default config doesn&#39;t matter as well.

And as I already said, I still cannot reproduce your results with stock Config::General on any platform at hand. So, there&#39;s no problem from my point of view &#40;yet - since I&#39;m still not 100% sure if I understood you correctly!&#41;.

On thing though: if you need ordered hashes for one or another reason, this kind of stuff is already supported. Refer to the documentation of the -Tie flag, which can be used to tie a sorting hash submodule onto hashes, e.g. by using Tie::IxHash. If you tie your default config as well, everything is ordered. No modification to the code would be required.

And - while I&#39;m at it - there are also plugin hooks available for this kind of stuff :&#41;


best,
Tom
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;18&nbsp;09:41:54&nbsp;2016</span>
    <span class="description">justice__8 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 18 Oct 2016 13:41:24 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Config-General [...] rt.cpan.org&#34; &lt;bug-Config-General [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JusTiCe 8 &lt;justice__8 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">All of this is nice but a bit irrelevant as the issue occurred when I use variables AND default config as the first samples given in this issue report.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Of course it&#39;s a completely different story with default hashes. Since hashes in perl are by definition unordered &#40;which is the &#34;random&#34; thing mentioned in the docs&#41;, keys inside default hashes are put onto the variable stack by chance.
</div>

The DefaultConfig description is:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This can be a hash reference or a simple scalar &#40;string&#41; of a config. This causes the module to preset the resulting config hash with the given values, which allows you to set default values for particular config options directly.
</div>

Which doesn&#39;t tell me not to do so.


So, IMHO, you could either choose to dodge the issue by declaring it not handled by Config::General explicitly in the documentation &#40;something like &#34;providing default configuration which can contains variable values is currently forbidden/unmanaged and have to be avoided&#34;&#41; or fix it.


It&#39;s is a bit strange you cannot get the issue &#40;also trying to download the configuration file lead to a BAD REQUEST HTTP error :/ the bugtracker looks like to don&#39;t like dot file so much, which may explain why&#41;

config file is:

%&lt;---

# Config::General variables interpolation issue configuration

myvar = something

/*item = $myvar*/

&lt;blockone&gt;
    foo = notbar
    var = $myvar /* $item */

    another = novar /* $myvar */
&lt;/blockone&gt;
%&lt;------


&#40;as the default contains only &#34;item&#34;, &#34;var&#34; and &#34;foo&#34;, it looks like Config::General::Interpolated::_interpolate encounter blockone/var BEFORE reading &#34;myvar&#34; value from loaded file&#41;


If you haven&#39;t done it yet, could you try with the file content above please ?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: T. Linden via RT &lt;bug-Config-General@rt.cpan.org&gt;
Sent: Monday, October 17, 2016 11:55 PM
To: justice__8@hotmail.com
Subject: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=118383">https://rt.cpan.org/Ticket/Display.html?id=118383</a></span> &gt;

Nope.

Variable parsing of CONFIG FILES happens in the precise order as they are defined in the config file:

Config::General::_parse&#40;&#41;
=&gt; Config::General::_parse_value&#40;&#41;
=&gt; Config::General::Interpolated::_interpolate&#40;&#41;

Variables are not parsed AFTER parsing is done, but line by line. Take a look:

#!/usr/bin/perl
use lib qw&#40;blib/lib&#41;;
use Config::General;
use Data::Dumper;
my $file = shift || die;
my $c = Config::General-&gt;new&#40;
                             -ConfigFile            =&gt; $file,
                             -MergeDuplicateOptions =&gt; 1,
                             -MergeDuplicateBlocks  =&gt; 1,
                             -AllowMultiOptions     =&gt; 1,
                             -AutoTrue              =&gt; 1,
                             -InterPolateVars       =&gt; 1,
                             -SplitPolicy           =&gt; &#39;equalsign&#39;,
                             -UTF8                  =&gt; 1
                            &#41;;
my %h = $c-&gt;getall&#40;&#41;;
print Dumper&#40;\%h&#41;;

Config:

a = 1
b = $a
c = $b
d = $c
e = $d
f = $e
g = $f
h = $g
i = $h

Output:

nubic: % perl t.pl t.cfg
$VAR1 = {
          &#39;b&#39; =&gt; 1,
          &#39;c&#39; =&gt; 1,
          &#39;h&#39; =&gt; 1,
          &#39;e&#39; =&gt; 1,
          &#39;a&#39; =&gt; 1,
          &#39;f&#39; =&gt; 1,
          &#39;i&#39; =&gt; 1,
          &#39;d&#39; =&gt; 1,
          &#39;g&#39; =&gt; 1
        };

This hasn&#39;t anything to do with hash ordering, only with occurrence in the input file.

Of course it&#39;s a completely different story with default hashes. Since hashes in perl are by definition unordered &#40;which is the &#34;random&#34; thing mentioned in the docs&#41;, keys inside default hashes are put onto the variable stack by chance.

This is, however, no problem at all, unless the config hash ITSELF already uses one of the variables it defines. If it doesn&#39;t &#40;and it shouldn&#39;t&#41;, then order of keys in a default config doesn&#39;t matter as well.

And as I already said, I still cannot reproduce your results with stock Config::General on any platform at hand. So, there&#39;s no problem from my point of view &#40;yet - since I&#39;m still not 100% sure if I understood you correctly!&#41;.

On thing though: if you need ordered hashes for one or another reason, this kind of stuff is already supported. Refer to the documentation of the -Tie flag, which can be used to tie a sorting hash submodule onto hashes, e.g. by using Tie::IxHash. If you tie your default config as well, everything is ordered. No modification to the code would be required.

And - while I&#39;m at it - there are also plugin hooks available for this kind of stuff :&#41;


best,
Tom
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;18&nbsp;10:32:20&nbsp;2016</span>
    <span class="description">tlinden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 18 09:41:54 2016, justice__8@hotmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; All of this is nice but a bit irrelevant as the issue occurred when I
&gt; use variables AND default config as the first samples given in this
&gt; issue report.
</div>
Great, so I don&#39;t need to explain anything anymore.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The DefaultConfig description is:
&gt; 
<div class="message-stanza open">&gt; &gt; This can be a hash reference or a simple scalar &#40;string&#41; of a config.
&gt; &gt; This causes the module to preset the resulting config hash with the
&gt; &gt; given values, which allows you to set default values for particular
&gt; &gt; config options directly.
</div>&gt; 
&gt; Which doesn&#39;t tell me not to do so.
</div>
Which is not what I said.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So, IMHO, you could either choose to dodge the issue[..]
</div>
If I wanted to &#34;dogge&#34; the issue, I had not responded to it in the first place.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It&#39;s is a bit strange you cannot get the issue
</div>
No, it behaves as I expect it to behave.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you haven&#39;t done it yet, could you try with the file content above
&gt; please ?
</div>
I already did that, but I did it again:

ok=1000 ko=0

It didn&#39;t fail, as there&#39;s nothing to interpolate in the first place. Just to recount, this is the default config I used &#40;according to your posts&#41;:

my $config =
{
        item =&gt; 1,
        blockone =&gt;
        {
                var =&gt; &#39;something&#39;,
                foo =&gt; &#39;bar&#39;,
        },
};

And this is the config with comments removed:

myvar = something
&lt;blockone&gt;
    foo = notbar
    var = $myvar
    another = novar
&lt;/blockone&gt;

From this, Config:General came up with this:

        {
          &#39;item&#39; =&gt; 1,
          &#39;myvar&#39; =&gt; &#39;something&#39;,
          &#39;blockone&#39; =&gt; {
                        &#39;another&#39; =&gt; &#39;novar&#39;,
                        &#39;var&#39; =&gt; &#39;something&#39;,
                        &#39;foo&#39; =&gt; &#39;notbar&#39;
                      }
        };

Looks legit.

If you want me to fix the bug &#40;if there is one&#41;, then you have to provide a reproducible test case.

Also, you did not respond to the rest of my last comment: did you test it with -Tie and what was the result?



- Tom
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;24&nbsp;04:25:50&nbsp;2016</span>
    <span class="description">justice__8 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 24 Oct 2016 08:25:15 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Config-General [...] rt.cpan.org&#34; &lt;bug-Config-General [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JusTiCe 8 &lt;justice__8 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If I wanted to &#34;dogge&#34; the issue, I had not responded to it in the first place.
</div>

I just consider any possible case, doesn&#39;t mean to offend you in any way, sorry.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; if you want me to fix the bug &#40;if there is one&#41;, then you have to provide a reproducible test case.
</div>

I did. Unfortunately, the issue I got looks like to be caused by something I don&#39;t know which is not equal on our respective setups. Perl offer a way to choose hash function at build time &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://onionstand.blogspot.fr/2012/12/are-you-relying-on-hash-keys-being.html&#41;">http://onionstand.blogspot.fr/2012/12/are-you-relying-on-hash-keys-being.html&#41;</a></span> and probably the version we use were not built using the same config, I don&#39;t know. The fact that the exact same code behave in two different ways on two different setups just confuses me.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, you did not respond to the rest of my last comment: did you test it with -Tie and what was the result?
</div>

I took time to work on this and I get this &#40;change in bold lead to 1000 ok/0 ko consistently&#41;:

use strict;
use Config::General;
use Data::Dumper;

use Tie::IxHash;


my $config =
{
    ...
};

tie %$config, &#34;Tie::IxHash&#34;;

my &#40;$oks, $errors&#41; = &#40;0, 0&#41;;

for &#40;my $count = 0; $count &lt; 1000; $count++&#41;
{
    eval
    {
        my $cgobject = Config::General-&gt;new
        &#40;
            -ConfigFile =&gt; &#39;.configgen-issue.cfg&#39;,
...
            -UTF8 =&gt; 1,
            -Tie =&gt; &#39;Tie::IxHash&#39;,
        &#41;;

        my %finalconfig = $cgobject-&gt;getall &#40;&#41;;

 ... &#40;everything else is identical&#41;


So, using Tie::IxHash fix the issue.


Thanks for your help on this.

Regards.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: T. Linden via RT &lt;bug-Config-General@rt.cpan.org&gt;
Sent: Tuesday, October 18, 2016 4:32 PM
To: justice__8@hotmail.com
Subject: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=118383">https://rt.cpan.org/Ticket/Display.html?id=118383</a></span> &gt;

On Tue Oct 18 09:41:54 2016, justice__8@hotmail.com wrote:
<div class="message-stanza open">&gt; All of this is nice but a bit irrelevant as the issue occurred when I
&gt; use variables AND default config as the first samples given in this
&gt; issue report.
</div>
Great, so I don&#39;t need to explain anything anymore.

<div class="message-stanza open">&gt; The DefaultConfig description is:
&gt;
<div class="message-stanza open">&gt; &gt; This can be a hash reference or a simple scalar &#40;string&#41; of a config.
&gt; &gt; This causes the module to preset the resulting config hash with the
&gt; &gt; given values, which allows you to set default values for particular
&gt; &gt; config options directly.
</div>&gt;
&gt; Which doesn&#39;t tell me not to do so.
</div>
Which is not what I said.

<div class="message-stanza open">&gt; So, IMHO, you could either choose to dodge the issue[..]
</div>
If I wanted to &#34;dogge&#34; the issue, I had not responded to it in the first place.

<div class="message-stanza open">&gt; It&#39;s is a bit strange you cannot get the issue
</div>
No, it behaves as I expect it to behave.

<div class="message-stanza open">&gt; If you haven&#39;t done it yet, could you try with the file content above
&gt; please ?
</div>
I already did that, but I did it again:

ok=1000 ko=0

It didn&#39;t fail, as there&#39;s nothing to interpolate in the first place. Just to recount, this is the default config I used &#40;according to your posts&#41;:

my $config =
{
        item =&gt; 1,
        blockone =&gt;
        {
                var =&gt; &#39;something&#39;,
                foo =&gt; &#39;bar&#39;,
        },
};

And this is the config with comments removed:

myvar = something
&lt;blockone&gt;
    foo = notbar
    var = $myvar
    another = novar
&lt;/blockone&gt;

From this, Config:General came up with this:

        {
          &#39;item&#39; =&gt; 1,
          &#39;myvar&#39; =&gt; &#39;something&#39;,
          &#39;blockone&#39; =&gt; {
                        &#39;another&#39; =&gt; &#39;novar&#39;,
                        &#39;var&#39; =&gt; &#39;something&#39;,
                        &#39;foo&#39; =&gt; &#39;notbar&#39;
                      }
        };

Looks legit.

If you want me to fix the bug &#40;if there is one&#41;, then you have to provide a reproducible test case.

Also, you did not respond to the rest of my last comment: did you test it with -Tie and what was the result?



- Tom
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;24&nbsp;04:39:57&nbsp;2016</span>
    <span class="description">tlinden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perl offer a way to choose hash function at build time
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://onionstand.blogspot.fr/2012/12/are-you-relying-on-hash-keys-">http://onionstand.blogspot.fr/2012/12/are-you-relying-on-hash-keys-</a></span>
&gt; being.html&#41;
</div>
I don&#39;t think this applies to Config::General, since it doesn&#39;t rely on key order. Sometimes the user might rely on key order, but not the module itself, that is.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The fact that the exact same code behave in
&gt; two different ways on two different setups just confuses me.
</div>
This, indeed, confuses me as well. Really strange.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So, using Tie::IxHash fix the issue.
</div>
Well, so what do you think - close the issue? I&#39;m undecided.



best regards,
Tom
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;25&nbsp;07:18:14&nbsp;2016</span>
    <span class="description">justice__8 [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Oct 2016 11:17:55 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Config-General [...] rt.cpan.org&#34; &lt;bug-Config-General [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JusTiCe 8 &lt;justice__8 [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This, indeed, confuses me as well. Really strange.
</div>
Have you any idea to move forward on this ?
One step could be to get specifics of the systems you have tested on &#40;perl compilation options, soft &#38; hard&#41; as for now and AFAIK, the only difference is us &#40;I have always encounter the issue, you always don&#39;t, I may be cursed&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Well, so what do you think - close the issue? I&#39;m undecided.
</div>
me too :&#41;
Perhaps you could put it on &#34;stall&#34; as it quite the case.

&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://aka.ms/weboutlook">http://aka.ms/weboutlook</a></span>&gt;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: T. Linden via RT &lt;bug-Config-General@rt.cpan.org&gt;
Sent: Monday, October 24, 2016 10:39 AM
To: justice__8@hotmail.com
Subject: [rt.cpan.org #118383] Variables interpolation sometimes doesn&#39;t work

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=118383">https://rt.cpan.org/Ticket/Display.html?id=118383</a></span> &gt;

Hi,

<div class="message-stanza open">&gt; Perl offer a way to choose hash function at build time
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://onionstand.blogspot.fr/2012/12/are-you-relying-on-hash-keys-">http://onionstand.blogspot.fr/2012/12/are-you-relying-on-hash-keys-</a></span>
&gt; being.html&#41;
</div>
I don&#39;t think this applies to Config::General, since it doesn&#39;t rely on key order. Sometimes the user might rely on key order, but not the module itself, that is.

<div class="message-stanza open">&gt; The fact that the exact same code behave in
&gt; two different ways on two different setups just confuses me.
</div>
This, indeed, confuses me as well. Really strange.

<div class="message-stanza open">&gt; So, using Tie::IxHash fix the issue.
</div>
Well, so what do you think - close the issue? I&#39;m undecided.



best regards,
Tom
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
