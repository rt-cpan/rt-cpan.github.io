<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #46830 for Catalyst-Example-InstantCRUD: 2 suggestions for InstantCRUD, and one possible bug</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #46830 for Catalyst-Example-InstantCRUD: 2 suggestions for InstantCRUD, and one possible bug</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Catalyst-Example-InstantCRUD">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Catalyst-Example-InstantCRUD">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Catalyst-Example-InstantCRUD">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Catalyst-Example-InstantCRUD">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Catalyst-Example-InstantCRUD">Catalyst-Example-InstantCRUD CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">46830</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Catalyst-Example-InstantCRUD">Catalyst-Example-InstantCRUD</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ramoore [...] axion-it.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Unimportant    </td>
  </tr>
  <tr id="CF-38130-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.0.30    </td>
  </tr>
  <tr id="CF-38131-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=46830">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-616852" href="/Public/Bug/Display.html?id=46830#txn-616852">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;10&nbsp;14:23:22&nbsp;2009</span>
    <span class="description">ramoore [...] axion-it.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 2 suggestions for InstantCRUD, and one possible bug</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/616852/313376/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/313376">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">These first two are not really bugs, just suggestions.

I&#39;m using Catalyst-Example-InstantCRUD v 0.0.30 with Catalyst 5.80004

1&#41; In the &#39;destroy&#39; sub, change the forward to a redirect, otherwise,
all the links on the following list page are wrong.
#        $c-&gt;forward&#40;&#39;list&#39;&#41;;
        $c-&gt;response-&gt;redirect&#40;$c-&gt;uri_for&#40;&#39;list&#39;&#41;&#41;;

2&#41; When pulling options from a related table in 
sub _options_from_resultset, it would be nice to have a way to pull in
something other than the PK field.

I overrode this routine and changed:
                while&#40; my $related_row = $related_rs-&gt;next &#41;{
                    $field-&gt;add_option&#40; $related_row-&gt;$pk =&gt;
$related_row-&gt;$pk &#41;;
                }
to:
                while&#40; my $related_row = $related_rs-&gt;next &#41;{
                    $field-&gt;add_option&#40; $related_row-&gt;$pk =&gt;
$related_row-&gt;display_name || $related_row-&gt;$pk &#41;;
                }

And then added an appropriate display_name method to each of my models.

But, I&#39;m sure there is a better way to generalize that idea.

The third issue is a possible bug.  But, I&#39;m not sure.  I&#39;m using MySQL
tables with auto_increment on the PK.  When start my test server and Add
an item to a table, it works perfectly the first time.  But, if I try to
add a second item, it fails.  It seem to try to UPDATE the previous
entry instead of INSERTing another new one.

Here is the debug output from the first, successful &#34;Add&#34;:
SELECT me.id, me.name FROM shopping_centers me WHERE &#40; me.id IS NULL &#41;: 
INSERT INTO shopping_centers &#40; id, name&#41; VALUES &#40; ?, ? &#41;: &#39;NULL&#39;, &#39;aaaa&#39;
[info] *** Request 13 &#40;0.481/s&#41; [23066] [Wed Jun 10 13:41:38 2009] ***
[debug] Body Parameters are:
.-------------------------------------+--------------------------------------.
| Parameter                           | Value                          
     |
+-------------------------------------+--------------------------------------+
| foo                                 | Add / Edit                     
     |
| id                                  |                                
     |
| name                                | aaaa                           
     |
&#39;-------------------------------------+--------------------------------------&#39;
[debug] &#34;POST&#34; request for &#34;shoppingcenters/edit&#34; from &#34;76.111.124.231&#34;
[debug] Path is &#34;shoppingcenters/edit&#34;
[debug] Found sessionid &#34;7785eea4550ee9183f1182882b207741b673128a&#34; in cookie
[debug] Restored session &#34;7785eea4550ee9183f1182882b207741b673128a&#34;
[debug] Redirecting to
&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://rh7.axion-it.com:3000/shoppingcenters/view/19">http://rh7.axion-it.com:3000/shoppingcenters/view/19</a></span>&#34;
[info] Request took 0.027832s &#40;35.930/s&#41;
.------------------------------------------------------------+-----------.
| Action                                                     | Time      |
+------------------------------------------------------------+-----------+
| /auto                                                      | 0.007691s |
| /shoppingcenters/auto                                      | 0.000682s |
| /shoppingcenters/edit                                      | 0.012079s |
| /end                                                       | 0.000321s |
&#39;------------------------------------------------------------+-----------&#39;

SELECT me.id, me.name FROM shopping_centers me WHERE &#40; me.id = ? &#41;: &#39;19&#39;
[info] *** Request 14 &#40;0.519/s&#41; [23066] [Wed Jun 10 13:41:38 2009] ***
[debug] &#34;GET&#34; request for &#34;shoppingcenters/view/19&#34; from &#34;76.111.124.231&#34;
[debug] Path is &#34;shoppingcenters/view&#34;
[debug] Arguments are &#34;19&#34;
[debug] Found sessionid &#34;7785eea4550ee9183f1182882b207741b673128a&#34; in cookie
[debug] Restored session &#34;7785eea4550ee9183f1182882b207741b673128a&#34;
[debug] Rendering template &#34;shoppingcenters/view.tt&#34;
[info] Request took 0.025501s &#40;39.214/s&#41;

And here is the output from the second, failed &#34;Add&#34;:

SELECT me.id, me.name FROM shopping_centers me WHERE &#40; me.id IS NULL &#41;: 
UPDATE shopping_centers SET id = ?, name = ? WHERE &#40; id = ? &#41;: &#39;NULL&#39;,
&#39;bbbbb&#39;, &#39;19&#39;
uri_for called with undef argument at
/usr/lib/perl5/site_perl/5.8.8/Catalyst/Example/Controller/InstantCRUD.pm line
75
Use of uninitialized value in substitution &#40;s///&#41; at
/usr/lib/perl5/site_perl/5.8.8/Catalyst.pm line 1193.
[info] *** Request 22 &#40;0.208/s&#41; [23066] [Wed Jun 10 13:42:57 2009] ***
[debug] Body Parameters are:
.-------------------------------------+--------------------------------------.
| Parameter                           | Value                          
     |
+-------------------------------------+--------------------------------------+
| foo                                 | Add / Edit                     
     |
| id                                  |                                
     |
| name                                | bbbbb                          
     |
&#39;-------------------------------------+--------------------------------------&#39;
[debug] &#34;POST&#34; request for &#34;shoppingcenters/edit&#34; from &#34;76.111.124.231&#34;
[debug] Path is &#34;shoppingcenters/edit&#34;
[debug] Found sessionid &#34;7785eea4550ee9183f1182882b207741b673128a&#34; in cookie
[debug] Restored session &#34;7785eea4550ee9183f1182882b207741b673128a&#34;
[debug] Redirecting to &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://rh7.axion-it.com:3000/shoppingcenters/view">http://rh7.axion-it.com:3000/shoppingcenters/view</a></span>&#34;
[info] Request took 0.027284s &#40;36.652/s&#41;
.------------------------------------------------------------+-----------.
| Action                                                     | Time      |
+------------------------------------------------------------+-----------+
| /auto                                                      | 0.007753s |
| /shoppingcenters/auto                                      | 0.000578s |
| /shoppingcenters/edit                                      | 0.011791s |
| /end                                                       | 0.000293s |
&#39;------------------------------------------------------------+-----------&#39;

[info] *** Request 23 &#40;0.217/s&#41; [23066] [Wed Jun 10 13:42:57 2009] ***
[debug] &#34;GET&#34; request for &#34;shoppingcenters/view&#34; from &#34;76.111.124.231&#34;
[debug] Path is &#34;shoppingcenters/view&#34;
[debug] Found sessionid &#34;7785eea4550ee9183f1182882b207741b673128a&#34; in cookie
[debug] Restored session &#34;7785eea4550ee9183f1182882b207741b673128a&#34;
[error] Caught exception in
Dw_Postings::Admin::Controller::ShoppingCenters-&gt;view &#34;You need to pass
an id at
/usr/lib/perl5/site_perl/5.8.8/Catalyst/Example/Controller/InstantCRUD.pm line
87.&#34;
[info] Request took 0.021008s &#40;47.601/s&#41;

I found that if I run this app in CGI mode, so that nothing but the
session, survives between calls, this problem does not occur.

Thanks much for making this module, it is very helpful as a starting point.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-644098" href="/Public/Bug/Display.html?id=46830#txn-644098">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;05&nbsp;13:18:32&nbsp;2009</span>
    <span class="description">zby [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/644098/329470/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/329470">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 734b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jun 10 14:23:22 2009, ramoore wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; These first two are not really bugs, just suggestions.
&gt; 
&gt; I&#39;m using Catalyst-Example-InstantCRUD v 0.0.30 with Catalyst 5.80004
&gt; 
&gt; 1&#41; In the &#39;destroy&#39; sub, change the forward to a redirect, otherwise,
&gt; all the links on the following list page are wrong.
&gt; #        $c-&gt;forward&#40;&#39;list&#39;&#41;;
&gt;         $c-&gt;response-&gt;redirect&#40;$c-&gt;uri_for&#40;&#39;list&#39;&#41;&#41;;
</div>
Fixed in 0.034 - thanks.

Ad. the lists of related rows - I&#39;ll check what can be done.

For the last problem - I am now using HTML::FormHandler as the base
processing module and it uses DBIx::Class::ResultSet::RecursiveUpdate
for the updates.  There was quite a bit or change - please check if the
problem still persists.

Cheers,
Zbigniew.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-644099" href="/Public/Bug/Display.html?id=46830#txn-644099">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;05&nbsp;13:18:33&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-715906" href="/Public/Bug/Display.html?id=46830#txn-715906">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;05&nbsp;21:07:31&nbsp;2010</span>
    <span class="description">ramoore [...] axion-it.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46830] 2 suggestions for InstantCRUD, and one possible bug</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 05 Jan 2010 21:07:36 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Catalyst-Example-InstantCRUD [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Randy Moore &lt;ramoore [...] axion-it.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/715906/369539/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/369539">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Zbigniew Lukasiak via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46830">https://rt.cpan.org/Ticket/Display.html?id=46830</a></span> &gt;
&gt;
&gt; On Wed Jun 10 14:23:22 2009, ramoore wrote:
&gt;   
<div class="message-stanza open">&gt;&gt; These first two are not really bugs, just suggestions.
&gt;&gt;
&gt;&gt; I&#39;m using Catalyst-Example-InstantCRUD v 0.0.30 with Catalyst 5.80004
&gt;&gt;
&gt;&gt; 1&#41; In the &#39;destroy&#39; sub, change the forward to a redirect, otherwise,
&gt;&gt; all the links on the following list page are wrong.
&gt;&gt; #        $c-&gt;forward&#40;&#39;list&#39;&#41;;
&gt;&gt;         $c-&gt;response-&gt;redirect&#40;$c-&gt;uri_for&#40;&#39;list&#39;&#41;&#41;;
&gt;&gt;     
</div>&gt;
&gt; Fixed in 0.034 - thanks.
&gt;
&gt; Ad. the lists of related rows - I&#39;ll check what can be done.
&gt;
&gt; For the last problem - I am now using HTML::FormHandler as the base
&gt; processing module and it uses DBIx::Class::ResultSet::RecursiveUpdate
&gt; for the updates.  There was quite a bit or change - please check if the
&gt; problem still persists.
&gt;
&gt; Cheers,
&gt; Zbigniew.
&gt;   
</div>Hi,  I finally had a chance to try the new HTML::FormHandler based 
InstantCRUD.  I&#39;m liking it very much.  But, I did still have the same 
&#40;or very similar&#41; problem the second time I try to add a new record to a 
table. 

I was able to work around the problem by passing a -&gt;new&#40;&#41; object to the 
form as and item when adding a new row, rather than just passing an 
undef row id.  I do not understand why that makes a difference, but it does.

Here is my revised &#34;edit&#34; routine:

sub edit : Local {
    my &#40; $self, $c, @pks &#41; = @_;

    my $item = &#40; @pks &#41; ? $self-&gt;model_item&#40; $c, @pks &#41; : 
$self-&gt;model_resultset&#40;$c&#41;-&gt;new&#40; {} &#41;;
   
    my $form = $self-&gt;form_class-&gt;new&#40;
        schema =&gt; $self-&gt;model_schema&#40;$c&#41;,
        params =&gt; $c-&gt;req-&gt;params,
        item   =&gt; $item,
    &#41;;
    if&#40; $c-&gt;req-&gt;method eq &#39;POST&#39; &#38;&#38; $form-&gt;process&#40;&#41; &#41;{
        my $item = $form-&gt;item;
        $c-&gt;res-&gt;redirect&#40; $c-&gt;uri_for&#40; &#39;view&#39;, $item-&gt;id &#41; &#41;;
        $c-&gt;stash&#40; item =&gt; $item &#41;;
    }
    if&#40; @pks &#41;{
        $form-&gt;field&#40; &#39;submit&#39; &#41;-&gt;value&#40; &#39;Update&#39; &#41;;
    }
    else{
        $form-&gt;field&#40; &#39;submit&#39; &#41;-&gt;value&#40; &#39;Create&#39; &#41;;
    }

    $c-&gt;stash&#40; form =&gt; $form-&gt;render &#41;;
}

Thanks much for sharing your code.

-- 
Randy Moore
Axion Information Technologies, Inc.

phone: 301-587-3300 x 511
fax:   240-744-7133

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.axion-it.com">http://www.axion-it.com</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/715906/369540/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/369540">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1759100" href="/Public/Bug/Display.html?id=46830#txn-1759100">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;21&nbsp;13:50:00&nbsp;2017</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1759100/946685/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/946685">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 84b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Marking ticket as rejected because InstantCRUD seems to have been removed from CPAN.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1759103" href="/Public/Bug/Display.html?id=46830#txn-1759103">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;21&nbsp;13:50:01&nbsp;2017</span>
    <span class="description">SHLOMIF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.309315</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
