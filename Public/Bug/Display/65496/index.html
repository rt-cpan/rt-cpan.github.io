<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #65496 for IO-Async: t/10loop-poll-io.t fails on NetBSD5.1 amd64</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #65496 for IO-Async: t/10loop-poll-io.t fails on NetBSD5.1 amd64</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=IO-Async">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=IO-Async">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=IO-Async">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=IO-Async">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Async">IO-Async CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">65496</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=IO-Async">IO-Async</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
TEAM [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-42614-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.38    </td>
  </tr>
  <tr id="CF-42615-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.39    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




build.log<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/893285/463094/build.log">
Sun Feb 06 01:28:28 2011 (6.2k) by TEAM [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=65496">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-893285" href="/Public/Bug/Display.html?id=65496#txn-893285">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;06&nbsp;01:28:28&nbsp;2011</span>
    <span class="description">TEAM [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> t/10loop-poll-io.t and 41detachedcode-call.t fail on NetBSD5.1 amd64</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/893285/463093/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/463093">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 631b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Got a couple of test failures on a new NetBSD5.1 install, the &#34;$hangup
after socket close&#34; one in t/10loop-poll-io.t is reproducible and the
&#34;$code-&gt;workers is now 0&#34; gave me a different error first time I ran it
&#40;timing issue perhaps?&#41; but didn&#39;t have the output logged that time
unfortunately, will update if I can trigger that again.

Only installed this VM a few hours ago, and I know very little about
*BSD so it&#39;s possibly an environment issue - using a perlbrew install
with usemultiplicity disabled to trace a separate issue, will try on
similar OpenBSD/FreeBSD setups to see if they behave any differently.

cheers,

Tom
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> build.log</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/893285/463094/build.log">Download build.log</a><br />
<span class="downloadcontenttype">text/x-log 6.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">/home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/bin/perl5.10.1 Build --makefile_env_macros 1 test
t/00use.t .................... ok
t/01timequeue.t .............. ok
t/02loop-magic.t ............. ok
t/03loop-osabstract.t ........ ok
t/04notifier.t ............... ok
t/05notifier-child.t ......... ok

#   Failed test &#39;$hangup after socket close&#39;
#   at /home/tom/.cpan/build/IO-Async-0.38-dic50f/blib/lib/IO/Async/LoopTests.pm line 267.
#          got: &#39;0&#39;
#     expected: &#39;1&#39;
# Looks like you failed 1 test of 20.
t/10loop-poll-io.t ........... 
Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
Failed 1/20 subtests 
t/10loop-select-io.t ......... ok
t/11loop-poll-timer.t ........ ok
t/11loop-select-timer.t ...... ok
t/12loop-poll-signal.t ....... ok
t/12loop-select-signal.t ..... ok
t/13loop-poll-idle.t ......... ok
t/13loop-select-idle.t ....... ok
t/14loop-poll-child.t ........ ok
t/14loop-select-child.t ...... ok
t/15loop-poll-control.t ...... ok
t/15loop-select-control.t .... ok
t/18loop-poll-legacy.t ....... ok
t/18loop-select-legacy.t ..... ok
t/19test.t ................... ok
t/20handle.t ................. ok
t/21stream-1read.t ........... ok
t/21stream-2write.t .......... ok
t/21stream-3split.t .......... ok
t/22timer-absolute.t ......... ok
t/22timer-countdown.t ........ ok
t/22timer-periodic.t ......... ok
t/23signal.t ................. ok
t/24listener.t ............... ok
t/25socket.t ................. ok
t/26pid.t .................... ok
t/30loop-fork.t .............. ok
t/31loop-spawnchild.t ........ ok
t/32loop-spawnchild-setup.t .. ok
t/33process.t ................ ok
t/34process-handles.t ........ ok
t/35loop-openchild.t ......... ok
t/36loop-runchild.t .......... ok
t/37loop-child-root.t ........ skipped: not root

#   Failed test &#39;$code-&gt;workers is now 0&#39;
#   at t/41detachedcode-call.t line 175.
#          got: &#39;1&#39;
#     expected: &#39;0&#39;
# Looks like you failed 1 test of 33.
t/41detachedcode-call.t ...... 
Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
Failed 1/33 subtests 
t/41function.t ............... ok
t/50resolver.t ............... ok
t/51loop-connect.t ........... ok
t/52loop-listen.t ............ ok
t/53loop-extend-connect.t .... ok
t/60protocol.t ............... ok
t/60sequencer-client.t ....... ok
t/60sequencer-server.t ....... ok
t/61protocol-stream.t ........ ok
t/62protocol-linestream.t .... ok
t/99pod.t .................... skipped: Test::Pod 1.00 required for testing POD

Test Summary Report
-------------------
t/10loop-poll-io.t         &#40;Wstat: 256 Tests: 20 Failed: 1&#41;
  Failed test:  13
  Non-zero exit status: 1
t/41detachedcode-call.t    &#40;Wstat: 256 Tests: 33 Failed: 1&#41;
  Failed test:  23
  Non-zero exit status: 1
Files=52, Tests=1247, 78 wallclock secs &#40; 0.42 usr  0.35 sys +  3.45 cusr  2.67 csys =  6.89 CPU&#41;
Result: FAIL
Failed 2/52 test programs. 2/1247 subtests failed.
*** Error code 255

Stop.
make: stopped in /home/tom/.cpan/build/IO-Async-0.38-dic50f
Summary of my perl5 &#40;revision 5 version 10 subversion 1&#41; configuration:
   
  Platform:
    osname=netbsd, osvers=netbsd, archname=amd64-netbsd
    uname=&#39;netbsd 5.1 netbsd 5.1 &#40;generic&#41; #0: sat nov 6 13:19:33 utc 2010 builds@b6.netbsd.org:homebuildsabnetbsd-5-1-releaseamd64201011061943z-objhomebuildsabnetbsd-5-1-releasesrcsysarchamd64compilegeneric amd64 &#39;
    config_args=&#39;-de -Dprefix=/home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult -Uusemultiplicity&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=undef, usemultiplicity=undef
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=define, use64bitall=define, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-fno-strict-aliasing -pipe -fstack-protector -I/usr/pkg/include&#39;,
    optimize=&#39;-O&#39;,
    cppflags=&#39;-fno-strict-aliasing -pipe -fstack-protector -I/usr/pkg/include&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.1.3 20080704 prerelease &#40;NetBSD nb2 20081120&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39; -Wl,-rpath,/usr/pkg/lib -Wl,-rpath,/usr/local/lib -fstack-protector -L/usr/pkg/lib&#39;
    libpth=/usr/pkg/lib /lib /usr/lib
    libs=-lm -lcrypt -lutil -lc -lposix
    perllibs=-lm -lcrypt -lutil -lc -lposix
    libc=/lib/libc.so, so=so, useshrplib=false, libperl=libperl.a
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E &#39;
    cccdlflags=&#39;-DPIC -fPIC &#39;, lddlflags=&#39;--whole-archive -shared  -L/usr/pkg/lib -fstack-protector&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: PERL_DONT_CREATE_GVSV USE_64_BIT_ALL USE_64_BIT_INT
                        USE_LARGE_FILES USE_PERLIO
  Built under netbsd
  Compiled at Feb  6 2011 04:10:15
  %ENV:
    PERL5LIB=&#34;/home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib/lib/perl5/amd64-netbsd:/home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib/lib/perl5:/home/tom/.cpan:/home/tom/.cpan/lib:/home/tom/.cpan/lib/perl5:/home/tom/.cpan/lib/perl5/site_perl:/home/tom/.cpan/lib/perl5/5.10.0/i486-linux-gnu-thread-multi:&#34;
    PERL_LOCAL_LIB_ROOT=&#34;/home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib&#34;
    PERL_MB_OPT=&#34;--install_base /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib&#34;
    PERL_MM_OPT=&#34;INSTALL_BASE=/home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib&#34;
    PERL_MM_USE_DEFAULT=&#34;1&#34;
  @INC:
    /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib/lib/perl5/amd64-netbsd
    /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib/lib/perl5/amd64-netbsd
    /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/local-lib/lib/perl5
    /home/tom/.cpan
    /home/tom/.cpan/lib
    /home/tom/.cpan/lib/perl5
    /home/tom/.cpan/lib/perl5/site_perl
    /home/tom/.cpan/lib/perl5/5.10.0/i486-linux-gnu-thread-multi
    /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/lib/5.10.1/amd64-netbsd
    /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/lib/5.10.1
    /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/lib/site_perl/5.10.1/amd64-netbsd
    /home/tom/perl5/perlbrew/perls/perl-5.10.1-nomult/lib/site_perl/5.10.1
    .
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-893412" href="/Public/Bug/Display.html?id=65496#txn-893412">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;06&nbsp;12:55:02&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> t/10loop-poll-io.t fails on NetBSD5.1 amd64</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/893412/463167/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/463167">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 641b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Feb 06 01:28:28 2011, TEAM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Got a couple of test failures on a new NetBSD5.1 install, the &#34;$hangup
&gt; after socket close&#34; one in t/10loop-poll-io.t is reproducible and the
&gt; &#34;$code-&gt;workers is now 0&#34; gave me a different error first time I ran it
&gt; &#40;timing issue perhaps?&#41; but didn&#39;t have the output logged that time
&gt; unfortunately, will update if I can trigger that again.
</div>
The $code-&gt;workers one seems to be an unreliable race condition sort of
bug; I&#39;ve raised it separately here:
  <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=65502">https://rt.cpan.org/Ticket/Display.html?id=65502</a></span>

I&#39;ll adjust the subject of this bug for just the 10loop-poll-io.t failure.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-893414" href="/Public/Bug/Display.html?id=65496#txn-893414">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;06&nbsp;12:55:03&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-893415" href="/Public/Bug/Display.html?id=65496#txn-893415">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;06&nbsp;12:55:18&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Severity Critical added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-894801" href="/Public/Bug/Display.html?id=65496#txn-894801">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;09&nbsp;06:29:50&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Subject changed from &#39;t/10loop-poll-io.t and 41detachedcode-call.t fail on NetBSD5.1 amd64&#39; to &#39;t/10loop-poll-io.t fails on NetBSD5.1 amd64&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895510" href="/Public/Bug/Display.html?id=65496#txn-895510">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;10&nbsp;17:18:24&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/895510/464271/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/464271">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 939b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Feb 06 01:28:28 2011, TEAM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Got a couple of test failures on a new NetBSD5.1 install, the &#34;$hangup
&gt; after socket close&#34; one in t/10loop-poll-io.t is reproducible and the
&gt; &#34;$code-&gt;workers is now 0&#34; gave me a different error first time I ran it
&gt; &#40;timing issue perhaps?&#41; but didn&#39;t have the output logged that time
&gt; unfortunately, will update if I can trigger that again.
</div>
So, after further investigation this whole POLLHUP thing appears to be
rather non-portable:

  <span class="clickylink"><a target="new" rel="nofollow" href="http://www.greenend.org.uk/rjk/2001/06/poll.html">http://www.greenend.org.uk/rjk/2001/06/poll.html</a></span>

Since on_hangup is entirely undocumented, unused internally, and newly
experimental, I&#39;ve decided to make it a Linux-only feature. Since the
code is there and does work on Linux, we might as well leave it in in
case anyone wants to use it, but with the portability caveat that &#34;it
won&#39;t work elsewhere&#34;. So now it&#39;s marked unsupported when not on Linux.

Patched in repo, will be in 0.39.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895512" href="/Public/Bug/Display.html?id=65496#txn-895512">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;10&nbsp;17:18:25&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895739" href="/Public/Bug/Display.html?id=65496#txn-895739">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;11&nbsp;10:06:53&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895741" href="/Public/Bug/Display.html?id=65496#txn-895741">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;11&nbsp;10:06:53&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Fixed in 0.39 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.436829</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
