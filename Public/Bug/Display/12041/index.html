<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #12041 for CGI-SSI: Infinite looping Error.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #12041 for CGI-SSI: Infinite looping Error.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CGI-SSI/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CGI-SSI/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CGI-SSI/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CGI-SSI/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI-SSI">CGI-SSI CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">12041</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CGI-SSI/Active/">CGI-SSI</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">james [...] bitperfect.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dsmith [...] avitar.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-5948-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.82    </td>
  </tr>
  <tr id="CF-5949-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;28&nbsp;17:57:19&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Infinite looping Error.</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If you accidently have an include that is parsed as a virtual includes, and you use cache all error handling &#40;ie a script that displays an alternate 404 error page&#41; for your webserver &#40;fairly prevelent&#41; in your webserver, you can cause an infinite loop for this module causing memory problems/overflows/etc. depending on your flavor of webserver.

This has been tested under windows 2000, xp, and 2003 using the most recent stable builds of ActiveState Perl versions 5.6 and 5.8 under Apache 2.0.49 to 2.0.53; Other OS&#39;s, distributions of perl, and webservers should also be vulrable to this error which may crash your webserver/OS since perl modules are theoritically portable and nearly platform independent.

Earlier versions of this module may have the same logic error as well.

Suggested Fixes include directory testing for local relative directories at the very least using &#39;-e&#39; with the relative path. This would require that the document root of the webserver &#40;which translates into the URL&#41; would need to be logically attained and/or provided as input into the module for translation.

The error appears to be in sub _include_virtual:

This original line:
    if&#40;$filename =~ m|^/|&#41; { # this is on the local server

Shoulde be reconsidered to something such as:
    if&#40;$filename =~ m|^/| &#38;&#38; -e $self-&gt;_include_file&#40;$self-&gt;{&#39;_variables&#39;}-&gt;{&#39;DOCUMENT_ROOT&#39;}.$filename&#41; { # this is on the local server
...etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;03&nbsp;18:28:35&nbsp;2005</span>
    <span class="description">james [...] bitperfect.com -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;03&nbsp;18:28:35&nbsp;2005</span>
    <span class="description">james [...] bitperfect.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[guest - Mon Mar 28 17:57:19 2005]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This original line:
&gt;     if&#40;$filename =~ m|^/|&#41; { # this is on the local server
&gt; 
&gt; Shoulde be reconsidered to something such as:
&gt;     if&#40;$filename =~ m|^/| &#38;&#38; -e $self-&gt;_include_file&#40;$self-
<div class="message-stanza open">&gt;    &gt;{&#39;_variables&#39;}-&gt;{&#39;DOCUMENT_ROOT&#39;}.$filename&#41; { # this is on the
</div>&gt;    local server
</div>
Hello and Thank You for Your Input,

I don&#39;t see that there&#39;s a bug here. If I were to add the code that you
suggest, I think that the erroneous directive would still be changed
into the currently-configured error message. That seems like appropriate
behavior, since there is an error in the directive. It seems that it&#39;s
possible to shoot yourself in the foot here, but that&#39;s not the problem
of the module. As you say, &#34;If you accidentally...&#34;.

I see that there&#39;s a possibility to create circular includes which go on
forever, creating real problems. However, I don&#39;t see that it&#39;s the
fault of the module as it&#39;s written. If you would like for me to write
in a failsafe where a file can only be included x number of times &#40;for
example&#41;, that&#39;s one thing. But it sounds like you&#39;re asking for
something else here.

If you would like to continue this thread, please submit a new ticket.
Please provide an example of the module breaking, with example
filenames, code, shtml, etc.

Thanks Again,

James Tolley
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Give even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;03&nbsp;18:28:36&nbsp;2005</span>
    <span class="description">james [...] bitperfect.com -  Given to JAMES</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;04&nbsp;01:55:24&nbsp;2005</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[JAMES - Tue May  3 18:28:35 2005]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [guest - Mon Mar 28 17:57:19 2005]:
&gt; 
<div class="message-stanza open">&gt; &gt; This original line:
&gt; &gt;     if&#40;$filename =~ m|^/|&#41; { # this is on the local server
&gt; &gt; 
&gt; &gt; Shoulde be reconsidered to something such as:
&gt; &gt;     if&#40;$filename =~ m|^/| &#38;&#38; -e $self-&gt;_include_file&#40;$self-
<div class="message-stanza open">&gt; &gt;    &gt;{&#39;_variables&#39;}-&gt;{&#39;DOCUMENT_ROOT&#39;}.$filename&#41; { # this is on the
</div>&gt; &gt;    local server
</div>&gt; 
&gt; Hello and Thank You for Your Input,
&gt; 
&gt; I don&#39;t see that there&#39;s a bug here. If I were to add the code that 
</div>you
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; suggest, I think that the erroneous directive would still be changed
&gt; into the currently-configured error message. That seems like 
</div>appropriate
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; behavior, since there is an error in the directive. It seems that it&#39;s
&gt; possible to shoot yourself in the foot here, but that&#39;s not the 
</div>problem
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; of the module. As you say, &#34;If you accidentally...&#34;.
&gt; 
&gt; I see that there&#39;s a possibility to create circular includes which go 
</div>on
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; forever, creating real problems. However, I don&#39;t see that it&#39;s the
&gt; fault of the module as it&#39;s written. If you would like for me to write
&gt; in a failsafe where a file can only be included x number of times &#40;for
&gt; example&#41;, that&#39;s one thing. But it sounds like you&#39;re asking for
&gt; something else here.
&gt; 
&gt; If you would like to continue this thread, please submit a new ticket.
&gt; Please provide an example of the module breaking, with example
&gt; filenames, code, shtml, etc.
&gt; 
&gt; Thanks Again,
&gt; 
&gt; James Tolley
</div>
Other modules of this flavor I have used have a maximum recursion 
level. Contray to what you belive this is the type of failsafe that I 
was interested in this modules inclusion to prevent endless loops in 
memory.

This is an accident that is likely to occour in web servers since close 
to one quarter of all servers I have encountered run perl, cpan 
modules, shtml, and custom error handelings &#40;ie. 404 redirects&#41;. While 
no one expects any programmer to create error handeling for unlikely 
events, this is likely to occour due to normal human error though day 
to day usage. 

Therefore I belive it is prudent to check to see if this module is 
calling itself repetiously, and to build in a way of catching the 
endless loop.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;04&nbsp;01:55:25&nbsp;2005</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;May&nbsp;07&nbsp;11:49:09&nbsp;2005</span>
    <span class="description">james [...] bitperfect.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
