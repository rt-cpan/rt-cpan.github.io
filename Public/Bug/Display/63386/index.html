<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #63386 for Spreadsheet-ParseExcel: Better detection of date-fields</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #63386 for Spreadsheet-ParseExcel: Better detection of date-fields</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">63386</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ftl [...] dnv.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.58    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




us_date.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/861692/446005/us_date.pl">
Mon Nov 29 16:24:59 2010 (748b) by ftl [...] dnv.com
</a>
</font></li>
</ul>


us_date.xls<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/861692/446006/us_date.xls">
Mon Nov 29 16:24:59 2010 (83.5k) by ftl [...] dnv.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;27&nbsp;15:28:51&nbsp;2010</span>
    <span class="description">ftl [...] dnv.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Better detection of date-fields</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear Sir,

thank you for very useful module!


row 2099 in sub _NewCell in ParseExcel.pm

I recommend to extend the detection regexp of date-formats to include 
an optional [$-409] in front, and a ;@ at the end, as this seems to be 
quite common date format extentions. &#40;as in &#34;[$-409]d\\-mmm\\-yy;@&#34;&#41;

See <span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/questions/894805/excel-number-format-what-">http://stackoverflow.com/questions/894805/excel-number-format-what-</a></span>
is-409 for details about 409 and other regionale settings.

In addition, this regexp should be made configurable, to accept 
strange local issues, on request.

I have also added a few more separation chars, and replaced }i with 
dmyDMY.

Hopefully this may contribute to further enhancements of this very 
fine and useful module.


best regards

Frode T. Lie
Code to insert at row 2099
        my $date_re = &#40;$oBook-&gt;{DateRegExp} ||= qr{^&#40;?:\[\$\-\d+\]&#41;?
[dmyDMY][;,-\s\\/dmyDMY]*&#40;?:;\@&#41;?$}&#41;;
        if &#40; $FmtStr =~ $date_re &#41; { 
            $rhKey{Type} = &#34;Date&#34;;
        }
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;29&nbsp;13:32:30&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Frode,

I&#39;m not really clear on what the issue is. Perhaps you could submit an
example program and Excel file along the lines of the following guidelines:

<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Dist/Spreadsheet-ParseExcel/Active/">https://rt.cpan.org/Dist/Display.html?Queue=Spreadsheet-ParseExcel</a></span>

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;29&nbsp;13:32:33&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;29&nbsp;16:24:59&nbsp;2010</span>
    <span class="description">ftl [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ftl [...] dnv.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for the missing example

See attachement.

Actually, quite many international formats exists, so making the 
regexp customizeable would also make sense 

&#40;e.g. 
$oBook-&gt;{DateRegExp} = qr/^detect [my] date formats*/;
&#41;

in the example, i have extended the re to 
qr{^&#40;?:\[\$\-\d+\]&#41;?[dmyDMY][;,-\s\\/dmyDMY\.]*&#40;?:;\@&#41;?$};
including . as possible separator.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> us_date.pl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use Data::Dump qw&#40; dump &#41;;

require Spreadsheet::ParseExcel;

my $oBook = Spreadsheet::ParseExcel::Workbook-&gt;Parse&#40;&#39;us_date.xls&#39;&#41;;
#get the cell B2
foreach my $i &#40;1..5&#41; {
	my $oCell = $oBook-&gt;{Worksheet}[0]{Cells}[1][$i];
	#get the text format string for this cell &#40;its index&#41;
	my $FmtIdx = $oCell-&gt;get_format&#40;&#41;-&gt;{FmtIdx};
	my $format_string = $oBook-&gt;{FormatStr}{$FmtIdx};
	print &#34;Format index $FmtIdx, \nwhich is defined as &#39;$format_string&#39;, \n&#34;.
		&#34;but is detected as type: &#34;.$oCell-&gt;type&#40;&#41;.&#34;\n&#34;;
	my $alt_regexp = qr{^&#40;?:\[\$\-\d+\]&#41;?[dmyDMY][;,-\s\\/dmyDMY\.]*&#40;?:;\@&#41;?$};
	print &#34;\nWith regexp: $alt_regexp \nthe format is detected as &#39;&#34;.
		&#40;$format_string =~ $alt_regexp ? &#34;Date&#34; : &#34;Numeric&#34;&#41;.&#34;&#39;\n\n\n&#34;;
}



</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> us_date.xls</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/861692/446006/us_date.xls">Download us_date.xls</a><br />
<span class="downloadcontenttype">application/octet-stream 83.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;30&nbsp;04:41:23&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Nov 29 16:24:59 2010, ftl wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Actually, quite many international formats exists, so making the 
&gt; regexp customizeable would also make sense 
</div>
Hi,

The type&#40;&#41; and ChkType&#40;&#41; methods are fundamentally flawed and I would
prefer to deprecate them.

Excel doesn&#39;t have a native date cell type so reporting the cell type
based on a regular expression is never going to match all possible cases.

I would prefer a scheme where the format was more more readily available
so that the end-user could decide on the type themselves. Something like
this:

    my $num_format = $cell-&gt;get_num_format&#40;&#41;;

    if &#40;$num_format =~ /some regex/&#41; {
         # Do something
    }

When I get a chance I&#39;ll add this to the interface.

In the meantime if you would like to add a testcase for type&#40;&#41; it would
be very useful. Something along the lines of:

<span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/JMCNAMARA/Spreadsheet-ParseExcel-0.58/t/20_number_format_default.t">http://cpansearch.perl.org/src/JMCNAMARA/Spreadsheet-ParseExcel-0.58/t/20_number_format_default.t</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/JMCNAMARA/Spreadsheet-ParseExcel-0.58/t/21_number_format_user.t">http://cpansearch.perl.org/src/JMCNAMARA/Spreadsheet-ParseExcel-0.58/t/21_number_format_user.t</a></span>


If you are familiar with Git you can fork the code on GitHub:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/jmcnamara/spreadsheet-parseexcel">https://github.com/jmcnamara/spreadsheet-parseexcel</a></span>

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;11&nbsp;11:54:33&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Nov 27 15:28:51 2010, ftl wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; an optional [$-409] in front, and a ;@ at the end, as this seems to be 
&gt; quite common date format extentions. &#40;as in &#34;[$-409]d\\-mmm\\-yy;@&#34;&#41;
</div>
What does the trailing &#39;;@&#39; mean ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;11&nbsp;12:20:05&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 11 11:54:33 2014, DOUGW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What does the trailing &#39;;@&#39; mean ?
</div>
The &#39;@&#39; means &#39;text&#39; format for a number. The &#39;;&#39; is a separator.

A format can include the following 4 sections:

   positive_num_format;negative_num_format;zeroes_format;text_format

See the following &#40;expand show all&#41;:

<span class="clickylink"><a target="new" rel="nofollow" href="http://office.microsoft.com/en-gb/excel-help/create-or-delete-a-custom-number-format-HP005199500.aspx?redir=0">http://office.microsoft.com/en-gb/excel-help/create-or-delete-a-custom-number-format-HP005199500.aspx?redir=0</a></span>

Having said that, the format in the first post doesn&#39;t look correct.

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;11&nbsp;14:46:15&nbsp;2014</span>
    <span class="description">ftl [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Actually the initial format is correct, even if it looks strange. This is the main cause of the original article.

The [$-nnn] is a locale flag for date formats. Which makes even more sense to include it in the &#34;heuristic date detection algoritm&#34; &#40;Which should be customable/modifyable, as i presume e.g. non-norwegians would not expect that date formats would contain åååå instead of yyyy....&#41;. And for date-formats, negative numbers are not not allowed, so only ;@ is needed at the end &#40;try ;@@ at the end and enter a text to see the effect&#41;

btw: &#34;[$-409]d\\-mmm\\-yy;@&#34; was perl-encoded, so 
&#34;[$-409]d\-mmm\-yy;@&#34; would make more sense to enter in Excel.

kind regards
Frode
.   
ty. 11. mars 2014 12.20.05 skreiv JMCNAMARA:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Mar 11 11:54:33 2014, DOUGW wrote:
<div class="message-stanza open">&gt; &gt; What does the trailing &#39;;@&#39; mean ?
</div>&gt; 
&gt; The &#39;@&#39; means &#39;text&#39; format for a number. The &#39;;&#39; is a separator.
&gt; 
&gt; A format can include the following 4 sections:
&gt; 
&gt; positive_num_format;negative_num_format;zeroes_format;text_format
&gt; 
&gt; See the following &#40;expand show all&#41;:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://office.microsoft.com/en-gb/excel-help/create-or-delete-a-">http://office.microsoft.com/en-gb/excel-help/create-or-delete-a-</a></span>
&gt; custom-number-format-HP005199500.aspx?redir=0
&gt; 
&gt; Having said that, the format in the first post doesn&#39;t look correct.
&gt; 
&gt; John
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
