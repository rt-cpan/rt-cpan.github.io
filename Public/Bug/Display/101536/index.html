<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #101536 for Pod-Markdown: Pod::Markdown doesn&#39;t translate E&lt;copy&gt; correctly</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #101536 for Pod-Markdown: Pod::Markdown doesn&#39;t translate E&lt;copy&gt; correctly</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Pod-Markdown/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Pod-Markdown/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Pod-Markdown/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Pod-Markdown/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Pod-Markdown">Pod-Markdown CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">101536</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Pod-Markdown/Active/">Pod-Markdown</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
david [...] weintraub.name

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-229566-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-229567-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;14&nbsp;07:52:06&nbsp;2015</span>
    <span class="description">david [...] weintraub.name -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Pod::Markdown doesn&#39;t translate E&lt;copy&gt; correctly</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 14 Jan 2015 07:51:56 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Pod-Markdown [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Weintraub &lt;david [...] weintraub.name&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Version: Pod::Markdown: 2.002
Perl Version: 5.18.1
Operating System: Mac OS X 10.10 &#40;Yosemite&#41;

Description: When parsing code, Pod::Markdown doesn’t correctly translate E&lt;copy&gt;. This becomes 0xA9 rather than &#38;copy; as done in Pod::Html.

This maybe an error in Pod::Simple in handling escapes between 0x80 and 0xFF.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;21&nbsp;09:32:29&nbsp;2015</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101536] Pod::Markdown doesn&#39;t translate E&lt;copy&gt; correctly</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 21 Jan 2015 07:31:57 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Pod-Markdown [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Randy Stauner &lt;rwstauner [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Pod::Simple transparently decodes E&lt;&gt; sequences into unicode characters.
Pod::Html subclasses Pod::Simple::XHTML which passes text sequences through
HTML::Entities.
By default HTML::Entites encodes: control chars, high bit chars and &#39;&lt;&#39;,
&#39;&#38;&#39;, &#39;&gt;&#39;, &#39;&#39;&#39; and &#39;&#34;.

I&#39;d be happy to make it an option to pass text sequences through
HTML::Entities but I&#39;m not sure what the default should be.
I, for one, am perfectly happy encoding the files in utf-8 and embedding
the unicode characters.
HTML-encoding any printable ascii characters seems excessive in Markdown
&#40;it detracts from the simplicity of it&#41;.

So in my opinion the best default would be to skip printable ascii and
encode other characters: [^\n\r\t\x20-\x7e]

I&#39;d still prefer to make this an opt-in, so I&#39;m considering an option to
encode any explicitly specified characters
and adding a shortcut that would expand to the above list.

What do you think?


...
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;21&nbsp;09:32:29&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;21&nbsp;11:44:23&nbsp;2015</span>
    <span class="description">david [...] weintraub.name -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101536] Pod::Markdown doesn&#39;t translate E&lt;copy&gt; correctly</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 21 Jan 2015 11:43:28 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Pod-Markdown [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Weintraub &lt;david [...] weintraub.name&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It gets pretty complex:

Pod::Man: Always encodes both © and E&lt;copy&gt; as “X”.
Pod::Text - with encoding declared in my POD: Both © and E&lt;copy&gt; are translated correctly.
Pod::Text - without encoding declared in my POD: Both © and E&lt;copy&gt; are translated as 0xA9.
Pod::Html always encodes either © or E&lt;copy&gt; correctly as &#38;copy; — even if I don’t set the encoding.
Pod::Markdown  always encodes either © or E&lt;copy&gt; as 0xA9 whether or not encoding is declared in my POD.

I understand that the whole purpose of Markdown is to be readable even if it isn’t displayed as a formatted document. HTML entities certainly don’t help.

What about this:

Lower ASCII printable characters &#40;0x20 through 0x7E&#41; are always translated correctly
If I declare an encoding scheme, Pod::Markdown should translate the characters like Pod::Text does.
If I don’t declare an encoding scheme, and I use E&lt;xxx&gt; in my POD, all characters not in the range 0x20 to 0x7E should be converted into HTML entities. I’ll be happy if this required a command line option.

--
David Weintraub
qazwart@gmail.com

perl -e &#39;print &#34;Just another second rate Perl Hacker\n&#34;;&#39;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Jan 21, 2015, at 9:32 AM, Randy Stauner via RT &lt;bug-Pod-Markdown@rt.cpan.org&gt; wrote:
&gt; 
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101536">https://rt.cpan.org/Ticket/Display.html?id=101536</a></span> &gt;
&gt; 
&gt; Pod::Simple transparently decodes E&lt;&gt; sequences into unicode characters.
&gt; Pod::Html subclasses Pod::Simple::XHTML which passes text sequences through
&gt; HTML::Entities.
&gt; By default HTML::Entites encodes: control chars, high bit chars and &#39;&lt;&#39;,
&gt; &#39;&#38;&#39;, &#39;&gt;&#39;, &#39;&#39;&#39; and &#39;&#34;.
&gt; 
&gt; I&#39;d be happy to make it an option to pass text sequences through
&gt; HTML::Entities but I&#39;m not sure what the default should be.
&gt; I, for one, am perfectly happy encoding the files in utf-8 and embedding
&gt; the unicode characters.
&gt; HTML-encoding any printable ascii characters seems excessive in Markdown
&gt; &#40;it detracts from the simplicity of it&#41;.
&gt; 
&gt; So in my opinion the best default would be to skip printable ascii and
&gt; encode other characters: [^\n\r\t\x20-\x7e]
&gt; 
&gt; I&#39;d still prefer to make this an opt-in, so I&#39;m considering an option to
&gt; encode any explicitly specified characters
&gt; and adding a shortcut that would expand to the above list.
&gt; 
&gt; What do you think?
&gt; 
&gt; 
&gt; ...
&gt; 
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;15&nbsp;12:01:47&nbsp;2015</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for the delay, but I finally got the time to finish this.

I was confused originally because I didn&#39;t realize we were talking about the bin scripts &#40;pod2man, pod2markdown, etc&#41;.
I was thinking about the Pod::Simple API which expects octets and returns a character string
and leaves it up to the caller to encode the result.

Obviously that&#39;s not the case for the bin script, where we need to be outputting bytes.

So, pod2markdown never specified any sort of encoding,
it was just dumping the characters.
So if the only high-bit characters in the output stream are &lt; 256 perl would print native bytes.

From what I can tell this is actually historical functionality...
The original version was based on Pod::Parser and
trustingly converted `E&lt;x&gt;` to `&#38;x;` but literal high-bit chars passed through directly.


I looked at the modules you mentioned to see how they do what they do:

Pod::Man&#39;s pod2man accepts a -u option which will enable utf-8 characters,
otherwise it tries for maximum compatibility with unknown *roff implementations
and just outputs an X.

Pod::Text has embedded logic to try to guess the best output encoding if it
wasn&#39;t specified.  It will match the input encoding of the pod &#40;if one was
specified&#41; or utf-8 if that was specified as an argument.

Pod::Html uses Pod::Simple::XHTML which passes all text through HTML::Entities by
default &#40;so `E&lt;copy&gt;` becomes U+00A9 which is then converted to `&#38;copy;`&#41;.


Without an `=encoding` specified, Pod::Simple
&#40;on which all of the aforementioned modules are currently based&#41;
will guess the encoding when it sees a high-bit character
&#40;so \xa9 is guessed to be CP1252 and \xc2\xa9 is guessed to be UTF-8&#41;.


So, I&#39;ve added some options to handle encoding for pod2markdown.
You can specify that it should use the same encoding as the input pod &#40;like Pod::Text&#41;.
You can specify the desired output encoding explicitly.
If you do neither it will output UTF-8 by default.

I considered making ascii &#40;and converting non-ascii to html entities&#41; the default,
however it&#39;s not 100% safe.  So I opted for simplicity and consistency and defaulted to UTF-8
while allowing options for alternate configurations.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;16&nbsp;18:19:02&nbsp;2015</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
