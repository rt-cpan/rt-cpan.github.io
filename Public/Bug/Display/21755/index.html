<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21755 for WebService-MusicBrainz: Bug fix for track_list sub-element of release</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21755 for WebService-MusicBrainz: Bug fix for track_list sub-element of release</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/WebService-MusicBrainz/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/WebService-MusicBrainz/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/WebService-MusicBrainz/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/WebService-MusicBrainz/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/WebService-MusicBrainz">WebService-MusicBrainz CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21755</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/WebService-MusicBrainz/Active/">WebService-MusicBrainz</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">bfaist [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
glitch241 [...] comcast.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39292-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39293-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;27&nbsp;20:12:33&nbsp;2006</span>
    <span class="description">glitch241 [...] comcast.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug fix for track_list sub-element of release</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Sep 2006 19:12:09 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WebService-MusicBrainz [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Powder &lt;glitch241 [...] comcast.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Version:  WebService-MusicBrainz-0.02
Perl Version: 5.8.7
Running with MusicBrainz version: unknown date: Sept 27, 2006

On a query for a Release with mbid and an inc of tracks, the Release has 
an undefined array as the track list; eventhough, the response XML has 
the track-list. An example of the response is:

&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;metadata xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/ns/mmd-1.0#&#34;">http://musicbrainz.org/ns/mmd-1.0#&#34;</a></span> 
xmlns:ext=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/ns/ext-1.0#&#34;&gt;">http://musicbrainz.org/ns/ext-1.0#&#34;&gt;</a></span>
&lt;release id=&#34;7279b0f3-7bf8-459a-8cbf-35f526f33d21&#34; type=&#34;Live Official&#34; &gt;
&lt;title&gt;Live at the El Mocambo&lt;/title&gt;
&lt;track-list&gt;
&lt;track id=&#34;c531d718-dad7-4038-9e31-777874dbcc7f&#34;&gt;&lt;title&gt;Mystery 
Dance&lt;/title&gt;&lt;duration&gt;139000&lt;/duration&gt;&lt;/track&gt;
...
&lt;/track-list&gt;
&lt;/release&gt;

It appears that the code in Response.pm expects to receive only a 
track-list as the root element and not a sub-element of release.  
Attached to this email is a copy of the Response.pm that has been 
updated to correct the problem.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">package WebService::MusicBrainz::Response;

use strict;
use XML::Twig;

our $VERSION = &#39;0.02&#39;;

=head1 NAME

WebService::MusicBrainz::Response

=head1 SYNOPSIS

=head1 DESCRIPTION

This module will hide the details of the XML web service response and provide an API to query the XML data which has been returned.  This module is responsible for parsing the XML web service response and instantiating objects to provide access to the details of the response.

=head1 METHODS

=head2 new&#40;&#41;

This method is the constructor and it will call for  initialization.

=cut

sub new {
   my $class = shift;
   my %params = @_;
   my $self = {};

   bless $self, $class;

   $self-&gt;{_xml} = $params{XML} || die &#34;XML parameter required&#34;;

   $self-&gt;_get_twig&#40;&#41;;

   $self-&gt;_init&#40;&#41;;

   return $self;
}

=head2 _get_twig&#40;&#41;

This method will create an XML::Twig object and parse the XML response which is then stored in the XML::Twig object.

=cut

sub _get_twig {
   my $self = shift;

   my $xTwig = XML::Twig-&gt;new&#40;&#41;;

   $xTwig-&gt;safe_parse&#40;$self-&gt;{_xml}&#41; or die &#34;Failure to parse XML&#34;;

   my $xRoot = $xTwig-&gt;root&#40;&#41;;

   $self-&gt;{_xmltwig} = $xRoot;

   return;
}

=head2 as_xml&#40;&#41;

This method returns the raw XML from the MusicBrainz web service response.

=cut

sub as_xml {
   my $self = shift;

   return $self-&gt;{_xml};
}

=head2 _init&#40;&#41;

This method will parse the XML response and act as a factory to generate the collection of WebService::MusicBrainz::Response::* objects that represent the XML data.

=cut

sub _init {
   my $self = shift;

   my $xRoot = $self-&gt;{_xmltwig} || return;

   require WebService::MusicBrainz::Response::Metadata;

   my $metadata = WebService::MusicBrainz::Response::Metadata-&gt;new&#40;&#41;;

   $metadata-&gt;generator&#40; $xRoot-&gt;att&#40;&#39;generator&#39;&#41; &#41; if $xRoot-&gt;att&#40;&#39;generator&#39;&#41;;
   $metadata-&gt;created&#40; $xRoot-&gt;att&#40;&#39;created&#39;&#41; &#41; if $xRoot-&gt;att&#40;&#39;created&#39;&#41;;

   my @artist_list;
   my @release_list;
   my @track_list;

   if&#40;$xRoot-&gt;first_child&#40;&#39;artist&#39;&#41;&#41; {
      my $xArtist = $xRoot-&gt;first_child&#40;&#39;artist&#39;&#41;;

      my $artist = _create_artist&#40; $xArtist &#41;;

      push @artist_list, $artist;

   } elsif&#40;$xRoot-&gt;first_child&#40;&#39;artist-list&#39;&#41;&#41; {
      foreach my $xArtist &#40;$xRoot-&gt;get_xpath&#40;&#39;artist-list/artist&#39;&#41;&#41; {
          my $artist = _create_artist&#40; $xArtist &#41;;

          push @artist_list, $artist;
      }
   } elsif&#40;$xRoot-&gt;first_child&#40;&#39;release&#39;&#41;&#41; {
      my $xRelease = $xRoot-&gt;first_child&#40;&#39;release&#39;&#41;;

      my $release = _create_release&#40; $xRelease &#41;;

      push @release_list, $release;

   } elsif&#40;$xRoot-&gt;first_child&#40;&#39;release-list&#39;&#41;&#41; {
      foreach my $xRelease &#40;$xRoot-&gt;get_xpath&#40;&#39;release-list/release&#39;&#41;&#41; {
          my $release = _create_release&#40; $xRelease &#41;;

          push @release_list, $release;
      }

   } elsif&#40;$xRoot-&gt;first_child&#40;&#39;track&#39;&#41;&#41; {
      my $xTrack = $xRoot-&gt;first_child&#40;&#39;track&#39;&#41;;

      my $track = _create_track&#40; $xTrack &#41;;

      push @track_list, $track;

   } elsif&#40;$xRoot-&gt;first_child&#40;&#39;track-list&#39;&#41;&#41; {
      foreach my $xTrack &#40;$xRoot-&gt;get_xpath&#40;&#39;track-list/track&#39;&#41;&#41; {
          my $track = _create_track&#40; $xTrack &#41;;

          push @track_list, $track;
      }

   }
   
   $metadata-&gt;artist_list&#40;\@artist_list&#41;;
   $metadata-&gt;track_list&#40;\@track_list&#41;;
   $metadata-&gt;release_list&#40;\@release_list&#41;;

   $self-&gt;{_metadata_cache} = $metadata;
}

=head2 artist&#40;&#41;

This method will return the first artist object from the artist list.

=cut

sub artist {
   my $self = shift;

   my $metadata = $self-&gt;{_metadata_cache};

   my $artist_list = $metadata-&gt;artist_list&#40;&#41;;

   return shift @{ $artist_list };
}

=head2 release&#40;&#41;

This method will return the first release object from the release list.

=cut

sub release {
   my $self = shift;

   my $metadata = $self-&gt;{_metadata_cache};

   my $release_list = $metadata-&gt;release_list&#40;&#41;;

   return shift @{ $release_list };
}

=head2 track&#40;&#41;

This method will return the first track object from the track list.

=cut

sub track {
   my $self = shift;

   my $metadata = $self-&gt;{_metadata_cache};

   my $track_list = $metadata-&gt;track_list&#40;&#41;;

   return shift @{ $track_list };
}

=head2 artist_list&#40;&#41;

This method will return the artist list.

=cut

sub artist_list {
   my $self = shift;

   my $metadata = $self-&gt;{_metadata_cache};

   my $artist_list = $metadata-&gt;artist_list&#40;&#41;;

   return wantarray ? @$artist_list : $artist_list;
}

=head2 release_list&#40;&#41;

This method will return the release list.

=cut

sub release_list {
   my $self = shift;

   my $metadata = $self-&gt;{_metadata_cache};

   my $release_list = $metadata-&gt;release_list&#40;&#41;;

   return wantarray ? @$release_list : $release_list;
}

=head2 track_list&#40;&#41;

This method will return the track list.

=cut

sub track_list {
   my $self = shift;

   my $metadata = $self-&gt;{_metadata_cache};

   my $track_list = $metadata-&gt;track_list&#40;&#41;;

   return wantarray ? @$track_list : $track_list;
}

=head2 _create_artist&#40;&#41;

Helper function to create a WebService::MusicBrainz::Response::Artist object and to populate it with data.
Internal use only.

=cut

sub _create_artist {
   my $xArtist = shift;

   require WebService::MusicBrainz::Response::Artist;

   my $artist = WebService::MusicBrainz::Response::Artist-&gt;new&#40;&#41;;

   $artist-&gt;id&#40; $xArtist-&gt;att&#40;&#39;id&#39;&#41; &#41; if $xArtist-&gt;att&#40;&#39;id&#39;&#41;;
   $artist-&gt;type&#40; $xArtist-&gt;att&#40;&#39;type&#39;&#41; &#41; if $xArtist-&gt;att&#40;&#39;type&#39;&#41;;
   $artist-&gt;name&#40; $xArtist-&gt;first_child&#40;&#39;name&#39;&#41;-&gt;text&#40;&#41; &#41; if $xArtist-&gt;first_child&#40;&#39;name&#39;&#41;;
   $artist-&gt;sort_name&#40; $xArtist-&gt;first_child&#40;&#39;sort-name&#39;&#41;-&gt;text&#40;&#41; &#41; 
            if $xArtist-&gt;first_child&#40;&#39;sort-name&#39;&#41;;
   $artist-&gt;disambiguation&#40; $xArtist-&gt;first_child&#40;&#39;disambiguation&#39;&#41;-&gt;text&#40;&#41; &#41; 
            if $xArtist-&gt;first_child&#40;&#39;disambiguation&#39;&#41;;
   $artist-&gt;life_span_begin&#40; $xArtist-&gt;first_child&#40;&#39;life-span&#39;&#41;-&gt;att&#40;&#39;begin&#39;&#41; &#41; 
            if $xArtist-&gt;first_child&#40;&#39;life-span&#39;&#41; &#38;&#38; $xArtist-&gt;first_child&#40;&#39;life-span&#39;&#41;-&gt;att&#40;&#39;begin&#39;&#41;;
   $artist-&gt;life_span_end&#40; $xArtist-&gt;first_child&#40;&#39;life-span&#39;&#41;-&gt;att&#40;&#39;end&#39;&#41; &#41; 
            if $xArtist-&gt;first_child&#40;&#39;life-span&#39;&#41; &#38;&#38; $xArtist-&gt;first_child&#40;&#39;life-span&#39;&#41;-&gt;att&#40;&#39;end&#39;&#41;;

   if&#40;$xArtist-&gt;first_child&#40;&#39;alias-list&#39;&#41;&#41; {
       my @alias_list;

       foreach my $xAlias &#40;$xArtist-&gt;get_xpath&#40;&#39;alias-list/alias&#39;&#41;&#41; {
           my $alias = _create_alias&#40;$xAlias&#41;;

	   push @alias_list, $alias;
       }

       $artist-&gt;alias_list&#40; \@alias_list &#41;;
   }

   if&#40;$xArtist-&gt;first_child&#40;&#39;relation-list&#39;&#41;&#41; {
       my @relation_list;

       foreach my $xRelation &#40;$xArtist-&gt;get_xpath&#40;&#39;relation-list/relation&#39;&#41;&#41; {
           my $relation = _create_relation&#40;$xRelation&#41;;

	   push @relation_list, $relation;
       }

       $artist-&gt;relation_list&#40; \@relation_list &#41;;
   }

   if&#40;$xArtist-&gt;first_child&#40;&#39;release-list&#39;&#41;&#41; {
       my @release_list;

       foreach my $xRelease &#40;$xArtist-&gt;get_xpath&#40;&#39;release-list/release&#39;&#41;&#41; {
           my $release = _create_release&#40;$xRelease&#41;;

	   push @release_list, $release;
       }

       $artist-&gt;release_list&#40; \@release_list &#41;;
   }

   return $artist;
}

=head2 _create_release&#40;&#41;

Helper function to create a WebService::MusicBrainz::Response::Release object and to populate it with data.
Internal use only.

=cut

sub _create_release {
   my $xRelease = shift;

   require WebService::MusicBrainz::Response::Release;

   my $release = WebService::MusicBrainz::Response::Release-&gt;new&#40;&#41;;

   $release-&gt;id&#40; $xRelease-&gt;att&#40;&#39;id&#39;&#41; &#41; if $xRelease-&gt;att&#40;&#39;id&#39;&#41;;
   $release-&gt;type&#40; $xRelease-&gt;att&#40;&#39;type&#39;&#41; &#41; if $xRelease-&gt;att&#40;&#39;type&#39;&#41;;
   $release-&gt;title&#40; $xRelease-&gt;first_child&#40;&#39;title&#39;&#41;-&gt;text&#40;&#41; &#41; if $xRelease-&gt;first_child&#40;&#39;title&#39;&#41;;
   $release-&gt;text_rep_language&#40; $xRelease-&gt;first_child&#40;&#39;text-representation&#39;&#41;-&gt;att&#40;&#39;language&#39;&#41; &#41;
        if $xRelease-&gt;first_child&#40;&#39;text-representation&#39;&#41; &#38;&#38; $xRelease-&gt;first_child&#40;&#39;text-representation&#39;&#41;-&gt;att&#40;&#39;language&#39;&#41;;
   $release-&gt;text_rep_script&#40; $xRelease-&gt;first_child&#40;&#39;text-representation&#39;&#41;-&gt;att&#40;&#39;script&#39;&#41; &#41;
        if $xRelease-&gt;first_child&#40;&#39;text-representation&#39;&#41; &#38;&#38; $xRelease-&gt;first_child&#40;&#39;text-representation&#39;&#41;-&gt;att&#40;&#39;script&#39;&#41;;
   $release-&gt;asin&#40; $xRelease-&gt;first_child&#40;&#39;asin&#39;&#41;-&gt;text&#40;&#41; &#41; if $xRelease-&gt;first_child&#40;&#39;asin&#39;&#41;;

   my $xArtist = $xRelease-&gt;first_child&#40;&#39;artist&#39;&#41;;

   if&#40;defined&#40;$xArtist&#41;&#41; {
       my $artist = _create_artist&#40;$xArtist&#41;;

       $release-&gt;artist&#40;$artist&#41;;
   }

    my @track_list;

    if &#40;$xRelease-&gt;first_child&#40;&#39;track-list&#39;&#41;&#41; {

      foreach my $xTrack &#40;$xRelease-&gt;get_xpath&#40;&#39;track-list/track&#39;&#41;&#41; {
          my $track = _create_track&#40; $xTrack &#41;;
          push @track_list, $track;
      }
    }

   $release-&gt;track_list&#40;\@track_list&#41;;

   return $release;
}

=head2 _create_track&#40;&#41;

Helper function to create a WebService::MusicBrainz::Response::Track object and to populate it with data.
Internal use only.

=cut

sub _create_track {
   my $xTrack = shift;

   require WebService::MusicBrainz::Response::Track;

   my $track= WebService::MusicBrainz::Response::Track-&gt;new&#40;&#41;;

   $track-&gt;id&#40; $xTrack-&gt;att&#40;&#39;id&#39;&#41; &#41; if $xTrack-&gt;att&#40;&#39;id&#39;&#41;;
   $track-&gt;title&#40; $xTrack-&gt;first_child&#40;&#39;title&#39;&#41;-&gt;text&#40;&#41; &#41; if $xTrack-&gt;first_child&#40;&#39;title&#39;&#41;;
   $track-&gt;duration&#40; $xTrack-&gt;first_child&#40;&#39;duration&#39;&#41;-&gt;text&#40;&#41; &#41; if $xTrack-&gt;first_child&#40;&#39;duration&#39;&#41;;

   my $xArtist = $xTrack-&gt;first_child&#40;&#39;artist&#39;&#41;;

   if&#40;defined&#40;$xArtist&#41;&#41; {
       my $artist = _create_artist&#40;$xArtist&#41;;

       $track-&gt;artist&#40;$artist&#41;;
   }

   my @release_list;

   foreach my $xRelease &#40;$xTrack-&gt;get_xpath&#40;&#39;release-list/release&#39;&#41;&#41; {
       my $release = _create_release&#40;$xRelease&#41;;

       push @release_list, $release;
   }

   $track-&gt;release_list&#40;\@release_list&#41;;

   return $track;
}

=head2 _create_alias&#40;&#41;

Helper function to create a WebService::MusicBrainz::Response::Alias object and to populate it with data.
Internal use only.

=cut

sub _create_alias {
   my $xAlias = shift;

   require WebService::MusicBrainz::Response::Alias;

   my $alias = WebService::MusicBrainz::Response::Alias-&gt;new&#40;&#41;;

   $alias-&gt;type&#40; $xAlias-&gt;att&#40;&#39;type&#39;&#41; &#41; if $xAlias-&gt;att&#40;&#39;type&#39;&#41;;
   $alias-&gt;script&#40; $xAlias-&gt;att&#40;&#39;script&#39;&#41; &#41; if $xAlias-&gt;att&#40;&#39;script&#39;&#41;;
   $alias-&gt;text&#40; $xAlias-&gt;text&#40;&#41; &#41; if $xAlias-&gt;text&#40;&#41;;

   return $alias;
}

=head2 _create_relation&#40;&#41;

Helper function to create a WebService::MusicBrainz::Response::Relation object and to populate it with data.
Internal use only.

=cut

sub _create_relation {
   my $xRelation = shift;

   require WebService::MusicBrainz::Response::Relation;

   my $relation = WebService::MusicBrainz::Response::Relation-&gt;new&#40;&#41;;

   $relation-&gt;type&#40; $xRelation-&gt;att&#40;&#39;type&#39;&#41; &#41; if $xRelation-&gt;att&#40;&#39;type&#39;&#41;;
   $relation-&gt;target&#40; $xRelation-&gt;att&#40;&#39;target&#39;&#41; &#41; if $xRelation-&gt;att&#40;&#39;target&#39;&#41;;
   $relation-&gt;direction&#40; $xRelation-&gt;att&#40;&#39;direction&#39;&#41; &#41; if $xRelation-&gt;att&#40;&#39;direction&#39;&#41;;
   $relation-&gt;attributes&#40; $xRelation-&gt;att&#40;&#39;attributes&#39;&#41; &#41; if $xRelation-&gt;att&#40;&#39;attributes&#39;&#41;;
   $relation-&gt;begin&#40; $xRelation-&gt;att&#40;&#39;begin&#39;&#41; &#41; if $xRelation-&gt;att&#40;&#39;begin&#39;&#41;;
   $relation-&gt;end&#40; $xRelation-&gt;att&#40;&#39;end&#39;&#41; &#41; if $xRelation-&gt;att&#40;&#39;end&#39;&#41;;

   if&#40;$xRelation-&gt;first_child&#40;&#39;artist&#39;&#41;&#41; {
       my $artist = _create_artist&#40;$xRelation-&gt;first_child&#40;&#39;artist&#39;&#41;&#41;;

       $relation-&gt;artist&#40;$artist&#41;;
   } elsif&#40;$xRelation-&gt;first_child&#40;&#39;release&#39;&#41;&#41; {
       my $release = _create_release&#40;$xRelation-&gt;first_child&#40;&#39;release&#39;&#41;&#41;;

       $relation-&gt;release&#40;$release&#41;;
   } elsif&#40;$xRelation-&gt;first_child&#40;&#39;track&#39;&#41;&#41; {
       my $track = _create_track&#40;$xRelation-&gt;first_child&#40;&#39;track&#39;&#41;&#41;;

       $relation-&gt;track&#40;$track&#41;;
   }

   return $relation;
}

=head1 AUTHOR

=over 4

=item Bob Faist &lt;bob.faist@gmail.com&gt;

=back

=head1 COPYRIGHT AND LICENSE

Copyright 2006 by Bob Faist

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

=head1 SEE ALSO

<span class="clickylink"><a target="new" rel="nofollow" href="http://wiki.musicbrainz.org/XMLWebService">http://wiki.musicbrainz.org/XMLWebService</a></span>

=cut

1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Give even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;27&nbsp;20:33:37&nbsp;2006</span>
    <span class="description">bfaist [...] cpan.org -  Given to BFAIST</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;27&nbsp;22:05:38&nbsp;2006</span>
    <span class="description">bfaist [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
