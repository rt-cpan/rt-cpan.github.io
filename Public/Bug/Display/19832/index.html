<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #19832 for CGI-Session: Non-bug :-&#41;: Adding ODBC support to CGI::Session</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #19832 for CGI-Session: Non-bug :-&#41;: Adding ODBC support to CGI::Session</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CGI-Session">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CGI-Session">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CGI-Session">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CGI-Session">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI-Session">CGI-Session CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">19832</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CGI-Session">CGI-Session</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MARKSTOS [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ron [...] savage.net.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-5872-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-5873-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




g4_mysql.t<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/207060/79423/g4_mysql.t">
Mon Jun 12 00:38:41 2006 (2.2k) by Guest
</a>
</font></li>
</ul>


g4_odbc.t<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/207060/79426/g4_odbc.t">
Mon Jun 12 00:38:41 2006 (2.2k) by Guest
</a>
</font></li>
</ul>


g4_postgresql.t<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/207060/79420/g4_postgresql.t">
Mon Jun 12 00:38:41 2006 (1.5k) by Guest
</a>
</font></li>
</ul>


Makefile.PL<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/207060/79429/Makefile.PL">
Mon Jun 12 00:38:41 2006 (2.8k) by Guest
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=19832">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-207060" href="/Public/Bug/Display.html?id=19832#txn-207060">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;12&nbsp;00:38:41&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Non-bug :-&#41;: Adding ODBC support to CGI::Session</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/207060/79417/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/79417">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 591b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve added a test which looks for an ODBC DSN.
Also, I&#39;ve cleaned up the usage of env vars for these 3 tests,
so they either use DBI_DSN/DBI_USER/DBI_PASS or they use env vars
specialized for each test.
Also, I&#39;ve changes the spelling of CGISESS_*_PASSWORD to
CGISESS_*_PASS to match both DBI_PASS and Rose::DB&#39;s spelling.
I&#39;ve patched the Makefile.PL too.
I&#39;ve tested this using ODBC to connect to both Oracle for Windows
and PostgreSQL for Windows, using CGI::Session::Driver::odbc,
and all tests pass, using CGI::Session V 4.14. In each case
the test program was running under Windows.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> g4_postgresql.t</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/207060/79420/g4_postgresql.t">Download g4_postgresql.t</a><br />
<span class="downloadcontenttype">text/x-perl 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"># $Id: /mirror/cgi-session/trunk/t/g4_postgresql.t 220 2005-08-30T11:47:14.305150Z sherzodr  $

use strict;
use diagnostics;

my %dsn;
if &#40;$ENV{DBI_DSN} &#38;&#38; &#40;$ENV{DBI_DSN} =~ m/^dbi:Pg:/&#41;&#41; {
    %dsn = &#40;
        DataSource  =&gt; $ENV{DBI_DSN},
        User        =&gt; $ENV{DBI_USER},
        Password    =&gt; $ENV{DBI_PASS},
        TableName   =&gt; &#39;sessions&#39;
    &#41;;
}
else {
    %dsn = &#40;
        DataSource  =&gt; $ENV{CGISESS_PG_DSN},
        User        =&gt; $ENV{CGISESS_PG_USER},
        Password    =&gt; $ENV{CGISESS_PG_PASS},
        TableName   =&gt; &#39;sessions&#39;
    &#41;;
}


use File::Spec;
use Test::More;
use CGI::Session::Test::Default;

unless &#40; $dsn{DataSource} &#41; {
    plan&#40;skip_all=&gt;&#34;DataSource is not known&#34;&#41;;
    exit&#40;0&#41;;
}

for &#40; &#34;DBI&#34;, &#34;DBD::Pg&#34; &#41; {
    eval &#34;require $_&#34;;
    if &#40; $@ &#41; {
        plan&#40;skip_all=&gt;&#34;$_ is NOT available&#34;&#41;;
        exit&#40;0&#41;;
    }
}

my $dbh = DBI-&gt;connect&#40;$dsn{DataSource}, $dsn{User}, $dsn{Password}, {RaiseError=&gt;0, PrintError=&gt;0}&#41;;
unless &#40; $dbh &#41; {
    plan&#40;skip_all=&gt;&#34;Couldn&#39;t establish connection with the PostgreSQL server&#34;&#41;;
    exit&#40;0&#41;;
}

my &#40;$count&#41; = $dbh-&gt;selectrow_array&#40;&#34;SELECT COUNT&#40;*&#41; FROM $dsn{TableName}&#34;&#41;;
unless &#40; defined $count &#41; {
    unless&#40; $dbh-&gt;do&#40;qq|
        CREATE TABLE $dsn{TableName} &#40;
            id CHAR&#40;32&#41; NOT NULL PRIMARY KEY,
            a_session TEXT NULL
        &#41;|&#41; &#41; {
        plan&#40;skip_all=&gt;$dbh-&gt;errstr&#41;;
        exit&#40;0&#41;;
    }
}

my $t = CGI::Session::Test::Default-&gt;new&#40;
    dsn =&gt; &#34;dr:postgresql&#34;,
    args=&gt;{Handle=&gt;$dbh, TableName=&gt;$dsn{TableName}}&#41;;

plan tests =&gt; $t-&gt;number_of_tests;
$t-&gt;run&#40;&#41;;

</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> g4_mysql.t</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/207060/79423/g4_mysql.t">Download g4_mysql.t</a><br />
<span class="downloadcontenttype">text/x-perl 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"># $Id: /mirror/cgi-session/trunk/t/g4_mysql.t 272 2006-02-14T11:29:59.639693Z sherzodr  $

use strict;
use diagnostics;

my %dsn;
if &#40;$ENV{DBI_DSN} &#38;&#38; &#40;$ENV{DBI_DSN} =~ m/^dbi:mysql:/&#41;&#41; {
    %dsn = &#40;
        DataSource  =&gt; $ENV{DBI_DSN},
        User        =&gt; $ENV{DBI_USER},
        Password    =&gt; $ENV{DBI_PASS},
        TableName   =&gt; &#39;sessions&#39;
    &#41;;
}
else {
    %dsn = &#40;
        DataSource  =&gt; $ENV{CGISESS_MYSQL_DSN},
        User        =&gt; $ENV{CGISESS_MYSQL_USER},
        Password    =&gt; $ENV{CGISESS_MYSQL_PASS},
        Socket      =&gt; $ENV{CGISESS_MYSQL_SOCKET},
        TableName   =&gt; &#39;sessions&#39;
    &#41;;
}


use File::Spec;
use Test::More;
use CGI::Session::Test::Default;

for &#40;qw/DBI DBD::mysql/&#41; {
    eval &#34;require $_&#34;;
    if &#40; $@ &#41; {
        plan&#40;skip_all=&gt;&#34;$_ is NOT available&#34;&#41;;
        exit&#40;0&#41;;
    }
}



require CGI::Session::Driver::mysql;
my $dsnstring = CGI::Session::Driver::mysql-&gt;_mk_dsnstr&#40;\%dsn&#41;;

my $dbh;
eval { $dbh = DBI-&gt;connect&#40;$dsnstring, $dsn{User}, $dsn{Password}, {RaiseError=&gt;0, PrintError=&gt;1}&#41; };
if &#40; $@ &#41; {
    plan&#40;skip_all=&gt;&#34;Couldn&#39;t establish connection with the MySQL server: &#34; . &#40;DBI-&gt;errstr || $@&#41;&#41;;
    exit&#40;0&#41;;
}

my $count;
eval { &#40;$count&#41; = $dbh-&gt;selectrow_array&#40;&#34;SELECT COUNT&#40;*&#41; FROM $dsn{TableName}&#34;&#41; };
unless &#40; defined $count &#41; {
    unless&#40; $dbh-&gt;do&#40;qq|
        CREATE TABLE $dsn{TableName} &#40;
            id CHAR&#40;32&#41; NOT NULL PRIMARY KEY,
            a_session TEXT NULL
        &#41;|&#41; &#41; {
        plan&#40;skip_all=&gt;&#34;Couldn&#39;t create $dsn{TableName}: &#34; . $dbh-&gt;errstr&#41;;
        exit&#40;0&#41;;
    }
}


my $t = CGI::Session::Test::Default-&gt;new&#40;
    dsn =&gt; &#34;dr:mysql&#34;,
    args=&gt;{Handle=&gt;$dbh, TableName=&gt;$dsn{TableName}}&#41;;


plan tests =&gt; $t-&gt;number_of_tests + 2;
$t-&gt;run&#40;&#41;;

{
    # This was documented to work in 3.95 and should be supported for compatibility
    my $obj;
    eval {
        # test.sessions will refer to the same &#39;sessions&#39; table but is a unique name to test with
        $CGI::Session::MySQL::TABLE_NAME = &#39;test.sessions&#39;;
        my $avoid_warning = $CGI::Session::MySQL::TABLE_NAME;
        require CGI::Session::Driver::mysql;
        $obj = CGI::Session::Driver::mysql-&gt;new&#40; {Handle=&gt;$dbh} &#41;;
    };
    is&#40;$@,&#39;&#39;, &#39;survived eval&#39;&#41;;
    is&#40;$obj-&gt;table_name, &#39;test.sessions&#39;, &#34;setting table name through CGI::Session::MySQL::TABLE_NAME works&#34;&#41;;
}




</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> g4_odbc.t</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/207060/79426/g4_odbc.t">Download g4_odbc.t</a><br />
<span class="downloadcontenttype">text/x-perl 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"># $Id: /mirror/cgi-session/trunk/t/g4_odbc.t 111 2006-06-06T06:06:06.060606Z Ron Savage  $

use strict;
use diagnostics;

my %dsn;
if &#40;$ENV{DBI_DSN} &#38;&#38; &#40;$ENV{DBI_DSN} =~ m/^dbi:ODBC:/&#41;&#41; {
    %dsn = &#40;
        DataSource  =&gt; $ENV{DBI_DSN},
        User        =&gt; $ENV{DBI_USER},
        Password    =&gt; $ENV{DBI_PASS},
        TableName   =&gt; &#39;sessions&#39;
    &#41;;
}
else {
    %dsn = &#40;
        DataSource  =&gt; $ENV{CGISESS_ODBC_DSN},
        User        =&gt; $ENV{CGISESS_ODBC_USER},
        Password    =&gt; $ENV{CGISESS_ODBC_PASS},
        TableName   =&gt; &#39;sessions&#39;
    &#41;;
}


use File::Spec;
use Test::More;
use CGI::Session::Test::Default;

for &#40;qw/DBI DBD::ODBC/&#41; {
    eval &#34;require $_&#34;;
    if &#40; $@ &#41; {
        plan&#40;skip_all=&gt;&#34;$_ is NOT available&#34;&#41;;
        exit&#40;0&#41;;
    }
}



my $dbh;
eval { $dbh = DBI-&gt;connect&#40;$dsn{DataSource}, $dsn{User}, $dsn{Password}, {RaiseError=&gt;0, PrintError=&gt;0, LongReadLen =&gt; 999}&#41; };
if &#40; $@ &#41; {
    plan&#40;skip_all=&gt;&#34;Couldn&#39;t establish connection with the ODBC driver: &#34; . &#40;DBI-&gt;errstr || $@&#41;&#41;;
    exit&#40;0&#41;;
}

my $count;
eval { &#40;$count&#41; = $dbh-&gt;selectrow_array&#40;&#34;SELECT COUNT&#40;*&#41; FROM $dsn{TableName}&#34;&#41; };
unless &#40; defined $count &#41; {
	my&#40;$session_type&#41; = $dsn{DataSource} =~ /Oracle/i ? &#39;long&#39; : &#39;text&#39;;
    unless&#40; $dbh-&gt;do&#40;qq|
        CREATE TABLE $dsn{TableName} &#40;
            id CHAR&#40;32&#41; NOT NULL PRIMARY KEY,
            a_session $session_type NULL
        &#41;|&#41; &#41; {
        plan&#40;skip_all=&gt;&#34;Couldn&#39;t create $dsn{TableName}: &#34; . $dbh-&gt;errstr&#41;;
        exit&#40;0&#41;;
    }
}


my $t = CGI::Session::Test::Default-&gt;new&#40;
    dsn =&gt; &#34;dr:odbc&#34;,
    args=&gt;{Handle=&gt;$dbh, TableName=&gt;$dsn{TableName}}&#41;;


plan tests =&gt; $t-&gt;number_of_tests + 2;
$t-&gt;run&#40;&#41;;

{
    # This was documented to work in 3.95 and should be supported for compatibility
    my $obj;
    eval {
        # test.sessions will refer to the same &#39;sessions&#39; table but is a unique name to test with
        $CGI::Session::ODBC::TABLE_NAME = &#39;test.sessions&#39;;
        my $avoid_warning = $CGI::Session::ODBC::TABLE_NAME;
        require CGI::Session::Driver::odbc;
        $obj = CGI::Session::Driver::odbc-&gt;new&#40; {Handle=&gt;$dbh} &#41;;
    };
    is&#40;$@,&#39;&#39;, &#39;survived eval&#39;&#41;;
    is&#40;$obj-&gt;table_name, &#39;test.sessions&#39;, &#34;setting table name through CGI::Session::ODBC::TABLE_NAME works&#34;&#41;;
}




</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Makefile.PL</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/207060/79429/Makefile.PL">Download Makefile.PL</a><br />
<span class="downloadcontenttype">text/x-perl 2.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"># $Id: /mirror/cgi-session/trunk/Makefile.PL 288 2006-03-09T11:08:34.672952Z tyler  $

use strict;
use Text::Wrap;
use File::Spec;
use lib &#39;./t/lib&#39;;
use ExtUtils::MakeMaker;

print &#34;-&#34; x 40, &#34;\n&#34;;
print fill&#40;&#34;&#34;, &#34;&#34;, &lt;&lt;&#39;MESSAGE&#39;&#41;;
#### WARNING ####

If you are using custom CGI::Session drivers they may not be compatible with the current driver specifications. You will need to make some changes to your drivers&#39; code before proceeding with this installation to make it compatible with CGI::Session 4.x.

Fortunately, current driver specifications are a lot easier to adapt to. Should you have any assistance re-coding your current drivers, please let me know.

Current driver specs are documented in CGI/Session/Driver.pm

#### TESTING #####

You are encouraged to run tests for the backend you will be using. The database backends that need a customized connection string won&#39;t run by default. To run them, some environment variables must be set.

The simplest method is to use the standard &#34;DBI_DSN/DBI_USER/DBI_PASS&#34; environment variables.

Otherwise, you can set these variables:
MESSAGE

print &#34;
For PostgreSQL:
    CGISESS_PG_DSN
    CGISESS_PG_USER
    CGISESS_PG_PASS

For MySQL:
    CGISESS_MYSQL_DSN
    CGISESS_MYSQL_USER
    CGISESS_MYSQL_PASS
    CGISESS_MYSQL_SOCKET

For ODBC:
    CGISESS_ODBC_DSN
    CGISESS_ODBC_USER
    CGISESS_ODBC_PASS

Note: For Oracle the sessions table must be declared as:
CREATE TABLE sessions
&#40;
    id CHAR&#40;32&#41; NOT NULL PRIMARY KEY,
    a_session long NULL
&#41;
whereas for MySQL, PostgreSQL etc it will be declared as:
CREATE TABLE sessions
&#40;
    id CHAR&#40;32&#41; NOT NULL PRIMARY KEY,
    a_session text NULL
&#41;
To make the ODBC test work under Oracle, just declare a DSN containing /Oracle/i,
e.g. CGISESS_ODBC_DSN=dbi:ODBC:oracle-test, so test t/g4_odbc.t can set the column type.

Warning: ODBC takes 16 &#40;sic&#41; seconds to connect to Oracle Database XE for Windows,
when the test program is running under Win2K, so be patient. WinXP is slightly faster.
&#34;;

print &#34;\n&#34;;
print &#34;-&#34; x 40, &#34;\n&#34;;

WriteMakefile&#40;
    NAME            =&gt; &#39;CGI::Session&#39;,
    VERSION_FROM            =&gt; &#39;lib/CGI/Session.pm&#39;,
    PREREQ_PM       =&gt; {
        &#39;Digest::MD5&#39;   =&gt; undef,
        &#39;Data::Dumper&#39;  =&gt; undef,
        &#39;Test::More&#39;    =&gt; undef,
        &#39;Scalar::Util&#39;  =&gt; undef,
    },
    ABSTRACT        =&gt; &#39;Persistent session data in CGI applications&#39;,
    AUTHOR          =&gt; &#39;Sherzod Ruzmetov &lt;sherzodr@cpan.org&gt;&#39;,
    clean           =&gt; { FILES =&gt; [ &#39;t/cgisess.*&#39;, &#39;t/sessiondata&#39; ] },
&#41;;

#
# Creating place for test-scripts. Some of the scripts needs this to be present
#
mkdir&#40;File::Spec-&gt;catfile&#40;&#39;t&#39;, &#39;sessiondata&#39;&#41;&#41;;



package MY;
use strict;




sub postamble {
    return &lt;&lt;&#39;MAKE_TEXT&#39;;
prepare_dist ::	metafile manifest dist
	$&#40;NOECHO&#41; $&#40;NOOP&#41;
MAKE_TEXT
}




sub libscan {
    my &#40;$self, $path&#41; = @_;
    return &#39;&#39; if $path =~ m/\.svn/;
    return $path;
}


</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-255668" href="/Public/Bug/Display.html?id=19832#txn-255668">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;25&nbsp;19:04:39&nbsp;2006</span>
    <span class="description">MARKSTOS [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-255682" href="/Public/Bug/Display.html?id=19832#txn-255682">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;25&nbsp;22:04:57&nbsp;2006</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/255682/110616/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/110616">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 312b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Although the title of this bug was about ODBC, most of the patches
weren&#39;t. Still, I liked the changes and am applying them subversion now. 

It seems ODBC support has been released in its own driver, as seems
best, so this ticket is resolvable on that count as well. 

Thanks for the contribution, Ron. 

  Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-255683" href="/Public/Bug/Display.html?id=19832#txn-255683">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;25&nbsp;22:04:58&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-255686" href="/Public/Bug/Display.html?id=19832#txn-255686">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;25&nbsp;22:04:59&nbsp;2006</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-255688" href="/Public/Bug/Display.html?id=19832#txn-255688">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;25&nbsp;22:11:33&nbsp;2006</span>
    <span class="description">ron [...] savage.net.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #19832] Non-bug :-&#41;: Adding ODBC support to  CGI::Session</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 26 Oct 2006 02:11:00 -0000 &#40;UTC&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Ron Savage&#34; &lt;ron [...] savage.net.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/255688/110620/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/110620">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 364b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Although the title of this bug was about ODBC, most of the patches
&gt; weren&#39;t. Still, I liked the changes and am applying them subversion now.
</div>
Thanx.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It seems ODBC support has been released in its own driver, as seems
&gt; best, so this ticket is resolvable on that count as well.
</div>
Right.
--
Ron Savage
ron@savage.net.au
<span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/index.html">http://savage.net.au/index.html</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-255689" href="/Public/Bug/Display.html?id=19832#txn-255689">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;25&nbsp;22:11:34&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-255703" href="/Public/Bug/Display.html?id=19832#txn-255703">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;25&nbsp;22:25:18&nbsp;2006</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.561621</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
