<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #41813 for Spreadsheet-ParseExcel: substr outside of string at /usr/lib64/perl5/site_perl/5.8.8/Spreadsheet/ParseExcel.pm line 1672.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #41813 for Spreadsheet-ParseExcel: substr outside of string at /usr/lib64/perl5/site_perl/5.8.8/Spreadsheet/ParseExcel.pm line 1672.</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-ParseExcel">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-ParseExcel">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-ParseExcel">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-ParseExcel">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">41813</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-ParseExcel">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gstead [...] cox.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




test.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/545482/274331/test.pl">
Thu Dec 18 14:07:03 2008 (204b) by gstead [...] cox.net
</a>
</font></li>
</ul>


test.xls<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/545482/274332/test.xls">
Thu Dec 18 14:07:04 2008 (33.5k) by gstead [...] cox.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=41813">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-545482" href="/Public/Bug/Display.html?id=41813#txn-545482">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;14:07:03&nbsp;2008</span>
    <span class="description">gstead [...] cox.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> substr outside of string at /usr/lib64/perl5/site_perl/5.8.8/Spreadsheet/ParseExcel.pm line 1672.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 18 Dec 2008 11:06:20 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Graham Stead &lt;gstead [...] cox.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/545482/274330/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/274330">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 905b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">First I&#39;d like to say that ParseExcel is way cool, and I use it a lot. I 
occasionally cannot parse Excel files, receiving the error: &#34;substr 
outside of string at 
/usr/lib64/perl5/site_perl/5.8.8/Spreadsheet/ParseExcel.pm line 1672.&#34;

I&#39;ve reduced a test file as much as possible: 1 row, 11 cells. The 
attached  test.pl script demonstrates the problem [it basically calls 
Parse&#40;&#41; ]. Is there some possibility you could look at this? I&#39;ve looked 
at ParseExcel.pm but don&#39;t understand Excel file internals.

Other information that may be helpful:

Distribution name and version: Spreadsheet::ParseExcel &#40;0.33&#41;
Perl version: v5.8.8 built for x86_64-linux
Operating System vendor and version: Linux snap 2.6.20-gentoo-r8 #3 SMP 
Sat Jul 14 11:14:30 PDT 2007 x86_64 Dual Core AMD Opteron&#40;tm&#41; Processor 
270 AuthenticAMD GNU/Linux

Please let me know if I can provide anything else.

best regards,
-Graham
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/545482/274331/test.pl">Download test.pl</a><br />
<span class="downloadcontenttype">text/x-perl 204b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use Spreadsheet::ParseExcel;

my $file = $ARGV[0] || &#34;test.xls&#34;;
print STDERR &#34;Spreadsheet::ParseExcel::Workbook-&gt;Parse&#40;$file&#41;\n&#34;;
my $excel = Spreadsheet::ParseExcel::Workbook-&gt;Parse&#40;$file&#41;;
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/545482/274332/test.xls">Download test.xls</a><br />
<span class="downloadcontenttype">application/vnd.ms-excel 33.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-548741" href="/Public/Bug/Display.html?id=41813#txn-548741">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;31&nbsp;08:47:25&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/548741/276098/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/276098">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 403b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 18 14:07:03 2008, gstead@cox.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; First I&#39;d like to say that ParseExcel is way cool, and I use it a lot. I 
&gt; occasionally cannot parse Excel files, receiving the error: &#34;substr 
&gt; outside of string at 
&gt; /usr/lib64/perl5/site_perl/5.8.8/Spreadsheet/ParseExcel.pm line 1672.&#34;
</div>
Hi Graham,

I haven&#39;t seen that bug before. 

I&#39;ll look into it but it looks a little tricky.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-548742" href="/Public/Bug/Display.html?id=41813#txn-548742">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;31&nbsp;08:47:25&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-548968" href="/Public/Bug/Display.html?id=41813#txn-548968">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;31&nbsp;15:50:02&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/548968/276225/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/276225">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 120b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Graham,

What version of Excel, or other spreadsheet application, was used to produce the test.xls file?

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-548971" href="/Public/Bug/Display.html?id=41813#txn-548971">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;31&nbsp;15:58:01&nbsp;2008</span>
    <span class="description">gstead [...] cox.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41813] substr outside of string at /usr/lib64/perl5/site_perl/5.8.8/Spreadsheet/ParseExcel.pm line 1672.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 31 Dec 2008 12:57:33 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Graham Stead &lt;gstead [...] cox.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/548971/276228/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/276228">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 760b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Our process goes something like this:

1&#41; An Excel is produced by Spreadsheet::WriteExcel
2&#41; Someone edits that file, either in Excel 2003 or Excel 2007. I can 
check if knowing the specific version is important.
3&#41; We read the file with Spreadsheet::ParseExcel, receiving the 
aforementioned error
4&#41; I edited the file in Excel 2007 to remove rows/columns that did not 
&#40;apparently&#41; cause the problem

Please let me know if this answers your question. I am happy to provide 
any additional information that may help.

best regards,
-Graham

John McNamara via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=41813">https://rt.cpan.org/Ticket/Display.html?id=41813</a></span> &gt;
&gt;
&gt; Hi Graham,
&gt;
&gt; What version of Excel, or other spreadsheet application, was used to produce the test.xls file?
&gt;
&gt; John.
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-548973" href="/Public/Bug/Display.html?id=41813#txn-548973">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;31&nbsp;16:01:33&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/548973/276230/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/276230">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 419b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Dec 31 15:58:01 2008, gstead@cox.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Our process goes something like this:
&gt; 
</div>
Hi Graham,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 1&#41; An Excel is produced by Spreadsheet::WriteExcel
</div>
Do you get the parse error if you process the file at that stage?


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2&#41; Someone edits that file, either in Excel 2003 or Excel 2007. I can
&gt; check if knowing the specific version is important.
</div>
Yes, let me know. It may be significant.

Thanks,

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-551380" href="/Public/Bug/Display.html?id=41813#txn-551380">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;08&nbsp;07:40:29&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/551380/277781/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/277781">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 544b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Dec 31 16:01:33 2008, JMCNAMARA wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Dec 31 15:58:01 2008, gstead@cox.net wrote:
<div class="message-stanza open">&gt; &gt; Our process goes something like this:
&gt; &gt; 
</div>&gt; 
&gt; Hi Graham,
&gt; 
<div class="message-stanza open">&gt; &gt; 1&#41; An Excel is produced by Spreadsheet::WriteExcel
</div>&gt; 
&gt; Do you get the parse error if you process the file at that stage?
&gt; 
&gt; 
<div class="message-stanza open">&gt; &gt; 2&#41; Someone edits that file, either in Excel 2003 or Excel 2007. I can
&gt; &gt; check if knowing the specific version is important.
</div>&gt; 
&gt; Yes, let me know. It may be significant.
&gt; 
&gt; Thanks,
&gt; 
&gt; John.
</div>

Hi Graham,

Any update on this?

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-552415" href="/Public/Bug/Display.html?id=41813#txn-552415">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;11&nbsp;09:57:31&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/552415/278340/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/278340">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 467b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 18 11:07:03 2008, gstead@cox.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I&#39;ve reduced a test file as much as possible: 1 row, 11 cells. The 
&gt; attached  test.pl script demonstrates the problem [it basically calls 
&gt; Parse&#40;&#41; ]. Is there some possibility you could look at this? I&#39;ve looked 
&gt; at ParseExcel.pm but don&#39;t understand Excel file internals.
</div>
Hi Graham,

I managed to isolate this issue so no further input is required.

There will be a fix in the next release.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-553421" href="/Public/Bug/Display.html?id=41813#txn-553421">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;13&nbsp;14:04:38&nbsp;2009</span>
    <span class="description">gstead [...] cox.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41813] substr outside of string at /usr/lib64/perl5/site_perl/5.8.8/Spreadsheet/ParseExcel.pm line 1672.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Jan 2009 11:04:02 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Graham Stead &lt;gstead [...] cox.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/553421/278928/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/278928">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 641b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">That&#39;s great news! Thanks again for your time.
-Graham

John McNamara via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=41813">https://rt.cpan.org/Ticket/Display.html?id=41813</a></span> &gt;
&gt;
&gt; On Thu Dec 18 11:07:03 2008, gstead@cox.net wrote:
&gt;   
<div class="message-stanza open">&gt;&gt; I&#39;ve reduced a test file as much as possible: 1 row, 11 cells. The 
&gt;&gt; attached  test.pl script demonstrates the problem [it basically calls 
&gt;&gt; Parse&#40;&#41; ]. Is there some possibility you could look at this? I&#39;ve looked 
&gt;&gt; at ParseExcel.pm but don&#39;t understand Excel file internals.
&gt;&gt;     
</div>&gt;
&gt; Hi Graham,
&gt;
&gt; I managed to isolate this issue so no further input is required.
&gt;
&gt; There will be a fix in the next release.
&gt;
&gt; John.
&gt;   
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-553668" href="/Public/Bug/Display.html?id=41813#txn-553668">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;14&nbsp;03:56:29&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/553668/279067/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/279067">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 94b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Hi,

This issue has been fixed in Spreadsheet::ParseExcel version 0.45.

Thanks,

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-553671" href="/Public/Bug/Display.html?id=41813#txn-553671">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;14&nbsp;03:56:30&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.664938</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
