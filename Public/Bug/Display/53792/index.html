<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #53792 for Term-ReadLine-Perl: Prompt with colors gets messed up</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #53792 for Term-ReadLine-Perl: Prompt with colors gets messed up</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Term-ReadLine-Perl/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Term-ReadLine-Perl/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Term-ReadLine-Perl/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Term-ReadLine-Perl/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Term-ReadLine-Perl">Term-ReadLine-Perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">53792</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Term-ReadLine-Perl/Active/">Term-ReadLine-Perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
roland [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-31192-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.0303    </td>
  </tr>
  <tr id="CF-31193-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




screenshot gnu.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/722080/372825/screenshot%20gnu.png">
Tue Jan 19 10:21:48 2010 (33.3k) by roland [...] cpan.org
</a>
</font></li>
</ul>


screenshot.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/721459/372528/screenshot.png">
Mon Jan 18 07:37:41 2010 (39.5k) by roland [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;18&nbsp;07:37:40&nbsp;2010</span>
    <span class="description">roland [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Prompt with colors gets messed up</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Using ANSI Colors in a prompt messes up the display as it seems that the for the internal 
prompt length calculation the ANSI control codes are not ignored.

PERL_RL=&#34;Perl o=0&#34; perl -MTerm::ReadLine -MTerm::ANSIColor=YELLOW,RESET -e &#39;new 
Term::ReadLine&#40;&#41;-&gt;readline&#40;YELLOW . &#34;H&#34; . RESET . &#34;ell&#34; . YELLOW . &#34;o&#34; . RESET . &#34; : &#34;&#41;&#39;

which gives looks like in the attachted screenshot.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> screenshot.png</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/721459/372528/screenshot.png">Download screenshot.png</a><br />
<span class="downloadcontenttype">image/png 39.5k</span>
</div>
<div class="messagebody">
<img alt="screenshot.png" title="screenshot.png" src="/Ticket/Attachment/721459/372528/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;18&nbsp;17:08:41&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 18 Jan 2010 14:08:23 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Roland Huss via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Jan 18, 2010 at 07:37:43AM -0500, Roland Huss via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Mon Jan 18 07:37:40 2010: Request 53792 was acted upon.
&gt; Transaction: Ticket created by ROLAND
&gt;        Queue: Term-ReadLine-Perl
&gt;      Subject: Prompt with colors gets messed up
&gt;    Broken in: 1.0303
&gt;     Severity: &#40;no value&#41;
&gt;        Owner: Nobody
&gt;   Requestors: roland@cpan.org
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=53792">https://rt.cpan.org/Ticket/Display.html?id=53792</a></span> &gt;
&gt; 
&gt; 
&gt; Using ANSI Colors in a prompt messes up the display as it seems that the for the internal 
&gt; prompt length calculation the ANSI control codes are not ignored.
&gt; 
&gt; PERL_RL=&#34;Perl o=0&#34; perl -MTerm::ReadLine -MTerm::ANSIColor=YELLOW,RESET -e &#39;new 
&gt; Term::ReadLine&#40;&#41;-&gt;readline&#40;YELLOW . &#34;H&#34; . RESET . &#34;ell&#34; . YELLOW . &#34;o&#34; . RESET . &#34; : &#34;&#41;&#39;
&gt; 
&gt; which gives looks like in the attachted screenshot.
</div>
Behaves as expected.  &#40;But improvements welcome.&#41;

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;18&nbsp;17:08:43&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;19&nbsp;10:04:15&nbsp;2010</span>
    <span class="description">roland [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Behaves as expected.  &#40;But improvements welcome.&#41;
</div>
You probably mean  &#39;works as designed&#39; ? Frankly, I would have 
expected something different &#40;i.e. taking into account &#39;invisible&#39; character
combinations like ANSI Escape sequences in the prompt when 
redisplaying&#41;.

Please don&#39;t get me wrong, I really love Term::ReadLine::Perl for it&#39;s
painless multiplatform support &#40;everyboy trying to install Term::ReadLine::Gnu
on a stock OS X can confirm this&#41; and I&#39;m consistently surprised about
the feature richness of Term::ReadLine::Perl. Chapeu !

And in fact, I looked into the code before opening this ticket but thought you are
closer to it as it seems that the code carries quite some &#39;historical baggage&#39;.
&#40;i.e. because you did a release recently&#41;

Nevertheless, your answer is clear and I will try to find a patch if I get into it.

In the meantime I disable prompt-coloring when using Term::ReadLine::Perl
and enable it for Term:ReadLine::Gnu for which prompt-coloring works unexpectedly ;-&#41;

Thanks again for this cool module. You can close the ticket, I would then open
a new one in case I have a patch. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;19&nbsp;10:11:39&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 19 Jan 2010 07:11:15 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Roland Huss via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Jan 19, 2010 at 10:04:16AM -0500, Roland Huss via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Behaves as expected.  &#40;But improvements welcome.&#41;
</div>&gt; 
&gt; You probably mean  &#39;works as designed&#39; ? Frankly, I would have 
&gt; expected something different
</div>
Probably, you never used any `readline&#39; package?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Nevertheless, your answer is clear and I will try to find a patch if I get into it.
</div>
Do not forget to look into the &#34;detailed&#34; docs of xterm &#40;available in
the distribution&#41; to see what can of worms it is...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In the meantime I disable prompt-coloring when using Term::ReadLine::Perl
&gt; and enable it for Term:ReadLine::Gnu for which prompt-coloring works unexpectedly ;-&#41;
</div>
Hmm, interesting...  Do not think it was there recently &#40;e.g., 10
years ago...&#41;.  This changes things.

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;19&nbsp;10:15:00&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 19 Jan 2010 07:14:32 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Roland Huss via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Jan 19, 2010 at 10:04:16AM -0500, Roland Huss via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In the meantime I disable prompt-coloring when using Term::ReadLine::Perl
&gt; and enable it for Term:ReadLine::Gnu for which prompt-coloring works unexpectedly ;-&#41;
</div>
What happens if you have multiline prompt, and edit multiline input so
that part of prompt goes off screen?  &#40;This is a functional equivalent
of &#34;our&#34; operation...&#41;

Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;19&nbsp;10:21:48&nbsp;2010</span>
    <span class="description">roland [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">For the notes, here&#39;s the similar screenshot for Term::ReadLine::Gnu

For muti-line prompts, I will try it as well.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> screenshot gnu.png</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/722080/372825/screenshot%20gnu.png">Download screenshot gnu.png</a><br />
<span class="downloadcontenttype">image/png 33.3k</span>
</div>
<div class="messagebody">
<img alt="screenshot gnu.png" title="screenshot gnu.png" src="/Ticket/Attachment/722080/372825/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;19&nbsp;10:50:58&nbsp;2010</span>
    <span class="description">roland [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What happens if you have multiline prompt, and edit multiline input so
&gt; that part of prompt goes off screen?  &#40;This is a functional equivalent
&gt; of &#34;our&#34; operation...&#41;
</div>
Sorry, don&#39;t know exactly how to do this one. Multi line prompt, ok, but what 
is required to allow multi-line input. Any options ? Can&#39;t find it in the 
documentation of Term::ReadLine either.

I guess, Term::ReadLine::Gnu use &#39;rl_expand_prompt&#39; for proper prompt handling &#40;though I 
didn&#39;t verify this&#41;. From the GNU Readline 6.1 documentation:

Function: int rl_expand_prompt &#40;char *prompt&#41;
Expand any special character sequences in prompt and set up the local Readline prompt 
redisplay variables. This function is called by readline&#40;&#41;. It may also be called to expand the 
primary prompt if the rl_on_new_line_with_prompt&#40;&#41; function or rl_already_prompted variable 
is used. It returns the number of visible characters on the last line of the &#40;possibly multi-line&#41; 
prompt. Applications may indicate that the prompt contains characters that take up no 
physical screen space when displayed by bracketing a sequence of such characters with the 
special markers RL_PROMPT_START_IGNORE and RL_PROMPT_END_IGNORE &#40;declared in 
`readline.h&#39;. This may be used to embed terminal-specific escape sequences in prompts.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;19&nbsp;17:01:07&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 19 Jan 2010 14:00:30 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Roland Huss via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Jan 19, 2010 at 10:51:01AM -0500, Roland Huss via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sorry, don&#39;t know exactly how to do this one. Multi line prompt, ok, but what 
&gt; is required to allow multi-line input.
</div>
With GNU, just enter quoted C-j...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Function: int rl_expand_prompt &#40;char *prompt&#41;
&gt; Expand any special character sequences in prompt and set up the local Readline prompt 
&gt; redisplay variables. This function is called by readline&#40;&#41;. It may also be called to expand the 
&gt; primary prompt if the rl_on_new_line_with_prompt&#40;&#41; function or rl_already_prompted variable 
&gt; is used. It returns the number of visible characters on the last line of the &#40;possibly multi-line&#41; 
&gt; prompt. Applications may indicate that the prompt contains characters that take up no 
&gt; physical screen space when displayed by bracketing a sequence of such characters with the 
&gt; special markers RL_PROMPT_START_IGNORE and RL_PROMPT_END_IGNORE &#40;declared in 
&gt; `readline.h&#39;. This may be used to embed terminal-specific escape sequences in prompts.
</div>
I see.  So it is as it always was: there is no support for
color-escapes &#40;except for manually bracketing them&#41;.  How would one
find RL_PROMPT_START_IGNORE and RL_PROMPT_END_IGNORE through
Term::ReadLine?

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;03:45:22&nbsp;2010</span>
    <span class="description">roland [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 19 17:01:07 2010, nospam-abuse@ilyaz.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Sorry, don&#39;t know exactly how to do this one. Multi line prompt, ok,
</div>&gt; but what
<div class="message-stanza open">&gt; &gt; is required to allow multi-line input.
</div>&gt; 
&gt; With GNU, just enter quoted C-j...
</div>
For bash this works, but using Term::ReadLine::GNU, I get

[osgish] : &#34;Bla Blub
need closing quote [&#34;] at char 0:
    &#34;Bla Blub
    ^
[osgish] :

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [...]
<div class="message-stanza open">&gt; &gt; physical screen space when displayed by bracketing a sequence of
</div>&gt; such characters with the
<div class="message-stanza open">&gt; &gt; special markers RL_PROMPT_START_IGNORE and RL_PROMPT_END_IGNORE
</div>&gt; &#40;declared in
<div class="message-stanza open">&gt; &gt; `readline.h&#39;. This may be used to embed terminal-specific escape
</div>&gt; sequences in prompts.
&gt; 
&gt; I see.  So it is as it always was: there is no support for
&gt; color-escapes &#40;except for manually bracketing them&#41;.  How would one
&gt; find RL_PROMPT_START_IGNORE and RL_PROMPT_END_IGNORE through
&gt; Term::ReadLine?
</div>
Actually I wouldn&#39;t mind to put the burden on the user. I.e. she is responsible
for mixing in the proper escapes when setting the prompt. Special control
characters are interpreted by the backend, which by coincidence could be the same
for Term::ReadLine::Gnu and Term::ReadLine::Perl. The frontend Term::ReadLine
itself is agnostic to the content of the prompt &#40;as it always was&#41;. Alternatively, 
Term::ReadLine could provide constants on its own &#40;to be respected by the backend&#41;
but I guess, this is out of scope as Term::ReadLine is bundled with Perl itself.

And in fact, Term::ReadLine::Gnu isn&#39;t that smart as I thought first. Color
prompting without escaping as described above seems to work, but if one 
uses the history and comes across an entry which is longer than the prompt
itself, then the display gets messed up, too &#40;an additonal length&#40;$prompt&#41;
offset for the input&#41;.

However, when I manually put in the escapes as described above
&#40;&#34;\01&#34; . YELLOW . &#34;\02&#34;&#41; everything works smoothely so far &#40;except 
that I still wasn&#39;t able to check multiline input&#41;.

bye ...
... roland
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;17:23:42&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 Jan 2010 14:23:22 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Roland Huss via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, Jan 20, 2010 at 03:45:24AM -0500, Roland Huss via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Actually I wouldn&#39;t mind to put the burden on the user. I.e. she is responsible
&gt; for mixing in the proper escapes when setting the prompt.
</div>
My question was: how would user find the bracketing characters using
&#40;only&#41; the Term::Readline interface?  &#40;So that user&#39;s code has a
chance to work with different backends...&#41;

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;18:33:27&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 Jan 2010 15:33:03 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Ilya Zakharevich via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, Jan 20, 2010 at 05:23:43PM -0500, Ilya Zakharevich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Term-ReadLine-Perl
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=53792">http://rt.cpan.org/Ticket/Display.html?id=53792</a></span> &gt;
&gt; 
&gt; On Wed, Jan 20, 2010 at 03:45:24AM -0500, Roland Huss via RT wrote:
<div class="message-stanza open">&gt; &gt; Actually I wouldn&#39;t mind to put the burden on the user. I.e. she is responsible
&gt; &gt; for mixing in the proper escapes when setting the prompt.
</div>&gt; 
&gt; My question was: how would user find the bracketing characters using
&gt; &#40;only&#41; the Term::Readline interface?  &#40;So that user&#39;s code has a
&gt; chance to work with different backends...&#41;
</div>
In fact, having 2 bracketing characters would not work with TRlP.  The
prompt may be substr&#40;&#41;inged; so we need &#34;0-length stuff which sticks
left&#34; &#40;as in &#34;end highlighting&#34;&#41;, and &#34;0-length stuff which sticks
right&#34; &#40;as in &#34;start highlighting&#34;&#41;.

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;19:18:54&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 Jan 2010 16:18:35 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Ilya Zakharevich via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, Jan 20, 2010 at 06:33:28PM -0500, Ilya Zakharevich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; My question was: how would user find the bracketing characters using
&gt; &gt; &#40;only&#41; the Term::Readline interface?  &#40;So that user&#39;s code has a
&gt; &gt; chance to work with different backends...&#41;
</div>&gt; 
&gt; In fact, having 2 bracketing characters would not work with TRlP.  The
&gt; prompt may be substr&#40;&#41;inged; so we need &#34;0-length stuff which sticks
&gt; left&#34; &#40;as in &#34;end highlighting&#34;&#41;, and &#34;0-length stuff which sticks
&gt; right&#34; &#40;as in &#34;start highlighting&#34;&#41;.
</div>
Thinking yet more: still not enough.  0-length stuff cmay control
out-of-band information &#40;such as xterm&#39;s title, xterm&#39;s
readline-mousing etc&#41;.

On the other hand, I can&#39;t invent a situation when leaving ALL
0-length stuff, and cutting out &#34;only printable substrings&#34; would hurt
the display &#40;all for the cases we need to substr&#40;&#41;ing the prompt...&#41;.

Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;21&nbsp;04:32:21&nbsp;2010</span>
    <span class="description">roland [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 20 17:23:42 2010, nospam-abuse@ilyaz.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed, Jan 20, 2010 at 03:45:24AM -0500, Roland Huss via RT wrote:
<div class="message-stanza open">&gt; &gt; Actually I wouldn&#39;t mind to put the burden on the user. I.e. she is
</div>&gt; responsible
<div class="message-stanza open">&gt; &gt; for mixing in the proper escapes when setting the prompt.
</div>&gt; 
&gt; My question was: how would user find the bracketing characters using
&gt; &#40;only&#41; the Term::Readline interface?  &#40;So that user&#39;s code has a
&gt; chance to work with different backends...&#41;
</div>
You are right, that the perfect solution where a user can semantically 
manage an *already* set RL prompt is really a heroic task &#40;as you give in your
examples&#41;. 

My assumption however was that for by far the most use cases the user is in 
complete control of the prompt and only sets this in TRl and never read it back.
Within this model, he can prepare the prompt in a concise form for the specific backend in
use.  He is also responsible for the proper bracket alignment and can decided on it&#39;s own,
which characters should be of 0-length. In my naive view, a TRl backend only needs to
take into account the markers and rely on a proper alignment as set by the client.

The backend, though, needs to keep track about the brackets. If I understand right, you 
suggest to keep two copies of the prompt, the original one and a &#39;clean&#39; version on which 
text manipulations are done. The challenge here is to keep track between the corresponding 
printable characters in both versions of the prompt. But where, except for multi line 
prompts, do you need text manipulations for prompt handling ? &#40;BTW, for multi-line 
prompts wouldn&#39;t it be nicer if Term::ReadLine::prompt&#40;&#41; would be able to be called with an 
arrayref ?&#41; 

Arghh. Never thought that terminal control is such a hard stuff. For sure, this discussion 
here increased my &#40;even already high&#41; respect for Term::ReadLine and its various backends ... 
;-&#41; Thanks a lot.

...roland
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;21&nbsp;07:10:43&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Jan 2010 04:10:10 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Roland Huss via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Jan 21, 2010 at 04:32:23AM -0500, Roland Huss via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Term-ReadLine-Perl
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=53792">https://rt.cpan.org/Ticket/Display.html?id=53792</a></span> &gt;
&gt; 
&gt; On Wed Jan 20 17:23:42 2010, nospam-abuse@ilyaz.org wrote:
<div class="message-stanza open">&gt; &gt; On Wed, Jan 20, 2010 at 03:45:24AM -0500, Roland Huss via RT wrote:
<div class="message-stanza open">&gt; &gt; &gt; Actually I wouldn&#39;t mind to put the burden on the user. I.e. she is
</div>&gt; &gt; responsible
<div class="message-stanza open">&gt; &gt; &gt; for mixing in the proper escapes when setting the prompt.
</div>&gt; &gt; 
&gt; &gt; My question was: how would user find the bracketing characters using
&gt; &gt; &#40;only&#41; the Term::Readline interface?  &#40;So that user&#39;s code has a
&gt; &gt; chance to work with different backends...&#41;
</div>&gt; 
&gt; You are right, that the perfect solution where a user can semantically 
&gt; manage an *already* set RL prompt is really a heroic task &#40;as you give in your
&gt; examples&#41;. 
&gt; 
&gt; My assumption however was that for by far the most use cases the user is in 
&gt; complete control of the prompt and only sets this in TRl and never read it back.
&gt; Within this model, he can prepare the prompt in a concise form for the specific backend in
&gt; use.
</div>
Sorry, but I have very little interest in this scenario.  If TR::Gnu
had provided an &#34;only-through T::R solution&#34; &#40;i.e, not
backend-cognizant&#41;, I might be interested to support it in TRP.  But
given that there is no pool of scripts which would suddently become
more usable due to my efforts, it looks this becomes quite a
theoretical exercise...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The backend, though, needs to keep track about the brackets. If I understand right, you 
&gt; suggest to keep two copies of the prompt, the original one and a &#39;clean&#39; version on which 
&gt; text manipulations are done.
</div>
I did not look in the code, but I think all I need is

  sub prompt_screen_width &#40;$&#41;;
  sub prompt_substr_keep_all_0length_escapes&#40;$$$&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; printable characters in both versions of the prompt. But where,
&gt; except for multi line prompts, do you need text manipulations for
&gt; prompt handling ?
</div>
I recall that TRP does not use any fancy terminal escapes.  Everything
is shown on one line.  As a corollary, prompt is shortened if too long
for 1-line display.

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;21&nbsp;07:25:49&nbsp;2010</span>
    <span class="description">roland [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for your efforts. For me the current situation is perfectly ok, I can live
without a colored prompt in TRP &#40;although it would be nice, too :&#41;

To avoid misunderstandings, by &#34;user&#34; I meant the &#39;user&#39; of the module &#40;i.e. a script&#41;, 
not the end-user &#40;so, the script using TR has control over the prompt and &#39;owns&#39; it. That&#39;s true 
at least for my own scripts&#41;.

Thanks again, let me know, when I can help testing sth. Or maybe &#40;but unlikely&#41; I have time to 
dive into the control character hell, too ;&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;21&nbsp;17:09:09&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #53792] Prompt with colors gets messed up</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Jan 2010 14:08:50 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Roland Huss via RT &lt;bug-Term-ReadLine-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Jan 21, 2010 at 07:25:52AM -0500, Roland Huss via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for your efforts. For me the current situation is perfectly ok, I can live
&gt; without a colored prompt in TRP &#40;although it would be nice, too :&#41;
&gt; 
&gt; To avoid misunderstandings, by &#34;user&#34; I meant the &#39;user&#39; of the module &#40;i.e. a script&#41;, 
&gt; not the end-user &#40;so, the script using TR has control over the prompt and &#39;owns&#39; it. That&#39;s true 
&gt; at least for my own scripts&#41;.
&gt; 
&gt; Thanks again, let me know, when I can help testing sth. Or maybe &#40;but unlikely&#41; I have time to 
&gt; dive into the control character hell, too ;&#41;
</div>
Did you notice a loophole?  If you make TR::Gnu announce &#34;a Feature&#34; presence,
and make the bracketing chars available via Attribs, then things
change.  ;-&#41;

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
