<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #66892 for version: normalize alpha version beginning with v</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #66892 for version: normalize alpha version beginning with v</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/version/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/version/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/version/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/version/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/version">version CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">66892</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/version/Active/">version</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mmaslano [...] redhat.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-34940-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.88    </td>
  </tr>
  <tr id="CF-34941-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;08:58:17&nbsp;2011</span>
    <span class="description">mmaslano [...] redhat.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> normalize alpha version beginning with v</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If I try normalize alpha version beginning with &#34;v&#34;, it creates very odd
version. Not sure if this is a bug or intentional behaviour.

perl -Mversion -e &#39;print version-&gt;parse&#40;1.02_23&#41;-&gt;normal&#39;
v1.22.300

perl -Mversion -e &#39;print version-&gt;parse&#40;v1.02_23&#41;-&gt;normal&#39;
v1.2_23
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;09:19:45&nbsp;2011</span>
    <span class="description">jpeacock [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Mar 25 08:58:17 2011, mmaslano@redhat.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If I try normalize alpha version beginning with &#34;v&#34;, it creates very odd
&gt; version. Not sure if this is a bug or intentional behaviour.
</div>
It is the unfortunate nature of Perl&#39;s own parser/tokenizer.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl -Mversion -e &#39;print version-&gt;parse&#40;1.02_23&#41;-&gt;normal&#39;
&gt; v1.22.300
</div>
The underscore is completely ignored by the parser because this is a
bare number &#40;which can contain underscores every other character&#41;.  So
what version-&gt;parse receives as a parameter is:

$ perl -MDevel::Peek -e &#39;my $vs = 1.02_03; Dump&#40;$vs&#41;&#39;
SV = NV&#40;0xa3f4370&#41; at 0xa3afee0
  REFCNT = 1
  FLAGS = &#40;PADMY,NOK,pNOK&#41;
  NV = 1.0203

which is then split on three decimal places by parse&#40;&#41; and thus becomes
v1.22.300.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl -Mversion -e &#39;print version-&gt;parse&#40;v1.02_23&#41;-&gt;normal&#39;
&gt; v1.2_23
</div>
This is interpreted by the Perl parser as a v-string &#40;which is a lossy
translation&#41;:

$ perl -MDevel::Peek -e &#39;my $vs = v1.02_03; Dump&#40;$vs&#41;&#39;
SV = PVMG&#40;0xbe6da30&#41; at 0xbe1aee0
  REFCNT = 1
  FLAGS = &#40;PADMY,RMG,POK,pPOK,UTF8&#41;
  IV = 0
  NV = 0
  PV = 0xbe310d0 &#34;\1\303\213&#34;\0 [UTF8 &#34;\x{1}\x{cb}&#34;]
  CUR = 3
  LEN = 8
  MAGIC = 0xbe3f370
    MG_VIRTUAL = 0
    MG_TYPE = PERL_MAGIC_vstring&#40;V&#41;
    MG_LEN = 8
    MG_PTR = 0xbe2d010 &#34;v1.02_03&#34;

However, the version.pm code takes the contents of the _original_ string
&#40;as stored in the MG_PTR structure above&#41;, and reparses it.  This means
the underscore is preserved and can be interpreted as an Alpha version.

If you want to force an Alpha version, and preserve what you mean in the
face of the Perl parser, you must quote the values you pass to version.pm.

On the other hand, if you want to always assume the version is a
dotted-decimal version &#40;with or without an alpha&#41;, then you should be
using version-&gt;declare instead of version-&gt;parse.  Thus:

$ perl -Mversion -MData::Dumper -e &#39;my $vs =
version-&gt;declare&#40;&#34;1.02_03&#34;&#41;; print Data::Dumper-&gt;Dumper&#40;$vs&#41;&#39;
$VAR1 = &#39;Data::Dumper&#39;;
$VAR2 = bless&#40; {
                 &#39;qv&#39; =&gt; 1,
                 &#39;alpha&#39; =&gt; 1,
                 &#39;original&#39; =&gt; &#39;v1.02_03&#39;,
                 &#39;version&#39; =&gt; [
                                1,
                                2,
                                3
                              ]
               }, &#39;version&#39; &#41;;

and

$ perl -Mversion -MData::Dumper -e &#39;my $vs =
version-&gt;declare&#40;&#34;v1.02_03&#34;&#41;; print Data::Dumper-&gt;Dumper&#40;$vs&#41;&#39;
$VAR1 = &#39;Data::Dumper&#39;;
$VAR2 = bless&#40; {
                 &#39;qv&#39; =&gt; 1,
                 &#39;alpha&#39; =&gt; 1,
                 &#39;original&#39; =&gt; &#39;v1.02_03&#39;,
                 &#39;version&#39; =&gt; [
                                1,
                                2,
                                3
                              ]
               }, &#39;version&#39; &#41;;

vs 

$ perl -Mversion -MData::Dumper -e &#39;my $vs = version-&gt;parse&#40;&#34;1.02_03&#34;&#41;;
print Data::Dumper-&gt;Dumper&#40;$vs&#41;&#39;
$VAR1 = &#39;Data::Dumper&#39;;
$VAR2 = bless&#40; {
                 &#39;width&#39; =&gt; 2,
                 &#39;alpha&#39; =&gt; 1,
                 &#39;original&#39; =&gt; &#39;1.02_03&#39;,
                 &#39;version&#39; =&gt; [
                                1,
                                20,
                                300
                              ]
               }, &#39;version&#39; &#41;;

and 

$ perl -Mversion -MData::Dumper -e &#39;my $vs = version-&gt;parse&#40;&#34;v1.02_03&#34;&#41;;
print Data::Dumper-&gt;Dumper&#40;$vs&#41;&#39;
$VAR1 = &#39;Data::Dumper&#39;;
$VAR2 = bless&#40; {
                 &#39;qv&#39; =&gt; 1,
                 &#39;alpha&#39; =&gt; 1,
                 &#39;original&#39; =&gt; &#39;v1.02_03&#39;,
                 &#39;version&#39; =&gt; [
                                1,
                                2,
                                3
                              ]
               }, &#39;version&#39; &#41;;

As you can see declare&#40;&#41;, which is an alias for qv&#40;&#41;, parses the same
string consistently with or without a leading &#39;v&#39;, but parse&#40;&#41;/new&#40;&#41;
acts differently whether the leading &#39;v&#39; is there or not.

Hope this helps...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;09:19:46&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;09:28:26&nbsp;2011</span>
    <span class="description">jpeacock [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;10:33:53&nbsp;2011</span>
    <span class="description">mmaslano [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> mmaslano [...] redhat.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;10:33:54&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;31&nbsp;06:40:04&nbsp;2011</span>
    <span class="description">jpeacock [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">re-resolve &#40;please do not reply or RT will re-open&#41;... :-/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;31&nbsp;06:40:06&nbsp;2011</span>
    <span class="description">jpeacock [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
