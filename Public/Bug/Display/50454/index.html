<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #50454 for Class-XSAccessor: Serious issues in mod_perl + win32</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #50454 for Class-XSAccessor: Serious issues in mod_perl + win32</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Class-XSAccessor">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Class-XSAccessor">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Class-XSAccessor">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Class-XSAccessor">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Class-XSAccessor">Class-XSAccessor CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">50454</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Class-XSAccessor">Class-XSAccessor</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
frioux [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-221550-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
1.03</li>
<li>
1.04_02</li>
<li>
1.04_03</li>
<li>
1.07</li>
<li>
1.07_02</li>
</ul>
    </td>
  </tr>
  <tr id="CF-221551-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




xsa_crash.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/684997/352665/xsa_crash.pl">
Mon Nov 02 12:56:00 2009 (422b) by smueller [...] cpan.org
</a>
</font></li>
</ul>


xsa_crash2.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/684998/352670/xsa_crash2.pl">
Mon Nov 02 12:57:32 2009 (389b) by smueller [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=50454">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-676096" href="/Public/Bug/Display.html?id=50454#txn-676096">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;13&nbsp;11:36:24&nbsp;2009</span>
    <span class="description">frioux [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Serious issues in mod_perl + win32</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/676096/347799/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/347799">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 710b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">We are using DBIx::Class, which uses Class::Accessor::Grouped, which in
turn optionally uses this module.  We found that in win32, if we
hammered the server with a load testing tool we would get the following
error:

Free to wrong pool 2063268 not a378b0 at
C:/Perl/site/lib/Class/Accessor/Grouped.pm line 102.

The line of code that references is

Class::XSAccessor::newxs_accessor&#40;&#34;${class}::${name}&#34;, $field, 0&#41;;

In CAG we disabled using this module &#40;comment out line 21&#41; and the issue
went away.  I really don&#39;t know how to help debug this issue, but I&#39;d
love to get it solved.  I&#39;m on IRC &#40;Freenode and Perl&#41; as frew almost
all the time and of course you have my email.

Look forward to talking with you!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-676405" href="/Public/Bug/Display.html?id=50454#txn-676405">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;13&nbsp;22:54:09&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/676405/347946/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/347946">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

thanks for tracking this down!

On Tue Oct 13 08:36:24 2009, frew wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We are using DBIx::Class, which uses Class::Accessor::Grouped, which in
&gt; turn optionally uses this module.  We found that in win32, if we
&gt; hammered the server with a load testing tool we would get the following
&gt; error:
&gt; 
&gt; Free to wrong pool 2063268 not a378b0 at
&gt; C:/Perl/site/lib/Class/Accessor/Grouped.pm line 102.
&gt; 
&gt; The line of code that references is
&gt; 
&gt; Class::XSAccessor::newxs_accessor&#40;&#34;${class}::${name}&#34;, $field, 0&#41;;
&gt; 
&gt; In CAG we disabled using this module &#40;comment out line 21&#41; and the issue
&gt; went away.  I really don&#39;t know how to help debug this issue, but I&#39;d
&gt; love to get it solved.  I&#39;m on IRC &#40;Freenode and Perl&#41; as frew almost
&gt; all the time and of course you have my email.
&gt; 
&gt; Look forward to talking with you!
</div>
I&#39;m currently travelling and will have access to a usable computer only
in November, so I can&#39;t really debug this now. Either way, some comments:

1&#41; This may be a nightmare to debug considering it happens when you
hammer the server with requests. The &#34;newxs_accessor&#34;-using line you
quote above should mostly be called *early* during the creation of a new
process since it&#39;s installing a new method. It seems strange that the
error happens due to high load unless your setup does funny stuff that
spawns new threads or processes as load increases. Specifically threads
may be an issue since the share the same C-level memory which
Class::XSAccessor uses. Maybe my thread-safety hacking wasn&#39;t as good as
I thought and I&#39;d have to add more locking pain. The only case in which
I can see this happening is when two threads try to extend the CXA
global state at the same time.
2&#41; Are these crashes reliably reproducable for you? Does this happen on
another OS? Could you run this in a C debugger to see where the bad free
happens?
3&#41; Class::Accessor::Grouped has NO business calling newxs_accessor. The
newxs* functions are NOT part of the API of Class::XSAccessor and
considering they might be doing scary shit &#40;i.e. produce segfaults&#41; when
used improperly, they&#39;re unlikely to become public. Besides, the public
API of C::XSA can do the same thing &#40;albeit with slightly higher
overhead which doesn&#39;t really matter given it&#39;s a one-time cost&#41;.

Don&#39;t expect much input besides this before November. I expect to have
little connectivity.

Best regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-676406" href="/Public/Bug/Display.html?id=50454#txn-676406">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;13&nbsp;22:54:10&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-676625" href="/Public/Bug/Display.html?id=50454#txn-676625">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;14&nbsp;10:42:36&nbsp;2009</span>
    <span class="description">frioux [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/676625/348068/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/348068">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 586b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the fast response!

to answer your questions in order: yes we can reproduce it fairly
easily, and we haven&#39;t yet tried it in another OS.  We will surely at
some point, but the fire is put out now so we have less motivation :-&#41; 
And as for a debugger, we&#39;ll probably have to do that in linux as I have
no idea how to attach gdb in windows.

I have commit access to Class::Accessor::Grouped, so I&#39;ll look at fixing
it so that it doesn&#39;t use those functions.

So before November I&#39;ll fix CAG to use the right functions, and then
I&#39;ll wait till you get back to do more with this.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-684997" href="/Public/Bug/Display.html?id=50454#txn-684997">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;12:56:00&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/684997/352662/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352662">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 528b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Attached, simple test script demonstrates the &#40;or *a*&#41; crash.

Reliably gives something like:
Scalars leaked: -1800
Scalars leaked: 100
...

Occasionally also:
Attempt to free non-existent shared string &#39;cCWeA&#39;, Perl interpreter:
0x251ee40 during global destruction.
Attempt to free non-existent shared string &#39;LynVM&#39;, Perl interpreter:
0x251ee40 during global destruction.

I&#39;m experimenting with a potential fix, but it&#39;s currently colliding
with other pending &#40;complex&#41; refactoring and optimization changes.

Cheers,
Steffen
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/684997/352665/xsa_crash.pl">Download xsa_crash.pl</a><br />
<span class="downloadcontenttype">text/x-perl 422b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl
use strict;
use warnings;
use threads;
use Class::XSAccessor constructor =&gt; &#39;new&#39;, class =&gt; &#39;Foo&#39;;

my @chars = &#40;&#39;a&#39;..&#39;z&#39;, &#39;A&#39;..&#39;Z&#39;&#41;;


my @t;
foreach &#40;1..20&#41; {
  push @t, threads-&gt;new&#40;sub {
    foreach &#40;1..100&#41; {
      my $foo = join &#39;&#39;, map {$chars[rand&#40;@chars&#41;]} 1..5;
      Class::XSAccessor-&gt;import&#40;
        class =&gt; &#39;Foo&#39;,
        getters =&gt; {$foo =&gt; $foo}
      &#41;;
    }
  }&#41;;
}

$_-&gt;join for @t;


</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-684998" href="/Public/Bug/Display.html?id=50454#txn-684998">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;12:57:31&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/684998/352667/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352667">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 30b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oops, simpler script attached.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/684998/352670/xsa_crash2.pl">Download xsa_crash2.pl</a><br />
<span class="downloadcontenttype">text/x-perl 389b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl
use strict;
use warnings;
use threads;
require Class::XSAccessor;

my @chars = &#40;&#39;a&#39;..&#39;z&#39;, &#39;A&#39;..&#39;Z&#39;&#41;;


my @t;
foreach &#40;1..20&#41; {
  push @t, threads-&gt;new&#40;sub {
    foreach &#40;1..100&#41; {
      my $foo = join &#39;&#39;, map {$chars[rand&#40;@chars&#41;]} 1..5;
      Class::XSAccessor-&gt;import&#40;
        class =&gt; &#39;Foo&#39;,
        getters =&gt; {$foo =&gt; $foo}
      &#41;;
    }
  }&#41;;
}

$_-&gt;join for @t;


</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685001" href="/Public/Bug/Display.html?id=50454#txn-685001">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;12:57:53&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Broken in 1.03 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685002" href="/Public/Bug/Display.html?id=50454#txn-685002">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;12:57:53&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Broken in 1.04_02 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685003" href="/Public/Bug/Display.html?id=50454#txn-685003">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;12:57:53&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Severity Critical added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685411" href="/Public/Bug/Display.html?id=50454#txn-685411">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;03&nbsp;16:37:24&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/685411/352876/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352876">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 133b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in trunk according to reporter. Dev release 1.04_03 was uploaded
to PAUSE. Stable release blocking for other changes. --Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685412" href="/Public/Bug/Display.html?id=50454#txn-685412">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;03&nbsp;16:37:27&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825503" href="/Public/Bug/Display.html?id=50454#txn-825503">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;01&nbsp;19:09:39&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/825503/427625/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427625">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Nov 03 16:37:24 2009, SMUELLER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Fixed in trunk according to reporter. Dev release 1.04_03 was uploaded
&gt; to PAUSE. Stable release blocking for other changes. --Steffen
</div>
Reopening this can of fat worms. Apparently there was a lapse in
testing, as neither 1.04_03, nor any more recent versions solve the
issue on win32.

Testing was performed on a virgin install of strawberry perl 5.12.1,
with cpanm downloaded to ease specific version installations. No other
cpan modules were installed:

FAIL log
===============

C:\&gt;perl cpanm
<span class="clickylink"><a target="new" rel="nofollow" href="http://backpan.perl.org/authors/id/S/SM/SMUELLER/Class-XSAccessor">http://backpan.perl.org/authors/id/S/SM/SMUELLER/Class-XSAccessor</a></span>
-1.04_03.tar.gz
Fetching
<span class="clickylink"><a target="new" rel="nofollow" href="http://backpan.perl.org/authors/id/S/SM/SMUELLER/Class-XSAccessor-1.04_">http://backpan.perl.org/authors/id/S/SM/SMUELLER/Class-XSAccessor-1.04_</a></span>
03.tar.gz ... OK
Configuring Class-XSAccessor-1.04_03 ... OK
Building and testing Class-XSAccessor-1.04_03 for
<span class="clickylink"><a target="new" rel="nofollow" href="http://backpan.perl.org/author">http://backpan.perl.org/author</a></span>
s/id/S/SM/SMUELLER/Class-XSAccessor-1.04_03.tar.gz ... OK
Successfully installed Class-XSAccessor-1.04_03

C:\&gt;perl xsa_crash2.pl
Free to wrong pool ac7e58 not a57230 at
C:/strawberry/perl/site/lib/Class/XSAcce
ssor.pm line 81.

C:\&gt;perl xsa_crash2.pl
Free to wrong pool ac7e58 not a57230 at
C:/strawberry/perl/site/lib/Class/XSAcce
ssor.pm line 81.

C:\&gt;perl cpanm
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAcce">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAcce</a></span>
ssor-1.07.tar.gz
Fetching
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAccessor-1">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAccessor-1</a></span>
.07.tar.gz ... OK
Configuring Class-XSAccessor-1.07 ... OK
Building and testing Class-XSAccessor-1.07 for
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/autho">http://search.cpan.org/CPAN/autho</a></span>
rs/id/S/SM/SMUELLER/Class-XSAccessor-1.07.tar.gz ... OK
Successfully installed Class-XSAccessor-1.07

C:\&gt;perl xsa_crash2.pl
Free to wrong pool ac65d0 not a57238 at
C:/strawberry/perl/site/lib/Class/XSAcce
ssor.pm line 84.

C:\&gt;perl xsa_crash2.pl
Free to wrong pool ac65d0 not a57238 at
C:/strawberry/perl/site/lib/Class/XSAcce
ssor.pm line 84.

C:\&gt;perl cpanm
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAcce">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAcce</a></span>
ssor-1.07_02.tar.gz
Fetching
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAccessor-1">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAccessor-1</a></span>
.07_02.tar.gz ... OK
Configuring Class-XSAccessor-1.07_02 ... OK
Building and testing Class-XSAccessor-1.07_02 for
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/au">http://search.cpan.org/CPAN/au</a></span>
thors/id/S/SM/SMUELLER/Class-XSAccessor-1.07_02.tar.gz ... OK
Successfully installed Class-XSAccessor-1.07_02

C:\&gt;perl xsa_crash2.pl
Free to wrong pool ac8f78 not a58a38 at
C:/strawberry/perl/site/lib/Class/XSAcce
ssor.pm line 87.

C:\&gt;perl xsa_crash2.pl
Free to wrong pool ac8f78 not a58a38 at
C:/strawberry/perl/site/lib/Class/XSAcce
ssor.pm line 87.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825506" href="/Public/Bug/Display.html?id=50454#txn-825506">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;01&nbsp;19:09:40&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825507" href="/Public/Bug/Display.html?id=50454#txn-825507">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;01&nbsp;19:15:48&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Broken in 1.04_03 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825508" href="/Public/Bug/Display.html?id=50454#txn-825508">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;01&nbsp;19:15:48&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Broken in 1.07 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825509" href="/Public/Bug/Display.html?id=50454#txn-825509">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;01&nbsp;19:15:48&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Broken in 1.07_02 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825651" href="/Public/Bug/Display.html?id=50454#txn-825651">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;02&nbsp;04:05:31&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50454] Serious issues in mod_perl + win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 02 Sep 2010 10:05:18 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Class-XSAccessor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen Mueller &lt;smueller [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/825651/427704/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427704">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Peter,

thanks for the report.

Peter Rabbitson via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Class-XSAccessor
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=50454">https://rt.cpan.org/Ticket/Display.html?id=50454</a></span> &gt;
&gt; 
&gt; On Tue Nov 03 16:37:24 2009, SMUELLER wrote:
<div class="message-stanza open">&gt;&gt; Fixed in trunk according to reporter. Dev release 1.04_03 was uploaded
&gt;&gt; to PAUSE. Stable release blocking for other changes. --Steffen
</div>&gt; 
&gt; Reopening this can of fat worms. Apparently there was a lapse in
&gt; testing, as neither 1.04_03, nor any more recent versions solve the
&gt; issue on win32.
</div>
Damn. I can&#39;t reproduce this on my linux even when hammering it with 20 
threads, each installing 100k methods in parallel. That&#39;s about where I 
run ou t of memory.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Testing was performed on a virgin install of strawberry perl 5.12.1,
&gt; with cpanm downloaded to ease specific version installations. No other
&gt; cpan modules were installed:
</div>
Still no win32 here. Not sure when or whether I&#39;ll be able to set one 
up. But even if I do, I will possess no win32 debugging skills at all. :&#40;

[...]

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; C:\&gt;perl cpanm
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAcce">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAcce</a></span>
&gt; ssor-1.07_02.tar.gz
&gt; Fetching
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAccessor-1">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/Class-XSAccessor-1</a></span>
&gt; .07_02.tar.gz ... OK
&gt; Configuring Class-XSAccessor-1.07_02 ... OK
&gt; Building and testing Class-XSAccessor-1.07_02 for
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/au">http://search.cpan.org/CPAN/au</a></span>
&gt; thors/id/S/SM/SMUELLER/Class-XSAccessor-1.07_02.tar.gz ... OK
&gt; Successfully installed Class-XSAccessor-1.07_02
&gt; 
&gt; C:\&gt;perl xsa_crash2.pl
&gt; Free to wrong pool ac8f78 not a58a38 at
&gt; C:/strawberry/perl/site/lib/Class/XSAcce
&gt; ssor.pm line 87.
&gt; 
&gt; C:\&gt;perl xsa_crash2.pl
&gt; Free to wrong pool ac8f78 not a58a38 at
&gt; C:/strawberry/perl/site/lib/Class/XSAcce
&gt; ssor.pm line 87.
</div>
I&#39;ll try staring at the locking code a bit. But I don&#39;t expect 
enlightenment.

--Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825881" href="/Public/Bug/Display.html?id=50454#txn-825881">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;02&nbsp;10:10:30&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/825881/427841/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427841">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 258b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">After serious hacking and much cursing, I have high hope that it might
be fixed on this branch:

<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/tsee/Class-XSAccessor/tree/memoryCraziness">http://github.com/tsee/Class-XSAccessor/tree/memoryCraziness</a></span>

Or directly for a git clone command:

git://github.com/tsee/Class-XSAccessor.git

Feedback welcome!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825971" href="/Public/Bug/Display.html?id=50454#txn-825971">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;02&nbsp;14:18:25&nbsp;2010</span>
    <span class="description">frioux [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/825971/427898/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427898">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 8.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Sep 02 10:10:30 2010, SMUELLER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; After serious hacking and much cursing, I have high hope that it might
&gt; be fixed on this branch:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/tsee/Class-XSAccessor/tree/memoryCraziness">http://github.com/tsee/Class-XSAccessor/tree/memoryCraziness</a></span>
&gt; 
&gt; Or directly for a git clone command:
&gt; 
&gt; git://github.com/tsee/Class-XSAccessor.git
&gt; 
&gt; Feedback welcome!
</div>
Sorry, we tried it, and although we don&#39;t get the errors we got before,
we now get new errors.  Here are our new errors:

[Dispatch] ERROR for request
&#39;/dispatch/AssignmentRule/single_mgmtid?_dc=1283451393808&#38;mgmtid=756&#39;:
Error executing run mode &#39;single_mgmtid&#39;:
DBIx::Class::Schema::resultset&#40;&#41;: Can&#39;t find source for 
 at C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 435
        CGI::Application::Dispatch::http_error&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Exception::Class::Base=HASH&#40;0x9fd6574&#41;&#39;, undef&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 409
        CGI::Application::Dispatch::dispatch&#40;&#39;EPMS::Dispatcher&#39;, &#39;args_to_new&#39;,
&#39;HASH&#40;0x18fc2a04&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 809
        CGI::Application::Dispatch::handler&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Apache2::RequestRec=SCALAR&#40;0x18fc2444&#41;&#39;&#41; called at -e line 0
        eval {...} called at -e line 0
Use of uninitialized value $moniker in exists at
C:/strawberry/perl/site/lib/DBIx/Class/Schema.pm line 593
        DBIx::Class::Schema::source&#40;&#39;EPMS::Schema=HASH&#40;0xb3aa44c&#41;&#39;, undef&#41;
called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSourceHandle.pm
line 68
        DBIx::Class::ResultSourceHandle::resolve&#40;&#39;DBIx::Class::ResultSourceHandle=HASH&#40;0x95d79b4&#41;&#39;&#41; called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSet.pm line 208
        DBIx::Class::ResultSet::new&#40;&#39;DBIx::Class::ResultSet&#39;,
&#39;DBIx::Class::ResultSource::Table=HASH&#40;0xbbe3d3c&#41;&#39;, &#39;HASH&#40;0xb3aa4fc&#41;&#39;&#41;
called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSource.pm line 849
        DBIx::Class::ResultSource::resultset&#40;&#39;DBIx::Class::ResultSource::Table=HASH&#40;0xbbe3d3c&#41;&#39;&#41; called at C:/strawberry/perl/site/lib/DBIx/Class/Schema.pm line 554
        DBIx::Class::Schema::resultset&#40;&#39;EPMS::Schema=HASH&#40;0xb3aa44c&#41;&#39;, &#39;Mgmt&#39;&#41;
called at /Inetpub/epms/Controller/Mgmt.pm line 107
        Controller::Mgmt::single&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application.pm line 143
        eval {...} called at C:/strawberry/perl/site/lib/CGI/Application.pm
line 142
        CGI::Application::__get_body&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;,
&#39;single&#39;&#41; called at C:/strawberry/perl/site/lib/CGI/Application.pm line 191
        CGI::Application::run&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 704
        eval {...} called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 701
        CGI::Application::Dispatch::_run_app&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Controller::Mgmt&#39;, &#39;single&#39;, &#39;HASH&#40;0x942e50c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 406
        eval {...} called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 368
        CGI::Application::Dispatch::dispatch&#40;&#39;EPMS::Dispatcher&#39;, &#39;args_to_new&#39;,
&#39;HASH&#40;0x942e50c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 809
        CGI::Application::Dispatch::handler&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Apache2::RequestRec=SCALAR&#40;0x47877f4&#41;&#39;&#41; called at -e line 0
        eval {...} called at -e line 0
Use of uninitialized value $moniker in hash element at
C:/strawberry/perl/site/lib/DBIx/Class/Schema.pm line 596
        DBIx::Class::Schema::source&#40;&#39;EPMS::Schema=HASH&#40;0xb3aa44c&#41;&#39;, undef&#41;
called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSourceHandle.pm
line 68
        DBIx::Class::ResultSourceHandle::resolve&#40;&#39;DBIx::Class::ResultSourceHandle=HASH&#40;0x95d79b4&#41;&#39;&#41; called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSet.pm line 208
        DBIx::Class::ResultSet::new&#40;&#39;DBIx::Class::ResultSet&#39;,
&#39;DBIx::Class::ResultSource::Table=HASH&#40;0xbbe3d3c&#41;&#39;, &#39;HASH&#40;0xb3aa4fc&#41;&#39;&#41;
called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSource.pm line 849
        DBIx::Class::ResultSource::resultset&#40;&#39;DBIx::Class::ResultSource::Table=HASH&#40;0xbbe3d3c&#41;&#39;&#41; called at C:/strawberry/perl/site/lib/DBIx/Class/Schema.pm line 554
        DBIx::Class::Schema::resultset&#40;&#39;EPMS::Schema=HASH&#40;0xb3aa44c&#41;&#39;, &#39;Mgmt&#39;&#41;
called at /Inetpub/epms/Controller/Mgmt.pm line 107
        Controller::Mgmt::single&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application.pm line 143
        eval {...} called at C:/strawberry/perl/site/lib/CGI/Application.pm
line 142
        CGI::Application::__get_body&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;,
&#39;single&#39;&#41; called at C:/strawberry/perl/site/lib/CGI/Application.pm line 191
        CGI::Application::run&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 704
        eval {...} called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 701
        CGI::Application::Dispatch::_run_app&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Controller::Mgmt&#39;, &#39;single&#39;, &#39;HASH&#40;0x942e50c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 406
        eval {...} called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 368
        CGI::Application::Dispatch::dispatch&#40;&#39;EPMS::Dispatcher&#39;, &#39;args_to_new&#39;,
&#39;HASH&#40;0x942e50c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 809
        CGI::Application::Dispatch::handler&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Apache2::RequestRec=SCALAR&#40;0x47877f4&#41;&#39;&#41; called at -e line 0
        eval {...} called at -e line 0
Use of uninitialized value $moniker in concatenation &#40;.&#41; or string at
C:/strawberry/perl/site/lib/DBIx/Class/Schema.pm line 597
        DBIx::Class::Schema::source&#40;&#39;EPMS::Schema=HASH&#40;0xb3aa44c&#41;&#39;, undef&#41;
called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSourceHandle.pm
line 68
        DBIx::Class::ResultSourceHandle::resolve&#40;&#39;DBIx::Class::ResultSourceHandle=HASH&#40;0x95d79b4&#41;&#39;&#41; called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSet.pm line 208
        DBIx::Class::ResultSet::new&#40;&#39;DBIx::Class::ResultSet&#39;,
&#39;DBIx::Class::ResultSource::Table=HASH&#40;0xbbe3d3c&#41;&#39;, &#39;HASH&#40;0xb3aa4fc&#41;&#39;&#41;
called at C:/strawberry/perl/site/lib/DBIx/Class/ResultSource.pm line 849
        DBIx::Class::ResultSource::resultset&#40;&#39;DBIx::Class::ResultSource::Table=HASH&#40;0xbbe3d3c&#41;&#39;&#41; called at C:/strawberry/perl/site/lib/DBIx/Class/Schema.pm line 554
        DBIx::Class::Schema::resultset&#40;&#39;EPMS::Schema=HASH&#40;0xb3aa44c&#41;&#39;, &#39;Mgmt&#39;&#41;
called at /Inetpub/epms/Controller/Mgmt.pm line 107
        Controller::Mgmt::single&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application.pm line 143
        eval {...} called at C:/strawberry/perl/site/lib/CGI/Application.pm
line 142
        CGI::Application::__get_body&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;,
&#39;single&#39;&#41; called at C:/strawberry/perl/site/lib/CGI/Application.pm line 191
        CGI::Application::run&#40;&#39;Controller::Mgmt=HASH&#40;0xef154c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 704
        eval {...} called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 701
        CGI::Application::Dispatch::_run_app&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Controller::Mgmt&#39;, &#39;single&#39;, &#39;HASH&#40;0x942e50c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 406
        eval {...} called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 368
        CGI::Application::Dispatch::dispatch&#40;&#39;EPMS::Dispatcher&#39;, &#39;args_to_new&#39;,
&#39;HASH&#40;0x942e50c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 809
        CGI::Application::Dispatch::handler&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Apache2::RequestRec=SCALAR&#40;0x47877f4&#41;&#39;&#41; called at -e line 0
        eval {...} called at -e line 0
[Dispatch] ERROR for request
&#39;/dispatch/mgmt/single?_dc=1283451394491&#38;mgmtid=756&#39;: Error executing
run mode &#39;single&#39;: DBIx::Class::Schema::resultset&#40;&#41;: Can&#39;t find source for 
 at C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 435
        CGI::Application::Dispatch::http_error&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Exception::Class::Base=HASH&#40;0xb88eeb4&#41;&#39;, undef&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 409
        CGI::Application::Dispatch::dispatch&#40;&#39;EPMS::Dispatcher&#39;, &#39;args_to_new&#39;,
&#39;HASH&#40;0x942e50c&#41;&#39;&#41; called at
C:/strawberry/perl/site/lib/CGI/Application/Dispatch.pm line 809
        CGI::Application::Dispatch::handler&#40;&#39;EPMS::Dispatcher&#39;,
&#39;Apache2::RequestRec=SCALAR&#40;0x47877f4&#41;&#39;&#41; called at -e line 0
        eval {...} called at -e line 0


As you may be able to tell they are nearly meaningless and all over the
board and probably useless.  But we consistently get issues when using
CXA and do not when we don&#39;t.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825987" href="/Public/Bug/Display.html?id=50454#txn-825987">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;02&nbsp;14:49:42&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50454] Serious issues in mod_perl + win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 02 Sep 2010 20:48:24 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Class-XSAccessor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen MÃ¼ller &lt;smueller [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/825987/427906/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427906">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 230b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi!

Thanks for trying again. Did you try with the memory... branch or master? Could you run the test scripts that are attached to this ticket?

Best regards,
Steffen
-- 
This message was sent from a phone. Apologies for brevity.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-826019" href="/Public/Bug/Display.html?id=50454#txn-826019">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;02&nbsp;16:42:54&nbsp;2010</span>
    <span class="description">frioux [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/826019/427922/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427922">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 469b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Sep 02 14:49:42 2010, SMUELLER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi!
&gt; 
&gt; Thanks for trying again. Did you try with the memory... branch or
&gt; master? Could you run the test scripts that are attached to this
&gt; ticket?
&gt; 
&gt; Best regards,
&gt; Steffen
</div>
We used the memoryCraziness branch.

Yeah, we ran the test in the thread &#40;which if I get a chance I&#39;ll make a
*real* test that can run on install&#41; and it works fine.  It seems like
something to do with the way mod_perl does things in win32?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-826482" href="/Public/Bug/Display.html?id=50454#txn-826482">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;03&nbsp;13:33:53&nbsp;2010</span>
    <span class="description">frioux [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/826482/428187/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/428187">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 79b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Latest version of the memoryCraziness branch still causes useless errors :-/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-826760" href="/Public/Bug/Display.html?id=50454#txn-826760">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;04&nbsp;03:54:16&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/826760/428319/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/428319">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 208b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 03 13:33:53 2010, frew wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Latest version of the memoryCraziness branch still causes useless
</div>errors :-/

I don&#39;t enjoy saying this, but I guess I&#39;m officially out of clue then.

Sorry,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-861794" href="/Public/Bug/Display.html?id=50454#txn-861794">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;29&nbsp;21:16:21&nbsp;2010</span>
    <span class="description">TJC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/861794/446077/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446077">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m unsure if it&#39;s related to this ticket.. but it looks similar.

I&#39;m getting segfaults due to bad memory access from Class::XSAccessor, 
on perl 5.12.2 on linux/amd64 architecture. It seems the issues aren&#39;t 
limited to mod_perl or win32, as I&#39;m not using either of thos.

ie.

*** glibc detected *** perl: realloc&#40;&#41;: invalid pointer: 
0x0000000001674838 ***
======= Backtrace: =========
/lib/libc.so.6&#40;+0x775b6&#41;[0x7f46229f65b6]
/lib/libc.so.6&#40;realloc+0x352&#41;[0x7f46229fd312]
/usr/local/strategic/perl/lib/site_perl/5.12.2/x86_64-linux-thread-
multi/auto/Class/XSAccessor/XSAccessor.so&#40;get_hashkey_index+0x2a7&#41;
[0x7f46210dcb77]
/usr/local/strategic/perl/lib/site_perl/5.12.2/x86_64-linux-thread-
multi/auto/Class/XSAccessor/XSAccessor.so&#40;XS_Class__XSAccessor_newxs_acc
essor+0x1db&#41;[0x7f46210dd5cb]
perl&#40;Perl_pp_entersub+0x530&#41;[0x495c90]
perl&#40;Perl_runops_standard+0x16&#41;[0x4947d6]
perl&#40;Perl_call_sv+0x4b7&#41;[0x439a47]
perl&#40;Perl_call_list+0x2ad&#41;[0x439f1d]
perl&#40;perl_destruct+0x170c&#41;[0x43c3bc]
perl&#40;main+0xcb&#41;[0x421e7b]
/lib/libc.so.6&#40;__libc_start_main+0xfd&#41;[0x7f462299dc4d]
perl[0x421ce9]
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-862570" href="/Public/Bug/Display.html?id=50454#txn-862570">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;01&nbsp;15:08:33&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/862570/446534/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446534">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Nov 29 21:16:21 2010, TJC wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m unsure if it&#39;s related to this ticket.. but it looks similar.
&gt; 
&gt; I&#39;m getting segfaults due to bad memory access from Class::XSAccessor, 
&gt; on perl 5.12.2 on linux/amd64 architecture. It seems the issues aren&#39;t 
&gt; limited to mod_perl or win32, as I&#39;m not using either of thos.
&gt; 
&gt; ie.
&gt; 
&gt; *** glibc detected *** perl: realloc&#40;&#41;: invalid pointer: 
&gt; 0x0000000001674838 ***
&gt; ======= Backtrace: =========
&gt; /lib/libc.so.6&#40;+0x775b6&#41;[0x7f46229f65b6]
&gt; /lib/libc.so.6&#40;realloc+0x352&#41;[0x7f46229fd312]
&gt; /usr/local/strategic/perl/lib/site_perl/5.12.2/x86_64-linux-thread-
&gt; multi/auto/Class/XSAccessor/XSAccessor.so&#40;get_hashkey_index+0x2a7&#41;
&gt; [0x7f46210dcb77]
&gt; /usr/local/strategic/perl/lib/site_perl/5.12.2/x86_64-linux-thread-
&gt; multi/auto/Class/XSAccessor/XSAccessor.so&#40;XS_Class__XSAccessor_newxs_acc
&gt; essor+0x1db&#41;[0x7f46210dd5cb]
&gt; perl&#40;Perl_pp_entersub+0x530&#41;[0x495c90]
&gt; perl&#40;Perl_runops_standard+0x16&#41;[0x4947d6]
&gt; perl&#40;Perl_call_sv+0x4b7&#41;[0x439a47]
&gt; perl&#40;Perl_call_list+0x2ad&#41;[0x439f1d]
&gt; perl&#40;perl_destruct+0x170c&#41;[0x43c3bc]
&gt; perl&#40;main+0xcb&#41;[0x421e7b]
&gt; /lib/libc.so.6&#40;__libc_start_main+0xfd&#41;[0x7f462299dc4d]
&gt; perl[0x421ce9]
</div>

... and based on this, I have uploaded Class::XSAccessor 1.10. Please retest with that version.

--Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-863209" href="/Public/Bug/Display.html?id=50454#txn-863209">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;02&nbsp;13:28:04&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/863209/446931/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446931">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 57b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">According to Peter Rabbitson, this issue is now resolved.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-863212" href="/Public/Bug/Display.html?id=50454#txn-863212">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;02&nbsp;13:28:04&nbsp;2010</span>
    <span class="description">smueller [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.168726</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
