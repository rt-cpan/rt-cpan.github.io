<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #46091 for WWW-Salesforce: no exception handling is provided</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #46091 for WWW-Salesforce: no exception handling is provided</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=WWW-Salesforce">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=WWW-Salesforce">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=WWW-Salesforce">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=WWW-Salesforce">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/WWW-Salesforce">WWW-Salesforce CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">46091</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=WWW-Salesforce">WWW-Salesforce</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">cwhitener [...] gmail.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MARKSTOS [...] cpan.org

<br />
rsniff [...] amllc.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38090-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38091-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




WWW-Salesforce-0.200_1.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/665597/341711/WWW-Salesforce-0.200_1.tar.gz">
Fri Sep 18 10:19:42 2009 (13.6k) by cwhitener [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=46091">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-605638" href="/Public/Bug/Display.html?id=46091#txn-605638">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;14&nbsp;18:21:32&nbsp;2009</span>
    <span class="description">rsniff [...] amllc.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Suggested changes to the API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 14 May 2009 16:20:50 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-WWW-Salesforce [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Reggie Sniff&#34; &lt;rsniff [...] amllc.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/605638/307044/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/307044">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I am using the API and it works wonderfully with a few exceptions. 
Unfortunately, I have had to pretty much copy your code and make changes to 
support my needs.

The problems I have, and I assume others might have is that from within most 
parts of the code, whenever you get an error, you use &#34;carp $err&#34; and then 
you return 0 or you attempt to use &#39;carp&#40;$res-&gt;faultstring&#40;&#41;&#41;&#39;.  Both of 
these are problematic for different reasons.  In the first, I only have 
access to the error if I have access to STDERR.  It would be much better if 
it was returned or stored in some global hash.  The second also causes 
problems if the $res object fails to get instantiated.  When this happens, 
if you try to call $res-&gt;faultstring&#40;&#41;  on a non-existent reference, the 
code dies.   When $res fails to get a reference it actually returns a scalar 
&#40;error message&#41; rather then the ref object you are expecting.

To use an example, what I have done is this:

Instead of this code:

------------
        if &#40; !defined $table_name || !length $table_name &#41; {
            carp&#40; &#39;Param1 of get_field_list&#40;&#41; should be a string&#39; &#41;;
            return 0;
        }

        my $res = $self-&gt;describeSObject&#40; &#39;type&#39; =&gt; $table_name &#41;;
        if &#40; $res-&gt;fault&#40;&#41; &#41; {
            carp&#40; $res-&gt;faultstring&#40;&#41; &#41;;
            return 0;
        }
-----------------

I use this -t allows me to have access to the error &#40;and email it back to 
muyself&#41; without having to look through a log file:

------------
        if &#40; !defined $table_name || !length $table_name &#41; {
            # I am returning the error so that I can handle it.  I just need 
to check the ref&#40;&#41; of the returned value first
            return &#40; &#39;Param1 of get_field_list&#40;&#41; should be a string&#39; &#41;;
        }

        my $res = $sforce-&gt;describeSObject&#40; &#39;type&#39; =&gt; $table_name &#41;;
        # If the above fails the $res object is a scalar error message
        unless &#40;ref&#40;$res&#41;&#41; {
            return $res;
        }
        # This should never be reached if $res is not a proper reference
        if &#40; $res-&gt;fault&#40;&#41; &#41; {
            return &#40; $res-&gt;faultstring&#40;&#41; &#41;;
        }
------------

Regards,

Reggie Sniff
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-606015" href="/Public/Bug/Display.html?id=46091#txn-606015">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;15&nbsp;09:56:48&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-629447" href="/Public/Bug/Display.html?id=46091#txn-629447">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;07&nbsp;10:45:52&nbsp;2009</span>
    <span class="description">iank [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/629447/320492/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/320492">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 160b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Reggie, I think this is a nonissue.  Carp raises an exception like any other, which you can 
catch with an eval block &#40;not string eval, see perldoc -f eval&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-629448" href="/Public/Bug/Display.html?id=46091#txn-629448">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;07&nbsp;10:45:54&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-629451" href="/Public/Bug/Display.html?id=46091#txn-629451">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;07&nbsp;10:50:51&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/629451/320495/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/320495">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 369b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is an issue that should be addressed much like other modules in the
CPAN, ie DBI.

WWW::Salesforce::errstr will contain the last error from here on out. 
Sorry, it will take me a while to dedicate some time to this.  I will
try to get this done as soon as possible.

my $sforce = WWW::Salesforce-&gt;login&#40; ... &#41; or croak&#40;
$WWW::Salesforce::errstr &#41;;

and so forth.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-632314" href="/Public/Bug/Display.html?id=46091#txn-632314">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;13&nbsp;14:13:28&nbsp;2009</span>
    <span class="description">iank [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/632314/322032/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/322032">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 268b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jul 07 10:45:52 2009, IANK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Reggie, I think this is a nonissue.  Carp raises an exception like any
&gt; other, which you can
&gt; catch with an eval block &#40;not string eval, see perldoc -f eval&#41;.
&gt; 
&gt; 
</div>
I&#39;ve gone and confused carp with croak.  Please disregard
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-649222" href="/Public/Bug/Display.html?id=46091#txn-649222">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;17&nbsp;15:45:50&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org - Ticket #48780:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> no exception handling is provided</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/649222/332403/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/332403">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 466b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Methods such as &#34;create&#40;&#41;&#34; can fail and throw exceptions. If I dump the
undocumented data structure returned by create&#40;&#41;, I can see it&#39;s trying
to tell me this:

&#34;sObject type \&#39;Idea\&#39; is not supported. If y
ou are attempting to use a custom object, be sure to append the \&#39;__c\&#39;
after the entity name. Ple
ase reference your WSDL or the describe call for the appropriate names.&#34;

However, there is no way to access this information through the
WWW::Salesforce API. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-665597" href="/Public/Bug/Display.html?id=46091#txn-665597">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;18&nbsp;10:19:42&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/665597/341708/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/341708">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 557b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Reggie,

Sorry it&#39;s taken so long, but my time is extremely limited.  This
pre-alpha is the direction I&#39;m going to be heading for the next release.
 Please take a look and see if you have any suggestions about
improvements or other comments.

NOTE:  This is nowhere near done and hardly any of the methods are
available yet.  But before I get too far, I want someone else to look at
it and see if what I think is a logical direction to steer into is in
fact logical.

Please read the documentation provided as a lot of things have changed.

Thanks,
Chase
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/665597/341711/WWW-Salesforce-0.200_1.tar.gz">Download WWW-Salesforce-0.200_1.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gzip 13.6k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-665635" href="/Public/Bug/Display.html?id=46091#txn-665635">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;18&nbsp;10:40:32&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com - Ticket #48780:  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-665636" href="/Public/Bug/Display.html?id=46091#txn-665636">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;18&nbsp;10:40:40&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com - Ticket #48780:  Merged into ticket #46091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-665637" href="/Public/Bug/Display.html?id=46091#txn-665637">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;18&nbsp;10:40:40&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com -  Merged into ticket #46091</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-665638" href="/Public/Bug/Display.html?id=46091#txn-665638">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;18&nbsp;10:40:40&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com -  Subject changed from &#39;Suggested changes to the API&#39; to &#39;no exception handling is provided&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666679" href="/Public/Bug/Display.html?id=46091#txn-666679">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;11:23:33&nbsp;2009</span>
    <span class="description">rsniff [...] amllc.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46091] Suggested changes to the API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 09:23:54 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-WWW-Salesforce [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Reggie Sniff&#34; &lt;rsniff [...] amllc.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666679/342364/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342364">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Chase,

This looks better, with the use of the $self-&gt;{errstr}variable.

A couple of suggestions:
1&#41; I think the $self-&gt;{errstr}should always be used anytime you have an 
error which will result in a return code.  For example, it should always be 
set with the error code prior to calling the &#39;confess&#39; function &#40;and perhaps 
call &#39;carp&#39; rather than &#39;confess&#39;&#41;..
2&#41; The only other thing needed is a method to access the $self-&gt;{errstr} 
variable.

The way I implement it is that if there is an error return code, we should 
be able to retrieve the error code and handle it as we see fit rather than 
having to use an eval and have to deal with a &#39;die&#39; &#40;via the confess&#41;.

Regards,

Reggie


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Chase Whitener via RT&#34; &lt;bug-WWW-Salesforce@rt.cpan.org&gt;
To: &lt;rsniff@amllc.com&gt;
Sent: Friday, September 18, 2009 8:19 AM
Subject: [rt.cpan.org #46091] Suggested changes to the API


<div class="message-stanza open">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46091">https://rt.cpan.org/Ticket/Display.html?id=46091</a></span> &gt;
&gt;
&gt; Hi Reggie,
&gt;
&gt; Sorry it&#39;s taken so long, but my time is extremely limited.  This
&gt; pre-alpha is the direction I&#39;m going to be heading for the next release.
&gt; Please take a look and see if you have any suggestions about
&gt; improvements or other comments.
&gt;
&gt; NOTE:  This is nowhere near done and hardly any of the methods are
&gt; available yet.  But before I get too far, I want someone else to look at
&gt; it and see if what I think is a logical direction to steer into is in
&gt; fact logical.
&gt;
&gt; Please read the documentation provided as a lot of things have changed.
&gt;
&gt; Thanks,
&gt; Chase
&gt; 
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666711" href="/Public/Bug/Display.html?id=46091#txn-666711">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;12:37:14&nbsp;2009</span>
    <span class="description">cwhitener [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/666711/342385/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342385">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 523b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Reggie,

errstr&#40;&#41; is a function that allows the caller to get the last error
message on the object.

my $sforce = WWW::Salesforce-&gt;new&#40;&#41;;
die $sforce-&gt;errstr&#40;&#41;
    unless &#40; $sforce-&gt;login&#40; username=&gt;&#39;foo&#39;,password=&gt;&#39;bar&#39;&#41; &#41;;

This is being documented more heavily as we speak.  As for the confess&#40;&#41;
calls.  Those will only happen on errors that are not recoverable.  In
this version, they&#39;re being used a bit more than I like, but I&#39;m getting
general ideas working rather than perfect code at the moment.

Thanks,
Chase
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666716" href="/Public/Bug/Display.html?id=46091#txn-666716">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;13:03:55&nbsp;2009</span>
    <span class="description">rsniff [...] amllc.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46091] no exception handling is provided </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 11:04:16 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-WWW-Salesforce [...] rt.cpan.org&gt;, &lt;MARKSTOS [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Reggie Sniff&#34; &lt;rsniff [...] amllc.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666716/342392/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342392">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Chase,

Sorry, didn&#39;t notice the note about the errstr&#40;&#41; method.

I think the new use of the errstr&#40;&#41; is great and I applaud you for the code, 
in general.  It is great to have such helpful code available

On another note ...
I also meant to note that I found some memory leaks in the Simple.pm code, 
specifically in the do_query method.
 It was killing my system to do queries with 2000 records &#40;severe memory 
usage&#41; and eventually ate up all my server memory and caused it to hang, 
requireing reboot. I found it best to reduce the record limit to 500 to keep 
it manageable.  I found that if I did an undef of the $res variable after 
each use, it significantly limited my memory usage and seemed to stop the 
unbound memory growth.
To make do the fix, I did an &#39;undef $res&#39; right before the line in 
do_query&#40;&#41; &#34;while &#40; $done eq &#39;false&#39; &#41; {&#34; and then another undef $res at the 
end of the while loop.  I also had to set up a fixed variable as not to lose 
the reference information so I added a line &#39;my @data = $res-&gt;valueof&#40; 
&#39;//queryMoreResponse/result/records&#39; &#41;;&#39; and then used the @data in the 
&#39;push&#39;.  I also did a little rearranging &#40;see below&#41; and set up a loop to 
delete the empty hash keys &#40;to save more memory&#41; before pushing them on the 
@rows array.


--------------- snippet from original do_query&#40;&#41; -------------------
        while &#40; $done eq &#39;false&#39; &#41; {
            $res = $self-&gt;queryMore&#40;
                queryLocator =&gt; $ql,
                limit =&gt; $limit
            &#41;;

            if &#40; $res-&gt;fault&#40;&#41; &#41; {
                carp&#40; $res-&gt;faultstring&#40;&#41; &#41;;
                return 0;
            }
            $done = $res-&gt;valueof&#40; &#39;//queryMoreResponse/result/done&#39; &#41;;
            $ql = $res-&gt;valueof&#40; 
&#39;//queryMoreResponse/result/queryLocator&#39; &#41;;
            push @rows, $res-&gt;valueof&#40; 
&#39;//queryMoreResponse/result/records&#39; &#41;
                if &#40; $res-&gt;valueof&#40; &#39;//queryMoreResponse/result/size&#39; &#41; &#41;;
        }
------------------------------------

----------------------- updated do_query&#40;&#41; - reduces memory 
usage -----------


        undef $res;
        while &#40; $done eq &#39;false&#39; &#41; {
            $res = $sforce-&gt;queryMore&#40;
                queryLocator =&gt; $ql,
                limit =&gt; $limit
            &#41;;

            if &#40; $res-&gt;fault&#40;&#41; &#41; {
                return&#40; $res-&gt;faultstring&#40;&#41; &#41;;
            }
            $done = $res-&gt;valueof&#40; &#39;//queryMoreResponse/result/done&#39; &#41;;
            $ql = $res-&gt;valueof&#40; 
&#39;//queryMoreResponse/result/queryLocator&#39; &#41;;

            if &#40; $res-&gt;valueof&#40; &#39;//queryMoreResponse/result/size&#39; &#41;&#41; {
                my @data = $res-&gt;valueof&#40; 
&#39;//queryMoreResponse/result/records&#39; &#41;;
                $cnt += @data;

                $self-&gt;{&#39;log&#39;}-&gt;log&#40;&#34;do_query: records process = $cnt&#34;&#41;;

                # Not really necessary but im my case I just deleted the 
empty hash keys in order to
                # save more memory
                foreach my $row &#40;@data&#41; {
                    foreach my $key &#40; keys %{$row} &#41; {
                        ###print &#34;\nDeleting $key =&gt;  $row-&gt;{$key}&#34; if 
&#40;$row-&gt;{$key} eq &#39;&#39; &#41;;
                        delete $row-&gt;{$key} if &#40; $row-&gt;{$key} eq &#39;&#39; &#41;;
                    }
                }

                push @rows, @data;

                # Clean up?
                undef $res;
            }

        }
----------------------------------



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Chase Whitener via RT&#34; &lt;bug-WWW-Salesforce@rt.cpan.org&gt;
To: &lt;MARKSTOS@cpan.org&gt;; &lt;rsniff@amllc.com&gt;
Sent: Monday, September 21, 2009 10:37 AM
Subject: [rt.cpan.org #46091] no exception handling is provided


<div class="message-stanza open">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46091">https://rt.cpan.org/Ticket/Display.html?id=46091</a></span> &gt;
&gt;
&gt; Hi Reggie,
&gt;
&gt; errstr&#40;&#41; is a function that allows the caller to get the last error
&gt; message on the object.
&gt;
&gt; my $sforce = WWW::Salesforce-&gt;new&#40;&#41;;
&gt; die $sforce-&gt;errstr&#40;&#41;
&gt;    unless &#40; $sforce-&gt;login&#40; username=&gt;&#39;foo&#39;,password=&gt;&#39;bar&#39;&#41; &#41;;
&gt;
&gt; This is being documented more heavily as we speak.  As for the confess&#40;&#41;
&gt; calls.  Those will only happen on errors that are not recoverable.  In
&gt; this version, they&#39;re being used a bit more than I like, but I&#39;m getting
&gt; general ideas working rather than perfect code at the moment.
&gt;
&gt; Thanks,
&gt; Chase
&gt;
&gt; 
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818480" href="/Public/Bug/Display.html?id=46091#txn-818480">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;17&nbsp;18:25:15&nbsp;2010</span>
    <span class="description">PHRED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/818480/424049/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424049">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 92b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Resolved with release 0.12.  Carp and return has been replaced with die and an error string.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818483" href="/Public/Bug/Display.html?id=46091#txn-818483">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;17&nbsp;18:25:16&nbsp;2010</span>
    <span class="description">PHRED [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.640923</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
