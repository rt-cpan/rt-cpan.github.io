<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #104449 for App-Wallflower: url option does not work</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #104449 for App-Wallflower: url option does not work</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=App-Wallflower">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=App-Wallflower">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=App-Wallflower">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=App-Wallflower">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/App-Wallflower">App-Wallflower CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">104449</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=App-Wallflower">App-Wallflower</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">book [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ASB [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-245554-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.005    </td>
  </tr>
  <tr id="CF-245555-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=104449">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1496505" href="/Public/Bug/Display.html?id=104449#txn-1496505">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;14&nbsp;16:18:00&nbsp;2015</span>
    <span class="description">ASB [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> url option does not work</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1496505/797105/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/797105">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 843b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have a Plack application that generates HTML content with links like &#34;/cgi-bin/myapp/index.cgi/page.html&#34;.

After running wallflower, I get HTML pages where the link is reduced to &#34;/page.html&#34;.
This is not what I want, because the pages will be located in the folder /myapp &#40;e.g. <span class="clickylink"><a target="new" rel="nofollow" href="http://127.0.0.1/myapp/page.html&#41;">http://127.0.0.1/myapp/page.html&#41;</a></span>.

This was the command used:
wallflower --application &#34;C:\Apache\cgi-bin\myapp\index.cgi&#34;

So I tried the --url option to change the links &#40;NB: localhost is the target server&#41;:
wallflower --application &#34;C:\Apache\cgi-bin\myapp\index.cgi&#34; --url &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span>&#34;

But: doing so only yields a &#34;404 /&#34;

What am I doing wrong? 
Could you eventually provide an example of the URL option in the tutorial &#40;incl. a before and after example&#41;?

Here is some additional info:
* Perl 5.16.3
* Windows 8.1 x64
* App::Wallflower 1.005
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1496573" href="/Public/Bug/Display.html?id=104449#txn-1496573">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;15&nbsp;00:59:21&nbsp;2015</span>
    <span class="description">book [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1496573/797153/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/797153">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu May 14 16:18:00 2015, ASB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have a Plack application that generates HTML content with links like
&gt; &#34;/cgi-bin/myapp/index.cgi/page.html&#34;.
&gt; 
&gt; After running wallflower, I get HTML pages where the link is reduced
&gt; to &#34;/page.html&#34;.
&gt; This is not what I want, because the pages will be located in the
&gt; folder /myapp &#40;e.g. <span class="clickylink"><a target="new" rel="nofollow" href="http://127.0.0.1/myapp/page.html&#41;">http://127.0.0.1/myapp/page.html&#41;</a></span>.
&gt; 
&gt; This was the command used:
&gt; wallflower --application &#34;C:\Apache\cgi-bin\myapp\index.cgi&#34;
&gt; 
&gt; So I tried the --url option to change the links &#40;NB: localhost is the
&gt; target server&#41;:
&gt; wallflower --application &#34;C:\Apache\cgi-bin\myapp\index.cgi&#34; --url
&gt; &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span>&#34;
&gt; 
&gt; But: doing so only yields a &#34;404 /&#34;
&gt; 
&gt; What am I doing wrong?
&gt; Could you eventually provide an example of the URL option in the
&gt; tutorial &#40;incl. a before and after example&#41;?
</div>
The url option is for mounting Plack applications, as done by
Plack::App::URLMap. It does not influence URL produced by your
application, just the URL the application will reply to.

Could you show me an example of your application &#40;just a small subset
that exhibits the behaviour you&#39;re describing&#41;? That way, I could
better understand what&#39;s happening, and provide a correct answer.

Once we&#39;ve got an answer to your question, I can use it to produce
an example in the tutorial.

Regards,

-- BooK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1496574" href="/Public/Bug/Display.html?id=104449#txn-1496574">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;15&nbsp;00:59:22&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1496671" href="/Public/Bug/Display.html?id=104449#txn-1496671">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;15&nbsp;06:45:22&nbsp;2015</span>
    <span class="description">ASB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1496671/797212/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/797212">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Fr 15. Mai 2015, 00:59:21, BOOK schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu May 14 16:18:00 2015, ASB wrote:
<div class="message-stanza open">&gt; &gt; I have a Plack application that generates HTML content with links like
&gt; &gt; &#34;/cgi-bin/myapp/index.cgi/page.html&#34;.
&gt; &gt; 
&gt; &gt; After running wallflower, I get HTML pages where the link is reduced
&gt; &gt; to &#34;/page.html&#34;.
&gt; &gt; This is not what I want, because the pages will be located in the
&gt; &gt; folder /myapp &#40;e.g. <span class="clickylink"><a target="new" rel="nofollow" href="http://127.0.0.1/myapp/page.html&#41;">http://127.0.0.1/myapp/page.html&#41;</a></span>.
&gt; &gt; 
&gt; &gt; This was the command used:
&gt; &gt; wallflower --application &#34;C:\Apache\cgi-bin\myapp\index.cgi&#34;
&gt; &gt; 
&gt; &gt; So I tried the --url option to change the links &#40;NB: localhost is the
&gt; &gt; target server&#41;:
&gt; &gt; wallflower --application &#34;C:\Apache\cgi-bin\myapp\index.cgi&#34; --url
&gt; &gt; &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span>&#34;
&gt; &gt; 
&gt; &gt; But: doing so only yields a &#34;404 /&#34;
&gt; &gt; 
&gt; &gt; What am I doing wrong?
&gt; &gt; Could you eventually provide an example of the URL option in the
&gt; &gt; tutorial &#40;incl. a before and after example&#41;?
</div>&gt; 
&gt; The url option is for mounting Plack applications, as done by
&gt; Plack::App::URLMap. It does not influence URL produced by your
&gt; application, just the URL the application will reply to.
&gt; 
&gt; Could you show me an example of your application &#40;just a small subset
&gt; that exhibits the behaviour you&#39;re describing&#41;? That way, I could
&gt; better understand what&#39;s happening, and provide a correct answer.
&gt; 
&gt; Once we&#39;ve got an answer to your question, I can use it to produce
&gt; an example in the tutorial.
&gt; 
&gt; Regards,
&gt; 
&gt; -- BooK
</div>
Hi BooK,

please find below a working sample:

[snip]
#!perl

use Mojolicious::Lite;

any &#39;/&#39; =&gt; sub {
    my $c   = shift;
    $c-&gt;render&#40;template =&gt; &#34;index&#34;&#41;;
};

any &#39;/page.html&#39; =&gt; sub{
    my $c   = shift;
    $c-&gt;render&#40;text =&gt; &#39;this is a page&#39;&#41;;
};

app-&gt;start;

__DATA__

@@ index.html.ep
    &lt;html&gt;
        &lt;p&gt;This is a &lt;%= link_to &#39;/page.html&#39; =&gt; begin %&gt;link to page&lt;/a&gt;&lt;% end %&gt;.&lt;/p&gt;
    &lt;/html&gt;
[/snip]
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1497707" href="/Public/Bug/Display.html?id=104449#txn-1497707">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;05:26:19&nbsp;2015</span>
    <span class="description">book [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1497707/797773/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/797773">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the code example.

First, you were using the --url option correctly. :-&#41;

Here are the things I tried:

    $ wallflower --application app.psgi --dir static/ 
    200 / =&gt; static/index.html [91]
    200 /page.html =&gt; static/page.html [14]

Using the --url option to &#34;mount&#34; the app under /myapp:

    $ wallflower --application app.psgi --dir static/ --url <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span>
    404 /

So, same issue as you had. Until I realized that this is the correct behaviour,
because &#40;thanks to the --url option&#41;, your application now answers to the /myapp URL,
and not / any more.

wallflower starts spidering the application from /, but you can pass it a list of URL
on the command-line:

    $ wallflower --application app.psgi --dir static/ --url <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span> /myapp/
    200 /myapp/ =&gt; static/myapp/index.html [97]
    200 /myapp/page.html =&gt; static/myapp/page.html [14]

And it now works as expected!

Note that the initial URL *has* to be &#34;/myapp/&#34; with a final slash, to create a directory &#34;myapp&#34;
with an &#34;index.html&#34; file inside.

If you forget the final slash, you&#39;ll get an error:

    $ wallflower --application app.psgi --dir static/ --url <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span> /myapp
    200 /myapp =&gt; static/myapp [97]
    Can&#39;t open static/myapp/page.html for writing: Not a directory at /home/book/perl5/lib/perl5/App/Wallflower.pm line 130.

which is caused by the fact that wallflower puts the result of requesting &#34;/myapp&#34; into the
&#34;static/myapp&#34; file, and later on can&#39;t create the &#34;static/myapp&#34; directory to put the
content of the &#34;/myapp/page.html&#34; URL in it.

Regards,

-- BooK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1499156" href="/Public/Bug/Display.html?id=104449#txn-1499156">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;22&nbsp;18:18:01&nbsp;2015</span>
    <span class="description">ASB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1499156/798667/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/798667">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Di 19. Mai 2015, 05:26:19, BOOK schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for the code example.
&gt; 
&gt; First, you were using the --url option correctly. :-&#41;
&gt; 
&gt; Here are the things I tried:
&gt; 
&gt; $ wallflower --application app.psgi --dir static/
&gt; 200 / =&gt; static/index.html [91]
&gt; 200 /page.html =&gt; static/page.html [14]
&gt; 
&gt; Using the --url option to &#34;mount&#34; the app under /myapp:
&gt; 
&gt; $ wallflower --application app.psgi --dir static/ --url
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span>
&gt; 404 /
&gt; 
&gt; So, same issue as you had. Until I realized that this is the correct
&gt; behaviour,
&gt; because &#40;thanks to the --url option&#41;, your application now answers to
&gt; the /myapp URL,
&gt; and not / any more.
&gt; 
&gt; wallflower starts spidering the application from /, but you can pass
&gt; it a list of URL
&gt; on the command-line:
&gt; 
&gt; $ wallflower --application app.psgi --dir static/ --url
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span> /myapp/
&gt; 200 /myapp/ =&gt; static/myapp/index.html [97]
&gt; 200 /myapp/page.html =&gt; static/myapp/page.html [14]
&gt; 
&gt; And it now works as expected!
&gt; 
&gt; Note that the initial URL *has* to be &#34;/myapp/&#34; with a final slash, to
&gt; create a directory &#34;myapp&#34;
&gt; with an &#34;index.html&#34; file inside.
&gt; 
&gt; If you forget the final slash, you&#39;ll get an error:
&gt; 
&gt; $ wallflower --application app.psgi --dir static/ --url
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/myapp">http://localhost/myapp</a></span> /myapp
&gt; 200 /myapp =&gt; static/myapp [97]
&gt; Can&#39;t open static/myapp/page.html for writing: Not a directory at
&gt; /home/book/perl5/lib/perl5/App/Wallflower.pm line 130.
&gt; 
&gt; which is caused by the fact that wallflower puts the result of
&gt; requesting &#34;/myapp&#34; into the
&gt; &#34;static/myapp&#34; file, and later on can&#39;t create the &#34;static/myapp&#34;
&gt; directory to put the
&gt; content of the &#34;/myapp/page.html&#34; URL in it.
&gt; 
&gt; Regards,
&gt; 
&gt; -- BooK
</div>
Thanks, it worked for me now.

5 additional things came to my attention:

1. A file extension can also be a cgi file:

Although you put a lot of work into the tutorial section about &#34;URL SEMANTICS COMPARED TO DIRECTORY SEMANTICS&#34;, I ran into this problem.
It was not that obvious. As I&#39;m running the script in CGI mode &#40;as I will convert it into an offline page anyway, speed doesn&#39;t matter&#41;, I had a home URL named <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/cgi-bin/myapp/myapp.cgi">http://localhost/cgi-bin/myapp/myapp.cgi</a></span>

This is similar to a URL without extension. I had to change the URL to:
<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/cgi-bin/myapp/myapp.cgi/index.html">http://localhost/cgi-bin/myapp/myapp.cgi/index.html</a></span>

2. wallflower is a bit tricky to debug

It was a bit tricky to debug. I modified the Wallflower.pm file and added STDERR output messages. Logging would be nice. Would you accept a patch, once the module is available on github?
Or is there a simple way I didn&#39;t get?

3. undocumented --filter option

There is no documentation for --filter. Not in the wallpaper tutorial, not in the main manpage, and I didn&#39;t find a test for it. Is it just a list of URLs? Or can there be place hodlers?

4. There is no link to the tutorial in wallflower&#39;s manpage. There is only this one link that referrs to the section &#34;URL SEMANTICS COMPARED TO DIRECTORY SEMANTICS&#34;.

Could you please add it to SEE ALSO section?

5. it just works

Although there are some issues as pointed out before, it just works. Thank you for this great piece of software! I really enjoy it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1499158" href="/Public/Bug/Display.html?id=104449#txn-1499158">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;22&nbsp;18:18:02&nbsp;2015</span>
    <span class="description">ASB [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1501637" href="/Public/Bug/Display.html?id=104449#txn-1501637">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;29&nbsp;17:51:57&nbsp;2015</span>
    <span class="description">book [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1501637/800146/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/800146">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Many thanks for your comments.

On Fri May 22 18:18:01 2015, ASB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 5 additional things came to my attention:
&gt; 
&gt; 1. A file extension can also be a cgi file:
&gt; 
&gt; Although you put a lot of work into the tutorial section about &#34;URL
&gt; SEMANTICS COMPARED TO DIRECTORY SEMANTICS&#34;, I ran into this problem.
&gt; It was not that obvious. As I&#39;m running the script in CGI mode &#40;as I
&gt; will convert it into an offline page anyway, speed doesn&#39;t matter&#41;, I
&gt; had a home URL named <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/cgi-bin/myapp/myapp.cgi">http://localhost/cgi-bin/myapp/myapp.cgi</a></span>
&gt; 
&gt; This is similar to a URL without extension. I had to change the URL
&gt; to:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/cgi-bin/myapp/myapp.cgi/index.html">http://localhost/cgi-bin/myapp/myapp.cgi/index.html</a></span>
&gt; 
</div>
What would be a solution to that issue?

I&#39;m of the opinion that, if you want your web application to convert
smoothly to a static site, you have to put some effort into it, as
a static website imposes some restrictions on the type of URL that
can be served &#40;no query-string, for example&#41;.

Wallflower does a naïve conversion from the URL it&#39;s given:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/book/App-Wallflower/blob/master/lib/Wallflower.pm#L50">https://github.com/book/App-Wallflower/blob/master/lib/Wallflower.pm#L50</a></span>

There might be something that could be done with PATH_INFO, but I don&#39;t
see it yet.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2. wallflower is a bit tricky to debug
&gt; 
&gt; It was a bit tricky to debug. I modified the Wallflower.pm file and
&gt; added STDERR output messages. Logging would be nice. Would you accept
&gt; a patch, once the module is available on github?
&gt; Or is there a simple way I didn&#39;t get?
</div>
I&#39;d be interested to know the type of logging you&#39;ve added.
I&#39;ve been adding some options, but they only control which
URL and status codes are shown.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 3. undocumented --filter option
&gt; 
&gt; There is no documentation for --filter. Not in the wallpaper tutorial,
&gt; not in the main manpage, and I didn&#39;t find a test for it. Is it just a
&gt; list of URLs? Or can there be place hodlers?
</div>
I think the only documentation is here:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/book/App-Wallflower/blob/master/bin/wallflower#L39">https://github.com/book/App-Wallflower/blob/master/bin/wallflower#L39</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/book/App-Wallflower/blob/master/bin/wallflower#L66">https://github.com/book/App-Wallflower/blob/master/bin/wallflower#L66</a></span>

The arguments are URL from which Wallflower will start.

The --filter option turns it into a &#34;filter&#34;, so you can do:

    script-that-prints-url | wallflower --filter

or

    wallflower --filter urls.txt


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 4. There is no link to the tutorial in wallflower&#39;s manpage. There is
&gt; only this one link that referrs to the section &#34;URL SEMANTICS COMPARED
&gt; TO DIRECTORY SEMANTICS&#34;.
&gt; 
&gt; Could you please add it to SEE ALSO section?
</div>
Will do.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 5. it just works
&gt; 
&gt; Although there are some issues as pointed out before, it just works.
&gt; Thank you for this great piece of software! I really enjoy it.
</div>
Thanks!
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.412073</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
