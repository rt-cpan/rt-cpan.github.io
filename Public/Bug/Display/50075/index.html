<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #50075 for SVG: SVG inline code generation includes &lt;?xml...?&gt; line</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #50075 for SVG: SVG inline code generation includes &lt;?xml...?&gt; line</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=SVG">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=SVG">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=SVG">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=SVG">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/SVG">SVG CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">50075</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=SVG">SVG</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mmcgillis [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-30238-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.44    </td>
  </tr>
  <tr id="CF-30239-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=50075">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-669998" href="/Public/Bug/Display.html?id=50075#txn-669998">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;28&nbsp;14:26:50&nbsp;2009</span>
    <span class="description">mmcgillis [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> SVG inline code generation includes &lt;?xml...?&gt; line</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/669998/344339/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/344339">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;Try option -inline on method xmlify:
</div>
The code sample I provided uses it and that removes some information but the &lt;?xml..?&gt; 
line still is printed.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;If it fails, a trick you can use is to use a 2nd SVG constructor within your document and 
&gt;xmlify that one rather than the whole document, dropping all xml declarations and 
&gt;annotations:
&gt;
&gt;my $doc = SVG-&gt;new&#40;&#41;;
&gt;my $svg = $doc-&gt;svg&#40;&#41;;
&gt;...
&gt;$svg-&gt;xlify&#40;&#41;; #renders the inner svg snippet.
&gt;
&gt;Let me know where you are, and please submit an RT bug report if the inline function fails 
&gt;to do what you expect it to.
</div>
The above approach doesn&#39;t seem to generate proper svg information for browsers to render 
it correctly I only get:
&lt;svg height=&#34;100%&#34; width=&#34;100%&#34;&gt;
where we seem to need something more like
&lt;svg height=&#34;600&#34; width=&#34;600&#34; xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a></span>&#34; 
xmlns:svg=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a></span>&#34; xmlns:xlink=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</a></span>&#34;&gt;

So I&#39;m still not seeing a workable option using the code as is.

I would be happy to generate an RT if I had a URL of where to enter it. The only thing I found 
definitive to get information to the developers of this project was this e-mail address.

Matthew

On Sep 27, 2009, at 8:17 PM, &lt;ronan.oger@roitsystems.com&gt; wrote:


Hi Matthew,

Try option -inline on method xmlify:

$svg-&gt;xmlify&#40;-inline&#41;

It&#39;s described in SVG::Manual.

Also take a look at the installation test 04-inline.t

<span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/RONAN/SVG-2.49/t/04-inline.t">http://cpansearch.perl.org/src/RONAN/SVG-2.49/t/04-inline.t</a></span>

Unfortunately I&#39;m nowhere near a machine where I can verify that the snippet actually works.

If it fails, a trick you can use is to use a 2nd SVG constructor within your document and 
xmlify that one rather than the whole document, dropping all xml declarations and 
annotations:

my $doc = SVG-&gt;new&#40;&#41;;
my $svg = $doc-&gt;svg&#40;&#41;;
...
$svg-&gt;xlify&#40;&#41;; #renders the inner svg snippet.

Let me know where you are, and please submit an RT bug report if the inline function fails to 
do what you expect it to.

Thanks for the ping,

Ronan

From:     Matthew McGillis &lt;matthew@mcgillis.org&gt;
Date:     9/28/09 2:03Subject:  SVG

I was looking at using your SVG module for generating some web content.

Using something like:

#!/usr/bin/perl

use CGI;
use SVG;

my $cgi=CGI-&gt;new&#40;&#41;;
my $svg=SVG-&gt;new&#40;width=&gt;200,height=&gt;200&#41;;

my $y=$svg-&gt;group&#40;id=&gt;&#39;group_y&#39;,style=&gt;{stroke=&gt;&#39;red&#39;,fill=&gt;&#39;green&#39;}&#41;;
$y-&gt;circle&#40;cx=&gt;100,cy=&gt;100,r=&gt;50,id=&gt;&#39;circle_in_group_y&#39;&#41;;

print $cgi-&gt;header&#40;&#34;application/xhtml+xml&#34;&#41;;
print qq|&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;\n|;
print qq|&lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.1 plus MathML 2.0
plus SVG 1.1//EN&#34; &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg-">http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg-</a></span>
flat.dtd
&#34;&gt;\n|;
print qq|&lt;html xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</a></span>&#34; xml:lang=&#34;en&#34;&gt;\n|;
print &#34;&lt;head&gt;\n&#34;;
print &#34;&lt;title&gt;Test&lt;/title&gt;\n&#34;;
print &#34;&lt;/head&gt;\n&#34;;
print &#34;&lt;body&gt;\n&#34;;
print $svg-&gt;xmlify&#40;-inline =&gt; 1&#41;;
print &#34;&lt;/body&gt;\n&#34;;
print &#34;&lt;/html&gt;\n&#34;;

Unfortunately the above generates:

Content-Type: application/xhtml+xml

&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG
1.1//EN&#34; &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg-flat.dtd">http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg-flat.dtd</a></span>
&#34;&gt;
&lt;html xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</a></span>&#34; xml:lang=&#34;en&#34;&gt;
&lt;head&gt;
&lt;title&gt;Test&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34;?&gt;

&lt;svg height=&#34;200&#34; width=&#34;200&#34; xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a></span>&#34;
xmlns:svg=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a></span>&#34; xmlns:xlink=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</a></span>
&#34;&gt;
        &lt;g id=&#34;group_y&#34; style=&#34;fill: green; stroke: red&#34;&gt;
                &lt;circle cx=&#34;100&#34; cy=&#34;100&#34; id=&#34;circle_in_group_y&#34; r=&#34;50&#34; /&gt;
        &lt;/g&gt;&lt;!--
        Generated using the Perl SVG Module V2.44
        by Ronan Oger
        Info: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.roitsystems.com/">http://www.roitsystems.com/</a></span>
--&gt;
&lt;/svg&gt;&lt;/body&gt;
&lt;/html&gt;

Which is very close to workable however svg generates an extra &lt;?
xml ...?&gt; line causing the above xhtml to be invalid. I did some
digging into your code and could not find any hooks to prevent that
line from getting generated for this sort of situation. If I have
missed something please let me know. If not this would be useful
functionality for this sort of coding.

Thanks,
Matthew
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-759956" href="/Public/Bug/Display.html?id=50075#txn-759956">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;08&nbsp;05:58:48&nbsp;2010</span>
    <span class="description">florent.angly [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/759956/393034/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/393034">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 54b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks Matthew, this is fixed in version 2.50.
Florent
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-759959" href="/Public/Bug/Display.html?id=50075#txn-759959">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;08&nbsp;05:58:49&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-759960" href="/Public/Bug/Display.html?id=50075#txn-759960">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;08&nbsp;05:58:49&nbsp;2010</span>
    <span class="description">florent.angly [...] gmail.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.29748</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
