<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #13793 for Maypole-Plugin-QuickTable: display of has_many columns is broken in new tabulate</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #13793 for Maypole-Plugin-QuickTable: display of has_many columns is broken in new tabulate</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Maypole-Plugin-QuickTable/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Maypole-Plugin-QuickTable/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Maypole-Plugin-QuickTable/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Maypole-Plugin-QuickTable/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Maypole-Plugin-QuickTable">Maypole-Plugin-QuickTable CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">13793</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Maypole-Plugin-QuickTable/Active/">Maypole-Plugin-QuickTable</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
davekam [...] pobox.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-21124-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-21125-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;20&nbsp;09:15:11&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> display of has_many columns is broken in new tabulate</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I inserted the following for debugging at line 168 in _tabulate:

    use Data::Dumper;
    print STDERR Dumper&#40;$cols&#41;;
    my @blah = map { $object-&gt;$_ } @$cols;
    print STDERR Dumper&#40;@blah&#41;;

It produces the following results:

$VAR1 = [
          &#39;table_id&#39;,
          &#39;ref&#39;,
          &#39;description&#39;,
          &#39;num_items&#39;,
          &#39;m_time&#39;,
          &#39;items&#39;
        ];

$VAR1 = [
          &#39;table_id&#39;,
          &#39;ref&#39;,
          &#39;description&#39;,
          &#39;num_items&#39;,
          &#39;m_time&#39;,
          &#39;items&#39;
        ];
$VAR1 = &#39;3&#39;;
$VAR2 = &#39;blibble&#39;;
$VAR3 = &#39;blabble&#39;;
$VAR4 = &#39;0&#39;;
$VAR5 = bless&#40; [
                 27,
                 5,
                 17,
                 18,
                 6,
                 105,
                 1,
                 198,
                 0,
                 undef,
                 0,
                 0
               ], &#39;Time::Piece&#39; &#41;;

In other words, the items field vanishes entirely, presumably because $object-&gt;$_ is returning undef or an empty array. In my database as it currently stands there are not yet any items. Presumably if there were, _tabulate&#40;&#41; would work ok. But in the case where there are none, it produces a big problem because an entire column is missing from the resulting HTML table, causing misalignment. This is, perhaps, yet another argument for forced stringification &#40;see #13778&#41;.

BTW, I&#39;m not so sure if it&#39;s a good idea to include _all_ related items in a case like this &#40;there could be dozens or even hundreds or thousands&#41;, although I certainly appreciate the added functionality and speed with which the general issue &#40;tabulate always assuming display_columns&#41; was resolved.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;20&nbsp;10:07:44&nbsp;2005</span>
    <span class="description">cpan.zerofive [...] googlemail.com -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;20&nbsp;10:07:44&nbsp;2005</span>
    <span class="description">cpan.zerofive [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[guest - Wed Jul 20 09:15:11 2005]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I inserted the following for debugging at line 168 in _tabulate:
&gt; 
&gt;     use Data::Dumper;
&gt;     print STDERR Dumper&#40;$cols&#41;;
&gt;     my @blah = map { $object-&gt;$_ } @$cols;
&gt;     print STDERR Dumper&#40;@blah&#41;;
&gt; 
&gt; It produces the following results:
&gt; 
&gt; $VAR1 = [
&gt;           &#39;table_id&#39;,
&gt;           &#39;ref&#39;,
&gt;           &#39;description&#39;,
&gt;           &#39;num_items&#39;,
&gt;           &#39;m_time&#39;,
&gt;           &#39;items&#39;
&gt;         ];
&gt; 
&gt; $VAR1 = [
&gt;           &#39;table_id&#39;,
&gt;           &#39;ref&#39;,
&gt;           &#39;description&#39;,
&gt;           &#39;num_items&#39;,
&gt;           &#39;m_time&#39;,
&gt;           &#39;items&#39;
&gt;         ];
&gt; $VAR1 = &#39;3&#39;;
&gt; $VAR2 = &#39;blibble&#39;;
&gt; $VAR3 = &#39;blabble&#39;;
&gt; $VAR4 = &#39;0&#39;;
&gt; $VAR5 = bless&#40; [
&gt;                  27,
&gt;                  5,
&gt;                  17,
&gt;                  18,
&gt;                  6,
&gt;                  105,
&gt;                  1,
&gt;                  198,
&gt;                  0,
&gt;                  undef,
&gt;                  0,
&gt;                  0
&gt;                ], &#39;Time::Piece&#39; &#41;;
&gt; 
&gt; In other words, the items field vanishes entirely, presumably because
&gt;    $object-&gt;$_ is returning undef or an empty array. In my database as
&gt;    it currently stands there are not yet any items. Presumably if
&gt;    there were, _tabulate&#40;&#41; would work ok. But in the case where there
&gt;    are none, it produces a big problem because an entire column is
&gt;    missing from the resulting HTML table, causing misalignment. This
&gt;    is, perhaps, yet another argument for forced stringification &#40;see
&gt;    #13778&#41;.
&gt; 
&gt; BTW, I&#39;m not so sure if it&#39;s a good idea to include _all_ related
&gt;    items in a case like this &#40;there could be dozens or even hundreds
&gt;    or thousands&#41;, although I certainly appreciate the added
&gt;    functionality and speed with which the general issue &#40;tabulate
&gt;    always assuming display_columns&#41; was resolved.
</div>
This is fixed in QT 0.3. Empty columns are turned into an empty string
rather than an empty list, so the table cell gets rendered and the
columns stay in sync. Muliple returns are transformed into a single list
to go in the table cell. 

The templates are intended to be a starting point. Wherever sensible and
useful default behaviour can be identified, I want to include it, but
some things depend entirely on the application. Having said that, I
think the tabulate&#40;&#41; method needs a lot more flexibility. It&#39;s easy to
override how a field is rendered in CDBI::FB, but not in tabulate&#40;&#41;, so
expect that to evolve, and send me any suggestions you have. 

d.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
