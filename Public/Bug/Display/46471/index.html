<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #46471 for libintl-perl: N__&#40;&#41; in scalar context</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #46471 for libintl-perl: N__&#40;&#41; in scalar context</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/libintl-perl/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/libintl-perl/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/libintl-perl/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/libintl-perl/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/libintl-perl">libintl-perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">46471</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/libintl-perl/Active/">libintl-perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">GUIDO [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
user42 [...] zip.com.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-18278-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-18279-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;29&nbsp;11:10:30&nbsp;2009</span>
    <span class="description">user42 [...] zip.com.au -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> N__&#40;&#41; in scalar context</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 30 May 2009 01:09:57 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libintl-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">With libintl-perl 0.18 and i386 debian perl 5.10.0 the program foo.pl
below prints

        1

where I hoped it would print

        true message

It&#39;d be good if a call to N__&#40;&#41; with one arg in scalar context returned
that arg.

I see the SYNOPSIS section of Locale::TextDomain shows N__ with two
args,

        my @plurals = &#40;N__ &#40;&#34;One world&#34;, &#34;{num} worlds&#34;&#41;,
                       N__ &#40;&#34;1 file&#34;, &#34;%d files&#34;&#41;&#41;;

so I suppose in array context it should continue to return all args in
case someone has cut and pasted from there.  Perhaps N__n&#40;&#41; is intended
though, or if all of N__ N__n N__xn etc are aliases anyway then it
doesn&#39;t matter which.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use warnings;
use Locale::TextDomain;
my $message = &#40;2+2 == 4
               ? N__&#40;&#39;true message&#39;&#41;
               : N__&#40;&#39;false message&#39;&#41;&#41;;
print $message,&#34;\n&#34;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;29&nbsp;11:35:14&nbsp;2009</span>
    <span class="description">GUIDO [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;29&nbsp;12:16:08&nbsp;2009</span>
    <span class="description">GUIDO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri May 29 11:10:30 2009, user42@zip.com.au wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ...
&gt; It&#39;d be good if a call to N__&#40;&#41; with one arg in scalar context returned
&gt; that arg.
</div>
Yes, confirmed.  The function is prototyped, so it can actually not be
called with more than one arg.

Anyway, both in scalar and array context, the argument should be
returned, for practical reasons.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I see the SYNOPSIS section of Locale::TextDomain shows N__ with two
&gt; args,
&gt; 
&gt;         my @plurals = &#40;N__ &#40;&#34;One world&#34;, &#34;{num} worlds&#34;&#41;,
&gt;                        N__ &#40;&#34;1 file&#34;, &#34;%d files&#34;&#41;&#41;;
&gt; 
&gt; so I suppose in array context it should continue to return all args in
&gt; case someone has cut and pasted from there.  Perhaps N__n&#40;&#41; is intended
&gt; though, or if all of N__ N__n N__xn etc are aliases anyway then it
&gt; doesn&#39;t matter which.
</div>
Yes N__n&#40;&#41; was meant.

However, all N__[np]+ functions that take more than one argument are
tricky.  What should be returned?

Their purpose is to postpone actual translation, typically because they
are called to early, and the user locale is not yet set.

Let&#39;s look at N__n&#40;&#41;.  In array context, it is pretty obvious, that the
caller wants all three arguments.  And in scalar context? If somebody
uses these functions in scalar context, it is probably a bug.  Say for
example, somebody really writes:

    my $message = N__n&#40;&#34;One world&#34;, &#34;{num} worlds&#34;, 3&#41;;

Both strings are marked and will appear in one entry in the po file, but
in this case &#40;count is 3&#41;, the first string is effectively discarded
inside the script.  If you later really want the translation, you have
to write it again.  And either it will be found again by xgettext, or
you write something really braindamaged like:

    my $count = int rand 10;
    my $void = N__n&#40;&#34;One world&#34;, &#34;{num} worlds&#34;, $count;
    my $sg = &#34;One world&#34;;
    my $pl = &#34;{num} worlds&#34;;
    POSIX::setlocale &#40;LC_ALL, &#39;&#39;&#41;;
    my $non_void = N__n&#40;$sg, $pl, $count&#41;;

Well, pretty esoteric.

I will change the implementation of implementation of N__&#40;&#41;, although it
is actually a little inconsistent.  But for convenience it makes sense.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;29&nbsp;12:16:09&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;29&nbsp;12:57:46&nbsp;2009</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46471] N__&#40;&#41; in scalar context</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 30 May 2009 02:57:19 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libintl-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;GUIDO via RT&#34; &lt;bug-libintl-perl@rt.cpan.org&gt; writes:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; The function is prototyped
</div>
Is it?  I see __&#40;&#41; prototyped, but is N__ the same?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, all N__[np]+ functions that take more than one argument are
&gt; tricky.  What should be returned?
</div>
Oh, umm, yes.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     my $message = N__n&#40;&#34;One world&#34;, &#34;{num} worlds&#34;, 3&#41;;
</div>
Maybe return the two messages, and don&#39;t have a number until later.

    my @message = &#40;N__n&#40;&#34;File&#34;, &#34;Files&#34;&#41;&#41;;

    # and later ...
    print ngettext&#40;@message, $count&#41;;

Does that sound likely?  That&#39;s how it is now is it?

Or equally well with a constant of the two returned strings, if that
looked better or worse.

    use constant MESSAGE_N =&gt; N__n&#40;&#34;File&#34;, &#34;Files&#34;&#41;;
    ...
    print ngettext&#40;MESSAGE_N, $count&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     my $void = N__n&#40;&#34;One world&#34;, &#34;{num} worlds&#34;, $count;
&gt;     my $sg = &#34;One world&#34;;
&gt;     my $pl = &#34;{num} worlds&#34;;
</div>
Oh, well, I suppose the aim of whatever return value&#40;s&#41; would be to help
you not write the strings twice.  But I haven&#39;t struck a case myself yet
where I needed to conditionalize or select a plural form :-&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;30&nbsp;05:42:34&nbsp;2009</span>
    <span class="description">GUIDO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri May 29 12:57:46 2009, user42@zip.com.au wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#34;GUIDO via RT&#34; &lt;bug-libintl-perl@rt.cpan.org&gt; writes:
<div class="message-stanza open">&gt; &gt;
&gt; &gt; The function is prototyped
</div>&gt; 
&gt; Is it?  I see __&#40;&#41; prototyped, but is N__ the same?
</div>
You&#39;re right, I forgot that.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;     my $message = N__n&#40;&#34;One world&#34;, &#34;{num} worlds&#34;, 3&#41;;
</div>&gt; 
&gt; Maybe return the two messages, and don&#39;t have a number until later.
&gt; 
&gt;     my @message = &#40;N__n&#40;&#34;File&#34;, &#34;Files&#34;&#41;&#41;;
&gt; 
&gt;     # and later ...
&gt;     print ngettext&#40;@message, $count&#41;;
&gt; 
&gt; Does that sound likely?  That&#39;s how it is now is it?
</div>
It will not work because __n&#40;&#41; resp. ngettext&#40;&#41; is prototyped.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Or equally well with a constant of the two returned strings, if that
&gt; looked better or worse.
&gt; 
&gt;     use constant MESSAGE_N =&gt; N__n&#40;&#34;File&#34;, &#34;Files&#34;&#41;;
&gt;     ...
&gt;     print ngettext&#40;MESSAGE_N, $count&#41;;
</div>
Hm, I think it is cleaner to just return whatever you stuffed into the
function.  In order to accomadate the prototype of __n&#40;&#41;/ngettext&#40;&#41;, you
have to unroll the list anyway:

    print __n&#40;CONST-&gt;[0], CONST-&gt;[1], $count&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Oh, well, I suppose the aim of whatever return value&#40;s&#41; would be to help
&gt; you not write the strings twice.  But I haven&#39;t struck a case myself yet
&gt; where I needed to conditionalize or select a plural form :-&#41;.
</div>
Yes, barely needed, and that&#39;s why I hope that I can break compatibility
here without later being flamed. ;-&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;30&nbsp;20:24:10&nbsp;2009</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46471] N__&#40;&#41; in scalar context</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 31 May 2009 10:22:54 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libintl-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;GUIDO via RT&#34; &lt;bug-libintl-perl@rt.cpan.org&gt; writes:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; It will not work because __n&#40;&#41; resp. ngettext&#40;&#41; is prototyped.
</div>
Ah.  Another reason prototypes should be banned :-&#41; Or rather a bit of
syntactic sugar on one-arg funcs, but multi-arg always seems doubtful.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     print __n&#40;CONST-&gt;[0], CONST-&gt;[1], $count&#41;;
</div>
Or rather I suppose with a list constant it&#39;s

      print __n&#40;&#40;CONST&#41;[0], &#40;CONST&#41;[1], $count&#41;;

or maybe easier to side-step the prototype

      print &#38;ngettext&#40;MSG_N, $count&#41;;

Either way I suppose the count arg belongs in the ngettext, not the
N__n, if the point of N__n is that it&#39;s only for marking strings,
ie. much earlier than the translation lookup.  You could think about
taking it out of the POD of N__n and N__np.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;01&nbsp;05:05:22&nbsp;2009</span>
    <span class="description">GUIDO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat May 30 20:24:10 2009, user42@zip.com.au wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#34;GUIDO via RT&#34; &lt;bug-libintl-perl@rt.cpan.org&gt; writes:
<div class="message-stanza open">&gt; &gt;
&gt; &gt; It will not work because __n&#40;&#41; resp. ngettext&#40;&#41; is prototyped.
</div>&gt; 
&gt; Ah.  Another reason prototypes should be banned :-&#41; Or rather a bit of
&gt; syntactic sugar on one-arg funcs, but multi-arg always seems doubtful.
</div>
I wanted to be able to write things like this:

    print __&#34;Hello world!&#34;, &#34;\n&#34;;

You need prototypes for that.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Either way I suppose the count arg belongs in the ngettext, not the
&gt; N__n, if the point of N__n is that it&#39;s only for marking strings,
&gt; ie. much earlier than the translation lookup.  You could think about
&gt; taking it out of the POD of N__n and N__np.
</div>
I thought about a consistent way, how I could explain how the N__[np]+
functions work.  IMHO, the closest resemblance to the C &#40;preprocessor&#41;
macro N_&#40;&#41; is to define that the functions are always a complete noop,
so that these things work as if you had omitted the intermediate call to
the noop functions:

    &#38;__&#40;N__&#40;&#34;Hello world!&#34;&#41;&#41;;
    &#38;__n&#40;N__n&#40;&#34;Hello world!&#34;, &#34;Hello worlds!&#34;, $count&#41;&#41;;
    &#38;__p&#40;N__p&#40;&#34;Menu|File|&#34;, &#34;Open&#34;&#41;&#41;;
    # etc.

Additional magic like discarding arguments would spoil the concept and
make it even less understandable.

You have a point, sure, but i kind of like the transparent approach better.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;01&nbsp;16:56:45&nbsp;2009</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46471] N__&#40;&#41; in scalar context</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 02 Jun 2009 06:56:11 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libintl-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;GUIDO via RT&#34; &lt;bug-libintl-perl@rt.cpan.org&gt; writes:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;     print __&#34;Hello world!&#34;, &#34;\n&#34;;
</div>
I&#39;ve been happy with parens like

      print __&#40;&#39;Hello&#39;&#41;, &#34;\n&#34;;

because I wanted to use single quotes and since __&#39;Hello&#39; doesn&#39;t work,
of course the &#39; being the old package part separator.  You could think
about a note on the latter under the __ docs, explaining why __&#34;&#34; is
good &#40;and how the prototype helps&#41; but __&#39;&#39; can&#39;t be used.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     &#38;__n&#40;N__n&#40;&#34;Hello world!&#34;, &#34;Hello worlds!&#34;, $count&#41;&#41;;
</div>
That&#39;s the one I suspect the messages would be in the N__n and the count
outside, ie.

      &#38;__n&#40;N__n&#40;&#34;Hello world!&#34;, &#34;Hello worlds!&#34;&#41;, $count&#41;;

I guess both work, as long as it&#39;s nice and clear N__n does nothing
except return all its args.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;19&nbsp;04:47:41&nbsp;2009</span>
    <span class="description">GUIDO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in libintl-perl 1.19.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;19&nbsp;04:47:43&nbsp;2009</span>
    <span class="description">GUIDO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
