<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #80527 for Pod-Perldoc: perldoc cannot find functions sections when is called with -L switch</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #80527 for Pod-Perldoc: perldoc cannot find functions sections when is called with -L switch</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Pod-Perldoc">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Pod-Perldoc">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Pod-Perldoc">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Pod-Perldoc">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Pod-Perldoc">Pod-Perldoc CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">80527</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Pod-Perldoc">Pod-Perldoc</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
explorer [...] joaquinferrero.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-26136-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
3.17    </td>
  </tr>
  <tr id="CF-26137-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
3.20    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=80527">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1135016" href="/Public/Bug/Display.html?id=80527#txn-1135016">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;31&nbsp;11:44:36&nbsp;2012</span>
    <span class="description">explorer [...] joaquinferrero.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> explorer [...] joaquinferrero.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> perldoc cannot find functions sections when is called with -L switch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1135016/597274/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/597274">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">When perldoc is called using the &#39;-L XX&#39; and &#39;-f&#39; switches, it
cannot find the corresponding section of the requested function
if the string returned by POD2::XX::search_perlfunc_re&#40;&#41; &#40;i.e.
the string that marks the beginning of the section in
perlfunc.pod that contains the descriptions of the functions
available&#41; is not encoded as iso-8859-1.

       perldoc -L ES perlfunc

    works, but

       perldoc -L ES -f chr

    returns the following error message:

   No documentation for perl function &#39;chr&#39; found

Interum solution: search_perlfunc_re&#40;&#41; should return an
iso-8859-1-encoded string fully &#40;or partially&#41; matching the same
string that should appear in perlfunc.pod.

Proposed solution: The search process of the string returned by
search_perlfunc_re&#40;&#41; should consider the encoding used for
perlfunc.pod.

In POD2::ES all the docs are UTF-8-encoded. As a temporary
solution, we have fixed this issue by removing characters with
diacritic marks:

        sub search_perlfunc_re {
            return &#39;Lista de funciones de Perl en orden&#39;;
        }

    &#40;removed ‘alfabético’&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1135058" href="/Public/Bug/Display.html?id=80527#txn-1135058">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;31&nbsp;15:05:47&nbsp;2012</span>
    <span class="description">mrallen1 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1135058/597298/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/597298">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 560b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        perldoc -L ES perlfunc
&gt; 
&gt;     works, but
&gt; 
&gt;        perldoc -L ES -f chr
&gt; 
&gt;     returns the following error message:
&gt; 
&gt;    No documentation for perl function &#39;chr&#39; found
&gt; 
&gt; Interum solution: search_perlfunc_re&#40;&#41; should return an
&gt; iso-8859-1-encoded string fully &#40;or partially&#41; matching the same
&gt; string that should appear in perlfunc.pod.
&gt; 
&gt; Proposed solution: The search process of the string returned by
&gt; search_perlfunc_re&#40;&#41; should consider the encoding used for
&gt; perlfunc.pod.
</div>
Thanks for the report. We definitely need to fix this.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1135061" href="/Public/Bug/Display.html?id=80527#txn-1135061">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;31&nbsp;15:05:48&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1175371" href="/Public/Bug/Display.html?id=80527#txn-1175371">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;28&nbsp;22:49:33&nbsp;2013</span>
    <span class="description">mrallen1 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1175371/619942/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/619942">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 31 11:44:36 2012, explorer@joaquinferrero.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When perldoc is called using the &#39;-L XX&#39; and &#39;-f&#39; switches, it
&gt; cannot find the corresponding section of the requested function
&gt; if the string returned by POD2::XX::search_perlfunc_re&#40;&#41; &#40;i.e.
&gt; the string that marks the beginning of the section in
&gt; perlfunc.pod that contains the descriptions of the functions
&gt; available&#41; is not encoded as iso-8859-1.
&gt; 
&gt;        perldoc -L ES perlfunc
&gt; 
&gt;     works, but
&gt; 
&gt;        perldoc -L ES -f chr
&gt; 
&gt;     returns the following error message:
&gt; 
&gt;    No documentation for perl function &#39;chr&#39; found
&gt; 
&gt; Interum solution: search_perlfunc_re&#40;&#41; should return an
&gt; iso-8859-1-encoded string fully &#40;or partially&#41; matching the same
&gt; string that should appear in perlfunc.pod.
&gt; 
&gt; Proposed solution: The search process of the string returned by
&gt; search_perlfunc_re&#40;&#41; should consider the encoding used for
&gt; perlfunc.pod.
&gt; 
&gt; In POD2::ES all the docs are UTF-8-encoded. As a temporary
&gt; solution, we have fixed this issue by removing characters with
&gt; diacritic marks:
&gt; 
&gt;       sub search_perlfunc_re {
&gt;           return &#39;Lista de funciones de Perl en orden&#39;;
&gt;       }
&gt; 
&gt;     &#40;removed ‘alfabético’&#41;
</div>
There&#39;s no easy way to tell what encoding a given file is in reliably,
so I am wondering if we should have a callback function in POD2::XX like
search_perlfunc_re_encoding&#40;&#41; which returns a string scalar like
&#34;latin1&#34; or &#34;utf8&#34; or whatever is appropriate.  

What do you think about that?

Thanks.

Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1175934" href="/Public/Bug/Display.html?id=80527#txn-1175934">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;30&nbsp;10:48:30&nbsp;2013</span>
    <span class="description">dolmen [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1175934/620241/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/620241">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 894b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le 2013-01-29 04:49:33, mallen a écrit :

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; There&#39;s no easy way to tell what encoding a given file is in reliably,
</div>
This is irrelevant to the issue.
Perl source encoding is specified with &#34;use utf8&#34; or &#34;use encoding ...&#34;.
POD source encoding is specified with &#34;=encoding ...&#34;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; so I am wondering if we should have a callback function in POD2::XX like
&gt; search_perlfunc_re_encoding&#40;&#41; which returns a string scalar like
&gt; &#34;latin1&#34; or &#34;utf8&#34; or whatever is appropriate.  
</div>
POD2::ES has &#34;use utf8&#34; at the beginning.
So the search_perlfunc_re_encoding&#40;&#41; returns a Unicode strings &#40;which
Perl internals calls &#34;utf8&#34;, see the utf8 module&#41;.

So POD2::ES seems fine. This is Perldoc that must be fixed.

Mark, are you sure that Perldoc correctly process POD sections after
having decoded it from bytes to the encoding specified by &#34;=encoding&#34; ?

-- 
Olivier Mengué - <span class="clickylink"><a target="new" rel="nofollow" href="http://perlresume.org/DOLMEN">http://perlresume.org/DOLMEN</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1176083" href="/Public/Bug/Display.html?id=80527#txn-1176083">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;30&nbsp;16:40:16&nbsp;2013</span>
    <span class="description">explorer [...] joaquinferrero.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #80527] perldoc cannot find functions sections when is called with -L switch</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 30 Jan 2013 22:39:56 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Pod-Perldoc [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Joaquin Ferrero &lt;explorer [...] joaquinferrero.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1176083/620327/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/620327">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">El 29/01/13 04:49, Mark Allen via RT escribió:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=80527">https://rt.cpan.org/Ticket/Display.html?id=80527</a></span> &gt;
&gt;
&gt; On Wed Oct 31 11:44:36 2012, explorer@joaquinferrero.com wrote:
<div class="message-stanza open">&gt;&gt; When perldoc is called using the &#39;-L XX&#39; and &#39;-f&#39; switches, it
&gt;&gt; cannot find the corresponding section of the requested function
&gt;&gt; if the string returned by POD2::XX::search_perlfunc_re&#40;&#41; &#40;i.e.
&gt;&gt; the string that marks the beginning of the section in
&gt;&gt; perlfunc.pod that contains the descriptions of the functions
&gt;&gt; available&#41; is not encoded as iso-8859-1.
&gt;&gt;
&gt;&gt;         perldoc -L ES perlfunc
&gt;&gt;
&gt;&gt;      works, but
&gt;&gt;
&gt;&gt;         perldoc -L ES -f chr
&gt;&gt;
&gt;&gt;      returns the following error message:
&gt;&gt;
&gt;&gt;     No documentation for perl function &#39;chr&#39; found
&gt;&gt;
&gt;&gt; Interum solution: search_perlfunc_re&#40;&#41; should return an
&gt;&gt; iso-8859-1-encoded string fully &#40;or partially&#41; matching the same
&gt;&gt; string that should appear in perlfunc.pod.
&gt;&gt;
&gt;&gt; Proposed solution: The search process of the string returned by
&gt;&gt; search_perlfunc_re&#40;&#41; should consider the encoding used for
&gt;&gt; perlfunc.pod.
&gt;&gt;
&gt;&gt; In POD2::ES all the docs are UTF-8-encoded. As a temporary
&gt;&gt; solution, we have fixed this issue by removing characters with
&gt;&gt; diacritic marks:
&gt;&gt;
&gt;&gt;      sub search_perlfunc_re {
&gt;&gt;          return &#39;Lista de funciones de Perl en orden&#39;;
&gt;&gt;      }
&gt;&gt;
&gt;&gt;      &#40;removed ‘alfabético’&#41;
</div>&gt;
&gt; There&#39;s no easy way to tell what encoding a given file is in reliably,
&gt; so I am wondering if we should have a callback function in POD2::XX like
&gt; search_perlfunc_re_encoding&#40;&#41; which returns a string scalar like
&gt; &#34;latin1&#34; or &#34;utf8&#34; or whatever is appropriate.
&gt;
&gt; What do you think about that?
&gt;
&gt; Thanks.
&gt;
&gt; Mark
&gt;
&gt;
&gt;
</div>

Other solution:

1&#41; edit perlfunc.pod, and search by line

=head2 Alphabetical Listing of Perl Functions

And add one line, below:

X&lt;Alphabetical Listing of Perl Functions&gt;

or,

=for Pod::Functions Alphabetical Listing of Perl Functions


2&#41; Modify the perldoc procedure to search by this line, and not by the =head2 line.

The =head2 tag will by displayed by perldoc, but not the =for line


With this solution, the translations teams and perldoc don&#39;t need the search_perlfunc_re&#40;&#41; function anymore :&#41;


Best Regards,

JF^D
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1176131" href="/Public/Bug/Display.html?id=80527#txn-1176131">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;30&nbsp;18:50:55&nbsp;2013</span>
    <span class="description">mrallen1 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1176131/620350/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/620350">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 960b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 30 10:48:30 2013, DOLMEN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So POD2::ES seems fine. This is Perldoc that must be fixed.
&gt; 
&gt; Mark, are you sure that Perldoc correctly process POD sections after
&gt; having decoded it from bytes to the encoding specified by &#34;=encoding&#34; ?
</div>
Perldoc *doesn&#39;t* interpret POD at all.  It&#39;s jobs are:

1&#41; Locate the appropriate file &#40;or section of perlfunc, etc&#41;
2&#41; Feed the file to the appropriate formatter
3&#41; Dump the formatted output from step #2 to a pager

So perldoc has no way of correctly interpreting =encoding directives without parsing through 
the file and looking for them.  It&#39;s arguable that it *ought* to do that, but historically it hasn&#39;t.

That&#39;s why I suggested making the encoding of the POD2::XX regex a callback.

We could instead *assume* that POD2::XX is encoded in Latin1 unless Encode:is_utf8 returns 
true. Or vice versa &#40;assume it&#39;s utf8 unless is_utf8 returns false&#41;

Other thoughts?

Thanks for your help on this.

Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1205896" href="/Public/Bug/Display.html?id=80527#txn-1205896">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;27&nbsp;01:31:05&nbsp;2013</span>
    <span class="description">mrallen1 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1205896/636727/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/636727">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 913b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 31 11:44:36 2012, explorer@joaquinferrero.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In POD2::ES all the docs are UTF-8-encoded. As a temporary
&gt; solution, we have fixed this issue by removing characters with
&gt; diacritic marks:
&gt; 
&gt;       sub search_perlfunc_re {
&gt;           return &#39;Lista de funciones de Perl en orden&#39;;
&gt;       }
&gt; 
&gt;     &#40;removed ‘alfabético’&#41;
</div>
OK, I found the problem.  When perldoc open filehandles for &#34;dynamic&#34; POD files - like extracts from perlfunc.pod it doesn&#39;t open them as UTF-8, so we make sure to do so and add an &#39;=encoding utf8&#39; on top of that.

This has the happy side effect of making the full regex with diacritical marks work properly &#40;at least on my local Pod::Perldoc.&#41;

Somewhere in the tool chain, you need the latest Pod::Simple and Pod::Text distributions from CPAN as they have much much better UTF-8 support in them now.

This is fixed in Pod::Perldoc 3.20 which headed to CPAN shortly.

Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1214447" href="/Public/Bug/Display.html?id=80527#txn-1214447">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;20&nbsp;08:24:01&nbsp;2013</span>
    <span class="description">http://joaquinferrero.com/ -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Joaquin Ferrero &lt;explorer [...] joaquinferrero.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1214447/641310/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/641310">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 683b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">El Sáb Abr 27 01:31:05 2013, mallen escribió:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; This is fixed in Pod::Perldoc 3.20 which headed to CPAN shortly.
&gt; 
</div>
Confirmed.

POD2/ES.pm:
       55 # String for perldoc with -L switch
       56 sub search_perlfunc_re {
       57     return &#39;Lista de funciones de Perl en orden alfabético&#39;;
       58 }

&#40;I added the word &#34;alfabético&#34;, with the &#34;é&#34; utf8 char&#41;

Now, perldoc -f &lt;function&gt; work perfectly:

$ perldoc -f chr
    chr NÚMERO
    chr     Devuelve el carácter representado por NÚMERO en el conjunto de
            caracteres. Por ejemplo, &#34;chr&#40;65&#41;&#34; es &#34;A&#34; tanto en ASCII como en
            Unicode, y chr&#40;0x263a&#41; es una cara sonriente en Unicode.




Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1214482" href="/Public/Bug/Display.html?id=80527#txn-1214482">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;20&nbsp;11:27:13&nbsp;2013</span>
    <span class="description">mrallen1 [...] yahoo.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1214483" href="/Public/Bug/Display.html?id=80527#txn-1214483">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;20&nbsp;11:27:13&nbsp;2013</span>
    <span class="description">mrallen1 [...] yahoo.com -  Fixed in 3.20 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1323173" href="/Public/Bug/Display.html?id=80527#txn-1323173">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;06&nbsp;08:05:22&nbsp;2014</span>
    <span class="description">explorer [...] joaquinferrero.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #80527] perldoc cannot find functions sections when is called with -L switch</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 06 Feb 2014 14:03:48 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Pod-Perldoc [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Joaquín Ferrero &lt;explorer [...] joaquinferrero.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1323173/701759/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/701759">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">El 29/01/13 04:49, Mark Allen via RT escribió:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=80527">https://rt.cpan.org/Ticket/Display.html?id=80527</a></span> &gt;
&gt;
&gt; On Wed Oct 31 11:44:36 2012, explorer@joaquinferrero.com wrote:
<div class="message-stanza open">&gt;&gt; When perldoc is called using the &#39;-L XX&#39; and &#39;-f&#39; switches, it
&gt;&gt; cannot find the corresponding section of the requested function
&gt;&gt; if the string returned by POD2::XX::search_perlfunc_re&#40;&#41; &#40;i.e.
&gt;&gt; the string that marks the beginning of the section in
&gt;&gt; perlfunc.pod that contains the descriptions of the functions
&gt;&gt; available&#41; is not encoded as iso-8859-1.
&gt;&gt;
&gt;&gt;         perldoc -L ES perlfunc
&gt;&gt;
&gt;&gt;      works, but
&gt;&gt;
&gt;&gt;         perldoc -L ES -f chr
&gt;&gt;
&gt;&gt;      returns the following error message:
&gt;&gt;
&gt;&gt;     No documentation for perl function &#39;chr&#39; found
&gt;&gt;
&gt;&gt; Interum solution: search_perlfunc_re&#40;&#41; should return an
&gt;&gt; iso-8859-1-encoded string fully &#40;or partially&#41; matching the same
&gt;&gt; string that should appear in perlfunc.pod.
&gt;&gt;
&gt;&gt; Proposed solution: The search process of the string returned by
&gt;&gt; search_perlfunc_re&#40;&#41; should consider the encoding used for
&gt;&gt; perlfunc.pod.
&gt;&gt;
&gt;&gt; In POD2::ES all the docs are UTF-8-encoded. As a temporary
&gt;&gt; solution, we have fixed this issue by removing characters with
&gt;&gt; diacritic marks:
&gt;&gt;
&gt;&gt;      sub search_perlfunc_re {
&gt;&gt;          return &#39;Lista de funciones de Perl en orden&#39;;
&gt;&gt;      }
&gt;&gt;
&gt;&gt;      &#40;removed ‘alfabético’&#41;
</div>&gt;
&gt; There&#39;s no easy way to tell what encoding a given file is in reliably,
&gt; so I am wondering if we should have a callback function in POD2::XX like
&gt; search_perlfunc_re_encoding&#40;&#41; which returns a string scalar like
&gt; &#34;latin1&#34; or &#34;utf8&#34; or whatever is appropriate.
&gt;
&gt; What do you think about that?
&gt;
&gt; Thanks.
&gt;
&gt; Mark
&gt;
&gt;
&gt;
</div>
Yes, it&#39;s true.

The Spanish PerlDoc team suggested to change all original English pod documentation to utf8 encoding, but this proposal was not approved. The Spanish version are all  utf8 encoded. Other language translation will be.

In this moment, 31 of 169 English pods have the encoding line :&#41;


The best part for this problem is that known that encoding of pod documents is easy: all pod are ISO-8859-1, unless the pod have a =encoding tag, showing the encoding.

The problem now is to make a regex compatible with these encoding, so perldoc can find the start of list of functions in perlfunc.

The search_perlfunc_re_encoding&#40;&#41; function would read the first lines of perlfunc.pod and show the encoding, but perldoc can make this operation, also.


Other solution:
1&#41; edit perlfunc.pod, and at line
2&#41; remove all the code about


I will talk with the Spanish PerlDoc team, and we will send you another email.

Best Regards,

JF^D


-- 
Enviado desde mi teléfono con K-9 Mail.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1323173/701760/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/701760">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.547972</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
