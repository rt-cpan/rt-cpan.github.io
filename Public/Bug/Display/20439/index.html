<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #20439 for Perl-Critic: Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #20439 for Perl-Critic: Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Critic/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/Perl-Critic/Perl-Critic/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Critic">Perl-Critic CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">20439</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Critic/Active/">Perl-Critic</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
adamk [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-25198-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-25199-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.104    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;13&nbsp;02:41:00&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ideally, if a file/module has a version, it should be completely static.

$VERSION = &#39;1.23&#39;;

and so on.

Worse than this is using something based on CVS of SVN versions.

$VERSION = &#34;somestring&#34; =~ /....&#40;....&#41;/;

This ties the code to a single repository, if any author ever tries to
check in a copy of your code, all the versions go haywire.

Even worse AGAIN are people that use versions that are not taint-safe.

For example.

use version; $VERSION = qv&#40;1.2.3&#41;;

Or worse again

use Some::Module; $VERSION = $Some::Module::VERSION;

These are hideously evil, and cause all sorts of problems.

So I propose two policies.

Firstly, ProhibitTaintedVersion, which requires the $VERSION declaration
 line contains a single statement, and that this statement doesn&#39;t have
an use calls, variables, or anything else that might be untaint-safe.

This needs to be at the strongest possible setting, as it creates all
sorts of problems.

And a second ProhibitDynamicVersion, which requires that versions are
simple $VERSION = &#39;...&#39; things, that will always be the same on every
installation, and in every repository, for every author.

This is bad, but not so urgent... one or two notches back from the
maximum would be fine.

Adam K
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;13&nbsp;10:57:54&nbsp;2006</span>
    <span class="description">chris [...] chrisdolan.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20439] Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 13 Jul 2006 09:56:11 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chris Dolan &lt;chris [...] chrisdolan.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Jul 13, 2006, at 1:41 AM, Guest via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ...
&gt; So I propose two policies.
&gt;
&gt; Firstly, ProhibitTaintedVersion, which requires the $VERSION  
&gt; declaration
&gt;  line contains a single statement, and that this statement doesn&#39;t  
&gt; have
&gt; an use calls, variables, or anything else that might be untaint-safe.
&gt;
&gt; This needs to be at the strongest possible setting, as it creates all
&gt; sorts of problems.
&gt;
&gt; And a second ProhibitDynamicVersion, which requires that versions are
&gt; simple $VERSION = &#39;...&#39; things, that will always be the same on every
&gt; installation, and in every repository, for every author.
&gt;
&gt; This is bad, but not so urgent... one or two notches back from the
&gt; maximum would be fine.
&gt;
&gt; Adam K
</div>
Adam,

Thanks.  I&#39;ve added variations of these to the TODO list as  
&#34;VariablesAndExpressions::RequireConstantVersion&#34; and  
&#34;VariablesAndExpressions::ProhibitComplexVersion&#34; &#40;although one could  
argue that they belong in the P::C::P::Modules:: namespace&#41;.  I agree  
with your distaste for dynamic $VERSION but I disagree with your  
recommendations for severity.  Our plan is to reserve highest  
severity for non-controversial policies &#40;i.e. ones that everyone  
agrees should be enforced&#41;.  I think your proposed policies are not  
going to be appreciated by all, so I&#39;ve recommended lower severities  
in the TODO list.

Chris

--
Chris Dolan, Software Developer, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/">http://www.chrisdolan.net/</a></span>
Public key: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/public.key">http://www.chrisdolan.net/public.key</a></span>
vCard: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/ChrisDolan.vcf">http://www.chrisdolan.net/ChrisDolan.vcf</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;13&nbsp;10:57:56&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;13&nbsp;11:12:08&nbsp;2006</span>
    <span class="description">adam [...] phase-n.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20439] Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Jul 2006 01:08:49 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adam [...] phase-n.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Chris: There&#39;s two seperate issues. I&#39;m willing to let you do whatever 
you want for severity with the regex/non-strict on, but the case where 
anything trying to find the version has to execute it as code is 
extremely dangerous.

For starters, it means you can Denial of Service any system that uses 
the interpreter to find the version.

while &#40; 1 &#41; { $_++ } our $VERSION = &#39;0.01&#39;;

or

use Nuclear::Weapon; our $VERSION = fire&#40;&#39;1.2.3&#39;&#41;;

This includes things like PAUSE.

Or slightly less bad, the version becomes unstable.

There are real world examples on #perl from the last month or so where a 
module is reporting the wrong version because it loaded some other 
module that had been updated, but it hadn&#39;t.

This, obviously produced a large dose of confusion.

Realising this, POE is switching from repository/regex to static on the 
next release &#40;I believe from Rocco&#41; and SVK is moving from dynamic 
$VERSION = $Other::Module::VERSION to static versions, because they&#39;ve 
had similar problems with modules reporting wrongly.

It&#39;s your software and your call, but for the case where the version 
line loads in or runs arbitrary code, this is seriously nasty stuff, and 
a ton of people that try it end up being bitten.

Adam K

Chris Dolan via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20439">http://rt.cpan.org/Ticket/Display.html?id=20439</a></span> &gt;
&gt; 
&gt; On Jul 13, 2006, at 1:41 AM, Guest via RT wrote:
&gt; 
<div class="message-stanza open">&gt;&gt; ...
&gt;&gt; So I propose two policies.
&gt;&gt;
&gt;&gt; Firstly, ProhibitTaintedVersion, which requires the $VERSION  
&gt;&gt; declaration
&gt;&gt;  line contains a single statement, and that this statement doesn&#39;t  
&gt;&gt; have
&gt;&gt; an use calls, variables, or anything else that might be untaint-safe.
&gt;&gt;
&gt;&gt; This needs to be at the strongest possible setting, as it creates all
&gt;&gt; sorts of problems.
&gt;&gt;
&gt;&gt; And a second ProhibitDynamicVersion, which requires that versions are
&gt;&gt; simple $VERSION = &#39;...&#39; things, that will always be the same on every
&gt;&gt; installation, and in every repository, for every author.
&gt;&gt;
&gt;&gt; This is bad, but not so urgent... one or two notches back from the
&gt;&gt; maximum would be fine.
&gt;&gt;
&gt;&gt; Adam K
</div>&gt; 
&gt; Adam,
&gt; 
&gt; Thanks.  I&#39;ve added variations of these to the TODO list as  
&gt; &#34;VariablesAndExpressions::RequireConstantVersion&#34; and  
&gt; &#34;VariablesAndExpressions::ProhibitComplexVersion&#34; &#40;although one could  
&gt; argue that they belong in the P::C::P::Modules:: namespace&#41;.  I agree  
&gt; with your distaste for dynamic $VERSION but I disagree with your  
&gt; recommendations for severity.  Our plan is to reserve highest  
&gt; severity for non-controversial policies &#40;i.e. ones that everyone  
&gt; agrees should be enforced&#41;.  I think your proposed policies are not  
&gt; going to be appreciated by all, so I&#39;ve recommended lower severities  
&gt; in the TODO list.
&gt; 
&gt; Chris
&gt; 
&gt; --
&gt; Chris Dolan, Software Developer, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/">http://www.chrisdolan.net/</a></span>
&gt; Public key: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/public.key">http://www.chrisdolan.net/public.key</a></span>
&gt; vCard: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/ChrisDolan.vcf">http://www.chrisdolan.net/ChrisDolan.vcf</a></span>
&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;13&nbsp;12:03:47&nbsp;2006</span>
    <span class="description">chris [...] chrisdolan.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20439] Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 13 Jul 2006 11:02:17 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chris Dolan &lt;chris [...] chrisdolan.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Adam,

OK, I might be coming around to agree with you on severity.

For the record, I totally agree with you on the danger and  
inappropriateness of non-constant version numbers.  I&#39;ve advocated  
similarly to what you are saying in the past.

What I&#39;m was reacting to is pissing off our user base.  We&#39;ve tried  
to use $SEVERITY_HIGHEST only for policies that we&#39;re sure nobody  
will want to turn off.  My intuition says that the &#34;&#40;$VERSION&#41; = q 
$REVISION: 38$ =~ /&#40;\d+&#41;/&#34; idiom is so ingrained that people will  
balk at a policy to outlaw that.  But maybe I&#39;m wrong?

If any other P::C developers have input, it would be welcome.

Chris

On Jul 13, 2006, at 10:12 AM, adam@phase-n.com via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;        Queue: Perl-Critic
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20439">http://rt.cpan.org/Ticket/Display.html?id=20439</a></span> &gt;
&gt;
&gt; Chris: There&#39;s two seperate issues. I&#39;m willing to let you do whatever
&gt; you want for severity with the regex/non-strict on, but the case where
&gt; anything trying to find the version has to execute it as code is
&gt; extremely dangerous.
&gt;
&gt; For starters, it means you can Denial of Service any system that uses
&gt; the interpreter to find the version.
&gt;
&gt; while &#40; 1 &#41; { $_++ } our $VERSION = &#39;0.01&#39;;
&gt;
&gt; or
&gt;
&gt; use Nuclear::Weapon; our $VERSION = fire&#40;&#39;1.2.3&#39;&#41;;
&gt;
&gt; This includes things like PAUSE.
&gt;
&gt; Or slightly less bad, the version becomes unstable.
&gt;
&gt; There are real world examples on #perl from the last month or so  
&gt; where a
&gt; module is reporting the wrong version because it loaded some other
&gt; module that had been updated, but it hadn&#39;t.
&gt;
&gt; This, obviously produced a large dose of confusion.
&gt;
&gt; Realising this, POE is switching from repository/regex to static on  
&gt; the
&gt; next release &#40;I believe from Rocco&#41; and SVK is moving from dynamic
&gt; $VERSION = $Other::Module::VERSION to static versions, because they&#39;ve
&gt; had similar problems with modules reporting wrongly.
&gt;
&gt; It&#39;s your software and your call, but for the case where the version
&gt; line loads in or runs arbitrary code, this is seriously nasty  
&gt; stuff, and
&gt; a ton of people that try it end up being bitten.
&gt;
&gt; Adam K
&gt;
&gt; Chris Dolan via RT wrote:
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20439">http://rt.cpan.org/Ticket/Display.html?id=20439</a></span> &gt;
&gt;&gt;
&gt;&gt; On Jul 13, 2006, at 1:41 AM, Guest via RT wrote:
&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt; ...
&gt;&gt;&gt; So I propose two policies.
&gt;&gt;&gt;
&gt;&gt;&gt; Firstly, ProhibitTaintedVersion, which requires the $VERSION
&gt;&gt;&gt; declaration
&gt;&gt;&gt;  line contains a single statement, and that this statement doesn&#39;t
&gt;&gt;&gt; have
&gt;&gt;&gt; an use calls, variables, or anything else that might be untaint- 
&gt;&gt;&gt; safe.
&gt;&gt;&gt;
&gt;&gt;&gt; This needs to be at the strongest possible setting, as it creates  
&gt;&gt;&gt; all
&gt;&gt;&gt; sorts of problems.
&gt;&gt;&gt;
&gt;&gt;&gt; And a second ProhibitDynamicVersion, which requires that versions  
&gt;&gt;&gt; are
&gt;&gt;&gt; simple $VERSION = &#39;...&#39; things, that will always be the same on  
&gt;&gt;&gt; every
&gt;&gt;&gt; installation, and in every repository, for every author.
&gt;&gt;&gt;
&gt;&gt;&gt; This is bad, but not so urgent... one or two notches back from the
&gt;&gt;&gt; maximum would be fine.
&gt;&gt;&gt;
&gt;&gt;&gt; Adam K
</div>&gt;&gt;
&gt;&gt; Adam,
&gt;&gt;
&gt;&gt; Thanks.  I&#39;ve added variations of these to the TODO list as
&gt;&gt; &#34;VariablesAndExpressions::RequireConstantVersion&#34; and
&gt;&gt; &#34;VariablesAndExpressions::ProhibitComplexVersion&#34; &#40;although one could
&gt;&gt; argue that they belong in the P::C::P::Modules:: namespace&#41;.  I agree
&gt;&gt; with your distaste for dynamic $VERSION but I disagree with your
&gt;&gt; recommendations for severity.  Our plan is to reserve highest
&gt;&gt; severity for non-controversial policies &#40;i.e. ones that everyone
&gt;&gt; agrees should be enforced&#41;.  I think your proposed policies are not
&gt;&gt; going to be appreciated by all, so I&#39;ve recommended lower severities
&gt;&gt; in the TODO list.
&gt;&gt;
&gt;&gt; Chris
&gt;&gt;
&gt;&gt; --
&gt;&gt; Chris Dolan, Software Developer, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/">http://www.chrisdolan.net/</a></span>
&gt;&gt; Public key: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/public.key">http://www.chrisdolan.net/public.key</a></span>
&gt;&gt; vCard: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/ChrisDolan.vcf">http://www.chrisdolan.net/ChrisDolan.vcf</a></span>
&gt;&gt;
&gt;&gt;
&gt;&gt;
</div>&gt;
&gt;
</div>
--
Chris Dolan, Software Developer, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/">http://www.chrisdolan.net/</a></span>
Public key: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/public.key">http://www.chrisdolan.net/public.key</a></span>
vCard: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/ChrisDolan.vcf">http://www.chrisdolan.net/ChrisDolan.vcf</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;13&nbsp;12:16:53&nbsp;2006</span>
    <span class="description">adam [...] phase-n.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20439] Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Jul 2006 02:15:17 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adam [...] phase-n.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ah, ok.

Sorry. There&#39;s two cases here.

&#40;$VERSION&#41; = q$REVISION: 38$ =~ /&#40;\d+&#41;/

That is NOT a severity 5. It&#39;s possibly a 4, and certainly no less than 3.

As you see, it IS taint-safe, and it doesn&#39;t call out of the file.

It is a concern from a DoS point of view but it&#39;s ONLY a concern over 
time and the security concerns are mostly theoretical &#40;we haven&#39;t seen 
examples of this in the wild, ever&#41;. And I agree that current convention 
in this regard currently means that the user-base isn&#39;t going to like 
it, and so all up it doesn&#39;t warrant a 5.

use Module; $VERSION = $Module::VERSION.

THAT is a severity 5.

Anything that has to call out to another file or load in other modules 
is the really severe problem. It breaks all sorts of things, from the 
PAUSE indexer to various tools. It&#39;s pure evil.

The only controvertial one is going to be that this also includes.

use version; $VERSION = qv&#40;1.2.3&#41;;

Calling that a 5 in direct conflict with PBP is tricky politically.

I&#39;d be willing to accept that you make a special case of version, and 
downrate it to 2 or 3.

But ANYTHING other than version.pm is absolutely a 5.

Adam K

Chris Dolan via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20439">http://rt.cpan.org/Ticket/Display.html?id=20439</a></span> &gt;
&gt; 
&gt; Adam,
&gt; 
&gt; OK, I might be coming around to agree with you on severity.
&gt; 
&gt; For the record, I totally agree with you on the danger and  
&gt; inappropriateness of non-constant version numbers.  I&#39;ve advocated  
&gt; similarly to what you are saying in the past.
&gt; 
&gt; What I&#39;m was reacting to is pissing off our user base.  We&#39;ve tried  
&gt; to use $SEVERITY_HIGHEST only for policies that we&#39;re sure nobody  
&gt; will want to turn off.  My intuition says that the &#34;&#40;$VERSION&#41; = q 
&gt; $REVISION: 38$ =~ /&#40;\d+&#41;/&#34; idiom is so ingrained that people will  
&gt; balk at a policy to outlaw that.  But maybe I&#39;m wrong?
&gt; 
&gt; If any other P::C developers have input, it would be welcome.
&gt; 
&gt; Chris
&gt; 
&gt; On Jul 13, 2006, at 10:12 AM, adam@phase-n.com via RT wrote:
&gt; 
<div class="message-stanza open">&gt;&gt;        Queue: Perl-Critic
&gt;&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20439">http://rt.cpan.org/Ticket/Display.html?id=20439</a></span> &gt;
&gt;&gt;
&gt;&gt; Chris: There&#39;s two seperate issues. I&#39;m willing to let you do whatever
&gt;&gt; you want for severity with the regex/non-strict on, but the case where
&gt;&gt; anything trying to find the version has to execute it as code is
&gt;&gt; extremely dangerous.
&gt;&gt;
&gt;&gt; For starters, it means you can Denial of Service any system that uses
&gt;&gt; the interpreter to find the version.
&gt;&gt;
&gt;&gt; while &#40; 1 &#41; { $_++ } our $VERSION = &#39;0.01&#39;;
&gt;&gt;
&gt;&gt; or
&gt;&gt;
&gt;&gt; use Nuclear::Weapon; our $VERSION = fire&#40;&#39;1.2.3&#39;&#41;;
&gt;&gt;
&gt;&gt; This includes things like PAUSE.
&gt;&gt;
&gt;&gt; Or slightly less bad, the version becomes unstable.
&gt;&gt;
&gt;&gt; There are real world examples on #perl from the last month or so  
&gt;&gt; where a
&gt;&gt; module is reporting the wrong version because it loaded some other
&gt;&gt; module that had been updated, but it hadn&#39;t.
&gt;&gt;
&gt;&gt; This, obviously produced a large dose of confusion.
&gt;&gt;
&gt;&gt; Realising this, POE is switching from repository/regex to static on  
&gt;&gt; the
&gt;&gt; next release &#40;I believe from Rocco&#41; and SVK is moving from dynamic
&gt;&gt; $VERSION = $Other::Module::VERSION to static versions, because they&#39;ve
&gt;&gt; had similar problems with modules reporting wrongly.
&gt;&gt;
&gt;&gt; It&#39;s your software and your call, but for the case where the version
&gt;&gt; line loads in or runs arbitrary code, this is seriously nasty  
&gt;&gt; stuff, and
&gt;&gt; a ton of people that try it end up being bitten.
&gt;&gt;
&gt;&gt; Adam K
&gt;&gt;
&gt;&gt; Chris Dolan via RT wrote:
<div class="message-stanza open">&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20439">http://rt.cpan.org/Ticket/Display.html?id=20439</a></span> &gt;
&gt;&gt;&gt;
&gt;&gt;&gt; On Jul 13, 2006, at 1:41 AM, Guest via RT wrote:
&gt;&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt;&gt; ...
&gt;&gt;&gt;&gt; So I propose two policies.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Firstly, ProhibitTaintedVersion, which requires the $VERSION
&gt;&gt;&gt;&gt; declaration
&gt;&gt;&gt;&gt;  line contains a single statement, and that this statement doesn&#39;t
&gt;&gt;&gt;&gt; have
&gt;&gt;&gt;&gt; an use calls, variables, or anything else that might be untaint- 
&gt;&gt;&gt;&gt; safe.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This needs to be at the strongest possible setting, as it creates  
&gt;&gt;&gt;&gt; all
&gt;&gt;&gt;&gt; sorts of problems.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; And a second ProhibitDynamicVersion, which requires that versions  
&gt;&gt;&gt;&gt; are
&gt;&gt;&gt;&gt; simple $VERSION = &#39;...&#39; things, that will always be the same on  
&gt;&gt;&gt;&gt; every
&gt;&gt;&gt;&gt; installation, and in every repository, for every author.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This is bad, but not so urgent... one or two notches back from the
&gt;&gt;&gt;&gt; maximum would be fine.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Adam K
</div>&gt;&gt;&gt; Adam,
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks.  I&#39;ve added variations of these to the TODO list as
&gt;&gt;&gt; &#34;VariablesAndExpressions::RequireConstantVersion&#34; and
&gt;&gt;&gt; &#34;VariablesAndExpressions::ProhibitComplexVersion&#34; &#40;although one could
&gt;&gt;&gt; argue that they belong in the P::C::P::Modules:: namespace&#41;.  I agree
&gt;&gt;&gt; with your distaste for dynamic $VERSION but I disagree with your
&gt;&gt;&gt; recommendations for severity.  Our plan is to reserve highest
&gt;&gt;&gt; severity for non-controversial policies &#40;i.e. ones that everyone
&gt;&gt;&gt; agrees should be enforced&#41;.  I think your proposed policies are not
&gt;&gt;&gt; going to be appreciated by all, so I&#39;ve recommended lower severities
&gt;&gt;&gt; in the TODO list.
&gt;&gt;&gt;
&gt;&gt;&gt; Chris
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Chris Dolan, Software Developer, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/">http://www.chrisdolan.net/</a></span>
&gt;&gt;&gt; Public key: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/public.key">http://www.chrisdolan.net/public.key</a></span>
&gt;&gt;&gt; vCard: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/ChrisDolan.vcf">http://www.chrisdolan.net/ChrisDolan.vcf</a></span>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
</div>&gt;&gt;
</div>&gt; 
&gt; --
&gt; Chris Dolan, Software Developer, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/">http://www.chrisdolan.net/</a></span>
&gt; Public key: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/public.key">http://www.chrisdolan.net/public.key</a></span>
&gt; vCard: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrisdolan.net/ChrisDolan.vcf">http://www.chrisdolan.net/ChrisDolan.vcf</a></span>
&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;14&nbsp;16:54:57&nbsp;2006</span>
    <span class="description">thaljef [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Maybe we could distribute this separately in a policy bundle that is
aimed at CPAN authors.  Or since you mentioned taintedness and
denial-of-service, it could fit into the Perl-Critic-Security bundle
that I&#39;ve been thinking about.  

-Jeff
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;14&nbsp;21:11:42&nbsp;2006</span>
    <span class="description">adam [...] phase-n.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20439] Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 15 Jul 2006 11:11:00 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adam [...] phase-n.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sounds appropriate.

I&#39;d actually been pondering the ideas of profiles as well, there&#39;s going 
to be a variety of things that are useful for things like security and 
backcompatibility.

This would fit in well to both, and anything for CPAN authors would 
necesarily contain both.

Adam K


Jeffrey Thalhammer via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20439">http://rt.cpan.org/Ticket/Display.html?id=20439</a></span> &gt;
&gt; 
&gt; Maybe we could distribute this separately in a policy bundle that is
&gt; aimed at CPAN authors.  Or since you mentioned taintedness and
&gt; denial-of-service, it could fit into the Perl-Critic-Security bundle
&gt; that I&#39;ve been thinking about.  
&gt; 
&gt; -Jeff
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;25&nbsp;22:06:32&nbsp;2009</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Proposed implementation committed &#40;to core Perl::Critic&#41; as SVN revision
3247.

I think it is fairly clear what
ValuesAndExpressions::RequireConstantVersion should do, but when
ForbidTaintedVersion transmogrified into ForbidComplexVersion things got
a little vague. At the moment ForbidComplexVersion implements more or
less what Adam K. asked for in ForbidTaintedVersion - but with an
explicit check for fully-qualified symbol names, since the wild appears
to contain tainted versions that do not include the source modules on
the same line.

Tom Wyant
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;26&nbsp;11:15:38&nbsp;2009</span>
    <span class="description">EDAVIS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Let&#39;s be clear: the denial-of-service vulnerability is in the code that
executes the VERSION line.  The interesting VERSION lines mentioned are
exploits for that vulnerability; they are not the bug itself.

&#40;In fact, it&#39;s worse than DoS; it is an arbitrary code execution bug.  I
have written such dodgy code myself, see
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://membled.com/work/perl/pmq/">http://membled.com/work/perl/pmq/</a></span>&gt;, mitigated slightly by the fact that
it scans only modules you&#39;ve already installed in your search path.&#41;

If all code conformed to a policy &#39;VERSION should be a simple static
expression&#39; then there would be no need to eval&#40;&#41; a line of code and the
world would be a more pleasant place for indexers and query tools.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;25&nbsp;23:41:52&nbsp;2009</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20439] Policy Idea: Prohibiting Dynamic or &#40;worse&#41; Tainted Versions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Aug 2009 22:41:31 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">ValuesAndExpressions::ProhibitComplexVersion and ValuesAndExpressions::RequireConstantVersion were released in v1.104.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;25&nbsp;23:45:19&nbsp;2009</span>
    <span class="description">ELLIOTJS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;25&nbsp;23:45:20&nbsp;2009</span>
    <span class="description">ELLIOTJS [...] cpan.org -  Fixed in 1.104 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
