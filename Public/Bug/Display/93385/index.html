<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #93385 for Glib-Object-Introspection: [Win32] Test libraries fail to build</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #93385 for Glib-Object-Introspection: [Win32] Test libraries fail to build</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Glib-Object-Introspection/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Glib-Object-Introspection/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Glib-Object-Introspection/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Glib-Object-Introspection/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Glib-Object-Introspection">Glib-Object-Introspection CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">93385</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Glib-Object-Introspection/Active/">Glib-Object-Introspection</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
sisyphus [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-239810-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.020    </td>
  </tr>
  <tr id="CF-239811-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;26&nbsp;07:30:06&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [Win32] Test libraries fail to build</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Windows, it seems that the intention is to use python &#40;Python-2.7, in my case&#41; to build the test libraries. For Windows, the Makefile.PL has:

############
foreach my $base &#40;map { File::Spec-&gt;catfile &#40;$_, &#39;g-ir-scanner&#39;&#41; } @path&#41; {
  if &#40;-f $base&#41; {
    $gir_cmd = qq&#40;python $base&#41;;
    $found = 1;
    last;
 }
}
############

The first problem is that I have no file named &#39;g-ir-scanner&#39;. I do have a file named &#39;g-ir-scanner.py&#39; &#40;in C:/usr/local/bin&#41;. It shipped with the glib/gobject-introspection binaries against which I&#39;m building G::O::I-0.020. Assuming that&#39;s the file we&#39;re looking for, I&#39;ve modified the filename given in the above snippet to include the &#39;.py&#39; extension.

The file then gets found, and the python command is executed. Changing $pipe &#40;in the Makefile.PL&#41; to the empty string allows me to see that the python command creates an error:

############
Trying to build test libraries... Traceback &#40;most recent call last&#41;:
  File &#34;C:\usr\local\bin\g-ir-scanner.py&#34;, line 43, in &lt;module&gt;
    from giscanner.scannermain import scanner_main
ImportError: No module named giscanner.scannermain
not OK
############

Where to from here ?

The module does build, but then all of the tests are skipped because there are no test libraries.

After installing the G::O::I-0.020, I find it loads ok ... but I&#39;d like to see some tests passing as I&#39;m a little sceptical about the usability of the built module.
For one thing, during &#39;dmake install&#39;, I see no mention of any typelibs being installed - yet the documentation suggests that the typelibs &#40;which exist in C:/usr/local/lib/girepository-1.0&#41; should be installed by the module.

I&#39;m running mingw.org&#39;s port of &#40;32-bit&#41; gcc-4.7.0, and perl-5.16.0 built using that gcc compiler.

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;26&nbsp;08:00:44&nbsp;2014</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93385] [Win32] Test libraries fail to build</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Feb 2014 14:00:33 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Glib-Object-Introspection [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Torsten Schönfeld&#34; &lt;kaffeetisch [...] gmx.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Sisyphus via RT&#34; &lt;bug-Glib-Object-Introspection@rt.cpan.org&gt;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The first problem is that I have no file named &#39;g-ir-scanner&#39;. I do have a file named &#39;g-ir-scanner.py&#39; &#40;in C:/usr/local/bin&#41;. It shipped with the glib/gobject-introspection binaries against which I&#39;m building G::O::I-0.020. Assuming that&#39;s the file we&#39;re looking for, I&#39;ve modified the filename given in the above snippet to include the &#39;.py&#39; extension.
</div>
Yes, that&#39;s probably the correct file.  We&#39;d have to make Makefile.PL search for both variants, then.  Patches welcome.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ############
&gt; Trying to build test libraries... Traceback &#40;most recent call last&#41;:
&gt;   File &#34;C:\usr\local\bin\g-ir-scanner.py&#34;, line 43, in &lt;module&gt;
&gt;     from giscanner.scannermain import scanner_main
&gt; ImportError: No module named giscanner.scannermain
&gt; not OK
&gt; ############
&gt; 
&gt; Where to from here ?
</div>
Are you sure that your installation of gobject-introspection is complete?  Is there maybe an associated &#34;development&#34; package that you don&#39;t have yet?  Is Makefile.PL using the same Python interpreter that gobject-introspection is referring to?  On my system, the file corresponding to the failing import is at /usr/lib64/gobject-introspection/giscanner/scannermain.py.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; For one thing, during &#39;dmake install&#39;, I see no mention of any typelibs being installed - yet the documentation suggests that the typelibs &#40;which exist in C:/usr/local/lib/girepository-1.0&#41; should be installed by the module.
</div>
No, the Perl bindings don&#39;t install any typelibs.  What part of the docs gave you that impression?  Introspectable libraries are supposed to install their typelibs themselves.

To test things manually, try to use one of the typelibs that you have installed.  For example, if you have Gio-2.0.typelib:

  use Glib::Object::Introspection;
  Glib::Object::Introspection-&gt;setup&#40;
    basename =&gt; &#39;Gio&#39;,
    version =&gt; &#39;2.0&#39;,
    package =&gt; &#39;Glib::IO&#39;&#41;;

  my $loop = Glib::MainLoop-&gt;new &#40;&#41;;

  my $file = Glib::IO::File::new_for_path &#40;$0&#41;;
  $file-&gt;query_info_async &#40;&#39;*&#39;, [], 0, undef, \&#38;info&#41;;
  sub info {
    my &#40;$file, $res&#41; = @_;

    my $info = $file-&gt;query_info_finish &#40;$res&#41;;
    warn $info-&gt;get_name &#40;&#41;;
    warn $info-&gt;get_size &#40;&#41;;

    $loop-&gt;quit &#40;&#41;;
  }

  $loop-&gt;run &#40;&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;26&nbsp;08:00:44&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;01:08:37&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93385] [Win32] Test libraries fail to build</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Feb 2014 17:07:40 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Glib-Object-Introspection [...] rt.cpan.org&gt;, &lt;sisyphus [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Torsten Schoenfeld via RT

<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; Where to from here ?
</div></div>
<div class="message-stanza open">&gt; Are you sure that your installation of gobject-introspection is complete?
</div>
I *think* it will prove to be complete ... no guarantees about that yet,
however.

<div class="message-stanza open">&gt; Is there maybe an associated &#34;development&#34; package that you don&#39;t have
&gt; yet?
</div>
This looks like a full devel package to me. It&#39;s at:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/tomnotcat/glib-win32/archive/master.zip">https://github.com/tomnotcat/glib-win32/archive/master.zip</a></span>

<div class="message-stanza open">&gt; Is Makefile.PL using the same Python interpreter that
&gt; gobject-introspection is referring to?
</div>
No. The only Python 27 I have is one that I installed independently.

<div class="message-stanza open">&gt; On my system, the file corresponding to the failing import is at
&gt; /usr/lib64/gobject-introspection/giscanner/scannermain.py.
</div>
The binaries that I have contain scannermain.py in the
C:\usr\local\python27\Lib\giscanner directory.
It occurs to me that the Python27 I&#39;m using won&#39;t know anything about that
location. How does one remedy that ?

<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; For one thing, during &#39;dmake install&#39;, I see no mention of any typelibs
&gt;&gt; being installed - yet the documentation suggests that the typelibs &#40;which
&gt;&gt; exist in C:/usr/local/lib/girepository-1.0&#41; should be installed by the
&gt;&gt; module.
</div></div>
<div class="message-stanza open">&gt; No, the Perl bindings don&#39;t install any typelibs.  What part of the docs
&gt; gave you that impression?  Introspectable libraries are supposed to
&gt; install their typelibs themselves.
</div>
I was looking at this piece of documentation near the beginning of the docs:

############################
DESCRIPTION
  &#34;Glib::Object::Introspection-&gt;setup&#34;
    To allow Glib::Object::Introspection to create bindings for a library,
    it must have installed a typelib file, for example
    &#34;$prefix/lib/girepository-1.0/Gtk-3.0.typelib&#34;.
############################

Looks like I might&#39;ve misread what &#34;it&#34; was applying to. &#40;I thought &#34;it&#34; was
Glib::Object::Introspection ....&#41;

<div class="message-stanza open">&gt; To test things manually, try to use one of the typelibs that you have
&gt; installed.  For example, if you have Gio-2.0.typelib:
&gt;
&gt;  use Glib::Object::Introspection;
&gt;  Glib::Object::Introspection-&gt;setup&#40;
&gt;    basename =&gt; &#39;Gio&#39;,
&gt;    version =&gt; &#39;2.0&#39;,
&gt;    package =&gt; &#39;Glib::IO&#39;&#41;;
&gt;
&gt;  my $loop = Glib::MainLoop-&gt;new &#40;&#41;;
&gt;
&gt;  my $file = Glib::IO::File::new_for_path &#40;$0&#41;;
&gt;  $file-&gt;query_info_async &#40;&#39;*&#39;, [], 0, undef, \&#38;info&#41;;
&gt;  sub info {
&gt;    my &#40;$file, $res&#41; = @_;
&gt;
&gt;    my $info = $file-&gt;query_info_finish &#40;$res&#41;;
&gt;    warn $info-&gt;get_name &#40;&#41;;
&gt;    warn $info-&gt;get_size &#40;&#41;;
&gt;
&gt;    $loop-&gt;quit &#40;&#41;;
&gt;  }
&gt;
&gt;  $loop-&gt;run &#40;&#41;;
</div>
Running that outputs:

##############################
&#40;perl.exe:3040&#41;: Glib-GObject-CRITICAL **: ..\..\..\gobject\gtype.c:2722:
You forgot to call g_type_init&#40;&#41;

&#40;perl.exe:3040&#41;: Glib-CRITICAL **: file ..\..\..\glib\gthread.c: line 713:
assertion `result != 0&#39; failed

&#40;perl.exe:3040&#41;: Glib-GObject-CRITICAL **: file ..\..\..\gobject\gobject.c:
line 1538: assertion `G_TYPE_IS_OBJECT &#40;object_type&#41;&#39; failed

[and then hangs at that point]
##############################

This is essentially the same as what happens when I try to run any of the
Gtk3-0.016 test scripts.

I tried adding the following argument to setup&#40;&#41; in the above demo:
search_path =&gt; &#39;C:/usr/local/lib/girepository-1.0&#39;

but this does not change the error. &#40;Btw C:/usr/local/lib/girepository-1.0 
contains Gio-2.0.typelib, among other typelib files.&#41;

I have tried &#40;and failed&#41; to build the gobject-introspection library 
myself - hence have resorted to binaries created by someone else.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;04:33:24&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93385] [Win32] Test libraries fail to build</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Feb 2014 20:32:26 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Glib-Object-Introspection [...] rt.cpan.org&gt;, &lt;sisyphus [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: sisyphus1@optusnet.com.au

<div class="message-stanza open">&gt; The binaries that I have contain scannermain.py in the
&gt; C:\usr\local\python27\Lib\giscanner directory.
&gt; It occurs to me that the Python27 I&#39;m using won&#39;t know anything about that
&gt; location. How does one remedy that ?
</div>
I copied the gi and giscanner directories from C:\usr\local\python27\Lib to 
my Python27/Lib folder &#40;C:/_32/Python27/Lib&#41; and the requisite py files now 
get found .... and the test libraries now build OK.
But, in the G::O::I test suite, I&#39;m still getting slugged with:

#############################
t/00-basic-types.t ............
&#40;perl.exe:4416&#41;: Glib-GObject-CRITICAL **: ..\..\..\gobject\gtype.c:2722: 
You forgot to call g_type_init&#40;&#41;

&#40;perl.exe:4416&#41;: Glib-CRITICAL **: file ..\..\..\glib\gthread.c: line 713: 
assertion `result != 0&#39; failed

&#40;perl.exe:4416&#41;: Glib-GObject-CRITICAL **: file ..\..\..\gobject\gobject.c: 
line 1538: assertion `G_TYPE_IS_OBJECT &#40;object_type&#41;&#39; failed

[Hang .....]
#############################

Any ideas on that ?
&#40;I&#39;ll see if I can come up with something.&#41;

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;01&nbsp;06:40:23&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93385] [Win32] Test libraries fail to build</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 1 Mar 2014 22:39:19 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Glib-Object-Introspection [...] rt.cpan.org&gt;, &lt;sisyphus [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: sisyphus1@optusnet.com.au

<div class="message-stanza open">&gt; #############################
&gt; t/00-basic-types.t ............
&gt; &#40;perl.exe:4416&#41;: Glib-GObject-CRITICAL **: ..\..\..\gobject\gtype.c:2722: 
&gt; You forgot to call g_type_init&#40;&#41;
&gt;
&gt; &#40;perl.exe:4416&#41;: Glib-CRITICAL **: file ..\..\..\glib\gthread.c: line 713: 
&gt; assertion `result != 0&#39; failed
&gt;
&gt; &#40;perl.exe:4416&#41;: Glib-GObject-CRITICAL **: file 
&gt; ..\..\..\gobject\gobject.c: line 1538: assertion `G_TYPE_IS_OBJECT 
&gt; &#40;object_type&#41;&#39; failed
&gt;
&gt; [Hang .....]
&gt; #############################
</div>
This apparently arises because I&#39;ve built my Glib-1.301 &#40;perl module&#41; 
against a different set of binaries than the ones against which I built 
G::O::I-0.020.
More specifically, I speculate that the problem comes about because my 
Glib-1.301 and G::O::I-0.020 load different &#40;ie separate and distinct&#41; glib 
dynamic libraries &#40;dll&#39;s&#41;.
Certainly, if I rebuild Glib-1.301 against the same binaries as I used for 
G::O::I-0.020, then the problem goes away.

Glib-1.301 loads the glib dll it was built for, and G::O::I-0.020 loads the 
glib dll it was built for - so it&#39;s *not* a case of the wrong dll being 
loaded. Rather, I envisage that the problem arises because one dll receives 
the g_type_init&#40;&#41; call, but the other dll doesn&#39;t see that.

I am, however, left with the problem that the typelib files are not being 
found.
If I run the script that Torsten provided &#40;which I&#39;ve named &#39;try.pl&#39;&#41;, then 
I get:

Typelib file for namespace &#39;Gio&#39;, version &#39;2.0&#39; not found at 
C:/MinGW/perl516/site/lib/Glib/Object/Introspection.pm line 92.

If I provide the correct &#39;search_path&#39; param to setup&#40;&#41;, then the script 
runs correctly, and outputs:

try.pl at try.pl line 17.
563 at try.pl line 18.

I&#39;m still left to wonder how one sets things up on Windows such that these 
typelib files get found *without* having to specify search_path.
Perhaps that will become clearer to me tomorrow .... enough for tonight :-&#41;

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;01&nbsp;23:10:52&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93385] [Win32] Test libraries fail to build</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 2 Mar 2014 15:10:04 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Glib-Object-Introspection [...] rt.cpan.org&gt;, &lt;sisyphus [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: sisyphus1@optusnet.com.au

<div class="message-stanza open">&gt; I am, however, left with the problem that the typelib files are not being 
&gt; found.
</div>
This is fixed with:
set GI_TYPELIB_PATH=C:\usr\local\lib\girepository-1.0

Perhaps the G::O::I documentation could mention this.
&#40;Googling for &#39;glib introspection typelib environment&#39; didn&#39;t help, but 
googling for &#39;introspection typelib environment&#39; did.&#41;

Thanks for the help, Torsten.
You can probably close this bug report if you wish.

Not sure that the assumption that my Glib module would load the same dll as 
G::O::I is valid - because they are separate perl  modules.
&#40;FAIRK, it *is* a valid assumption .... I&#39;m just &#34;not sure&#34; about that, 
that&#39;s all ;-&#41;

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;07&nbsp;11:49:30&nbsp;2014</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93385] [Win32] Test libraries fail to build</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 07 Mar 2014 17:49:21 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Glib-Object-Introspection [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Torsten Schönfeld &lt;kaffeetisch [...] gmx.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;sisyphus1@optusnet.com.au via RT&#34;
&lt;bug-Glib-Object-Introspection@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I was looking at this piece of documentation near the beginning of the docs:
&gt;
&gt; ############################
&gt; DESCRIPTION
&gt;   &#34;Glib::Object::Introspection-&gt;setup&#34;
&gt;     To allow Glib::Object::Introspection to create bindings for a library,
&gt;     it must have installed a typelib file, for example
&gt;     &#34;$prefix/lib/girepository-1.0/Gtk-3.0.typelib&#34;.
&gt; ############################
</div>
Ah, yeah, that&#39;s not entirely clear.  Fixed now in git.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;07&nbsp;11:49:43&nbsp;2014</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93385] [Win32] Test libraries fail to build</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 07 Mar 2014 11:19:02 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Glib-Object-Introspection [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Torsten Schönfeld &lt;kaffeetisch [...] gmx.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;sisyphus1@optusnet.com.au via RT&#34;
&lt;bug-Glib-Object-Introspection@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; I am, however, left with the problem that the typelib files are not being 
&gt;&gt; found.
</div>&gt;
&gt; This is fixed with:
&gt; set GI_TYPELIB_PATH=C:\usr\local\lib\girepository-1.0
&gt;
&gt; Perhaps the G::O::I documentation could mention this.
</div>
Now done in git.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Not sure that the assumption that my Glib module would load the same dll as 
&gt; G::O::I is valid - because they are separate perl  modules.
&gt; &#40;FAIRK, it *is* a valid assumption .... I&#39;m just &#34;not sure&#34; about that, 
&gt; that&#39;s all ;-&#41;
</div>
Not sure I understand you here.  Both, Glib and
Glib::Object::Introspection must be built against and use the same
libglib to avoid problems like the one you encountered.  Perl&#39;s &#40;or
rather, ExtUtils::MakeMaker&#39;s&#41; linker calls should automatically ensure
that the modules use the libglib at runtime that they were linked
against.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;19&nbsp;17:07:13&nbsp;2014</span>
    <span class="description">kaffeetisch [...] gmx.de -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
