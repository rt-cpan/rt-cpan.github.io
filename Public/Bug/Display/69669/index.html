<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #69669 for ExtUtils-MakeMaker: [patch] minimal patch for win paths with spaces</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #69669 for ExtUtils-MakeMaker: [patch] minimal patch for win paths with spaces</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/ExtUtils-MakeMaker">ExtUtils-MakeMaker CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">69669</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/ExtUtils-MakeMaker/Active/">ExtUtils-MakeMaker</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
HEXCODER [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-12494-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
6.58    </td>
  </tr>
  <tr id="CF-12495-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;21&nbsp;13:21:56&nbsp;2011</span>
    <span class="description">HEXCODER [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [patch] minimal patch for win paths with spaces</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When the path to the installed perl has spaces
&#40;eg C:\Program Files\Perl\bin&#41;, perl Makefile.PL 
does not find its perl via find_perl&#40;&#41; in init_PERL&#40;&#41;.
It tries to execute it, but did not quote the path before.

Quoting it like &#34;C:\Program Files\Perl\bin\perl.exe&#34; breaks the 
detection of an absolute pathname in method file_name_is_absolute&#40;&#41; 
later.

So I quoted it like this:
C:\Program&#34; &#34;Files\Perl\bin\perl.exe

Second place to modify was in MM_Unix::constants, where the
definition of CONFIGDEP is done. Both entries need to be quoted
like this:
CONFIGDEP = &#34;$&#40;PERL_ARCHLIB&#41;$&#40;DFSEP&#41;Config.pm&#34; &#34;$&#40;PERL_INC&#41;$&#40;DFSEP&#41;
config.h&#34;
This part is a bit ugly. I needed a quick fix to install modules on my 
box.

With this patch, &#39;perl Makefile.PL&#39; generates a Makefile that runs 
with &#39;nmake&#39; and &#39;nmake install&#39;. For &#39;nmake test&#39; more work is needed.

So it can be a start for people to build on.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> min_patch_for_winpath_with_spaces.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/ExtUtils/MM_Unix.pm.org	2011-07-06 23:17:22.000000000 +0200
+++ lib/ExtUtils/MM_Unix.pm	2011-07-21 18:55:40.227308100 +0200
@@ -444,6 +444,11 @@
 # Where is the Config information that we are using/depend on
 CONFIGDEP = $&#40;PERL_ARCHLIB&#41;$&#40;DFSEP&#41;Config.pm $&#40;PERL_INC&#41;$&#40;DFSEP&#41;config.h
 };
+    # quote possible spaces for Windows
+    if &#40;$Is{Win32} &#38;&#38; 0 &lt;= index $m[-1], &#39; &#39;&#41; {
+        $m[-1] =~ s{\ \$\&#40;}{ &#34;\$&#40;}xmsg;
+        $m[-1] =~ s{\.&#40;[pmh]+&#41;}{.$1&#34;}xmsg;
+    }
 
 
     push @m, qq{
@@ -1033,6 +1038,11 @@
             }
             print &#34;Checking $abs\n&#34; if &#40;$trace &gt;= 2&#41;;
             next unless $self-&gt;maybe_command&#40;$abs&#41;;
+
+            # quote spaces for Windows
+            if &#40;$Is{Win32} &#38;&#38; 0 &lt;= index $abs, &#39; &#39;&#41; {
+                $abs =~ s{\ }{&#34;\ &#34;}xmsg;
+            }
             print &#34;Executing $abs\n&#34; if &#40;$trace &gt;= 2&#41;;
 
             my $version_check = qq{$abs -le &#34;require $ver; print qq{VER_OK}&#34;};
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;21&nbsp;15:07:08&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #69669] [patch] minimal patch for win paths with spaces</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Jul 2011 12:07:01 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is an old, old, old issue with MakeMaker and one that is unlikely to
really ever be fixed.  The best thing to do is to not put your Perl into
&#34;Program Files&#34;, that&#39;s what most Windows Perl installers do.  Otherwise
you&#39;re holding back the tide.

My general policy towards paths with spaces in MakeMaker is YOU&#39;RE DOOMED
because there&#39;s so many places where a space in any path will mess up the
Makefile.  The necessary work to make MakeMaker properly escape paths... well,
you&#39;re better off writing a new build system.  I kinda prefer to leave it
completely and obviously broken.  It may be possible to make it even more
obvious with a warning if it sees that Perl is in a path with spaces.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;21&nbsp;15:07:09&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;21&nbsp;16:38:43&nbsp;2011</span>
    <span class="description">heiko [...] hexco.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #69669] [patch] minimal patch for win paths with spaces</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Jul 2011 22:37:41 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Heiko &lt;heiko [...] hexco.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 21.07.2011 21:07, schrieb Michael G Schwern via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=69669">https://rt.cpan.org/Ticket/Display.html?id=69669</a></span>&gt;
&gt;
&gt; This is an old, old, old issue with MakeMaker and one that is unlikely to
&gt; really ever be fixed.  The best thing to do is to not put your Perl into
&gt; &#34;Program Files&#34;, that&#39;s what most Windows Perl installers do.  Otherwise
&gt; you&#39;re holding back the tide.
&gt;
&gt; My general policy towards paths with spaces in MakeMaker is YOU&#39;RE DOOMED
&gt; because there&#39;s so many places where a space in any path will mess up the
&gt; Makefile.  The necessary work to make MakeMaker properly escape paths... well,
&gt; you&#39;re better off writing a new build system.  I kinda prefer to leave it
&gt; completely and obviously broken.  It may be possible to make it even more
&gt; obvious with a warning if it sees that Perl is in a path with spaces.
&gt;
&gt;
</div>Thanks, but I have no choice &#40;company settings&#41;.
So many CPAN modules rely on it
&#40;and don&#39;t support the alternative Module::Build&#41;,
so I thought there had to be some interest in this!

 From the long history of EUMM, the mentioned
policy has been obvious.
Although, once it is fixed no one will complain, I think.

I wonder, if ActiveState has a set of patches for this.
It must be one of their very common problems.

Thanks and best regards, hexcoder
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;23&nbsp;02:58:41&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #69669] [patch] minimal patch for win paths with spaces</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 22 Jul 2011 23:58:30 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2011.7.21 1:38 PM, Heiko via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks, but I have no choice &#40;company settings&#41;.
&gt;
&gt; So many CPAN modules rely on it
&gt; &#40;and don&#39;t support the alternative Module::Build&#41;,
&gt; so I thought there had to be some interest in this!
</div>
There is interest, but I reckon it would be a lot of work to actually make it
work rather than just limp along.  Nobody has done that work.

Now, I could be wrong.  It might be pretty simple.  I&#39;d very much like to be
proven wrong.  You can take a whack at fixing it for real.  Fork the
repository on Github and give it a go.  Be sure to try out building some XS
modules.  If you can demonstrate that non-trivial modules are building, great!
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/Perl-Toolchain-Gang/ExtUtils-MakeMaker">https://github.com/Perl-Toolchain-Gang/ExtUtils-MakeMaker</a></span>


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; From the long history of EUMM, the mentioned
&gt; policy has been obvious.
&gt; Although, once it is fixed no one will complain, I think.
&gt; 
&gt; I wonder, if ActiveState has a set of patches for this.
&gt; It must be one of their very common problems.
</div>
ActiveState a long time ago switched their installations to C:\Perl.
Strawberry Perl and every Windows Perl install I know of does so as well.  I
would suggest your company do the same.


-- 
package Outer::Space;  use Test::More tests =&gt; 9;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;28&nbsp;12:51:33&nbsp;2014</span>
    <span class="description">ETJ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I claim this is now obsolete since a&#41; duplicate of RT-448; b&#41; hopefully fixed in <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/Perl-Toolchain-Gang/ExtUtils-MakeMaker/pull/105">https://github.com/Perl-Toolchain-Gang/ExtUtils-MakeMaker/pull/105</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;28&nbsp;18:54:17&nbsp;2014</span>
    <span class="description">rt-cpan [...] trout.me.uk -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
