<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #57618 for Language-Farnsworth: Farnsworth array functions</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #57618 for Language-Farnsworth: Farnsworth array functions</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Language-Farnsworth">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Language-Farnsworth">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Language-Farnsworth">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Language-Farnsworth">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Language-Farnsworth">Language-Farnsworth CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">57618</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Language-Farnsworth">Language-Farnsworth</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">simcop [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
farnsworth-bugs [...] googlegroups.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-232522-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-232523-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=57618">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-778892" href="/Public/Bug/Display.html?id=57618#txn-778892">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;18&nbsp;19:22:45&nbsp;2010</span>
    <span class="description">farnsworth-bugs [...] googlegroups.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Farnsworth array functions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 May 2010 00:49:47 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> farnsworth-bugs [...] googlegroups.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ZsbÃ¡n Ambrus &lt;ambrus [...] math.bme.hu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/778892/403414/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/403414">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here are some array functions that might go to the farnsworth standard
library, and examples in comments.

You already have in the library: length map reverse sort reduce min max.

take{n isa 1, a isa []} := { var r = []; var k = 0; var m = n &lt;
length[a] ? n : length[a]; while &#40;k &lt; m&#41; { r@k$ = a@k$; k++; }; r };
//take[19, [3,1,4,1,5,9,2]]];

drop{n isa 1, a isa []} := { var r = []; var m = length[a] - n; var k
= 0; while &#40;k &lt; m&#41; { r@k$ = a@n + k$; k++; }; r }
//drop[2, [3,1,4,1,5,9,2]]

for{p isa {``}, a isa []} := { var k = 0; while &#40;k &lt; length[a]&#41; {
p[a@k$]; k++ } }
//var s = 0; for[{`x` s += x }, [3, 4, 5]]; s

concat{a isa []} := { var r = []; var m = 0; for[{`b` for[{`x` r@m++$
= x }, b]}, a]; r }
//concat[[[3, 1], [], [4], [1, 5, 9, 2]]]
//var a = []; var k = 0; while &#40;k &lt; 1000&#41; { a@k$ = [k]; k++ };
concat[a] /* should be fast */

concatMap{p isa {``}, a isa []} := { var r = []; var m = 0; for[{`b`
for[{`x` r@m++$ = x }, p[b]]}, a]; r };
//concatMap[{`x` 0==x%2?[-1,x,-2]:[x]}, [3,1,4,1,5,9,2]]

reduce{p isa {``}, s, a isa []} := { var r = s; for[{`x` r = p[r, x]},
a]; r }; /* NOTE: differs from the current reduce function */
//reduce[{`x,y` 10*x+y }, 0, [2,3,4]]

fold{p isa {``}, a isa []} := { var r = a@0$; var k = 1; var m =
length[a]; while &#40;k &lt; m&#41; { r = p[r, a@k$]; k++; }; r } /* this is like
the current reduce function, but does not ignore number of arguments
*/
// fold[{`x,y` 10*x+y }, [2,3,4]]

scan{p isa {``}, s, a isa []} := { var t = s; var r = []; var k = 0;
var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = p[t, a@k$]; k++; }; r };
//scan[{`x,y` 10*x+y }, 0, [2,3,4]]

foldScan{p isa {``}, a isa []} := { var t = a@0$; var r = [t]; var k =
1; var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = p[t, a@k$]; k++; }; r
};
//foldScan[{`x,y` x*y}, [1,2,3,4]]

boolToNum{x} := { x conforms True ? &#40;x ? 1 : 0&#41; : x conforms 1 ? x :
error[&#34;error: boolean or number expected&#34;] };
//[boolToNum[True], boolToNum[2]]

iota{n} := { var k = 0; var r = []; var m = boolToNum[n]; while &#40;k &lt;
m&#41; { r@k$ = k; k++; }; r };
//iota[5]

times{p isa {``}, n} := { var k = 0; var m = boolToNum[n]; while &#40;k &lt;
m&#41; { p[k]; k++; }; };
//var n = 1; times[{`k`n*=2}, 10]; n

forRange2{p isa {``}, a isa 1, b isa 1} := { var k = a; while &#40;k &lt; b&#41;
{ p[k]; k++ } };
forRange3{p isa {``}, a isa 1, b isa 1, c isa 1} := { var k = a; while
&#40;0 &lt; c ? k &lt; b : b &lt; k&#41; { p[k]; k += c; } };
forRange{p isa {``}, a, b = undef, c = undef} := { c conforms undef ?
&#40;b conforms undef ? times[p, a] : forRange2[p, a, b]&#41; : forRange3[p,
a, b, c] };
range{a, b = undef, c = undef} := { var r = []; var k = 0;
forRange[{`x` r@k++$ = x }, a, b, c]; r };
// [range[5], range[2, 6], range[10,5,-1], range[2,10,2]]

sliceRange{a isa [], b, c = undef, d = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = a@x$; }, b, c, d]; r };
//sliceRange[[3,1,4,1,5,9,2], 0, 10, 2]

slice{a isa [], b isa []} := { map[{`x` a@x$ }, b] };
//slice[[3,1,4,1,5,9,2], [2,2,0]]

mapRange{p isa {``}, a, b = undef, c = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = p[x]; }, a, b, c]; r };
//mapRange[{`x` x^2}, 10]

replicate{n isa 1, x} := { mapRange[{`_k`, x}, n] };
//replicate[5, &#34;hello &#34;]



I still need to write these later:
find, any, anyWith, anyBool, anyBoolWith, all, allBool, findIndex,
filter &#40;bool/int&#41;, filterIndex, indices,
zip, zipWith, transpose,
grade, sortBy,
copy &#40;bool/int&#41;,
sum &#40;bool/int&#41;, sumWith &#40;bool/int&#41;,
reverse folds and scans,

UNTESTED, doesn&#39;t work, have to finish:
transposeWith{p isa {``}, a isa []} := { var m = a@0$; forRange[{`k`
if &#40;length[a@k$] &lt; m&#41; { m = length[a@k$] }; }, 1, length[a]];
mapRange[{`k` p[map[{`b` b@k$ }, a]] }, m] };
transpose{a isa []} := { transposeWith[{`x`x}, a] };
zipWith{p isa {``}, a isa ...} := { transposeWith[{`x` p*x }, a] };

Ambrus
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-778992" href="/Public/Bug/Display.html?id=57618#txn-778992">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;19&nbsp;02:32:06&nbsp;2010</span>
    <span class="description">farnsworth-bugs [...] googlegroups.com - Ticket #57624:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: Farnsworth array functions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 May 2010 07:55:26 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> farnsworth-bugs [...] googlegroups.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ZsbÃ¡n Ambrus &lt;ambrus [...] math.bme.hu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/778992/403459/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/403459">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 319b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, May 19, 2010 at 12:49 AM, ZsbÃ¡n Ambrus &lt;ambrus@math.bme.hu&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here are some array functions that might go to the farnsworth standard
&gt; library, and examples in comments.
</div>
Don&#39;t add the code from my previous mail yet, I&#39;ll still want to
revise them, I just sent it so there&#39;s a permanent record.

Ambrus
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-778996" href="/Public/Bug/Display.html?id=57618#txn-778996">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;19&nbsp;02:34:13&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org - Ticket #57624:  Merged into ticket #57618</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-778997" href="/Public/Bug/Display.html?id=57618#txn-778997">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;19&nbsp;02:34:13&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org -  Merged into ticket #57618</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779245" href="/Public/Bug/Display.html?id=57618#txn-779245">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;19&nbsp;15:47:42&nbsp;2010</span>
    <span class="description">farnsworth-bugs [...] googlegroups.com - Ticket #57643:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Farnsworth array functions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 May 2010 16:45:24 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> farnsworth-bugs [...] googlegroups.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ZsbÃ¡n Ambrus &lt;ambrus [...] math.bme.hu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/779245/403574/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/403574">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here are some array functions that might go to the farnsworth standard
library, and examples in comments.  This is still just a draft, don&#39;t
add them yet, just sending to record them.


You already have in the library: length @$ map reverse sort reduce min max +.


take{n isa 1, a isa []} := { var r = []; var k = 0; var m = n &lt;
length[a] ? n : length[a]; while &#40;k &lt; m&#41; { r@k$ = a@k$; k++; }; r };
//take[5, [3,1,4,1,5,9,2]];

drop{n isa 1, a isa []} := { var r = []; var m = length[a] - n; var k
= 0; while &#40;k &lt; m&#41; { r@k$ = a@n + k$; k++; }; r }
//drop[2, [3,1,4,1,5,9,2]];

for{p isa {``}, a isa []} := { var k = 0; while &#40;k &lt; length[a]&#41; {
p[a@k$]; k++ } };
//var s = 0; for[{`x` s += x }, [3, 4, 5]]; s

concat{a isa []} := { var r = []; var m = 0; for[{`b` for[{`x` r@m++$
= x }, b]}, a]; r };
//concat[[[3, 1], [], [4], [1, 5, 9, 2]]]
//var a = []; var k = 0; while &#40;k &lt; 1000&#41; { a@k$ = [k]; k++ };
concat[a] /* should be fast */

concatMap{p isa {``}, a isa []} := { var r = []; var m = 0; for[{`b`
for[{`x` r@m++$ = x }, p[b]]}, a]; r };
//concatMap[{`x` 0==x%2?[-1,x,-2]:[x]}, [3,1,4,1,5,9,2]]

reduce{p isa {``}, s, a isa []} := { var r = s; for[{`x` r = p[r, x]},
a]; r }; /* NOTE: differs from the current reduce function */
//reduce[{`x,y` 10*x+y }, 0, [2,3,4]]

fold{p isa {``}, a isa []} := { var r = a@0$; var k = 1; var m =
length[a]; while &#40;k &lt; m&#41; { r = p[r, a@k$]; k++; }; r }; /* this is like
the current reduce function, but does not ignore number of arguments
*/
// fold[{`x,y` 10*x+y }, [2,3,4]]

scan{p isa {``}, s, a isa []} := { var t = s; var r = []; var k = 0;
var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = p[t, a@k$]; k++; }; r };
//scan[{`x,y` 10*x+y }, 0, [2,3,4]]

foldScan{p isa {``}, a isa []} := { var t = a@0$; var r = [t]; var k =
1; var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = p[t, a@k$]; k++; }; r
};
//foldScan[{`x,y` x*y}, [1,2,3,4]]

iota{n} := { var k = 0; var r = []; while &#40;k &lt;
n&#41; { r@k$ = k; k++; }; r };
//iota[5]

times{p isa {``}, n} := { var k = 0; while &#40;k &lt;
n&#41; { p[k]; k++; }; };
//var a = []; times[{`k` a = a+[k]+a }, 5]; a

forRange{p isa {``}, a, b = undef, c = undef} := { if &#40;c conforms
undef&#41; { if &#40;b conforms undef&#41; { var k = 0; while &#40;k &lt; n&#41; { p[k]; k++;
}; } else { var k = a; while &#40;k &lt; b&#41; { p[k]; k++ } } } else { var k =
a; while &#40;0 &lt; c ? k &lt; b : b &lt; k&#41; { p[k]; k += c; } } };
// var s = []; forRange[{`x` s@x$ = 1; }, 3, 6]; s

range{a, b = undef, c = undef} := { var r = []; var k = 0;
forRange[{`x` r@k++$ = x }, a, b, c]; r };
// [range[5], range[2, 6], range[10,5,-1], range[2,10,2]]

sliceRange{a isa [], b, c = undef, d = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = a@x$; }, b, c, d]; r };
//sliceRange[[3,1,4,1,5,9,2], 0, 10, 2]

slice{a isa [], b isa []} := { map[{`x` a@x$ }, b] };
//slice[[3,1,4,1,5,9,2], [2,2,0]]

mapRange{p isa {``}, a, b = undef, c = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = p[x]; }, a, b, c]; r };
//mapRange[{`x`, &#40;x^2+x&#41;/2}, 1, 10]

replicate{n isa 1, x} := { mapRange[{`_k`, x}, n] };
//replicate[5, &#34;hello &#34;]

transpose{a isa []} := { var m = a ? length[a@0$] : 0; forRange[{`k`
if &#40;length[a@k$] &lt; m&#41; { m = length[a@k$] } }, 1, length[a]];
mapRange[{`k` map[{`b` b@k$ }, a] }, m] };
//transpose[[[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;],[&#34;d&#34;,&#34;e&#34;,&#34;f&#34;],[&#34;g&#34;,&#34;h&#34;,&#34;i&#34;]]]

forTranspose{p isa {``}, a isa []} := { var m = a ? length[a@0$] : 0;
forRange[{`k` if &#40;length[a@k$] &lt; m&#41; { m = length[a@k$] } }, 1,
length[a]]; forRange[{`k` p[map[{`b` b@k$ }, a]] }, m] }; /* this
could be a private function */

zip{a isa ...} := { transpose[a]; };
//zip[[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;,&#34;k&#34;],[&#34;d&#34;,&#34;e&#34;,&#34;f&#34;],[&#34;g&#34;,&#34;h&#34;,&#34;i&#34;]];

forZip{p isa {``}, a isa ...} := { forTranspose[{`x` p x }, a]; };
/*var a = []; forZip[{`x, y` if &#40;x &lt; y&#41; { a@length[a]$ = 10 x + y } },
[3, 1, 4, 1, 5], [9, 2, 6, 5, 3]]; a*/

mapZip{p isa {``}, a isa ...} := { var r = []; var k = 0;
forTranspose[{`x` r@k++$ = p x }, a]; r }; /* aka zipWith */
//mapZip[{`x, y, z` a = &#40;10 x + y&#41; z }, [3, 1, 4], [9, 2, 6], [meter,
kilogram, second]]

find{p isa {``}, a isa []} := { var k = 0; var m = length[a]; while &#40;k
&lt; m &#38;&#38; !&#40;p[a@k$]&#41;&#41; { k++ }; a@k$ };
//find[{`x`5&lt;x}, [3,1,4,1,5,9,2,6]];

findIndex{p isa {``}, a isa []} := { var k = 0; var m = length[a];
while &#40;k &lt; m &#38;&#38; !&#40;p[a@k$]&#41;&#41; { k++ }; k };
//findIndex[{`x`4&lt;x}, [3,1,4,1,5,9,2,6]]

anyMap{p isa {``}, a isa []} := { var k = 0; var m = length[a]; var r;
while &#40;k &lt; m &#38;&#38; !&#40;r = p[a@k$]&#41;&#41; { k++ }; r };
//anyMap[{`x` 8&lt;x }, [3,1,4,1,5,9,2,6]]

any{a isa []} := { var k = 0; var m = length[a]; while &#40;k &lt; m &#38;&#38;
!&#40;a@k$&#41;&#41; { k++ }; a@k$ };
//any[[0,0,3,0,2]]

anyP{a isa []} := { var k = 0; var m = length[a]; while &#40;k &lt; m &#38;&#38;
!&#40;a@k$&#41;&#41; { k++ }; k &lt; m };
//anyP[[0,0,3,0,2]]

anyMapP{p isa {``}, a isa []} := { var k = 0; var m = length[a]; while
&#40;k &lt; m &#38;&#38; !&#40;p[a@k$]&#41;&#41; { k++ }; k &lt; m };
//anyMapP[{`x` floor[x/6] }, [3,1,4,1,5,20,2,6]]


I still might need to write these later:
all, allP,
filter &#40;bool/int&#41;, filterIndex, indices,
copy, compress,
sum &#40;bool/int&#41;, sumWith &#40;bool/int&#41;,
infix, forInfix, chunk, forChunk,
grade, sortBy,
reverse folds and scans,
head, tail, last, init,
forL, forR, mapL, mapR,
findRange, anyRange, reduceRange, mapZip, findZip, anyZip, reduceZip,


Ambrus
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779249" href="/Public/Bug/Display.html?id=57618#txn-779249">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;19&nbsp;15:48:08&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org - Ticket #57643:  Merged into ticket #57618</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779250" href="/Public/Bug/Display.html?id=57618#txn-779250">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;19&nbsp;15:48:09&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org -  Merged into ticket #57618</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779255" href="/Public/Bug/Display.html?id=57618#txn-779255">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;19&nbsp;15:50:08&nbsp;2010</span>
    <span class="description">farnsworth-bugs [...] googlegroups.com - Ticket #57644:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Farnsworth array functions</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 May 2010 16:45:24 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> farnsworth-bugs [...] googlegroups.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ZsbÃ¡n Ambrus &lt;ambrus [...] math.bme.hu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/779255/403578/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/403578">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here are some array functions that might go to the farnsworth standard
library, and examples in comments.  This is still just a draft, don&#39;t
add them yet, just sending to record them.


You already have in the library: length @$ map reverse sort reduce min max +.


take{n isa 1, a isa []} := { var r = []; var k = 0; var m = n &lt;
length[a] ? n : length[a]; while &#40;k &lt; m&#41; { r@k$ = a@k$; k++; }; r };
//take[5, [3,1,4,1,5,9,2]];

drop{n isa 1, a isa []} := { var r = []; var m = length[a] - n; var k
= 0; while &#40;k &lt; m&#41; { r@k$ = a@n + k$; k++; }; r }
//drop[2, [3,1,4,1,5,9,2]];

for{p isa {``}, a isa []} := { var k = 0; while &#40;k &lt; length[a]&#41; {
p[a@k$]; k++ } };
//var s = 0; for[{`x` s += x }, [3, 4, 5]]; s

concat{a isa []} := { var r = []; var m = 0; for[{`b` for[{`x` r@m++$
= x }, b]}, a]; r };
//concat[[[3, 1], [], [4], [1, 5, 9, 2]]]
//var a = []; var k = 0; while &#40;k &lt; 1000&#41; { a@k$ = [k]; k++ };
concat[a] /* should be fast */

concatMap{p isa {``}, a isa []} := { var r = []; var m = 0; for[{`b`
for[{`x` r@m++$ = x }, p[b]]}, a]; r };
//concatMap[{`x` 0==x%2?[-1,x,-2]:[x]}, [3,1,4,1,5,9,2]]

reduce{p isa {``}, s, a isa []} := { var r = s; for[{`x` r = p[r, x]},
a]; r }; /* NOTE: differs from the current reduce function */
//reduce[{`x,y` 10*x+y }, 0, [2,3,4]]

fold{p isa {``}, a isa []} := { var r = a@0$; var k = 1; var m =
length[a]; while &#40;k &lt; m&#41; { r = p[r, a@k$]; k++; }; r }; /* this is like
the current reduce function, but does not ignore number of arguments
*/
// fold[{`x,y` 10*x+y }, [2,3,4]]

scan{p isa {``}, s, a isa []} := { var t = s; var r = []; var k = 0;
var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = p[t, a@k$]; k++; }; r };
//scan[{`x,y` 10*x+y }, 0, [2,3,4]]

foldScan{p isa {``}, a isa []} := { var t = a@0$; var r = [t]; var k =
1; var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = p[t, a@k$]; k++; }; r
};
//foldScan[{`x,y` x*y}, [1,2,3,4]]

iota{n} := { var k = 0; var r = []; while &#40;k &lt;
n&#41; { r@k$ = k; k++; }; r };
//iota[5]

times{p isa {``}, n} := { var k = 0; while &#40;k &lt;
n&#41; { p[k]; k++; }; };
//var a = []; times[{`k` a = a+[k]+a }, 5]; a

forRange{p isa {``}, a, b = undef, c = undef} := { if &#40;c conforms
undef&#41; { if &#40;b conforms undef&#41; { var k = 0; while &#40;k &lt; n&#41; { p[k]; k++;
}; } else { var k = a; while &#40;k &lt; b&#41; { p[k]; k++ } } } else { var k =
a; while &#40;0 &lt; c ? k &lt; b : b &lt; k&#41; { p[k]; k += c; } } };
// var s = []; forRange[{`x` s@x$ = 1; }, 3, 6]; s

range{a, b = undef, c = undef} := { var r = []; var k = 0;
forRange[{`x` r@k++$ = x }, a, b, c]; r };
// [range[5], range[2, 6], range[10,5,-1], range[2,10,2]]

sliceRange{a isa [], b, c = undef, d = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = a@x$; }, b, c, d]; r };
//sliceRange[[3,1,4,1,5,9,2], 0, 10, 2]

slice{a isa [], b isa []} := { map[{`x` a@x$ }, b] };
//slice[[3,1,4,1,5,9,2], [2,2,0]]

mapRange{p isa {``}, a, b = undef, c = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = p[x]; }, a, b, c]; r };
//mapRange[{`x`, &#40;x^2+x&#41;/2}, 1, 10]

replicate{n isa 1, x} := { mapRange[{`_k`, x}, n] };
//replicate[5, &#34;hello &#34;]

transpose{a isa []} := { var m = a ? length[a@0$] : 0; forRange[{`k`
if &#40;length[a@k$] &lt; m&#41; { m = length[a@k$] } }, 1, length[a]];
mapRange[{`k` map[{`b` b@k$ }, a] }, m] };
//transpose[[[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;],[&#34;d&#34;,&#34;e&#34;,&#34;f&#34;],[&#34;g&#34;,&#34;h&#34;,&#34;i&#34;]]]

forTranspose{p isa {``}, a isa []} := { var m = a ? length[a@0$] : 0;
forRange[{`k` if &#40;length[a@k$] &lt; m&#41; { m = length[a@k$] } }, 1,
length[a]]; forRange[{`k` p[map[{`b` b@k$ }, a]] }, m] }; /* this
could be a private function */

zip{a isa ...} := { transpose[a]; };
//zip[[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;,&#34;k&#34;],[&#34;d&#34;,&#34;e&#34;,&#34;f&#34;],[&#34;g&#34;,&#34;h&#34;,&#34;i&#34;]];

forZip{p isa {``}, a isa ...} := { forTranspose[{`x` p x }, a]; };
/*var a = []; forZip[{`x, y` if &#40;x &lt; y&#41; { a@length[a]$ = 10 x + y } },
[3, 1, 4, 1, 5], [9, 2, 6, 5, 3]]; a*/

mapZip{p isa {``}, a isa ...} := { var r = []; var k = 0;
forTranspose[{`x` r@k++$ = p x }, a]; r }; /* aka zipWith */
//mapZip[{`x, y, z` a = &#40;10 x + y&#41; z }, [3, 1, 4], [9, 2, 6], [meter,
kilogram, second]]

find{p isa {``}, a isa []} := { var k = 0; var m = length[a]; while &#40;k
&lt; m &#38;&#38; !&#40;p[a@k$]&#41;&#41; { k++ }; a@k$ };
//find[{`x`5&lt;x}, [3,1,4,1,5,9,2,6]];

findIndex{p isa {``}, a isa []} := { var k = 0; var m = length[a];
while &#40;k &lt; m &#38;&#38; !&#40;p[a@k$]&#41;&#41; { k++ }; k };
//findIndex[{`x`4&lt;x}, [3,1,4,1,5,9,2,6]]

anyMap{p isa {``}, a isa []} := { var k = 0; var m = length[a]; var r;
while &#40;k &lt; m &#38;&#38; !&#40;r = p[a@k$]&#41;&#41; { k++ }; r };
//anyMap[{`x` 8&lt;x }, [3,1,4,1,5,9,2,6]]

any{a isa []} := { var k = 0; var m = length[a]; while &#40;k &lt; m &#38;&#38;
!&#40;a@k$&#41;&#41; { k++ }; a@k$ };
//any[[0,0,3,0,2]]

anyP{a isa []} := { var k = 0; var m = length[a]; while &#40;k &lt; m &#38;&#38;
!&#40;a@k$&#41;&#41; { k++ }; k &lt; m };
//anyP[[0,0,3,0,2]]

anyMapP{p isa {``}, a isa []} := { var k = 0; var m = length[a]; while
&#40;k &lt; m &#38;&#38; !&#40;p[a@k$]&#41;&#41; { k++ }; k &lt; m };
//anyMapP[{`x` floor[x/6] }, [3,1,4,1,5,20,2,6]]


I still might need to write these later:
all, allP,
filter &#40;bool/int&#41;, filterIndex, indices,
copy, compress,
sum &#40;bool/int&#41;, sumWith &#40;bool/int&#41;,
infix, forInfix, chunk, forChunk,
grade, sortBy,
reverse folds and scans,
head, tail, last, init,
forL, forR, mapL, mapR,
findRange, anyRange, reduceRange, mapZip, findZip, anyZip, reduceZip,


Ambrus
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779846" href="/Public/Bug/Display.html?id=57618#txn-779846">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;15:43:57&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779847" href="/Public/Bug/Display.html?id=57618#txn-779847">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;15:44:00&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779848" href="/Public/Bug/Display.html?id=57618#txn-779848">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;15:44:14&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/779848/403891/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/403891">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">/*
Here are some &#40;mostly array&#41; functions that might go to the farnsworth
standard
library, and examples in comments. This is still just a draft, don&#39;t
add them yet,
just sending to record them.


You already have in the library: length @$ map reverse sort reduce min
max +.
*/


take{n isa 1, a isa []} := { var r = []; var k = 0; var m = n &lt;
length[a] ? n : length[a]; while &#40;k &lt; m&#41; { r@k$ = a@k$; k++; }; r };
//take[5, [3,1,4,1,5,9,2]];

drop{n isa 1, a isa []} := { var r = []; var m = length[a] - n; var k
= 0; while &#40;k &lt; m&#41; { r@k$ = a@n + k$; k++; }; r };
//drop[2, [3,1,4,1,5,9,2]];

for{p isa {``}, a isa []} := { var k = 0; while &#40;k &lt; length[a]&#41; {
&#40;p&#41;[a@k$]; k++ } };
//var s = 0; for[{`x` s += x }, [3, 4, 5]]; s

concat{a isa []} := { var r = []; var m = 0; for[{`b` for[{`x` r@m++$
= x }, b]}, a]; r };
/*concat[[[3, 1], [], [4], [1, 5, 9, 2]]];
var a = []; var k = 0; while &#40;k &lt; 1000&#41; { a@k$ = [k]; k++ };
concat[a]; */

concatMap{p isa {``}, a isa []} := { var r = []; var m = 0; for[{`b`
for[{`x` r@m++$ = x }, &#40;p&#41;[b]]}, a]; r };
//concatMap[{`x` 0==x%2?[-1,x,-2]:[x]}, [3,1,4,1,5,9,2]]

reduce{p isa {``}, s, a isa []} := { var r = s; for[{`x` r = &#40;p&#41;[r, x]},
a]; r }; /* NOTE: differs from the current reduce function */
//reduce[{`x,y` 10*x+y }, 0, [2,3,4]]

fold{p isa {``}, a isa []} := { var r = a@0$; var k = 1; var m =
length[a]; while &#40;k &lt; m&#41; { r = &#40;p&#41;[r, a@k$]; k++; }; r }; /* this is
like the current reduce function, but does not ignore number of
arguments */
// fold[{`x,y` 10*x+y }, [2,3,4]]

scan{p isa {``}, s, a isa []} := { var t = s; var r = []; var k = 0;
var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = &#40;p&#41;[t, a@k$]; k++; }; r };
//scan[{`x,y` 10*x+y }, 0, [2,3,4]]

foldScan{p isa {``}, a isa []} := { var t = a@0$; var r = [t]; var k =
1; var m = length[a]; while &#40;k &lt; m&#41; { r@k$ = t = &#40;p&#41;[t, a@k$]; k++; }; r
};
//foldScan[{`x,y` x*y}, [1,2,3,4]]

iota{n} := { var k = 0; var r = []; while &#40;k &lt; n&#41; { r@k$ = k; k++; }; r };
//iota[5]

times{p isa {``}, n} := { var k = 0; while &#40;k &lt; n&#41; { p[k]; k++; }; };
//var a = []; times[{`k` a = a+[k]+a }, 5]; a

forRange{p isa {``}, a, b = undef, c = undef} := { if &#40;c conforms undef&#41; {
if &#40;b conforms undef&#41; { var k = 0; while &#40;k &lt; a&#41; { &#40;p&#41;[k]; k++; }; } else {
var k = a; while &#40;k &lt; b&#41; { &#40;p&#41;[k]; k++ } } } else { var k = a; while
&#40;0 &lt; c ? k &lt; b : b &lt; k&#41; { &#40;p&#41;[k]; k += c; } } };
/*var s = []; forRange[{`x` s@x$ = 1; }, 3, 6]; s*/

range{a, b = undef, c = undef} := { var r = []; var k = 0;
forRange[{`x` r@k++$ = x }, a, b, c]; r };
/*[range[5], range[2, 6], range[10,5,-1], range[2,10,2]]*/

sliceRange{a isa [], b, c = undef, d = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = a@x$; }, b, c, d]; r };
//sliceRange[[3,1,4,1,5,9,2], 0, 10, 2]

slice{a isa [], b isa []} := { map[{`x` a@x$ }, b] };
//slice[[3,1,4,1,5,9,2], [2,2,0]]

mapRange{p isa {``}, a, b = undef, c = undef} := { var r = []; var k =
0; forRange[{`x` r@k++$ = &#40;p&#41;[x]; }, a, b, c]; r };
//mapRange[{`x`, &#40;x^2+x&#41;/2}, 1, 10]

replicate{n isa 1, x} := { mapRange[{`_k` x}, n] };
//replicate[5, &#34;hello &#34;]

transpose{a isa []} := { var m = a ? length[a@0$] : 0;
forRange[{`k` if &#40;length[a@k$] &lt; m&#41; { m = length[a@k$] } }, 1, length[a]];
mapRange[{`k` map[{`b` b@k$ }, a] }, m] };
//transpose[[[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;],[&#34;d&#34;,&#34;e&#34;,&#34;f&#34;],[&#34;g&#34;,&#34;h&#34;,&#34;i&#34;]]]

forTranspose{p isa {``}, a isa []} := { var m = a ? length[a@0$] : 0;
forRange[{`k` if &#40;length[a@k$] &lt; m&#41; { m = length[a@k$] } }, 1, length[a]];
forRange[{`k` &#40;p&#41;[map[{`b` b@k$ }, a]] }, m] };
/* forTranspose might be a private function, but it&#39;s needed for the
implementation below */

zip{a isa ...} := { if &#40;2 == length[a]&#41; { var a0 = a@0$; var a1 = a@1$;
var m = length[a0]&lt;=length[a1]?length[a0]:length[a1]; var r = []; var k = 0;
while &#40;k &lt; m&#41; { r@k$ = [a0@k$, a1@k$]; k++; }; r } else { transpose[a]; } };
/*[zip[[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;,&#34;k&#34;],[&#34;d&#34;,&#34;e&#34;,&#34;f&#34;],[&#34;g&#34;,&#34;h&#34;,&#34;i&#34;]], zip[[1, 2, 3],
[4, 5, 6]]];*/

forZip{p isa {``}, a isa ...} := { if &#40;2 == length[a]&#41; { var a0 = a@0$;
var a1 = a@1$; var m = length[a0]&lt;=length[a1]?length[a0]:length[a1]; var
k = 0;
while &#40;k &lt; m&#41; { &#40;p&#41;[a0@k$, a1@k$]; k++; }; } else { forTranspose[{`x`
&#40;p&#41;x }, a];
} };
/*
var a0 = []; forZip[{`x,y`a@x$=10*x+y}, [3,1,4], [1,5,9]];
var a1 = []; forZip[{`x,y,z`a@x$=10*y+z}, range[0,20,2], [3,1,4],
[1,5,9]]; [a0, a1];
*/

mapZip{p isa {``}, a isa ...} := { var r = []; var k = 0; if &#40;2 ==
length[a]&#41; { var a0 = a@0$; var a1 = a@1$; var m =
length[a0]&lt;=length[a1]?length[a0]:length[a1]; while &#40;k &lt; m&#41; { r@k$ =
&#40;p&#41;[a0@k$,
a1@k$]; k++; }; } else { forTranspose[{`x` r@k++$ = &#40;p&#41;x }, a]; }; r };
/*[mapZip[{`x, y, z` a = &#40;10 x + y&#41; z }, [3, 1, 4], [9, 2, 6], [meter,
kilogram, second]],
mapZip[{`x,y`10*x+y},[3,1,4],[1,5,9,2]],
mapZip[{`x,y,z`100*x+10*y+z},[3,1,4],[1,5,9],[2,6,5]]]*/

find{p isa {``}, a isa []} := { var k = 0; var m = length[a];
while &#40;k &lt; m &#38;&#38; !&#40;&#40;p&#41;[a@k$]&#41;&#41; { k++ }; a@k$ };
//find[{`x`5&lt;x}, [3,1,4,1,5,9,2,6]];

findIndex{p isa {``}, a isa []} := { var k = 0; var m = length[a];
while &#40;k &lt; m &#38;&#38; !&#40;&#40;p&#41;[a@k$]&#41;&#41; { k++ }; k };
//findIndex[{`x`4&lt;x}, [3,1,4,1,5,9,2,6]]

anyMap{p isa {``}, a isa []} := { var k = 0; var m = length[a]; var r;
while &#40;k &lt; m &#38;&#38; !&#40;r = &#40;p&#41;[a@k$]&#41;&#41; { k++ }; r };
//anyMap[{`x` 8&lt;x }, [3,1,4,1,5,9,2,6]]

any{a isa []} := { var k = 0; var m = length[a]; while &#40;k &lt; m &#38;&#38;
!&#40;a@k$&#41;&#41; { k++ }; a@k$ };
//any[[0,0,3,0,2]]

anyP{a isa []} := { var k = 0; var m = length[a]; while &#40;k &lt; m &#38;&#38;
!&#40;a@k$&#41;&#41; { k++ }; k &lt; m };
//anyP[[0,0,3,0,2]]

anyMapP{p isa {``}, a isa []} := { var k = 0; var m = length[a];
while &#40;k &lt; m &#38;&#38; !&#40;&#40;p&#41;[a@k$]&#41;&#41; { k++ }; k &lt; m };
//anyMapP[{`x` floor[x/6] }, [3,1,4,1,5,20,2,6]]

filter{p isa {``}, a isa []} := { var r = []; var k = 0; var l = 0; var m
= length[a]; while &#40;k &lt; m&#41; { if &#40;&#40;p&#41;[a@k$]&#41; { r@l++$ = a@k$; }; k++; }; r };
//filter[{`x`x&lt;5}, [3,1,4,1,5,9,2,6,3]]

compress{c isa [], a isa []} := { var r = []; var k = 0; var l = 0; var m
= length[a]; if &#40;m != length[c]&#41; { error[&#34;error: compress incompatible
arrays&#34;]
}; while &#40;k &lt; m&#41; { if &#40;c@k$&#41; { r@l++$ = a@k$; }; k++; }; r };
//var a = [3,1,4,1,5,9,2,6,3]; compress[map[{`x`x&lt;5},a], a];

copy{c isa [], a isa []} := { var r = []; var k = 0; var l = 0; var m =
length[a]; if &#40;m != length[c]&#41; { error[&#34;error: compress incompatible
arrays&#34;] };
while &#40;k &lt; m&#41; { var v = c@k$; while &#40;0 &lt; v--&#41; { r@l++$ = a@k$; }; k++;
}; r };
//var a = [3,1,4,1,5,9,2,6,3]; copy[map[{`x`floor[x/4]},a], a];

indicesMap{p isa {``}, a isa []} := { compress[map[p, a],
iota[length[a]]] };
//indicesMap[{`x`x&lt;4}, [3,1,4,1,5,9,2,6,3]];

sum{a isa []} := { reduce[{`t,x` t+x }, 0, a] };
//sum[[3,4,10]]

count{a isa []} := { reduce[{`t,x` x?t+1:t }, 0, a] };
//count[[True,False,False,False]]

sumMap{p isa {``}, a isa []} := { reduce[{`t,x` t+&#40;p&#41;[x] }, 0, a] };
//sumMap[{`x`abs[x]}, [3,-4,10*unit[i]]

countMap{p isa {``}, a isa []} := { reduce[{`t,x` &#40;p&#41;[x]?t+1:t }, 0, a] };
//countMap[{`x`x&lt;4},[3,1,4,1,5,9,2,6,3]]

complex{x,y} := { x + y * unit[i] };
//complex[3 second, -2 second]

explode{s isa &#34;&#34;} := { mapRange[{`x` substrLen[s,x,1]}, length[s]] };
//explode[&#34;hello&#34;]

implode{a isa []} := { if&#40;a&#41; { var p = {`i,j` j&lt;=1 ? a@i$ :
&#40;p&#41;[i,floor[j/2]] + &#40;p&#41;[i+floor[j/2],ceil[j/2]] }; &#40;p&#41;[0, length[a]] }
else { &#34;&#34;
} };
//implode[explode[&#34;hello, world&#34;]]

infix{n isa 1, a isa []} := { mapRange[{`k` sliceRange[a, k, k+n] },
length[a]-n+1] };
//map[{`x`implode[x]}, infix[2, explode[&#34;hello&#34;]]]

chunk{n isa 1, a isa []} := { var m = length[a]; mapRange[{`x`
sliceRange[a, x, x+n&lt;m?x+n:m] }, 0, m, n] };
//map[{`x`implode[x]}, chunk[5, explode[&#34;hello, world&#34;]]]

sortBy{a isa [], b isa []} := { if &#40;length[a]!=length[b]&#41; { error[&#34;error:
sortBy incompatible length arrays&#34;] }; slice[b, sort[{`x,y` a@x$&lt;=&gt;a@y$ },
range[length[b]]]] }; sortMap{p isa {``}, b isa []} := { sortBy[map[p,
b], b] };
//var a = map[{`x`100*randmax[100]+x}, [3,1,4,1,5,9,2,6]];
sortMap[{`x` x%100 }, a]


/*
Some ideas to write later:
reverse folds and scans,
head, tail, last, init,
findRange, anyRange, reduceRange, findZip, anyZip, reduceZip, *infix,
*chunk,
or a general lazy iterator/foldable object
&#40;doesn&#39;t seem possible without language expansions&#41;,
forL, forR, mapL, mapR,
all, allP.

These should rather be implemented as a builtin:
floor ceil rint trunc variants that give float &#40;not bigint&#41;.
div, mod, quo, rem,


Ambrus
*/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779851" href="/Public/Bug/Display.html?id=57618#txn-779851">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;15:44:57&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org - Ticket #57644:  Merged into ticket #57618</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-779852" href="/Public/Bug/Display.html?id=57618#txn-779852">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;15:44:57&nbsp;2010</span>
    <span class="description">simcop [...] cpan.org -  Merged into ticket #57618</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.604282</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
