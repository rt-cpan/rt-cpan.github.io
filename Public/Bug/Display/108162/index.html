<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #108162 for Net-FTPSSL: Net-FPSSL data connection mode problem</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #108162 for Net-FTPSSL: Net-FPSSL data connection mode problem</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-FTPSSL/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-FTPSSL/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-FTPSSL/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-FTPSSL/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-FTPSSL">Net-FTPSSL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">108162</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-FTPSSL/Active/">Net-FTPSSL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
laszlo.gercsov [...] mq.edu.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22628-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22629-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;29&nbsp;23:47:24&nbsp;2015</span>
    <span class="description">laszlo.gercsov [...] mq.edu.au -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net-FPSSL data connection mode problem</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Oct 2015 14:47:04 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-FTPSSL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Laszlo Gercsov &lt;laszlo.gercsov [...] mq.edu.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;13:53:21&nbsp;2015</span>
    <span class="description">CLEACH [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Laszlo,

Sorry for the delay in responding.  I was out of town for a long weekend.  Next time send all that data as attachments.  Makes things easier to read.  You could have dumped the output to a log file using option DebugLogFile=&gt;&#34;myLogs.txt&#34;.

Currently data channel modes&#40;S&#41; &#38; &#40;E&#41; are not supported, hence the failure message for &#39;E&#39;.  They&#39;ve been on my todo list for a while now.  But I currently don&#39;t have a server to develop against that supports these 2 options.  Making it very difficult to come up with a solution.  And I&#39;ve always found &#40;P&#41;, the most secure option, usually works.

So I was very surprised to see that selecting &#34;E&#34; for this worked in the test script.  It may have been a bug in my test code where it defaulted to &#39;P&#39; anyway for the data channel.  But without the log file for the test, I can&#39;t tell for sure.  Can you please rerun the test script &#38; return the log it generates in ./t/test_trace_log_new.txt

Also can you please simplify your test script.  Most of the options you provided are being ignored anyway.  Be careful of typos.  The module ignores unknown tags.

my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1, DebugLogFile=&gt;&#34;myLog${dc}.txt&#34;, Croak=&gt;1, Port=&gt;5011, DataProtLevel = $dc&#41;;

Try one test with $dc = &#34;P&#34; and another with $dc = &#34;E&#34;.

If neither case works, add SSL_Client_Certificate=&gt;%emptyHash so that it will attempt to reuse the context, and then retry $dc = &#34;P&#34; and another test with $dc = &#34;E&#34;.  &#40;Your test script had a typo when it attempted to do this.&#41;

I hope this helps &#38; I look forward to hearing back from you.

Curtis

On Thu Oct 29 23:47:24 2015, laszlo.gercsov@mq.edu.au wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi.
&gt; 
&gt; I would like to use &#34;Data Connection mode E&#34; with Net-FTPSSL-0.30.
&gt; 
&gt; For the FTPS server I am trying to use, &#39;make test&#39; deeper test works with
&gt; &#34;Data Connection mode E&#34;, but fails with &#34;Data Connection mode P&#34;.
&gt; 
&gt; During execution there is a message saying &#34;Data Connection mode E&#34; is not
&gt; supported and the transfer fails.
&gt; The transfer also fails with &#34;Data Connection mode P&#34; with &#34;450 TLS session
&gt; of data connection has not resumed or the session does not match the
&gt; control connection&#34;.
&gt; I have copied below the results for the &#34;make test&#34; attemps with data
&gt; connection mode &#34;E&#34; and &#34;P&#34; as well as the program listing for my test
&gt; program, and the results when the program executes.
&gt; I can transfer files using the same credentials using FileZilla, but with
&gt; mode &#34;P&#34; the transferred file is empty with size zero but the file is
&gt; created with a current timestamp, just no contents.
&gt; 
&gt; I get &#34;uname -a&#34; giving :-
&gt; Linux lacwsprd1001a 3.8.13-55.1.2.el6uek.x86_64 #2 SMP Thu Dec 18 00:15:51
&gt; PST 2014 x86_64 x86_64 x86_64 GNU/Linux
&gt; 
&gt; and &#34;perl -v&#34; gives :-
&gt; This is perl, v5.10.1 &#40;*&#41; built for x86_64-linux-thread-multi
&gt; 
&gt; I get the same results for Net-FTPSSL-0.30 and Net-FTPSSL-0.29
&gt; 
&gt; Please advise.
&gt; 
&gt; Thanks,
&gt; 
&gt; Laszlo.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;13:53:21&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;22:57:08&nbsp;2015</span>
    <span class="description">laszlo.gercsov [...] mq.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #108162] Net-FPSSL data connection mode problem</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Nov 2015 14:56:52 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-FTPSSL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Laszlo Gercsov &lt;laszlo.gercsov [...] mq.edu.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Curtis.

Thanks for looking into this.

I have attached the test trace log. It looks like the test with data mode E
has given the &#34;not supported&#34; message and the test reports that the test
was successful.

Best,

Laszlo.

On 3 November 2015 at 05:53, Curtis Leach via RT &lt;bug-Net-FTPSSL@rt.cpan.org
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; wrote:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=108162">https://rt.cpan.org/Ticket/Display.html?id=108162</a></span> &gt;
&gt;
&gt; Hi Laszlo,
&gt;
&gt; Sorry for the delay in responding.  I was out of town for a long weekend.
&gt; Next time send all that data as attachments.  Makes things easier to read.
&gt; You could have dumped the output to a log file using option
&gt; DebugLogFile=&gt;&#34;myLogs.txt&#34;.
&gt;
&gt; Currently data channel modes&#40;S&#41; &#38; &#40;E&#41; are not supported, hence the failure
&gt; message for &#39;E&#39;.  They&#39;ve been on my todo list for a while now.  But I
&gt; currently don&#39;t have a server to develop against that supports these 2
&gt; options.  Making it very difficult to come up with a solution.  And I&#39;ve
&gt; always found &#40;P&#41;, the most secure option, usually works.
&gt;
&gt; So I was very surprised to see that selecting &#34;E&#34; for this worked in the
&gt; test script.  It may have been a bug in my test code where it defaulted to
&gt; &#39;P&#39; anyway for the data channel.  But without the log file for the test, I
&gt; can&#39;t tell for sure.  Can you please rerun the test script &#38; return the log
&gt; it generates in ./t/test_trace_log_new.txt
&gt;
&gt; Also can you please simplify your test script.  Most of the options you
&gt; provided are being ignored anyway.  Be careful of typos.  The module
&gt; ignores unknown tags.
&gt;
&gt; my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1,
&gt; DebugLogFile=&gt;&#34;myLog${dc}.txt&#34;, Croak=&gt;1, Port=&gt;5011, DataProtLevel = $dc&#41;;
&gt;
&gt; Try one test with $dc = &#34;P&#34; and another with $dc = &#34;E&#34;.
&gt;
&gt; If neither case works, add SSL_Client_Certificate=&gt;%emptyHash so that it
&gt; will attempt to reuse the context, and then retry $dc = &#34;P&#34; and another
&gt; test with $dc = &#34;E&#34;.  &#40;Your test script had a typo when it attempted to do
&gt; this.&#41;
&gt;
&gt; I hope this helps &#38; I look forward to hearing back from you.
&gt;
&gt; Curtis
&gt;
&gt; On Thu Oct 29 23:47:24 2015, laszlo.gercsov@mq.edu.au wrote:
<div class="message-stanza open">&gt; &gt; Hi.
&gt; &gt;
&gt; &gt; I would like to use &#34;Data Connection mode E&#34; with Net-FTPSSL-0.30.
&gt; &gt;
&gt; &gt; For the FTPS server I am trying to use, &#39;make test&#39; deeper test works
</div>&gt; with
<div class="message-stanza open">&gt; &gt; &#34;Data Connection mode E&#34;, but fails with &#34;Data Connection mode P&#34;.
&gt; &gt;
&gt; &gt; During execution there is a message saying &#34;Data Connection mode E&#34; is
</div>&gt; not
<div class="message-stanza open">&gt; &gt; supported and the transfer fails.
&gt; &gt; The transfer also fails with &#34;Data Connection mode P&#34; with &#34;450 TLS
</div>&gt; session
<div class="message-stanza open">&gt; &gt; of data connection has not resumed or the session does not match the
&gt; &gt; control connection&#34;.
&gt; &gt; I have copied below the results for the &#34;make test&#34; attemps with data
&gt; &gt; connection mode &#34;E&#34; and &#34;P&#34; as well as the program listing for my test
&gt; &gt; program, and the results when the program executes.
&gt; &gt; I can transfer files using the same credentials using FileZilla, but with
&gt; &gt; mode &#34;P&#34; the transferred file is empty with size zero but the file is
&gt; &gt; created with a current timestamp, just no contents.
&gt; &gt;
&gt; &gt; I get &#34;uname -a&#34; giving :-
&gt; &gt; Linux lacwsprd1001a 3.8.13-55.1.2.el6uek.x86_64 #2 SMP Thu Dec 18
</div>&gt; 00:15:51
<div class="message-stanza open">&gt; &gt; PST 2014 x86_64 x86_64 x86_64 GNU/Linux
&gt; &gt;
&gt; &gt; and &#34;perl -v&#34; gives :-
&gt; &gt; This is perl, v5.10.1 &#40;*&#41; built for x86_64-linux-thread-multi
&gt; &gt;
&gt; &gt; I get the same results for Net-FTPSSL-0.30 and Net-FTPSSL-0.29
&gt; &gt;
&gt; &gt; Please advise.
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt;
&gt; &gt; Laszlo.
</div>&gt;
&gt;
</div>

-- 

*Laszlo Gercsov*


Senior Systems Analyst Library Systems

*Library  |  *Level 4, C3C Building
Macquarie Drive
Macquarie University, NSW 2109, Australia

*T:* +61 2 9850 6533 *| **F:* +61 2 9850 7568

*M:* + 61 402 175 101*  |  *mq.edu.au

[image: Macquarie University] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://mq.edu.au/">http://mq.edu.au/</a></span>&gt;

CRICOS Provider Number 00002J. Think before you print.
Please consider the environment before printing this email.

This message is intended for the addressee named and may
contain confidential information. If you are not the intended
recipient, please delete it and notify the sender. Views expressed
in this message are those of the individual sender, and are not
necessarily the views of Macquarie University.
</div></div>

<div class="messagebody">
</div>
</div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;03&nbsp;13:38:31&nbsp;2015</span>
    <span class="description">CLEACH [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Laszlo,

Did you truncate the log file?  Or was that all there was?  It ended in a really strange state.  So assuming that was everything in the log file, it tells me two things.

1&#41; The final message in the log says that your SFTP server doesn&#39;t support Data Chanel level &#34;E&#34;.  So there is nothing I can do about this on the client side.  You&#39;ll have to use the default protection level &#34;P&#34; and resolve it that way.

2&#41; There is a bug in my test script that just silently fails on that particular error and just skips the rest of the tests without telling you about it.

Now that we&#39;ve ruled out that your server doesn&#39;t support &#34;E&#34;, at this point your original request to have Net::FTPSSL support it won&#39;t help you.

Now going back to the original test script you sent me, I have 2 suggestions to try out in replacing the call to new&#40;&#41;.

my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1, DebugLogFile=&gt;&#34;myLog1.txt&#34;, Croak=&gt;1, Port=&gt;5011&#41;;

If that doesn&#39;t work, try the following:
my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1, DebugLogFile=&gt;&#34;myLog2.txt&#34;, Croak=&gt;1, Port=&gt;5011, SSL_Client_Certificate=&gt;%emptyHash&#41;;

If the 1st one fails &#38; the 2nd one works, and my test program fails, then I may have an issue with my test program as well.

Let me know how things work out.

Curtis


On Mon Nov 02 22:57:08 2015, laszlo.gercsov@mq.edu.au wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Curtis.
&gt; 
&gt; Thanks for looking into this.
&gt; 
&gt; I have attached the test trace log. It looks like the test with data
&gt; mode E
&gt; has given the &#34;not supported&#34; message and the test reports that the
&gt; test
&gt; was successful.
&gt; 
&gt; Best,
&gt; 
&gt; Laszlo.
&gt; 
&gt; On 3 November 2015 at 05:53, Curtis Leach via RT &lt;bug-Net-
&gt; FTPSSL@rt.cpan.org
<div class="message-stanza open">&gt; &gt; wrote:
</div>&gt; 
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=108162">https://rt.cpan.org/Ticket/Display.html?id=108162</a></span> &gt;
&gt; &gt;
&gt; &gt; Hi Laszlo,
&gt; &gt;
&gt; &gt; Sorry for the delay in responding.  I was out of town for a long
&gt; &gt; weekend.
&gt; &gt; Next time send all that data as attachments.  Makes things easier to
&gt; &gt; read.
&gt; &gt; You could have dumped the output to a log file using option
&gt; &gt; DebugLogFile=&gt;&#34;myLogs.txt&#34;.
&gt; &gt;
&gt; &gt; Currently data channel modes&#40;S&#41; &#38; &#40;E&#41; are not supported, hence the
&gt; &gt; failure
&gt; &gt; message for &#39;E&#39;.  They&#39;ve been on my todo list for a while now.  But
&gt; &gt; I
&gt; &gt; currently don&#39;t have a server to develop against that supports these
&gt; &gt; 2
&gt; &gt; options.  Making it very difficult to come up with a solution.  And
&gt; &gt; I&#39;ve
&gt; &gt; always found &#40;P&#41;, the most secure option, usually works.
&gt; &gt;
&gt; &gt; So I was very surprised to see that selecting &#34;E&#34; for this worked in
&gt; &gt; the
&gt; &gt; test script.  It may have been a bug in my test code where it
&gt; &gt; defaulted to
&gt; &gt; &#39;P&#39; anyway for the data channel.  But without the log file for the
&gt; &gt; test, I
&gt; &gt; can&#39;t tell for sure.  Can you please rerun the test script &#38; return
&gt; &gt; the log
&gt; &gt; it generates in ./t/test_trace_log_new.txt
&gt; &gt;
&gt; &gt; Also can you please simplify your test script.  Most of the options
&gt; &gt; you
&gt; &gt; provided are being ignored anyway.  Be careful of typos.  The module
&gt; &gt; ignores unknown tags.
&gt; &gt;
&gt; &gt; my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1,
&gt; &gt; DebugLogFile=&gt;&#34;myLog${dc}.txt&#34;, Croak=&gt;1, Port=&gt;5011, DataProtLevel =
&gt; &gt; $dc&#41;;
&gt; &gt;
&gt; &gt; Try one test with $dc = &#34;P&#34; and another with $dc = &#34;E&#34;.
&gt; &gt;
&gt; &gt; If neither case works, add SSL_Client_Certificate=&gt;%emptyHash so that
&gt; &gt; it
&gt; &gt; will attempt to reuse the context, and then retry $dc = &#34;P&#34; and
&gt; &gt; another
&gt; &gt; test with $dc = &#34;E&#34;.  &#40;Your test script had a typo when it attempted
&gt; &gt; to do
&gt; &gt; this.&#41;
&gt; &gt;
&gt; &gt; I hope this helps &#38; I look forward to hearing back from you.
&gt; &gt;
&gt; &gt; Curtis
&gt; &gt;
&gt; &gt; On Thu Oct 29 23:47:24 2015, laszlo.gercsov@mq.edu.au wrote:
<div class="message-stanza open">&gt; &gt; &gt; Hi.
&gt; &gt; &gt;
&gt; &gt; &gt; I would like to use &#34;Data Connection mode E&#34; with Net-FTPSSL-0.30.
&gt; &gt; &gt;
&gt; &gt; &gt; For the FTPS server I am trying to use, &#39;make test&#39; deeper test
&gt; &gt; &gt; works
</div>&gt; &gt; with
<div class="message-stanza open">&gt; &gt; &gt; &#34;Data Connection mode E&#34;, but fails with &#34;Data Connection mode P&#34;.
&gt; &gt; &gt;
&gt; &gt; &gt; During execution there is a message saying &#34;Data Connection mode E&#34;
&gt; &gt; &gt; is
</div>&gt; &gt; not
<div class="message-stanza open">&gt; &gt; &gt; supported and the transfer fails.
&gt; &gt; &gt; The transfer also fails with &#34;Data Connection mode P&#34; with &#34;450 TLS
</div>&gt; &gt; session
<div class="message-stanza open">&gt; &gt; &gt; of data connection has not resumed or the session does not match
&gt; &gt; &gt; the
&gt; &gt; &gt; control connection&#34;.
&gt; &gt; &gt; I have copied below the results for the &#34;make test&#34; attemps with
&gt; &gt; &gt; data
&gt; &gt; &gt; connection mode &#34;E&#34; and &#34;P&#34; as well as the program listing for my
&gt; &gt; &gt; test
&gt; &gt; &gt; program, and the results when the program executes.
&gt; &gt; &gt; I can transfer files using the same credentials using FileZilla,
&gt; &gt; &gt; but with
&gt; &gt; &gt; mode &#34;P&#34; the transferred file is empty with size zero but the file
&gt; &gt; &gt; is
&gt; &gt; &gt; created with a current timestamp, just no contents.
&gt; &gt; &gt;
&gt; &gt; &gt; I get &#34;uname -a&#34; giving :-
&gt; &gt; &gt; Linux lacwsprd1001a 3.8.13-55.1.2.el6uek.x86_64 #2 SMP Thu Dec 18
</div>&gt; &gt; 00:15:51
<div class="message-stanza open">&gt; &gt; &gt; PST 2014 x86_64 x86_64 x86_64 GNU/Linux
&gt; &gt; &gt;
&gt; &gt; &gt; and &#34;perl -v&#34; gives :-
&gt; &gt; &gt; This is perl, v5.10.1 &#40;*&#41; built for x86_64-linux-thread-multi
&gt; &gt; &gt;
&gt; &gt; &gt; I get the same results for Net-FTPSSL-0.30 and Net-FTPSSL-0.29
&gt; &gt; &gt;
&gt; &gt; &gt; Please advise.
&gt; &gt; &gt;
&gt; &gt; &gt; Thanks,
&gt; &gt; &gt;
&gt; &gt; &gt; Laszlo.
</div>&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;03&nbsp;17:56:32&nbsp;2015</span>
    <span class="description">laszlo.gercsov [...] mq.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #108162] Net-FPSSL data connection mode problem</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 4 Nov 2015 09:56:18 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-FTPSSL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Laszlo Gercsov &lt;laszlo.gercsov [...] mq.edu.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Curtis.

We upgraded IO::Socket::SSL and then &#34;Data Connection mode P&#34; with the
ReuseSession option got the FTPS file transfer working.

I was confused when the deeper test reported that the test with option &#34;E&#34;
was passed. I did not truncate the log - that&#39;s where it stops.

Thanks for your help ! I will not pursue this issue further as the transfer
is now working for us !

Best,

Laszlo.

On 4 November 2015 at 05:38, Curtis Leach via RT &lt;bug-Net-FTPSSL@rt.cpan.org
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; wrote:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=108162">https://rt.cpan.org/Ticket/Display.html?id=108162</a></span> &gt;
&gt;
&gt; Hi Laszlo,
&gt;
&gt; Did you truncate the log file?  Or was that all there was?  It ended in a
&gt; really strange state.  So assuming that was everything in the log file, it
&gt; tells me two things.
&gt;
&gt; 1&#41; The final message in the log says that your SFTP server doesn&#39;t support
&gt; Data Chanel level &#34;E&#34;.  So there is nothing I can do about this on the
&gt; client side.  You&#39;ll have to use the default protection level &#34;P&#34; and
&gt; resolve it that way.
&gt;
&gt; 2&#41; There is a bug in my test script that just silently fails on that
&gt; particular error and just skips the rest of the tests without telling you
&gt; about it.
&gt;
&gt; Now that we&#39;ve ruled out that your server doesn&#39;t support &#34;E&#34;, at this
&gt; point your original request to have Net::FTPSSL support it won&#39;t help you.
&gt;
&gt; Now going back to the original test script you sent me, I have 2
&gt; suggestions to try out in replacing the call to new&#40;&#41;.
&gt;
&gt; my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1,
&gt; DebugLogFile=&gt;&#34;myLog1.txt&#34;, Croak=&gt;1, Port=&gt;5011&#41;;
&gt;
&gt; If that doesn&#39;t work, try the following:
&gt; my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1,
&gt; DebugLogFile=&gt;&#34;myLog2.txt&#34;, Croak=&gt;1, Port=&gt;5011,
&gt; SSL_Client_Certificate=&gt;%emptyHash&#41;;
&gt;
&gt; If the 1st one fails &#38; the 2nd one works, and my test program fails, then
&gt; I may have an issue with my test program as well.
&gt;
&gt; Let me know how things work out.
&gt;
&gt; Curtis
&gt;
&gt;
&gt; On Mon Nov 02 22:57:08 2015, laszlo.gercsov@mq.edu.au wrote:
<div class="message-stanza open">&gt; &gt; Hi Curtis.
&gt; &gt;
&gt; &gt; Thanks for looking into this.
&gt; &gt;
&gt; &gt; I have attached the test trace log. It looks like the test with data
&gt; &gt; mode E
&gt; &gt; has given the &#34;not supported&#34; message and the test reports that the
&gt; &gt; test
&gt; &gt; was successful.
&gt; &gt;
&gt; &gt; Best,
&gt; &gt;
&gt; &gt; Laszlo.
&gt; &gt;
&gt; &gt; On 3 November 2015 at 05:53, Curtis Leach via RT &lt;bug-Net-
&gt; &gt; FTPSSL@rt.cpan.org
<div class="message-stanza open">&gt; &gt; &gt; wrote:
</div>&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=108162">https://rt.cpan.org/Ticket/Display.html?id=108162</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Hi Laszlo,
&gt; &gt; &gt;
&gt; &gt; &gt; Sorry for the delay in responding.  I was out of town for a long
&gt; &gt; &gt; weekend.
&gt; &gt; &gt; Next time send all that data as attachments.  Makes things easier to
&gt; &gt; &gt; read.
&gt; &gt; &gt; You could have dumped the output to a log file using option
&gt; &gt; &gt; DebugLogFile=&gt;&#34;myLogs.txt&#34;.
&gt; &gt; &gt;
&gt; &gt; &gt; Currently data channel modes&#40;S&#41; &#38; &#40;E&#41; are not supported, hence the
&gt; &gt; &gt; failure
&gt; &gt; &gt; message for &#39;E&#39;.  They&#39;ve been on my todo list for a while now.  But
&gt; &gt; &gt; I
&gt; &gt; &gt; currently don&#39;t have a server to develop against that supports these
&gt; &gt; &gt; 2
&gt; &gt; &gt; options.  Making it very difficult to come up with a solution.  And
&gt; &gt; &gt; I&#39;ve
&gt; &gt; &gt; always found &#40;P&#41;, the most secure option, usually works.
&gt; &gt; &gt;
&gt; &gt; &gt; So I was very surprised to see that selecting &#34;E&#34; for this worked in
&gt; &gt; &gt; the
&gt; &gt; &gt; test script.  It may have been a bug in my test code where it
&gt; &gt; &gt; defaulted to
&gt; &gt; &gt; &#39;P&#39; anyway for the data channel.  But without the log file for the
&gt; &gt; &gt; test, I
&gt; &gt; &gt; can&#39;t tell for sure.  Can you please rerun the test script &#38; return
&gt; &gt; &gt; the log
&gt; &gt; &gt; it generates in ./t/test_trace_log_new.txt
&gt; &gt; &gt;
&gt; &gt; &gt; Also can you please simplify your test script.  Most of the options
&gt; &gt; &gt; you
&gt; &gt; &gt; provided are being ignored anyway.  Be careful of typos.  The module
&gt; &gt; &gt; ignores unknown tags.
&gt; &gt; &gt;
&gt; &gt; &gt; my $ftps = Net::FTPSSL-&gt;new &#40;$server, Debug=&gt;1,
&gt; &gt; &gt; DebugLogFile=&gt;&#34;myLog${dc}.txt&#34;, Croak=&gt;1, Port=&gt;5011, DataProtLevel =
&gt; &gt; &gt; $dc&#41;;
&gt; &gt; &gt;
&gt; &gt; &gt; Try one test with $dc = &#34;P&#34; and another with $dc = &#34;E&#34;.
&gt; &gt; &gt;
&gt; &gt; &gt; If neither case works, add SSL_Client_Certificate=&gt;%emptyHash so that
&gt; &gt; &gt; it
&gt; &gt; &gt; will attempt to reuse the context, and then retry $dc = &#34;P&#34; and
&gt; &gt; &gt; another
&gt; &gt; &gt; test with $dc = &#34;E&#34;.  &#40;Your test script had a typo when it attempted
&gt; &gt; &gt; to do
&gt; &gt; &gt; this.&#41;
&gt; &gt; &gt;
&gt; &gt; &gt; I hope this helps &#38; I look forward to hearing back from you.
&gt; &gt; &gt;
&gt; &gt; &gt; Curtis
&gt; &gt; &gt;
&gt; &gt; &gt; On Thu Oct 29 23:47:24 2015, laszlo.gercsov@mq.edu.au wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; Hi.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I would like to use &#34;Data Connection mode E&#34; with Net-FTPSSL-0.30.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; For the FTPS server I am trying to use, &#39;make test&#39; deeper test
&gt; &gt; &gt; &gt; works
</div>&gt; &gt; &gt; with
<div class="message-stanza open">&gt; &gt; &gt; &gt; &#34;Data Connection mode E&#34;, but fails with &#34;Data Connection mode P&#34;.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; During execution there is a message saying &#34;Data Connection mode E&#34;
&gt; &gt; &gt; &gt; is
</div>&gt; &gt; &gt; not
<div class="message-stanza open">&gt; &gt; &gt; &gt; supported and the transfer fails.
&gt; &gt; &gt; &gt; The transfer also fails with &#34;Data Connection mode P&#34; with &#34;450 TLS
</div>&gt; &gt; &gt; session
<div class="message-stanza open">&gt; &gt; &gt; &gt; of data connection has not resumed or the session does not match
&gt; &gt; &gt; &gt; the
&gt; &gt; &gt; &gt; control connection&#34;.
&gt; &gt; &gt; &gt; I have copied below the results for the &#34;make test&#34; attemps with
&gt; &gt; &gt; &gt; data
&gt; &gt; &gt; &gt; connection mode &#34;E&#34; and &#34;P&#34; as well as the program listing for my
&gt; &gt; &gt; &gt; test
&gt; &gt; &gt; &gt; program, and the results when the program executes.
&gt; &gt; &gt; &gt; I can transfer files using the same credentials using FileZilla,
&gt; &gt; &gt; &gt; but with
&gt; &gt; &gt; &gt; mode &#34;P&#34; the transferred file is empty with size zero but the file
&gt; &gt; &gt; &gt; is
&gt; &gt; &gt; &gt; created with a current timestamp, just no contents.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I get &#34;uname -a&#34; giving :-
&gt; &gt; &gt; &gt; Linux lacwsprd1001a 3.8.13-55.1.2.el6uek.x86_64 #2 SMP Thu Dec 18
</div>&gt; &gt; &gt; 00:15:51
<div class="message-stanza open">&gt; &gt; &gt; &gt; PST 2014 x86_64 x86_64 x86_64 GNU/Linux
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; and &#34;perl -v&#34; gives :-
&gt; &gt; &gt; &gt; This is perl, v5.10.1 &#40;*&#41; built for x86_64-linux-thread-multi
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I get the same results for Net-FTPSSL-0.30 and Net-FTPSSL-0.29
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Please advise.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Thanks,
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Laszlo.
</div>&gt; &gt; &gt;
&gt; &gt; &gt;
</div></div>&gt;
&gt;
&gt;
&gt;
</div>

-- 

*Laszlo Gercsov*


Senior Systems Analyst Library Systems

*Library  |  *Level 4, C3C Building
Macquarie Drive
Macquarie University, NSW 2109, Australia

*T:* +61 2 9850 6533 *| **F:* +61 2 9850 7568

*M:* + 61 402 175 101*  |  *mq.edu.au

[image: Macquarie University] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://mq.edu.au/">http://mq.edu.au/</a></span>&gt;

CRICOS Provider Number 00002J. Think before you print.
Please consider the environment before printing this email.

This message is intended for the addressee named and may
contain confidential information. If you are not the intended
recipient, please delete it and notify the sender. Views expressed
in this message are those of the individual sender, and are not
necessarily the views of Macquarie University.
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;04&nbsp;22:02:00&nbsp;2015</span>
    <span class="description">CLEACH [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
