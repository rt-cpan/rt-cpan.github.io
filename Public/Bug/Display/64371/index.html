<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #64371 for Encode: Update for 5.14 API changes</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #64371 for Encode: Update for 5.14 API changes</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Encode">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Encode">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Encode">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Encode">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Encode">Encode CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">64371</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Encode">Encode</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
khw [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-12062-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.41    </td>
  </tr>
  <tr id="CF-12063-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




0002-Update-for-core-5.14-API-changes.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/875564/453459/0002-Update-for-core-5.14-API-changes.patch">
Fri Dec 31 16:29:28 2010 (6.6k) by khw [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=64371">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-875564" href="/Public/Bug/Display.html?id=64371#txn-875564">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;31&nbsp;16:29:28&nbsp;2010</span>
    <span class="description">khw [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Update for 5.14 API changes</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/875564/453458/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/453458">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Dan,

The attached patch changes two .xs files to compensate for the planned
changes in the core API for 5.14.  After much discussion on p5p, the
consensus is that to fix various misbehaviors with utf8, the best
solution is to change the API somewhat.  This solution requires the
fewest source code changes.  In fact, the attached changes are the only
ones required in all of CPAN.  

Whether changes to Encode should go first through you, or first through
blead has not been discussed on p5p.  A third option is first-come,
first-served, so that either your or p5p can create patches.  If you
have an opinion on this, please let me or the p5p email list know.

The patches try to keep the external behavior as close as possible to
the current one; I&#39;ve tried to give a full explanation in the commit
message.  

The severity is &#39;critical&#39; because we can&#39;t make the changes to blead
until these are applied.  It would be good to get these into the next
5.13.x release of blead, which means it would need to be applied within
the next couple weeks.  If you would rather I do that, I can, even if
you would rather keep control in general.

Thanks for maintaining Encode!
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0002-Update-for-core-5.14-API-changes.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/875564/453459/0002-Update-for-core-5.14-API-changes.patch">Download 0002-Update-for-core-5.14-API-changes.patch</a><br />
<span class="downloadcontenttype">text/x-diff 6.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From a8678e5edb9e8ddcdaaa291aa906c8308b6a9ec2 Mon Sep 17 00:00:00 2001
From: Karl Williamson &lt;public@khwilliamson.com&gt;
Date: Fri, 31 Dec 2010 11:12:51 -0700
Subject: [PATCH] Update for core 5.14 API changes

This patch updates two .xs files to accommodate the changes that are
planned in the Perl 5.14 core, while maintaining backward source
compatibility so that Encode can be used with earlier Perls.

The core is changing so that all code points that fit in a UV are legal
and do not raise warnings or errors when converted to/from utf8, except
during input and output.  This means that a 0 passed in the flags fields to
the routines that do this conversion means to accept any UVs instead of
forbidding all potentially problematic ones.  That means that any code
that doesn&#39;t want to accept certain categories must change to use new
flags that specify that behavior.  Since Encode is used for I/O, it
needs to change so that it can continue to check for these potentially
problematic code points.  The categories that are changing are the
surrogates, the non-character code points &#40;such as 0xFFFF, 0xFFFE, ...&#41;,
the code points above the legal Unicode maximum of 0x10FFFF &#40;called
supers&#41;, and the code points way above that maximum, above what was the
original utf8 limit of 0x7FFFFFFF.

The two affected functions are utf8n_to_uvuni&#40;&#41; and
uvuni_to_utf8_flags&#40;&#41;.

Both .xs files are changed to have #ifdefs and #defines so they can work
on Perls which don&#39;t have the latest flags #defined.

Besides that, here are the changes and their rationales.

First, for Encode.xs, it only calls one of the affected functions,
utf8n_to_utf8&#40;&#41;.  One of the calls uses the flag UTF8_ALLOW_ANY.
That flag will continue to have the same meaning as currently, so no
change is needed here.  The other two calls use the Encode #defines
UTF8_ALLOW_STRICT and UTF8_ALLOW_NONSTRICT.  The effect of the first
define is to exclude the 4 categories.  The effect of the other is to
allow them.  The only needed changes to the file are to adjust the
definitions of these to get as close to the existing behavior as
desirable.  The definition of nonstrict doesn&#39;t have to change, so the
only change needed is to UTF8_ALLOW_STRICT to disallow the 4
categories..  The pre-5.14 behavior of utf8n_to_utf8&#40;&#41; with respect to
the 4 categories is to allow the supers without complaint, but to
disallow the other three unless a flag was set otherwise.  However, it
only knew about 1 of the 66 non-characters, 0xFFFF, so it mistakenly
allowed the other 65 through without complaint.  Encode realizes that
the supers are allowed through, and so has special code to disallow them
when strictness is required, but the 65 noncharacters are allowed
through.  The 5.14 behavior is to know about all these.  Thus the
special code to disallow supers is not needed when run under 5.14.  And,
for the first time, under strict utf8ness, all the non-characters will
correctly be excluded, not just the one.  Note, though, that under
non-strict rules, accepting the non-character U+FFEF, is considered a
security hole, as it can apparently be used to make a program think the
byte ordering of the machine is the opposite of what it really is.  I
don&#39;t know it there have been successful attacks using this mechanism.
This patch closes this potential vulnerability under strict utf8; and
does not address it under non-strict.

Second, for Unicode.xs, it calls both the affected functions.  In the
single call to utf8n_to_uvuni&#40;&#41;, it currently uses 0 for the flags,
which causes the pre-5.14 function to not allow surrogates nor the very
large supers, nor the single non-character 0xFFFF; and to warn if any of
these conditions are found, provided UTF8 warnings are not lexically
disabled.  This patch keeps this behavior except it now allows 0xFFFF,
which brings that code point into sync with the other 65 points; but all
66 will warn.  If it&#39;s desired to exclude all 66, the flag
UTF8_DISALLOW_NONCHAR can be passed.  Note that supers are continued to
be accepted without complaint.

The single call to uvuni_to_utf8_flags&#40;&#41; currently uses 0 for the flags,
which causes the pre-5.14 function to accept all 4 categories, but to
warn, if enabled, on all 4.  The pre-5.14 function knows about all 66
noncharacters.  The patch just changes the flags to get the identical
behavior in 5.14.
---
 cpan/Encode/Encode.xs          |    7 ++++++-
 cpan/Encode/Unicode/Unicode.xs |   19 +++++++++++++++++--
 2 files changed, 23 insertions&#40;+&#41;, 3 deletions&#40;-&#41;

diff --git a/cpan/Encode/Encode.xs b/cpan/Encode/Encode.xs
index 1a672d6..ffaddb7 100644
--- a/cpan/Encode/Encode.xs
+++ b/cpan/Encode/Encode.xs
@@ -29,7 +29,12 @@
 UNIMPLEMENTED&#40;_encoded_utf8_to_bytes, I32&#41;
 UNIMPLEMENTED&#40;_encoded_bytes_to_utf8, I32&#41;
 
-#define UTF8_ALLOW_STRICT 0
+#ifdef UTF8_DISALLOW_ILLEGAL_INTERCHANGE
+#   define UTF8_ALLOW_STRICT UTF8_DISALLOW_ILLEGAL_INTERCHANGE
+#else
+#   define UTF8_ALLOW_STRICT 0
+#endif
+
 #define UTF8_ALLOW_NONSTRICT &#40;UTF8_ALLOW_ANY &#38;                    \
                               ~&#40;UTF8_ALLOW_CONTINUATION |         \
                                 UTF8_ALLOW_NON_CONTINUATION |     \
diff --git a/cpan/Encode/Unicode/Unicode.xs b/cpan/Encode/Unicode/Unicode.xs
index 9741626..61d25a2 100644
--- a/cpan/Encode/Unicode/Unicode.xs
+++ b/cpan/Encode/Unicode/Unicode.xs
@@ -18,6 +18,16 @@
 #define isLoSurrogate&#40;x&#41;	&#40;0xDC00 &lt;= &#40;x&#41;  &#38;&#38; &#40;x&#41; &lt;= 0xDFFF &#41;
 #define invalid_ucs2&#40;x&#41;         &#40; issurrogate&#40;x&#41; || 0xFFFF &lt; &#40;x&#41; &#41;
 
+/* For pre-5.14 source compatibility */
+#ifndef UNICODE_WARN_ILLEGAL_INTERCHANGE
+#   define UNICODE_WARN_ILLEGAL_INTERCHANGE 0
+#   define UTF8_DISALLOW_SURROGATE 0
+#   define UTF8_WARN_SURROGATE 0
+#   define UTF8_DISALLOW_FE_FF 0
+#   define UTF8_WARN_FE_FF 0
+#   define UTF8_WARN_NONCHAR 0
+#endif
+
 #define PERLIO_BUFSIZ 1024 /* XXX value comes from PerlIOEncode_get_base */
 
 /* Avoid wasting too much space in the result buffer */
@@ -255,7 +265,8 @@ CODE:
 	    resultbuflen = SvLEN&#40;result&#41;;
 	}
 
-	d = uvuni_to_utf8_flags&#40;resultbuf+SvCUR&#40;result&#41;, ord, 0&#41;;
+	d = uvuni_to_utf8_flags&#40;resultbuf+SvCUR&#40;result&#41;, ord,
+                                            UNICODE_WARN_ILLEGAL_INTERCHANGE&#41;;
 	SvCUR_set&#40;result, d - &#40;U8 *&#41;SvPVX&#40;result&#41;&#41;;
     }
 
@@ -323,7 +334,11 @@ CODE:
     }
     while &#40;s &lt; e &#38;&#38; s+UTF8SKIP&#40;s&#41; &lt;= e&#41; {
 	STRLEN len;
-	UV ord = utf8n_to_uvuni&#40;s, e-s, &#38;len, 0&#41;;
+	UV ord = utf8n_to_uvuni&#40;s, e-s, &#38;len, &#40;UTF8_DISALLOW_SURROGATE
+                                               |UTF8_WARN_SURROGATE
+                                               |UTF8_DISALLOW_FE_FF
+                                               |UTF8_WARN_FE_FF
+                                               |UTF8_WARN_NONCHAR&#41;&#41;;
 	s += len;
 	if &#40;size != 4 &#38;&#38; invalid_ucs2&#40;ord&#41;&#41; {
 	    if &#40;!issurrogate&#40;ord&#41;&#41; {
-- 
1.5.6.3

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-875587" href="/Public/Bug/Display.html?id=64371#txn-875587">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;31&nbsp;17:56:12&nbsp;2010</span>
    <span class="description">DANKOGAI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/875587/453473/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/453473">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">khw,

A happy new year.  Thank you so much.  Your patch is important enough to 
$Encode::VERSION++.  Repositories updated.  PAUSE submitted.

Dan the Maintainer Thereof


On Fri Dec 31 16:29:28 2010, khw wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Dan,
&gt; 
&gt; The attached patch changes two .xs files to compensate for the planned
&gt; changes in the core API for 5.14.  After much discussion on p5p, the
&gt; consensus is that to fix various misbehaviors with utf8, the best
&gt; solution is to change the API somewhat.  This solution requires the
&gt; fewest source code changes.  In fact, the attached changes are the only
&gt; ones required in all of CPAN.  
&gt; 
&gt; Whether changes to Encode should go first through you, or first through
&gt; blead has not been discussed on p5p.  A third option is first-come,
&gt; first-served, so that either your or p5p can create patches.  If you
&gt; have an opinion on this, please let me or the p5p email list know.
&gt; 
&gt; The patches try to keep the external behavior as close as possible to
&gt; the current one; I&#39;ve tried to give a full explanation in the commit
&gt; message.  
&gt; 
&gt; The severity is &#39;critical&#39; because we can&#39;t make the changes to blead
&gt; until these are applied.  It would be good to get these into the next
&gt; 5.13.x release of blead, which means it would need to be applied within
&gt; the next couple weeks.  If you would rather I do that, I can, even if
&gt; you would rather keep control in general.
&gt; 
&gt; Thanks for maintaining Encode!
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-875589" href="/Public/Bug/Display.html?id=64371#txn-875589">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;31&nbsp;17:56:12&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-875590" href="/Public/Bug/Display.html?id=64371#txn-875590">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;31&nbsp;17:56:13&nbsp;2010</span>
    <span class="description">DANKOGAI [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-875732" href="/Public/Bug/Display.html?id=64371#txn-875732">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;01&nbsp;12:10:47&nbsp;2011</span>
    <span class="description">khw [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #64371] Update for 5.14 API changes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 01 Jan 2011 10:10:28 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Encode [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karl WIlliamson &lt;corporate [...] khwilliamson.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/875732/453545/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/453545">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 453b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dan Kogai via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=64371">https://rt.cpan.org/Ticket/Display.html?id=64371</a></span> &gt;
&gt; 
&gt; khw,
&gt; 
&gt; A happy new year.  Thank you so much.  Your patch is important enough to 
&gt; $Encode::VERSION++.  Repositories updated.  PAUSE submitted.
</div>
It&#39;s new year here now.  Thanks for the lightning quick turn around. 
I&#39;m going to submit two more patches that are unrelated to this issue 
and have much lower priority, so can wait to be considered at your leisure.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-875734" href="/Public/Bug/Display.html?id=64371#txn-875734">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;01&nbsp;12:10:48&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-937661" href="/Public/Bug/Display.html?id=64371#txn-937661">#</a>      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;21&nbsp;18:15:11&nbsp;2011</span>
    <span class="description">DANKOGAI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/937661/486867/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/486867">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 642b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ouch.  The reply unintentionally reopened the ticket.  As you know it&#39;s in 2.42 so closing now.

Dan the Maintainer Thereof

On Sat Jan 01 12:10:47 2011, khw wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Dan Kogai via RT wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=64371">https://rt.cpan.org/Ticket/Display.html?id=64371</a></span> &gt;
&gt; &gt; 
&gt; &gt; khw,
&gt; &gt; 
&gt; &gt; A happy new year.  Thank you so much.  Your patch is important enough to 
&gt; &gt; $Encode::VERSION++.  Repositories updated.  PAUSE submitted.
</div>&gt; 
&gt; It&#39;s new year here now.  Thanks for the lightning quick turn around. 
&gt; I&#39;m going to submit two more patches that are unrelated to this issue 
&gt; and have much lower priority, so can wait to be considered at your leisure.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-937663" href="/Public/Bug/Display.html?id=64371#txn-937663">#</a>      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;21&nbsp;18:15:12&nbsp;2011</span>
    <span class="description">DANKOGAI [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.325577</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
