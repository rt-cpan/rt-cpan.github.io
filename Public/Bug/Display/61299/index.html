<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #61299 for Spreadsheet-ParseExcel: apostrophe issue</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #61299 for Spreadsheet-ParseExcel: apostrophe issue</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-ParseExcel">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-ParseExcel">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-ParseExcel">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-ParseExcel">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">61299</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-ParseExcel">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mailgpa [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




example.xls<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/830724/430338/example.xls">
Mon Sep 13 17:02:36 2010 (17.5k) by mailgpa [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=61299">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-830592" href="/Public/Bug/Display.html?id=61299#txn-830592">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;13&nbsp;07:29:06&nbsp;2010</span>
    <span class="description">mailgpa [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> apostrophe issue</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 13 Sep 2010 15:28:15 +0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Pavel Goloborodko &lt;mailgpa [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/830592/430267/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/430267">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi!

When a numeric cell starts with apostrophe&#40;&#39;&#41; &#40;which it disappearing after
input&#41; its value should be interpreted as text. But the parser tries to
format its value. As the result, &#34; &#39;000 &#34; is being parsed as &#34; 0.00 &#34;.

   Perl version   : 5.010001
   OS name        : MSWin32
   Module versions: &#40;not all are required&#41;
                    Spreadsheet::ParseExcel         0.57
                    Scalar::Util                    1.23
                    Unicode::Map                    &#40;not installed&#41;
                    Spreadsheet::WriteExcel         &#40;not installed&#41;
                    Parse::RecDescent               1.965001
                    File::Temp                      0.22
                    OLE::Storage_Lite               0.19
                    IO::Stringy                     2.110


I&#39;ve tried to fix this. But since it was not fully tested maybe you can
suggest a better solution.

sub ExcelFmt {

   my &#40; $format_str, $number, $is_1904, $number_type, $want_subformats &#41; =
@_;

   # Return text strings without further formatting.
   return $number unless $number =~ $qrNUMBER;
   # Fix leading apostrophe issue &#40;mailgpa@gmail.com&#41;.
   return $number if $number_type eq &#39;Text&#39;;

-- 
Ð¡ ÑƒÐ²Ð°Ð¶ÐµÐ½Ð¸ÐµÐ¼, / Kind regards,
ÐŸÐ°Ð²ÐµÐ» Ð“Ð¾Ð»Ð¾Ð±Ð¾Ñ€Ð¾Ð´ÑŒÐºÐ¾ / Pavel Goloborodko
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/830592/430268/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/430268">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.8k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-830724" href="/Public/Bug/Display.html?id=61299#txn-830724">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;13&nbsp;17:02:36&nbsp;2010</span>
    <span class="description">mailgpa [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #61299] AutoReply: apostrophe issue</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 14 Sep 2010 01:01:45 +0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Pavel Goloborodko &lt;mailgpa [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/830724/430337/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/430337">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Sep 13, 2010 at 3:29 PM, Bugs in Spreadsheet-ParseExcel via RT
&lt;bug-Spreadsheet-ParseExcel@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Greetings,
&gt;
&gt; This message has been automatically generated in response to the
&gt; creation of a trouble ticket regarding:
&gt; Â  Â  Â  Â &#34;apostrophe issue&#34;,
&gt; a summary of which appears below.
&gt;
&gt; There is no need to reply to this message right now. Â Your ticket has been
&gt; assigned an ID of [rt.cpan.org #61299]. Â Your ticket is accessible
&gt; on the web at:
&gt;
&gt; Â  Â <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=61299">https://rt.cpan.org/Ticket/Display.html?id=61299</a></span>
&gt;
&gt; Please include the string:
&gt;
&gt; Â  Â  Â  Â  [rt.cpan.org #61299]
&gt;
&gt; in the subject line of all future correspondence about this issue. To do so,
&gt; you may reply to this message.
&gt;
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Thank you,
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â bug-Spreadsheet-ParseExcel@rt.cpan.org
&gt;
&gt; -------------------------------------------------------------------------
&gt; Hi!
&gt;
&gt; When a numeric cell starts with apostrophe&#40;&#39;&#41; &#40;which it disappearing after
&gt; input&#41; its value should be interpreted as text. But the parser tries to
&gt; format its value. As the result, &#34; &#39;000 &#34; is being parsed as &#34; 0.00 &#34;.
&gt;
&gt; Â  Perl version Â  : 5.010001
&gt; Â  OS name Â  Â  Â  Â : MSWin32
&gt; Â  Module versions: &#40;not all are required&#41;
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Spreadsheet::ParseExcel Â  Â  Â  Â  0.57
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Scalar::Util Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 1.23
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Unicode::Map Â  Â  Â  Â  Â  Â  Â  Â  Â  Â &#40;not installed&#41;
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Spreadsheet::WriteExcel Â  Â  Â  Â  &#40;not installed&#41;
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Parse::RecDescent Â  Â  Â  Â  Â  Â  Â  1.965001
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â File::Temp Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 0.22
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â OLE::Storage_Lite Â  Â  Â  Â  Â  Â  Â  0.19
&gt; Â  Â  Â  Â  Â  Â  Â  Â  Â  Â IO::Stringy Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  2.110
&gt;
&gt;
&gt; I&#39;ve tried to fix this. But since it was not fully tested maybe you can
&gt; suggest a better solution.
&gt;
&gt; sub ExcelFmt {
&gt;
&gt; Â  my &#40; $format_str, $number, $is_1904, $number_type, $want_subformats &#41; =
&gt; @_;
&gt;
&gt; Â  # Return text strings without further formatting.
&gt; Â  return $number unless $number =~ $qrNUMBER;
&gt; Â  # Fix leading apostrophe issue &#40;mailgpa@gmail.com&#41;.
&gt; Â  return $number if $number_type eq &#39;Text&#39;;
&gt;
&gt; --
&gt; Ð¡ ÑƒÐ²Ð°Ð¶ÐµÐ½Ð¸ÐµÐ¼, / Kind regards,
&gt; ÐŸÐ°Ð²ÐµÐ» Ð“Ð¾Ð»Ð¾Ð±Ð¾Ñ€Ð¾Ð´ÑŒÐºÐ¾ / Pavel Goloborodko
&gt;
&gt;
</div>


-- 
Ð¡ ÑƒÐ²Ð°Ð¶ÐµÐ½Ð¸ÐµÐ¼, / Kind regards,
ÐŸÐ°Ð²ÐµÐ» Ð“Ð¾Ð»Ð¾Ð±Ð¾Ñ€Ð¾Ð´ÑŒÐºÐ¾ / Pavel Goloborodko
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/830724/430338/example.xls">Download example.xls</a><br />
<span class="downloadcontenttype">application/vnd.ms-excel 17.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-831883" href="/Public/Bug/Display.html?id=61299#txn-831883">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;16&nbsp;06:14:20&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/831883/430906/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/430906">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 89b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the example file.

I&#39;ll take a look at the issue and let you know.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-831886" href="/Public/Bug/Display.html?id=61299#txn-831886">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;16&nbsp;06:14:21&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-831896" href="/Public/Bug/Display.html?id=61299#txn-831896">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;16&nbsp;07:06:13&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/831896/430912/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/430912">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I found the issue. Here is a workaround until I can fix it in the code.


&lt;code&gt;

#!/usr/bin/perl

use strict;
use warnings;
use Spreadsheet::ParseExcel;

my $parser   = Spreadsheet::ParseExcel-&gt;new&#40;&#41;;
my $workbook = $parser-&gt;parse&#40;&#39;example.xls&#39;&#41;;


for my $worksheet &#40; $workbook-&gt;worksheets&#40;&#41; &#41; {

    my &#40; $row_min, $row_max &#41; = $worksheet-&gt;row_range&#40;&#41;;
    my &#40; $col_min, $col_max &#41; = $worksheet-&gt;col_range&#40;&#41;;

    for my $row &#40; $row_min .. $row_max &#41; {
        for my $col &#40; $col_min .. $col_max &#41; {

            my $cell = $worksheet-&gt;get_cell&#40; $row, $col &#41;;
            next unless $cell;

            my $value_formatted   = $cell-&gt;value&#40;&#41;;
            my $value_unformatted = $cell-&gt;unformatted&#40;&#41;;


            my $format = $cell-&gt;get_format&#40;&#41;;

            if &#40; defined $format &#38;&#38; $format-&gt;{Key123} &#41; {

                # Use the unformatted valus for 123 style text formats.
                $value_formatted = $value_unformatted;
            }

            print &#34;Row, Col      = &#40;$row, $col&#41;\n&#34;;
            print &#34;Value         = &#34;, $value_formatted, &#34;\n&#34;;
            print &#34;\n&#34;;
        }
    }
}

__END__

&lt;/code&gt;


John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-832138" href="/Public/Bug/Display.html?id=61299#txn-832138">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;16&nbsp;19:11:34&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/832138/431031/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/431031">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 177b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

There is a fix for this in the repo on Github.

<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/jmcnamara/spreadsheet-parseexcel">http://github.com/jmcnamara/spreadsheet-parseexcel</a></span>

Can you try it out and let me know if it resolves the issue.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-832502" href="/Public/Bug/Display.html?id=61299#txn-832502">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;17&nbsp;05:54:31&nbsp;2010</span>
    <span class="description">mailgpa [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #61299] apostrophe issue</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 17 Sep 2010 13:53:43 +0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Pavel Goloborodko &lt;mailgpa [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/832502/431236/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/431236">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 510b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi John,

it seems that it works. Thanks a lot!

On Fri, Sep 17, 2010 at 3:11 AM, John McNamara via RT
&lt;bug-Spreadsheet-ParseExcel@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=61299">https://rt.cpan.org/Ticket/Display.html?id=61299</a></span> &gt;
&gt;
&gt; Hi,
&gt;
&gt; There is a fix for this in the repo on Github.
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/jmcnamara/spreadsheet-parseexcel">http://github.com/jmcnamara/spreadsheet-parseexcel</a></span>
&gt;
&gt; Can you try it out and let me know if it resolves the issue.
&gt;
&gt; John.
&gt; --
&gt;
&gt;
</div>


-- 
Ð¡ ÑƒÐ²Ð°Ð¶ÐµÐ½Ð¸ÐµÐ¼, / Kind regards,
ÐŸÐ°Ð²ÐµÐ» Ð“Ð¾Ð»Ð¾Ð±Ð¾Ñ€Ð¾Ð´ÑŒÐºÐ¾ / Pavel Goloborodko
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834102" href="/Public/Bug/Display.html?id=61299#txn-834102">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;04:41:19&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/834102/432058/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432058">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 67b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in Spreadsheet::ParseExcel version 0.58.

Thanks,

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834105" href="/Public/Bug/Display.html?id=61299#txn-834105">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;04:41:21&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834108" href="/Public/Bug/Display.html?id=61299#txn-834108">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;04:52:04&nbsp;2010</span>
    <span class="description">mailgpa [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #61299] apostrophe issue</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 21 Sep 2010 12:51:16 +0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Pavel Goloborodko &lt;mailgpa [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/834108/432062/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432062">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 360b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks John!

On Tue, Sep 21, 2010 at 12:41 PM, John McNamara via RT
&lt;bug-Spreadsheet-ParseExcel@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=61299">https://rt.cpan.org/Ticket/Display.html?id=61299</a></span> &gt;
&gt;
&gt; Fixed in Spreadsheet::ParseExcel version 0.58.
&gt;
&gt; Thanks,
&gt;
&gt; John.
&gt; --
&gt;
&gt;
</div>


-- 
Ð¡ ÑƒÐ²Ð°Ð¶ÐµÐ½Ð¸ÐµÐ¼, / Kind regards,
ÐŸÐ°Ð²ÐµÐ» Ð“Ð¾Ð»Ð¾Ð±Ð¾Ñ€Ð¾Ð´ÑŒÐºÐ¾ / Pavel Goloborodko
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834110" href="/Public/Bug/Display.html?id=61299#txn-834110">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;04:52:05&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834118" href="/Public/Bug/Display.html?id=61299#txn-834118">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;05:15:16&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.449213</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
