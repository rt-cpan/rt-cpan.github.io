<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21986 for Archive-Tar: Packed relative paths lost on Win32</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21986 for Archive-Tar: Packed relative paths lost on Win32</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Archive-Tar/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Archive-Tar/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Archive-Tar/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Archive-Tar/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Archive-Tar">Archive-Tar CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21986</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Archive-Tar/Active/">Archive-Tar</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
sisyphus [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-2526-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.30    </td>
  </tr>
  <tr id="CF-2527-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




test.tar<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/250288/107413/test.tar">
Sun Oct 15 07:33:51 2006 (10k) by sisyphus1 [...] optusnet.com.au
</a>
</font></li>
</ul>


test2.tar<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/250288/107414/test2.tar">
Sun Oct 15 07:33:51 2006 (4k) by sisyphus1 [...] optusnet.com.au
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;10&nbsp;00:11:46&nbsp;2006</span>
    <span class="description">sisyphus [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Packed relative paths lost on Win32</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This may be related to bugs 19577 and/or 18720. Sorry, I don&#39;t have a 
patch. I&#39;m on Windows 2000, running MinGW-built perl 5.8.8 and 
Archive::Tar-1.30. 

By way of example, I have a tarball &#40;test.tar.gz&#41; that contains 
a/b/one.txt and a/b/two.txt.
I run the following code:

use warnings;
use Archive::Tar;
my $tar = Archive::Tar-&gt;new&#40;&#41;;
$tar-&gt;read&#40;&#39;test.tar.gz&#39;, 1&#41;;
$tar-&gt;write&#40;&#39;test2.tar.gz&#39;, 9&#41;;

I would expect that test.tar.gz and test2.tar.gz would be essentially, 
if not exactly, the same. On linux this is the case, but not on Win32. 
On Win32, test2.tar.gz&#39;s &#39;one.txt&#39; and &#39;two.txt&#39; are unpacked into the 
top level destination folder - not into destination/a/b. And if I open 
up test2.tar.gz in WinZip, I can see that nothing is being specified 
for &#34;Path&#34;.

Not sure when this first crept in - this breakage exists in both 
1.29_01 and 1.30, but not 1.10.

Things seem ok after doing the read. The following indicates 
thata/b/one.txt and a/b/two.txt are found in test.tar.gz:

use warnings;
use Archive::Tar;

my $tar = Archive::Tar-&gt;new&#40;&#41;;
$tar-&gt;read&#40;&#39;test.tar.gz&#39;, 1&#41;;
if&#40;$tar-&gt;contains_file&#40;&#39;a/b/one.txt&#39;&#41; &#38;&#38;
   $tar-&gt;contains_file&#40;&#39;a/b/two.txt&#39;&#41;&#41; {print &#34;OK\n&#34;}

But somewhere between then and writing the in-memory archive to file, 
the paths get lost.

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;14&nbsp;11:22:46&nbsp;2006</span>
    <span class="description">kane [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 10 00:11:46 2006, SISYPHUS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This may be related to bugs 19577 and/or 18720. Sorry, I don&#39;t have a 
&gt; patch. I&#39;m on Windows 2000, running MinGW-built perl 5.8.8 and 
&gt; Archive::Tar-1.30. 
&gt; 
&gt; By way of example, I have a tarball &#40;test.tar.gz&#41; that contains 
&gt; a/b/one.txt and a/b/two.txt.
&gt; I run the following code:
&gt; 
&gt; use warnings;
&gt; use Archive::Tar;
&gt; my $tar = Archive::Tar-&gt;new&#40;&#41;;
&gt; $tar-&gt;read&#40;&#39;test.tar.gz&#39;, 1&#41;;
&gt; $tar-&gt;write&#40;&#39;test2.tar.gz&#39;, 9&#41;;
&gt; 
&gt; I would expect that test.tar.gz and test2.tar.gz would be essentially, 
&gt; if not exactly, the same. On linux this is the case, but not on Win32. 
</div>
I&#39;ve attempted to replicate your problem as follows:

    C:\tmp\src&gt; ls -Rl
    .:
    total 16
    drwxr-xr-x 3 Administrator None     0 Oct 14 16:16 a
    
    ./a:
    total 0
    drwxr-xr-x 2 Administrator None 0 Oct 14 16:16 b
    
    ./a/b:
    total 0
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 one.txt
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 two.txt
    
    C:\tmp\src&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;14&nbsp;11:22:46&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;14&nbsp;11:22:47&nbsp;2006</span>
    <span class="description">kane [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;14&nbsp;11:23:15&nbsp;2006</span>
    <span class="description">kane [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 10 00:11:46 2006, SISYPHUS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This may be related to bugs 19577 and/or 18720. Sorry, I don&#39;t have a 
&gt; patch. I&#39;m on Windows 2000, running MinGW-built perl 5.8.8 and 
&gt; Archive::Tar-1.30. 
&gt; 
&gt; By way of example, I have a tarball &#40;test.tar.gz&#41; that contains 
&gt; a/b/one.txt and a/b/two.txt.
&gt; I run the following code:
&gt; 
&gt; use warnings;
&gt; use Archive::Tar;
&gt; my $tar = Archive::Tar-&gt;new&#40;&#41;;
&gt; $tar-&gt;read&#40;&#39;test.tar.gz&#39;, 1&#41;;
&gt; $tar-&gt;write&#40;&#39;test2.tar.gz&#39;, 9&#41;;
&gt; 
&gt; I would expect that test.tar.gz and test2.tar.gz would be essentially, 
&gt; if not exactly, the same. On linux this is the case, but not on Win32. 
</div>
I&#39;ve attempted to replicate your problem as follows:

    C:\tmp\src&gt; ls -Rl
    .:
    total 16
    drwxr-xr-x 3 Administrator None     0 Oct 14 16:16 a
    
    ./a:
    total 0
    drwxr-xr-x 2 Administrator None 0 Oct 14 16:16 b
    
    ./a/b:
    total 0
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 one.txt
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 two.txt
    
    C:\tmp\src&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;14&nbsp;11:23:16&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;14&nbsp;11:29:24&nbsp;2006</span>
    <span class="description">kane [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for the SPAM, apparently RT was only getting a part of my reply.

On Tue Oct 10 00:11:46 2006, SISYPHUS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This may be related to bugs 19577 and/or 18720. Sorry, I don&#39;t have a 
&gt; patch. I&#39;m on Windows 2000, running MinGW-built perl 5.8.8 and 
&gt; Archive::Tar-1.30. 
&gt; 
&gt; By way of example, I have a tarball &#40;test.tar.gz&#41; that contains 
&gt; a/b/one.txt and a/b/two.txt.
&gt; I run the following code:
&gt; 
&gt; use warnings;
&gt; use Archive::Tar;
&gt; my $tar = Archive::Tar-&gt;new&#40;&#41;;
&gt; $tar-&gt;read&#40;&#39;test.tar.gz&#39;, 1&#41;;
&gt; $tar-&gt;write&#40;&#39;test2.tar.gz&#39;, 9&#41;;
&gt; 
&gt; I would expect that test.tar.gz and test2.tar.gz would be essentially, 
&gt; if not exactly, the same. On linux this is the case, but not on Win32. 
</div>
I&#39;ve attempted to replicate your problem as follows:

    C:\tmp\src&gt; ls -Rl
    .:
    total 16
    drwxr-xr-x 3 Administrator None     0 Oct 14 16:16 a
    
    ./a:
    total 0
    drwxr-xr-x 2 Administrator None 0 Oct 14 16:16 b
    
    ./a/b:
    total 0
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 one.txt
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 two.txt
    
    C:\tmp\srcs shows that in our original tar file, the paths are stored. Using your
copy code, i created a test2.tar, which shows exactly the same contents.

    C:\tmp&gt; cat x.pl
    use strict;
    use warnings;
    use Archive::Tar;
    
    
    my $tar = Archive::Tar-&gt;new&#40;&#41;;
    $tar-&gt;read&#40; shift&#40;&#41; &#41;;
    $tar-&gt;write&#40; shift&#40;&#41; &#41;;

    C:\tmp&gt; perl perl x.pl src\test.tar test2.tar

    C:\tmp&gt; ptar -tf test2.tar
    a
    a/b
    a/b/one.txt
    a/b/two.txt

So I&#39;ve been unable to reproduce your problem -- the files are identical,
even according to diff&#40;1&#41;.
I&#39;m using vanilla-perl on Win2003 server, with Archive::Tar 1.30.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Win32, test2.tar.gz&#39;s &#39;one.txt&#39; and &#39;two.txt&#39; are unpacked into the 
&gt; top level destination folder - not into destination/a/b. 
</div>
Hmm, also that i can not reproduce:

    C:\tmp\out&gt; ptar -xf ..\test2.tar
    C:\tmp\out&gt; ls -Rl
    .:
    total 0
    drwxr-xr-x 3 Administrator None 0 Oct 14 17:18 a
    
    ./a:
    total 0
    drwxr-xr-x 2 Administrator None 0 Oct 14 17:18 b
    
    ./a/b:
    total 0
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 one.txt
    -rw-r--r-- 1 Administrator None 0 Oct 14 16:16 two.txt

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And if I open 
&gt; up test2.tar.gz in WinZip, I can see that nothing is being specified 
&gt; for &#34;Path&#34;.
</div>
Hmm, if you are using winzip for the entire process, perhaps this FAQ
entry applies to you:

    I&#39;m using WinZip, or some other non-POSIX client, and files are 
    not being extracted properly!
    
    By default, Archive::Tar is in a completely POSIX-compatible mode, which 
    uses the POSIX-specification of tar to store files. For paths greather 
    than 100 characters, this is done using the POSIX header prefix.
    Non-POSIX-compatible clients may not support this part of the specification, 
    and may only support the GNU Extended Header functionality. To facilitate 
    those clients, you can set the $Archive::Tar::DO_NOT_USE_PREFIX variable 
    to true. See the GLOBAL VARIABLES section for details on this variable.

I&#39;m afraid i&#39;m not able to track down the problem for you, as it works as
intended on my windows box. 

Sorry I couldn&#39;t be more help :&#40;

If you have anything that could help me reproduce the problem, I&#39;m happy
to look into it again -- perhaps showing me the tar files &#40;skip the .gz
compression&#41; generated by A::T that are faulty would help...

Regards,

-- Jos
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;14&nbsp;11:30:01&nbsp;2006</span>
    <span class="description">kane [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;15&nbsp;07:33:48&nbsp;2006</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21986] Packed relative paths lost on Win32 </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 15 Oct 2006 21:28:00 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Tar [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34; via RT&#34; &lt;bug-Archive-Tar@rt.cpan.org&gt;

<div class="message-stanza open">&gt;
&gt; So I&#39;ve been unable to reproduce your problem -- the files are identical,
&gt; even according to diff&#40;1&#41;.
&gt; I&#39;m using vanilla-perl on Win2003 server, with Archive::Tar 1.30.
&gt;
</div>
Ok - just to standardise things a little, I&#39;m using Strawberry Perl on
Windows 2000, with Archive::Tar-1.30.

<div class="message-stanza open">&gt;
&gt; Hmm, if you are using winzip for the entire process, perhaps this FAQ
&gt; entry applies to you:
&gt;
&gt;     I&#39;m using WinZip, or some other non-POSIX client, and files are
&gt;     not being extracted properly!
&gt;
&gt;     By default, Archive::Tar is in a completely POSIX-compatible mode,
</div>which
<div class="message-stanza open">&gt;     uses the POSIX-specification of tar to store files. For paths greather
&gt;     than 100 characters, this is done using the POSIX header prefix.
&gt;     Non-POSIX-compatible clients may not support this part of the
</div>specification,
<div class="message-stanza open">&gt;     and may only support the GNU Extended Header functionality. To
</div>facilitate
<div class="message-stanza open">&gt;     those clients, you can set the $Archive::Tar::DO_NOT_USE_PREFIX
</div>variable
<div class="message-stanza open">&gt;     to true. See the GLOBAL VARIABLES section for details on this
</div>variable.
<div class="message-stanza open">&gt;
</div>
Curiouser and curiouser ....
I&#39;m not using *just* WinZip. I find the same problem using gzip.exe and
tar.exe from <span class="clickylink"><a target="new" rel="nofollow" href="http://gnuwin32.sourceforge.net/packages.html">http://gnuwin32.sourceforge.net/packages.html</a></span> . I see you have
&#39;cat&#39; which doesn&#39;t normally exist in the cmd.exe shell ... so I wondered if
perhaps there were shell issues at play here. However, I find the same in
both the cmd.exe shell and the msys &#40;bash&#41; shell.

First up, following on with your suggestion that we stick with uncompressed
tar files, here&#39;s what &#39;try.pl&#39; looks like:

----------------------------
E:\pscrpt\archive-tar&gt;type try.pl
use warnings;
use Archive::Tar;

my $tar = Archive::Tar-&gt;new&#40;&#41;;

$tar-&gt;read&#40;&#39;test.tar&#39;, 0&#41;;
$tar-&gt;write&#40;&#39;test2.tar&#39;, 0&#41;;

print $Archive::Tar::VERSION, &#34;\n&#34;;
----------------------------

Both &#39;try.pl&#39; and &#39;test.tar&#39; are located in E:/pscrpt/archive-tar.
&#40;Obviously, test2.tar gets written to the same directory.&#41;
For separation purposes, I &#39;cd&#39; to E:/pscrpt/archive-tar/extract to extract
test2.tar.

Anyway, here&#39;s what I get in the msys shell using the Gnu tar utility with
Strawberry Perl:

----------------------------
Rob@DESKTOP /e/pscrpt/archive-tar
$ perl try.pl
1.30

Rob@DESKTOP /e/pscrpt/archive-tar
$ cd extract

Rob@DESKTOP /e/pscrpt/archive-tar/extract
$ /d/tar/tar xvf ../test2.tar
d:\tar\tar.exe: Blocksize = 8 records
a
b
one.txt
two.txt
 : Permission denied
 : Permission denied
d:\tar\tar.exe: couldn&#39;t change access and modification times of b:
d:\tar\tar.exe: couldn&#39;t change access and modification times of a:
Rob@DESKTOP /e/pscrpt/archive-tar/extract
-------------------------------------

Which is essentially the same as I get in the cmd.exe shell using the same
perl and the same tar utility:

-------------------------------------
E:\pscrpt\archive-tar&gt;perl try.pl
1.30

E:\pscrpt\archive-tar&gt;cd extract

E:\pscrpt\archive-tar\extract&gt;tar xvf ..\test2.tar
tar: Blocksize = 8 records
a
b
one.txt
two.txt
tar: couldn&#39;t change access and modification times of b:  : Permission
denied
tar: couldn&#39;t change access and modification times of a:  : Permission
denied

E:\pscrpt\archive-tar\extract&gt;
------------------------------------

Attached is both the original &#39;test.tar&#39; and the &#39;test2.tar&#39; that is
generated by &#39;try.pl&#39;. &#40;Is this the right place to send them ? Please let me
know if I was supposed to send them elsewhere.&#41;

Perhaps both my tar.exe and WinZip.exe programs suffer from the same ailment
?

Thank you for replying so promptly.

Oops ... I had an afterthought ... what if &#40;in the msys shell&#41; I use that
shell&#39;s version of &#39;tar&#39; rather than the Gnu version ? Turns out it makes
essentially no difference:

------------------------------------- 
Rob@DESKTOP /e/pscrpt/archive-tar/extract
$ tar xvf ../test2.tar
tar: Record size = 8 blocks
a
b
one.txt
two.txt
-------------------------------------

Finally, as an afterafterthought, I did a &#39;diff -u&#39;:

-------------------------------------
E:\pscrpt\archive-tar&gt;diff -u test2.tar test.tar
Binary files test2.tar and test.tar differ
-------------------------------------

Cheers,
Rob
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/250288/107413/test.tar">Download test.tar</a><br />
<span class="downloadcontenttype">application/octet-stream 10k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/250288/107414/test2.tar">Download test2.tar</a><br />
<span class="downloadcontenttype">application/octet-stream 4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;15&nbsp;07:33:54&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;15&nbsp;10:58:56&nbsp;2006</span>
    <span class="description">kane [...] xs4all.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21986] Packed relative paths lost on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 15 Oct 2006 16:58:28 +0200 &#40;CEST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Archive-Tar [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Jos Boumans&#34; &lt;kane [...] xs4all.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[...]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not using *just* WinZip. I find the same problem using gzip.exe and
&gt; tar.exe from <span class="clickylink"><a target="new" rel="nofollow" href="http://gnuwin32.sourceforge.net/packages.html">http://gnuwin32.sourceforge.net/packages.html</a></span>
</div>[...]

Ah! I think we may have hit upon the problem here. This GnuTar port is well..
ancient :&#40; They supply only a port of 1.13, which is from 1999 as you can
see here:

  <span class="clickylink"><a target="new" rel="nofollow" href="http://ftp.gnu.org/gnu/tar/">http://ftp.gnu.org/gnu/tar/</a></span>

At that time, gnu tar didn&#39;t have the PREFIX header support yet, so it&#39;s
blatantly
ignoring it in the tar archive created by Archive::Tar. You are indeed
getting bitten
by the non-POSIX compatibility issue as mentioned in the A::T FAQ.

I&#39;ll mention expliclity in the FAQ now, that this includes gnu tar pre
version 1.14.

You could try using the gnu tar supplied by cygwin, who supply 1.15.x.

Hopefully this will fix your problem.

Good luck,

Jos
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;15&nbsp;18:45:01&nbsp;2006</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21986] Packed relative paths lost on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 16 Oct 2006 08:39:35 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Tar [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Jos I. Boumans via RT&#34; &lt;bug-Archive-Tar@rt.cpan.org&gt;

<div class="message-stanza open">&gt; 
&gt; You could try using the gnu tar supplied by cygwin, who supply 1.15.x.
&gt; 
&gt; Hopefully this will fix your problem.
&gt; 
</div>
Yes, it does fix the problem.
Apologies for having thrown a non-Archive::Tar issue at you.

Thanks for providing a solution.

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;15&nbsp;20:24:19&nbsp;2006</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21986] Packed relative paths lost on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 16 Oct 2006 10:18:57 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Tar [...] rt.cpan.org&gt;, &lt;SISYPHUS [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Archive-
<div class="message-stanza open">&gt; Apologies for having thrown a non-Archive::Tar issue at you.
</div>
Actually, I was a little hasty there. There&#39;s still a problem with
Archive::Tar in that when I do:

$tar-&gt;read&#40;&#39;test.tar&#39;, 0&#41;;
$tar-&gt;write&#40;&#39;test2.tar&#39;, 0&#41;;

then test2.tar is not an exact copy of test.tar.

Having created test.tar using cygwin&#39;s tar, test2.tar unpacks correctly
using that same tar utility.

But whilt WinZip unpacks test.tar correctly, it fails to handle test2.tar
correctly - again the paths are lost.

That can only mean that test.tar and test2.tar are not the same.

Does this relate to those other bugs reported re Win32 ?

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;16&nbsp;05:21:25&nbsp;2006</span>
    <span class="description">kane [...] xs4all.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21986] Packed relative paths lost on Win32</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 16 Oct 2006 11:21:09 +0200 &#40;CEST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Archive-Tar [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Jos Boumans&#34; &lt;kane [...] xs4all.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Actually, I was a little hasty there. There&#39;s still a problem with
&gt; Archive::Tar in that when I do:
&gt;
&gt; $tar-&gt;read&#40;&#39;test.tar&#39;, 0&#41;;
&gt; $tar-&gt;write&#40;&#39;test2.tar&#39;, 0&#41;;
&gt;
&gt; then test2.tar is not an exact copy of test.tar.
&gt;
&gt; Having created test.tar using cygwin&#39;s tar, test2.tar unpacks correctly
&gt; using that same tar utility.
&gt;
&gt; But whilt WinZip unpacks test.tar correctly, it fails to handle test2.tar
&gt; correctly - again the paths are lost.
&gt;
&gt; That can only mean that test.tar and test2.tar are not the same.
&gt;
&gt; Does this relate to those other bugs reported re Win32 ?
</div>
This is still part of the issue i described to you and which is mentioned
in the
FAQ: WinZIp doesn&#39;t understand POSIX compliant tar-achives. test2.tar is
indeed
not identical to test.tar, as test2.tar is re-packaged using Archive::Tar,
and the PREFIX
header is used, which WinZip &#40;and your gnu-tar port 1.13&#41; just ignore.
hence the problem.

Follow the instructions from the FAQ to avoid this behaviour &#40;but realise,
your tar archives
will now no longer work on strictly POSIX compliant archives&#41; or avoid
using non-POSIX
compliant extraction applications.

Good luck,

Jos
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;20&nbsp;08:34:25&nbsp;2006</span>
    <span class="description">kane [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
