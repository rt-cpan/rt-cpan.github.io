<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #3861 for Apache-Test: Custom t/conf/httpd.conf.in is ignored</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #3861 for Apache-Test: Custom t/conf/httpd.conf.in is ignored</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Apache-Test/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Apache-Test/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Apache-Test/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Apache-Test/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Apache-Test">Apache-Test CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">3861</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Apache-Test/Active/">Apache-Test</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
william [...] knowmad.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-2238-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.03    </td>
  </tr>
  <tr id="CF-2239-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;24&nbsp;11:57:09&nbsp;2003</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Custom t/conf/httpd.conf.in is ignored</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">After getting past the hurdle of notifying A::Test of the path to my httpd daemon, I now get the following error when testing:

---------------------------------------------
waiting for server to start: .Syntax error on line 10 of /root/.cpan/build/Apache-Test-1.03/t/conf/httpd.conf:
Cannot load /usr/lib/apache/1.3/mod_log_config.so into server: /usr/lib/apache/1.3/mod_log_config.so: undefined symbol: ap_hook_status
!!! 
server has died with status 1 &#40;t/logs/error_log wasn&#39;t created, start the server in the debug mode&#41;
---------------------------------------------

Apparently my server needs to be configured for DSO support and have its modules compiled as DSO&#39;s. None of the docs mentioned these requirements and it is a surprising one given the fickleness of running mod_perl as a DSO &#40;which is why all of my modules are compiled into the daemon&#41;.

Anyhow, I saw in the README that I could create a custom httpd.conf file to use for testing. I copied the default t/conf/httpd.conf to t/conf/httpd.conf.in and removed the calls to LoadModule. I even deleted the original t/conf/httpd.conf file. However, my changes in the httpd.conf.in file were ignored when the new httpd.conf file was generated. Apparently the test is not using this file as its source for generating the httpd.conf file.

Thanks,
William
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;24&nbsp;12:00:29&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> william [...] knowmad.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Actually, reviewing the httpd.conf file further, it appears that my
httpd.conf.in file is being used. However, the following lines are being
appended to the top of the file &#40;which is why I am getting an error
starting the server&#41;:

---------------------------------
LoadModule config_log_module &#34;/usr/lib/apache/1.3/mod_log_config.so&#34;
LoadModule mime_magic_module &#34;/usr/lib/apache/1.3/mod_mime_magic.so&#34;
LoadModule mime_module &#34;/usr/lib/apache/1.3/mod_mime.so&#34;
LoadModule negotiation_module &#34;/usr/lib/apache/1.3/mod_negotiation.so&#34;
LoadModule status_module &#34;/usr/lib/apache/1.3/mod_status.so&#34;
LoadModule autoindex_module &#34;/usr/lib/apache/1.3/mod_autoindex.so&#34;
LoadModule dir_module &#34;/usr/lib/apache/1.3/mod_dir.so&#34;
LoadModule cgi_module &#34;/usr/lib/apache/1.3/mod_cgi.so&#34;
LoadModule userdir_module &#34;/usr/lib/apache/1.3/mod_userdir.so&#34;
LoadModule alias_module &#34;/usr/lib/apache/1.3/mod_alias.so&#34;
LoadModule rewrite_module &#34;/usr/lib/apache/1.3/mod_rewrite.so&#34;
LoadModule access_module &#34;/usr/lib/apache/1.3/mod_access.so&#34;
LoadModule auth_module &#34;/usr/lib/apache/1.3/mod_auth.so&#34;
LoadModule expires_module &#34;/usr/lib/apache/1.3/mod_expires.so&#34;
LoadModule unique_id_module &#34;/usr/lib/apache/1.3/mod_unique_id.so&#34;
LoadModule setenvif_module &#34;/usr/lib/apache/1.3/mod_setenvif.so&#34;

User    nobody
Group    nogroup
ServerName localhost
Port 8529
---------------------------------

Where are these getting set and how can I override them?

Thanks,
William
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;01&nbsp;19:28:43&nbsp;2003</span>
    <span class="description">stas+old [...] stason.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 01 Oct 2003 16:28:07 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stas Bekman &lt;stas [...] stason.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> test-dev [...] httpd.apache.org, bug-Apache-Test [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [Fwd: [cpan #3861] Custom t/conf/httpd.conf.in is ignored]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This message about Apache-Test was sent to you by guest &lt;&gt; via rt.cpan.org
&gt; 
&gt; Full context and any attached attachments can be found at:
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=3861">https://rt.cpan.org/Ticket/Display.html?id=3861</a></span> &gt;
&gt; 
&gt; Actually, reviewing the httpd.conf file further, it appears that my
&gt; httpd.conf.in file is being used. However, the following lines are being
&gt; appended to the top of the file &#40;which is why I am getting an error
&gt; starting the server&#41;:
&gt; 
&gt; ---------------------------------
&gt; LoadModule config_log_module &#34;/usr/lib/apache/1.3/mod_log_config.so&#34;
&gt; LoadModule mime_magic_module &#34;/usr/lib/apache/1.3/mod_mime_magic.so&#34;
&gt; LoadModule mime_module &#34;/usr/lib/apache/1.3/mod_mime.so&#34;
&gt; LoadModule negotiation_module &#34;/usr/lib/apache/1.3/mod_negotiation.so&#34;
&gt; LoadModule status_module &#34;/usr/lib/apache/1.3/mod_status.so&#34;
&gt; LoadModule autoindex_module &#34;/usr/lib/apache/1.3/mod_autoindex.so&#34;
&gt; LoadModule dir_module &#34;/usr/lib/apache/1.3/mod_dir.so&#34;
&gt; LoadModule cgi_module &#34;/usr/lib/apache/1.3/mod_cgi.so&#34;
&gt; LoadModule userdir_module &#34;/usr/lib/apache/1.3/mod_userdir.so&#34;
&gt; LoadModule alias_module &#34;/usr/lib/apache/1.3/mod_alias.so&#34;
&gt; LoadModule rewrite_module &#34;/usr/lib/apache/1.3/mod_rewrite.so&#34;
&gt; LoadModule access_module &#34;/usr/lib/apache/1.3/mod_access.so&#34;
&gt; LoadModule auth_module &#34;/usr/lib/apache/1.3/mod_auth.so&#34;
&gt; LoadModule expires_module &#34;/usr/lib/apache/1.3/mod_expires.so&#34;
&gt; LoadModule unique_id_module &#34;/usr/lib/apache/1.3/mod_unique_id.so&#34;
&gt; LoadModule setenvif_module &#34;/usr/lib/apache/1.3/mod_setenvif.so&#34;
&gt; 
&gt; User    nobody
&gt; Group    nogroup
&gt; ServerName localhost
&gt; Port 8529
&gt; ---------------------------------
&gt; 
&gt; Where are these getting set and how can I override them?
</div>
They are inherited from your httpd.conf installed system-wide. You probably 
have a stale one. Once you remove it it won&#39;t inherit them any longer.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">__________________________________________________________________
Stas Bekman            JAm_pH ------&gt; Just Another mod_perl Hacker
<span class="clickylink"><a target="new" rel="nofollow" href="http://stason.org/">http://stason.org/</a></span>     mod_perl Guide ---&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://perl.apache.org">http://perl.apache.org</a></span>
mailto:stas@stason.org <span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org">http://use.perl.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apacheweek.com">http://apacheweek.com</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://modperlbook.org">http://modperlbook.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apache.org">http://apache.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://ticketmaster.com">http://ticketmaster.com</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;01&nbsp;19:30:18&nbsp;2003</span>
    <span class="description">stas+old [...] stason.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 01 Oct 2003 16:29:42 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stas Bekman &lt;stas [...] stason.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> test-dev [...] httpd.apache.org, Guest via RT &lt;bug-Apache-Test [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #3861] Custom t/conf/httpd.conf.in is ignored</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This message about Apache-Test was sent to you by guest &lt;&gt; via rt.cpan.org
&gt; 
&gt; Full context and any attached attachments can be found at:
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=3861">https://rt.cpan.org/Ticket/Display.html?id=3861</a></span> &gt;
&gt; 
&gt; After getting past the hurdle of notifying A::Test of the path to my 
&gt; httpd daemon, I now get the following error when testing:
&gt; 
&gt; ---------------------------------------------
&gt; waiting for server to start: .Syntax error on line 10 of 
&gt; /root/.cpan/build/Apache-Test-1.03/t/conf/httpd.conf:
&gt; Cannot load /usr/lib/apache/1.3/mod_log_config.so into server: 
&gt; /usr/lib/apache/1.3/mod_log_config.so: undefined symbol: ap_hook_status
&gt; !!!
&gt; server has died with status 1 &#40;t/logs/error_log wasn&#39;t created, start 
&gt; the server in the debug mode&#41;
&gt; ---------------------------------------------
&gt; 
&gt; Apparently my server needs to be configured for DSO support and have its 
&gt; modules compiled as DSO&#39;s. None of the docs mentioned these requirements 
&gt; and it is a surprising one given the fickleness of running mod_perl as a 
&gt; DSO &#40;which is why all of my modules are compiled into the daemon&#41;.
</div>
No, as mentioned in the other followup. it inherits the httpd.conf settings 
from your global httpd.conf.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Anyhow, I saw in the README that I could create a custom httpd.conf file 
&gt; to use for testing. I copied the default t/conf/httpd.conf to 
&gt; t/conf/httpd.conf.in and removed the calls to LoadModule. I even deleted 
&gt; the original t/conf/httpd.conf file. However, my changes in the 
&gt; httpd.conf.in file were ignored when the new httpd.conf file was 
&gt; generated. Apparently the test is not using this file as its source for 
&gt; generating the httpd.conf file.
&gt; 
&gt; Thanks,
&gt; William
&gt; 
</div>

-- 


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">__________________________________________________________________
Stas Bekman            JAm_pH ------&gt; Just Another mod_perl Hacker
<span class="clickylink"><a target="new" rel="nofollow" href="http://stason.org/">http://stason.org/</a></span>     mod_perl Guide ---&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://perl.apache.org">http://perl.apache.org</a></span>
mailto:stas@stason.org <span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org">http://use.perl.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apacheweek.com">http://apacheweek.com</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://modperlbook.org">http://modperlbook.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apache.org">http://apache.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://ticketmaster.com">http://ticketmaster.com</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;03&nbsp;17:46:24&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[stas+old@stason.org - Wed Oct  1 19:28:43 2003]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; They are inherited from your httpd.conf installed system-wide. You 
&gt; probably have a stale one. Once you remove it it won&#39;t inherit them
&gt; any longer.
</div>
Yep, found and removed. Because I installed Apache as a package then
reinstalled manually to /usr/local, I had the original conf file in
/etc/apache/httpd.conf.

With that file removed, I tried again and did not get all the LoadModule
lines into my generated httpd.conf. However, I did continue to get the
following lines:
  User nobody
  Group nobody

I run my webserver as user www and don&#39;t know where these were being
pulled from. I grepped the files in Apache::Test and didn&#39;t come across
it either. However, I discovered that I could override the values as
follows:

  t/TEST -httpd /usr/local/apache/bin/httpd -User www -Group www


Thanks,
William
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;03&nbsp;18:09:53&nbsp;2003</span>
    <span class="description">stas [...] stason.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 03 Oct 2003 15:09:17 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stas Bekman &lt;stas [...] stason.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Apache-Test [...] rt.cpan.org, httpd-test-dev list &lt;test-dev [...] httpd.apache.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #3861] Custom t/conf/httpd.conf.in is ignored</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Guest via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This message about Apache-Test was sent to you by guest &lt;&gt; via rt.cpan.org
&gt; 
&gt; Full context and any attached attachments can be found at:
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=3861">https://rt.cpan.org/Ticket/Display.html?id=3861</a></span> &gt;
&gt; 
&gt; [stas+old@stason.org - Wed Oct  1 19:28:43 2003]:
&gt; 
<div class="message-stanza open">&gt;&gt;They are inherited from your httpd.conf installed system-wide. You 
&gt;&gt;probably have a stale one. Once you remove it it won&#39;t inherit them
&gt;&gt;any longer.
</div>&gt; 
&gt; 
&gt; Yep, found and removed. Because I installed Apache as a package then
&gt; reinstalled manually to /usr/local, I had the original conf file in
&gt; /etc/apache/httpd.conf.
</div>
It proves again and again that guessing is evil :&#40;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; With that file removed, I tried again and did not get all the LoadModule
&gt; lines into my generated httpd.conf. However, I did continue to get the
&gt; following lines:
&gt;   User nobody
&gt;   Group nobody
&gt; 
&gt; I run my webserver as user www and don&#39;t know where these were being
&gt; pulled from. I grepped the files in Apache::Test and didn&#39;t come across
&gt; it either. However, I discovered that I could override the values as
&gt; follows:
&gt; 
&gt;   t/TEST -httpd /usr/local/apache/bin/httpd -User www -Group www
</div>
The logic comes from: Apache-Test/lib/Apache/TestConfig.pm

If the server is run as non-root, it uses that user&#39;s uid/gid to configure. If 
run as root it tries &#39;nobody&#39;. We could add &#39;www&#39; as well, but someone may 
have both available, and others will have some other names. So again to avoid 
wrong guessing, probably the right solution is to inherit from the global 
httpd.conf, just like it inherits the LoadModule directives. Can you please 
try to fix that and send a patch?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">__________________________________________________________________
Stas Bekman            JAm_pH ------&gt; Just Another mod_perl Hacker
<span class="clickylink"><a target="new" rel="nofollow" href="http://stason.org/">http://stason.org/</a></span>     mod_perl Guide ---&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://perl.apache.org">http://perl.apache.org</a></span>
mailto:stas@stason.org <span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org">http://use.perl.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apacheweek.com">http://apacheweek.com</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://modperlbook.org">http://modperlbook.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apache.org">http://apache.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://ticketmaster.com">http://ticketmaster.com</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;03&nbsp;18:21:43&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> william [...] knowmad.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[STAS - Fri Oct  3 18:09:53 2003]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It proves again and again that guessing is evil :&#40;
</div>
LOL. Yeah, it&#39;s hard enough for an administrator to figure out how a
system is configured. Capturing all that knowledge into a pgm is very
difficult! At least it doesn&#39;t expose security risks like some systems
are prone to do when guessing ;-&gt;.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If the server is run as non-root, it uses that user&#39;s uid/gid to
&gt; configure. If
&gt; run as root it tries &#39;nobody&#39;. We could add &#39;www&#39; as well, but someone
&gt; may
&gt; have both available, and others will have some other names. So again
&gt; to avoid
&gt; wrong guessing, probably the right solution is to inherit from the
&gt; global
&gt; httpd.conf, just like it inherits the LoadModule directives. Can you
&gt; please
&gt; try to fix that and send a patch?
</div>
I&#39;d be glad to try. Looking at Apache::TestConfig.pm I see a sub called
default_user and default_group. Are these what I should be modifying?
Where do you read in the LoadModule lines from the httpd.conf, if
discovered? I&#39;d like to use that as a template for finding the User and
Group lines.

William

 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;03&nbsp;18:25:27&nbsp;2003</span>
    <span class="description">stas [...] stason.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 03 Oct 2003 15:24:50 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stas Bekman &lt;stas [...] stason.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Apache-Test [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> httpd-test-dev list &lt;test-dev [...] httpd.apache.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #3861] Custom t/conf/httpd.conf.in is ignored</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Guest via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This message about Apache-Test was sent to you by guest &lt;&gt; via rt.cpan.org
&gt; 
&gt; Full context and any attached attachments can be found at:
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=3861">https://rt.cpan.org/Ticket/Display.html?id=3861</a></span> &gt;
&gt; 
&gt; [STAS - Fri Oct  3 18:09:53 2003]:
&gt; 
<div class="message-stanza open">&gt;&gt;It proves again and again that guessing is evil :&#40;
</div>&gt; 
&gt; 
&gt; LOL. Yeah, it&#39;s hard enough for an administrator to figure out how a
&gt; system is configured. Capturing all that knowledge into a pgm is very
&gt; difficult! At least it doesn&#39;t expose security risks like some systems
&gt; are prone to do when guessing ;-&gt;.
</div>
Hopefully at the end we will get rid of all guesses, both in Apache-Test and 
modperl-2.0. I&#39;m big +1 on that.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;If the server is run as non-root, it uses that user&#39;s uid/gid to
&gt;&gt;configure. If
&gt;&gt;run as root it tries &#39;nobody&#39;. We could add &#39;www&#39; as well, but someone
&gt;&gt;may
&gt;&gt;have both available, and others will have some other names. So again
&gt;&gt;to avoid
&gt;&gt;wrong guessing, probably the right solution is to inherit from the
&gt;&gt;global
&gt;&gt;httpd.conf, just like it inherits the LoadModule directives. Can you
&gt;&gt;please
&gt;&gt;try to fix that and send a patch?
</div>&gt; 
&gt; 
&gt; I&#39;d be glad to try. Looking at Apache::TestConfig.pm I see a sub called
&gt; default_user and default_group. Are these what I should be modifying?
&gt; Where do you read in the LoadModule lines from the httpd.conf, if
&gt; discovered? I&#39;d like to use that as a template for finding the User and
&gt; Group lines.
</div>
You should be able to grep for this kind of tokens. It&#39;s coming from 
TestConfigParse.pm.

Thank you.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">__________________________________________________________________
Stas Bekman            JAm_pH ------&gt; Just Another mod_perl Hacker
<span class="clickylink"><a target="new" rel="nofollow" href="http://stason.org/">http://stason.org/</a></span>     mod_perl Guide ---&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://perl.apache.org">http://perl.apache.org</a></span>
mailto:stas@stason.org <span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org">http://use.perl.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apacheweek.com">http://apacheweek.com</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://modperlbook.org">http://modperlbook.org</a></span> <span class="clickylink"><a target="new" rel="nofollow" href="http://apache.org">http://apache.org</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://ticketmaster.com">http://ticketmaster.com</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;11&nbsp;21:26:54&nbsp;2003</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> william [...] knowmad.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[STAS - Fri Oct  3 18:25:27 2003]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; You should be able to grep for this kind of tokens. It&#39;s coming from
&gt; TestConfigParse.pm.
</div>
Hi Stas,

I&#39;ve finally had a chance to take another look at parsing the httpd.conf
file for the Group and User settings. I looked in the TestConfigParse.pm
file; there&#39;s some nice, but complex, code in that module.

From what I could figure out, the %wanted_config contains a hash of
hashes which is used to parse the config file. The TAKE1 group appears
to be made for retrieving a single key, so I added User and Group to
that list.

Now, however, I&#39;m stuck. If I dump the vars hashref after running
inherit_config, the values of User and Group are my user id &#39;william&#39;
&#40;despite the fact that I&#39;m running the script as root&#41;. I also looked at
the value of User when it was being parsed inside of the
inheret_config_file_or_directory sub. The script had the right values.  

I tried debugging but this part of the code is wrapped inside of an eval
which sets ulimit before calling the script again. Is there a way to
debug under this situation?

So, I&#39;m not sure what needs to happen to get the correct User and Group
values into the vars hash. Sorry it&#39;s been so long but hopefully you can
pick up the thread by reviewing the messages at rt.cpan.org.

Now that I think about it, it could be that the parsing routine is
getting the last User and Group values. Looking at my httpd.conf, this
appears to be the case. However, those are settings for a VirtualHost
which probably isn&#39;t what we want. We want the global User and Group
settings which is typically&#40;?&#41; going to be the first value. So, how to
skip further user and group lines in the parsing? Any suggestions?

Thanks,
William
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;17:39:31&nbsp;2003</span>
    <span class="description">stas [...] stason.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
