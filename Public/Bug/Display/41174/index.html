<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #41174 for Sys-Syslog: escape codes</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #41174 for Sys-Syslog: escape codes</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Sys-Syslog/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Sys-Syslog/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Sys-Syslog/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Sys-Syslog/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Sys-Syslog">Sys-Syslog CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">41174</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Sys-Syslog/Active/">Sys-Syslog</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MARKOV [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-30616-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.27    </td>
  </tr>
  <tr id="CF-30617-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;24&nbsp;05:21:15&nbsp;2008</span>
    <span class="description">MARKOV [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> escape codes</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Syslog is sloppy with character-sets.  Before logging a message, it
should get translated into latin1 or real utf-8 explicitly.  Besides,
escape codes must get filtered, as the following script will demonstrate

 #!/usr/bin/perl
 use Sys::Syslog;

 openlog &#39;test&#39;, &#39;&#39;, &#39;local0&#39;;
 syslog err =&gt; &#34;Test\a\033[2J\033[2;5m\033[1;31mHACKER~
    ATTACK\033[2;25m\033[22;30m\033[3q&#34;;

&#40;At least under Linux this has nice effects in de log-file&#41;

So: we need an option to explicitly specify in which character-set
to write the syslog.  Before translation, all non-printable need to
be replaced by something else.

Log-files are usually read by root, and it is simple to create an
escape sequence which insert characters in the terminal input stream;
be executed with super-user rights.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;25&nbsp;03:11:34&nbsp;2008</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Nov 2008 09:11:18 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Sys-Syslog [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Mark,


Mark Overmeer wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Syslog is sloppy with character-sets.  Before logging a message, it
&gt; should get translated into latin1 or real utf-8 explicitly.  Besides,
&gt; escape codes must get filtered, as the following script will  
&gt; demonstrate
&gt;
&gt;  #!/usr/bin/perl
&gt;  use Sys::Syslog;
&gt;
&gt;  openlog &#39;test&#39;, &#39;&#39;, &#39;local0&#39;;
&gt;  syslog err =&gt; &#34;Test\a\033[2J\033[2;5m\033[1;31mHACKER~
&gt;     ATTACK\033[2;25m\033[22;30m\033[3q&#34;;
&gt;
&gt; &#40;At least under Linux this has nice effects in de log-file&#41;
</div>
I guess this will set the terminal title to &#34;HACKER~ATTACK&#34;. Or is it  
doing something more evil?
Anyway, your point is valid.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So: we need an option to explicitly specify in which character-set
&gt; to write the syslog.  Before translation, all non-printable need to
&gt; be replaced by something else.
</div>
Agreed. However there is the same problem as with any module that  
must process random text: how can we know the encoding of the  
incoming text? Unconditionally transforming everything to Latin-1 or  
UTF-8 will surely produce junk. Possible solutions:
- transliterate each character outside ASCII into an ASCII equivalent  
with Text::Unidecode if available
- transform each character outside ASCII into its hexadecimal value  
&#40;&#34;é&#34; -&gt; \x{e9}
- expect parameters so the user provide the encoding of the message  
and the encoding of how Sys::Syslog should send the text

This is possible but will make the code more complex, and the current  
API isn&#39;t really extensible. Also having different behaviours  
depending on the installed modules may not please administrators,  
even if it&#39;s documented.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Log-files are usually read by root, and it is simple to create an
&gt; escape sequence which insert characters in the terminal input stream;
&gt; be executed with super-user rights.
</div>

I see two solutions: either strip the escape sequences &#40;which means  
being able to recognise them&#41;, or protect the backslashes so the  
administrator has a chance to safely see the attack. I would favour  
the later because it&#39;s simpler and faster to implement, and preserve  
more information.


-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;25&nbsp;03:11:35&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;25&nbsp;03:39:04&nbsp;2008</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Nov 2008 09:38:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni via RT &lt;bug-Sys-Syslog [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Hi Sébastien,

* Sébastien Aperghis-Tramoni via RT &#40;bug-Sys-Syslog@rt.cpan.org&#41; [081125 08:11]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=41174">http://rt.cpan.org/Ticket/Display.html?id=41174</a></span> &gt;
<div class="message-stanza open">&gt; &gt; Syslog is sloppy with character-sets.
&gt; &gt;
&gt; &gt;  openlog &#39;test&#39;, &#39;&#39;, &#39;local0&#39;;
</div>&gt; 
&gt; Agreed. However there is the same problem as with any module that  
&gt; must process random text: how can we know the encoding of the  
&gt; incoming text? Unconditionally transforming everything to Latin-1 or  
&gt; UTF-8 will surely produce junk.
</div>
There are two different problems:
  1 which character-set is used in the log-files.
  2 protecting the dangerous escapes

ad1&#41;
  Traditionally, logfiles are probably latin1 &#40;I think that is the
  best name for UNIX without any understanding of &gt;ASCII&#41;
  What I found-out in a little research, is that many &#40;free&#41; UNIXes
  have switched to utf-8 for the logfiles.

  The least what Sys::Syslog must do, is convert strings from an internal
  latin1/fake-utf8 mixture into a consequent charset.  Probably by
  default utf8.    syslog&#40;$level, &#34;%s&#34;, encode&#40;&#39;UTF-8&#39;, $string&#41;&#41;

ad2&#41;
  Replace non-printables with their ASCII-table name &#40;see &#39;man ascii&#39;&#41;
       000   0     00    NUL &#39;\0&#39;
       001   1     01    SOH
       002   2     02    STX
       003   3     03    ETX
       004   4     04    EOT
       005   5     05    ENQ
       006   6     06    ACK
       007   7     07    BEL &#39;\a&#39;
       010   8     08    BS  &#39;\b&#39;
       011   9     09    HT  &#39;\t&#39;
       012   10    0A    LF  &#39;\n&#39;
       013   11    0B    VT  &#39;\v&#39;
       014   12    0C    FF  &#39;\f&#39;
       015   13    0D    CR  &#39;\r&#39;
       016   14    0E    SO
       017   15    0F    SI
       020   16    10    DLE
       021   17    11    DC1
       022   18    12    DC2
       023   19    13    DC3
       024   20    14    DC4
       025   21    15    NAK
       026   22    16    SYN
       027   23    17    ETB
       030   24    18    CAN
       031   25    19    EM
       032   26    1A    SUB
       033   27    1B    ESC
       034   28    1C    FS             134   92    5C    \   &#39;\\&#39;
       035   29    1D    GS
       036   30    1E    RS
       037   31    1F    US  
                                        177   127   7F    DEL

  for instance &#34;\x1B&#34; -&gt;  &#34;&lt;esc&gt;&#34;
  For security reasons, this rewrite should be the default.
  I was looking for a module which does this, but couldn&#39;t find it yet.
  Probably, it should be an additions to the Encode suite.  This should
  not be an intergral part of Sys::Syslog itself.  Preferrably
  implemented in C for performance.

The cleanest way IMO is to add options to openlog.  Either as 4th
argument or inside $logopt:

   openlog &#39;myprog&#39;, &#39;pid,charset=latin1,unsafe&#39;, &#39;local0&#39;;
   # charset=none or raw to switch back to old behavior?

Yes, it will break some peoples applications... but now farmost Perl
programs are unsafe, especially in debug mode where all incoming
packages are being logged.

What do you think about it?
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;25&nbsp;03:41:42&nbsp;2008</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Nov 2008 09:41:32 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni via RT &lt;bug-Sys-Syslog [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Mark Overmeer &#40;mark@overmeer.net&#41; [081125 09:38]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt;    openlog &#39;myprog&#39;, &#39;pid,charset=latin1,unsafe&#39;, &#39;local0&#39;;
&gt;    # charset=none or raw to switch back to old behavior?
</div>
or maybe   &#34;encoding&#40;latin1&#41;&#34;   as in PerlIO
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;25&nbsp;19:48:33&nbsp;2008</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Nov 2008 01:48:15 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Sys-Syslog [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mark Overmeer wrote via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Sébastien,
</div>
Hello Mark,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; There are two different problems:
&gt;   1 which character-set is used in the log-files.
&gt;   2 protecting the dangerous escapes
&gt;
&gt; ad1&#41;
&gt;   Traditionally, logfiles are probably latin1 &#40;I think that is the
&gt;   best name for UNIX without any understanding of &gt;ASCII&#41;
&gt;   What I found-out in a little research, is that many &#40;free&#41; UNIXes
&gt;   have switched to utf-8 for the logfiles.
</div>
Maybe recent systems, but older systems didn&#39;t. You&#39;ll say that  
sysadmins of old systems don&#39;t upgrade their Perl modules, and I&#39;d  
agree, except sometimes, they do. So I can&#39;t really assume anything  
WRT encoding.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   The least what Sys::Syslog must do, is convert strings from an  
&gt; internal
&gt;   latin1/fake-utf8 mixture into a consequent charset.  Probably by
&gt;   default utf8.    syslog&#40;$level, &#34;%s&#34;, encode&#40;&#39;UTF-8&#39;, $string&#41;&#41;
</div>
I&#39;d say this is not the responsibility of Sys::Syslog but instead of  
the caller. People can&#39;t throw random text at Sys::Syslog and expect  
it to do the Right Thing by guessing the correct encoding. I can  
concur regarding the encoding of the messages sent by Sys::Syslog,  
but by default, I&#39;d say it&#39;d be better to do nothing and only  
transform to a specific encoding when asked to do so.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ad2&#41;
&gt;   Replace non-printables with their ASCII-table name &#40;see &#39;man ascii&#39;&#41;
&gt;        [...]
&gt;
&gt;   for instance &#34;\x1B&#34; -&gt;  &#34;&lt;esc&gt;&#34;
&gt;   For security reasons, this rewrite should be the default.
</div>
I fully agree on this. I can make a release with code to do this  
quite fast as I think nobody will oppose to such a change.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   I was looking for a module which does this, but couldn&#39;t find it  
&gt; yet.
</div>
Even if there was one, I couldn&#39;t use it in Sys::Syslog as it is a  
core module, and therefore I can only use module from the core.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   Probably, it should be an additions to the Encode suite.
</div>
I&#39;m unsure of this but you should ask Dan Kogai.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   This should not be an intergral part of Sys::Syslog itself.
</div>
It must for the reasons previously exposed. And given that  
Sys::Syslog is currently compatible with Perl 5.005, and I&#39;d like to  
keep this, I can only use core modules from this version of Perl.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   Preferrably implemented in C for performance.
</div>
Yes. But I&#39;ll probably first code it in Perl to check how it  
performs :-&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The cleanest way IMO is to add options to openlog.  Either as 4th
&gt; argument or inside $logopt:
&gt;
&gt;    openlog &#39;myprog&#39;, &#39;pid,charset=latin1,unsafe&#39;, &#39;local0&#39;;
&gt;    # charset=none or raw to switch back to old behavior?
&gt;
&gt; or maybe   &#34;encoding&#40;latin1&#41;&#34;   as in PerlIO
</div>
Clearly not &#34;charset&#34; as it is semantically incorrect and Juerd will  
beat me :-&#41;
Passing the encoding this way is quite ugly, but I guess I don&#39;t  
really have the choice: passing it as a 4th parameter or inside a  
hashref given as 4th parameters will mean two different ways to pass  
different options. Confusing.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yes, it will break some peoples applications... but now farmost Perl
&gt; programs are unsafe, especially in debug mode where all incoming
&gt; packages are being logged.
</div>
I am not allowed to break applications, because that means breaking  
things like SpamAssassin. Which means all the BOFH from the Perl  
community over my shoulder /o\

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What do you think about it?
</div>

I imagine you opened this ticket because to have a better I18N  
support in Log::Report.
As I said, I agree WRT replacing non-printable characters, and I  
mostly agree WRT the encoding, but for both changes I&#39;ll also seek  
advice from P5P.


-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;26&nbsp;03:25:27&nbsp;2008</span>
    <span class="description">webmaster [...] nlnet.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Nov 2008 09:25:13 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni via RT &lt;bug-Sys-Syslog [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> NLnet webmaster &lt;webmaster [...] nlnet.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Sébastien Aperghis-Tramoni via RT &#40;bug-Sys-Syslog@rt.cpan.org&#41; [081126 00:48]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=41174">http://rt.cpan.org/Ticket/Display.html?id=41174</a></span> &gt;
<div class="message-stanza open">&gt; &gt; ad1&#41;
&gt; &gt;   Traditionally, logfiles are probably latin1 &#40;I think that is the
&gt; &gt;   best name for UNIX without any understanding of &gt;ASCII&#41;
&gt; &gt;   What I found-out in a little research, is that many &#40;free&#41; UNIXes
&gt; &gt;   have switched to utf-8 for the logfiles.
</div>&gt; 
&gt; Maybe recent systems, but older systems didn&#39;t. You&#39;ll say that  
&gt; sysadmins of old systems don&#39;t upgrade their Perl modules, and I&#39;d  
&gt; agree, except sometimes, they do. So I can&#39;t really assume anything  
&gt; WRT encoding.
</div>
Well, luckily ASCII and UTF-8 overlap.  Character-encodings on
UNIX-systemwide level is a mess.  Windows made a good decission
to move to &#40;UTF16&#41; everywhere.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;   The least what Sys::Syslog must do, is convert strings from an  
&gt; &gt; internal
&gt; &gt;   latin1/fake-utf8 mixture into a consequent charset.  Probably by
&gt; &gt;   default utf8.    syslog&#40;$level, &#34;%s&#34;, encode&#40;&#39;UTF-8&#39;, $string&#41;&#41;
</div>&gt; 
&gt; I&#39;d say this is not the responsibility of Sys::Syslog but instead of  
&gt; the caller. People can&#39;t throw random text at Sys::Syslog and expect  
&gt; it to do the Right Thing by guessing the correct encoding. I can  
&gt; concur regarding the encoding of the messages sent by Sys::Syslog,  
&gt; but by default, I&#39;d say it&#39;d be better to do nothing and only  
&gt; transform to a specific encoding when asked to do so.
</div>
I do not know how to interpret this: do you suggest to make &#34;default
is raw&#34; or not have the Sys::Syslog::syslog&#40;&#41; encode at all?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; ad2&#41;
&gt; &gt;   Replace non-printables with their ASCII-table name &#40;see &#39;man ascii&#39;&#41;
&gt; &gt;        [...]
&gt; &gt;
&gt; &gt;   for instance &#34;\x1B&#34; -&gt;  &#34;&lt;esc&gt;&#34;
&gt; &gt;   For security reasons, this rewrite should be the default.
</div>&gt; 
&gt; I fully agree on this. I can make a release with code to do this  
&gt; quite fast as I think nobody will oppose to such a change.
</div>
That would be nice!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I was looking for a module which does this, but couldn&#39;t find it  
&gt; &gt; yet. Probably, it should be an additions to the Encode suite.
</div>&gt; Even if there was one, I couldn&#39;t use it in Sys::Syslog as it is a  
&gt; core module, and therefore I can only use module from the core.
&gt; 
&gt; I&#39;m unsure of this but you should ask Dan Kogai.
</div>
Encode is also in Core ;-&#41;   I have asked him via RT.  Waiting for a
response.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; or maybe   &#34;encoding&#40;latin1&#41;&#34;   as in PerlIO
</div>&gt; Clearly not &#34;charset&#34; as it is semantically incorrect and Juerd will  
&gt; beat me :-&#41;
</div>
&#34;encoding&#34; is a very bad name as well: too general.  But used
everywhere in Perl, so...  openlog&#40;&#41; following the binmode syntax
of open&#40;&#41; as far as possible cannot be a bad choice.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am not allowed to break applications, because that means breaking  
&gt; things like SpamAssassin. Which means all the BOFH from the Perl  
&gt; community over my shoulder /o\
</div>
I know... although not core modules, I have modules which are often
used as well.  On the other hand, Schwern is breaking the interface
of Test::More quite often :&#40;&#40;&#40;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I imagine you opened this ticket because to have a better I18N  
&gt; support in Log::Report.
&gt; As I said, I agree WRT replacing non-printable characters, and I  
&gt; mostly agree WRT the encoding, but for both changes I&#39;ll also seek  
&gt; advice from P5P.
</div>
Ok.  It will follow soon as two seperate items.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;26&nbsp;06:51:16&nbsp;2008</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Nov 2008 12:50:56 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni via RT &lt;bug-Sys-Syslog [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Sébastien Aperghis-Tramoni via RT &#40;bug-Sys-Syslog@rt.cpan.org&#41; [081126 00:48]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I imagine you opened this ticket because to have a better I18N  
&gt; support in Log::Report.
</div>
Well, Log::Report is very careful with encodings, and I would like
all back-ends to support it as well.  I was investigating it, and
then realized how dangerous my own programs are wrt syslog...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As I said, I agree WRT replacing non-printable characters, and I  
&gt; mostly agree WRT the encoding, but for both changes I&#39;ll also seek  
&gt; advice from P5P.
</div>
I have created to seperate tickets for this.  I could publish these
like that on P5P if you wish.  Or will they get published automatically?
-- 
               MarkOv
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;26&nbsp;10:31:06&nbsp;2008</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Nov 2008 16:30:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Sys-Syslog [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mark Overmeer wrote via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sebastien Aperghis-Tramoni wrote via RT:
&gt;
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt;   The least what Sys::Syslog must do, is convert strings from an
&gt; &gt; &gt; internal
&gt; &gt; &gt;   latin1/fake-utf8 mixture into a consequent charset.  Probably by
&gt; &gt; &gt;   default utf8.    syslog&#40;$level, &#34;%s&#34;, encode&#40;&#39;UTF-8&#39;, $string&#41;&#41;
</div>&gt; &gt;
&gt; &gt; I&#39;d say this is not the responsibility of Sys::Syslog but instead of
&gt; &gt; the caller. People can&#39;t throw random text at Sys::Syslog and expect
&gt; &gt; it to do the Right Thing by guessing the correct encoding. I can
&gt; &gt; concur regarding the encoding of the messages sent by Sys::Syslog,
&gt; &gt; but by default, I&#39;d say it&#39;d be better to do nothing and only
&gt; &gt; transform to a specific encoding when asked to do so.
</div>&gt;
&gt; I do not know how to interpret this: do you suggest to make &#34;default
&gt; is raw&#34; or not have the Sys::Syslog::syslog&#40;&#41; encode at all?
</div>
In a sense, yes. I want to avoid causing the problem that libnet did in
version 1.20, when Graham suddenly decided to utf8::encode&#40;&#41; everything
passing through Net::Cmd. Suddenly, all the mails generated by my programs
were double-encoded.
  » <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=24835">http://rt.cpan.org/Public/Bug/Display.html?id=24835</a></span>

Therefore I prefer to keep the current behaviour as the default, and be
smart and encode when asked to do so.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; I was looking for a module which does this, but couldn&#39;t find it
&gt; &gt; &gt; yet. Probably, it should be an additions to the Encode suite.
</div>&gt; &gt; Even if there was one, I couldn&#39;t use it in Sys::Syslog as it is a
&gt; &gt; core module, and therefore I can only use module from the core.
&gt; &gt;
&gt; &gt; I&#39;m unsure of this but you should ask Dan Kogai.
</div>&gt;
&gt; Encode is also in Core ;-&#41;   I have asked him via RT.  Waiting for a
&gt; response.
</div>
Encode is core since 5.8. Sys::Syslog is core since before 5.000 and the
current CPAN version is compatible with Perl 5.005
  » <span class="clickylink"><a target="new" rel="nofollow" href="http://bbbike.radzeit.de/~slaven/cpantestersmatrix.cgi?dist=Sys-Syslog">http://bbbike.radzeit.de/~slaven/cpantestersmatrix.cgi?dist=Sys-Syslog</a></span>

So Sys::Syslog can use Encode when it is available, but will have to work
without when it isn&#39;t.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; or maybe   &#34;encoding&#40;latin1&#41;&#34;   as in PerlIO
</div>&gt; &gt; Clearly not &#34;charset&#34; as it is semantically incorrect and Juerd will
&gt; &gt; beat me :-&#41;
</div>&gt;
&gt; &#34;encoding&#34; is a very bad name as well: too general.  But used
&gt; everywhere in Perl, so...  openlog&#40;&#41; following the binmode syntax
&gt; of open&#40;&#41; as far as possible cannot be a bad choice.
</div>
Agreed. Even if it&#39;s not the best term, let&#39;s be consistent :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I am not allowed to break applications, because that means breaking
&gt; &gt; things like SpamAssassin. Which means all the BOFH from the Perl
&gt; &gt; community over my shoulder /o\
</div>&gt;
&gt; I know... although not core modules, I have modules which are often
&gt; used as well.  On the other hand, Schwern is breaking the interface
&gt; of Test::More quite often :&#40;&#40;&#40;
</div>
To be honest I was only bitten once or twice by Schwern breaking Test::More.
Also, if it&#39;s an important module for the developpers, it is not as
important &#40;for the user or the sysadmin&#41; as modules that are used during
the true execution of programs, like libnet or Sys::Syslog.


-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;26&nbsp;10:42:18&nbsp;2008</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Nov 2008 16:42:05 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni via RT &lt;bug-Sys-Syslog [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Sébastien Aperghis-Tramoni via RT &#40;bug-Sys-Syslog@rt.cpan.org&#41; [081126 15:31]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=41174">http://rt.cpan.org/Ticket/Display.html?id=41174</a></span> &gt;
<div class="message-stanza open">&gt; &gt; I do not know how to interpret this: do you suggest to make &#34;default
&gt; &gt; is raw&#34; or not have the Sys::Syslog::syslog&#40;&#41; encode at all?
</div>&gt; 
&gt; In a sense, yes. I want to avoid causing the problem that libnet did in
&gt; version 1.20, when Graham suddenly decided to utf8::encode&#40;&#41; everything
&gt; passing through Net::Cmd. Suddenly, all the mails generated by my programs
&gt; were double-encoded.
&gt;   » <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=24835">http://rt.cpan.org/Public/Bug/Display.html?id=24835</a></span>
</div>
Net::Cmd is a much to general-purpose module to do character encodings.
Sys::Syslog is end-user material.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Therefore I prefer to keep the current behaviour as the default, and be
&gt; smart and encode when asked to do so.
</div>
Then you suggest that there are people who use syslog correctly w.r.t
character recoding?  Did you ever get complaints on the subject?  Then
probably no-one does realize it yet.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Encode is also in Core ;-&#41;   I have asked him via RT.  Waiting for a
&gt; &gt; response.
</div>&gt; 
&gt; Encode is core since 5.8. Sys::Syslog is core since before 5.000 and the
&gt; current CPAN version is compatible with Perl 5.005
&gt;   » <span class="clickylink"><a target="new" rel="nofollow" href="http://bbbike.radzeit.de/~slaven/cpantestersmatrix.cgi?dist=Sys-Syslog">http://bbbike.radzeit.de/~slaven/cpantestersmatrix.cgi?dist=Sys-Syslog</a></span>
&gt; 
&gt; So Sys::Syslog can use Encode when it is available, but will have to work
&gt; without when it isn&#39;t.
</div>
In older versions, Encode doesn&#39;t work at all... it is easy to avoid
using it.

  BEGIN {
     if&#40; $[ &gt;= 5.008 &#41;
     {   require Encode;
         Encode-&gt;import&#40;&#39;encode&#39;&#41;;
     }
     else
     {   *encode = sub { shift };
     }
  }

-- 
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;26&nbsp;12:05:01&nbsp;2008</span>
    <span class="description">maddingue [...] free.fr -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Nov 2008 18:04:46 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Sys-Syslog [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;maddingue [...] free.fr&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mark Overmeer wrote via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sebastien Aperghis-Tramoni wrote via RT:
&gt;
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; I do not know how to interpret this: do you suggest to make &#34;default
&gt; &gt; &gt; is raw&#34; or not have the Sys::Syslog::syslog&#40;&#41; encode at all?
</div>&gt; &gt;
&gt; &gt; In a sense, yes. I want to avoid causing the problem that libnet did in
&gt; &gt; version 1.20, when Graham suddenly decided to utf8::encode&#40;&#41; everything
&gt; &gt; passing through Net::Cmd. Suddenly, all the mails generated by my programs
&gt; &gt; were double-encoded.
&gt; &gt;   » <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=24835">http://rt.cpan.org/Public/Bug/Display.html?id=24835</a></span>
</div>&gt;
&gt; Net::Cmd is a much to general-purpose module to do character encodings.
&gt; Sys::Syslog is end-user material.
</div>
I agree, Net::Cmd isn&#39;t for the end-user, but it is only one layer below
end-user modules &#40;Net::SMTP, Net::FTP&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Therefore I prefer to keep the current behaviour as the default, and be
&gt; &gt; smart and encode when asked to do so.
</div>&gt;
&gt; Then you suggest that there are people who use syslog correctly w.r.t
&gt; character recoding?  Did you ever get complaints on the subject?  Then
&gt; probably no-one does realize it yet.
</div>
Most tickets can be summed up with &#34;it doesn&#39;t work&#34;. No one complained
about an encoding problem. I can&#39;t tell whether it just works or if nobody
realised there is a problem.


-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;26&nbsp;12:05:57&nbsp;2008</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #41174] escape codes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Nov 2008 18:05:47 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Sys-Syslog [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mark Overmeer wrote via RT:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sebastien Aperghis-Tramoni wrote via RT:
&gt;
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; I do not know how to interpret this: do you suggest to make &#34;default
&gt; &gt; &gt; is raw&#34; or not have the Sys::Syslog::syslog&#40;&#41; encode at all?
</div>&gt; &gt;
&gt; &gt; In a sense, yes. I want to avoid causing the problem that libnet did in
&gt; &gt; version 1.20, when Graham suddenly decided to utf8::encode&#40;&#41; everything
&gt; &gt; passing through Net::Cmd. Suddenly, all the mails generated by my programs
&gt; &gt; were double-encoded.
&gt; &gt;   » <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=24835">http://rt.cpan.org/Public/Bug/Display.html?id=24835</a></span>
</div>&gt;
&gt; Net::Cmd is a much to general-purpose module to do character encodings.
&gt; Sys::Syslog is end-user material.
</div>
I agree, Net::Cmd isn&#39;t for the end-user, but it is only one layer below
end-user modules &#40;Net::SMTP, Net::FTP&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Therefore I prefer to keep the current behaviour as the default, and be
&gt; &gt; smart and encode when asked to do so.
</div>&gt;
&gt; Then you suggest that there are people who use syslog correctly w.r.t
&gt; character recoding?  Did you ever get complaints on the subject?  Then
&gt; probably no-one does realize it yet.
</div>
Most tickets can be summed up with &#34;it doesn&#39;t work&#34;. No one complained
about an encoding problem. I can&#39;t tell whether it just works or if nobody
realised there is a problem.


-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
