<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #114809 for Time-HiRes: Time::HiRes should override `utime` to allow setting hires access and modification times</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #114809 for Time-HiRes: Time::HiRes should override `utime` to allow setting hires access and modification times</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Time-HiRes/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Time-HiRes/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Time-HiRes/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Time-HiRes/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Time-HiRes">Time-HiRes CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">114809</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Time-HiRes/Active/">Time-HiRes</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
andrew [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-33448-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.9733    </td>
  </tr>
  <tr id="CF-33449-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




ifndef_perl_ck_warner.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1640934/879821/ifndef_perl_ck_warner.patch">
Wed Jun 22 11:35:46 2016 (130b) by pereira.m [...] gmail.com
</a>
</font></li>
</ul>


Time-HiRes-1.9736.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1640757/879716/Time-HiRes-1.9736.tar.gz">
Tue Jun 21 19:45:05 2016 (91.6k) by JHI [...] cpan.org
</a>
</font></li>
</ul>


Time-HiRes-utime-1.9733.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1631823/874408/Time-HiRes-utime-1.9733.patch">
Sun May 29 15:41:53 2016 (13.8k) by andrew [...] cpan.org
</a>
</font></li>
</ul>


Time_Hires_cpan_installation_failure.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1640605/879636/Time_Hires_cpan_installation_failure.txt">
Tue Jun 21 11:13:33 2016 (8.6k) by pereira.m [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;29&nbsp;15:41:53&nbsp;2016</span>
    <span class="description">andrew [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Time::HiRes should override `utime` to allow setting hires access
 and modification times</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This patch adds support for setting higher-precision timestamps via `utime` using futimens for file descriptors and utimensat for files.

Tests pass on OpenBSD-current under both perl 5.20.2 and perl 5.22.2.

I look forward to critiques as I am my XS skills are pretty new.

<span class="clickylink"><a target="new" rel="nofollow" href="http://man.openbsd.org/futimens.2">http://man.openbsd.org/futimens.2</a></span>
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Time-HiRes-utime-1.9733.patch</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;20&nbsp;07:21:59&nbsp;2016</span>
    <span class="description">JHI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun May 29 15:41:53 2016, ANDREW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This patch adds support for setting higher-precision timestamps via
&gt; `utime` using futimens for file descriptors and utimensat for files.
&gt; 
&gt; Tests pass on OpenBSD-current under both perl 5.20.2 and perl 5.22.2.
&gt; 
&gt; I look forward to critiques as I am my XS skills are pretty new.
</div>
First round looked pretty good, one small issue: in a system without neither futimens nor utimensat&#40;&#41;
&#40;OS X&#41; I get a warning:

HiRes.c:1886:2: warning: declaration does not declare anything
      [-Wmissing-declarations]
        NV;
        ^~

Looks like the &#34;NV nsec&#34; in the utime&#40;&#41; fallback is unused, so I&#39;ll remove that.

However, some portability issues: IS_SAFE_PATHNAME&#40;&#41; seems not be available in some older Perls.  I&#39;ll look into it.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://man.openbsd.org/futimens.2">http://man.openbsd.org/futimens.2</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;20&nbsp;07:21:59&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;20&nbsp;08:11:22&nbsp;2016</span>
    <span class="description">JHI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jun 20 07:21:59 2016, JHI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sun May 29 15:41:53 2016, ANDREW wrote:
<div class="message-stanza open">&gt; &gt; This patch adds support for setting higher-precision timestamps via
&gt; &gt; `utime` using futimens for file descriptors and utimensat for files.
&gt; &gt;
&gt; &gt; Tests pass on OpenBSD-current under both perl 5.20.2 and perl 5.22.2.
&gt; &gt;
&gt; &gt; I look forward to critiques as I am my XS skills are pretty new.
</div>&gt; 
&gt; First round looked pretty good, one small issue: in a system without
&gt; neither futimens nor utimensat&#40;&#41;
&gt; &#40;OS X&#41; I get a warning:
&gt; 
&gt; HiRes.c:1886:2: warning: declaration does not declare anything
&gt;       [-Wmissing-declarations]
&gt;         NV;
&gt;         ^~
&gt; 
&gt; Looks like the &#34;NV nsec&#34; in the utime&#40;&#41; fallback is unused, so I&#39;ll
&gt; remove that.
&gt; 
&gt; However, some portability issues: IS_SAFE_PATHNAME&#40;&#41; seems not be
&gt; available in some older Perls.  I&#39;ll look into it.
&gt; 
&gt; 
<div class="message-stanza open">&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://man.openbsd.org/futimens.2">http://man.openbsd.org/futimens.2</a></span>
</div></div>
I&#39;m dubious of this logic:

+    if &#40;exists $Config{d_hires_utime}&#41; {
+       $has_utimensat++ if $Config{d_hires_utime}; # Unlikely...

and the same for futimens.  We should not from the general imply the specific.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;20&nbsp;09:03:07&nbsp;2016</span>
    <span class="description">andrew [...] afresh1.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #114809] Time::HiRes should override `utime` to allow setting hires access and modification times</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 20 Jun 2016 06:02:53 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Jarkko_Hietaniemi via RT &lt;bug-Time-HiRes [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andrew Fresh &lt;andrew [...] afresh1.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Jun 20, 2016 at 08:11:27AM -0400, Jarkko_Hietaniemi via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m dubious of this logic:
&gt; 
&gt; +    if &#40;exists $Config{d_hires_utime}&#41; {
&gt; +       $has_utimensat++ if $Config{d_hires_utime}; # Unlikely...
&gt; 
&gt; and the same for futimens.  We should not from the general imply the specific.
</div>
Agreed, I thought I fixed that.  Oops!

-- 
andrew - <span class="clickylink"><a target="new" rel="nofollow" href="http://afresh1.com">http://afresh1.com</a></span>

Hey, I think I see a barn up ahead.
                      -- The American Astronaut
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;11:13:33&nbsp;2016</span>
    <span class="description">pereira.m [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> pereira.m [...] gmail.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jun 20 07:21:59 2016, JHI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, some portability issues: IS_SAFE_PATHNAME&#40;&#41; seems not be
&gt; available in some older Perls.  I&#39;ll look into it.
</div>
Hi,

The current workaround for IS_SAFE_PATHNAME &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/JHI/Time-HiRes-1.9735/HiRes.xs#L927&#41;">https://metacpan.org/source/JHI/Time-HiRes-1.9735/HiRes.xs#L927&#41;</a></span> breaks the installation of this module on Centos 6.5 with Perl 5.010001

The problem is related to the use of the Perl_ck_warner function which seems to be unavailable in this version of perl.

The relevant excerpts from the complete log &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://gist.githubusercontent.com/MichaelPereira/cf998fb316f2741ce30e5f5cd8a4067e/raw/c9a03e34057d6a51e8008c806850070dc748c598/gistfile1.txt">https://gist.githubusercontent.com/MichaelPereira/cf998fb316f2741ce30e5f5cd8a4067e/raw/c9a03e34057d6a51e8008c806850070dc748c598/gistfile1.txt</a></span> also attached to the message&#41;:

&lt;Compilation call of HiRes.c&gt;
HiRes.xs: In function ‘XS_Time__HiRes_utime’:
HiRes.xs:1378: warning: implicit declaration of function ‘Perl_ck_warner’

&lt;In each test compilation&gt;
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/nanosleep.t line 4

By any chance, would you know of a way to rewrite the problematic line to avoid using this function?

Thanks for your help
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Time_Hires_cpan_installation_failure.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">cpanm &#40;App::cpanminus&#41; 1.7042 on perl 5.010001 built for x86_64-linux-thread-multi
Work directory is /root/.cpanm/work/1466518127.22818
You have make /usr/bin/make
You have LWP 5.833
You have /bin/tar: tar &#40;GNU tar&#41; 1.23
Copyright &#40;C&#41; 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a></span>&gt;.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by John Gilmore and Jay Fenlason.
You have /usr/bin/unzip
Searching Time::HiRes &#40;&#41; on cpanmetadb ...
--&gt; Working on Time::HiRes
Fetching <span class="clickylink"><a target="new" rel="nofollow" href="http://www.cpan.org/authors/id/J/JH/JHI/Time-HiRes-1.9735.tar.gz">http://www.cpan.org/authors/id/J/JH/JHI/Time-HiRes-1.9735.tar.gz</a></span>
-&gt; OK
Unpacking Time-HiRes-1.9735.tar.gz
Entering Time-HiRes-1.9735
Checking configure dependencies from META.json
Checking if you have ExtUtils::MakeMaker 6.58 ... Yes &#40;7.18&#41;
Configuring Time-HiRes-1.9735
Running Makefile.PL
Configuring Time::HiRes...
Using hints hints/linux.pl...
Extra libraries: -lrt...
Have syscall&#40;&#41;... looking for syscall.h... found &lt;syscall.h&gt;.
Looking for gettimeofday&#40;&#41;... found.
Looking for setitimer&#40;&#41;... found.
Looking for getitimer&#40;&#41;... found.
You have interval timers &#40;both setitimer and getitimer&#41;.
Looking for ualarm&#40;&#41;... found.
Looking for usleep&#40;&#41;... found.
Looking for nanosleep&#40;&#41;... testing... found.
You can mix subsecond sleeps with signals, if you want to.
You seem to have stat&#40;&#41; subsecond timestamps.
&#40;Your struct stat has them, but the filesystems must help.&#41;
Checking if your kit is complete...
Looks good
Generating a Unix-style Makefile
Writing Makefile for Time::HiRes
Writing MYMETA.yml and MYMETA.json
Now you may issue &#39;make&#39;.  Do not forget also &#39;make test&#39;.
-&gt; OK
Checking dependencies from MYMETA.json ...
Checking if you have strict 0 ... Yes &#40;1.04&#41;
Checking if you have Test::More 0.82 ... Yes &#40;1.302022&#41;
Checking if you have ExtUtils::MakeMaker 0 ... Yes &#40;7.18&#41;
Checking if you have DynaLoader 0 ... Yes &#40;1.10&#41;
Checking if you have Config 0 ... Yes &#40;undef&#41;
Checking if you have Exporter 0 ... Yes &#40;5.63&#41;
Checking if you have Carp 0 ... Yes &#40;1.11&#41;
Building and testing Time-HiRes-1.9735
cp HiRes.pm blib/lib/Time/HiRes.pm
Running Mkbootstrap for HiRes &#40;&#41;
chmod 644 &#34;HiRes.bs&#34;
&#34;/usr/bin/perl&#34; -MExtUtils::Command::MM -e &#39;cp_nonempty&#39; -- HiRes.bs blib/arch/auto/Time/HiRes/HiRes.bs 644
&#34;/usr/bin/perl&#34; &#34;/usr/share/perl5/ExtUtils/xsubpp&#34;  -typemap &#39;/usr/share/perl5/ExtUtils/typemap&#39; -typemap &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/typemap&#39;  HiRes.xs &gt; HiRes.xsc
mv HiRes.xsc HiRes.c
gcc -c   -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic   -DVERSION=\&#34;1.9735\&#34; -DXS_VERSION=\&#34;1.9735\&#34; -fPIC &#34;-I/usr/lib64/perl5/CORE&#34;  -DTIME_HIRES_NANOSLEEP -DTIME_HIRES_CLOCK_GETTIME -DTIME_HIRES_CLOCK_GETRES -DTIME_HIRES_CLOCK_NANOSLEEP -DTIME_HIRES_CLOCK -DHAS_FUTIMENS -DHAS_UTIMENSAT -DTIME_HIRES_UTIME -DTIME_HIRES_STAT_XTIM -DTIME_HIRES_STAT=4 -DATLEASTFIVEOHOHFIVE HiRes.c
HiRes.xs: In function ‘XS_Time__HiRes_utime’:
HiRes.xs:1378: warning: implicit declaration of function ‘Perl_ck_warner’
HiRes.c: In function ‘XS_Time__HiRes_constant’:
./const-xs.inc:11: warning: ‘iv’ may be used uninitialized in this function
./const-xs.inc:11: note: ‘iv’ was declared here
rm -f blib/arch/auto/Time/HiRes/HiRes.so
LD_RUN_PATH=&#34;/lib64&#34; gcc  -shared -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -o blib/arch/auto/Time/HiRes/HiRes.so  HiRes.o  \
           -lrt   \

chmod 755 blib/arch/auto/Time/HiRes/HiRes.so
Manifying 1 pod document
&#34;/usr/bin/perl&#34; -MExtUtils::Command::MM -e &#39;cp_nonempty&#39; -- HiRes.bs blib/arch/auto/Time/HiRes/HiRes.bs 644
PERL_DL_NONLAZY=1 &#34;/usr/bin/perl&#34; &#34;-MExtUtils::Command::MM&#34; &#34;-MTest::Harness&#34; &#34;-e&#34; &#34;undef *Test::Harness::Switches; test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/alarm.t ......... ok
t/clock.t ......... ok
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/gettimeofday.t line 4
Compilation failed in require at t/gettimeofday.t line 4.
BEGIN failed--compilation aborted at t/gettimeofday.t line 9.
t/gettimeofday.t ..
Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/itimer.t line 14
Compilation failed in require at t/itimer.t line 14.
BEGIN failed--compilation aborted at t/itimer.t line 26.
t/itimer.t ........
Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/nanosleep.t line 4
Compilation failed in require at t/nanosleep.t line 4.
BEGIN failed--compilation aborted at t/nanosleep.t line 9.
t/nanosleep.t .....
Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run
t/sleep.t ......... ok
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/stat.t line 4
Compilation failed in require at t/stat.t line 4.
BEGIN failed--compilation aborted at t/stat.t line 14.
t/stat.t ..........
Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run
t/time.t .......... ok
t/tv_interval.t ... ok
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/ualarm.t line 4
Compilation failed in require at t/ualarm.t line 4.
BEGIN failed--compilation aborted at t/ualarm.t line 9.
t/ualarm.t ........
Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/usleep.t line 4
Compilation failed in require at t/usleep.t line 4.
BEGIN failed--compilation aborted at t/usleep.t line 9.
t/usleep.t ........
Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run
Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes: /root/.cpanm/work/1466518127.22818/Time-HiRes-1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol: Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
 at t/utime.t line 4
BEGIN failed--compilation aborted at t/utime.t line 9.
t/utime.t .........
Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run

Test Summary Report
-------------------
t/gettimeofday.t &#40;Wstat: 65280 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 255
  Parse errors: No plan found in TAP output
t/itimer.t      &#40;Wstat: 65280 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 255
  Parse errors: No plan found in TAP output
t/nanosleep.t   &#40;Wstat: 65280 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 255
  Parse errors: No plan found in TAP output
t/stat.t        &#40;Wstat: 65280 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 255
  Parse errors: No plan found in TAP output
t/ualarm.t      &#40;Wstat: 65280 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 255
  Parse errors: No plan found in TAP output
t/usleep.t      &#40;Wstat: 65280 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 255
  Parse errors: No plan found in TAP output
t/utime.t       &#40;Wstat: 65280 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 255
  Parse errors: No plan found in TAP output
Files=12, Tests=23, 10 wallclock secs &#40; 0.04 usr  0.01 sys +  4.56 cusr  0.04 csys =  4.65 CPU&#41;
Result: FAIL
Failed 7/12 test programs. 0/23 subtests failed.
make: *** [test_dynamic] Error 255
-&gt; FAIL Installing Time::HiRes failed. See /root/.cpanm/work/1466518127.22818/build.log for details. Retry with --force to force install it.

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;19:45:05&nbsp;2016</span>
    <span class="description">JHI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oh, rats.  Please try the attached.  Note that despite what it is claiming it is not yet the final official Time-HiRes 1.9736.

On Tue Jun 21 11:13:33 2016, pereira.m@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Jun 20 07:21:59 2016, JHI wrote:
<div class="message-stanza open">&gt; &gt; However, some portability issues: IS_SAFE_PATHNAME&#40;&#41; seems not be
&gt; &gt; available in some older Perls.  I&#39;ll look into it.
</div>&gt; 
&gt; Hi,
&gt; 
&gt; The current workaround for IS_SAFE_PATHNAME
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/JHI/Time-HiRes-1.9735/HiRes.xs#L927&#41;">https://metacpan.org/source/JHI/Time-HiRes-1.9735/HiRes.xs#L927&#41;</a></span>
&gt; breaks the installation of this module on Centos 6.5 with Perl
&gt; 5.010001
&gt; 
&gt; The problem is related to the use of the Perl_ck_warner function which
&gt; seems to be unavailable in this version of perl.
&gt; 
&gt; The relevant excerpts from the complete log
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://gist.githubusercontent.com/MichaelPereira/cf998fb316f2741ce30e5f5cd8a4067e/raw/c9a03e34057d6a51e8008c806850070dc748c598/gistfile1.txt">https://gist.githubusercontent.com/MichaelPereira/cf998fb316f2741ce30e5f5cd8a4067e/raw/c9a03e34057d6a51e8008c806850070dc748c598/gistfile1.txt</a></span>
&gt; also attached to the message&#41;:
&gt; 
&gt; &lt;Compilation call of HiRes.c&gt;
&gt; HiRes.xs: In function ‘XS_Time__HiRes_utime’:
&gt; HiRes.xs:1378: warning: implicit declaration of function
&gt; ‘Perl_ck_warner’
&gt; 
&gt; &lt;In each test compilation&gt;
&gt; Can&#39;t load &#39;/root/.cpanm/work/1466518127.22818/Time-HiRes-
&gt; 1.9735/blib/arch/auto/Time/HiRes/HiRes.so&#39; for module Time::HiRes:
&gt; /root/.cpanm/work/1466518127.22818/Time-HiRes-
&gt; 1.9735/blib/arch/auto/Time/HiRes/HiRes.so: undefined symbol:
&gt; Perl_ck_warner at /usr/lib64/perl5/DynaLoader.pm line 200.
&gt;  at t/nanosleep.t line 4
&gt; 
&gt; By any chance, would you know of a way to rewrite the problematic line
&gt; to avoid using this function?
&gt; 
&gt; Thanks for your help
</div></div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Time-HiRes-1.9736.tar.gz</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1640757/879716/Time-HiRes-1.9736.tar.gz">Download Time-HiRes-1.9736.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gzip 91.6k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;22&nbsp;11:35:46&nbsp;2016</span>
    <span class="description">pereira.m [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> pereira.m [...] gmail.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jun 21 19:45:05 2016, JHI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Oh, rats.  Please try the attached.  Note that despite what it is
&gt; claiming it is not yet the final official Time-HiRes 1.9736.
</div>
Hi JHI,

Thanks for the quick reply time. Unfortunately I am still getting the same error. The reason is that contrary to what is being shown at the top of the error log:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; cpanm &#40;App::cpanminus&#41; 1.7042 on perl 5.010001 built for x86_64-linux-thread-multi
</div>
The version of perl installed on the system is:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;[root@centos65-test-8 Time-HiRes-1.9736]# perl --version
&gt;
&gt;This is perl, v5.10.1 &#40;*&#41; built for x86_64-linux-thread-multi
</div>
In the modified #ifndef, I can get it to work by replacing the PERL_VERSION check from 10 to 11:

[root@centos65-test-8 Time-HiRes-1.9736]# diff HiRes.c.1.9736 HiRes.c
940c940
&lt; #if PERL_VERSION &gt;= 10 /* Perl_ck_warner is 5.10.0 -&gt; */
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; #if PERL_VERSION &gt;= 11 /* Perl_ck_warner is 5.11.0 -&gt; */
</div>

But I am unable to find in which version exactly was Perk_ck_warner introduced, so I&#39;m not sure if this is going to work for people with Perl 5.11.

With the modified check, the rest of the setup runs correctly in my case.

Thanks again,
Michael
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ifndef_perl_ck_warner.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">940c940
&lt; #if PERL_VERSION &gt;= 10 /* Perl_ck_warner is 5.10.0 -&gt; */
---
&gt; #if PERL_VERSION &gt;= 11 /* Perl_ck_warner is 5.11.0 -&gt; */
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;22&nbsp;13:27:20&nbsp;2016</span>
    <span class="description">jhi [...] iki.fi -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #114809] Time::HiRes should override `utime` to allow setting hires access and modification times</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 22 Jun 2016 13:27:07 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Time-HiRes [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jarkko Hietaniemi &lt;jhi [...] iki.fi&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wednesday-201606-22 11:35, pereira.m@gmail.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for the quick reply time. Unfortunately I am still getting the same error. The reason is that contrary to what is being shown at the top of the error log:
&gt;
<div class="message-stanza open">&gt;&gt; &gt; cpanm &#40;App::cpanminus&#41; 1.7042 on perl 5.010001 built for x86_64-linux-thread-multi
</div>&gt; The version of perl installed on the system is:
&gt;
</div>
That is strange.  At least according to the perl source code archive of 
Perl 5.10.0 Perl_ck_warner was available in that version.

And this: &#34;perl 5.010001&#34; does mean 5.10.1, it&#39;s well-defined that way:
&#40;a + b / 1000 + c / 1000000&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;29&nbsp;21:44:11&nbsp;2016</span>
    <span class="description">JHI [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;30&nbsp;15:23:55&nbsp;2016</span>
    <span class="description">pereira.m [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> pereira.m [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I confirm that everything is good with Time-HiRes-1.9739.

Thanks a lot for the changes
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
