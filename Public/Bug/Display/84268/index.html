<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #84268 for Win32-API: Win32::API: Bug/Exception in call_asm_x86_msvc.asm</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #84268 for Win32-API: Win32::API: Bug/Exception in call_asm_x86_msvc.asm</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Win32-API">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Win32-API">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Win32-API">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Win32-API">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-API">Win32-API CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">84268</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Win32-API">Win32-API</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rkeuchel [...] allgeier.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35436-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35437-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




imageb271b8.JPG<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1195785/631058/imageb271b8.JPG">
Thu Mar 28 13:42:02 2013 (12.6k) by rkeuchel [...] allgeier.com
</a>
</font></li>
</ul>


smime.p7s<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1200012/633536/smime.p7s">
Tue Apr 09 04:56:26 2013 (1.9k) by rkeuchel [...] allgeier.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/1195898/631136/smime.p7s">
Thu Mar 28 17:11:32 2013 (1.9k) by rkeuchel [...] allgeier.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/1195785/631059/smime.p7s">
Thu Mar 28 13:42:02 2013 (1.9k) by rkeuchel [...] allgeier.com
</a>
</font></li>
</ul>


Win32-API-WINCE.rar<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1196046/631229/Win32-API-WINCE.rar">
Fri Mar 29 06:24:29 2013 (34k) by keuchel [...] rainer-keuchel.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=84268">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1195785" href="/Public/Bug/Display.html?id=84268#txn-1195785">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;28&nbsp;13:42:02&nbsp;2013</span>
    <span class="description">rkeuchel [...] allgeier.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Win32::API: Bug/Exception in call_asm_x86_msvc.asm</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Mar 2013 17:41:36 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Keuchel, Rainer&#34; &lt;rkeuchel [...] allgeier.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195785/631056/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631056">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I get an exception in call_asm_x86_msvc.asm, raised at bad_esp.
ESP and EBP do not match.

Using the C version works. Why is the ASM-Version the default for MSVC?

I compiled a fresh perl for testing and debugging this.
The called DLL is also built with MSVC 16 and uses WINAPI calling convention.

The signature is:
Win32::API-&gt;Import&#40;&#34;svapi32_vc100.dll&#34;,  &#39;ULONG svapi_connect&#40;LPVOID hsv,LPSTR s1,LPSTR s2,LPSTR s3,LPSTR s4,LPSTR s5,LPSTR s6,LPSTR s7,LPSTR s8,LPSTR s9, LPSTR s10&#41;&#39;&#41;;


Compiler: Microsoft &#40;R&#41; 32-bit C/C++ Optimizing Compiler Version 16.00.40219.01 for 80x86

Build Log:

                nmake -f Makefile all -nologo
                C:\perl\5.16.3\bin\perl.exe C:\Perl\5.16.3\lib\ExtUtils\xsubpp  -typemap C:\perl\5.16.3\lib\ExtUtils\typemap  Callback.xs &gt; Callback.xsc &#38;&#38; C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e mv -- Callback.xsc Callback.c
                cl -c    -GS- -nologo -GF -W3 -Od -MD -Zi -DDEBUGGING -DWIN32 -D_CONSOLE -DNO_STRICT -D_CRT_SECURE_NO_DEPRECATE -D_CRT_NONSTDC_NO_DEPRECATE -DPERL_TEXTMODE_SCRIPTS -DUSE_PERLIO -Od -MD -Zi -DDEBUGGING    -DVERSION=\&#34;0.76_01\&#34;  -DXS_VERSION=\&#34;0.76_01\&#34;  &#34;-IC:\perl\5.16.3\lib\CORE&#34;   Callback.c
Callback.c
Running Mkbootstrap for Win32::API::Callback &#40;&#41;
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e chmod -- 644 Callback.bs
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Mksymlists  -e &#34;Mksymlists&#40;&#39;NAME&#39;=&gt;\&#34;Win32::API::Callback\&#34;, &#39;DLBASE&#39; =&gt; &#39;Callback&#39;, &#39;DL_FUNCS&#39; =&gt; {  }, &#39;FUNCLIST&#39; =&gt; [], &#39;IMPORTS&#39; =&gt; {  }, &#39;DL_VARS&#39; =&gt; []&#41;;&#34;
                link -out:..\blib\arch\auto\Win32\API\Callback\Callback.dll -dll -nologo -nodefaultlib -debug  -libpath:&#34;c:\perl\5.16.3\lib\CORE&#34;  -machine:x86 &#34;/manifestdependency:type=&#39;Win32&#39; name=&#39;Microsoft.Windows.Common-Controls&#39; version=&#39;6.0.0.0&#39; processorArchitecture=&#39;*&#39; publicKeyToken=&#39;6595b64144ccf1df&#39; language=&#39;*&#39;&#34; Callback.obj   C:\perl\5.16.3\lib\CORE\perl516.lib oldnames.lib kernel32.lib user32.lib gdi32.lib winspool.lib  comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib  netapi32.lib uuid.lib ws2_32.lib mpr.lib winmm.lib  version.lib odbc32.lib odbccp32.lib comctl32.lib msvcrt.lib -def:Callback.def
   Creating library ..\blib\arch\auto\Win32\API\Callback\Callback.lib and object ..\blib\arch\auto\Win32\API\Callback\Callback.exp
                if exist ..\blib\arch\auto\Win32\API\Callback\Callback.dll.manifest mt -nologo -manifest ..\blib\arch\auto\Win32\API\Callback\Callback.dll.manifest -outputresource:..\blib\arch\auto\Win32\API\Callback\Callback.dll;2
                if exist ..\blib\arch\auto\Win32\API\Callback\Callback.dll.manifest del ..\blib\arch\auto\Win32\API\Callback\Callback.dll.manifest
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e chmod -- 755 ..\blib\arch\auto\Win32\API\Callback\Callback.dll
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e cp -- Callback.bs ..\blib\arch\auto\Win32\API\Callback\Callback.bs
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e chmod -- 644 ..\blib\arch\auto\Win32\API\Callback\Callback.bs
                cd ..
                C:\perl\5.16.3\bin\perl.exe C:\Perl\5.16.3\lib\ExtUtils\xsubpp  -nolinenumbers  -typemap C:\perl\5.16.3\lib\ExtUtils\typemap -typemap typemap  API.xs &gt; API.xsc &#38;&#38; C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e mv -- API.xsc API.c
                cl -c    -GS- -nologo -GF -W3 -Od -MD -Zi -DDEBUGGING -DWIN32 -D_CONSOLE -DNO_STRICT -D_CRT_SECURE_NO_DEPRECATE -D_CRT_NONSTDC_NO_DEPRECATE -DPERL_TEXTMODE_SCRIPTS -DUSE_PERLIO -Od -MD -Zi -DDEBUGGING    -DVERSION=\&#34;0.76_01\&#34;  -DXS_VERSION=\&#34;0.76_01\&#34;  &#34;-IC:\perl\5.16.3\lib\CORE&#34;   API.c
API.c
                ml -Zi -c call_asm_x86_msvc.asm
Assembling: call_asm_x86_msvc.asm
Running Mkbootstrap for Win32::API &#40;&#41;
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e chmod -- 644 API.bs
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Mksymlists  -e &#34;Mksymlists&#40;&#39;NAME&#39;=&gt;\&#34;Win32::API\&#34;, &#39;DLBASE&#39; =&gt; &#39;API&#39;, &#39;DL_FUNCS&#39; =&gt; {  }, &#39;FUNCLIST&#39; =&gt; [], &#39;IMPORTS&#39; =&gt; {  }, &#39;DL_VARS&#39; =&gt; []&#41;;&#34;
                link -out:blib\arch\auto\Win32\API\API.dll -dll -nologo -nodefaultlib -debug  -libpath:&#34;c:\perl\5.16.3\lib\CORE&#34;  -machine:x86 &#34;/manifestdependency:type=&#39;Win32&#39; name=&#39;Microsoft.Windows.Common-Controls&#39; version=&#39;6.0.0.0&#39; processorArchitecture=&#39;*&#39; publicKeyToken=&#39;6595b64144ccf1df&#39; language=&#39;*&#39;&#34; API.obj call_asm_x86_msvc.obj   C:\perl\5.16.3\lib\CORE\perl516.lib oldnames.lib kernel32.lib user32.lib gdi32.lib winspool.lib  comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib  netapi32.lib uuid.lib ws2_32.lib mpr.lib winmm.lib  version.lib odbc32.lib odbccp32.lib comctl32.lib msvcrt.lib -def:API.def
   Creating library blib\arch\auto\Win32\API\API.lib and object blib\arch\auto\Win32\API\API.exp
                if exist blib\arch\auto\Win32\API\API.dll.manifest mt -nologo -manifest blib\arch\auto\Win32\API\API.dll.manifest -outputresource:blib\arch\auto\Win32\API\API.dll;2
                if exist blib\arch\auto\Win32\API\API.dll.manifest del blib\arch\auto\Win32\API\API.dll.manifest
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e chmod -- 755 blib\arch\auto\Win32\API\API.dll
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e cp -- API.bs blib\arch\auto\Win32\API\API.bs
                C:\perl\5.16.3\bin\perl.exe -MExtUtils::Command -e chmod -- 644 blib\arch\auto\Win32\API\API.bs




Rainer Keuchel
Entwicklungsleiter
Enterprise Content Management
[cid:imageb271b8.JPG@f9d174aa.46bf0687]
Allgeier IT Solutions GmbH
Hans-Bredow-Str. 60
28307 Bremen

Tel: +49 &#40;421&#41; 43841294
Fax: +49 &#40;421&#41; 438419294
E-Mail: rkeuchel@allgeier.com
Internet: www.allgeier-it.de

ALLGEIER IT SOLUTIONS GmbH
Amtsgericht Bremen | HRB 25242
GeschÃ¤ftsfÃ¼hrer: Hubert Rohrer, Johannes HÃ¤ringslack, Ralf Nitzgen
St.-Nr. 71/551/06446 | USt.-ID-Nr. DE114397847
Diese E-Mail enthÃ¤lt vertrauliche und/oder rechtlich geschÃ¼tzte Informationen. Wenn Sie nicht der richtige Adressat sind oder diese E-Mail irrtÃ¼mlich erhalten haben, informieren Sie bitte sofort den Absender und vernichten Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe dieser E-Mail sind nicht gestattet.
This message &#40;and any associated files&#41; is intended only for the use of bug-Win32-API@rt.cpan.org and may contain information that is confidential, subject to copyright or constitutes a trade secret. If you are not bug-Win32-API@rt.cpan.org you are hereby notified that any dissemination, copying or distribution of this message, or files associated with this message, is strictly prohibited. If you have received this message in error, please notify us immediately by replying to the message and deleting it from your computer. Any views or opinions presented are solely those of the author rkeuchel@allgeier.com and do not necessarily represent those of the company.


</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195785/631057/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631057">with headers</a>
<br />
<span class="downloadcontenttype">text/html 16.5k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195785/631058/imageb271b8.JPG">Download imageb271b8.JPG</a><br />
<span class="downloadcontenttype">image/jpeg 12.6k</span>
</div>
<div class="messagebody">
<img alt="imageb271b8.JPG" title="imageb271b8.JPG" src="/Ticket/Attachment/1195785/631058/" /></div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195785/631059/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/x-pkcs7-signature 1.9k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1195852" href="/Public/Bug/Display.html?id=84268#txn-1195852">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;28&nbsp;15:58:57&nbsp;2013</span>
    <span class="description">BULKDD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195852/631104/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631104">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Mar 28 13:42:02 2013, rkeuchel@allgeier.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I get an exception in call_asm_x86_msvc.asm, raised at bad_esp.
&gt; ESP
&gt;    and EBP do not match.
</div>
Your prototype is wrong. Either the func in the DLL is actually __cdecl because it doesn&#39;t explicitly say __stdcall or WINAPI in each declaration and wasn&#39;t compiled with -Gz and the default in Win32::API is always __stdcall unless specified otherwise &#40;this is the opposite of Visual C and GCC&#39;s defaults&#41;, or it is a __stdcall which takes a different amount of args than you specified in the prototype string.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Using the C version works. Why is the ASM-
&gt;    Version the default for MSVC?
&gt; 
</div>
The inline assembly version was very inefficient compared to the ideal design, the inline assembly version copied the same data between memory and register 2-4 times redundantly before writing it to memory for the final time, also the call instruction appears 3 different times &#40;but called only once&#41; in the inline assembly version instead of once. The C version &#40;still used with GCC&#41; doesn&#39;t compare ESP to EBP to find wrong prototypes yet &#40;not sure if the C version ever will&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I compiled a fresh perl for
&gt;    testing and debugging this.
&gt; The called DLL is also built with MSVC
&gt;    16 and uses WINAPI calling convention.
</div>
Are you sure?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; The signature is:
&gt;    Win32::API-&gt;Import&#40;&#34;svapi32_vc100.dll&#34;,  &#39;ULONG
&gt;    svapi_connect&#40;LPVOID hsv,LPSTR s1,LPSTR s2,LPSTR s3,LPSTR s4,LPSTR
&gt;    s5,LPSTR s6,LPSTR s7,LPSTR s8,LPSTR s9, LPSTR s10&#41;&#39;&#41;;
</div>

The above is probably a __cdecl in the DLL since __stdcall isn&#39;t specified anywhere and -Gr and -Gz weren&#39;t used &#40;-Gd wasn&#39;t used either, but it is on by default&#41;. I made a test function below to try your prototype.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">_______________________________________________

API_TEST_API ULONG svapi_connect&#40;LPVOID hsv,LPSTR s1,LPSTR s2,LPSTR s3,
        LPSTR s4,LPSTR s5,LPSTR s6,LPSTR s7,LPSTR s8,LPSTR s9, LPSTR s10&#41; {
    if&#40;hsv == 0x0
       &#38;&#38; atoi&#40;s1&#41; == 1
       &#38;&#38; atoi&#40;s2&#41; == 2
       &#38;&#38; atoi&#40;s3&#41; == 3
       &#38;&#38; atoi&#40;s4&#41; == 4
       &#38;&#38; atoi&#40;s5&#41; == 5
       &#38;&#38; atoi&#40;s6&#41; == 6
       &#38;&#38; atoi&#40;s7&#41; == 7
       &#38;&#38; atoi&#40;s8&#41; == 8
       &#38;&#38; atoi&#40;s9&#41; == 9
       &#38;&#38; atoi&#40;s10&#41; == 10&#41;
        return 2;
    else{
        DebugBreak&#40;&#41;;
        return 0;
    }
}
<div class="message-stanza open">___________________________________________________
this is fine, notice I changed the 1st parameter from LPVOID to ULONG &#40;LPVOID is a char * in Win32::API, not an opaque pointer as normally thought of LPVOID&#41;
<div class="message-stanza open">_______________________________________________
use Win32::API;
    Win32::API-&gt;Import&#40;&#34;api_test.dll&#34;,  &#39;ULONG __cdecl svapi_connect&#40;ULONG &#39;
.&#39;hsv,LPSTR s1,LPSTR s2,LPSTR s3,LPSTR s4,LPSTR s5,LPSTR s6,LPSTR s7,LPSTR s8,&#39;
.&#39;LPSTR s9, LPSTR s10&#41;&#39;&#41;;
    
die &#34;bad return&#34; if svapi_connect&#40;0..10&#41; != 2;
<div class="message-stanza open">_______________________________________________


This causes &#34;Unhandled exception at 0x7c812afb in perl.exe: 0xC0000028: An invalid or unaligned stack was encountered during an unwind operation.&#34; with 0.76_01. 
<div class="message-stanza open">_______________________________________________
use Win32::API;
    Win32::API-&gt;Import&#40;&#34;api_test.dll&#34;,  &#39;ULONG svapi_connect&#40;ULONG &#39;
.&#39;hsv,LPSTR s1,LPSTR s2,LPSTR s3,LPSTR s4,LPSTR s5,LPSTR s6,LPSTR s7,LPSTR s8,&#39;
.&#39;LPSTR s9, LPSTR s10&#41;&#39;&#41;;
    
die &#34;bad return&#34; if svapi_connect&#40;0..10&#41; != 2;
<div class="message-stanza open">_______________________________________________

I plan to change the RaiseException to a Perl catchable croak based on the opinions in <span class="clickylink"><a target="new" rel="nofollow" href="http://perlmonks.org/?node_id=1024423">http://perlmonks.org/?node_id=1024423</a></span> in a future  0.76_02. Also I might switch the RaiseException to a DebugBreak since RaiseException uses alot of C autos and changes esp/ebp alot &#40;but ebp sort of points to the incoming args to RaiseException from Call_asm&#41;. Do you have another opinion of what to do when there is a prototype mistake?
</div></div></div></div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1195855" href="/Public/Bug/Display.html?id=84268#txn-1195855">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;28&nbsp;15:58:58&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1195898" href="/Public/Bug/Display.html?id=84268#txn-1195898">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;28&nbsp;17:11:32&nbsp;2013</span>
    <span class="description">rkeuchel [...] allgeier.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #84268] Win32::API: Bug/Exception in call_asm_x86_msvc.asm</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Mar 2013 21:11:16 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Keuchel, Rainer&#34; &lt;rkeuchel [...] allgeier.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195898/631135/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631135">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It&#39;s really stdcall. Sorry, I should have checked this..

Maybe I was biased because it worked in my old 5.14 ActiveState-Perl, which
probably used the C version of &#34;call&#34; or an old asm version.

I recompiled Win32::API for getting WriteMemory&#40;&#41;, which was missing in the AS build.

And others also use the DLL from C# so I thought it would be stdcall..


unsigned int __cdecl svapi_connect&#40;...&#41;

push    ebp
mov     ebp, esp
push    0FFFFFFFEh
push    offset stru_1006F560
push    offset __except_handler4
mov     eax, large fs:0
push    eax
add     esp, 0FFFFFF68h
mov     eax, ___security_cookie
xor     [ebp+ms_exc.registration.ScopeTable], eax
xor     eax, ebp
mov     [ebp+var_24], eax
push    ebx
push    esi
push    edi
push    eax
lea     eax, [ebp+ms_exc.registration]
mov     large fs:0, eax
mov     [ebp+ms_exc.old_esp], esp

...

mov     ecx, [ebp+ms_exc.registration.Next]
mov     large fs:0, ecx
pop     ecx
pop     edi
pop     esi
pop     ebx
mov     ecx, [ebp+var_24]
xor     ecx, ebp        ; cookie
call    @__security_check_cookie@4 ; __security_check_cookie&#40;x&#41;
mov     esp, ebp
pop     ebp
retn


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I plan to change the RaiseException to a Perl catchable croak based on the opinions in <span class="clickylink"><a target="new" rel="nofollow" href="http://perlmonks.org/?node_id=1024423">http://perlmonks.org/?node_id=1024423</a></span> in a future  0.76_02. Also &gt; I might switch the RaiseException to a DebugBreak since RaiseException uses alot of C autos and changes esp/ebp alot &#40;but ebp sort of points to the
&gt; incoming args to RaiseException from Call_asm&#41;.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Do you have another opinion of what to do when there is a prototype mistake?
</div>
Yes, a DebugBreak&#40;&#41; woud be nice to find the reg mismatch, but most people i.e. using an ActiveState-Build of Perl
would not have debug syms.

Maybe do the DebugBreak&#40;&#41; when IsDebuggerPresent&#40;&#41; is true, else use croak.
You could call IsDebuggerPresent&#40;&#41; when api.dll is loaded.

Thanks for your help and your work!






Rainer Keuchel
Entwicklungsleiter
Enterprise Content Management

Allgeier IT Solutions GmbH
Hans-Bredow-Str. 60
28307 Bremen

Tel: +49 &#40;421&#41; 43841294
Fax: +49 &#40;421&#41; 438419294
E-Mail: rkeuchel@allgeier.com
Internet: www.allgeier-it.de

ALLGEIER IT SOLUTIONS GmbH
Amtsgericht Bremen | HRB 20924
GeschÃ¤ftsfÃ¼hrer: Hubert Rohrer, Johannes HÃ¤ringslack, Ralf Nitzgen
St.-Nr. 803/11449 | USt.-ID-Nr. DE114397847

Diese E-Mail enthÃ¤lt vertrauliche und/oder rechtlich geschÃ¼tzte Informationen. Wenn Sie nicht der richtige Adressat sind oder diese E-Mail irrtÃ¼mlich erhalten haben, informieren Sie bitte sofort den Absender und vernichten Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe dieser E-Mail sind nicht gestattet.

This message &#40;and any associated files&#41; is intended only for the use
of bug-Win32-API@rt.cpan.org and may contain information that is confidential, subject to copyright or constitutes a trade secret. If you are not bug-Win32-API@rt.cpan.org you are hereby notified that any dissemination, copying or distribution of this message, or files associated with this message, is strictly prohibited. If you have received this message in error, please notify us immediately by replying to the message and deleting it from your computer. Any
views or opinions presented are solely those of the author rkeuchel@allgeier.com and do not necessarily represent those of the
company.


</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195898/631136/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/x-pkcs7-signature 1.9k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1195908" href="/Public/Bug/Display.html?id=84268#txn-1195908">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;28&nbsp;17:42:02&nbsp;2013</span>
    <span class="description">BULKDD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195908/631141/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631141">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Mar 28 17:11:32 2013, rkeuchel@allgeier.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It&#39;s really stdcall. Sorry, I should have checked this..
</div>
Then why does it crash for you if it really is stdcall?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Maybe I
&gt;    was biased because it worked in my old 5.14 ActiveState-Perl, which
&gt;    probably used the C version of &#34;call&#34; or an old asm version.
</div>
Previous versions of Win32::API as far as I remember, didn&#39;t care if it was __cdecl or __stdcall, original esp from the XSUB is copied back in asm, &#34;esp = *&#40;void **&#41;ebp; ebp = *&#40;void **&#41;esp; esp -= 4;&#34; AKA &#34;leave&#34; or &#34;mov esp, [ebp]; pop esp&#34;, so what the called C func left esp at was actually irrelevant &#40;it can be esp == 0, and Call_asm didn&#39;t care&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I
&gt;    recompiled Win32::API for getting WriteMemory&#40;&#41;, which was missing
&gt;    in the AS build.
</div>
OT: &#34;unpack&#40;&#39;P&#39;,&#34; can read any memory, but you can&#39;t write to random memory from core Perl. The undocumented RtlMoveMemory in kernel32.dll in old Win32::APIs &#40;0.68 and older&#41; had to be cludgingly used before. Internet grapevine says RtlMoveMemory exists for VB Classic programmers to use. So I added a WriteMemory so that foreign memory allocators can more easily be used &#40;some C func wants a LocalAlloc memory block to take ownership of and free when it wants, not malloc or Newx &#40;PV buffer&#41;&#41;. 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; And others also use the DLL from C# so I
&gt;    thought it would be stdcall..
&gt; 
&gt; 
&gt; unsigned int __cdecl
&gt;    svapi_connect&#40;...&#41;
&gt; 
&gt; push    ebp
&gt; mov     ebp, esp
&gt; push
&gt;    0FFFFFFFEh
&gt; push    offset stru_1006F560
&gt; push    offset
&gt;    __except_handler4
&gt; mov     eax, large fs:0
&gt; push    eax
&gt; add
&gt;    esp, 0FFFFFF68h
&gt; mov     eax, ___security_cookie
&gt; xor
&gt;    [ebp+ms_exc.registration.ScopeTable], eax
&gt; xor     eax, ebp
&gt; mov
&gt;    [ebp+var_24], eax
&gt; push    ebx
&gt; push    esi
&gt; push    edi
&gt; push
&gt;    eax
&gt; lea     eax, [ebp+ms_exc.registration]
&gt; mov     large fs:0,
&gt;    eax
&gt; mov     [ebp+ms_exc.old_esp], esp
&gt; 
&gt; ...
&gt; 
&gt; mov     ecx,
&gt;    [ebp+ms_exc.registration.Next]
&gt; mov     large fs:0, ecx
&gt; pop
&gt;    ecx
&gt; pop     edi
&gt; pop     esi
&gt; pop     ebx
&gt; mov     ecx,
&gt;    [ebp+var_24]
&gt; xor     ecx, ebp        ; cookie
&gt; call
&gt;    @__security_check_cookie@4 ; __security_check_cookie&#40;x&#41;
&gt; mov
&gt;    esp, ebp
&gt; pop     ebp
&gt; retn
&gt; 
</div>
This is a __cdecl function, &#34;retn&#34; would have a number after it if was a __stdcall.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; I plan to change the
</div>&gt;    RaiseException to a Perl catchable croak based on the opinions in
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="http://perlmonks.org/?node_id=1024423">http://perlmonks.org/?node_id=1024423</a></span> in a future  0.76_02. Also &gt;
&gt;    I might switch the RaiseException to a DebugBreak since
&gt;    RaiseException uses alot of C autos and changes esp/ebp alot &#40;but
&gt;    ebp sort of points to the
<div class="message-stanza open">&gt; &gt; incoming args to RaiseException from
</div>&gt;    Call_asm&#41;.
&gt; 
<div class="message-stanza open">&gt; &gt; Do you have another opinion of what to do when
</div>&gt;    there is a prototype mistake?
&gt; 
&gt; Yes, a DebugBreak&#40;&#41; woud be nice
&gt;    to find the reg mismatch, but most people i.e. using an
&gt;    ActiveState-Build of Perl
&gt; would not have debug syms.
</div>
You can sort-of, barely really, figure it out by just going to memory watch window, put &#34;esp&#34; as the address, set view to &#34;4 byte integers&#34; then do mental arthmitic &#40;I think&#41; to put back esp 4 bytes back &#40;return address from DebugBreak&#40;&#41;&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Maybe do
&gt;    the DebugBreak&#40;&#41; when IsDebuggerPresent&#40;&#41; is true, else use croak.
&gt;    You could call IsDebuggerPresent&#40;&#41; when api.dll is loaded.
&gt;    Thanks for your help and your work!
&gt; 
</div>
I like that idea, I forgot IsDebuggerPresent exists. Thanks for the idea.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1195972" href="/Public/Bug/Display.html?id=84268#txn-1195972">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;29&nbsp;00:35:42&nbsp;2013</span>
    <span class="description">BULKDD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1195972/631181/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631181">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 652b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Mar 28 17:11:32 2013, rkeuchel@allgeier.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It&#39;s really stdcall. Sorry, I should have checked this..
&gt; 
&gt; Maybe I
&gt;    was biased because it worked in my old 5.14 ActiveState-Perl, which
&gt;    probably used the C version of &#34;call&#34; or an old asm version.
&gt; 
&gt; I
&gt;    recompiled Win32::API for getting WriteMemory&#40;&#41;, which was missing
&gt;    in the AS build.
</div>
If you are the same Rainer Keuchel as in <span class="clickylink"><a target="new" rel="nofollow" href="http://tech.groups.yahoo.com/group/wince-devel/message/459">http://tech.groups.yahoo.com/group/wince-devel/message/459</a></span> , could you provide/attach what was in <span class="clickylink"><a target="new" rel="nofollow" href="http://www.rainer-keuchel.de/wince/perl-win32-api.tar.gz">http://www.rainer-keuchel.de/wince/perl-win32-api.tar.gz</a></span> ? I&#39;d like to integrate what was in there &#40;ARM support&#41; into the official Win32::API.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1196046" href="/Public/Bug/Display.html?id=84268#txn-1196046">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;29&nbsp;06:24:29&nbsp;2013</span>
    <span class="description">keuchel [...] rainer-keuchel.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AW: [rt.cpan.org #84268] Win32::API: Bug/Exception in call_asm_x86_msvc.asm</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 29 Mar 2013 11:21:07 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Rainer Keuchel&#34; &lt;keuchel [...] rainer-keuchel.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1196046/631227/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631227">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 552b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here is the old code.. Unfortunatly there is no assembly magic. It just calls several functions with different numbers of args from 1 to 10.
 

If you are the same Rainer Keuchel as in  &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://tech.groups.yahoo.com/group/wince-devel/message/459">http://tech.groups.yahoo.com/group/wince-devel/message/459</a></span>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://tech.groups.yahoo.com/group/wince-devel/message/459">http://tech.groups.yahoo.com/group/wince-devel/message/459</a></span> , could you provide/attach what was in  &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.rainer-keuchel.de/wince/perl-win32-api.tar.gz">http://www.rainer-keuchel.de/wince/perl-win32-api.tar.gz</a></span>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.rainer-keuchel.de/wince/perl-win32-api.tar.gz">http://www.rainer-keuchel.de/wince/perl-win32-api.tar.gz</a></span> ? I&#39;d like to integrate what was in there &#40;ARM support&#41; into the official Win32::API.
 
 
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1196046/631228/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/631228">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.4k</span>
</div>
<div class="messagebody">
</div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1196046/631229/Win32-API-WINCE.rar">Download Win32-API-WINCE.rar</a><br />
<span class="downloadcontenttype">application/octet-stream 34k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1199968" href="/Public/Bug/Display.html?id=84268#txn-1199968">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;09&nbsp;01:09:13&nbsp;2013</span>
    <span class="description">BULKDD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> keuchel [...] rainer-keuchel.de</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1199968/633500/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633500">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 322b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Mar 29 06:24:29 2013, keuchel@rainer-keuchel.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here is the old code.. Unfortunatly there is no assembly magic. It
&gt;    just calls several functions with different numbers of args from 1
&gt;    to 10.
&gt; 
</div>
Thank you for the ARM code. Are you still having x86/x64 Win32::API problems or can I close the ticket?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200012" href="/Public/Bug/Display.html?id=84268#txn-1200012">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;09&nbsp;04:56:26&nbsp;2013</span>
    <span class="description">rkeuchel [...] allgeier.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AW: [rt.cpan.org #84268] Win32::API: Bug/Exception in call_asm_x86_msvc.asm</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 9 Apr 2013 08:56:07 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Keuchel, Rainer&#34; &lt;rkeuchel [...] allgeier.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200012/633535/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633535">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">You can close the ticket, cdecl works..



Mit freundlichen GrÃ¼ssen

Rainer Keuchel





Rainer Keuchel
Entwicklungsleiter
Enterprise Content Management

Allgeier IT Solutions GmbH
Hans-Bredow-Str. 60
28307 Bremen

Tel: +49 &#40;421&#41; 43841294
Fax: +49 &#40;421&#41; 438419294
E-Mail: rkeuchel@allgeier.com
Internet: www.allgeier-it.de

ALLGEIER IT SOLUTIONS GmbH
Amtsgericht Bremen | HRB 20924
GeschÃ¤ftsfÃ¼hrer: Hubert Rohrer, Johannes HÃ¤ringslack, Ralf Nitzgen
St.-Nr. 803/11449 | USt.-ID-Nr. DE114397847

Diese E-Mail enthÃ¤lt vertrauliche und/oder rechtlich geschÃ¼tzte Informationen. Wenn Sie nicht der richtige Adressat sind oder diese E-Mail irrtÃ¼mlich erhalten haben, informieren Sie bitte sofort den Absender und vernichten Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte Weitergabe dieser E-Mail sind nicht gestattet.

This message &#40;and any associated files&#41; is intended only for the use
of bug-Win32-API@rt.cpan.org and may contain information that is confidential, subject to copyright or constitutes a trade secret. If you are not bug-Win32-API@rt.cpan.org you are hereby notified that any dissemination, copying or distribution of this message, or files associated with this message, is strictly prohibited. If you have received this message in error, please notify us immediately by replying to the message and deleting it from your computer. Any
views or opinions presented are solely those of the author rkeuchel@allgeier.com and do not necessarily represent those of the
company.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----UrsprÃ¼ngliche Nachricht-----
Von: Daniel Dragan via RT [mailto:bug-Win32-API@rt.cpan.org]
Gesendet: Dienstag, 9. April 2013 07:09
An: Keuchel, Rainer
Betreff: [rt.cpan.org #84268] Win32::API: Bug/Exception in call_asm_x86_msvc.asm

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=84268">https://rt.cpan.org/Ticket/Display.html?id=84268</a></span> &gt;

On Fri Mar 29 06:24:29 2013, keuchel@rainer-keuchel.de wrote:
<div class="message-stanza open">&gt; Here is the old code.. Unfortunatly there is no assembly magic. It
&gt;    just calls several functions with different numbers of args from 1
&gt;    to 10.
&gt;
</div>
Thank you for the ARM code. Are you still having x86/x64 Win32::API problems or can I close the ticket?
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200012/633536/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/x-pkcs7-signature 1.9k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200414" href="/Public/Bug/Display.html?id=84268#txn-1200414">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;09&nbsp;22:28:45&nbsp;2013</span>
    <span class="description">BULKDD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200414/633740/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633740">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 7b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Closed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200418" href="/Public/Bug/Display.html?id=84268#txn-1200418">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;09&nbsp;22:28:46&nbsp;2013</span>
    <span class="description">BULKDD [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.765358</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
