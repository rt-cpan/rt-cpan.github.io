<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #48008 for Win32-SystemInfo: Incorrect use of Win32::API::Struct sizeof</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #48008 for Win32-SystemInfo: Incorrect use of Win32::API::Struct sizeof</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Win32-SystemInfo">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Win32-SystemInfo">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Win32-SystemInfo">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Win32-SystemInfo">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-SystemInfo">Win32-SystemInfo CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">48008</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Win32-SystemInfo">Win32-SystemInfo</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">cjohnston [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
steven.hartland [...] multiplay.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-35790-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.11    </td>
  </tr>
  <tr id="CF-35791-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=48008">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-634903" href="/Public/Bug/Display.html?id=48008#txn-634903">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;19&nbsp;16:25:18&nbsp;2009</span>
    <span class="description">steven.hartland [...] multiplay.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Incorrect use of Win32::API::Struct sizeof</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/634903/323587/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/323587">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1020b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Within sub MemoryStatus there is the following call:-

 $MEMORYSTATUSEX-&gt;{dwLength} =
   Win32::API::Struct-&gt;sizeof&#40;$MEMORYSTATUSEX&#41;;

The current call is using sizeof as a class method which results in the 
following warning when run under perl -w:
Use of uninitialized value $first in concatenation &#40;.&#41; or string at 
Perl/site/lib/Win32/API/Struct.pm line 139.

Upon inspection it can be seen that the loop is never processed hence a 
real size value is never calculated and 0 value is always returned.

 $MEMORYSTATUSEX-&gt;{dwLength} =
   Win32::API::Struct-&gt;sizeof&#40;$MEMORYSTATUSEX&#41;;
  print &#34;dwLength = $MEMORYSTATUSEX-&gt;{dwLength}\n&#34;;

Gives:-
Use of uninitialized value $first in concatenation &#40;.&#41; or string at 
Perl/site/lib/Win32/API/Struct.pm line 139.
dwLength = 0

Changing it to the following fixes this:
   $MEMORYSTATUSEX-&gt;{dwLength} = $MEMORYSTATUSEX-&gt;sizeof&#40;&#41;;

I&#39;m using Win32::SystemInfo v0.11 with Win32::API v0.59 on Windows 2008 
R2 64bit but this will happen on any 64bit int compatible build of perl.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-634971" href="/Public/Bug/Display.html?id=48008#txn-634971">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;19&nbsp;19:56:34&nbsp;2009</span>
    <span class="description">cjohnston [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-634972" href="/Public/Bug/Display.html?id=48008#txn-634972">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;19&nbsp;20:00:08&nbsp;2009</span>
    <span class="description">cjohnston [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/634972/323628/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/323628">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 871b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The current call is using sizeof as a class method which results in the 
&gt; following warning when run under perl -w:
&gt; Use of uninitialized value $first in concatenation &#40;.&#41; or string at 
&gt; Perl/site/lib/Win32/API/Struct.pm line 139.
</div>
So, the issue here is that warnings are being generated? Am I reading this correctly? There is 
no actual crash? Is the call returning the correct data?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Changing it to the following fixes this:
&gt;    $MEMORYSTATUSEX-&gt;{dwLength} = $MEMORYSTATUSEX-&gt;sizeof&#40;&#41;;
</div>
It does appear that the sizeof&#40;&#41; sub in Win32::API::Struct differs from the one in 
Win32::API::Typedef, so making this change may indeed change the behavior.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m using Win32::SystemInfo v0.11 with Win32::API v0.59 on Windows 2008 
&gt; R2 64bit but this will happen on any 64bit int compatible build of perl.
</div>
What distribution/version of Perl are you seeing this issue on?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-634973" href="/Public/Bug/Display.html?id=48008#txn-634973">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;19&nbsp;20:00:09&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-634992" href="/Public/Bug/Display.html?id=48008#txn-634992">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;19&nbsp;20:11:39&nbsp;2009</span>
    <span class="description">killing [...] multiplay.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48008] Incorrect use of Win32::API::Struct sizeof</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 20 Jul 2009 01:11:17 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-SystemInfo [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Steven Hartland&#34; &lt;killing [...] multiplay.co.uk&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/634992/323635/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/323635">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Chad Johnston via RT&#34; &lt;bug-Win32-SystemInfo@rt.cpan.org&gt;

<div class="message-stanza open">&gt; So, the issue here is that warnings are being generated? Am I reading this correctly? There is 
&gt; no actual crash? Is the call returning the correct data?
</div>
No it always returns 0 as it has no access to the structure, so not sure what the
result will be to the actual windows dll call, it may not harm it but it could.

<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; Changing it to the following fixes this:
&gt;&gt;    $MEMORYSTATUSEX-&gt;{dwLength} = $MEMORYSTATUSEX-&gt;sizeof&#40;&#41;;
</div>&gt; 
&gt; It does appear that the sizeof&#40;&#41; sub in Win32::API::Struct differs from the one in 
&gt; Win32::API::Typedef, so making this change may indeed change the behavior.
</div>
 ;-&#41;

<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; I&#39;m using Win32::SystemInfo v0.11 with Win32::API v0.59 on Windows 2008 
&gt;&gt; R2 64bit but this will happen on any 64bit int compatible build of perl.
</div>&gt; 
&gt; What distribution/version of Perl are you seeing this issue on?
</div>
I was testing with 5.8 and 5.10 from Activestate.

================================================
This e.mail is private and confidential between Multiplay &#40;UK&#41; Ltd. and the person or entity to whom it is addressed. In the event of misdirection, the recipient is prohibited from using, copying, printing or otherwise disseminating it or any information contained in it. 

In the event of misdirection, illegible or incomplete transmission please telephone +44 845 868 1337
or return the E.mail to postmaster@multiplay.co.uk.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-635262" href="/Public/Bug/Display.html?id=48008#txn-635262">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;20&nbsp;11:37:27&nbsp;2009</span>
    <span class="description">cjohnston [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/635262/323759/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/323759">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 711b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; So, the issue here is that warnings are being generated? Am I
</div>&gt;    reading this correctly? There is
<div class="message-stanza open">&gt; &gt; no actual crash? Is the call returning the correct data?
</div>&gt; 
&gt; No it always returns 0 as it has no access to the structure, so not
&gt;    sure what the
&gt; result will be to the actual windows dll call, it may not harm it but
&gt;    it could.
</div>
I&#39;m still a bit confused. If I make the following call:
Win32::SystemInfo::MemoryStatus&#40;%mHash&#41;;

Does the call fail? Is information returned in the hash? Is there an
actual crash?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I was testing with 5.8 and 5.10 from Activestate.
</div>
32- or 64-bit versions? I tried the 64-bit versions, but Win32::API
isn&#39;t available by default for 64-bit because it doesn&#39;t build.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1179387" href="/Public/Bug/Display.html?id=48008#txn-1179387">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;09&nbsp;13:09:30&nbsp;2013</span>
    <span class="description">mmusgrove [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1179387/622162/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/622162">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This appears to be the source of the test failures on Strawberry Perl
5.16.2.1.

    Can&#39;t use string &#40;&#34;Win32::API::Struct&#34;&#41; as a HASH ref while &#34;strict
refs&#34; in use at C:/strawberry/perl/site/lib/
    /Struct.pm line 158.
    dmake.EXE:  Error code 255, while making &#39;test_dynamic&#39;
      CJOHNSTON/Win32-SystemInfo-0.11.zip
      C:\strawberry\c\bin\dmake.EXE test -- NOT OK

When the change outlined above is made, this error goes away and we see
the following:
        C:\strawberry\cpan\build\Win32-SystemInfo-0.11-PL12Cm&gt;dmake
        cp SystemInfo.pm blib\lib\Win32\SystemInfo.pm

        C:\strawberry\cpan\build\Win32-SystemInfo-0.11-PL12Cm&gt;dmake test
        C:\strawberry\perl\bin\perl.exe &#34;-Iblib\lib&#34; &#34;-Iblib\arch&#34; test.pl
        1..3
        ok 1
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        Use of uninitialized value in pack at
C:/strawberry/perl/vendor/lib/Win32/API/St
        ruct.pm line 317.
        ok 2
        Can&#39;t call method &#34;GetValue&#34; on an undefined value at
blib\lib/Win32/SystemInfo.
        pm line 355.
        dmake:  Error code 255, while making &#39;test_dynamic&#39;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1179555" href="/Public/Bug/Display.html?id=48008#txn-1179555">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;10&nbsp;04:18:15&nbsp;2013</span>
    <span class="description">BULKDD [...] cpan.org -  Reference by ticket #83237 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1181291" href="/Public/Bug/Display.html?id=48008#txn-1181291">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;15&nbsp;00:21:44&nbsp;2013</span>
    <span class="description">cjohnston [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1181291/623165/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/623165">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Feb 09 13:09:30 2013, MMUSGROVE wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This appears to be the source of the test failures on Strawberry Perl
&gt; 5.16.2.1.
&gt; 
&gt;     Can&#39;t use string &#40;&#34;Win32::API::Struct&#34;&#41; as a HASH ref while 
</div>&#34;strict
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; refs&#34; in use at C:/strawberry/perl/site/lib/
&gt;     /Struct.pm line 158.
&gt;     dmake.EXE:  Error code 255, while making &#39;test_dynamic&#39;
&gt;       CJOHNSTON/Win32-SystemInfo-0.11.zip
&gt;       C:\strawberry\c\bin\dmake.EXE test -- NOT OK
&gt; 
&gt; When the change outlined above is made, this error goes away and we 
</div>see
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; the following:
&gt;       C:\strawberry\cpan\build\Win32-SystemInfo-0.11-PL12Cm&gt;dmake
&gt;       cp SystemInfo.pm blib\lib\Win32\SystemInfo.pm
&gt; 
&gt;       C:\strawberry\cpan\build\Win32-SystemInfo-0.11-PL12Cm&gt;dmake test
&gt;       C:\strawberry\perl\bin\perl.exe &#34;-Iblib\lib&#34; &#34;-Iblib\arch&#34; 
</div>test.pl
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       1..3
&gt;       ok 1
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       Use of uninitialized value in pack at
&gt; C:/strawberry/perl/vendor/lib/Win32/API/St
&gt;       ruct.pm line 317.
&gt;       ok 2
&gt;       Can&#39;t call method &#34;GetValue&#34; on an undefined value at
&gt; blib\lib/Win32/SystemInfo.
&gt;       pm line 355.
&gt;       dmake:  Error code 255, while making &#39;test_dynamic&#39;
</div>
I&#39;ve made this change, and I still get the above errors on ActivePerl 
5.14. I can&#39;t call this a fix yet, so I&#39;ll dig in to it as I get more 
time.

I&#39;ve started a feature branch at <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/iamthechad/perl-">https://github.com/iamthechad/perl-</a></span>
win32-systeminfo/tree/v012 with these changes in case anybody wants to 
take a look at it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1181909" href="/Public/Bug/Display.html?id=48008#txn-1181909">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;16&nbsp;12:57:53&nbsp;2013</span>
    <span class="description">cjohnston [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1181909/623528/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/623528">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 94b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This has been resolved in Win32::SystemInfo 0.12, which was uploaded to PAUSE on 16 Feb 
2013.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1181911" href="/Public/Bug/Display.html?id=48008#txn-1181911">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;16&nbsp;12:57:54&nbsp;2013</span>
    <span class="description">cjohnston [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.520479</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
