<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #54754 for OpenOffice-OODoc: user defined fields</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #54754 for OpenOffice-OODoc: user defined fields</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/OpenOffice-OODoc">OpenOffice-OODoc CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">54754</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/OpenOffice-OODoc/Active/">OpenOffice-OODoc</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rlauer6 [...] comcast.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-24242-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.112    </td>
  </tr>
  <tr id="CF-24243-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;18&nbsp;08:59:12&nbsp;2010</span>
    <span class="description">rlauer6 [...] comcast.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> user defined fields</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Not sure if this is a bug or intended behavior, but an ooStyle XPath
object does not have the userFieldValue method...read on...

While working with your package we discovered some interesting things
about OO docs, namely that user defined field declarations can be in
either the styles.xml, or the content.xml depending on how they are
defined.  Specifically we have found differences in how OO inserts
declarations when you first define them while working with  headers and
footers &#40;i.e. in the styles section of the document&#41; - what&#39;s even odder
is that is OO behaves differently &#40;where it puts the decls&#41; depending on
whether the user defined fields are in tables or not.  This appears to
be a bug in OO itself...however back to the userFieldValue issue...

It is possible to have user defined fields in headers &#38; footers, yet the
styles object instantiated with ooStyle does not have that method.

We&#39;ve gotten around it by using the XPath object itself, however, I
thought you might like to know...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;18&nbsp;10:09:09&nbsp;2010</span>
    <span class="description">jmgdoc [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Jeu 18 Fév 2010 08:59:12, rlauer6@comcast.net a écrit :

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It is possible to have user defined fields in headers &#38; footers, yet the
&gt; styles object instantiated with ooStyle does not have that method.
&gt; 
&gt; We&#39;ve gotten around it by using the XPath object itself, however, I
&gt; thought you might like to know...
</div>
Hm... while it&#39;s probably not so clear in the documentation, the
explicit invocation of Style, XPath, Text and other OODoc submodules is
not recommended. You should &#34;use OpenOffice::OODoc&#34; and instantiate the
document objects through the common odfDocument&#40;&#41; constructor. This
constructor allows you to create objects that inherit all the features
of ooStyle, ooText, ooImage and ooXPath. As a consequence, all the
methods are available for the styles.xml part as well as for the
content.xml part. Example:

my $oofile = odfContainer&#40;&#34;myfile.odt&#34;&#41;;
my $styles = odfDocument&#40;
    container =&gt; $oofile,
    part =&gt; &#34;styles&#34;
    &#41;;
my $text = odfDocument&#40;
    container =&gt; $oofile,
    part =&gt; &#34;content&#34;
    &#41;;
# ...process...
# and save the changes
$oofile-&gt;save&#40;&#41;;

Knowing that page styles, which are stored in the styles.xml part, may
contain headers and footers that may contain image and text objects, an
application that uses Styles, Text and/or Image separately is not
practical. The Document compound module is intended to avoid such an
issue. &#40;For other explanations see
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/OpenOffice-OODoc/OODoc/Intro.pod#Dealing_with_styles_AND_content&#41;">http://search.cpan.org/dist/OpenOffice-OODoc/OODoc/Intro.pod#Dealing_with_styles_AND_content&#41;</a></span>
 
Could you please try that and let me know the result ?
I&#39;m interested in any feed back about the user field issues with OODoc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;18&nbsp;10:09:19&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;28&nbsp;12:57:04&nbsp;2010</span>
    <span class="description">jmgdoc [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Could you please provide me with more details and code so I&#39;ll try to
reenact the issue ?

Or may I suppose it&#39;s resolved ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;28&nbsp;13:15:27&nbsp;2010</span>
    <span class="description">rlauer6 [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54754] user defined fields</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 28 Feb 2010 13:14:31 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-OpenOffice-OODoc [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rob Lauer &lt;rlauer6 [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The issue is really not &#34;a bug&#34; as I indicated, it&#39;s more an omission.

There is not UserFieldValue method on ::Style object although, as it
turns out, there certainly can be user defined fields defined there.

On Sun, Feb 28, 2010 at 12:57 PM, Jean-Marie Gouarné via RT
&lt;bug-OpenOffice-OODoc@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=54754">https://rt.cpan.org/Ticket/Display.html?id=54754</a></span> &gt;
&gt;
&gt; Hi,
&gt;
&gt; Could you please provide me with more details and code so I&#39;ll try to
&gt; reenact the issue ?
&gt;
&gt; Or may I suppose it&#39;s resolved ?
&gt;
&gt;
</div>


-- 
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;28&nbsp;19:07:09&nbsp;2010</span>
    <span class="description">jmgdoc [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Dim 28 Fév 2010 13:15:27, rlauer6@comcast.net a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; There is not UserFieldValue method on ::Style object although, as it
&gt; turns out, there certainly can be user defined fields defined there.
&gt; 
</div>
You are right; the user fields related to page styles are presently not
supported by the OODoc user field method. I&#39;ll turn the issue into a
wishlist item.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;28&nbsp;19:07:32&nbsp;2010</span>
    <span class="description">jmgdoc [...] cpan.org -  Severity Important changed to Wishlist</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;10&nbsp;10:32:18&nbsp;2010</span>
    <span class="description">jmgdoc [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Now the following program works:

my $styles = odfDocument
    &#40;
    file =&gt; &#34;odftest.odt&#34;,
    part =&gt; &#39;styles&#39;
    &#41;;

print $doc-&gt;userFieldValue&#40;&#34;Toto&#34;&#41; . &#34;\n&#34;;

In addition, with &#39;styles&#39; document part, the user is allowed to
restrict the search context of getUserField&#40;&#41; and userFieldValue&#40;&#41; to a
given master page. Example:

my $styles = odfDocument&#40;file =&gt; &#34;odftest.odt&#34;, part =&gt; &#39;styles&#39;&#41;;
my $uf = $styles-&gt;getUserField&#40;&#34;Foo&#34;, $styles-&gt;getMasterpage&#40;&#34;Standard&#34;&#41;&#41;;

The last instruction returns the user field whose name is &#34;Foo&#34; if and
only if it&#39;s declared with the definition of a master page &#40;i.e.
included in the definition of the page header or footer&#41;.




So, the odfStyles&#40;&#41; or ooStyles&#40;&#41; constructor should not be used; the
odfDocument&#40;&#41; constructor creates an object that inherit all the
features of ::Text, ::Styles, and others.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;10&nbsp;10:32:19&nbsp;2010</span>
    <span class="description">jmgdoc [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
