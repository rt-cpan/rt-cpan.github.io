<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #38099 for Spreadsheet-WriteExcel: strange name conflict with autofilter</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #38099 for Spreadsheet-WriteExcel: strange name conflict with autofilter</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-WriteExcel">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-WriteExcel">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-WriteExcel">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-WriteExcel">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-WriteExcel">Spreadsheet-WriteExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::WriteExcel here are some pointers</b>
<p>

1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>

2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>

3) Upgrade to the latest version of Spreadsheet::WriteExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.

<p>
4) <b>Create a small but complete example program that demonstrates your problem.</b> The program should be as small as possible. At the same time it should be a complete program that generates an Excel file. If the Spreadsheet::WriteExcel section is part of a much larger program then simplify it down to the essentials. Simulate any DB reads with an array.
<p>

5) Say if you tested with Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>

6) If you are submitting a patch you should check with the author whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-writeexcel">Spreadsheet::WriteExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">38099</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-WriteExcel">Spreadsheet-WriteExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ThomasKratz [...] web.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29480-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29481-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




name_conflict.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/640220/327095/name_conflict.pl">
Mon Jul 27 04:48:12 2009 (905b) by DAMI [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=38099">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-492224" href="/Public/Bug/Display.html?id=38099#txn-492224">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;01&nbsp;09:33:31&nbsp;2008</span>
    <span class="description">ThomasKratz [...] web.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> strange name conflict with autofilter</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 01 Aug 2008 15:33:11 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-WriteExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Thomas Kratz &lt;ThomasKratz [...] web.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/492224/243563/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/243563">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 866b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

the below test script produces an xls file that comes up with a dialog directly after opening, saying that there is a name conflict with
&#39;_FilterDatenbank&#39; &#40;German Excel 2000&#41;. Just by exchanging the two &#39;add_worksheet&#39; lines, the problem disappears.

use strict;
use warnings;

use Spreadsheet::WriteExcel;

my $wb   = Spreadsheet::WriteExcel-&gt;new&#40;&#39;test.xls&#39;&#41;;

# swap the following two lines for the error to disappear
my $a_ws = $wb-&gt;add_worksheet&#40;&#39;S&#39;&#41;;
my $b_ws = $wb-&gt;add_worksheet&#40;&#39;A&#39;&#41;;

$a_ws-&gt;autofilter&#40;0, 0, 1, 1&#41;;
$b_ws-&gt;autofilter&#40;0, 0, 1, 1&#41;;

$wb-&gt;close&#40;&#41;;

perl v5.8.8 built for MSWin32-x86-multi-thread
Spreadsheet-WriteExcel-2.22

Thomas
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">_____________________________________________________________________
Der WEB.DE SmartSurfer hilft bis zu 70% Ihrer Onlinekosten zu sparen!
<span class="clickylink"><a target="new" rel="nofollow" href="http://smartsurfer.web.de/?mc=100071&#38;distributionid=000000000066">http://smartsurfer.web.de/?mc=100071&#38;distributionid=000000000066</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-492233" href="/Public/Bug/Display.html?id=38099#txn-492233">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;01&nbsp;10:26:17&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/492233/243572/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/243572">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 445b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Aug 01 09:33:31 2008, ThomasKratz@web.de wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; the below test script produces an xls file that comes up with a dialog
&gt; directly after opening, saying that there is a name conflict with
&gt; &#39;_FilterDatenbank&#39; &#40;German Excel 2000&#41;.
</div>
Hi Thomas,

I don&#39;t have Excel 2000 and I cannot reproduce it with English Excel 97
or 2003.

I do believe you that it exists though. :-&#41;

I have an idea what might cause it. I&#39;ll look into it.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-492234" href="/Public/Bug/Display.html?id=38099#txn-492234">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;01&nbsp;10:29:46&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-510045" href="/Public/Bug/Display.html?id=38099#txn-510045">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;19&nbsp;06:10:56&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/510045/253943/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/253943">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Thomas,

I still haven&#39;t been able to reproduce this or find the cause. If you
have a little time perhaps you could help me debug it. Could you do the
following &#40;the open and close parts are important&#41;.

1.  Open Excel.
2.  Select &#34;Tools -&gt; Options -&gt; General -&gt; Sheets in new Workbook&#34;
3.  Set it to 2 or more.
4.  Close Excel.

5.  Open Excel.
6.  Paste or add the following data into the first 2 worksheets.

    a   b   c
    1   1   1
    2   2   2
    3   3   3
    4   4   4

7.  Select cell A1 on Sheet 1.
8.  Save the workbook as rt01.xls.

9.  On Sheet1 select the area A1:C5 and set the autofilter.
10. Select cell A1.
11. On Sheet2 select the area A1:C5 and set the autofilter.
12. Select cell A1.
13. Select cell A1 on Sheet 1.
14. Save the workbook as rt02.xls.
15. Close Excel.

16. Open Excel.
17. Reopen rt01.xls.
18. On Sheet2 select the area A1:C5 and set the autofilter.
19. Select cell A1.
20. On Sheet1 select the area A1:C5 and set the autofilter.
21. Select cell A1.
22. Save the workbook as rt03.xls.

Zip up the rt01.xls, rt02.xls and rt03.xls files and send them to me.

Thanks,

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-510102" href="/Public/Bug/Display.html?id=38099#txn-510102">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;19&nbsp;08:05:28&nbsp;2008</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/510102/253980/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/253980">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 102b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
P.S. Send the files to the address in the docs. No point clogging up the
system here. :-&#41;

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-640186" href="/Public/Bug/Display.html?id=38099#txn-640186">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;27&nbsp;03:45:09&nbsp;2009</span>
    <span class="description">DAMI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/640186/327068/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/327068">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 898b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Ven. AoÃ». 01 09:33:31 2008, ThomasKratz@web.de a Ã©critÂ :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; the below test script produces an xls file that comes up with a dialog
&gt; directly after opening, saying that there is a name conflict with
&gt; &#39;_FilterDatenbank&#39; &#40;German Excel 2000&#41;. 
</div>
Hi,

I juste encountered a similar problem &#40;French Excel 2003&#41;.

First version of my script created a workbook with several worksheets
and autofilter in each of them; when opening the file, Excel reports a
name conflict in the first sheet on &#34;_FilterDatabase&#34;.

In a second version of the script, I added printing instructions by
calling $worksheet-&gt;repeat_rows&#40;..&#41; and $worksheet-&gt;repeat_columns&#40;..&#41;.
Surprisingly, this caused the problem with _FilterDatabase to disappear,
but now there is a name conflict on &#34;Impression_des_titres&#34;.

I&#39;ll try to isolate the problem in a shorter script and post it a bit later.

Best regards, Laurent Dami
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-640220" href="/Public/Bug/Display.html?id=38099#txn-640220">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;27&nbsp;04:48:12&nbsp;2009</span>
    <span class="description">DAMI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/640220/327092/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/327092">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 336b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here is a script that demonstrates the name conflict.

The bug is related to the number of sheets &#40;starts with 10 sheets or more&#41;.

It is not related specifically to autofilter&#40;&#41;, but rather to builtin
internal names used by Excel; so we get the same bug when calling
repeat_rows&#40;&#41; instead of autofilter&#40;&#41;.

Best regards, Laurent Dami
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/640220/327095/name_conflict.pl">Download name_conflict.pl</a><br />
<span class="downloadcontenttype">text/x-perl 905b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"># laurent.dami@justice.ge.ch, July 09.
# script to demonstrate bug with autofilter&#40;&#41; or repeat_rows&#40;&#41;.
use strict;
use warnings;
use Spreadsheet::WriteExcel;

my $n_sheets = $ARGV[0] || 10;
my $xls_name = &#34;foo.xls&#34;;

my @data = &#40;[qw/FOO BAR/], [1, 2], [qw/a b/]&#41;;

my $workbook = Spreadsheet::WriteExcel-&gt;new&#40;&#34;$xls_name&#34;&#41;  
  or die &#34;could not create workbook $xls_name, $!&#34;;

for my $i &#40;1 .. $n_sheets&#41; {
  my $worksheet = $workbook-&gt;add_worksheet&#40;&#34;Tst $i&#34;&#41;;
  $worksheet-&gt;write&#40;$_, 0, $data[$_]&#41; foreach 0 .. $#data;

  # with 10 sheets or more, either &#39;repeat_rows&#39; or &#39;autofilter&#39; will
  # create a name conflict when opening the file in Excel &#40;but both
  # conflicts do not cumulate; one shadows the other&#41;.
  $worksheet-&gt;repeat_rows&#40;0&#41;;
  $worksheet-&gt;autofilter&#40;0, 0, @data -1 , @{$data[0]}-1&#41;;
}

$workbook-&gt;close&#40;&#41;;

# open in Excel &#40;assuming we are on a Win32 system&#41;
system &#40;&#34;start $xls_name&#34;&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-641482" href="/Public/Bug/Display.html?id=38099#txn-641482">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;29&nbsp;12:01:03&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/641482/327860/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/327860">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 814b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jul 27 04:48:12 2009, DAMI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here is a script that demonstrates the name conflict.
&gt; 
&gt; The bug is related to the number of sheets &#40;starts with 10 sheets or
</div>more&#41;.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; It is not related specifically to autofilter&#40;&#41;, but rather to builtin
&gt; internal names used by Excel; so we get the same bug when calling
&gt; repeat_rows&#40;&#41; instead of autofilter&#40;&#41;.
&gt; 
&gt; Best regards, Laurent Dami
&gt; 
</div>

Hi,

I identified a fix for this even if I didn&#39;t figure out what was causing
it exactly.

Could you try the following test release:

<span class="clickylink"><a target="new" rel="nofollow" href="http://homepage.eircom.net/~jmcnamara/perl/prerel/Spreadsheet-WriteExcel-2.25.07.tar.gz">http://homepage.eircom.net/~jmcnamara/perl/prerel/Spreadsheet-WriteExcel-2.25.07.tar.gz</a></span>

And somewhere in your program set the country code for France using the
new set_country&#40;&#41; workbook method:

$workbook-&gt;set_country&#40;33&#41;;

Let me know if that fixes the problem.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-641878" href="/Public/Bug/Display.html?id=38099#txn-641878">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;30&nbsp;08:41:48&nbsp;2009</span>
    <span class="description">DAMI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/641878/328096/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/328096">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 545b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Mer. Jul. 29 12:01:03 2009, JMCNAMARA a Ã©critÂ :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Hi,
&gt; 
&gt; I identified a fix for this even if I didn&#39;t figure out what was
&gt; causing
&gt; it exactly.
&gt; 
&gt; Could you try the following test release:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://homepage.eircom.net/~jmcnamara/perl/prerel/Spreadsheet-">http://homepage.eircom.net/~jmcnamara/perl/prerel/Spreadsheet-</a></span>
&gt; WriteExcel-2.25.07.tar.gz
&gt; 
&gt; And somewhere in your program set the country code for France using
&gt; the
&gt; new set_country&#40;&#41; workbook method:
&gt; 
&gt; $workbook-&gt;set_country&#40;33&#41;;
&gt; 
&gt; Let me know if that fixes the problem.
&gt; 
&gt; John.
</div>
YES, it works. Great, thanks!

Laurent D.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-684868" href="/Public/Bug/Display.html?id=38099#txn-684868">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;02:43:42&nbsp;2009</span>
    <span class="description">DAMI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> next public release ?</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/684868/352625/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352625">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 787b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi John,

Since your dev. version 2.25.07 solved the bug, could you please make it
an official release ?

Thanks in advance, Laurent Dami


Le Jeu. Jul. 30 08:41:48 2009, DAMI a Ã©critÂ :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Le Mer. Jul. 29 12:01:03 2009, JMCNAMARA a Ã©critÂ :
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; I identified a fix for this even if I didn&#39;t figure out what was
&gt; &gt; causing
&gt; &gt; it exactly.
&gt; &gt; 
&gt; &gt; Could you try the following test release:
&gt; &gt; 
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://homepage.eircom.net/~jmcnamara/perl/prerel/Spreadsheet-">http://homepage.eircom.net/~jmcnamara/perl/prerel/Spreadsheet-</a></span>
&gt; &gt; WriteExcel-2.25.07.tar.gz
&gt; &gt; 
&gt; &gt; And somewhere in your program set the country code for France using
&gt; &gt; the
&gt; &gt; new set_country&#40;&#41; workbook method:
&gt; &gt; 
&gt; &gt; $workbook-&gt;set_country&#40;33&#41;;
&gt; &gt; 
&gt; &gt; Let me know if that fixes the problem.
&gt; &gt; 
&gt; &gt; John.
</div>&gt; 
&gt; YES, it works. Great, thanks!
&gt; 
&gt; Laurent D.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-690623" href="/Public/Bug/Display.html?id=38099#txn-690623">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;14&nbsp;08:09:44&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/690623/355516/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/355516">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 213b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Nov 02 02:43:42 2009, DAMI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi John,
&gt; 
&gt; Since your dev. version 2.25.07 solved the bug, could you please make it
&gt; an official release ?
</div>
Hi,

This fix has gone into the 2.26 release.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-703893" href="/Public/Bug/Display.html?id=38099#txn-703893">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;08&nbsp;21:57:14&nbsp;2009</span>
    <span class="description">DAMI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/703893/362957/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/362957">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 301b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Sam. Nov. 14 08:09:44 2009, JMCNAMARA a Ã©critÂ :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Nov 02 02:43:42 2009, DAMI wrote:
<div class="message-stanza open">&gt; &gt; Hi John,
&gt; &gt; 
&gt; &gt; Since your dev. version 2.25.07 solved the bug, could you please make it
&gt; &gt; an official release ?
</div>&gt; 
&gt; Hi,
&gt; 
&gt; This fix has gone into the 2.26 release.
&gt; 
&gt; John.
</div>
Perfect, thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-723261" href="/Public/Bug/Display.html?id=38099#txn-723261">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;21&nbsp;19:50:27&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/723261/373472/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/373472">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 635b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Aug 01 09:33:31 2008, ThomasKratz@web.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; the below test script produces an xls file that comes up with a dialog
&gt; directly after opening, saying that there is a name conflict with
&gt; &#39;_FilterDatenbank&#39; &#40;German Excel 2000&#41;. Just by exchanging the two
&gt; &#39;add_worksheet&#39; lines, the problem disappears.
</div>
Hi,

This issue should be fixed in Spreadsheet::WriteExcel 2.36.

Note, the fix doesn&#39;t require the set_country&#40;&#41; workaround and for compatibility with other 
versions of Excel you probably should use it.

If you get a chance to test it you can let me know how it works out.

Thanks for your input.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-728389" href="/Public/Bug/Display.html?id=38099#txn-728389">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;03&nbsp;07:35:42&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.65945</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
