<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #88005 for Net-SFTP-Foreign: error message when program exits</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #88005 for Net-SFTP-Foreign: error message when program exits</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-SFTP-Foreign">Net-SFTP-Foreign CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">88005</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-SFTP-Foreign/Active/">Net-SFTP-Foreign</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
stephen [...] lingraywatches.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23164-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23165-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;21&nbsp;11:36:08&nbsp;2013</span>
    <span class="description">stephen [...] lingraywatches.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> error message when program exits</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 21 Aug 2013 16:35:51 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SFTP-Foreign [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Wylie &lt;stephen [...] lingraywatches.co.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It says &#39;Killed by signal 1.&#39; This can be avoided by using the disconnect
method, so the problem is really only in the documentation which advises
that disconnect shouldn&#39;t normally be used. I&#39;m running a program every 5
minutes on the cron, and getting an email every time, due to the ssh
process being killed.

-- 
&#34;It is human nature to think wisely and act in an absurd fashion.&#34; -
Anatole France
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;22&nbsp;20:29:36&nbsp;2013</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Aug 21 11:36:08 2013, stephen@lingraywatches.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It says &#39;Killed by signal 1.&#39; This can be avoided by using the disconnect
&gt; method, so the problem is really only in the documentation which advises
&gt; that disconnect shouldn&#39;t normally be used. I&#39;m running a program every 5
&gt; minutes on the cron, and getting an email every time, due to the ssh
&gt; process being killed.
</div>
You can avoid the message by using the method described here: <span class="clickylink"><a target="new" rel="nofollow" href="http://perlmonks.org/?node_id=1022042">http://perlmonks.org/?node_id=1022042</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;22&nbsp;20:29:36&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;26&nbsp;06:34:01&nbsp;2013</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88005] error message when program exits</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 Aug 2013 03:33:46 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message -----
<div class="message-stanza open">&gt; From: Stephen Wylie via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; To: 
&gt; Cc: 
&gt; Sent: Wednesday, August 21, 2013 5:36 PM
&gt; Subject: [rt.cpan.org #88005] error message when program exits
&gt; 
&gt; Wed Aug 21 11:36:08 2013: Request 88005 was acted upon.
&gt; Transaction: Ticket created by stephen@lingraywatches.co.uk
&gt;        Queue: Net-SFTP-Foreign
&gt;      Subject: error message when program exits
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: &#40;no value&#41;
&gt;        Owner: Nobody
&gt;   Requestors: stephen@lingraywatches.co.uk
&gt;       Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88005">https://rt.cpan.org/Ticket/Display.html?id=88005</a></span> &gt;
&gt; 
&gt; 
&gt; It says &#39;Killed by signal 1.&#39;
</div>
That means that the SSH process is getting a HUP signal.

<div class="message-stanza open">&gt; This can be avoided by using the disconnect
&gt; method, so the problem is really only in the documentation which advises
&gt; that disconnect shouldn&#39;t normally be used. I&#39;m running a program every 
&gt; 5
&gt; minutes on the cron, and getting an email every time, due to the ssh
&gt; process being killed.
</div>

I guess you are using password authentication and storing the Net::SFTP::Foreign object in a global variable instead of a lexical one &#40;or otherwise, that some reference is keep in some way to the object until global destruction&#41;.

If the SFTP object reaches the global destruction phase, it may be destroyed after the IO::Pty object handling the ssh process pty and that would cause the delivering of the HUP signal.

If that is the problem, the documentation would be right, as it says that the conneciton is closed automatically when the object goes out of scope, the problem being that actually, in your case, it never goes out of scope.

As a work around, you can:

- save the SFTP object in a lexical variable:

   my $sftp = Net::SFTP::Foreign-&gt;new&#40;...&#41;;

- call disconnect explicitly

- set the stderr_discard flag from the constructor


I will update the docs explaining that.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;26&nbsp;09:12:48&nbsp;2013</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88005] error message when program exits</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 Aug 2013 06:12:35 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message -----
<div class="message-stanza open">&gt; From: &#34;Salvador \&#34;Fandiño\&#34;﻿ via RT&#34; &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; To: 
&gt; Cc: 
&gt; Sent: Monday, August 26, 2013 12:34 PM
&gt; Subject: Re: [rt.cpan.org #88005] error message when program exits
&gt; 
&gt;        Queue: Net-SFTP-Foreign
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88005">https://rt.cpan.org/Ticket/Display.html?id=88005</a></span> &gt;
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; ----- Original Message -----
<div class="message-stanza open">&gt;&gt;  From: Stephen Wylie via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt;&gt;  To: 
&gt;&gt;  Cc: 
&gt;&gt;  Sent: Wednesday, August 21, 2013 5:36 PM
&gt;&gt;  Subject: [rt.cpan.org #88005] error message when program exits
&gt;&gt; 
&gt;&gt;  Wed Aug 21 11:36:08 2013: Request 88005 was acted upon.
&gt;&gt;  Transaction: Ticket created by stephen@lingraywatches.co.uk
&gt;&gt;         Queue: Net-SFTP-Foreign
&gt;&gt;       Subject: error message when program exits
&gt;&gt;     Broken in: &#40;no value&#41;
&gt;&gt;      Severity: &#40;no value&#41;
&gt;&gt;         Owner: Nobody
&gt;&gt;    Requestors: stephen@lingraywatches.co.uk
&gt;&gt;        Status: new
&gt;&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88005">https://rt.cpan.org/Ticket/Display.html?id=88005</a></span> &gt;
&gt;&gt; 
&gt;&gt; 
&gt;&gt;  It says &#39;Killed by signal 1.&#39;
</div>&gt; 
&gt; That means that the SSH process is getting a HUP signal.
&gt; 
<div class="message-stanza open">&gt;&gt;  This can be avoided by using the disconnect
&gt;&gt;  method, so the problem is really only in the documentation which advises
&gt;&gt;  that disconnect shouldn&#39;t normally be used. I&#39;m running a program 
</div>&gt; every 
<div class="message-stanza open">&gt;&gt;  5
&gt;&gt;  minutes on the cron, and getting an email every time, due to the ssh
&gt;&gt;  process being killed.
</div>&gt; 
&gt; 
&gt; I guess you are using password authentication and storing the Net::SFTP::Foreign 
&gt; object in a global variable instead of a lexical one &#40;or otherwise, that some 
&gt; reference is keep in some way to the object until global destruction&#41;.
&gt; 
&gt; If the SFTP object reaches the global destruction phase, it may be destroyed 
&gt; after the IO::Pty object handling the ssh process pty and that would cause the 
&gt; delivering of the HUP signal.
&gt; 
&gt; If that is the problem, the documentation would be right, as it says that the 
&gt; conneciton is closed automatically when the object goes out of scope, the 
&gt; problem being that actually, in your case, it never goes out of scope.
</div>
I have released a new version that includes a work-around for that issue.

Could you try it?

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/SALVA/Net-SFTP-Foreign-1.76_03">https://metacpan.org/release/SALVA/Net-SFTP-Foreign-1.76_03</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;27&nbsp;06:38:09&nbsp;2013</span>
    <span class="description">stephen [...] lingraywatches.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88005] error message when program exits</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 Aug 2013 11:37:49 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SFTP-Foreign [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Wylie &lt;stephen [...] lingraywatches.co.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for your explanations. The version I am using is the one from
rpmforge, an unofficial Centos repository.
I&#39;m not quite sure what version it is! Centos maintainers advise against
installing directly from CPAN etc, as it can create obscure conflicts. I
don&#39;t really know why this is, but as I have an adequate workaround, I am
reluctant to go against their advice.
 I reported it just to help other people who might have the same problem.


On 26 August 2013 14:12, Salvador \&#34;Fandiño\&#34; via RT &lt;
bug-Net-SFTP-Foreign@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88005">https://rt.cpan.org/Ticket/Display.html?id=88005</a></span> &gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt;
&gt; ----- Original Message -----
<div class="message-stanza open">&gt; &gt; From: &#34;Salvador \&#34;Fandiño\&#34; via RT&#34; &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; &gt; To:
&gt; &gt; Cc:
&gt; &gt; Sent: Monday, August 26, 2013 12:34 PM
&gt; &gt; Subject: Re: [rt.cpan.org #88005] error message when program exits
&gt; &gt;
&gt; &gt;        Queue: Net-SFTP-Foreign
&gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88005">https://rt.cpan.org/Ticket/Display.html?id=88005</a></span> &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; ----- Original Message -----
<div class="message-stanza open">&gt; &gt;&gt;  From: Stephen Wylie via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; &gt;&gt;  To:
&gt; &gt;&gt;  Cc:
&gt; &gt;&gt;  Sent: Wednesday, August 21, 2013 5:36 PM
&gt; &gt;&gt;  Subject: [rt.cpan.org #88005] error message when program exits
&gt; &gt;&gt;
&gt; &gt;&gt;  Wed Aug 21 11:36:08 2013: Request 88005 was acted upon.
&gt; &gt;&gt;  Transaction: Ticket created by stephen@lingraywatches.co.uk
&gt; &gt;&gt;         Queue: Net-SFTP-Foreign
&gt; &gt;&gt;       Subject: error message when program exits
&gt; &gt;&gt;     Broken in: &#40;no value&#41;
&gt; &gt;&gt;      Severity: &#40;no value&#41;
&gt; &gt;&gt;         Owner: Nobody
&gt; &gt;&gt;    Requestors: stephen@lingraywatches.co.uk
&gt; &gt;&gt;        Status: new
&gt; &gt;&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88005">https://rt.cpan.org/Ticket/Display.html?id=88005</a></span> &gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;  It says &#39;Killed by signal 1.&#39;
</div>&gt; &gt;
&gt; &gt; That means that the SSH process is getting a HUP signal.
&gt; &gt;
<div class="message-stanza open">&gt; &gt;&gt;  This can be avoided by using the disconnect
&gt; &gt;&gt;  method, so the problem is really only in the documentation which
</div></div>&gt; advises
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt;  that disconnect shouldn&#39;t normally be used. I&#39;m running a program
</div>&gt; &gt; every
<div class="message-stanza open">&gt; &gt;&gt;  5
&gt; &gt;&gt;  minutes on the cron, and getting an email every time, due to the ssh
&gt; &gt;&gt;  process being killed.
</div>&gt; &gt;
&gt; &gt;
&gt; &gt; I guess you are using password authentication and storing the
</div>&gt; Net::SFTP::Foreign
<div class="message-stanza open">&gt; &gt; object in a global variable instead of a lexical one &#40;or otherwise, that
</div>&gt; some
<div class="message-stanza open">&gt; &gt; reference is keep in some way to the object until global destruction&#41;.
&gt; &gt;
&gt; &gt; If the SFTP object reaches the global destruction phase, it may be
</div>&gt; destroyed
<div class="message-stanza open">&gt; &gt; after the IO::Pty object handling the ssh process pty and that would
</div>&gt; cause the
<div class="message-stanza open">&gt; &gt; delivering of the HUP signal.
&gt; &gt;
&gt; &gt; If that is the problem, the documentation would be right, as it says
</div>&gt; that the
<div class="message-stanza open">&gt; &gt; conneciton is closed automatically when the object goes out of scope, the
&gt; &gt; problem being that actually, in your case, it never goes out of scope.
</div>&gt;
&gt; I have released a new version that includes a work-around for that issue.
&gt;
&gt; Could you try it?
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/SALVA/Net-SFTP-Foreign-1.76_03">https://metacpan.org/release/SALVA/Net-SFTP-Foreign-1.76_03</a></span>
&gt;
&gt;
</div>

-- 
&#34;It is human nature to think wisely and act in an absurd fashion.&#34; -
Anatole France
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;27&nbsp;08:27:48&nbsp;2013</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88005] error message when program exits</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 Aug 2013 05:27:34 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message -----
<div class="message-stanza open">&gt; From: Stephen Wylie via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; To: 
&gt; Cc: 
&gt; Sent: Tuesday, August 27, 2013 12:38 PM
&gt; Subject: Re: [rt.cpan.org #88005] error message when program exits
&gt; 
&gt;        Queue: Net-SFTP-Foreign
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88005">https://rt.cpan.org/Ticket/Display.html?id=88005</a></span> &gt;
&gt; 
&gt; Thanks for your explanations. The version I am using is the one from
&gt; rpmforge, an unofficial Centos repository.
&gt; I&#39;m not quite sure what version it is! Centos maintainers advise against
&gt; installing directly from CPAN etc, as it can create obscure conflicts. I
&gt; don&#39;t really know why this is, but as I have an adequate workaround, I am
&gt; reluctant to go against their advice.
</div>
Well, their advice is sound. Replacing modules on the system perl may completely ruin your system.

On the other hand it is possible to install modules in a private directory and use then for your scripts otherwise you end using really old versions. Nowadays local::lib is the module everybody use to install modules privately.

In any case, just for testing, you can unpack the module archive in your home or some other harmless place, and add the lib directory inside to the module search patch. For instance:

  PERL5LIB=/tmp/Net-SFTP-Foreign-1.76_03/lib your_script.pl
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;02&nbsp;09:17:39&nbsp;2013</span>
    <span class="description">salva [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">closing as resolved as a fix was released even if the OP never confirmed that the issue was gone.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;02&nbsp;09:17:39&nbsp;2013</span>
    <span class="description">salva [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
