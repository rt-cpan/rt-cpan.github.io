<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21752 for Net-DNS: Patch: error in compiler detection, error in XS.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21752 for Net-DNS: Patch: error in compiler detection, error in XS.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-DNS/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21752</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-DNS/Active/">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
alexchorny [...] gmail.com

<br />
andy.melnikov [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Makefile.PL.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/245078/104581/Makefile.PL.patch">
Wed Sep 27 14:43:24 2006 (465b) by alexchorny [...] gmail.com
</a>
</font></li>
</ul>


netdns.h.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/245078/104584/netdns.h.patch">
Wed Sep 27 14:43:24 2006 (279b) by alexchorny [...] gmail.com
</a>
</font></li>
</ul>


PGP.sig<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/245243/104675/PGP.sig">
Thu Sep 28 10:36:56 2006 (227b) by olaf [...] dacht.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;27&nbsp;14:43:23&nbsp;2006</span>
    <span class="description">alexchorny [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Patch: error in compiler detection, error in XS.</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">ActiveState perl v5.8.7 built for MSWin32-x86-multi-thread
Binary build 813

Also ok on Vanilla, Cygwin.

-------
Alexandr Ciornii, <span class="clickylink"><a target="new" rel="nofollow" href="http://chorny.net">http://chorny.net</a></span>
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Makefile.PL.patch</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Makefile.PL.dist	Mon Sep 18 22:22:12 2006
+++ Makefile.PL	Wed Sep 27 01:38:46 2006
@@ -211,6 +211,7 @@
 
 
 
+use Config qw&#40;%Config&#41;;
 sub postamble {
     my $content;
 
@@ -222,8 +223,9 @@
 
 
 
-netdns$&#40;LIB_EXT&#41;: netdns.o
-	$&#40;AR&#41; cr netdns$&#40;LIB_EXT&#41; netdns.o
+netdns$&#40;LIB_EXT&#41;: netdns$&#40;OBJ_EXT&#41;
+	$&#40;AR&#41; &#39;.&#40;$^O eq &#39;MSWin32&#39; &#38;&#38; $Config{&#39;cc&#39;} eq &#39;cl&#39;?&#39;/OUT:&#39;:&#39;cr &#39;&#41;.
+	  &#39;netdns$&#40;LIB_EXT&#41; netdns$&#40;OBJ_EXT&#41;
 	$&#40;RANLIB&#41; netdns$&#40;LIB_EXT&#41;
 
 
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> netdns.h.patch</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- netdns.h.dist	Mon Sep 18 22:22:12 2006
+++ netdns.h	Wed Sep 27 01:36:26 2006
@@ -1,4 +1,7 @@
 #include &lt;sys/types.h&gt;
+#if defined&#40;_MSC_VER&#41; || defined&#40;__MINGW32_VERSION&#41;
+#include &lt;windows.h&gt;
+#endif
 #define TESTVAL 4
 extern double foo&#40;int, long, const char*&#41;;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;28&nbsp;10:36:55&nbsp;2006</span>
    <span class="description">olaf [...] dacht.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21752] Patch: error in compiler detection, error in XS. </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Sep 2006 16:36:40 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Olaf M. Kolkman&#34; &lt;olaf [...] dacht.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Patch applied on the trunk. I have no ways to test this.

--Olaf


On 27Sep 2006, at 8:43 PM, alexchorny@gmail.com via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Wed Sep 27 14:43:23 2006: Request 21752 was acted upon.
&gt; Transaction: Ticket created by alexchorny@gmail.com
&gt;        Queue: Net-DNS
&gt;      Subject: Patch: error in compiler detection, error in XS.
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: Normal
&gt;        Owner: Nobody
&gt;   Requestors: alexchorny@gmail.com
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=21752">http://rt.cpan.org/Ticket/Display.html?id=21752</a></span> &gt;
&gt;
&gt;
&gt; ActiveState perl v5.8.7 built for MSWin32-x86-multi-thread
&gt; Binary build 813
&gt;
&gt; Also ok on Vanilla, Cygwin.
&gt;
&gt; -------
&gt; Alexandr Ciornii, <span class="clickylink"><a target="new" rel="nofollow" href="http://chorny.net">http://chorny.net</a></span>
&gt;
&gt; &lt;Makefile.PL.patch&gt;
&gt; &lt;netdns.h.patch&gt;
</div>
------------------------------------------------------
Ik dacht net... heel even maar.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/245243/104675/PGP.sig">Download PGP.sig</a><br />
<span class="downloadcontenttype">application/pgp-signature 227b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;28&nbsp;10:36:57&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;21&nbsp;19:14:39&nbsp;2006</span>
    <span class="description">andy.melnikov [...] gmail.com - Ticket #24042:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> netdns.c doesn&#39;t compile on Win32/Visual C++ due to u_char</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">In Net-DNS-0.59 distribution netdns.c refuses to compile on Win32/Visual
C++ &#40;I tried 2005, but earlier versions should have the same problem&#41;.

It&#39;s due to broken/non-compliant sys/types.h on Windows. u_char type is
not defined there, so you should add something like

#ifdef _WIN32
typedef unsigned char u_char;
#endif

I&#39;m not sure what exactly you should detect &#40;e.g. it might compile using
cygwin/gcc even without this patch&#41;, so maybe you should use other
condition.

This patch alone doesn&#39;t make Net::DNS using the XS part on Windows due
to problems with makefile &#40;I will post that issue as another bug&#41; but
with this patch Makefile.PL starts to detect the compiler successfully.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;21&nbsp;19:34:47&nbsp;2006</span>
    <span class="description">andy.melnikov [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andy.melnikov [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">alexchorny@gmail.com wrote:

--- netdns.h.dist       Mon Sep 18 22:22:12 2006
+++ netdns.h    Wed Sep 27 01:36:26 2006
@@ -1,4 +1,7 @@
 #include &lt;sys/types.h&gt;
+#if defined&#40;_MSC_VER&#41; || defined&#40;__MINGW32_VERSION&#41;
+#include &lt;windows.h&gt;
+#endif
 #define TESTVAL 4
 extern double foo&#40;int, long, const char*&#41;;

Just a single 

typedef unsigned char u_char;

is enough here instead of fat windows.h. Also, IMO winsock2.h would
still be a better alternative if you want to include a header for some
reason instead of copy/pasting the standard BSD definition.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;22&nbsp;05:20:47&nbsp;2006</span>
    <span class="description">OLAF [...] cpan.org - Ticket #24042:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> OLAF [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

Would you be willing to be so kind and test the version that is currently on the development 
trunk. I have very few means to test the windows environments properly.

svn co <span class="clickylink"><a target="new" rel="nofollow" href="http://www.net-dns.org/svn/net-dns/trunk/">http://www.net-dns.org/svn/net-dns/trunk/</a></span> net-dns-trunk

should do the trick.

--Olaf

On Thu Dec 21 19:14:39 2006, nimnul wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In Net-DNS-0.59 distribution netdns.c refuses to compile on Win32/Visual
&gt; C++ &#40;I tried 2005, but earlier versions should have the same problem&#41;.
&gt; 
&gt; It&#39;s due to broken/non-compliant sys/types.h on Windows. u_char type is
&gt; not defined there, so you should add something like
&gt; 
&gt; #ifdef _WIN32
&gt; typedef unsigned char u_char;
&gt; #endif
&gt; 
&gt; I&#39;m not sure what exactly you should detect &#40;e.g. it might compile using
&gt; cygwin/gcc even without this patch&#41;, so maybe you should use other
&gt; condition.
&gt; 
&gt; This patch alone doesn&#39;t make Net::DNS using the XS part on Windows due
&gt; to problems with makefile &#40;I will post that issue as another bug&#41; but
&gt; with this patch Makefile.PL starts to detect the compiler successfully.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;22&nbsp;05:20:49&nbsp;2006</span>
    <span class="description">The RT System itself - Ticket #24042:  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;22&nbsp;05:21:15&nbsp;2006</span>
    <span class="description">OLAF [...] cpan.org - Ticket #24042:  Merged into ticket #21752</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;22&nbsp;05:21:15&nbsp;2006</span>
    <span class="description">OLAF [...] cpan.org -  Merged into ticket #21752</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;22&nbsp;07:23:27&nbsp;2006</span>
    <span class="description">andy.melnikov [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andy.melnikov [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Works with the latest activeperl &#40;5.8.x&#41; and MS Visual C++ 2005.

But I think the patches described here are hacks rather than proper
implementations.

Microsoft used BSD sockets implementation initially for their IP stack,
so during porting they needed several standard declarations not found in
non-compliant MSVC sys/types.h header. But fixing the header would break
old code, so they decided to use a hack and added those declarations to
winsock.h instead:

/*
 * Basic system type definitions, taken from the BSD file sys/types.h.
 */
typedef unsigned char   u_char;
typedef unsigned short  u_short;
typedef unsigned int    u_int;
typedef unsigned long   u_long;

&#40;the comment is by Microsoft&#41;

Winsock.h is included when windows.h is included. But actually we don&#39;t
need neither winsock.h nor windows.h - we need just this little hack
from Microsoft. So I think replacing #include &lt;windows.h&gt; with just

typedef unsigned char   u_char;

would be a replacement of one hack with another. But obviously from my
variant it more clear and can be easier fixed if Microsoft would make
compliant headers some day.

Regarding the &#34;^O Win32&#34; patch to makefile.pl I also have a better
solution, so I will publish it later here.

On Птн. Дек. 22 05:20:47 2006, OLAF wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; 
</div>&gt; Would you be willing to be so kind and test the version that is
&gt; currently on the development
&gt; trunk. I have very few means to test the windows environments
&gt; properly.
&gt; 
&gt; svn co <span class="clickylink"><a target="new" rel="nofollow" href="http://www.net-dns.org/svn/net-dns/trunk/">http://www.net-dns.org/svn/net-dns/trunk/</a></span> net-dns-trunk
&gt; 
&gt; should do the trick.
&gt; 
&gt; --Olaf
&gt; 
&gt; On Thu Dec 21 19:14:39 2006, nimnul wrote:
<div class="message-stanza open">&gt; &gt; In Net-DNS-0.59 distribution netdns.c refuses to compile on
</div>&gt; Win32/Visual
<div class="message-stanza open">&gt; &gt; C++ &#40;I tried 2005, but earlier versions should have the same
</div>&gt; problem&#41;.
<div class="message-stanza open">&gt; &gt;
&gt; &gt; It&#39;s due to broken/non-compliant sys/types.h on Windows. u_char type
</div>&gt; is
<div class="message-stanza open">&gt; &gt; not defined there, so you should add something like
&gt; &gt;
&gt; &gt; #ifdef _WIN32
&gt; &gt; typedef unsigned char u_char;
&gt; &gt; #endif
&gt; &gt;
&gt; &gt; I&#39;m not sure what exactly you should detect &#40;e.g. it might compile
</div>&gt; using
<div class="message-stanza open">&gt; &gt; cygwin/gcc even without this patch&#41;, so maybe you should use other
&gt; &gt; condition.
&gt; &gt;
&gt; &gt; This patch alone doesn&#39;t make Net::DNS using the XS part on Windows
</div>&gt; due
<div class="message-stanza open">&gt; &gt; to problems with makefile &#40;I will post that issue as another bug&#41;
</div>&gt; but
<div class="message-stanza open">&gt; &gt; with this patch Makefile.PL starts to detect the compiler
</div>&gt; successfully.
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;24&nbsp;10:04:00&nbsp;2007</span>
    <span class="description">OLAF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

So just to be sure; looking at those variables that Alexandr suggested will not break anything.
Or is just looking at WIN32 prefered?

This is what I have now:

#include &lt;sys/types.h&gt;
#if defined&#40;_MSC_VER&#41; || defined&#40;__MINGW32_VERSION&#41;
typedef unsigned char u_char;
#endif
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;24&nbsp;10:04:10&nbsp;2007</span>
    <span class="description">OLAF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

So just to be sure; looking at those variables that Alexandr suggested will not break anything.
Or is just looking at WIN32 prefered?

This is what I have now:

#include &lt;sys/types.h&gt;
#if defined&#40;_MSC_VER&#41; || defined&#40;__MINGW32_VERSION&#41;
typedef unsigned char u_char;
#endif
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;22&nbsp;12:18:42&nbsp;2007</span>
    <span class="description">jloverso [...] mathworks.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jloverso [...] mathworks.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Just to let you know, I&#39;m sucessfully building and using Net-DNS 0.59 on
Windows &#40;and Linux, Sol 5.10 and Mac 10.4&#41; with the current trunk
versions of netdns.h and Makefile.PL; which include the fixes for this
bug as well as the fix for 22334 &#40;netdns.a not built when XS forced&#41;.

Perhaps you could release an 0.60?  Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;11:52:49&nbsp;2007</span>
    <span class="description">OLAF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perhaps you could release an 0.60?  Thanks.
</div>
0.60 was released last week
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;11:52:51&nbsp;2007</span>
    <span class="description">OLAF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;11:53:28&nbsp;2007</span>
    <span class="description">OLAF [...] cpan.org -  Fixed in 0.59 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
