<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #9178 for Spreadsheet-ParseExcel-Simple: Spreadsheet::ParseExcel::Simple Suggested Change</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #9178 for Spreadsheet-ParseExcel-Simple: Spreadsheet::ParseExcel::Simple Suggested Change</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel-Simple/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel-Simple/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel-Simple/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel-Simple/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel-Simple">Spreadsheet-ParseExcel-Simple CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">9178</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Spreadsheet-ParseExcel-Simple/Active/">Spreadsheet-ParseExcel-Simple</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
bill [...] tribley.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29458-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29459-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;27&nbsp;11:19:50&nbsp;2004</span>
    <span class="description">bill [...] tribley.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Bill Tribley&#34; &lt;bill [...] tribley.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;kasei [...] tmtm.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Spreadsheet::ParseExcel::Simple Suggested Change</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 May 2004 21:37:46 -0500</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Tony,
Thank you for writing this Simple interface. I have been using it for a year and liking it a lot!

In the last 6 months I have been working with Japanese spreadsheets. As you know, the original authors of the Spreadsheet stuff are Japanese, they have good support for Asian languages. But, the Simple module as it is now does not permit passing the FormatObject which permits processing different character sets. 

I have made a trivial modification in Spreadsheet::ParseExcel::Simple which permits this. Would it be possible to include it in the distro? 

Here is a diff:

root@mail dir[/usr/local/lib/perl5/site_perl/5.8.3/Spreadsheet/ParseExcel]
$ diff Simple.pm Simple.pm.orig
35,39c35
&lt;   # Simplest Case
&lt;   my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;&#41;; # Default Charset
&lt;
&lt;   # Case of using Character Formats
&lt;   use Spreadsheet::ParseExcel::FmtJapan; # Many others available
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;&#41;;
</div>41,45c37,38
&lt;   my $oFmtJ = Spreadsheet::ParseExcel::FmtJapan-&gt;new&#40;Code =&gt; &#39;sjis&#39;&#41;; # euc, jis, etc.
&lt;   my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;,$oFmtJ&#41;;
&lt;
&lt; This opens the spreadsheet specified for you. $formatObject is optional, used for
&lt; non-default characters sets. Returns undef if we cannot read the book.
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This opens the spreadsheet specified for you. Returns undef if we cannot
&gt; read the book.
</div>87,94c80,81
&lt;   my &#40;$class,$sheetPath,$charFormatObject&#41; = @_;
&lt;   my $book;
&lt;   if &#40;defined $charFormatObject&#41;{
&lt;       $book = Spreadsheet::ParseExcel-&gt;new-&gt;Parse&#40;$sheetPath,$charFormatObject&#41; or return;
&lt;     }
&lt;   else {
&lt;     $book = Spreadsheet::ParseExcel-&gt;new-&gt;Parse&#40;$sheetPath&#41; or return;
&lt;     }
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;   my $class = shift;
&gt;   my $book = Spreadsheet::ParseExcel-&gt;new-&gt;Parse&#40;shift&#41; or return;
</div>
Here is the first 100 lines of the changed module:
package Spreadsheet::ParseExcel::Simple;
 
use strict;
use Spreadsheet::ParseExcel;
use vars qw/$VERSION/;
$VERSION = &#39;1.01&#39;;
 
=head1 NAME
 
Spreadsheet::ParseExcel::Simple - A simple interface to Excel data
 
=head1 SYNOPSIS
 
  my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;&#41;;
  foreach my $sheet &#40;$xls-&gt;sheets&#41; {
     while &#40;$sheet-&gt;has_data&#41; {
         my @data = $sheet-&gt;next_row;
     }
  }
 
=head1 DESCRIPTION
 
This provides an abstraction to the Spreadsheet::ParseExcel module for
simple reading of values.
 
You simply loop over the sheets, and fetch rows to arrays.
 
For anything more complex, you probably want to use
Spreadsheet::ParseExcel directly.
 
=head1 METHODS
 
=head2 read
 
  # Simplest Case
  my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;&#41;; # Default Charset
   
  # Case of using Character Formats
  use Spreadsheet::ParseExcel::FmtJapan; # Many others available
 
  my $oFmtJ = Spreadsheet::ParseExcel::FmtJapan-&gt;new&#40;Code =&gt; &#39;sjis&#39;&#41;; # euc, jis, etc.
  my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;,$oFmtJ&#41;;
 
This opens the spreadsheet specified for you. $formatObject is optional, used for
non-default characters sets. Returns undef if we cannot read the book.
 
=head2 sheets
 
  @sheets = $xls-&gt;sheets;
 
Each spreadsheet can contain one or more worksheets. This fetches them
all back. You can then iterate over them, or jump straight to the one
you wish to play with.
 
=head2 has_data
 
  if &#40;$sheet-&gt;has_data&#41; { ... }
 
This lets us know if there are more rows in this sheet that we haven&#39;t
read yet. This allows us to differentiate between an empty row, and
the end of the sheet.
 
=head2 next_row
 
  my @data = $sheet-&gt;next_row;
 
Fetch the next row of data back.
 
=head1 AUTHOR
 
Tony Bowden, E&lt;lt&gt;kasei@tmtm.comE&lt;gt&gt;.
 
=head1 SEE ALSO
 
L&lt;Spreadsheet::ParseExcel&gt;.
 
=head1 COPYRIGHT
 
Copyright &#40;C&#41; 2001 Tony Bowden. All rights reserved.
 
This module is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.
 
=cut
 
sub read {
  my &#40;$class,$sheetPath,$charFormatObject&#41; = @_;
  my $book;
  if &#40;defined $charFormatObject&#41;{
        $book = Spreadsheet::ParseExcel-&gt;new-&gt;Parse&#40;$sheetPath,$charFormatObject&#41; or return;
    }
  else {
    $book = Spreadsheet::ParseExcel-&gt;new-&gt;Parse&#40;$sheetPath&#41; or return;
    }
  bless { book =&gt; $book }, $class;
}
 
sub book { shift-&gt;{book} }
 
sub sheets {
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;27&nbsp;11:19:50&nbsp;2004</span>
    <span class="description">bill [...] tribley.org - Ticket #9177:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Bill Tribley&#34; &lt;bill [...] tribley.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;&#39;Tony Bowden&#39;&#34; &lt;kasei [...] tmtm.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: Spreadsheet::ParseExcel::Simple Suggested Change</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 21 May 2004 08:49:26 -0500</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Tony,
I agree. I will try it out this weekend if I can.
Bill



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Tony Bowden [mailto:kasei@tmtm.com]
Sent: Thursday, May 20, 2004 3:17 AM
To: Bill Tribley
Subject: Re: Spreadsheet::ParseExcel::Simple Suggested Change


On Wed, May 19, 2004 at 09:37:46PM -0500, Bill Tribley wrote:
<div class="message-stanza open">&gt; Thank you for writing this Simple interface. I have been using it for
&gt; a year and liking it a lot!
</div>
Thanks.

<div class="message-stanza open">&gt; I have made a trivial modification in Spreadsheet::ParseExcel::Simple
&gt; which permits this. Would it be possible to include it in the distro?
</div>
This looks plausible, except I&#39;d rather the following arguments came as
a hashref rather than just a positional arg, in case I need to add more
later.

i.e. instead of 
  my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;,$oFmtJ&#41;

I&#39;d rather have:
  my $xls = Spreadsheet::ParseExcel::Simple-&gt;read&#40;&#39;spreadsheet.xls&#39;, {
    format =&gt; $oFmtJ
  }&#41;;

Or something similar to that. I&#39;m a little busy at the minute to get
this done, but I&#39;ll try to get round to it soon.

Look OK?

Thanks,

Tony
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;03&nbsp;18:02:00&nbsp;2005</span>
    <span class="description">TMTM [...] cpan.org - Ticket #9177:  Ticket 9177 MergedInto ticket 9178.</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
