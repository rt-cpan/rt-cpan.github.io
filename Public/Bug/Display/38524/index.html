<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #38524 for Catalyst-Plugin-PageCache: [PATCH] White labelling</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #38524 for Catalyst-Plugin-PageCache: [PATCH] White labelling</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Catalyst-Plugin-PageCache/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Catalyst-Plugin-PageCache/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Catalyst-Plugin-PageCache/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Catalyst-Plugin-PageCache/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Catalyst-Plugin-PageCache">Catalyst-Plugin-PageCache CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">38524</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Catalyst-Plugin-PageCache/Active/">Catalyst-Plugin-PageCache</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
m.e [...] acm.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-5242-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-5243-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;16&nbsp;11:13:36&nbsp;2008</span>
    <span class="description">m.e [...] acm.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] White labelling</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Patch to allow override to page key to allow different pages to be
served based on site name, user name etc.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 14keymaker.t</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!perl

use strict;
use warnings;
no warnings &#39;redefine&#39;;

use FindBin;
use lib &#34;$FindBin::Bin/lib&#34;;
use Test::More;
use File::Path;

BEGIN {
    eval &#34;use Catalyst::Plugin::Cache::FileCache&#34;;
    plan $@
      ? &#40; skip_all =&gt; &#39;needs Catalyst::Plugin::Cache::FileCache for testing&#39; &#41;
      : &#40; tests =&gt; 8 &#41;;
}

# This test that options can be passed to cache.

# remove previous cache
rmtree &#39;t/var&#39; if -d &#39;t/var&#39;;

use Catalyst::Test &#39;TestApp&#39;;

# add config option
TestApp-&gt;config-&gt;{page_cache}-&gt;{key_maker} = sub {
    my &#40;$c&#41; = @_;
    return $c-&gt;req-&gt;base . q{/} . $c-&gt;req-&gt;path;
};

# cache a page
ok&#40; my $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host1/cache/count&#39;&#41;">http://host1/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 1, &#39;count is 1&#39; &#41;;

# page will be served from cache
ok&#40; $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host1/cache/count&#39;&#41;">http://host1/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 1, &#39;count is still 1 from cache&#39; &#41;;

# page will not be served from cache
ok&#40; $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host2/cache/count&#39;&#41;">http://host2/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 2, &#39;count is 2 from cache&#39; &#41;;

# page will be served from cache
ok&#40; $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host2/cache/count&#39;&#41;">http://host2/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 2, &#39;count is still 2 from cache&#39; &#41;;
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> patch.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: PageCache.pm
===================================================================
@@ -311,13 +313,15 @@
 
 sub _get_page_cache_key {
     my $c = shift;
-    
+
     # We can&#39;t rely on the params after the user&#39;s code has run, so
     # use the key created during the initial dispatch phase
     return $c-&gt;_page_cache_key if &#40; $c-&gt;_page_cache_key &#41;;
 
-    my $key = &#34;/&#34; . $c-&gt;req-&gt;path;
-    
+    # override key if required
+    my $keymaker = $c-&gt;config-&gt;{page_cache}-&gt;{key_maker};
+    my $key = $keymaker ? $keymaker-&gt;&#40;$c&#41; : &#34;/&#34; . $c-&gt;req-&gt;path;
+
     # prepend language if I18N present.
     if &#40; $c-&gt;can&#40;&#39;language&#39;&#41; &#41; {
         $key = &#39;:&#39; . $c-&gt;language . &#39;:&#39; . $key;
@@ -479,6 +483,17 @@
 Note that this is called BEFORE auto_check_user, so you have more flexibility
 to determine what to do for not logged in users.
 
+To override the generation of page keys:
+
+__PACKAGE__-&gt;config&#40;
+    page_cache =&gt; {
+        key_maker =&gt; sub {
+            my &#40;$c&#41; = @_;
+            return $c-&gt;req-&gt;base . &#39;/&#39; . $c-&gt;req-&gt;path;
+          }
+    }
+&#41;;
+
 =head1 METHODS
 
 =head2 cache_page
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;18&nbsp;06:01:07&nbsp;2008</span>
    <span class="description">mst [...] shadowcat.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #38524] [PATCH] White labelling</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 18 Aug 2008 11:00:38 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Martin via RT &lt;bug-Catalyst-Plugin-PageCache [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Matt S Trout &lt;mst [...] shadowcat.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, Aug 16, 2008 at 11:13:40AM -0400, Martin via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sat Aug 16 11:13:36 2008: Request 38524 was acted upon.
&gt; Transaction: Ticket created by m.e
&gt;        Queue: Catalyst-Plugin-PageCache
&gt;      Subject: [PATCH] White labelling
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: Normal
&gt;        Owner: Nobody
&gt;   Requestors: m.e@acm.org
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=38524">http://rt.cpan.org/Ticket/Display.html?id=38524</a></span> &gt;
&gt; 
&gt; 
&gt; Patch to allow override to page key to allow different pages to be
&gt; served based on site name, user name etc.
</div>
wrong config key still.

-- 
      Matt S Trout       Need help with your Catalyst or DBIx::Class project?
   Technical Director                    <span class="clickylink"><a target="new" rel="nofollow" href="http://www.shadowcat.co.uk/catalyst/">http://www.shadowcat.co.uk/catalyst/</a></span>
 Shadowcat Systems Ltd.  Want a managed development or deployment platform?
<span class="clickylink"><a target="new" rel="nofollow" href="http://chainsawblues.vox.com/">http://chainsawblues.vox.com/</a></span>            <span class="clickylink"><a target="new" rel="nofollow" href="http://www.shadowcat.co.uk/servers/">http://www.shadowcat.co.uk/servers/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;18&nbsp;06:01:23&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;22&nbsp;02:48:35&nbsp;2008</span>
    <span class="description">m.e [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ...with Plugin::PageCache key</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> m.e [...] acm.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">i have added a new version of the patch and the test file. This uses the
new Plugin::PageCache key.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!perl

use strict;
use warnings;
no warnings &#39;redefine&#39;;

use FindBin;
use lib &#34;$FindBin::Bin/lib&#34;;
use Test::More;
use File::Path;

BEGIN {
    eval &#34;use Catalyst::Plugin::Cache::FileCache&#34;;
    plan $@
      ? &#40; skip_all =&gt; &#39;needs Catalyst::Plugin::Cache::FileCache for testing&#39; &#41;
      : &#40; tests =&gt; 8 &#41;;
}

# This test that options can be passed to cache.

# remove previous cache
rmtree &#39;t/var&#39; if -d &#39;t/var&#39;;

use Catalyst::Test &#39;TestApp&#39;;

# add config option
# cannot call TestApp-&gt;config&#40;&#41; because TestApp has already called setup
TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{key_maker} = sub {
    my &#40;$c&#41; = @_;
    return $c-&gt;req-&gt;base . q{/} . $c-&gt;req-&gt;path;
};

# cache a page
ok&#40; my $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host1/cache/count&#39;&#41;">http://host1/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 1, &#39;count is 1&#39; &#41;;

# page will be served from cache
ok&#40; $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host1/cache/count&#39;&#41;">http://host1/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 1, &#39;count is still 1 from cache&#39; &#41;;

# page will not be served from cache
ok&#40; $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host2/cache/count&#39;&#41;">http://host2/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 2, &#39;count is 2 from cache&#39; &#41;;

# page will be served from cache
ok&#40; $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://host2/cache/count&#39;&#41;">http://host2/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
is&#40; $res-&gt;content, 2, &#39;count is still 2 from cache&#39; &#41;;
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: PageCache.pm
===================================================================
--- PageCache.pm	&#40;revision 756&#41;
+++ PageCache.pm	&#40;working copy&#41;
@@ -24,7 +24,7 @@
     if &#40; ref&#40;$args[0]&#41; eq &#39;HASH&#39; || @args &gt; 1 &#41; {
         my $options = ref&#40; $args[0] &#41; ? shift : { @args };
 
-        $options-&gt;{cache_seconds} = $c-&gt;config-&gt;{page_cache}-&gt;{expires}
+        $options-&gt;{cache_seconds} = $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{expires}
             unless exists $options-&gt;{cache_seconds};
 
         $c-&gt;_cache_page&#40; $options &#41;;
@@ -37,9 +37,8 @@
     $expires = $expires-&gt;epoch - time
         if ref&#40;$expires&#41; &#38;&#38; $expires-&gt;isa&#40;&#39;DateTime&#39;&#41;;
 
+    $expires ||= $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{expires};
 
-    $expires ||= $c-&gt;config-&gt;{page_cache}-&gt;{expires};
-
     # mark the page for caching during finalize
     if &#40; $expires &gt; 0 &#41; {
         $c-&gt;_cache_page&#40; { cache_seconds =&gt; $expires } &#41;;
@@ -61,11 +60,12 @@
             delete $index-&gt;{$key};
             $removed++;
             $c-&gt;log-&gt;debug&#40; &#34;Removed $key from page cache&#34; &#41;
-                if &#40; $c-&gt;config-&gt;{page_cache}-&gt;{debug} &#41;;
+              if &#40;$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{debug}&#41;;
         }
     }
     $c-&gt;cache-&gt;set&#40; &#34;_page_cache_index&#34;, $index,
-        $c-&gt;config-&gt;{page_cache}-&gt;{no_expire} &#41; if &#40; $removed &#41;;
+        $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{no_expire}&#41;
+      if &#40;$removed&#41;;
 }
 
 sub dispatch {
@@ -74,15 +74,16 @@
     # never serve POST request pages from cache
     return $c-&gt;NEXT::dispatch&#40;@_&#41; if &#40; $c-&gt;req-&gt;method eq &#34;POST&#34; &#41;;
 
-    my $hook = $c-&gt;config-&gt;{page_cache}-&gt;{cache_hook} ?
-        $c-&gt;can&#40;$c-&gt;config-&gt;{page_cache}-&gt;{cache_hook}&#41; : undef;
+    my $hook =
+        $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{cache_hook}
+      ? $c-&gt;can&#40;$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{cache_hook}&#41;
+      : undef;
     return $c-&gt;NEXT::dispatch&#40;@_&#41; if &#40; $hook &#38;&#38; !$c-&gt;$hook&#40;&#41; &#41;;
 
-    return $c-&gt;NEXT::dispatch&#40;@_&#41; if &#40;
-        $c-&gt;config-&gt;{page_cache}-&gt;{auto_check_user} &#38;&#38;
-        $c-&gt;can&#40;&#39;user_exists&#39;&#41; &#38;&#38;
-        $c-&gt;user_exists
-    &#41;;
+    return $c-&gt;NEXT::dispatch&#40;@_&#41;
+      if &#40; $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{auto_check_user}
+        &#38;&#38; $c-&gt;can&#40;&#39;user_exists&#39;&#41;
+        &#38;&#38; $c-&gt;user_exists&#41;;
 
     # check the page cache for a cached copy of this page
     return $c-&gt;NEXT::dispatch&#40;@_&#41;
@@ -95,30 +96,28 @@
 
     if &#40; $data-&gt;{expire_time} and $data-&gt;{expire_time} &lt;= time &#41; {
         $c-&gt;log-&gt;debug&#40; &#34;Expiring $key from page cache&#34; &#41;
-            if &#40; $c-&gt;config-&gt;{page_cache}-&gt;{debug} &#41;;
+          if &#40;$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{debug}&#41;;
 
         $c-&gt;cache-&gt;remove&#40; $key &#41;;
 
         my $index = $c-&gt;cache-&gt;get&#40; &#34;_page_cache_index&#34; &#41; || {};
         delete $index-&gt;{$key};
         $c-&gt;cache-&gt;set&#40; &#34;_page_cache_index&#34;, $index,
-            $c-&gt;config-&gt;{page_cache}-&gt;{no_expire} &#41;;
+            $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{no_expire}&#41;;
 
         return $c-&gt;NEXT::dispatch&#40;@_&#41;;
     }
 
-    $c-&gt;log-&gt;debug&#40; &#34;Serving $key from page cache, expires in &#34; .
-        &#40; $data-&gt;{expire_time} - time &#41; . &#34; seconds&#34; &#41;
-        if &#40; $c-&gt;config-&gt;{page_cache}-&gt;{debug} &#41;;
+    $c-&gt;log-&gt;debug&#40;&#34;Serving $key from page cache, expires in &#34;
+          . &#40;$data-&gt;{expire_time} - time&#41;
+          . &#34; seconds&#34;&#41;
+      if &#40;$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{debug}&#41;;
 
     $c-&gt;_page_cache_used&#40; 1 &#41;;
 
-
     # Check If-Modified-Since headers
     return 1 if $c-&gt;_page_cache_not_modified&#40; $data &#41;;
 
-
-
     # Serve cached page
 
     $c-&gt;res-&gt;body&#40; $data-&gt;{body} &#41;;
@@ -126,11 +125,9 @@
     $c-&gt;res-&gt;content_type&#40; join &#39;; &#39;, @{$data-&gt;{content_type}} &#41;
         if $data-&gt;{content_type};
 
-
     $c-&gt;res-&gt;content_encoding&#40; $data-&gt;{content_encoding} &#41;
         if $data-&gt;{content_encoding};
 
-
     $c-&gt;_set_page_cache_headers&#40; $data &#41;;
 
     $c-&gt;res-&gt;header&#40;&#39;X-PageCache&#39;, &#39;Catalyst&#39;&#41;;
@@ -157,15 +154,13 @@
     return;
 }
 
-
 # Sets cache headers for the page if set_http_headers is true.
 
 sub _set_page_cache_headers {
     my &#40; $c, $data &#41; = @_;
 
-    return unless $c-&gt;config-&gt;{page_cache}-&gt;{set_http_headers};
+    return unless $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{set_http_headers};
 
-
     if &#40; exists $data-&gt;{expires} &#41; {
 
         # page cache but not client cache
@@ -175,15 +170,16 @@
             return;
         }
 
-        $c-&gt;res-&gt;headers-&gt;header&#40; &#39;Cache-Control&#39; =&gt;
-            &#34;max-age=&#34; . $data-&gt;{expires} &#41;;
+        $c-&gt;res-&gt;headers-&gt;header&#40;
+            &#39;Cache-Control&#39; =&gt; &#34;max-age=&#34; . $data-&gt;{expires}&#41;;
 
         $c-&gt;res-&gt;headers-&gt;expires&#40; time + $data-&gt;{expires} &#41;;
 
-    } else {
+    }
+    else {
 
-        $c-&gt;res-&gt;headers-&gt;header&#40; &#39;Cache-Control&#39; =&gt;
-            &#34;max-age=&#34; . &#40; $data-&gt;{expire_time} - time &#41; &#41;;
+        $c-&gt;res-&gt;headers-&gt;header&#40;
+            &#39;Cache-Control&#39; =&gt; &#34;max-age=&#34; . &#40;$data-&gt;{expire_time} - time&#41;&#41;;
 
         $c-&gt;res-&gt;headers-&gt;expires&#40; $data-&gt;{expire_time} &#41;;
     }
@@ -198,33 +194,37 @@
     # never cache POST requests
     return $c-&gt;NEXT::finalize&#40;@_&#41; if &#40; $c-&gt;req-&gt;method eq &#34;POST&#34; &#41;;
 
-    my $hook = $c-&gt;config-&gt;{page_cache}-&gt;{cache_hook} ?
-        $c-&gt;can&#40;$c-&gt;config-&gt;{page_cache}-&gt;{cache_hook}&#41; : undef;
+    my $hook =
+        $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{cache_hook}
+      ? $c-&gt;can&#40;$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{cache_hook}&#41;
+      : undef;
     return $c-&gt;NEXT::finalize&#40;@_&#41; if &#40; $hook &#38;&#38; !$c-&gt;$hook&#40;&#41; &#41;;
 
-
-    return $c-&gt;NEXT::finalize&#40;@_&#41; if &#40;
-        $c-&gt;config-&gt;{page_cache}-&gt;{auto_check_user} &#38;&#38;
-        $c-&gt;can&#40;&#39;user_exists&#39;&#41; &#38;&#38;
-        $c-&gt;user_exists
-    &#41;;
+    return $c-&gt;NEXT::finalize&#40;@_&#41;
+      if &#40; $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{auto_check_user}
+        &#38;&#38; $c-&gt;can&#40;&#39;user_exists&#39;&#41;
+        &#38;&#38; $c-&gt;user_exists&#41;;
     return $c-&gt;NEXT::finalize&#40;@_&#41; if &#40; scalar @{ $c-&gt;error } &#41;;
 
     # if we already served the current request from cache, we can skip the
     # rest of this method
     return $c-&gt;NEXT::finalize&#40;@_&#41; if &#40; $c-&gt;_page_cache_used &#41;;
 
-    if &#40; !$c-&gt;_cache_page &#38;&#38; scalar @{ $c-&gt;config-&gt;{page_cache}-&gt;{auto_cache} } &#41; {
+    if &#40;!$c-&gt;_cache_page
+        &#38;&#38; scalar @{ $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{auto_cache} }&#41;
+    {
+
         # is this page part of the auto_cache list?
         my $path = &#34;/&#34; . $c-&gt;req-&gt;path;
 
         # For performance, this should be moved to setup, and generate a hash.
         AUTO_CACHE:
-        foreach my $auto &#40; @{ $c-&gt;config-&gt;{page_cache}-&gt;{auto_cache} } &#41; {
+        foreach my $auto &#40;@{ $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{auto_cache} }&#41;
+        {
             next if $auto =~ m/^\d$/;
             if &#40; $path =~ /^$auto$/ &#41; {
                 $c-&gt;log-&gt;debug&#40; &#34;Auto-caching page $path&#34; &#41;
-                    if &#40; $c-&gt;config-&gt;{page_cache}-&gt;{debug} &#41;;
+                  if &#40;$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{debug}&#41;;
                 $c-&gt;cache_page;
                 last AUTO_CACHE;
             }
@@ -236,17 +236,19 @@
 
         my $now = time;
 
+        $c-&gt;log-&gt;debug&#40;
+            &#34;Caching page $key for $options-&gt;{cache_seconds} seconds&#34;&#41;
+          if &#40;$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{debug}&#41;;
 
-        $c-&gt;log-&gt;debug&#40; &#34;Caching page $key for $options-&gt;{cache_seconds} seconds&#34; &#41;
-            if &#40; $c-&gt;config-&gt;{page_cache}-&gt;{debug} &#41;;
-
         # Cache some additional metadata along with the content
         # Some caches don&#39;t support expirations, so we do it manually
         my $data = {
             body =&gt; $c-&gt;res-&gt;body || undef,
             content_type =&gt; [ $c-&gt;res-&gt;content_type ] || undef,
             content_encoding =&gt; $c-&gt;res-&gt;content_encoding || undef,
-            create_time =&gt; $options-&gt;{last_modified} || $c-&gt;res-&gt;headers-&gt;last_modified || $now,
+            create_time      =&gt; $options-&gt;{last_modified}
+              || $c-&gt;res-&gt;headers-&gt;last_modified
+              || $now,
             expire_time =&gt; $now + $options-&gt;{cache_seconds},
         };
 
@@ -256,7 +258,6 @@
 
         $c-&gt;_set_page_cache_headers&#40; $data &#41;;  # don&#39;t forget the first time
 
-
         # Keep an index cache of all pages that have been cached, for use
         # with clear_cached_page
 
@@ -265,7 +266,7 @@
 
         # Save date in cache
         $c-&gt;cache-&gt;set&#40; &#34;_page_cache_index&#34;, $index,
-            $c-&gt;config-&gt;{page_cache}-&gt;{no_expire} &#41;;
+            $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{no_expire}&#41;;
 
         # Check for If-Modified-Since
         $c-&gt;_page_cache_not_modified&#40; $data &#41;;
@@ -279,10 +280,14 @@
 
     $c-&gt;NEXT::setup&#40;@_&#41;;
 
-    $c-&gt;config-&gt;{page_cache}-&gt;{auto_cache} ||= [];
-    $c-&gt;config-&gt;{page_cache}-&gt;{expires} ||= 60 * 5;
-    $c-&gt;config-&gt;{page_cache}-&gt;{set_http_headers} ||= 0;
-    $c-&gt;config-&gt;{page_cache}-&gt;{debug} ||= $c-&gt;debug;
+    # allow code using old config key to work
+    if &#40;$c-&gt;config-&gt;{page_cache} and !$c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}&#41; {
+        $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;} = $c-&gt;config-&gt;{page_cache};
+    }
+    $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{auto_cache}       ||= [];
+    $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{expires}          ||= 60 * 5;
+    $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{set_http_headers} ||= 0;
+    $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{debug}            ||= $c-&gt;debug;
 
     # detect the cache plugin being used and set appropriate
     # never-expires syntax
@@ -295,13 +300,15 @@
 
         # Older Cache plugins
         if &#40; $c-&gt;cache-&gt;isa&#40;&#39;Cache::FileCache&#39;&#41; &#41; {
-            $c-&gt;config-&gt;{page_cache}-&gt;{no_expire} = &#34;never&#34;;
+            $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{no_expire} = &#34;never&#34;;
         }
-        elsif &#40; $c-&gt;cache-&gt;isa&#40;&#39;Cache::Memcached&#39;&#41; ||
-                  $c-&gt;cache-&gt;isa&#40;&#39;Cache::FastMmap&#39;&#41; &#41; {
+        elsif &#40;$c-&gt;cache-&gt;isa&#40;&#39;Cache::Memcached&#39;&#41;
+            || $c-&gt;cache-&gt;isa&#40;&#39;Cache::FastMmap&#39;&#41;&#41;
+        {
+
           # Memcached defaults to &#39;never&#39; when not given an expiration
           # In FastMmap, it&#39;s not possible to set an expiration
-          $c-&gt;config-&gt;{page_cache}-&gt;{no_expire} = undef;
+            $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{no_expire} = undef;
         }
     }
     else {
@@ -316,7 +323,9 @@
     # use the key created during the initial dispatch phase
     return $c-&gt;_page_cache_key if &#40; $c-&gt;_page_cache_key &#41;;
 
-    my $key = &#34;/&#34; . $c-&gt;req-&gt;path;
+    # override key if required
+    my $keymaker = $c-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{key_maker};
+    my $key = $keymaker ? $keymaker-&gt;&#40;$c&#41; : &#34;/&#34; . $c-&gt;req-&gt;path;
     
     # prepend language if I18N present.
     if &#40; $c-&gt;can&#40;&#39;language&#39;&#41; &#41; {
@@ -357,7 +366,8 @@
     use Catalyst;
     MyApp-&gt;setup&#40; qw/Cache::FileCache PageCache/ &#41;;
 
-    MyApp-&gt;config-&gt;{page_cache} = {
+    __PACKAGE__-&gt;config&#40;
+      &#39;Plugin::PageCache&#39; =&gt; {
         expires =&gt; 300,
         set_http_headers =&gt; 1,
         auto_cache =&gt; [
@@ -369,7 +379,7 @@
         # determine if the page should be cached.  This is called both
         # before dispatch, and before finalize.
         cache_hook =&gt; &#39;some_method&#39;
-    };
+    }&#41;;
     
     sub some_method {
         my &#40; $c &#41; = @_;
@@ -479,6 +489,17 @@
 Note that this is called BEFORE auto_check_user, so you have more flexibility
 to determine what to do for not logged in users.
 
+To override the generation of page keys:
+
+__PACKAGE__-&gt;config&#40;
+    &#39;Plugin::PageCache&#39; =&gt; {
+        key_maker =&gt; sub {
+            my &#40;$c&#41; = @_;
+            return $c-&gt;req-&gt;base . &#39;/&#39; . $c-&gt;req-&gt;path;
+          }
+    }
+&#41;;
+
 =head1 METHODS
 
 =head2 cache_page
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;22&nbsp;11:03:28&nbsp;2008</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Aug 22 02:48:35 2008, m.e wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; i have added a new version of the patch and the test file. This uses the
&gt; new Plugin::PageCache key.
</div>
Thanks for the patch.  Unfortunately it looks like it breaks a lot of
the other tests:

Failed Test            Stat Wstat Total Fail  Failed  List of Failed
-------------------------------------------------------------------------------
t/05expires.t             1   256     6    1  16.67%  6
t/06auto_cache.t          3   768     8    3  37.50%  4 6 8
t/07set_http_headers.t    3   768     7    3  42.86%  5-7
t/09datetime.t            3   768     7    3  42.86%  5-7
t/10options.t             3   768     7    3  42.86%  5-7
t/11nocache.t             2   512     7    2  28.57%  5-6
t/13cachehook.t           5  1280    16    5  31.25%  5 11 13-15
2 tests skipped.
Failed 7/15 test scripts, 53.33% okay. 20/121 subtests failed, 83.47% okay.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;22&nbsp;12:23:06&nbsp;2008</span>
    <span class="description">m.e [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] ...patch existing tests</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> m.e [...] acm.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please also apply the attached patch to the test files. The problem is
that the tests are modifying the config hash after setup has been run.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: t/05expires.t
===================================================================
--- t/05expires.t	&#40;revision 768&#41;
+++ t/05expires.t	&#40;working copy&#41;
@@ -21,7 +21,7 @@
 use Catalyst::Test &#39;TestApp&#39;;
 
 # add config option
-TestApp-&gt;config-&gt;{page_cache}-&gt;{expires} = 2;
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{expires} = 2;
 
 # cache a page
 ok&#40; my $res = request&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/cache/count&#39;&#41;">http://localhost/cache/count&#39;&#41;</a></span>, &#39;request ok&#39; &#41;;
Index: t/06auto_cache.t
===================================================================
--- t/06auto_cache.t	&#40;revision 768&#41;
+++ t/06auto_cache.t	&#40;working copy&#41;
@@ -21,7 +21,7 @@
 use Catalyst::Test &#39;TestApp&#39;;
 
 # add config option
-TestApp-&gt;config-&gt;{page_cache}-&gt;{auto_cache} = [
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{auto_cache} = [
     &#39;/cache/auto_count&#39;,
     &#39;/cache/another.+&#39;,
 ];
Index: t/07set_http_headers.t
===================================================================
--- t/07set_http_headers.t	&#40;revision 768&#41;
+++ t/07set_http_headers.t	&#40;working copy&#41;
@@ -21,7 +21,7 @@
 use Catalyst::Test &#39;TestApp&#39;;
 
 # add config option
-TestApp-&gt;config-&gt;{page_cache}-&gt;{set_http_headers} = 1;
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{set_http_headers} = 1;
 
 # cache a page
 my $cache_time = time;
Index: t/09datetime.t
===================================================================
--- t/09datetime.t	&#40;revision 768&#41;
+++ t/09datetime.t	&#40;working copy&#41;
@@ -30,7 +30,7 @@
 use Catalyst::Test &#39;TestApp&#39;;
 
 # add config option
-TestApp-&gt;config-&gt;{page_cache}-&gt;{set_http_headers} = 1;
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{set_http_headers} = 1;
 
 # cache a page
 my $cache_time = time;
Index: t/10options.t
===================================================================
--- t/10options.t	&#40;revision 768&#41;
+++ t/10options.t	&#40;working copy&#41;
@@ -23,7 +23,7 @@
 use Catalyst::Test &#39;TestApp&#39;;
 
 # add config option
-TestApp-&gt;config-&gt;{page_cache}-&gt;{set_http_headers} = 1;
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{set_http_headers} = 1;
 
 # cache a page
 my $cache_time = time;
Index: t/11nocache.t
===================================================================
--- t/11nocache.t	&#40;revision 768&#41;
+++ t/11nocache.t	&#40;working copy&#41;
@@ -23,7 +23,7 @@
 use Catalyst::Test &#39;TestApp&#39;;
 
 # add config option
-TestApp-&gt;config-&gt;{page_cache}-&gt;{set_http_headers} = 1;
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{set_http_headers} = 1;
 
 # cache a page
 my $cache_time = time;
Index: t/13cachehook.t
===================================================================
--- t/13cachehook.t	&#40;revision 768&#41;
+++ t/13cachehook.t	&#40;working copy&#41;
@@ -24,8 +24,8 @@
 use Catalyst::Test &#39;TestApp&#39;;
 
 # add config option
-TestApp-&gt;config-&gt;{page_cache}-&gt;{set_http_headers} = 1;
-TestApp-&gt;config-&gt;{page_cache}-&gt;{cache_hook}   = &#39;use_pagecache&#39;;
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{set_http_headers} = 1;
+TestApp-&gt;config-&gt;{&#39;Plugin::PageCache&#39;}-&gt;{cache_hook}   = &#39;use_pagecache&#39;;
 
 local *TestApp::use_pagecache = sub { 0 };
 cmp_ok&#40; TestApp-&gt;use_pagecache&#40;&#41;, &#39;==&#39;, &#39;0&#39; &#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;22&nbsp;12:58:38&nbsp;2008</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Applied in 0.19.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;22&nbsp;12:58:41&nbsp;2008</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
