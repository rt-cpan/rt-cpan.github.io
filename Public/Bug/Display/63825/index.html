<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #63825 for Plack-App-Apache-ActionWrapper: Win32 compatibility/platform independence and Plack::Server deprecated</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #63825 for Plack-App-Apache-ActionWrapper: Win32 compatibility/platform independence and Plack::Server deprecated</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Plack-App-Apache-ActionWrapper/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Plack-App-Apache-ActionWrapper/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Plack-App-Apache-ActionWrapper/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Plack-App-Apache-ActionWrapper/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Plack-App-Apache-ActionWrapper">Plack-App-Apache-ActionWrapper CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">63825</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Plack-App-Apache-ActionWrapper/Active/">Plack-App-Apache-ActionWrapper</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ronaldxs [...] software-path.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-230900-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.02    </td>
  </tr>
  <tr id="CF-230901-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;11&nbsp;07:11:31&nbsp;2010</span>
    <span class="description">ronaldxs [...] software-path.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Win32 compatibility/platform independence and Plack::Server
 deprecated</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
I got the module working under Ubuntu Linux and partially working on 
Windows Vista but on Win32 when I tried to bring up the index URL &#40;eg 
<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost">http://localhost</a></span>&#41; I got the &#34;No .psgi file found&#34; error.  On looking 
into the problem I noticed that _resolve_app_filename was assuming that 
the path separator for the PATH_TRANSLATED was the forward &#39;/&#39; which is 
not true on Win32 Apache 2.X where you get &#39;\&#39; backslash separators.  
So this patch uses File::Spec to split up and rejoin path segments 
until it finds the longest path section that maps to a file.  This 
should make _resolve_app_filename more platform independent.

I am new to Plack but noticed in the docs that the Plack::Server 
modules, referred to in your POD, are now deprecated.  So this patch 
includes about two lines that change the Plack::Server references to 
Plack::Handler and I have tested with the changed psgi.fcgi and it 
seems to work.

The patch has been tested under Windows Vista with Strawberry Perl 5.12 
and Apache 2.2 and Ubuntu 8.04 with Perl 5.8.8 and Apache 2.2.8.

Good luck and thanks for the module,
Ron
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ActionWrapper.pm.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">10c10
&lt; 
---
&gt; use File::Spec;
59a60,62
&gt;     my &#40;$vol, $pt_dir&#41; = File::Spec-&gt;splitpath&#40;$path_translated&#41;;
&gt;     my @path_parts = File::Spec-&gt;splitdir&#40;$pt_dir&#41;;
&gt; 
61,64c64,68
&lt;     my @path_parts = split&#40;m{/}, $path_translated&#41;;
&lt;     while &#40; ! -r join&#40;&#34;/&#34;, @path_parts&#41; &#41; {
&lt;         last if @path_parts == 0; # Break out if we&#39;re at the end
&lt;         pop @path_parts;
---
&gt;     while &#40; not -r $path_translated and @path_parts &#41; {
&gt;         my $f = pop @path_parts;
&gt;         $path_translated = File::Spec-&gt;catpath&#40;
&gt;             $vol, File::Spec-&gt;catdir&#40;@path_parts&#41;, $f
&gt;         &#41;;	
67,74c71
&lt;     # Return undef &#40;that is, no app&#41; if no path part was a readable file
&lt;     return if @path_parts == 0;
&lt; 
&lt;     # Execute the contents of the file and return last variable defined in it
&lt;     my $psgi_file = join&#40;&#34;/&#34;, @path_parts &#41;;
&lt; 
&lt;     # Cache the app to allow persistent running
&lt;     return $psgi_file;
---
&gt;     return -r $path_translated &#38;&#38; $path_translated;
166,167c163,164
&lt;     use Plack::Server::FCGI;
&lt;     Plack::Server::FCGI-&gt;new-&gt;run&#40;$app&#41;;
---
&gt;     use Plack::Handler::FCGI;
&gt;     Plack::Handler::FCGI-&gt;new-&gt;run&#40;$app&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;19&nbsp;13:00:21&nbsp;2010</span>
    <span class="description">ROBINS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Dec 11 13:11:31 2010, ronaldxs wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; I got the module working under Ubuntu Linux and partially working on 
&gt; Windows Vista but on Win32 when I tried to bring up the index URL &#40;eg 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost">http://localhost</a></span>&#41; I got the &#34;No .psgi file found&#34; error.  On looking 
&gt; into the problem I noticed that _resolve_app_filename was assuming that 
&gt; the path separator for the PATH_TRANSLATED was the forward &#39;/&#39; which is 
&gt; not true on Win32 Apache 2.X where you get &#39;\&#39; backslash separators.  
&gt; So this patch uses File::Spec to split up and rejoin path segments 
&gt; until it finds the longest path section that maps to a file.  This 
&gt; should make _resolve_app_filename more platform independent.
</div>
I&#39;ve applied the patch on
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/robinsmidsrod/Plack-App-Apache-ActionWrapper">https://github.com/robinsmidsrod/Plack-App-Apache-ActionWrapper</a></span>, commit
07f05ef2e9d9e48a653495cb8f5a118827d4b108.

Could you test it out on your system and verify that it works as intended?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am new to Plack but noticed in the docs that the Plack::Server 
&gt; modules, referred to in your POD, are now deprecated.  So this patch 
&gt; includes about two lines that change the Plack::Server references to 
&gt; Plack::Handler and I have tested with the changed psgi.fcgi and it 
&gt; seems to work.
</div>
Thanks for the catch! Didn&#39;t know that it had been deprecated. Have
applied that fix in the same commit as well.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;19&nbsp;13:00:22&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;19&nbsp;21:03:04&nbsp;2010</span>
    <span class="description">ronaldxs [...] software-path.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ronaldxs [...] software-path.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Could you test it out on your system and verify that it works as 
</div>intended?
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
</div>
I did a git clone and copied over the module on my Win/Vista system and 
did some basic testing which checked out fine.

Thanks,
Ron
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;20&nbsp;03:19:03&nbsp;2010</span>
    <span class="description">ROBINS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Released version 0.30.0 to CPAN with your patch included. Should close
this issue.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;20&nbsp;03:19:04&nbsp;2010</span>
    <span class="description">ROBINS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
