<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #83235 for Tk: Perl v5.13.0-58-gefaf367 broke SREZIC/Tk-804.030.tar.gz</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #83235 for Tk: Perl v5.13.0-58-gefaf367 broke SREZIC/Tk-804.030.tar.gz</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Tk">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Tk">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Tk">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Tk">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Tk">Tk CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">83235</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Tk">Tk</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ANDK [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Unimportant    </td>
  </tr>
  <tr id="CF-33610-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
804.030    </td>
  </tr>
  <tr id="CF-33611-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




tkstopwatch.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1179307/622121/tkstopwatch.pl">
Sat Feb 09 05:17:49 2013 (1k) by ANDK [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=83235">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1179307" href="/Public/Bug/Display.html?id=83235#txn-1179307">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;09&nbsp;05:17:49&nbsp;2013</span>
    <span class="description">ANDK [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Perl v5.13.0-58-gefaf367 broke SREZIC/Tk-804.030.tar.gz</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1179307/622120/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/622120">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The attached program exposes the effect of the change referenced in the
subject. Before the change the Label widget displayed the formatted
running time just fine, but after the change it doesn&#39;t. Instead it
displays random strings, often Unicode strings, but also often nothing
at all. Here is the commit message of he change:

commit efaf36747029c85b4d8825318cb4d485a0bb350e                        
        Author: David Mitchell &lt;davem@iabyn.com&gt;
Date:   Sun Apr 25 00:56:32 2010 +0100

    add Perl_magic_methcall

    Add a new function that wraps the setup needed to call a magic
method like
    FETCH &#40;the existing S_magic_methcall function has been renamed
    S_magic_methcall1&#41;.

    There is one functional change, done mainly to allow for a single clean
    wrapper function, and that is that the method calls are no longer
wrapped
    with SAVETMPS/FREETMPS. Previously only about half of them had this, so
    some relied on the caller to free, some didn&#39;t. At least we&#39;re
consistent
    now. Doing it this way is necessary because otherwise magic_methcall&#40;&#41;
    can&#39;t return an SV &#40;eg for POP&#41; because it&#39;ll be a temp and get freed by
    FREETMPS before it gets returned. So you&#39;d have to copy everything,
which
    would slow things down.


HTH,
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> tkstopwatch.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1179307/622121/tkstopwatch.pl">Download tkstopwatch.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use Tk;
use Tk::ProgressBar;
use strict;

our $TV = &#34;0.00&#34;;

my&#40;%tinfo&#41; =
    &#40;
     w =&gt; undef,
     s =&gt; 0,
     h =&gt; 0,
     p =&gt; 1,
    &#41;;

sub tick {
    return if $tinfo{p};
    $tinfo{h} += 5;
    if &#40;$tinfo{h} &gt;= 100&#41; {
        $tinfo{h} = 0;
        $tinfo{s}++;
    }
    $TV = sprintf&#40;&#34;%d.%02d&#34;, $tinfo{s}, $tinfo{h}&#41;;
    $tinfo{w}-&gt;after&#40;50, \&#38;tick&#41;;

}

my $MW = MainWindow-&gt;new;
$MW-&gt;bind&#40;&#39;&lt;Control-c&gt;&#39; =&gt; \&#38;exit&#41;;
$MW-&gt;bind&#40;&#39;&lt;Control-q&gt;&#39; =&gt; \&#38;exit&#41;;
$tinfo{w} = $MW;

my $start = $MW-&gt;Button&#40;
    -text         =&gt; &#39;Start/Pause&#39;,
    -command      =&gt; sub {$tinfo{p}^=1; tick},
&#41;;

my $counter = $MW-&gt;Label&#40;
    -relief       =&gt; &#39;raised&#39;,
    -width        =&gt; 10,
    -textvariable =&gt; \$TV,
&#41;;

$counter-&gt;pack&#40;-side =&gt; &#39;bottom&#39;, -fill =&gt; &#39;both&#39;&#41;;
$start-&gt;pack&#40;-side =&gt; &#39;bottom&#39;, -fill =&gt; &#39;both&#39;, -expand =&gt; &#39;yes&#39;&#41;;
my $pb = $MW-&gt;ProgressBar&#40;
    -width =&gt; 200,
    -length =&gt; 800,
    -anchor =&gt; &#34;w&#34;,
    -from =&gt; 0,
    -to =&gt; 800,
    -blocks =&gt; 800,
    -colors =&gt; [0, &#34;green&#34;],
    -variable =&gt; \$TV,
&#41;-&gt;pack;
MainLoop;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1179372" href="/Public/Bug/Display.html?id=83235#txn-1179372">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;09&nbsp;12:12:56&nbsp;2013</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1179372/622153/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/622153">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 629b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here&#39;s an even shorter example --- without Tk::ProgressBar, instead
using a tied scalar. The label should show the string &#34;changed&#34;, but
some random string is shown instead. The problem is independent from
perl, I could reproduce it with 5.8.9 and 5.16.1.

    use strict;
    use Tk;
    use Tie::Scalar;
    my $mw=tkinit;
    tie my $val, &#39;Tie::StdScalar&#39;;
    $val = &#34;init&#34;;
    my $l = $mw-&gt;Label&#40;-textvariable =&gt; \$val&#41;-&gt;pack;
    $mw-&gt;afterIdle&#40;sub { $val = &#34;changed&#34; }&#41;;
    MainLoop;

The mentioned perl commit is probably not causing the problem, it&#39;s more
likely that data is handled differently.

Regards,
    Slaven
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1179375" href="/Public/Bug/Display.html?id=83235#txn-1179375">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;09&nbsp;12:12:59&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1213456" href="/Public/Bug/Display.html?id=83235#txn-1213456">#</a>      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;17&nbsp;16:53:44&nbsp;2013</span>
    <span class="description">SREZIC [...] cpan.org -  Severity Normal changed to Unimportant</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1746476" href="/Public/Bug/Display.html?id=83235#txn-1746476">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;27&nbsp;06:34:04&nbsp;2017</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1746476/939408/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/939408">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 892b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2013-02-09 12:12:56, SREZIC wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here&#39;s an even shorter example --- without Tk::ProgressBar, instead
&gt; using a tied scalar. The label should show the string &#34;changed&#34;, but
&gt; some random string is shown instead. The problem is independent from
&gt; perl, I could reproduce it with 5.8.9 and 5.16.1.
&gt; 
&gt;     use strict;
&gt;     use Tk;
&gt;     use Tie::Scalar;
&gt;     my $mw=tkinit;
&gt;     tie my $val, &#39;Tie::StdScalar&#39;;
&gt;     $val = &#34;init&#34;;
&gt;     my $l = $mw-&gt;Label&#40;-textvariable =&gt; \$val&#41;-&gt;pack;
&gt;     $mw-&gt;afterIdle&#40;sub { $val = &#34;changed&#34; }&#41;;
&gt;     MainLoop;
&gt; 
&gt; The mentioned perl commit is probably not causing the problem, it&#39;s more
&gt; likely that data is handled differently.
&gt; 
</div>
Update: on a debian/jessie system I could reproduce the problem with perls ranging from 5.8.8 to 5.18.4, but not anymore with 5.20.2 and later &#40;Tk installed here: 804.032 .. 804.034, does not seem to matter&#41;.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.410783</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
