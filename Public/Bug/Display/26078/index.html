<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #26078 for Spreadsheet-ParseExcel: test failures under ActivePerl build 820, Win XP</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #26078 for Spreadsheet-ParseExcel: test failures under ActivePerl build 820, Win XP</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">26078</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MTHURN [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.30    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;03&nbsp;17:30:44&nbsp;2007</span>
    <span class="description">MTHURN [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test failures under ActivePerl build 820, Win XP</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">        C:\Perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&#34;test_harness&#40;0, &#39;blib\li
b&#39;, &#39;blib\arch&#39;&#41;&#34; t/*.t t/examples/*t
t/basic.................
#   Failed test &#39;use Spreadsheet::ParseExcel;&#39;
#   in t/basic.t at line 8.
#     Tried to use &#39;Spreadsheet::ParseExcel&#39;.
#     Error:  Weak references are not implemented in the version of perl
at C:\source
\perl\.cpanplus\5.8.8\build\Spreadsheet-ParseExcel-0.30\blib\lib/Spreadsheet/ParseExc
el.pm line 67
# BEGIN failed--compilation aborted at t/basic.t line 8.
# Compilation failed in require at &#40;eval 3&#41; line 2.
# BEGIN failed--compilation aborted at &#40;eval 3&#41; line 2.
dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 1
        Failed 1/8 tests, 87.50% okay &#40;less 3 skipped tests: 4 okay, 50.00%&#41;
t/examples/chkFmt.......# Looks like you failed 1 test of 8.
ok
t/examples/chkInfo......# sample/Excel/FmtTest.xls
# Could not run example: Bad file descriptor

#   Failed test in t/lib/Test/Example.pm at line 49.
# Lists are not the same length. Expected is 7485 long, while received
is 0 long
# Looks like you failed 1 test of 2.
dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 2
        Failed 1/2 tests, 50.00% okay
t/examples/dmpExR.......# sample/Excel/Rich.xls
# Could not run example: Bad file descriptor

#   Failed test in t/lib/Test/Example.pm at line 49.
# Lists are not the same length. Expected is 68 long, while received is
0 long
# Looks like you failed 1 test of 2.
dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 2
        Failed 1/2 tests, 50.00% okay
t/examples/iftest.......# sample/Excel/Test97.xls
# Could not run example: Bad file descriptor

#   Failed test in t/lib/Test/Example.pm at line 49.
# Lists are not the same length. Expected is 22 long, while received is
0 long
# Looks like you failed 1 test of 2.
dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 2
        Failed 1/2 tests, 50.00% okay
t/examples/sample.......# Could not run example: Bad file descriptor

#   Failed test in t/lib/Test/Example.pm at line 49.
# Lists are not the same length. Expected is 91 long, while received is
0 long
# Looks like you failed 1 test of 2.
dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 2
        Failed 1/2 tests, 50.00% okay
t/examples/sample_j.....skipped
        all skipped: Jcode needed for this test
t/examples/sampleOEM....skipped
        all skipped: We need Unicode::Map and CP932Excel.map has to be
installed some
how...  This test is not in use currently
t/examples/warning......# Could not run example: Bad file descriptor

#   Failed test in t/lib/Test/Example.pm at line 49.
# Lists are not the same length. Expected is 2 long, while received is 0
long
# Looks like you failed 1 test of 2.
dubious
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 2
        Failed 1/2 tests, 50.00% okay
t/memory_leak...........skipped
        all skipped: Proc::ProcessTable is needed for this test
t/parse.................
dubious
        Test returned status 255 &#40;wstat 65280, 0xff00&#41;
DIED. FAILED tests 1-37
        Failed 37/37 tests, 0.00% okay
t/pod...................#   Failed test &#39;use Spreadsheet::ParseExcel;&#39;
#   in t/parse.t at line 10.
#     Tried to use &#39;Spreadsheet::ParseExcel&#39;.
#     Error:  Weak references are not implemented in the version of perl
at C:\source
\perl\.cpanplus\5.8.8\build\Spreadsheet-ParseExcel-0.30\blib\lib/Spreadsheet/ParseExc
el.pm line 67
# BEGIN failed--compilation aborted at t/parse.t line 10.
# Compilation failed in require at &#40;eval 3&#41; line 2.
# BEGIN failed--compilation aborted at &#40;eval 3&#41; line 2.
Can&#39;t locate object method &#34;new&#34; via package &#34;Spreadsheet::ParseExcel&#34;
at C:\source\p
erl\.cpanplus\5.8.8\build\Spreadsheet-ParseExcel-0.30\blib\lib/Spreadsheet/ParseExcel
.pm line 33.
# Looks like you planned 37 tests but only ran 1.
# Looks like you failed 1 test of 1 run.
# Looks like your test died just after 1.
ok
t/sample................# Skipping 0 test as they need Jcode to be installed
skipped
        all skipped: Tests moved to individual files in t/examples/
Failed Test          Stat Wstat Total Fail  List of Failed
-------------------------------------------------------------------------------
t/basic.t               1   256     8    1  1
t/examples/chkInfo.t    1   256     2    1  2
t/examples/dmpExR.t     1   256     2    1  2
t/examples/iftest.t     1   256     2    1  2
t/examples/sample.t     1   256     2    1  2
t/examples/warning.t    1   256     2    1  2
t/parse.t             255 65280    37   73  1-37
4 tests and 3 subtests skipped.
Failed 7/13 test scripts. 43/108 subtests failed.
Files=13, Tests=108,  5 wallclock secs &#40; 0.00 cusr +  0.00 csys =  0.00 CPU&#41;
Failed 7/13 test programs. 43/108 subtests failed.
NMAKE : fatal error U1077: &#39;C:\WINDOWS\system32\cmd.exe&#39; : return code
&#39;0xff&#39;
Stop.


[ERROR] Unable to create a new distribution object for
&#39;Spreadsheet::ParseExcel&#39; -- c
annot continue

*** Install log written to:
 
C:\source\perl\.cpanplus\install-logs\Spreadsheet-ParseExcel-1175635550.log

Error installing &#39;Spreadsheet::ParseExcel&#39;
Problem installing one or more modules

-- 
 - - Martin &#39;Kingpin&#39; Thurn
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;08&nbsp;08:18:41&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Apr 03 17:30:44 2007, MTHURN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         C:\Perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&gt; &#34;test_harness&#40;0, &#39;blib\li
&gt; b&#39;, &#39;blib\arch&#39;&#41;&#34; t/*.t t/examples/*t
&gt; t/basic.................
&gt; #   Failed test &#39;use Spreadsheet::ParseExcel;&#39;
&gt; #   in t/basic.t at line 8.
&gt; #     Tried to use &#39;Spreadsheet::ParseExcel&#39;.
&gt; #     Error:  Weak references are not implemented in the version of
&gt; perl
</div>
Hi,

I think that this problem may have been particular to ActivePerl build
820 which didn&#39;t implement Scalar::Util::weaken correctly.

I don&#39;t see the same problem in build 822.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;08&nbsp;08:18:42&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;10&nbsp;09:19:23&nbsp;2009</span>
    <span class="description">mthurn [...] verizon.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #26078] test failures under ActivePerl build 820, Win XP</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 10 Jan 2009 09:19:04 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Spreadsheet-ParseExcel [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Martin Thurn&#34; &lt;mthurn [...] verizon.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">You&#39;re probably right.  And I&#39;ve since upgraded to build 1002, so I have no way to go back and retest.  

 - - Martin
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;10&nbsp;09:42:40&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jan 10 09:19:23 2009, mthurn@verizon.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; You&#39;re probably right.  And I&#39;ve since upgraded to build 1002, so I
&gt; have no way to go back and retest.
</div>
Hi,

In that case I&#39;ll close this issue. If it occurs again you can  reopen the tracker.

Thanks,

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;10&nbsp;09:42:56&nbsp;2009</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
