<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #17680 for SVN-Notify: SVN::Notify seems to have a hardcoded path to svn and svnlook</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #17680 for SVN-Notify: SVN::Notify seems to have a hardcoded path to svn and svnlook</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=SVN-Notify">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=SVN-Notify">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=SVN-Notify">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=SVN-Notify">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/theory/svn-notify/issues/">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/SVN-Notify">SVN-Notify CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">17680</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=SVN-Notify">SVN-Notify</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ANDK [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-30306-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-30307-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.52    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=17680">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165389" href="/Public/Bug/Display.html?id=17680#txn-165389">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;16&nbsp;10:51:02&nbsp;2006</span>
    <span class="description">ANDK [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0.031 seems to have a hardcoded path to svn and svnlook</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/165389/52809/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/52809">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 616b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks much for fixing 17649! I&#39;ve downloaded 0.031, Build runs fine,
nearly all tests fail. On a quick inspection, the error messages all
look a bit like this:

Can&#39;t exec &#34;/usr/local/bin/svnlook&#34;: No such file or directory at
/usr/local/share/perl/5.8.7/SVN/Notify.pm line 1526.
Cannot exec /usr/local/bin/svnlook: No such file or directory
Use of uninitialized value in substitution &#40;s///&#41; at
/usr/local/share/perl/5.8.7/SVN/Notify.pm line 764.
Use of uninitialized value in substitution &#40;s///&#41; at
/usr/local/share/perl/5.8.7/SVN/Notify.pm line 765.
Child process exited: 512


My svn and svnlook are in /usr/bin/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165400" href="/Public/Bug/Display.html?id=17680#txn-165400">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;16&nbsp;12:39:51&nbsp;2006</span>
    <span class="description">jpeacock [...] cpan.org -  Subject changed from &#39;0.031 seems to have a hardcoded path to svn and svnlook&#39; to &#39;SVN::Notify seems to have a hardcoded path to svn and svnlook&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165401" href="/Public/Bug/Display.html?id=17680#txn-165401">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;16&nbsp;12:39:51&nbsp;2006</span>
    <span class="description">jpeacock [...] cpan.org -  Queue changed from SVN-Notify-Mirror to SVN-Notify</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165595" href="/Public/Bug/Display.html?id=17680#txn-165595">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;17&nbsp;04:42:19&nbsp;2006</span>
    <span class="description">ANDK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/165595/52925/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/52925">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 502b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">In an email from John Peacock I got the explanation which I want to
disclose to interested parties:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is hardcoded in SVN::Notify here:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     # Set up default values.
&gt;     $params{svnlook}   ||= $ENV{SVNLOOK}  || &#39;/usr/local/bin/svnlook&#39;;
</div>
I think I would call it a bug if the PATH environment is not honoured
when trying to execute an external command.

When I come to think if it, I&#39;m also surprised that SVN::Notify passed
its test suite. Is the test suite too forgiving or too intelligent?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165620" href="/Public/Bug/Display.html?id=17680#txn-165620">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;17&nbsp;05:36:25&nbsp;2006</span>
    <span class="description">ANDK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> John Peacock &lt;jpeacock [...] rowman.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/165620/52934/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/52934">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 946b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 17 04:42:19 2006, ANDK wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &gt;     $params{svnlook}   ||= $ENV{SVNLOOK}  || &#39;/usr/local/bin/svnlook&#39;;
</div>
From this snippet I got the impression that I can run
SVN::Notify::Mirror&#39;s test suite with


 SVNLOOK=svnlook SVN=svn ./Build test

This is not the case. So I start to believe that somebody under the
hooks might set $params{svnlook}.

Besides I do not understand why the usual incantation to run single test
scripts does not find SVN::Notify::Mirror as in this try:

~/.cpan/build/SVN-Notify-Mirror-0.031% perl -Mblib t/001_basic.t  |&#38; head
ok 1 - Directories are consistent at rev: 1
Can&#39;t locate SVN/Notify/Mirror.pm in @INC &#40;@INC contains: /etc/perl
/usr/local/lib/perl/5.8.7 /usr/local/share/perl/5.8.7 /usr/lib/perl5
/usr/share/perl5 /usr/lib/perl/5.8 /usr/share/perl/5.8
/usr/local/lib/site_perl /usr/local/lib/perl/5.8.4
/usr/local/share/perl/5.8.4 .&#41; at &#40;eval 1&#41; line 3.
not ok 2 - Directories are consistent at rev: 2
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165623" href="/Public/Bug/Display.html?id=17680#txn-165623">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;17&nbsp;05:36:26&nbsp;2006</span>
    <span class="description">ANDK [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165628" href="/Public/Bug/Display.html?id=17680#txn-165628">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;17&nbsp;06:10:29&nbsp;2006</span>
    <span class="description">jpeacock [...] rowman.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #17680] SVN::Notify seems to have a hardcoded path to svn and svnlook</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 17 Feb 2006 06:09:56 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Peacock &lt;jpeacock [...] rowman.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/165628/52940/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/52940">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Andreas Koenig via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Feb 17 04:42:19 2006, ANDK wrote:
&gt; 
<div class="message-stanza open">&gt;&gt;&gt;     $params{svnlook}   ||= $ENV{SVNLOOK}  || &#39;/usr/local/bin/svnlook&#39;;
</div>&gt; 
&gt; From this snippet I got the impression that I can run
&gt; SVN::Notify::Mirror&#39;s test suite with
&gt; 
&gt; 
&gt;  SVNLOOK=svnlook SVN=svn ./Build test
&gt; 
&gt; This is not the case. So I start to believe that somebody under the
&gt; hooks might set $params{svnlook}.
</div>
WFM:

$ sudo mv /usr/local/bin/svnlook /usr/local/bin/svnlook.bad
$ SVNLOOK=svnlook.bad ./Build test
t/001_basic........ok
t/002_config.......ok
t/003_sshtest......ok
t/004_rsynctest....ok
All tests successful.
Files=4, Tests=117, 54 wallclock secs &#40; 8.13 cusr +  1.68 csys =  9.81 CPU&#41;

Oh, I see.  SVNLOOK is an overrideable option in SVN::Notify, but SVN is not.
That I can fix; give me a moment...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Besides I do not understand why the usual incantation to run single test
&gt; scripts does not find SVN::Notify::Mirror as in this try:
&gt; 
&gt; ~/.cpan/build/SVN-Notify-Mirror-0.031% perl -Mblib t/001_basic.t  |&#38; head
&gt; ok 1 - Directories are consistent at rev: 1
&gt; Can&#39;t locate SVN/Notify/Mirror.pm in @INC &#40;@INC contains: /etc/perl
&gt; /usr/local/lib/perl/5.8.7 /usr/local/share/perl/5.8.7 /usr/lib/perl5
&gt; /usr/share/perl5 /usr/lib/perl/5.8 /usr/share/perl/5.8
&gt; /usr/local/lib/site_perl /usr/local/lib/perl/5.8.4
&gt; /usr/local/share/perl/5.8.4 .&#41; at &#40;eval 1&#41; line 3.
&gt; not ok 2 - Directories are consistent at rev: 2
&gt; 
</div>
WFM
$ perl -Mblib t/001_basic.t
ok 1 - Directories are consistent at rev: 1
ok 2 - Updated project1/trunk to correct revision: 2
ok 3 - Correct files updated in project1/trunk at rev: 2
ok 4 - Directories are consistent at rev: 2
ok 5 - No changes in project1/tags/TRUNK-1135534439 at revision: 3
...

FWIW, running single tests with Module::Build is usually done

        $ ./Build test --test_files t/001_basic.t

but the other way should work too... :&#40;

John

-- 
John Peacock
Director of Information Research and Technology
Rowman &#38; Littlefield Publishing Group
4720 Boston Way
Lanham, MD 20706
301-459-3366 x.5010
fax 301-429-5747
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165765" href="/Public/Bug/Display.html?id=17680#txn-165765">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;17&nbsp;13:15:36&nbsp;2006</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #17680] SVN::Notify seems to have a hardcoded path to svn and svnlook </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 17 Feb 2006 10:14:37 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Wheeler &lt;dwheeler [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/165765/53023/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/53023">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 17, 2006, at 01:42, Andreas Koenig via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; This is hardcoded in SVN::Notify here:
</div>&gt;
<div class="message-stanza open">&gt;&gt;     # Set up default values.
&gt;&gt;     $params{svnlook}   ||= $ENV{SVNLOOK}  || &#39;/usr/local/bin/ 
&gt;&gt; svnlook&#39;;
</div>&gt;
&gt; I think I would call it a bug if the PATH environment is not honoured
&gt; when trying to execute an external command.
</div>
Well, I made it default to /usr/local/bin/svnlook because, when  
SVN::Notify is run from Apache &#40;as is common with subversion&#41;, it  
could not find anything in the path, because there is no PATH  
environment variable there. I don&#39;t know about when it&#39;s running  
outside of Apache, though.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When I come to think if it, I&#39;m also surprised that SVN::Notify passed
&gt; its test suite. Is the test suite too forgiving or too intelligent?
</div>
I guess it&#39;s too intelligent. The tests all point to t/bin/ 
testsvnlook, which is a Perl script that mimics svnlook. Same with  
sendmail.


On Feb 17, 2006, at 03:10, John Peacock via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Oh, I see.  SVNLOOK is an overrideable option in SVN::Notify, but  
&gt; SVN is not.
&gt; That I can fix; give me a moment...
</div>
Yes, SVN::Notify doesn&#39;t use svn, just svnlook.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; WFM
&gt; $ perl -Mblib t/001_basic.t
&gt; ok 1 - Directories are consistent at rev: 1
&gt; ok 2 - Updated project1/trunk to correct revision: 2
&gt; ok 3 - Correct files updated in project1/trunk at rev: 2
&gt; ok 4 - Directories are consistent at rev: 2
&gt; ok 5 - No changes in project1/tags/TRUNK-1135534439 at revision: 3
&gt; ...
&gt;
&gt; FWIW, running single tests with Module::Build is usually done
&gt;
&gt;       $ ./Build test --test_files t/001_basic.t
&gt;
&gt; but the other way should work too... :&#40;
</div>
As should prove t/001_basic.t.

Anyway, what is the upshot here with regard to SVN::Notify? Should I  
just make it default to &#39;svnlook&#39; instead of &#39;/usr/local/bin/ 
svnlook&#39;? That may well break installations for folks who rely on the  
default path, but it&#39;ll only take a second for them to fix it.

Opinions welcome.

Best,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-165959" href="/Public/Bug/Display.html?id=17680#txn-165959">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;18&nbsp;02:52:35&nbsp;2006</span>
    <span class="description">andreas.koenig.gmwojprw [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> ANDK [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #17680] SVN::Notify seems to have a hardcoded path to svn and svnlook</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 18 Feb 2006 08:51:33 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andreas.koenig.gmwojprw [...] franz.ak.mind.de &#40;Andreas J. Koenig&#41;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/165959/53156/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/53156">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; On Fri, 17 Feb 2006 13:15:37 -0500 &#40;EST&#41;, &#34;David Wheeler via RT&#34; &lt;bug-SVN-Notify@rt.cpan.org&gt; said:
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; On Feb 17, 2006, at 01:42, Andreas Koenig via RT wrote:
<div class="message-stanza open"><div class="message-stanza open"> &gt;&gt;&gt; This is hardcoded in SVN::Notify here:
</div> &gt;&gt; 
<div class="message-stanza open"> &gt;&gt;&gt; # Set up default values.
 &gt;&gt;&gt; $params{svnlook}   ||= $ENV{SVNLOOK}  || &#39;/usr/local/bin/ 
 &gt;&gt;&gt; svnlook&#39;;
</div> &gt;&gt; 
 &gt;&gt; I think I would call it a bug if the PATH environment is not honoured
 &gt;&gt; when trying to execute an external command.
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Well, I made it default to /usr/local/bin/svnlook because, when  
  &gt; SVN::Notify is run from Apache &#40;as is common with subversion&#41;, it  
  &gt; could not find anything in the path, because there is no PATH  
  &gt; environment variable there. I don&#39;t know about when it&#39;s running  
  &gt; outside of Apache, though.
</div>
I read your explanation later in the docs somewhere. I&#39;m sorry that I
did not find it earlier.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"> &gt;&gt; When I come to think if it, I&#39;m also surprised that SVN::Notify passed
 &gt;&gt; its test suite. Is the test suite too forgiving or too intelligent?
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; I guess it&#39;s too intelligent. The tests all point to t/bin/ 
  &gt; testsvnlook, which is a Perl script that mimics svnlook. Same with  
  &gt; sendmail.
</div>
Ok, for sendmail this makes a lot of sense, not sure for svnlook. If
people have no svnlook, your tests should probably fail.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; On Feb 17, 2006, at 03:10, John Peacock via RT wrote:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"> &gt;&gt; Oh, I see.  SVNLOOK is an overrideable option in SVN::Notify, but  
 &gt;&gt; SVN is not.
 &gt;&gt; That I can fix; give me a moment...
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Yes, SVN::Notify doesn&#39;t use svn, just svnlook.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"> &gt;&gt; WFM
 &gt;&gt; $ perl -Mblib t/001_basic.t
 &gt;&gt; ok 1 - Directories are consistent at rev: 1
 &gt;&gt; ok 2 - Updated project1/trunk to correct revision: 2
 &gt;&gt; ok 3 - Correct files updated in project1/trunk at rev: 2
 &gt;&gt; ok 4 - Directories are consistent at rev: 2
 &gt;&gt; ok 5 - No changes in project1/tags/TRUNK-1135534439 at revision: 3
 &gt;&gt; ...
 &gt;&gt; 
 &gt;&gt; FWIW, running single tests with Module::Build is usually done
 &gt;&gt; 
 &gt;&gt; $ ./Build test --test_files t/001_basic.t
 &gt;&gt; 
 &gt;&gt; but the other way should work too... :&#40;
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; As should prove t/001_basic.t.
</div>
John sent me a prerelease of the next version and with that I had
neither this or the other problem, so from my point of view all bugs
appear fixed.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Anyway, what is the upshot here with regard to SVN::Notify? Should I  
  &gt; just make it default to &#39;svnlook&#39; instead of &#39;/usr/local/bin/ 
  &gt; svnlook&#39;? That may well break installations for folks who rely on the  
  &gt; default path, but it&#39;ll only take a second for them to fix it.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Opinions welcome.
</div>
CPAN::FirstTime has a find_exe routine:

sub find_exe {
    my&#40;$exe,$path&#41; = @_;
    my&#40;$dir&#41;;
    #warn &#34;in find_exe exe[$exe] path[@$path]&#34;;
    for $dir &#40;@$path&#41; {
        my $abs = File::Spec-&gt;catfile&#40;$dir,$exe&#41;;
        if &#40;&#40;$abs = MM-&gt;maybe_command&#40;$abs&#41;&#41;&#41; {
            return $abs;
        }
    }
}

which is typically used like

    my&#40;@path&#41; = split /$Config{&#39;path_sep&#39;}/, $ENV{&#39;PATH&#39;};
    $exe = find_exe&#40;&#34;svnlook&#34;,\@path&#41;;


I think something like that should work quite well and you could even
append &#34;usr/local/bin&#34; to he path or help the user to do so. I do not
know of a module that contains this functionality.

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-166115" href="/Public/Bug/Display.html?id=17680#txn-166115">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;18&nbsp;12:21:37&nbsp;2006</span>
    <span class="description">david [...] kineticode.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #17680] SVN::Notify seems to have a hardcoded path to svn and svnlook</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 18 Feb 2006 09:20:43 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Wheeler &lt;david [...] kineticode.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/166115/53241/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/53241">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 17, 2006, at 23:52, andreas.koenig.gmwojprw@franz.ak.mind.de  
via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I read your explanation later in the docs somewhere. I&#39;m sorry that I
&gt; did not find it earlier.
</div>
Ah, good, it is there. No problem.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Ok, for sendmail this makes a lot of sense, not sure for svnlook. If
&gt; people have no svnlook, your tests should probably fail.
</div>
Or skip. But I thought it best not to skip and to get more control  
over the location of the script, which is why I wrote it to include  
in the distribution.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; As should prove t/001_basic.t.
</div>&gt;
&gt; John sent me a prerelease of the next version and with that I had
&gt; neither this or the other problem, so from my point of view all bugs
&gt; appear fixed.
</div>
Ah, great.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think something like that should work quite well and you could even
&gt; append &#34;usr/local/bin&#34; to he path or help the user to do so. I do not
&gt; know of a module that contains this functionality.
</div>
Yes, activitymail does something similar, and I wrote a similar  
function for App::Info. But I avoided that in svnnotify adding the -- 
svnlook option, so that users could always just point to svnlook.  
That&#39;s the other reason that I wrote the script for testing.

But I guess that I could add something like it again to SVN::Notify.  
It likely doesn&#39;t have much overhead--at least, not as much as system  
calls to svnlook likely do.

That said, someday I want to convert all this stuff to use the svn  
Perl swig modules instead of svnlook, and then the problem will go away.

Thanks,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-166238" href="/Public/Bug/Display.html?id=17680#txn-166238">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;19&nbsp;13:53:59&nbsp;2006</span>
    <span class="description">david [...] kineticode.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #17680] SVN::Notify seems to have a hardcoded path to svn and svnlook</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 19 Feb 2006 10:53:05 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Wheeler &lt;david [...] kineticode.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/166238/53314/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/53314">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 702b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 18, 2006, at 09:21, David Wheeler via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But I guess that I could add something like it again to SVN::Notify.
&gt; It likely doesn&#39;t have much overhead--at least, not as much as system
&gt; calls to svnlook likely do.
</div>
Okay, I&#39;ve done it. The new function is:

sub _find_exe {
     my $exe = shift;
     require File::Spec;
     for my $path &#40;File::Spec-&gt;path, &#39;/usr/local/bin&#39;, &#39;/usr/sbin&#39;&#41; {
         $path = File::Spec-&gt;catfile&#40;$path, $exe&#41;;
         return $path if -x $path &#38;&#38; -f _;
     }
     return;
}

and it&#39;s called like this:

     $params{svnlook}   ||= $ENV{SVNLOOK}  || _find_exe&#40;&#39;svnlook&#39;&#41;;
     $params{sendmail}  ||= $ENV{SENDMAIL} || _find_exe&#40;&#39;sendmail&#39;&#41;;


Best,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-167224" href="/Public/Bug/Display.html?id=17680#txn-167224">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;22&nbsp;00:02:45&nbsp;2006</span>
    <span class="description">dwheeler [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-167226" href="/Public/Bug/Display.html?id=17680#txn-167226">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;22&nbsp;00:02:57&nbsp;2006</span>
    <span class="description">dwheeler [...] cpan.org -  Fixed in 2.52 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.581961</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
