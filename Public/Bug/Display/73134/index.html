<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #73134 for List-MoreUtils: wishlist: one&#40;&#41; - returns true if a single element matches, false otherwise</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #73134 for List-MoreUtils: wishlist: one&#40;&#41; - returns true if a single element matches, false otherwise</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=List-MoreUtils">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=List-MoreUtils">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=List-MoreUtils">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=List-MoreUtils">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/List-MoreUtils">List-MoreUtils CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">73134</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=List-MoreUtils">List-MoreUtils</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
kaoru [...] slackwise.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-19166-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19167-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.407    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




List-MoreUtils-0.33-MHASCH-01.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1122179/590379/List-MoreUtils-0.33-MHASCH-01.patch">
Fri Sep 21 17:54:35 2012 (11.4k) by hasch-cpan [...] cozap.com
</a>
</font></li>
</ul>


one.t<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1009873/526280/one.t">
Fri Dec 09 11:24:26 2011 (1.1k) by kaoru [...] slackwise.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=73134">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1009873" href="/Public/Bug/Display.html?id=73134#txn-1009873">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;09&nbsp;11:24:26&nbsp;2011</span>
    <span class="description">kaoru [...] slackwise.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> wishlist: one&#40;&#41; - returns true if a single element matches, false
 otherwise</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1009873/526279/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/526279">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 99b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Implemented in pure perl in one.t, with some tests. I found it useful 
once, maybe others would do.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> one.t</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1009873/526280/one.t">Download one.t</a><br />
<span class="downloadcontenttype">text/x-perl 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use warnings;

use Test::More;

sub one &#40;&#38;@&#41; {
    my $code_ref = shift;
    my @list     = @_;
    my $rv;

    foreach &#40;@list&#41; {
        my $code_rv = $code_ref-&gt;&#40;&#41;;

        if &#40;$code_rv &#38;&#38; !$rv&#41; {
            $rv = 1;
        }
        elsif &#40;$code_rv &#38;&#38; $rv&#41; {
            return;
        }
    }

    return 1 if $rv;
    return;
}


ok one { $_ eq &#39;a&#39; } qw&#40;a b c d e f&#41;;
ok one { $_ eq &#39;a&#39; } qw&#40;f e d c b a&#41;;
ok one { $_ eq &#39;a&#39; } qw&#40;a 2 3 4 5 6&#41;;
ok one { $_ eq &#39;a&#39; } qw&#40;1 a 3 4 5 6&#41;;
ok one { $_ eq &#39;a&#39; } qw&#40;1 2 a 4 5 6&#41;;
ok one { $_ eq &#39;a&#39; } qw&#40;1 2 3 a 5 6&#41;;
ok one { $_ eq &#39;a&#39; } qw&#40;1 2 3 4 a 6&#41;;
ok one { $_ eq &#39;a&#39; } qw&#40;1 2 3 4 5 a&#41;;

ok ! one { $_ eq &#39;a&#39; } qw&#40;&#41;;

ok ! one { $_ eq &#39;a&#39; } qw&#40;1 2 3 4 5 6&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;2 3 4 5 6 7&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;3 4 5 6 7 8&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;b c d e f g&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;c d e f g h&#41;;

ok ! one { $_ eq &#39;a&#39; } qw&#40;1 a 3 a 5 6&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;a a a a a a&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;a 2 a 4 a 6&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;a a c d e f&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;a a a d e f&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;a a a a e f&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;a a a a a f&#41;;
ok ! one { $_ eq &#39;a&#39; } qw&#40;a a a a a a&#41;;

done_testing&#40;&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1045569" href="/Public/Bug/Display.html?id=73134#txn-1045569">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;02&nbsp;22:25:35&nbsp;2012</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1045569/546301/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/546301">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 375b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is functionally equivalent

    &#40;grep { ... } @list&#41; == 1;

Since it&#39;s very specialized, not to hard to implement and doesn&#39;t save
any performance &#40;it&#39;s probably slower&#41; I&#39;d say it doesn&#39;t deserve
inclusion.  Perhaps as a FAQ entry in the docs.

A more general case version equivalent to &#40;grep { ... } @list&#41; == $n has
a bit more merit, but I still don&#39;t find it enough.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1045572" href="/Public/Bug/Display.html?id=73134#txn-1045572">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;02&nbsp;22:25:36&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1122179" href="/Public/Bug/Display.html?id=73134#txn-1122179">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;21&nbsp;17:54:35&nbsp;2012</span>
    <span class="description">hasch-cpan [...] cozap.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] wishlist: one&#40;&#41; - returns true if a single element
 matches, false otherwise</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1122179/590378/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/590378">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Mar 02 22:25:35 2012, MSCHWERN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is functionally equivalent
&gt; 
&gt;     &#40;grep { ... } @list&#41; == 1;
&gt; 
&gt; Since it&#39;s very specialized, not to hard to implement and doesn&#39;t save
&gt; any performance &#40;it&#39;s probably slower&#41; I&#39;d say it doesn&#39;t deserve
&gt; inclusion.  Perhaps as a FAQ entry in the docs.
&gt; 
&gt; A more general case version equivalent to &#40;grep { ... } @list&#41; == $n has
&gt; a bit more merit, but I still don&#39;t find it enough.
</div>
Not being hard to implement is a weak point against extentending
a module that explicitly puts trivial functionality on top of its agenda.

As to performance, of course there can be a huge gain over grep or
this same module&#39;s true&#40;&#41; function by way of shortcut behaviour.
Why keep on counting true instances if you already saw enough of
them to know the result will be false?

And it can be useful. One use case would be option parsing with
mutually exclusive alternatives. I would prefer, however, a more
complete approach and also have functions that can tell which
item was the singular one that matched.

I am extending this wishlist suggestion therefore by two more
functions. only_index&#40;&#41; should return the index of the only item
that matched or -1, and only_value&#40;&#41; should return the very item
or undef, in analogy to first_index&#40;&#41;/last_index&#40;&#41; and first_value&#40;&#41;
/last_value&#40;&#41;.

To promote this idea further, I am attaching a complete patch
with implementations in pp and xs, including tests and pod.

-Martin
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> List-MoreUtils-0.33-MHASCH-01.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1122179/590379/List-MoreUtils-0.33-MHASCH-01.patch">Download List-MoreUtils-0.33-MHASCH-01.patch</a><br />
<span class="downloadcontenttype">text/x-diff 11.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -rup List-MoreUtils-0.33.orig/Changes List-MoreUtils-0.33/Changes
--- List-MoreUtils-0.33.orig/Changes	2011-08-04 11:39:36.000000000 +0200
+++ List-MoreUtils-0.33/Changes	2012-09-21 18:58:50.000000000 +0200
@@ -1,5 +1,8 @@
 Revision history for Perl extension List-MoreUtils
 
+x.xx &#40;not yet released&#41;
+        - Added one&#40;&#41;, onlyidx&#40;&#41;, onlyval&#40;&#41; &#40;MHASCH&#41;
+
 0.33 Thu 4 Aug 2011
 	- Updated can_xs to fix a bug in it
 
diff -rup List-MoreUtils-0.33.orig/MoreUtils.xs List-MoreUtils-0.33/MoreUtils.xs
--- List-MoreUtils-0.33.orig/MoreUtils.xs	2011-08-04 11:39:36.000000000 +0200
+++ List-MoreUtils-0.33/MoreUtils.xs	2012-09-21 18:08:45.000000000 +0200
@@ -345,6 +345,45 @@ CODE:
     XSRETURN_NO;
 }
 
+void
+one &#40;code, ...&#41;
+    SV *code;
+PROTOTYPE: &#38;@
+CODE:
+{
+    dMULTICALL;
+    register int i;
+    register int found = 0;
+    HV *stash;
+    GV *gv;
+    I32 gimme = G_SCALAR;
+    SV **args = &#38;PL_stack_base[ax];
+    CV *cv;
+
+    if &#40;items &lt;= 1&#41;
+	XSRETURN_NO;
+
+    cv = sv_2cv&#40;code, &#38;stash, &#38;gv, 0&#41;;
+    PUSH_MULTICALL&#40;cv&#41;;
+    SAVESPTR&#40;GvSV&#40;PL_defgv&#41;&#41;;
+	    
+    for&#40;i = 1 ; i &lt; items ; ++i&#41; {
+	GvSV&#40;PL_defgv&#41; = args[i];
+	MULTICALL;
+	if &#40;SvTRUE&#40;*PL_stack_sp&#41;&#41; {
+            if &#40;found++&#41; {
+                POP_MULTICALL;
+                XSRETURN_NO;
+            }
+	}
+    }
+    POP_MULTICALL;
+    if &#40;found&#41; {
+        XSRETURN_YES;
+    }
+    XSRETURN_NO;
+}
+
 int
 true &#40;code, ...&#41;
     SV *code;
@@ -488,6 +527,45 @@ OUTPUT:
     RETVAL
 
 int
+onlyidx &#40;code, ...&#41;
+    SV *code;
+PROTOTYPE: &#38;@
+CODE:
+{
+    dMULTICALL;
+    register int i;
+    register int found = 0;
+    HV *stash;
+    GV *gv;
+    I32 gimme = G_SCALAR;
+    SV **args = &#38;PL_stack_base[ax];
+    CV *cv;
+
+    RETVAL = -1;
+    
+    if &#40;items &gt; 1&#41; {
+	cv = sv_2cv&#40;code, &#38;stash, &#38;gv, 0&#41;;
+	PUSH_MULTICALL&#40;cv&#41;;
+	SAVESPTR&#40;GvSV&#40;PL_defgv&#41;&#41;;
+ 
+	for &#40;i = 1 ; i &lt; items ; ++i&#41; {
+	    GvSV&#40;PL_defgv&#41; = args[i];
+	    MULTICALL;
+	    if &#40;SvTRUE&#40;*PL_stack_sp&#41;&#41; {
+                if &#40;found++&#41; {
+                    RETVAL = -1;
+                    break;
+                }
+		RETVAL = i-1;
+	    }
+	}
+	POP_MULTICALL;
+    }
+}
+OUTPUT:
+    RETVAL
+
+int
 insert_after &#40;code, val, avref&#41;
     SV *code;
     SV *val;
@@ -860,6 +938,48 @@ CODE:
 	    }
 	}
 	POP_MULTICALL;
+    }
+}
+OUTPUT:
+    RETVAL
+
+SV *
+onlyval &#40;code, ...&#41;
+    SV *code;
+PROTOTYPE: &#38;@
+CODE:
+{
+    dMULTICALL;
+    register int i;
+    register int found = 0;
+    HV *stash;
+    GV *gv;
+    I32 gimme = G_SCALAR;
+    SV **args = &#38;PL_stack_base[ax];
+    CV *cv;
+
+    RETVAL = &#38;PL_sv_undef;
+
+    if &#40;items &gt; 1&#41; {
+	cv = sv_2cv&#40;code, &#38;stash, &#38;gv, 0&#41;;
+	PUSH_MULTICALL&#40;cv&#41;;
+	SAVESPTR&#40;GvSV&#40;PL_defgv&#41;&#41;;
+
+	for &#40;i = 1; i &lt; items; ++i&#41; {
+	    GvSV&#40;PL_defgv&#41; = args[i];
+	    MULTICALL;
+	    if &#40;SvTRUE&#40;*PL_stack_sp&#41;&#41; {
+                if &#40;found++&#41; {
+                    /* see comment in indexes&#40;&#41; */
+                    SvREFCNT_dec&#40;RETVAL&#41;;
+                    RETVAL = &#38;PL_sv_undef;
+                    break;
+                }
+		/* see comment in indexes&#40;&#41; */
+		SvREFCNT_inc&#40;RETVAL = args[i]&#41;;
+	    }
+	}
+	POP_MULTICALL;
     }
 }
 OUTPUT:
diff -rup List-MoreUtils-0.33.orig/lib/List/MoreUtils.pm List-MoreUtils-0.33/lib/List/MoreUtils.pm
--- List-MoreUtils-0.33.orig/lib/List/MoreUtils.pm	2011-08-04 11:39:36.000000000 +0200
+++ List-MoreUtils-0.33/lib/List/MoreUtils.pm	2012-09-21 19:02:02.000000000 +0200
@@ -7,16 +7,18 @@ use DynaLoader &#40;&#41;;
 
 use vars qw{ $VERSION @ISA @EXPORT_OK %EXPORT_TAGS };
 BEGIN {
-    $VERSION   = &#39;0.33&#39;;
-    # $VERSION   = eval $VERSION;
+    $VERSION   = &#39;0.33_01&#39;;
+    $VERSION   = eval $VERSION;
     @ISA       = qw{ Exporter DynaLoader };
     @EXPORT_OK = qw{
-        any all none notall true false
+        any all none notall one true false
         firstidx first_index lastidx last_index
+        onlyidx only_index
         insert_after insert_after_string
         apply indexes
         after after_incl before before_incl
         firstval first_value lastval last_value
+        onlyval only_value
         each_array each_arrayref
         pairwise natatime
         mesh zip uniq distinct
@@ -77,6 +79,18 @@ sub notall &#40;&#38;@&#41; {
     return NO;
 }
 
+sub one &#40;&#38;@&#41; {
+    my $f = shift;
+    my $found = NO;
+    foreach &#40; @_ &#41; {
+        if &#40;$f-&gt;&#40;&#41;&#41; {
+            return NO if $found;
+            $found = YES;
+        }
+    }
+    return $found;
+}
+
 sub true &#40;&#38;@&#41; {
     my $f     = shift;
     my $count = 0;
@@ -113,6 +127,19 @@ sub lastidx &#40;&#38;@&#41; {
     return -1;
 }
 
+sub onlyidx &#40;&#38;@&#41; {
+    my $f = shift;
+    my $r = -1;
+    foreach my $i &#40; 0 .. $#_ &#41; {
+        local *_ = \$_[$i];
+        if &#40;$f-&gt;&#40;&#41;&#41; {
+            return -1 if -1 != $r;
+            $r = $i;
+        }
+    }
+    return $r;
+}
+
 sub insert_after &#40;&#38;$\@&#41; {
     my &#40;$f, $val, $list&#41; = @_;
     my $c = -1;
@@ -214,6 +241,20 @@ sub firstval &#40;&#38;@&#41; {
     return undef;
 }
 
+sub onlyval &#40;&#38;@&#41; {
+    my $test = shift;
+    my $result = undef;
+    my $found  = NO;
+    foreach &#40; @_ &#41; {
+        if &#40;$test-&gt;&#40;&#41;&#41; {
+            return undef if $found;
+            $result = $_;
+            $found  = YES;
+        }
+    }
+    return $result;
+}
+
 sub pairwise &#40;&#38;\@\@&#41; {
     my $op = shift;
 
@@ -350,8 +391,10 @@ die $@ if $@;
 # Function aliases
 *first_index = \&#38;firstidx;
 *last_index  = \&#38;lastidx;
+*only_index  = \&#38;onlyidx;
 *first_value = \&#38;firstval;
 *last_value  = \&#38;lastval;
+*only_value  = \&#38;onlyval;
 *zip         = \&#38;mesh;
 *distinct    = \&#38;uniq;
 
@@ -368,12 +411,14 @@ List::MoreUtils - Provide the stuff miss
 =head1 SYNOPSIS
 
     use List::MoreUtils qw{
-        any all none notall true false
+        any all none notall one true false
         firstidx first_index lastidx last_index
+        onlyidx only_index
         insert_after insert_after_string
         apply indexes
         after after_incl before before_incl
         firstval first_value lastval last_value
+        onlyval only_val
         each_array each_arrayref
         pairwise natatime
         mesh zip uniq distinct minmax part
@@ -434,6 +479,20 @@ turn:
 
 Returns false otherwise, or if LIST is empty.
 
+=item one BLOCK LIST
+
+Returns a true value if precisely one item in LIST meets the criterion
+given through BLOCK. Sets C&lt;$_&gt; for each item in LIST in turn:
+
+    print &#34;Precisely one value defined&#34;
+        if one { defined&#40;$_&#41; } @list;
+
+Returns false otherwise, especially if LIST is empty.
+
+The expression C&lt;one BLOCK LIST&gt; is almost equivalent to
+C&lt;1 == true BLOCK LIST&gt;, except for short-cutting.
+Evaluation of BLOCK will immediately stop at the second true value.
+
 =item true BLOCK LIST
 
 Counts the number of elements in LIST for which the criterion in BLOCK is true.
@@ -480,6 +539,23 @@ Returns C&lt;-1&gt; if no such item could be f
 
 C&lt;last_index&gt; is an alias for C&lt;lastidx&gt;.
 
+=item onlyidx BLOCK LIST
+
+=item only_index BLOCK LIST
+
+Returns the index of the only element in LIST for which the criterion
+in BLOCK is true. Sets C&lt;$_&gt; for each item in LIST in turn:
+
+    my @list = &#40;1, 3, 4, 3, 2, 4&#41;;
+    printf &#34;uniqe index of item 2 in list is %i&#34;, onlyidx { $_ == 2 } @list;
+    __END__
+    unique index of item 2 in list is 4
+
+Returns C&lt;-1&gt; if either no such item or more than one of these
+has been found.
+
+C&lt;only_index&gt; is an alias for C&lt;onlyidx&gt;.
+
 =item insert_after BLOCK VALUE LIST
 
 Inserts VALUE after the first item in LIST for which the criterion in BLOCK is
@@ -556,7 +632,7 @@ Returns the first element in LIST for wh
 element of LIST is set to C&lt;$_&gt; in turn. Returns C&lt;undef&gt; if no such element
 has been found.
 
-C&lt;first_val&gt; is an alias for C&lt;firstval&gt;.
+C&lt;first_value&gt; is an alias for C&lt;firstval&gt;.
 
 =item lastval BLOCK LIST
 
@@ -566,7 +642,17 @@ Returns the last value in LIST for which
 of LIST is set to C&lt;$_&gt; in turn. Returns C&lt;undef&gt; if no such element has been
 found.
 
-C&lt;last_val&gt; is an alias for C&lt;lastval&gt;.
+C&lt;last_value&gt; is an alias for C&lt;lastval&gt;.
+
+=item onlyval BLOCK LIST
+
+=item only_value BLOCK LIST
+
+Returns the only value in LIST for which BLOCK evaluates to true.
+Each element of LIST is set to C&lt;$_&gt; in turn.  Returns C&lt;undef&gt; if either
+no such element or more than one of these has been found.
+
+C&lt;only_value&gt; is an alias for C&lt;onlyval&gt;.
 
 =item pairwise BLOCK ARRAY1 ARRAY2
 
diff -rup List-MoreUtils-0.33.orig/t/lib/Test.pm List-MoreUtils-0.33/t/lib/Test.pm
--- List-MoreUtils-0.33.orig/t/lib/Test.pm	2011-08-04 11:39:36.000000000 +0200
+++ List-MoreUtils-0.33/t/lib/Test.pm	2012-09-21 18:55:18.000000000 +0200
@@ -7,16 +7,18 @@ use List::MoreUtils &#39;:all&#39;;
 
 # Run all tests
 sub run {
-    plan tests =&gt; 184;
+    plan tests =&gt; 217;
 
     test_any&#40;&#41;;
     test_all&#40;&#41;;
     test_none&#40;&#41;;
     test_notall&#40;&#41;;
+    test_one&#40;&#41;;
     test_true&#40;&#41;;
     test_false&#40;&#41;;
     test_firstidx&#40;&#41;;
     test_lastidx&#40;&#41;;
+    test_onlyidx&#40;&#41;;
     test_insert_after&#40;&#41;;
     test_insert_after_string&#40;&#41;;
     test_apply&#40;&#41;;
@@ -27,6 +29,7 @@ sub run {
     test_after_incl&#40;&#41;;
     test_firstval&#40;&#41;;
     test_lastval&#40;&#41;;
+    test_onlyval&#40;&#41;;
     test_each_array&#40;&#41;;
     test_pairwise&#40;&#41;;
     test_natatime&#40;&#41;;
@@ -108,6 +111,22 @@ sub test_notall {
     }&#41;;
 }
 
+sub test_one {
+    # Normal cases
+    my @list = &#40; 1 .. 300 &#41;;
+    is_true&#40;  one {    1 == $_  } @list &#41;;
+    is_true&#40;  one {  150 == $_  } @list &#41;;
+    is_true&#40;  one {  300 == $_  } @list &#41;;
+    is_false&#40; one {    0 == $_  } @list &#41;;
+    is_false&#40; one {    1 &lt;= $_  } @list &#41;;
+    is_false&#40; one { !&#40;127 &#38; $_&#41; } @list &#41;;
+
+    leak_free_ok&#40;one =&gt; sub {
+        my $ok  = one { 150 &lt;= $_ } @list;
+        my $ok2 = one { 150 &lt;= $_ } 1 .. 300;
+    }&#41;;
+}
+
 sub test_true {
     # The null set should return zero
     my $null_scalar = true { };
@@ -184,6 +203,29 @@ sub test_lastidx {
     }&#41;;
 }
 
+sub test_onlyidx {
+    my @list = &#40; 1 .. 300 &#41;;
+    is&#40;   0, onlyidx {    1 == $_  } @list &#41;;
+    is&#40; 149, onlyidx {  150 == $_  } @list &#41;;
+    is&#40; 299, onlyidx {  300 == $_  } @list &#41;;
+    is&#40;  -1, onlyidx {    0 == $_  } @list &#41;;
+    is&#40;  -1, onlyidx {    1 &lt;= $_  } @list &#41;;
+    is&#40;  -1, onlyidx { !&#40;127 &#38; $_&#41; } @list &#41;;
+
+    # Test aliases
+    is&#40;   0, only_index {    1 == $_  } @list &#41;;
+    is&#40; 149, only_index {  150 == $_  } @list &#41;;
+    is&#40; 299, only_index {  300 == $_  } @list &#41;;
+    is&#40;  -1, only_index {    0 == $_  } @list &#41;;
+    is&#40;  -1, only_index {    1 &lt;= $_  } @list &#41;;
+    is&#40;  -1, only_index { !&#40;127 &#38; $_&#41; } @list &#41;;
+
+    leak_free_ok&#40;onlyidx =&gt; sub {
+        my $ok  = onlyidx { 150 &lt;= $_ } @list;
+        my $ok2 = onlyidx { 150 &lt;= $_ } 1 .. 300;
+    }&#41;;
+}
+
 sub test_insert_after {
     my @list = qw{This is a list};
     insert_after { $_ eq &#34;a&#34; } &#34;longer&#34; =&gt; @list;
@@ -367,6 +409,29 @@ sub test_lastval {
     }&#41;;
 }
 
+sub test_onlyval {
+    my @list = &#40; 1 .. 300 &#41;;
+    is&#40;     1, onlyval {    1 == $_  } @list &#41;;
+    is&#40;   150, onlyval {  150 == $_  } @list &#41;;
+    is&#40;   300, onlyval {  300 == $_  } @list &#41;;
+    is&#40; undef, onlyval {    0 == $_  } @list &#41;;
+    is&#40; undef, onlyval {    1 &lt;= $_  } @list &#41;;
+    is&#40; undef, onlyval { !&#40;127 &#38; $_&#41; } @list &#41;;
+
+    # Test aliases
+    is&#40;     1, only_value {    1 == $_  } @list &#41;;
+    is&#40;   150, only_value {  150 == $_  } @list &#41;;
+    is&#40;   300, only_value {  300 == $_  } @list &#41;;
+    is&#40; undef, only_value {    0 == $_  } @list &#41;;
+    is&#40; undef, only_value {    1 &lt;= $_  } @list &#41;;
+    is&#40; undef, only_value { !&#40;127 &#38; $_&#41; } @list &#41;;
+
+    leak_free_ok&#40;onlyval =&gt; sub {
+        my $ok  = onlyval { 150 &lt;= $_ } @list;
+        my $ok2 = onlyval { 150 &lt;= $_ } 1 .. 300;
+    }&#41;;
+}
+
 sub test_each_array {
     SCOPE: {
         my @a  = &#40; 7, 3, &#39;a&#39;, undef, &#39;r&#39; &#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1471487" href="/Public/Bug/Display.html?id=73134#txn-1471487">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;09:56:21&nbsp;2015</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> dagolden [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1471487/783444/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/783444">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 113b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Pushed 059791e which contains the final elements from this wishlist.

@David, can you short review the doc parts?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1471491" href="/Public/Bug/Display.html?id=73134#txn-1471491">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;09:56:31&nbsp;2015</span>
    <span class="description">REHSACK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1471493" href="/Public/Bug/Display.html?id=73134#txn-1471493">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;09&nbsp;10:00:07&nbsp;2015</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> dagolden [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1471493/783448/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/783448">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 184b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">@MHASH: would be cool when you fill the &#40;junction&#41; gap for:

* all_but_one &#40;with a much better name!&#41;
* just_n &#40;n, code, ...&#41;
* all_but_n&#40;n, code, ...&#41;

Please all with better names ;&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1475250" href="/Public/Bug/Display.html?id=73134#txn-1475250">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;19&nbsp;03:37:14&nbsp;2015</span>
    <span class="description">REHSACK [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1475252" href="/Public/Bug/Display.html?id=73134#txn-1475252">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;19&nbsp;03:37:15&nbsp;2015</span>
    <span class="description">REHSACK [...] cpan.org -  Fixed in 0.407 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.613497</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
