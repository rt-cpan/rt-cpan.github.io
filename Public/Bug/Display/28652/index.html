<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #28652 for Net-Daemon: Net::Daemon tests hang on IRIX</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #28652 for Net-Daemon: Net::Daemon tests hang on IRIX</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-Daemon/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-Daemon/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-Daemon/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-Daemon/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-Daemon">Net-Daemon CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">28652</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-Daemon/Active/">Net-Daemon</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MNOONING [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
SAPER [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22384-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22385-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;03&nbsp;14:17:03&nbsp;2007</span>
    <span class="description">MNOONING [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net::Daemon tests hang on IRIX</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This was originally reported by Stuart Shelton.
I don&#39;t know if there&#39;s an offical bug-tracker, or whether you already
know of this issue:

When trying to install Net::Daemon via the CPAN shell, the test suite
hangs on IRIX, which requires killing both the build and CPAN with it.

The output &#40;from &#34;make Net::Daemon&#34;, &#34;look Net::Daemon&#34;&#41; is:

# gmake test
PERL_DL_NONLAZY=1 /usr/bsd/bin/perl &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&#34;test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/base..........ok
t/config........no connection to syslog available
        - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
line 114
Server process didn&#39;t create a file &#39;ndtest.prt&#39;. at
/usr/bsd/var/tmp/cpan/build/Net-Daemon-XXAnno/blib/lib/Net/Daemon/Test.pm
line 317.
t/config........dubious
        Test returned status 2 &#40;wstat 512, 0x200&#41;
DIED. FAILED tests 1-5
        Failed 5/5 tests, 0.00% okay
t/fork..........no connection to syslog available
        - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
line 114
Server process didn&#39;t create a file &#39;ndtest.prt&#39;. at
/usr/bsd/var/tmp/cpan/build/Net-Daemon-XXAnno/blib/lib/Net/Daemon/Test.pm
line 317.
FAILED before any test output arrived
t/forkm.........Unexpected return from Bind&#40;&#41;.
Server died: no connection to syslog available
        - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
line 114

... and, indeed, on IRIX /dev/conslog does exist, but is a
character-special file.

$ ls -l /dev/*log*
crw-rw-rw- 1 root sys 10, 80 2007-08-01 11:28 /dev/conslog
crw-r--r-- 1 root sys 41,  0 2007-06-28 10:41 /dev/klog
crw-rw-rw- 1 root sys 10, 80 2007-08-01 05:25 /dev/log

The man page for syslogd&#40;1M&#41; states:

     syslogd reads and logs messages into a set of files described by the
     configuration file /etc/syslog.conf.  Each message is one line.  A
     message can contain a priority code, marked by a number in angle braces
     at the beginning of the line.  Priorities are defined in
&lt;sys/syslog.h&gt;.
     syslogd reads from the stream device /dev/log, from an Internet domain
     socket specified in /etc/services, and from the special device
/dev/klog
     &#40;to read kernel messages&#41;.


Can I provide you with any further information in order to fix this
issue on IRIX?

P.S. In the Net::Daemon documentation, the only contact listed is
Jochen, and I can&#39;t seem to find any email lists &#40;via Google&#41; where
Malcolm&#39;s email address hasn&#39;t been censored.  Hopefully, this message
will find the right person...

Cheers,

Stuart 

------------------------------Response by M. Nooning follows
Hello Stuart,

It may be that there is a problem that is unrelated to Net::Daemon.  If
you go to <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~saper/Sys-Syslog-0.18/Syslog.pm">http://search.cpan.org/~saper/Sys-Syslog-0.18/Syslog.pm</a></span>  you
will see that the error message &#34;no connection to syslog available&#34;
comes from syslog&#40;&#41; failing to connect to the specified socket

Make sure syslogd is running when you run the tests, too. 
Make sure you have the latest Sys::Syslog &#40;0.18&#41;.

On the other hand, I would like to try something in Temp.pm.  If all
else fails, please go to blib/lib/Net/Daemon/Test.pm.  The reason is,
from your error messages, the file &#34;ndtest.prt&#34; is not being created in
the parent or the child is not waiting properly before it looks for it.
------------Begin try this
Go to line 316 and change
        for &#40;my $secs = 20;  $secs  &#38;&#38;  ! -s &#39;ndtest.prt&#39;;  $secs -=
sleep 1&#41; {
        }
to

   for &#40;my $secs = 20;  $secs  &#38;&#38;  ! -s &#39;ndtest.prt&#39;;  $secs -= 1&#41; {
               select&#40;undef, undef, undef, 1&#41;;
   }

------------End try this

You are *not* getting the error message &#34;Error while creating
&#39;ndtest.prt&#39; so I suspect maybe there is something wrong with sleep. 
The &#34;select&#34; will wait 1 second and not depend upon the same signal that
&#34;sleep&#34; does.  Yes, I know this is long shot.

I doubt that it is a permissions problem because you could not have
unzipped and untarred your Net::Daemon download, etcetera, without
having the permissions to create a file.

Please let me know how you have fared. 

---------------------Stuart Shelton responded as below

Hi Sebastien &#38; Malcolm,

Sebastien - Hi, I&#39;m trying to track down a problem which not only
prevents Net::Daemon from passing its test-suite on IRIX, but which
causes the perl build process to hang indefinitely.  You&#39;ll notice the
output from Sys::Syslog during the Net::Daemon tests.  The problem seems
to be that Sys::Syslog is expecting a socket at /dev/conslog &#40;Solaris?&#41;
whereas on IRIX this is a character device - and this seems to be
confusing things.

I&#39;ve double-checked, and I definitely have Sys::Syslog 0.18 installed.

I&#39;ve made the change to blib/lib/Net/Daemon/Test.pm at line 314 &#40;which I
assume was the one you meant with Temp.pm at line 316 ;&#41; and the same
output is produced:

cpan[5]&gt; install Sys::Syslog
Sys::Syslog is up to date &#40;0.18&#41;.

cpan[6]&gt; test Net::Daemon
Running test for module &#39;Net::Daemon&#39;
Running make for M/MN/MNOONING/Net-Daemon/Net-Daemon-0.43.tar.gz
  Has already been unwrapped into directory
/usr/bsd/var/tmp/cpan/build/Net-Daemon-kclMUV
  Has already been made
Running make test
PERL_DL_NONLAZY=1 /usr/bsd/bin/perl &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&#34;test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/base..........ok
t/config........no connection to syslog available
        - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
line 114
Server process didn&#39;t create a file &#39;ndtest.prt&#39;. at
/usr/bsd/var/tmp/cpan/build/Net-Daemon-kclMUV/blib/lib/Net/Daemon/Test.pm
line 318.
t/config........dubious
        Test returned status 2 &#40;wstat 512, 0x200&#41;
DIED. FAILED tests 1-5
        Failed 5/5 tests, 0.00% okay
t/fork..........no connection to syslog available
        - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
line 114
Server process didn&#39;t create a file &#39;ndtest.prt&#39;. at
/usr/bsd/var/tmp/cpan/build/Net-Daemon-kclMUV/blib/lib/Net/Daemon/Test.pm
line 318.
FAILED before any test output arrived
t/forkm.........Unexpected return from Bind&#40;&#41;.
Server died: no connection to syslog available
        - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
line 114

[Test process hangs at this point - sent a HUP]

gmake: *** [test_dynamic] Hangup
  MNOONING/Net-Daemon/Net-Daemon-0.43.tar.gz
  /usr/bsd/bin/gmake test -- NOT OK
Failed during this command:
 MNOONING/Net-Daemon/Net-Daemon-0.43.tar.gz   : make_test NO

cpan[7]&gt;

Incidentally, if I &#40;force-&#41;test Sys::Syslog, then I get:

cpan[8]&gt; test Sys::Syslog
Running test for module &#39;Sys::Syslog&#39;
Running make for S/SA/SAPER/Sys-Syslog-0.18.tar.gz
  Checksum was ok
Sys-Syslog-0.18/
Sys-Syslog-0.18/Syslog.pm
Sys-Syslog-0.18/Changes
Sys-Syslog-0.18/t/
Sys-Syslog-0.18/t/distchk.t
Sys-Syslog-0.18/t/constants.t
Sys-Syslog-0.18/t/portfs.t
Sys-Syslog-0.18/t/podspell.t
Sys-Syslog-0.18/t/00-load.t
Sys-Syslog-0.18/t/pod.t
Sys-Syslog-0.18/t/syslog.t
Sys-Syslog-0.18/t/podcover.t
Sys-Syslog-0.18/MANIFEST
Sys-Syslog-0.18/fallback/
Sys-Syslog-0.18/fallback/const-c.inc
Sys-Syslog-0.18/fallback/const-xs.inc
Sys-Syslog-0.18/ppport.h
Sys-Syslog-0.18/Syslog.xs
Sys-Syslog-0.18/README
Sys-Syslog-0.18/Makefile.PL
Sys-Syslog-0.18/META.yml

  CPAN.pm: Going to build S/SA/SAPER/Sys-Syslog-0.18.tar.gz

Checking if your kit is complete...
Looks good
Writing Makefile for Sys::Syslog
/usr/bsd/bin/perl /usr/bsd/lib/perl5/5.8.0/ExtUtils/xsubpp -noprototypes
-typemap /usr/bsd/lib/perl5/5.8.0/ExtUtils/typemap  Syslog.xs &gt;
Syslog.xsc &#38;&#38; mv Syslog.xsc Syslog.c
Running Mkbootstrap for Sys::Syslog &#40;&#41;
cp Syslog.pm blib/lib/Sys/Syslog.pm
chmod 644 Syslog.bs
cp Syslog.bs blib/arch/auto/Sys/Syslog/Syslog.bs
chmod 644 blib/arch/auto/Sys/Syslog/Syslog.bs
cc -c99 -n32 -mips4 -r14000 -float_const -use_readonly_const
-TARG:isa=mips4:platform=ip30:processor=r14000 -TENV:zeroinit_in_bss=ON
-c   -woff 1174,1183,1184,1185,1188,1196,1204,1548,1552,3970,3968
-D_BSD_TYPES -D_BSD_TIME -DLANGUAGE_C -I/usr/bsd/include -c99 -O2 -n32
-mips4 -r14000 -apo -float_const -use_readonly_const
-TARG:isa=mips4:platform=ip30:processor=r14000 -TENV:zeroinit_in_bss=ON
-OPT:fast_io=ON:Olimit=10240:reorg_common=ON:swp=ON
-LNO:auto_dist=ON:fusion_peeling_limit=8:gather_scatter=2
-DVERSION=\&#34;0.18\&#34; -DXS_VERSION=\&#34;0.18\&#34;
&#34;-I/usr/bsd/lib/perl5/5.8.0/mipseb-irix6.5/CORE&#34;   Syslog.c
rm -f blib/arch/auto/Sys/Syslog/Syslog.so
cc -c99 -n32 -mips4 -r14000 -float_const -use_readonly_const
-TARG:isa=mips4:platform=ip30:processor=r14000 -TENV:zeroinit_in_bss=ON
-Wl,-v,-s,-x,-n32,-mips4,-rdata_shared,-allow_jump_at_eop,-rpath,/usr/bsd/lib
-shared -L/usr/bsd/lib Syslog.o  -o blib/arch/auto/Sys/Syslog/Syslog.so
    \
                \

ld32: Mapped ===   Syslog.o    ====   at address  0x4000000
ld32: 1: loading Syslog.o.
ld32: Trying to open /usr/bsd/lib/libc.so...
ld32: Trying to open /usr/bsd/lib/libc.a...
ld32: Trying to open /usr/lib32/mips4/r10000/libc.so...
ld32: Trying to open /usr/lib32/mips4/r10000/libc.a...
ld32: Trying to open /usr/lib32/mips4/libc.so...
ld32: Mapped ===   /usr/lib32/mips4/libc.so    ====   at address  0x4008000
ld32: Processing /usr/lib32/mips4/libc.so.
ld32: Laying out sections and assigning virtual addresses.
ld32: Fixing up symbol values.
ld32: Sorting symbol table.
ld32: Pass2:  creating output file.
ld32: .MIPS.options.
ld32: .reginfo.
ld32: .dynamic.
ld32: .liblist.
ld32: .dynstr.
ld32: .hash.
ld32: .dynsym.
ld32: .MIPS.symlib.
ld32: .rel.dyn.
ld32: .msym.
ld32: .MIPS.stubs.
ld32: .text.
ld32: .rodata.
ld32: .got.
ld32: .sbss.
ld32: .srdata.
ld32: .debug_abbrev.
ld32: .debug_info.
ld32: .debug_frame.
ld32: .debug_aranges.
ld32: .comment.
ld32: .MIPS.interfaces.
ld32: .MIPS.events.text.
ld32: .MIPS.content.rodata.
ld32: .shstrtab.
ld32: Sorting dynamic relocation records.
chmod 755 blib/arch/auto/Sys/Syslog/Syslog.so
  SAPER/Sys-Syslog-0.18.tar.gz
  /usr/bsd/bin/gmake -j3 -j3 -- OK
Running make test
PERL_DL_NONLAZY=1 /usr/bsd/bin/perl &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&#34;test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/00-load......ok 1/1# Testing Sys::Syslog 0.18, Perl 5.008008,
/usr/bsd/bin/perl
t/00-load......ok
t/constants....ok
        7/88 skipped: various reasons
t/distchk......ok
t/pod..........ok
t/podcover.....ok
t/podspell.....skipped
        all skipped: Pod spelling: for developer interest only :&#41;
t/portfs.......ok
t/syslog.......ok
        34/159 skipped: various reasons
All tests successful, 1 test and 41 subtests skipped.
Files=8, Tests=258,  3 wallclock secs &#40; 2.53 cusr +  0.56 csys =  3.09 CPU&#41;
  SAPER/Sys-Syslog-0.18.tar.gz
  /usr/bsd/bin/gmake test -- OK


... which seems to suggest that it is okay &#40;or that the Syslog test
suite is not as comprehensive as it might be...&#41;

Cheers guys,

Stuart 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;03&nbsp;20:58:57&nbsp;2007</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;, Stuart Shelton &lt;stuart [...] openobjects.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #28652] Re: Net::Daemon tests hang on IRIX</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 4 Aug 2007 02:58:30 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Daemon [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Malcolm and Stuart,


Stuart Shelton wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Sebastien &#38; Malcolm,
&gt;
&gt; Sebastien - Hi, I&#39;m trying to track down a problem which not only  
&gt; prevents Net::Daemon from passing its test-suite on IRIX, but which  
&gt; causes the perl build process to hang indefinitely.  You&#39;ll notice  
&gt; the output from Sys::Syslog during the Net::Daemon tests.  The  
&gt; problem seems to be that Sys::Syslog is expecting a socket at /dev/ 
&gt; conslog &#40;Solaris?&#41; whereas on IRIX this is a character device - and  
&gt; this seems to be confusing things.
&gt;
&gt; I&#39;ve double-checked, and I definitely have Sys::Syslog 0.18 installed.
&gt;
&gt; cpan[6]&gt; test Net::Daemon
&gt; [...]
&gt; Server died: no connection to syslog available
&gt;         - /dev/conslog is not a socket at blib/lib/Net/Daemon/ 
&gt; Log.pm line 114
&gt;
&gt; [Test process hangs at this point - sent a HUP]
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Incidentally, if I &#40;force-&#41;test Sys::Syslog, then I get:
&gt;
&gt; [Sys::Syslog: All tests successful, 1 test and 41 subtests skipped.]
&gt;
&gt; ... which seems to suggest that it is okay &#40;or that the Syslog test  
&gt; suite is not as comprehensive as it might be...&#41;
</div>
Of course, I can&#39;t offer a warranty, but I think that the current  
test suite checks the module in most if not all code paths &#40;hard to  
prove because code paths are OS dependent&#41;.

The real problem in your case is that Net::Daemon uses Sys::Syslog is  
the old way, which has always been very wrong &#40;but it was documented  
this way so Malcolm can&#39;t be blamed for this&#41;. The current correct  
way is to use the &#34;native&#34; mechanism which should have been the one  
used since years ago. It&#39;s the default on all operating systems  
except Win32 where Sys::Syslog will use Win32::EventLog &#40;in the soon- 
to-be-released version&#41;. See the note in L&lt;Sys::Syslog/setlogck&gt; for  
more details.
   » <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock">http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock</a></span>

Malcolm, attached to this mail is a patch which removes the operating  
system dance from Net::Daemon::Log.
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
The second patch does the same but also simplifies the loading of the  
module, as I see no reason for doing this. It also removes some &#34;&#38;&#34;  
when used to call functions because, unless you really known what  
you&#39;re doing, it doesn&#39;t do exactly what you think &#40;and in such case,  
its usage it just obsolete&#41;.
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

Regards,

-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;03&nbsp;20:59:00&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;03&nbsp;21:03:10&nbsp;2007</span>
    <span class="description">SAPER [...] cpan.org -  Cc SAPER added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;10&nbsp;02:44:34&nbsp;2007</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;, Stuart Shelton &lt;stuart [...] openobjects.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28652] Re: Net::Daemon tests hang on IRIX</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 10 Aug 2007 08:44:09 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Daemon [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Malcolm and Stuart,


I haven&#39;t heard back from you. Did one of you tried to apply the  
patch I sent in my previous mail?


Sébastien Aperghis-Tramoni wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The real problem in your case is that Net::Daemon uses Sys::Syslog  
&gt; is the old way, which has always been very wrong &#40;but it was  
&gt; documented this way so Malcolm can&#39;t be blamed for this&#41;. The  
&gt; current correct way is to use the &#34;native&#34; mechanism which should  
&gt; have been the one used since years ago. It&#39;s the default on all  
&gt; operating systems except Win32 where Sys::Syslog will use  
&gt; Win32::EventLog &#40;in the soon-to-be-released version&#41;. See the note  
&gt; in L&lt;Sys::Syslog/setlogck&gt; for more details.
&gt;   » <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock">http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock</a></span>
&gt;
&gt; Malcolm, attached to this mail is a patch which removes the  
&gt; operating system dance from Net::Daemon::Log.
&gt; &lt;Net-Daemon-0.43-sys-syslog-01.diff&gt;
&gt;
&gt; The second patch does the same but also simplifies the loading of  
&gt; the module, as I see no reason for doing this. It also removes some  
&gt; &#34;&#38;&#34; when used to call functions because, unless you really known  
&gt; what you&#39;re doing, it doesn&#39;t do exactly what you think &#40;and in  
&gt; such case, its usage it just obsolete&#41;.
&gt; &lt;Net-Daemon-0.43-sys-syslog-02.diff&gt;
</div>

Regards,

-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;10&nbsp;21:08:24&nbsp;2007</span>
    <span class="description">MNOONING [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From: Sébastien Aperghis-Tramoni
Hello Malcolm and Stuart,


Stuart Shelton wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Sebastien &#38; Malcolm,
&gt;
&gt; Sebastien - Hi, I&#39;m trying to track down a problem which not only
</div>prevents Net::Daemon from passing its test-suite on IRIX, but which
causes the perl build process to hang indefinitely.  You&#39;ll notice the
output from Sys::Syslog during the Net::Daemon tests.  The problem seems
to be that Sys::Syslog is expecting a socket at /dev/conslog &#40;Solaris?&#41;
whereas on IRIX this is a character device - and this seems to be
confusing things.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; I&#39;ve double-checked, and I definitely have Sys::Syslog 0.18 installed.
&gt;
&gt; cpan[6]&gt; test Net::Daemon
&gt; [...]
&gt; Server died: no connection to syslog available
&gt;         - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
</div>line 114
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; [Test process hangs at this point - sent a HUP]
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Incidentally, if I &#40;force-&#41;test Sys::Syslog, then I get:
&gt;
&gt; [Sys::Syslog: All tests successful, 1 test and 41 subtests skipped.]
&gt;
&gt; ... which seems to suggest that it is okay &#40;or that the Syslog test
</div>suite is not as comprehensive as it might be...&#41;

Of course, I can&#39;t offer a warranty, but I think that the current test
suite checks the module in most if not all code paths &#40;hard to prove
because code paths are OS dependent&#41;.

The real problem in your case is that Net::Daemon uses Sys::Syslog is
the old way, which has always been very wrong &#40;but it was documented
this way so Malcolm can&#39;t be blamed for this&#41;. The current correct way
is to use the &#34;native&#34; mechanism which should have been the one used
since years ago. It&#39;s the default on all operating systems except Win32
where Sys::Syslog will use Win32::EventLog &#40;in the soon-to-be-released
version&#41;. See the note in L&lt;Sys::Syslog/setlogck&gt; for more details.
  » <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock">http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock</a></span>

Malcolm, attached to this mail is a patch which removes the operating
system dance from Net::Daemon::Log.

The second patch does the same but also simplifies the loading of the
module, as I see no reason for doing this. It also removes some &#34;&#38;&#34; when
used to call functions because, unless you really known what you&#39;re
doing, it doesn&#39;t do exactly what you think &#40;and in such case, its usage
it just obsolete&#41;.


Regards,

-- 
Sébastien Aperghis-Tramoni
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;10&nbsp;21:11:40&nbsp;2007</span>
    <span class="description">MNOONING [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From: Sébastien Aperghis-Tramoni
Hello Malcolm and Stuart,


Stuart Shelton wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Sebastien &#38; Malcolm,
&gt;
&gt; Sebastien - Hi, I&#39;m trying to track down a problem which not only
</div>prevents Net::Daemon from passing its test-suite on IRIX, but which
causes the perl build process to hang indefinitely.  You&#39;ll notice the
output from Sys::Syslog during the Net::Daemon tests.  The problem seems
to be that Sys::Syslog is expecting a socket at /dev/conslog &#40;Solaris?&#41;
whereas on IRIX this is a character device - and this seems to be
confusing things.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; I&#39;ve double-checked, and I definitely have Sys::Syslog 0.18 installed.
&gt;
&gt; cpan[6]&gt; test Net::Daemon
&gt; [...]
&gt; Server died: no connection to syslog available
&gt;         - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm
</div>line 114
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; [Test process hangs at this point - sent a HUP]
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Incidentally, if I &#40;force-&#41;test Sys::Syslog, then I get:
&gt;
&gt; [Sys::Syslog: All tests successful, 1 test and 41 subtests skipped.]
&gt;
&gt; ... which seems to suggest that it is okay &#40;or that the Syslog test
</div>suite is not as comprehensive as it might be...&#41;

Of course, I can&#39;t offer a warranty, but I think that the current test
suite checks the module in most if not all code paths &#40;hard to prove
because code paths are OS dependent&#41;.

The real problem in your case is that Net::Daemon uses Sys::Syslog is
the old way, which has always been very wrong &#40;but it was documented
this way so Malcolm can&#39;t be blamed for this&#41;. The current correct way
is to use the &#34;native&#34; mechanism which should have been the one used
since years ago. It&#39;s the default on all operating systems except Win32
where Sys::Syslog will use Win32::EventLog &#40;in the soon-to-be-released
version&#41;. See the note in L&lt;Sys::Syslog/setlogck&gt; for more details.
  » <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock">http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock</a></span>

Malcolm, attached to this mail is a patch which removes the operating
system dance from Net::Daemon::Log.

The second patch does the same but also simplifies the loading of the
module, as I see no reason for doing this. It also removes some &#34;&#38;&#34; when
used to call functions because, unless you really known what you&#39;re
doing, it doesn&#39;t do exactly what you think &#40;and in such case, its usage
it just obsolete&#41;.


Regards,

-- 
Sébastien Aperghis-Tramoni
-------------------------------paste Part 1p3
&lt;div class=&#34;moz-text-flowed&#34; style=&#34;font-family: -moz-fixed&#34;&gt;
The second patch does the same but also simplifies the loading of the  
module, as I see no reason for doing this. It also removes some &#34;&#38;&#34;  
when used to call functions because, unless you really known what  
you&#39;re doing, it doesn&#39;t do exactly what you think &#40;and in such case,  
its usage it just obsolete&#41;.&lt;/div&gt;

--------------------------------paste Part 1p5
&lt;div class=&#34;moz-text-flowed&#34; style=&#34;font-family: -moz-fixed&#34;&gt;

Regards,

-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.


&lt;/div&gt;
-------------------------------paste first diff
diff -ru Net-Daemon-0.43-orig/lib/Net/Daemon/Log.pm
Net-Daemon-0.43/lib/Net/Daemon/Log.pm
--- Net-Daemon-0.43-orig/lib/Net/Daemon/Log.pm  2007-05-23
15:56:02.000000000 +0200
+++ Net-Daemon-0.43/lib/Net/Daemon/Log.pm       2007-08-04 02:27:37.000000000
+0200
@@ -57,11 +57,6 @@
        if &#40;$@&#41; {
            die &#34;Cannot open Syslog: $@&#34;;
        }
-       if &#40;$^O ne &#39;solaris&#39;  &#38;&#38;  $^O ne &#39;freebsd&#39;  &#38;&#38;
-           defined&#40;&#38;Sys::Syslog::setlogsock&#41;  &#38;&#38;
-           eval { &#38;Sys::Syslog::_PATH_LOG&#40;&#41; }&#41; {
-           &#38;Sys::Syslog::setlogsock&#40;&#39;unix&#39;&#41;;
-       }
        &#38;Sys::Syslog::openlog&#40;$self-&gt;{&#39;logname&#39;} || ref&#40;$self&#41;, &#39;pid&#39;,
                              $self-&gt;{&#39;facility&#39;} || &#39;daemon&#39;&#41;;
     }
-----------------------------paste second diff
diff -ru Net-Daemon-0.43-orig/lib/Net/Daemon/Log.pm
Net-Daemon-0.43/lib/Net/Daemon/Log.pm
--- Net-Daemon-0.43-orig/lib/Net/Daemon/Log.pm  2007-05-23
15:56:02.000000000 +0200
+++ Net-Daemon-0.43/lib/Net/Daemon/Log.pm       2007-08-04 02:38:43.000000000
+0200
@@ -53,16 +53,8 @@
            or die &#34;Cannot open EventLog:&#34; . &#38;Win32::GetLastError&#40;&#41;;
        $self-&gt;{&#39;$eventId&#39;} = 0;
     } else {
-       eval { require Sys::Syslog };
-       if &#40;$@&#41; {
-           die &#34;Cannot open Syslog: $@&#34;;
-       }
-       if &#40;$^O ne &#39;solaris&#39;  &#38;&#38;  $^O ne &#39;freebsd&#39;  &#38;&#38;
-           defined&#40;&#38;Sys::Syslog::setlogsock&#41;  &#38;&#38;
-           eval { &#38;Sys::Syslog::_PATH_LOG&#40;&#41; }&#41; {
-           &#38;Sys::Syslog::setlogsock&#40;&#39;unix&#39;&#41;;
-       }
-       &#38;Sys::Syslog::openlog&#40;$self-&gt;{&#39;logname&#39;} || ref&#40;$self&#41;, &#39;pid&#39;,
+       require Sys::Syslog;
+       Sys::Syslog::openlog&#40;$self-&gt;{&#39;logname&#39;} || ref&#40;$self&#41;, &#39;pid&#39;,
                              $self-&gt;{&#39;facility&#39;} || &#39;daemon&#39;&#41;;
     }
     $self-&gt;{&#39;logfile&#39;} = 0;
@@ -111,7 +103,7 @@
            &#39;Data&#39; =&gt; $tid
            }&#41;;
     } else {
-       &#38;Sys::Syslog::syslog&#40;$level, &#34;$tid$format&#34;, @args&#41;;
+       Sys::Syslog::syslog&#40;$level, &#34;$tid$format&#34;, @args&#41;;
     }
 }
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;10&nbsp;21:39:00&nbsp;2007</span>
    <span class="description">MNOONING [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">First of all, my apologies for the duplication of the last messages. 
What a pain.

I have decided to keep use Sebastien&#39;s patch, modified to keep the eval
and the check for $@ and the die statement.  If there is a problem with
require Sys::Syslog the &#34;Cannot open Syslog: $@&#34; line at least lets the
user know what happened.

The forkm test hung for me on a linux machine.  It was a quickie type of
test on someone else&#39;s machine so I was not able to triage it.  When I
get a chance I will test it further.

Thanks
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;10&nbsp;21:41:19&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-Net-Daemon [...] rt.cpan.org, Stuart Shelton &lt;stuart [...] openobjects.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28652] Re: Net::Daemon tests hang on IRIX</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 10 Aug 2007 21:40:39 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sébastien Aperghis-Tramoni wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello Malcolm and Stuart,
&gt;
&gt;
&gt; Stuart Shelton wrote:
&gt;
<div class="message-stanza open">&gt;&gt; Hi Sebastien &#38; Malcolm,
&gt;&gt;
&gt;&gt; Sebastien - Hi, I&#39;m trying to track down a problem which not only 
&gt;&gt; prevents Net::Daemon from passing its test-suite on IRIX, but which 
&gt;&gt; causes the perl build process to hang indefinitely.  You&#39;ll notice 
&gt;&gt; the output from Sys::Syslog during the Net::Daemon tests.  The 
&gt;&gt; problem seems to be that Sys::Syslog is expecting a socket at 
&gt;&gt; /dev/conslog &#40;Solaris?&#41; whereas on IRIX this is a character device - 
&gt;&gt; and this seems to be confusing things.
&gt;&gt;
&gt;&gt; I&#39;ve double-checked, and I definitely have Sys::Syslog 0.18 installed.
&gt;&gt;
&gt;&gt; cpan[6]&gt; test Net::Daemon
&gt;&gt; [...]
&gt;&gt; Server died: no connection to syslog available
&gt;&gt;         - /dev/conslog is not a socket at blib/lib/Net/Daemon/Log.pm 
&gt;&gt; line 114
&gt;&gt;
&gt;&gt; [Test process hangs at this point - sent a HUP]
</div>&gt;
<div class="message-stanza open">&gt;&gt; Incidentally, if I &#40;force-&#41;test Sys::Syslog, then I get:
&gt;&gt;
&gt;&gt; [Sys::Syslog: All tests successful, 1 test and 41 subtests skipped.]
&gt;&gt;
&gt;&gt; ... which seems to suggest that it is okay &#40;or that the Syslog test 
&gt;&gt; suite is not as comprehensive as it might be...&#41;
</div>&gt;
&gt; Of course, I can&#39;t offer a warranty, but I think that the current test 
&gt; suite checks the module in most if not all code paths &#40;hard to prove 
&gt; because code paths are OS dependent&#41;.
&gt;
&gt; The real problem in your case is that Net::Daemon uses Sys::Syslog is 
&gt; the old way, which has always been very wrong &#40;but it was documented 
&gt; this way so Malcolm can&#39;t be blamed for this&#41;. The current correct way 
&gt; is to use the &#34;native&#34; mechanism which should have been the one used 
&gt; since years ago. It&#39;s the default on all operating systems except 
&gt; Win32 where Sys::Syslog will use Win32::EventLog &#40;in the 
&gt; soon-to-be-released version&#41;. See the note in L&lt;Sys::Syslog/setlogck&gt; 
&gt; for more details.
&gt;   » <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock">http://search.cpan.org/dist/Sys-Syslog/Syslog.pm#setlogsock</a></span>
&gt;
&gt; Malcolm, attached to this mail is a patch which removes the operating 
&gt; system dance from Net::Daemon::Log.
&gt;
&gt; The second patch does the same but also simplifies the loading of the 
&gt; module, as I see no reason for doing this. It also removes some &#34;&#38;&#34; 
&gt; when used to call functions because, unless you really known what 
&gt; you&#39;re doing, it doesn&#39;t do exactly what you think &#40;and in such case, 
&gt; its usage it just obsolete&#41;.
&gt;
&gt;
&gt; Regards,
&gt;
</div>Thanks Sebastien,

Thanks for the analysis and the patches.

I have posted your email to 
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=28652">http://rt.cpan.org/Ticket/Display.html?id=28652</a></span>, and posted my reply 
there, too.

Thanks
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;11&nbsp;09:37:53&nbsp;2007</span>
    <span class="description">SAPER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Stuart Shelton &lt;stuart [...] openobjects.com&gt;, Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28652] Re: Net::Daemon tests hang on IRIX</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 11 Aug 2007 15:37:26 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Daemon [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Malcolm Nooning wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for the analysis and the patches.
</div>
You&#39;re welcome.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have posted your email to <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html">http://rt.cpan.org/Ticket/Display.html</a></span>? 
&gt; id=28652, and posted my reply there, too.
</div>
There&#39;s no need to copy mails in the ticket: it is automatically done  
as long as we send mails to bug-Net-Daemon@rt.cpan.org with the  
ticket number in the subject. That&#39;s why RT is nice to use: in a  
typical ticket, you can discuss and exchange patches with people  
through the mail gateway, and only use the web interface when it&#39;s  
done, to close the ticket.

-- 
Sébastien Aperghis-Tramoni

Close the world, txEn eht nepO.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;31&nbsp;13:56:40&nbsp;2007</span>
    <span class="description">stuart [...] openobjects.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-Net-Daemon [...] rt.cpan.org, Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28652] Re: Net::Daemon tests hang on IRIX</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 31 Aug 2007 18:56:12 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sébastien Aperghis-Tramoni &lt;saper [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stuart Shelton &lt;stuart [...] openobjects.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry it took so long - I can confirm that with Patch #2, Net::Daemon 
does indeed build, test, and install cleanly on IRIX.

I&#39;ve not tried actually using it - but this is obvisouly a great 
improvement :&#41;

Cheers,

Stuart
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;22&nbsp;18:18:52&nbsp;2020</span>
    <span class="description">TODDR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ticket migrated to github as <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/toddr/Net-Daemon/issues/13">https://github.com/toddr/Net-Daemon/issues/13</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;22&nbsp;18:18:53&nbsp;2020</span>
    <span class="description">TODDR [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
