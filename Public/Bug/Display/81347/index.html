<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #81347 for Net-SSLeay: Tests do not pass when OpenSSL runs in FIPS mode</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #81347 for Net-SSLeay: Tests do not pass when OpenSSL runs in FIPS mode</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-SSLeay/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-SSLeay/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-SSLeay/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-SSLeay/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-SSLeay">Net-SSLeay CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">81347</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">30 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-SSLeay/Active/">Net-SSLeay</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MIKEM [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ppisar [...] redhat.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-44414-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.49    </td>
  </tr>
  <tr id="CF-44415-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;22&nbsp;10:58:39&nbsp;2012</span>
    <span class="description">ppisar [...] redhat.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If OpenSSL is switched into FIPS mode, some tests do not pass. That&#39;s
because testing data use weak algorithms not available in FIPS mode.
E.g. t/data/key.pem.e is encrypted using DES but DES as well as MD5 is
not available in FIPS mode.

It would be great to upgrade all the tests to use stronger encryption.

It would be much better to perform tests on the weakly and strongly
encrypted data and to make tests tolerant to unavailable algorithms. &#40;If
I&#39;m correct, current Net::SSLeay cannot parse OpenSSL error code to
retrieve failure reason, ERR_GET_REASON&#40;3&#41;.&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;22&nbsp;17:08:43&nbsp;2012</span>
    <span class="description">mikem [...] open.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 23 Nov 2012 08:08:19 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SSLeay [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike McCauley &lt;mikem [...] open.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Petr.

can you indicate how to reproduce the problem you are reporting?

Cheers.

On Thursday, November 22, 2012 10:58:40 AM you wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thu Nov 22 10:58:39 2012: Request 81347 was acted upon.
&gt; Transaction: Ticket created by ppisar
&gt;        Queue: Net-SSLeay
&gt;      Subject: Tests do not pass when OpenSSL runs in FIPS mode
&gt;    Broken in: 1.49
&gt;     Severity: &#40;no value&#41;
&gt;        Owner: Nobody
&gt;   Requestors: ppisar@redhat.com
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; 
&gt; If OpenSSL is switched into FIPS mode, some tests do not pass. That&#39;s
&gt; because testing data use weak algorithms not available in FIPS mode.
&gt; E.g. t/data/key.pem.e is encrypted using DES but DES as well as MD5 is
&gt; not available in FIPS mode.
&gt; 
&gt; It would be great to upgrade all the tests to use stronger encryption.
&gt; 
&gt; It would be much better to perform tests on the weakly and strongly
&gt; encrypted data and to make tests tolerant to unavailable algorithms. &#40;If
&gt; I&#39;m correct, current Net::SSLeay cannot parse OpenSSL error code to
&gt; retrieve failure reason, ERR_GET_REASON&#40;3&#41;.&#41;
</div>-- 
Mike McCauley                               mikem@open.com.au
Open System Consultants Pty. Ltd
9 Bulbul Place Currumbin Waters QLD 4223 Australia   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.open.com.au">http://www.open.com.au</a></span>
Phone +61 7 5598-7474                       Fax   +61 7 5598-7070

Radiator: the most portable, flexible and configurable RADIUS server 
anywhere. SQL, proxy, DBM, files, LDAP, NIS+, password, NT, Emerald, 
Platypus, Freeside, TACACS+, PAM, external, Active Directory, EAP, TLS, 
TTLS, PEAP, TNC, WiMAX, RSA, Vasco, Yubikey, MOTP, HOTP, TOTP,
DIAMETER etc. Full source on Unix, Windows, MacOSX, Solaris, VMS, NetWare etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;22&nbsp;17:08:45&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;23&nbsp;09:38:28&nbsp;2012</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 23 Nov 2012 15:38:06 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;mikem [...] open.com.au via RT&#34; &lt;bug-Net-SSLeay [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Petr Pisar &lt;ppisar [...] redhat.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Nov 22, 2012 at 05:08:45PM -0500, mikem@open.com.au via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello Petr.
&gt; 
&gt; can you indicate how to reproduce the problem you are reporting?
&gt; 
</div>Read &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://openssl.org/docs/fips/UserGuide-2.0.pdf">http://openssl.org/docs/fips/UserGuide-2.0.pdf</a></span>&gt;. You can call
FIPS_mode_set&#40;1&#41; in your application, or put fips_mode=yes into alg_section in
OpenSSL configuration file, or export OPENSSL_FIPS environment variable. Of
course your OpenSSL must be compiled with enabled FIPS.

Example:

$ OPENSSL_FIPS=1 openssl rsa -passin pass:secret &lt; t/data/key.pem.e 
unable to load Private Key
140631549605728:error:0906B072:PEM routines:PEM_get_EVP_CIPHER_INFO:unsupported encryption:pem_lib.c:530:

However this seems be not enough in Net-SSLeay case. OPENSSL_FIPS=1 perl
t/local/05_passwd_cb.t does not fail.

But If I enable FIPS on operating system level at boot time &#40;special argument
fips=1 for initramdisk created by dracut tool
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://linux.die.net/man/8/dracut">http://linux.die.net/man/8/dracut</a></span>&gt;&#41;, Linux reports 1 in
/proc/sys/crypto/fips_enabled and Net-SSL test fails too.

I will investigate more what&#39;s the difference. Probably OpenSSL delegates some
algorithms to kernel implementation which gets disables in FIPS mode. This way
Net-SSLeay fails even without calling FIPS_mode_set&#40;&#41;.

-- Petr
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;28&nbsp;08:12:42&nbsp;2012</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 28 Nov 2012 13:30:02 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;mikem [...] open.com.au via RT&#34; &lt;bug-Net-SSLeay [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Petr Pisar &lt;ppisar [...] redhat.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Nov 23, 2012 at 03:38:06PM +0100, Petr Pisar wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; But If I enable FIPS on operating system level at boot time &#40;special argument
&gt; fips=1 for initramdisk created by dracut tool
&gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://linux.die.net/man/8/dracut">http://linux.die.net/man/8/dracut</a></span>&gt;&#41;, Linux reports 1 in
&gt; /proc/sys/crypto/fips_enabled and Net-SSL test fails too.
&gt; 
&gt; I will investigate more what&#39;s the difference. Probably OpenSSL delegates some
&gt; algorithms to kernel implementation which gets disables in FIPS mode. This way
&gt; Net-SSLeay fails even without calling FIPS_mode_set&#40;&#41;.
&gt; 
</div>OpenSSL library does not obey OPENSSL_FIPS. This variable is specific for
openssl&#40;1&#41; tool only.

Attached patch to Net-SSLeay-1.49 adds FIPS_mode_set&#40;&#41; function to Net::SSLeay
and enables FIPS mode for t/local/05_passwd_cb.t. You do not need any special
Linux init ram disk or kernel. Just OpenSSL built with FIPS support. This way
I can reproduce the failures:

$ perl -I./blib/arch -I./blib/lib t/local/05_passwd_cb.t 
1..13
FIPS enabled
ok 1 - CTX_new
ok 2 - CTX_new
ok 3 - CTX_new
not ok 4 - CTX_use_PrivateKey_file works with right passphrase and userdata
#   Failed test &#39;CTX_use_PrivateKey_file works with right passphrase and userdata&#39;
#   at t/local/05_passwd_cb.t line 64.

et cetera.

-- Petr
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;17:48:57&nbsp;2012</span>
    <span class="description">mikem [...] open.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Nov 2012 08:48:37 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SSLeay [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike McCauley &lt;mikem [...] open.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

thanks for your note.

I have now added support for SSL_FIPS_mode_set similar to your suggestion to 
Net-SSLeay in the SVN repository.

However, I have difficulty with your report that changing the test suite causes 
the test suite to fail.

I would suggest instead that you do not change the test suite.

Cheers.


On Wednesday, November 28, 2012 08:12:44 AM you wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Net-SSLeay
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; On Fri, Nov 23, 2012 at 03:38:06PM +0100, Petr Pisar wrote:
<div class="message-stanza open">&gt; &gt; But If I enable FIPS on operating system level at boot time &#40;special
&gt; &gt; argument fips=1 for initramdisk created by dracut tool
&gt; &gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://linux.die.net/man/8/dracut">http://linux.die.net/man/8/dracut</a></span>&gt;&#41;, Linux reports 1 in
&gt; &gt; /proc/sys/crypto/fips_enabled and Net-SSL test fails too.
&gt; &gt; 
&gt; &gt; I will investigate more what&#39;s the difference. Probably OpenSSL delegates
&gt; &gt; some algorithms to kernel implementation which gets disables in FIPS
&gt; &gt; mode. This way Net-SSLeay fails even without calling FIPS_mode_set&#40;&#41;.
</div>&gt; 
&gt; OpenSSL library does not obey OPENSSL_FIPS. This variable is specific for
&gt; openssl&#40;1&#41; tool only.
&gt; 
&gt; Attached patch to Net-SSLeay-1.49 adds FIPS_mode_set&#40;&#41; function to
&gt; Net::SSLeay and enables FIPS mode for t/local/05_passwd_cb.t. You do not
&gt; need any special Linux init ram disk or kernel. Just OpenSSL built with
&gt; FIPS support. This way I can reproduce the failures:
&gt; 
&gt; $ perl -I./blib/arch -I./blib/lib t/local/05_passwd_cb.t
&gt; 1..13
&gt; FIPS enabled
&gt; ok 1 - CTX_new
&gt; ok 2 - CTX_new
&gt; ok 3 - CTX_new
&gt; not ok 4 - CTX_use_PrivateKey_file works with right passphrase and userdata
&gt; #   Failed test &#39;CTX_use_PrivateKey_file works with right passphrase and
&gt; userdata&#39; #   at t/local/05_passwd_cb.t line 64.
&gt; 
&gt; et cetera.
&gt; 
&gt; -- Petr
</div>-- 
Mike McCauley                               mikem@open.com.au
Open System Consultants Pty. Ltd
9 Bulbul Place Currumbin Waters QLD 4223 Australia   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.open.com.au">http://www.open.com.au</a></span>
Phone +61 7 5598-7474                       Fax   +61 7 5598-7070

Radiator: the most portable, flexible and configurable RADIUS server 
anywhere. SQL, proxy, DBM, files, LDAP, NIS+, password, NT, Emerald, 
Platypus, Freeside, TACACS+, PAM, external, Active Directory, EAP, TLS, 
TTLS, PEAP, TNC, WiMAX, RSA, Vasco, Yubikey, MOTP, HOTP, TOTP,
DIAMETER etc. Full source on Unix, Windows, MacOSX, Solaris, VMS, NetWare etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;03:08:42&nbsp;2012</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Nov 2012 09:08:26 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;mikem [...] open.com.au via RT&#34; &lt;bug-Net-SSLeay [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Petr Pisar &lt;ppisar [...] redhat.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Nov 29, 2012 at 05:48:59PM -0500, mikem@open.com.au via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; I have now added support for SSL_FIPS_mode_set similar to your suggestion to
&gt; Net-SSLeay in the SVN repository.
&gt;
</div>Great. Actually I have patched Net-SSLeay locally in similar way including
adding FIPS_mode&#40;&#41; which is to report if FIPS is enabled and adding a code
into BOOT to call FIPS_mode_set&#40;1&#41; if OPENSSL_FIPS environment variable
exists.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, I have difficulty with your report that changing the test suite
&gt; causes the test suite to fail.
&gt; 
&gt; I would suggest instead that you do not change the test suite.
&gt; 
</div>This was just to demonstrate the problem and to allow you to reproduce the
failure. Now I set FIPS automatically when loading Net-SSLeay, so I do not
have to touch tests to get FIPS mode and failing tests.

I&#39;m now fixing tests to use stronger encryption and skip disabled
cryptographics algorithms to pass with and without FIPS. Once I finishes it,
I will send you my patches.

-- Petr
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;03:16:55&nbsp;2012</span>
    <span class="description">mikem [...] open.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Nov 2012 18:16:35 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SSLeay [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike McCauley &lt;mikem [...] open.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

On Friday, November 30, 2012 03:08:44 AM you wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Net-SSLeay
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; On Thu, Nov 29, 2012 at 05:48:59PM -0500, mikem@open.com.au via RT wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; &gt; 
&gt; &gt; I have now added support for SSL_FIPS_mode_set similar to your suggestion
&gt; &gt; to Net-SSLeay in the SVN repository.
</div>&gt; 
&gt; Great. Actually I have patched Net-SSLeay locally in similar way including
&gt; adding FIPS_mode&#40;&#41; which is to report if FIPS is enabled and adding a code
&gt; into BOOT to call FIPS_mode_set&#40;1&#41; if OPENSSL_FIPS environment variable
&gt; exists.
&gt; 
<div class="message-stanza open">&gt; &gt; However, I have difficulty with your report that changing the test suite
&gt; &gt; causes the test suite to fail.
&gt; &gt; 
&gt; &gt; I would suggest instead that you do not change the test suite.
</div>&gt; 
&gt; This was just to demonstrate the problem and to allow you to reproduce the
&gt; failure. Now I set FIPS automatically when loading Net-SSLeay, so I do not
&gt; have to touch tests to get FIPS mode and failing tests.
&gt; 
&gt; I&#39;m now fixing tests to use stronger encryption and skip disabled
&gt; cryptographics algorithms to pass with and without FIPS. Once I finishes it,
&gt; I will send you my patches.
</div>
OK. Thanks.
Cheers.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; -- Petr
</div>-- 
Mike McCauley                               mikem@open.com.au
Open System Consultants Pty. Ltd
9 Bulbul Place Currumbin Waters QLD 4223 Australia   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.open.com.au">http://www.open.com.au</a></span>
Phone +61 7 5598-7474                       Fax   +61 7 5598-7070

Radiator: the most portable, flexible and configurable RADIUS server 
anywhere. SQL, proxy, DBM, files, LDAP, NIS+, password, NT, Emerald, 
Platypus, Freeside, TACACS+, PAM, external, Active Directory, EAP, TLS, 
TTLS, PEAP, TNC, WiMAX, RSA, Vasco, Yubikey, MOTP, HOTP, TOTP,
DIAMETER etc. Full source on Unix, Windows, MacOSX, Solaris, VMS, NetWare etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;08:39:59&nbsp;2012</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Nov 2012 14:39:35 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Bugs in Net-SSLeay via RT &lt;bug-Net-SSLeay [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Petr Pisar &lt;ppisar [...] redhat.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Nov 22, 2012 at 10:58:40AM -0500, Bugs in Net-SSLeay via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If OpenSSL is switched into FIPS mode, some tests do not pass. That&#39;s
&gt; because testing data use weak algorithms not available in FIPS mode.
&gt; E.g. t/data/key.pem.e is encrypted using DES but DES as well as MD5 is
&gt; not available in FIPS mode.
&gt; 
&gt; It would be great to upgrade all the tests to use stronger encryption.
&gt; 
&gt; It would be much better to perform tests on the weakly and strongly
&gt; encrypted data and to make tests tolerant to unavailable algorithms. &#40;If
&gt; I&#39;m correct, current Net::SSLeay cannot parse OpenSSL error code to
&gt; retrieve failure reason, ERR_GET_REASON&#40;3&#41;.&#41;
</div>
Here is my patch set that adjusts tests to pass in FIPS mode. It&#39;s against
Net-SSLeay-1.49 and the diff is in git format because of binary patches on
PKCS#12 files &#40;be ware patch from binutils does work on it correctly&#41;.

Each patch touches one test for easier review.

It passes on 1.0.1c. With enabled and with disabled FIPS mode. Some other
OpenSSL versions can segfault in FIPS mode due to a bug in the OpenSSL. There
is also an issue with listing available digest algorithms when the list
obtained with P_EVP_MD_list_all&#40;&#41; does not match list obtained with &#34;openssl
list-message-digest-algorithms&#34;. It&#39;s not fatal for Net-SSLeay, and I think it
should be resolved in OpenSSL.

The patches change tests only. If you would like to add FIPS_mode&#40;&#41; or
to add FIPS mode according to OPENSSL_FIPS variable, I can provide necessary
changes too, but first I&#39;d like to ask tou to provide me SVN repository URL
because I could find ViewVCS web interface only which is not usable for 
cloning the repository.

-- Petr
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;08:44:38&nbsp;2012</span>
    <span class="description">mikem [...] open.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Nov 2012 23:44:19 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SSLeay [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike McCauley &lt;mikem [...] open.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Petr,

Will this patch work with all current and older versions of openssl, with or 
without FIPS mode compiled?

Cheers.

On Friday, November 30, 2012 08:40:01 AM you wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Net-SSLeay
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; On Thu, Nov 22, 2012 at 10:58:40AM -0500, Bugs in Net-SSLeay via RT wrote:
<div class="message-stanza open">&gt; &gt; If OpenSSL is switched into FIPS mode, some tests do not pass. That&#39;s
&gt; &gt; because testing data use weak algorithms not available in FIPS mode.
&gt; &gt; E.g. t/data/key.pem.e is encrypted using DES but DES as well as MD5 is
&gt; &gt; not available in FIPS mode.
&gt; &gt; 
&gt; &gt; It would be great to upgrade all the tests to use stronger encryption.
&gt; &gt; 
&gt; &gt; It would be much better to perform tests on the weakly and strongly
&gt; &gt; encrypted data and to make tests tolerant to unavailable algorithms. &#40;If
&gt; &gt; I&#39;m correct, current Net::SSLeay cannot parse OpenSSL error code to
&gt; &gt; retrieve failure reason, ERR_GET_REASON&#40;3&#41;.&#41;
</div>&gt; 
&gt; Here is my patch set that adjusts tests to pass in FIPS mode. It&#39;s against
&gt; Net-SSLeay-1.49 and the diff is in git format because of binary patches on
&gt; PKCS#12 files &#40;be ware patch from binutils does work on it correctly&#41;.
&gt; 
&gt; Each patch touches one test for easier review.
&gt; 
&gt; It passes on 1.0.1c. With enabled and with disabled FIPS mode. Some other
&gt; OpenSSL versions can segfault in FIPS mode due to a bug in the OpenSSL.
&gt; There is also an issue with listing available digest algorithms when the
&gt; list obtained with P_EVP_MD_list_all&#40;&#41; does not match list obtained with
&gt; &#34;openssl list-message-digest-algorithms&#34;. It&#39;s not fatal for Net-SSLeay,
&gt; and I think it should be resolved in OpenSSL.
&gt; 
&gt; The patches change tests only. If you would like to add FIPS_mode&#40;&#41; or
&gt; to add FIPS mode according to OPENSSL_FIPS variable, I can provide necessary
&gt; changes too, but first I&#39;d like to ask tou to provide me SVN repository URL
&gt; because I could find ViewVCS web interface only which is not usable for
&gt; cloning the repository.
&gt; 
&gt; -- Petr
</div>-- 
Mike McCauley                               mikem@open.com.au
Open System Consultants Pty. Ltd
9 Bulbul Place Currumbin Waters QLD 4223 Australia   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.open.com.au">http://www.open.com.au</a></span>
Phone +61 7 5598-7474                       Fax   +61 7 5598-7070

Radiator: the most portable, flexible and configurable RADIUS server 
anywhere. SQL, proxy, DBM, files, LDAP, NIS+, password, NT, Emerald, 
Platypus, Freeside, TACACS+, PAM, external, Active Directory, EAP, TLS, 
TTLS, PEAP, TNC, WiMAX, RSA, Vasco, Yubikey, MOTP, HOTP, TOTP,
DIAMETER etc. Full source on Unix, Windows, MacOSX, Solaris, VMS, NetWare etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;30&nbsp;09:08:01&nbsp;2012</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Nov 2012 15:07:46 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;mikem [...] open.com.au via RT&#34; &lt;bug-Net-SSLeay [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Petr Pisar &lt;ppisar [...] redhat.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Nov 30, 2012 at 08:44:39AM -0500, mikem@open.com.au via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; Will this patch work with all current and older versions of openssl, with or 
&gt; without FIPS mode compiled?
&gt;
</div>They do not call any FIPS related functions. And the other calls are
conditionalized by OpenSSL version exactly the same way you already have in
thests. I tested only 1.0.0j and 1.0.1c versions compiled with FIPS.

-- Petr
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;01&nbsp;18:27:53&nbsp;2012</span>
    <span class="description">mikem [...] open.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 02 Dec 2012 09:27:34 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SSLeay [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike McCauley &lt;mikem [...] open.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

thanks for the patch.

It works fine for openssl 1.* without FIPS mode, but does not succeed with 
openssl-0.9.8i as shown below. I wont be able to apply this patch unless it is 
backwards compatible with earlier versions of openssl still in common use.

Cheers.



cc -c  -I/tmp/openssl-0.9.8i+extensions/include -D_REENTRANT -D_GNU_SOURCE -
DPERL_USE_SAFE_PUTENV -fno-strict-aliasing -pipe -fstack-protector -
D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -O2 -g   -DVERSION=\&#34;1.49\&#34; -
DXS_VERSION=\&#34;1.49\&#34; -fPIC &#34;-I/usr/lib/perl5/5.16.0/i586-linux-thread-
multi/CORE&#34;   SSLeay.c
Running Mkbootstrap for Net::SSLeay &#40;&#41;
chmod 644 SSLeay.bs
rm -f blib/arch/auto/Net/SSLeay/SSLeay.so
LD_RUN_PATH=&#34;/lib&#34; cc  -shared -fomit-frame-pointer -fmessage-length=0 -O2 -
Wall -D_FORTIFY_SOURCE=2 -fstack-protector -funwind-tables -fasynchronous-
unwind-tables -g -Wall -pipe SSLeay.o  -o blib/arch/auto/Net/SSLeay/SSLeay.so     
\
   -L/tmp/openssl-0.9.8i+extensions -L/tmp/openssl-0.9.8i+extensions/lib -lssl 
-lcrypto -lz     \
  
chmod 755 blib/arch/auto/Net/SSLeay/SSLeay.so
cp SSLeay.bs blib/arch/auto/Net/SSLeay/SSLeay.bs
chmod 644 blib/arch/auto/Net/SSLeay/SSLeay.bs
PERL_DL_NONLAZY=1 /usr/bin/perl &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; 
&#34;test_harness&#40;0, &#39;inc&#39;, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/local/*.t 
t/handle/local/*.t
t/handle/local/05_use.t ................ ok   
t/local/01_pod.t ....................... ok   
t/local/02_pod_coverage.t .............. skipped: Test::Pod::Coverage 1.00 
required for testing POD coverage
t/local/03_use.t ....................... ok   
t/local/04_basic.t ..................... 1/6 # Version info:
# Testing Net::SSLeay 1.49, Perl 5.016000, /usr/bin/perl
# OpenSSL version:  &#39;OpenSSL 0.9.8i 15 Sep 2008&#39;
# OpenSSL platform: &#39;platform: linux-elf&#39;
t/local/04_basic.t ..................... ok   
t/local/05_passwd_cb.t ................. 1/13 
#   Failed test &#39;CTX_use_PrivateKey_file works with right passphrase and 
userdata&#39;
#   at t/local/05_passwd_cb.t line 63.

#   Failed test &#39;CTX_use_PrivateKey_file works with right passphrase and 
userdata&#39;
#   at t/local/05_passwd_cb.t line 66.

#   Failed test &#39;CTX_use_PrivateKey_file works with right passphrase and 
without userdata&#39;
#   at t/local/05_passwd_cb.t line 69.
# Looks like you failed 3 tests of 13.
t/local/05_passwd_cb.t ................. Dubious, test returned 3 &#40;wstat 768, 
0x300&#41;
Failed 3/13 subtests 
t/local/06_tcpecho.t ................... ok   
t/local/07_sslecho.t ................... ok     
t/local/08_pipe.t ...................... ok     
t/local/15_bio.t ....................... ok   
t/local/20_autoload.t .................. ok       
t/local/21_constants.t ................. ok       
t/local/30_error.t ..................... ok     
t/local/31_rsa_generate_key.t .......... ok     
t/local/32_x509_get_cert_info.t ........ ok         
t/local/33_x509_create_cert.t .......... ok       
t/local/34_x509_crl.t .................. ok     
t/local/35_ephemeral.t ................. ok   
t/local/36_verify.t .................... ok     
t/local/37_asn1_time.t ................. ok     
t/local/38_priv-key.t .................. 1/10 
#   Failed test &#39;PEM_read_bio_PrivateKey encrypted - callback&#39;
#   at t/local/38_priv-key.t line 24.

#   Failed test &#39;PEM_read_bio_PrivateKey encrypted - password&#39;
#   at t/local/38_priv-key.t line 29.
# Looks like you failed 2 tests of 10.
t/local/38_priv-key.t .................. Dubious, test returned 2 &#40;wstat 512, 
0x200&#41;
Failed 2/10 subtests 
t/local/39_pkcs12.t .................... ok     
t/local/40_npn_support.t ............... skipped: openssl 1.0.1 required
t/local/50_digest.t .................... ok       
t/local/61_threads-cb-crash.t .......... ok   
t/local/62_threads-ctx_new-deadlock.t .. ok   
t/local/kwalitee.t ..................... ok     

Test Summary Report
-------------------
t/local/05_passwd_cb.t               &#40;Wstat: 768 Tests: 13 Failed: 3&#41;
  Failed tests:  5, 7, 9
  Non-zero exit status: 3
t/local/38_priv-key.t                &#40;Wstat: 512 Tests: 10 Failed: 2&#41;
  Failed tests:  4, 6
  Non-zero exit status: 2
Files=27, Tests=2567,  5 wallclock secs &#40; 0.21 usr  0.02 sys +  4.42 cusr  
0.20 csys =  4.85 CPU&#41;
Result: FAIL
Failed 2/27 test programs. 5/2567 subtests failed.
make: *** [test_dynamic] Error 255


On Friday, November 30, 2012 09:08:02 AM you wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Net-SSLeay
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; On Fri, Nov 30, 2012 at 08:44:39AM -0500, mikem@open.com.au via RT wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; &gt; 
&gt; &gt; Will this patch work with all current and older versions of openssl, with
&gt; &gt; or without FIPS mode compiled?
</div>&gt; 
&gt; They do not call any FIPS related functions. And the other calls are
&gt; conditionalized by OpenSSL version exactly the same way you already have in
&gt; thests. I tested only 1.0.0j and 1.0.1c versions compiled with FIPS.
&gt; 
&gt; -- Petr
</div>-- 
Mike McCauley                               mikem@open.com.au
Open System Consultants Pty. Ltd
9 Bulbul Place Currumbin Waters QLD 4223 Australia   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.open.com.au">http://www.open.com.au</a></span>
Phone +61 7 5598-7474                       Fax   +61 7 5598-7070

Radiator: the most portable, flexible and configurable RADIUS server 
anywhere. SQL, proxy, DBM, files, LDAP, NIS+, password, NT, Emerald, 
Platypus, Freeside, TACACS+, PAM, external, Active Directory, EAP, TLS, 
TTLS, PEAP, TNC, WiMAX, RSA, Vasco, Yubikey, MOTP, HOTP, TOTP,
DIAMETER etc. Full source on Unix, Windows, MacOSX, Solaris, VMS, NetWare etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;03&nbsp;09:13:06&nbsp;2012</span>
    <span class="description">ppisar [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 3 Dec 2012 15:12:52 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;mikem [...] open.com.au via RT&#34; &lt;bug-Net-SSLeay [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Petr Pisar &lt;ppisar [...] redhat.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, Dec 01, 2012 at 06:27:54PM -0500, mikem@open.com.au via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; It works fine for openssl 1.* without FIPS mode, but does not succeed with
&gt; openssl-0.9.8i as shown below. I wont be able to apply this patch unless it
&gt; is backwards compatible with earlier versions of openssl still in common
&gt; use.
&gt;
</div>You are right, it does not work with 0.9.8 because such old library does not
load some strong hash algorithms by default. Attached patch should fix it.
I tested it with 0.9.8x in non-FIPS mode and with the two 1.* with and without
FIPS.

-- Petr
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;03&nbsp;20:52:26&nbsp;2012</span>
    <span class="description">mikem [...] open.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #81347] Tests do not pass when OpenSSL runs in FIPS mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 04 Dec 2012 11:52:08 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SSLeay [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike McCauley &lt;mikem [...] open.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

thanks for your second patch.
IT tests fine with 0.9.8

Your patches have now been incorporated in SVN 360

On Monday, December 03, 2012 09:13:08 AM Petr Pisar via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Net-SSLeay
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=81347">https://rt.cpan.org/Ticket/Display.html?id=81347</a></span> &gt;
&gt; 
&gt; On Sat, Dec 01, 2012 at 06:27:54PM -0500, mikem@open.com.au via RT wrote:
<div class="message-stanza open">&gt; &gt; It works fine for openssl 1.* without FIPS mode, but does not succeed with
&gt; &gt; openssl-0.9.8i as shown below. I wont be able to apply this patch unless
&gt; &gt; it
&gt; &gt; is backwards compatible with earlier versions of openssl still in common
&gt; &gt; use.
</div>&gt; 
&gt; You are right, it does not work with 0.9.8 because such old library does not
&gt; load some strong hash algorithms by default. Attached patch should fix it.
&gt; I tested it with 0.9.8x in non-FIPS mode and with the two 1.* with and
&gt; without FIPS.
&gt; 
&gt; -- Petr
</div>-- 
Mike McCauley                               mikem@open.com.au
Open System Consultants Pty. Ltd
9 Bulbul Place Currumbin Waters QLD 4223 Australia   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.open.com.au">http://www.open.com.au</a></span>
Phone +61 7 5598-7474                       Fax   +61 7 5598-7070

Radiator: the most portable, flexible and configurable RADIUS server 
anywhere. SQL, proxy, DBM, files, LDAP, NIS+, password, NT, Emerald, 
Platypus, Freeside, TACACS+, PAM, external, Active Directory, EAP, TLS, 
TTLS, PEAP, TNC, WiMAX, RSA, Vasco, Yubikey, MOTP, HOTP, TOTP,
DIAMETER etc. Full source on Unix, Windows, MacOSX, Solaris, VMS, NetWare etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;07&nbsp;21:04:02&nbsp;2013</span>
    <span class="description">MIKEM [...] cpan.org -  TimeWorked changed from &#40;no value&#41; to &#39;30&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;07&nbsp;21:04:02&nbsp;2013</span>
    <span class="description">MIKEM [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;07&nbsp;21:04:02&nbsp;2013</span>
    <span class="description">MIKEM [...] cpan.org -  Given to MIKEM</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
