<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #60431 for File-ShareDir: Support for objects in @INC</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #60431 for File-ShareDir: Support for objects in @INC</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=File-ShareDir">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=File-ShareDir">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=File-ShareDir">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=File-ShareDir">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/File-ShareDir">File-ShareDir CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">60431</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=File-ShareDir">File-ShareDir</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
w.phillip.moore@gmail.com
(no email address)

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-13120-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.02    </td>
  </tr>
  <tr id="CF-13121-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.02    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




File-ShareDir-1.02-INC-objects.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/818348/423979/File-ShareDir-1.02-INC-objects.patch">
Tue Aug 17 14:28:12 2010 (2.8k) by w.phillip.moore [...] gmail.com
</a>
</font></li>
</ul>


File-ShareDir-1.02-refactor.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/819014/424361/File-ShareDir-1.02-refactor.patch">
Wed Aug 18 13:46:45 2010 (3.1k) by w.phillip.moore@gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=60431">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818348" href="/Public/Bug/Display.html?id=60431#txn-818348">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;17&nbsp;14:28:12&nbsp;2010</span>
    <span class="description">w.phillip.moore [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Support for objects in @INC</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/818348/423978/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/423978">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Adam et al --

This is not a bug report, but rather a request for a small new feature, and a patch that 
implements it.

The current version searches for the share dir relative to the directories in @INC, and simply 
skips any references in @INC.  This is perfectly reasonable behavior of course, and probably 
the only obvious thing to do with @INC entries that aren&#39;t strings.

However, we&#39;re using some interesting infrastructure that leverages the @INC objects 
support, and the objects we create overload stringification to return the underlying directory 
they represent.  The code&#39;s purpose is to provide an INC method that checks for file existence 
based on some cached data, thus avoiding filesystem I/O.

The attached patch does two things.  First of all, I refactored the @INC searching code into a 
single subroutine, and second, it simply does a directory test of the quoted entry.  This allows 
the code to work with our objects &#40;or anyone&#39;s object, if they just overload &#34;&#34; to return the 
directory&#41;, and I believe it should still skip other references just fine.

Please let me know if this feature and patch acceptable to you.

Thanks in advance, and all that....
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> File-ShareDir-1.02-INC-objects.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818348/423979/File-ShareDir-1.02-INC-objects.patch">Download File-ShareDir-1.02-INC-objects.patch</a><br />
<span class="downloadcontenttype">text/x-diff 2.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -r -u File-ShareDir-1.02/lib/File/ShareDir.pm File-ShareDir-1.02-INC-objects/lib/File/ShareDir.pm
--- File-ShareDir-1.02/lib/File/ShareDir.pm	2010-03-17 21:31:04.000000000 -0400
+++ File-ShareDir-1.02-INC-objects/lib/File/ShareDir.pm	2010-08-13 18:28:08.000000000 -0400
@@ -176,18 +176,8 @@
 		&#39;auto&#39;, &#39;share&#39;, &#39;dist&#39;, $dist,
 	&#41;;
 
-	# Find the full dir withing @INC
-	foreach my $inc &#40; @INC &#41; {
-		next unless defined $inc and ! ref $inc;
-		my $dir = File::Spec-&gt;catdir&#40; $inc, $path &#41;;
-		next unless -d $dir;
-		unless &#40; -r $dir &#41; {
-			croak&#40;&#34;Found directory &#39;$dir&#39;, but no read permissions&#34;&#41;;
-		}
-		return $dir;
-	}
+        return _search_inc_path&#40; $path &#41;;
 
-	return undef;
 }
 
 sub _dist_dir_old {
@@ -198,18 +188,8 @@
 		&#39;auto&#39;, split&#40; /-/, $dist &#41;,
 	&#41;;
 
-	# Find the full dir within @INC
-	foreach my $inc &#40; @INC &#41; {
-		next unless defined $inc and ! ref $inc;
-		my $dir = File::Spec-&gt;catdir&#40; $inc, $path &#41;;
-		next unless -d $dir;
-		unless &#40; -r $dir &#41; {
-			croak&#40;&#34;Found directory &#39;$dir&#39;, but no read permissions&#34;&#41;;
-		}
-		return $dir;
-	}
+        return _search_inc_path&#40; $path &#41;;
 
-	return undef;
 }
 
 =pod
@@ -252,18 +232,7 @@
 		_module_subdir&#40; $module &#41;,
 	&#41;;
 
-	# Find the full dir withing @INC
-	foreach my $inc &#40; @INC &#41; {
-		next unless defined $inc and ! ref $inc;
-		my $dir = File::Spec-&gt;catdir&#40; $inc, $path &#41;;
-		next unless -d $dir;
-		unless &#40; -r $dir &#41; {
-			croak&#40;&#34;Found directory &#39;$dir&#39;, but no read permissions&#34;&#41;;
-		}
-		return $dir;
-	}
-
-	return undef;
+        return _search_inc_path&#40; $path &#41;;
 }
 	
 sub _module_dir_old {
@@ -344,19 +313,10 @@
 		&#39;auto&#39;, split&#40; /-/, $dist &#41;, $file,
 	&#41;;
 
-	# Find the full dir withing @INC
-	foreach my $inc &#40; @INC &#41; {
-		next unless defined $inc and ! ref $inc;
-		my $full = File::Spec-&gt;catdir&#40; $inc, $path &#41;;
-		next unless -e $full;
-		unless &#40; -r $full &#41; {
-			croak&#40;&#34;Directory &#39;$full&#39;, no read permissions&#34;&#41;;
-		}
-		return $full;
-	}
+        my $dir = _search_inc_path&#40; $path &#41; ||
+            croak&#40;&#34;Failed to find shared file &#39;$file&#39; for dist &#39;$dist&#39;&#34;&#41;;
 
-	# Couldn&#39;t find it
-	croak&#40;&#34;Failed to find shared file &#39;$file&#39; for dist &#39;$dist&#39;&#34;&#41;;
+        return $dir;
 }
 
 =pod
@@ -468,6 +428,28 @@
 #####################################################################
 # Support Functions
 
+sub _search_inc_path {
+
+        my $path = shift;
+
+	# Find the full dir within @INC
+	foreach my $inc &#40; @INC &#41; {
+                # NOTE: This allows objects in @INC that provide the
+                # directory by overloading stringification, and still
+                # skips references correctly.
+                next unless -d &#34;$inc&#34;;
+		my $dir = File::Spec-&gt;catdir&#40; $inc, $path &#41;;
+		next unless -d $dir;
+		unless &#40; -r $dir &#41; {
+			croak&#40;&#34;Found directory &#39;$dir&#39;, but no read permissions&#34;&#41;;
+		}
+		return $dir;
+	}
+
+	return undef;
+
+}
+
 sub _module_subdir {
 	my $module = shift;
 	$module =~ s/::/-/g;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818351" href="/Public/Bug/Display.html?id=60431#txn-818351">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;17&nbsp;14:31:10&nbsp;2010</span>
    <span class="description">jesse [...] fsck.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 17 Aug 2010 14:30:23 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Phillip Moore via RT &lt;bug-File-ShareDir [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jesse Vincent &lt;jesse [...] fsck.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818351/423982/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/423982">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 790b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The current version searches for the share dir relative to the directories in @INC, and simply 
&gt; skips any references in @INC.  This is perfectly reasonable behavior of course, and probably 
&gt; the only obvious thing to do with @INC entries that aren&#39;t strings.
&gt; 
&gt; However, we&#39;re using some interesting infrastructure that leverages the @INC objects 
&gt; support, and the objects we create overload stringification to return the underlying directory 
&gt; they represent.  The code&#39;s purpose is to provide an INC method that checks for file existence 
&gt; based on some cached data, thus avoiding filesystem I/O.
</div>

That seems fairly specialized and overloaded stringification isn&#39;t a
standard part of references/objects in @INC. This seems like something
you might want in a custom subclass.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818354" href="/Public/Bug/Display.html?id=60431#txn-818354">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;17&nbsp;14:31:10&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818394" href="/Public/Bug/Display.html?id=60431#txn-818394">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;17&nbsp;15:59:11&nbsp;2010</span>
    <span class="description">w.phillip.moore@gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 17 Aug 2010 15:59:01 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Phillip Moore &lt;w.phillip.moore [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/818394/424000/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424000">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the quick response.  I&#39;d like to ask you to reconsider though,
for the following reasons.

First of all, File::ShareDir can&#39;t be sub-classed, since it&#39;s not an object
oriented module.   All of the methods are procedural, and there isn&#39;t even a
single method that does the @INC searching, which is what you would need to
override in a subclass.

Using objects in @INC has been supported for quite some time, and while it
is certainly true that the interface doesn&#39;t define any specific behavior
for overloading, this patch at least makes it possible to use them, and
still leverage File::ShareDir.

We&#39;re leveraging some features of the perl core that are probably used very
rarely, I think.  For example, we&#39;re about to submit patches for the
sitecustomize.pl mechanism, since it lacks any form of error checking.
 Clearly, very few people are actually using that feature.  Similarly, using
objects in @INC is a rarely used feature as well, so it&#39;s not surprising
that modules like File::ShareDir don&#39;t support it.

In this case, we&#39;re simply proposing to make it possible for the authors of
@INC objects to leverage File::ShareDir by simply overloading
stringification.   This change is almost entirely backwards compatible I
believe, and only serves to make File::ShareDir even more useful than it
already is.  The edge conditions which are not backwards compatible should
hopefully be irrelevant, too.

I expect that we&#39;ll find similar issues with other modules that directly
inspect the contents of @INC, and we hope to improve the usability of
objects in @INC by patching them, as well &#40;if possible&#41;.

Would you please reconsider accepting this patch, on the grounds that it
makes @INC objects more useful?

On Tue, Aug 17, 2010 at 2:31 PM, Jesse via RT &lt;bug-File-ShareDir@rt.cpan.org
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; wrote:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60431">https://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt;
&gt;
<div class="message-stanza open">&gt; &gt; The current version searches for the share dir relative to the
</div>&gt; directories in @INC, and simply
<div class="message-stanza open">&gt; &gt; skips any references in @INC.  This is perfectly reasonable behavior of
</div>&gt; course, and probably
<div class="message-stanza open">&gt; &gt; the only obvious thing to do with @INC entries that aren&#39;t strings.
&gt; &gt;
&gt; &gt; However, we&#39;re using some interesting infrastructure that leverages the
</div>&gt; @INC objects
<div class="message-stanza open">&gt; &gt; support, and the objects we create overload stringification to return the
</div>&gt; underlying directory
<div class="message-stanza open">&gt; &gt; they represent.  The code&#39;s purpose is to provide an INC method that
</div>&gt; checks for file existence
<div class="message-stanza open">&gt; &gt; based on some cached data, thus avoiding filesystem I/O.
</div>&gt;
&gt;
&gt; That seems fairly specialized and overloaded stringification isn&#39;t a
&gt; standard part of references/objects in @INC. This seems like something
&gt; you might want in a custom subclass.
&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818394/424001/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424001">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.4k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818660" href="/Public/Bug/Display.html?id=60431#txn-818660">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;01:08:57&nbsp;2010</span>
    <span class="description">adam [...] ali.as -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Aug 2010 15:08:47 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818660/424147/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424147">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From memory, the reason I didn&#39;t implement support for references in
@INC is that &#40;from my reading of the coderef behaviour&#41; the @INC
coderefs return filehandles to be read from.

Many uses of File::ShareDir are not seeking to load a single file in
this way, but are instead locating a root directory within which many
dozens or hundreds of files may exist.

Would this not mean that any such CODE reference @INC hooks could
never have returned a file or directory name, as the code may not
actually exist as files.

The same seems to apply for objects in @INC, according to here anyway.

<span class="clickylink"><a target="new" rel="nofollow" href="http://perldoc.perl.org/functions/require.html">http://perldoc.perl.org/functions/require.html</a></span>

The finding of a directory, or even a file name, does not seem to
exist in the concept as documented. I&#39;m loath in modules this low
level to take actions without the blessings of #p5p.

While you can&#39;t overload, one other option which is suitably evil
given what you want is to use Hook::LexWrap.

Your &#34;sub-class&#34; would load File::ShareDir, and then hijack the normal
functions to replace them with your alternative behaviour.

If the optimisation system in question will never go to CPAN, it is
quite acceptable.

If it is going to CPAN, it is reasonable as long as it is the only
module that might over monkey-patch File::ShareDir in this way &#40;which
may not be an entirely unreasonable assumption&#41;.

Adam K

On 18 August 2010 04:28, Phillip Moore via RT
&lt;bug-File-ShareDir@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue Aug 17 14:28:12 2010: Request 60431 was acted upon.
&gt; Transaction: Ticket created by WPMOORE
&gt;       Queue: File-ShareDir
&gt;     Subject: Support for objects in @INC
&gt;   Broken in: 1.02
&gt;    Severity: Normal
&gt;       Owner: Nobody
&gt;  Requestors: w.phillip.moore@gmail.com
&gt;      Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60431">https://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt;
&gt;
&gt; Adam et al --
&gt;
&gt; This is not a bug report, but rather a request for a small new feature, and a patch that
&gt; implements it.
&gt;
&gt; The current version searches for the share dir relative to the directories in @INC, and simply
&gt; skips any references in @INC.  This is perfectly reasonable behavior of course, and probably
&gt; the only obvious thing to do with @INC entries that aren&#39;t strings.
&gt;
&gt; However, we&#39;re using some interesting infrastructure that leverages the @INC objects
&gt; support, and the objects we create overload stringification to return the underlying directory
&gt; they represent.  The code&#39;s purpose is to provide an INC method that checks for file existence
&gt; based on some cached data, thus avoiding filesystem I/O.
&gt;
&gt; The attached patch does two things.  First of all, I refactored the @INC searching code into a
&gt; single subroutine, and second, it simply does a directory test of the quoted entry.  This allows
&gt; the code to work with our objects &#40;or anyone&#39;s object, if they just overload &#34;&#34; to return the
&gt; directory&#41;, and I believe it should still skip other references just fine.
&gt;
&gt; Please let me know if this feature and patch acceptable to you.
&gt;
&gt; Thanks in advance, and all that....
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818925" href="/Public/Bug/Display.html?id=60431#txn-818925">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;11:40:40&nbsp;2010</span>
    <span class="description">w.phillip.moore@gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Aug 2010 11:40:25 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Phillip Moore &lt;w.phillip.moore [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/818925/424290/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424290">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The API that perl uses when searching @INC for a file to load via &#34;use&#34; or
&#34;require&#34; is simple.   The object must implement an INC method that returns
a filehandle.  However, that API is only used by use and/or require.

In this case, your module is simply interpreting each @INC entry as a
directory, and doing searches for pathnames relative to those directories.
 It&#39;s obvious that there&#39;s no way you can interpret a generic, non-blessed
reference as a directory, so skipping them makes complete sense.

What I&#39;m proposing is a very simple way to interpret the blessed @INC
entries that makes it *possible* for an object to be implemented that can
satisfy perl&#39;s use/require API, and thus avoid a tremendous amount of
needless filesystem I/O, and still be interpreted as a single directory by
your code.

Now, I would prefer that the documented API for objects in @INC included an
optional method that returns the underlying directory, and then
File::ShareDir would simply use this to support such objects.  No such API
exists, obviously, so I&#39;m leveraging operator overloading to provide a
simple way to extract the directory from my objects.

At the end of the day, all I&#39;m trying to do is incrementally improve the
usefulness of objects in @INC by patching File::ShareDir to *allow* an
object author to use this same mechanism to implement objects which can work
with it.  As currently implemented, you can only use File::ShareDir if you
do not leverage this mechanism.  My patch tries to build a small, simple
bridge between your module and this somewhat arcane feature of perl.

As for subclassing it with yet another layer of special module complexity,
that&#39;s really overkill here.  For my own, specific application, I can
replace use of File::ShareDir with something trivial like:

my $base_dir = dirname dirname $INC{ q{EFS/Deploy.pm} };
my $share_dir = qq{$base_dir/auto/share/dist/EFS-Deploy};

If I recall the convention off the top of my head.  However, rather than
just make my code work, I&#39;m trying to extend File::ShareDir so that it can
work with ANY code that is deployed using our system.   If the patch isn&#39;t
accepted, then it doesn&#39;t offer enough complex functionality to justify
implementing a complex wrapper around it just to implement this simple
extension.   I&#39;ll just recommend the above 2-liner as a workaround.

The &#34;optimization system&#34; as you refer to it &#40;EFS&#41; won&#39;t be on CPAN
directly, but it is open source, and we hope to gain wider adoption in the
coming months and years, so &#34;evil hacks&#34; are something I don&#39;t consider
maintainable or desirable.   If the patch isn&#39;t acceptable, then it just
makes sense to not use File::ShareDir.  I don&#39;t think it offers enough
critical functionality to justify that level of complexity when there&#39;s a
simple workaround.

The downside will be that when we install someone&#39;s application, or perhaps
a CPAN module which itself depends on File::ShareDir, then they won&#39;t work
without code changes in our system.  Not the end of the world, but this
patch would have made such a migration transparent.

It&#39;s your code, so it&#39;s your call.   If you would rather wait for p5p to
agree on extensions to the object API and use those, I can understand, but
in the meantime, I felt that this patch added functionality without removing
any.

On Wed, Aug 18, 2010 at 1:08 AM, Reserved Local Account via RT &lt;
bug-File-ShareDir@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=60431">http://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt;
&gt; From memory, the reason I didn&#39;t implement support for references in
&gt; @INC is that &#40;from my reading of the coderef behaviour&#41; the @INC
&gt; coderefs return filehandles to be read from.
&gt;
&gt; Many uses of File::ShareDir are not seeking to load a single file in
&gt; this way, but are instead locating a root directory within which many
&gt; dozens or hundreds of files may exist.
&gt;
&gt; Would this not mean that any such CODE reference @INC hooks could
&gt; never have returned a file or directory name, as the code may not
&gt; actually exist as files.
&gt;
&gt; The same seems to apply for objects in @INC, according to here anyway.
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://perldoc.perl.org/functions/require.html">http://perldoc.perl.org/functions/require.html</a></span>
&gt;
&gt; The finding of a directory, or even a file name, does not seem to
&gt; exist in the concept as documented. I&#39;m loath in modules this low
&gt; level to take actions without the blessings of #p5p.
&gt;
&gt; While you can&#39;t overload, one other option which is suitably evil
&gt; given what you want is to use Hook::LexWrap.
&gt;
&gt; Your &#34;sub-class&#34; would load File::ShareDir, and then hijack the normal
&gt; functions to replace them with your alternative behaviour.
&gt;
&gt; If the optimisation system in question will never go to CPAN, it is
&gt; quite acceptable.
&gt;
&gt; If it is going to CPAN, it is reasonable as long as it is the only
&gt; module that might over monkey-patch File::ShareDir in this way &#40;which
&gt; may not be an entirely unreasonable assumption&#41;.
&gt;
&gt; Adam K
&gt;
&gt; On 18 August 2010 04:28, Phillip Moore via RT
&gt; &lt;bug-File-ShareDir@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; Tue Aug 17 14:28:12 2010: Request 60431 was acted upon.
&gt; &gt; Transaction: Ticket created by WPMOORE
&gt; &gt;       Queue: File-ShareDir
&gt; &gt;     Subject: Support for objects in @INC
&gt; &gt;   Broken in: 1.02
&gt; &gt;    Severity: Normal
&gt; &gt;       Owner: Nobody
&gt; &gt;  Requestors: w.phillip.moore@gmail.com
&gt; &gt;      Status: new
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60431">https://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Adam et al --
&gt; &gt;
&gt; &gt; This is not a bug report, but rather a request for a small new feature,
</div>&gt; and a patch that
<div class="message-stanza open">&gt; &gt; implements it.
&gt; &gt;
&gt; &gt; The current version searches for the share dir relative to the
</div>&gt; directories in @INC, and simply
<div class="message-stanza open">&gt; &gt; skips any references in @INC.  This is perfectly reasonable behavior of
</div>&gt; course, and probably
<div class="message-stanza open">&gt; &gt; the only obvious thing to do with @INC entries that aren&#39;t strings.
&gt; &gt;
&gt; &gt; However, we&#39;re using some interesting infrastructure that leverages the
</div>&gt; @INC objects
<div class="message-stanza open">&gt; &gt; support, and the objects we create overload stringification to return the
</div>&gt; underlying directory
<div class="message-stanza open">&gt; &gt; they represent.  The code&#39;s purpose is to provide an INC method that
</div>&gt; checks for file existence
<div class="message-stanza open">&gt; &gt; based on some cached data, thus avoiding filesystem I/O.
&gt; &gt;
&gt; &gt; The attached patch does two things.  First of all, I refactored the @INC
</div>&gt; searching code into a
<div class="message-stanza open">&gt; &gt; single subroutine, and second, it simply does a directory test of the
</div>&gt; quoted entry.  This allows
<div class="message-stanza open">&gt; &gt; the code to work with our objects &#40;or anyone&#39;s object, if they just
</div>&gt; overload &#34;&#34; to return the
<div class="message-stanza open">&gt; &gt; directory&#41;, and I believe it should still skip other references just
</div>&gt; fine.
<div class="message-stanza open">&gt; &gt;
&gt; &gt; Please let me know if this feature and patch acceptable to you.
&gt; &gt;
&gt; &gt; Thanks in advance, and all that....
&gt; &gt;
</div>&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818925/424291/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424291">with headers</a>
<br />
<span class="downloadcontenttype">text/html 7.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818927" href="/Public/Bug/Display.html?id=60431#txn-818927">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;11:55:17&nbsp;2010</span>
    <span class="description">jesse [...] fsck.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Aug 2010 11:54:30 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;w.phillip.moore [...] gmail.com via RT&#34; &lt;bug-File-ShareDir [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jesse Vincent &lt;jesse [...] fsck.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818927/424293/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424293">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 476b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Phillip,

I &#40;my company&#41; actually make pretty heavy use of coderefs and objects
in @INC. And there&#39;s never actually a directory on disk behind them in
any of our implementations. All of the code that we&#39;re loading is
generated or coming from non-disk sources. 

I&#39;m somewhat curious about the performance problem you&#39;re trying to
solve with your extra cache in @INC &#40;since Perl does cache misses as
well as hits&#41;, but that&#39;s a discussion for p5p, not File::ShareDir.

-jesse
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818951" href="/Public/Bug/Display.html?id=60431#txn-818951">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;12:58:07&nbsp;2010</span>
    <span class="description">w.phillip.moore@gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Aug 2010 12:57:56 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Phillip Moore &lt;w.phillip.moore [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/818951/424314/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424314">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">My team in responsible for a product called EFS, which provides a generic
mechanism for deploying releases of software in very large enterprises.

The model we use is to deploy each distinct release of each software product
independently.  This means we have a separate directory structure for each
and every CPAN release &#40;these are each built for multiple perl compilers,
and multiple platforms&#41;.

This means that if you need to use something like Moose, which needs a total
of about 40 different CPAN dependencies, you end up with 40 entries in @INC.
  Since these directory structures are ALL on a distributed filesystem, the
cost of the negative directory lookups is very expensive, and startup times
rise dramatically.

The objects we put into @INC each represent a single directory, and we do
all the filesystem IO up front, when the object is created, using some
simple metadata files that are created by the tool that builds the modules.
   Each call to the INC method merely has to do a hash lookup to see if the
requested file is available, rather than stat the filesystem.

On Wed, Aug 18, 2010 at 11:55 AM, Jesse via RT &lt;
bug-File-ShareDir@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=60431">http://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt;
&gt;
&gt; Phillip,
&gt;
&gt; I &#40;my company&#41; actually make pretty heavy use of coderefs and objects
&gt; in @INC. And there&#39;s never actually a directory on disk behind them in
&gt; any of our implementations. All of the code that we&#39;re loading is
&gt; generated or coming from non-disk sources.
&gt;
&gt; I&#39;m somewhat curious about the performance problem you&#39;re trying to
&gt; solve with your extra cache in @INC &#40;since Perl does cache misses as
&gt; well as hits&#41;, but that&#39;s a discussion for p5p, not File::ShareDir.
&gt;
&gt; -jesse
&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818951/424315/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424315">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818960" href="/Public/Bug/Display.html?id=60431#txn-818960">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;13:08:20&nbsp;2010</span>
    <span class="description">adam [...] ali.as -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 19 Aug 2010 03:08:07 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818960/424325/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424325">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">These two issues are the crux of the problem.

File::ShareDir is very popular and has become the defacto standard for
almost all modules that need to install and locate non-code read-only
data files. It&#39;s done this primarily because it stays completely
within the boundaries of the perl core and does not invent any new
functionality.

It may well be destined for the core as well at some future time.

Because of this position, any new convention I invented may well
become a defacto standard, and so the perl core might be faced with
adopting the new mechanism &#40;which looks nothing like the existing INC
mechanism&#41; or breaking back-compatibility.

And so I would indeed rather wait for p5p to agree on extensions to
the object API.

With regards to the lexwrap approach, while you are welcome to use or
not use File::ShareDir as you wish, you are correct that you would
potentially not be compatible with a wide range of CPAN modules that
use File::ShareDir.

And it is precisely the need to provide File::ShareDir integration
with your application across the whole CPAN that is the main reason
for the lexwrap approach if you want this in the short term. It is a
bit hacky, but I&#39;d argue it&#39;s LESS so than the use of stringification
overloading on object hooks in @INC.

Adam K

On 19 August 2010 01:40, w.phillip.moore@gmail.com via RT
&lt;bug-File-ShareDir@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The downside will be that when we install someone&#39;s application, or perhaps
&gt; a CPAN module which itself depends on File::ShareDir, then they won&#39;t work
&gt; without code changes in our system.  Not the end of the world, but this
&gt; patch would have made such a migration transparent.
&gt;
&gt; It&#39;s your code, so it&#39;s your call.   If you would rather wait for p5p to
&gt; agree on extensions to the object API and use those, I can understand, but
&gt; in the meantime, I felt that this patch added functionality without removing
&gt; any.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-818995" href="/Public/Bug/Display.html?id=60431#txn-818995">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;13:23:54&nbsp;2010</span>
    <span class="description">w.phillip.moore@gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Aug 2010 13:23:45 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Phillip Moore &lt;w.phillip.moore [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/818995/424345/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424345">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">OK, I give up....

I understand where you&#39;re coming from, but please bear in mind that
*without* my patch, you have to override each and every method in
File::ShareDir that parses @INC.   IIRC, there&#39;s 4 of them.  IOW, the code&#39;s
not modular enough to make wrapping it with Lex::Wrap feasible.

What I fail to understand is why we require some special extension to the
@INC object API.  it&#39;s already there -- overloading stringification.  If
noone uses it, File::ShareDir &#40;with my patch, that is&#41; will behave as it did
before.  This just allows the authors of those objects to add a simple,
trivial method &#40;when it makes sense to do so&#41; that will allow File::ShareDir
to work with those objects.

I&#39;m not claiming this is a grand strategic enhancement to said API.  I&#39;m
just saying this builds a simple, tactical bridge between File::ShareDir and
the use of such objects.

Realistically, if we start to get lots of other modules that depend on
File::ShareDir in our infrastructure, then I&#39;ll have to maintain a local
patch to File::ShareDir &#40;not the first time I&#39;ve had to do this&#41;, and since
as you claim this is becoming more widespread in use, that seems inevitable.

But, like I said..... Your code, your call.  Thanks for listening...

On Wed, Aug 18, 2010 at 1:08 PM, Reserved Local Account via RT &lt;
bug-File-ShareDir@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60431">https://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt;
&gt; These two issues are the crux of the problem.
&gt;
&gt; File::ShareDir is very popular and has become the defacto standard for
&gt; almost all modules that need to install and locate non-code read-only
&gt; data files. It&#39;s done this primarily because it stays completely
&gt; within the boundaries of the perl core and does not invent any new
&gt; functionality.
&gt;
&gt; It may well be destined for the core as well at some future time.
&gt;
&gt; Because of this position, any new convention I invented may well
&gt; become a defacto standard, and so the perl core might be faced with
&gt; adopting the new mechanism &#40;which looks nothing like the existing INC
&gt; mechanism&#41; or breaking back-compatibility.
&gt;
&gt; And so I would indeed rather wait for p5p to agree on extensions to
&gt; the object API.
&gt;
&gt; With regards to the lexwrap approach, while you are welcome to use or
&gt; not use File::ShareDir as you wish, you are correct that you would
&gt; potentially not be compatible with a wide range of CPAN modules that
&gt; use File::ShareDir.
&gt;
&gt; And it is precisely the need to provide File::ShareDir integration
&gt; with your application across the whole CPAN that is the main reason
&gt; for the lexwrap approach if you want this in the short term. It is a
&gt; bit hacky, but I&#39;d argue it&#39;s LESS so than the use of stringification
&gt; overloading on object hooks in @INC.
&gt;
&gt; Adam K
&gt;
&gt; On 19 August 2010 01:40, w.phillip.moore@gmail.com via RT
&gt; &lt;bug-File-ShareDir@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; The downside will be that when we install someone&#39;s application, or
</div>&gt; perhaps
<div class="message-stanza open">&gt; &gt; a CPAN module which itself depends on File::ShareDir, then they won&#39;t
</div>&gt; work
<div class="message-stanza open">&gt; &gt; without code changes in our system.  Not the end of the world, but this
&gt; &gt; patch would have made such a migration transparent.
&gt; &gt;
&gt; &gt; It&#39;s your code, so it&#39;s your call.   If you would rather wait for p5p to
&gt; &gt; agree on extensions to the object API and use those, I can understand,
</div>&gt; but
<div class="message-stanza open">&gt; &gt; in the meantime, I felt that this patch added functionality without
</div>&gt; removing
<div class="message-stanza open">&gt; &gt; any.
</div>&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/818995/424346/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424346">with headers</a>
<br />
<span class="downloadcontenttype">text/html 4.1k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-819004" href="/Public/Bug/Display.html?id=60431#txn-819004">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;13:28:05&nbsp;2010</span>
    <span class="description">jesse [...] fsck.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Aug 2010 13:27:16 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;w.phillip.moore [...] gmail.com via RT&#34; &lt;bug-File-ShareDir [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jesse Vincent &lt;jesse [...] fsck.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/819004/424351/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424351">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 501b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">


On Wed, Aug 18, 2010 at 01:23:55PM -0400, w.phillip.moore@gmail.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I understand where you&#39;re coming from, but please bear in mind that
&gt; *without* my patch, you have to override each and every method in
&gt; File::ShareDir that parses @INC.   IIRC, there&#39;s 4 of them.  IOW, the code&#39;s
&gt; not modular enough to make wrapping it with Lex::Wrap feasible.
</div>
_That_ sounds like a good patch to contribute that would both improve
the code and make the lexwrapping a much simpler proposition.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-819014" href="/Public/Bug/Display.html?id=60431#txn-819014">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;13:46:45&nbsp;2010</span>
    <span class="description">w.phillip.moore@gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Aug 2010 13:46:33 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Phillip Moore &lt;w.phillip.moore [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/819014/424359/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424359">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 768b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It was a one-line change from the previous patch I sent.   Attached here, if
you want it....

On Wed, Aug 18, 2010 at 1:28 PM, Jesse via RT &lt;bug-File-ShareDir@rt.cpan.org
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; wrote:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=60431">http://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt;
&gt;
&gt;
&gt;
&gt; On Wed, Aug 18, 2010 at 01:23:55PM -0400, w.phillip.moore@gmail.com via RT
&gt; wrote:
<div class="message-stanza open">&gt; &gt; I understand where you&#39;re coming from, but please bear in mind that
&gt; &gt; *without* my patch, you have to override each and every method in
&gt; &gt; File::ShareDir that parses @INC.   IIRC, there&#39;s 4 of them.  IOW, the
</div>&gt; code&#39;s
<div class="message-stanza open">&gt; &gt; not modular enough to make wrapping it with Lex::Wrap feasible.
</div>&gt;
&gt; _That_ sounds like a good patch to contribute that would both improve
&gt; the code and make the lexwrapping a much simpler proposition.
&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/819014/424360/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424360">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.2k</span>
</div>
<div class="messagebody">
</div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/819014/424361/File-ShareDir-1.02-refactor.patch">Download File-ShareDir-1.02-refactor.patch</a><br />
<span class="downloadcontenttype">text/x-diff 3.1k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-819173" href="/Public/Bug/Display.html?id=60431#txn-819173">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;20:48:06&nbsp;2010</span>
    <span class="description">adam [...] ali.as -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60431] Support for objects in @INC</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 19 Aug 2010 10:47:58 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-File-ShareDir [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/819173/424444/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/424444">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 803b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Indeed.

I&#39;d be quite happy to refactor File::ShareDir to make it much simpler
to hook around.

Adam K

On 19 August 2010 03:28, Jesse via RT &lt;bug-File-ShareDir@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: File-ShareDir
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=60431">http://rt.cpan.org/Ticket/Display.html?id=60431</a></span> &gt;
&gt;
&gt;
&gt;
&gt;
&gt; On Wed, Aug 18, 2010 at 01:23:55PM -0400, w.phillip.moore@gmail.com via RT wrote:
<div class="message-stanza open">&gt;&gt; I understand where you&#39;re coming from, but please bear in mind that
&gt;&gt; *without* my patch, you have to override each and every method in
&gt;&gt; File::ShareDir that parses @INC.   IIRC, there&#39;s 4 of them.  IOW, the code&#39;s
&gt;&gt; not modular enough to make wrapping it with Lex::Wrap feasible.
</div>&gt;
&gt; _That_ sounds like a good patch to contribute that would both improve
&gt; the code and make the lexwrapping a much simpler proposition.
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1447560" href="/Public/Bug/Display.html?id=60431#txn-1447560">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;31&nbsp;03:22:10&nbsp;2014</span>
    <span class="description">ZHENYZ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> jesse [...] fsck.com, w.phillip.moore [...] gmail.com, adamkennedybackup [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1447560/769663/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/769663">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 323b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, 

It has been four years since you guys&#39; discussion on this request of supporting objects in @INC. I wonder if there is still plan to do it...

My company is also heavily using in @INC objects with overloading of stringification. I also really hope we make a change in File::ShareDir to support that. 

Thanks, 
Zhenyi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1790136" href="/Public/Bug/Display.html?id=60431#txn-1790136">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;09&nbsp;12:10:13&nbsp;2018</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1790136/962776/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/962776">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 242b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The common sense of the patch has been committed as
eb120ce ShareDir.pm: extract common sub _search_inc_path

If another patch would come around extracting the approval of the loop element into a dedicated check routine, I would be fine, too.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1916328" href="/Public/Bug/Display.html?id=60431#txn-1916328">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;21&nbsp;02:25:28&nbsp;2020</span>
    <span class="description">REHSACK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1916328/1026190/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1026190">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 70b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Looks to me as if the resolution provided in 1.106 is widely accepted.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1916330" href="/Public/Bug/Display.html?id=60431#txn-1916330">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;21&nbsp;02:25:28&nbsp;2020</span>
    <span class="description">REHSACK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.031351</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
