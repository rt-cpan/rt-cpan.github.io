<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #67271 for XML-Twig: Having seg fault with script on multi thread perl systems</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #67271 for XML-Twig: Having seg fault with script on multi thread perl systems</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=XML-Twig">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=XML-Twig">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=XML-Twig">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=XML-Twig">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-Twig">XML-Twig CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">67271</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=XML-Twig">XML-Twig</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Thorsten.Dombach [...] mabunta.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-37682-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
3.38    </td>
  </tr>
  <tr id="CF-37683-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




dev_network_objects.xml<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/919732/477175/dev_network_objects.xml">
Wed Apr 06 07:39:16 2011 (15.3k) by Thorsten.Dombach [...] mabunta.de
</a>
</font></li>
</ul>


ex_seg_fault.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/919732/477174/ex_seg_fault.pl">
Wed Apr 06 07:39:16 2011 (2.6k) by Thorsten.Dombach [...] mabunta.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=67271">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-919732" href="/Public/Bug/Display.html?id=67271#txn-919732">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;06&nbsp;07:39:16&nbsp;2011</span>
    <span class="description">Thorsten.Dombach [...] mabunta.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Having seg fault with script on multi thread perl systems</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/919732/477173/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/477173">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

when I use XML-Twig-3.38 in the stripped down script to extract some
information from the XML File, I get a segmentation fault with the
return statement.

I get the seg fault on the following systems:

 /usr/bin/perl -v
This is perl, v5.8.8 built for i586-linux-thread-multi
uname -a
Linux sl90113 2.6.16.60-0.58.1-xenpae #1 SMP Wed Dec 2 12:27:56 UTC 2009
i686 i686 i386 GNU/Linux
====
perl -v
This is perl, v5.10.0 built for x86_64-linux-thread-multi
 uname -a
Linux sl01166 2.6.27.39-0.2-xen #1 SMP 2009-11-23 12:57:38 +0100 x86_64
x86_64 x86_64 GNU/Linux
=====

Then I recompiled a new perl on system sl90113 without the following
options:

If this doesn&#39;t make any sense to you, just accept the default &#39;n&#39;.
Build a threading Perl? [n] 
If this doesn&#39;t make any sense to you, just accept the default &#39;n&#39;.
Build Perl for multiplicity? [n]

I now have:
 /usr/local/bin/perl -v
This is perl, v5.10.0 built for i686-linux-64int

Now the programm works fine. The problem for reproducing the bug is,
that the xml file need a size bigger than 25 MB. I can offer such kind
of file but not for public availability. I have a smaller one added with
dummy data for seeing the xml structure.

Regards,
Thorsten
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ex_seg_fault.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/919732/477174/ex_seg_fault.pl">Download ex_seg_fault.pl</a><br />
<span class="downloadcontenttype">text/x-perl 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/local/bin/perl
use Data::Dumper;
use XML::Twig;
# define the functions
sub f_create_twig {
 # create the twig of group and group members
 my $group  = $_[0];
 my $cma    = $_[1];
 my $conf   = ${$_[2]};
 my $DEBUG  = $_[3];
 my %all_mem_twig;
 my $group_found = 0;
 my $twig = XML::Twig-&gt;new&#40;pretty_print =&gt; &#39;indented&#39;&#41;;
 $twig-&gt;parsefile&#40;&#34;./eg_seg_fault.xml&#34;&#41;;
 my $root = $twig-&gt;root;
 # first find the searched group and all it&#39;s members
 foreach my $no &#40;$root-&gt;children&#40;&#39;network_object&#39;&#41;&#41;{
   if &#40;&#40;$no-&gt;first_child_text&#40;&#39;type&#39;&#41; eq &#34;group&#34;&#41; and &#40;$no-&gt;first_child_text&#40;&#39;Name&#39;&#41; eq $group&#41;&#41; {
     print &#34;group: &#34; . $no-&gt;first_child_text&#40;&#39;Name&#39;&#41; . &#34;\n&#34; if $DEBUG;
     $group_twig = $no-&gt;sprint&#40;0&#41;;
     foreach $mem &#40;$no-&gt;first_child&#40;&#39;members&#39;&#41;-&gt;children&#40;&#39;reference&#39;&#41;&#41; {
      print &#34;mem: &#34; . $mem-&gt;first_child_text&#40;&#39;Name&#39;&#41; . &#34;\n&#34; if $DEBUG;
      push&#40;@all_members,$mem-&gt;first_child_text&#40;&#39;Name&#39;&#41;&#41;;
      $group_found = 1;
     } # end foreach
   } # end if
   last if $group_found;
 } # end foreach
 if &#40;!$group_found&#41; {
  # group was not found on this cma
  print &#34;The group $group was not found on CMA $cma\n&#34;;
  return 0;
 }
 print &#34;all mem: @all_members\n&#34; if $DEBUG;
 foreach my $no &#40;$root-&gt;children&#40;&#39;network_object&#39;&#41;&#41; {
  foreach my $mem_name &#40;@all_members&#41; {
   if &#40;$no-&gt;first_child_text&#40;&#39;Name&#39;&#41; eq $mem_name&#41; {
    $all_mem_twig{$mem_name} = $no-&gt;sprint&#40;0&#41;;
   } # end if
  } # end foreach
 } # enf foreach
 return $group_twig, %all_mem_twig;
} # end sub f_create_twig
$DEBUG = 1;
my @cmas;
@cmas =&#40;&#34;site&#34;, &#34;third_customer&#34;&#41;;
# normally is here the config parameters from config file
$conf = &#34;config&#34;;
 # get master xml
 my &#40;$master_group_twig,%master_mem_twig&#41; = &#38;f_create_twig&#40;&#34;g_xTD-test-lok&#34;,&#34;application&#34;,\$conf,$DEBUG&#41;;
 # create cma xmls
# print &#34;before cma loop: @cmas\n&#34;;
# foreach my $cma &#40;@cmas&#41; {
#  print &#34;cma-loop:$groupname - cma: $cma\n&#34; if $DEBUG;
#  # create from every cma one twig of the group and an array of twigs for all members of the group
#  my &#40;$cma_group_twig,%cma_mem_twig&#41; = &#38;f_create_twig&#40;$groupname,$cma,\$conf,$DEBUG&#41;;
#print &#34;after return of f_create_twig\n&#34;;
#  # group is not found in this cma
#  next if &#40;!$cma_group_twig&#41;;
#  # compare the member names of the groups
#  # this print out when something is different in the amount or names of the members between master
#  &#38;f_cmp_mem&#40;\%master_mem_twig,\%cma_mem_twig,$cma,$groupname,$config{groups}-&gt;{$groupname}-&gt;{master},$DEBUG&#41;;
#  # now compare each member of the cma to the member of the master
#  #print &#34;cmp_xml: $master_xml-$tmp_xml-$cma-$group-$DEBUG\n&#34; if $DEBUG;
#  #&#38;f_cmp_xml&#40;$master_group_twig,$cma_group_twig,$cma,$groupname,$DEBUG&#41;;
# }
print &#34;\nEND\n&#34; if $DEBUG;
exit 0;

</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dev_network_objects.xml</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/919732/477175/dev_network_objects.xml">Download dev_network_objects.xml</a><br />
<span class="downloadcontenttype">text/xml 15.3k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-980775" href="/Public/Bug/Display.html?id=67271#txn-980775">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;23&nbsp;06:05:26&nbsp;2011</span>
    <span class="description">MIROD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/980775/510655/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/510655">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 511b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I am very sorry, I never saw this ticket for some reason.

So more for the sake of future readers: in your script you load the
entire XML in memory. There is no magic there, if the file is too big
you&#39;re going to use all of the system memory. 

If you want to process bigger files than can fit in memory, you need to
use the tools that XML::Twig give you to limit the size that&#39;s held in
memory at one time. Usually it means setting handlers, purging the twig
after processing certain elements...

__
mirod
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-980777" href="/Public/Bug/Display.html?id=67271#txn-980777">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;23&nbsp;06:05:27&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-980778" href="/Public/Bug/Display.html?id=67271#txn-980778">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;23&nbsp;06:05:27&nbsp;2011</span>
    <span class="description">MIROD [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-980798" href="/Public/Bug/Display.html?id=67271#txn-980798">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;23&nbsp;07:22:43&nbsp;2011</span>
    <span class="description">Thorsten.Dombach [...] mabunta.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AW: [rt.cpan.org #67271] Having seg fault with script on multi thread perl systems </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 23 Sep 2011 13:22:30 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-XML-Twig [...] rt.cpan.org&#34; &lt;bug-XML-Twig [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Thorsten Dombach &lt;Thorsten.Dombach [...] mabunta.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/980798/510675/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/510675">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

no problem. But sorry I cannot understand your answer. Because, when I use the 32 Bit not multithreaded Version
with the SAME XML File it works. For my understanding, I would expect that the 64 Bit Version did not crash, because
it can address more memory than the 32 Bit Version.
So how to understand this?

Regards,
Thorsten

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Ursprüngliche Nachricht-----
Von: MIROD via RT [mailto:bug-XML-Twig@rt.cpan.org] 
Gesendet: Freitag, 23. September 2011 12:05
An: Thorsten Dombach
Betreff: [rt.cpan.org #67271] Having seg fault with script on multi thread perl systems 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=67271">https://rt.cpan.org/Ticket/Display.html?id=67271</a></span> &gt;

Hi,

I am very sorry, I never saw this ticket for some reason.

So more for the sake of future readers: in your script you load the
entire XML in memory. There is no magic there, if the file is too big
you&#39;re going to use all of the system memory. 

If you want to process bigger files than can fit in memory, you need to
use the tools that XML::Twig give you to limit the size that&#39;s held in
memory at one time. Usually it means setting handlers, purging the twig
after processing certain elements...

__
mirod
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-980800" href="/Public/Bug/Display.html?id=67271#txn-980800">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;23&nbsp;07:22:45&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-980835" href="/Public/Bug/Display.html?id=67271#txn-980835">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;23&nbsp;10:01:17&nbsp;2011</span>
    <span class="description">MIROD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/980835/510692/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/510692">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 706b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 23 07:22:43 2011, Thorsten.Dombach@mabunta.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; no problem. But sorry I cannot understand your answer. Because,
&gt; when I use the 32 Bit not multithreaded Version
&gt; with the SAME XML
&gt; File it works. For my understanding, I would expect that the 64 Bit
&gt; Version did not crash, because
&gt; it can address more memory than the 32
&gt; Bit Version.
&gt; So how to understand this?
</div>
My guess would be that the 64 bit version requires more space, so when
you use the 32 bit Perl the entire XML still fits in memory, but when
you switch to the 64 bit Perl then you go over the machine size. 

You could check by looking at top while running your code, to see how
much memory it uses.

__
mirod
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1417933" href="/Public/Bug/Display.html?id=67271#txn-1417933">#</a>      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;05&nbsp;08:41:51&nbsp;2014</span>
    <span class="description">MIROD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1417933/752813/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/752813">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 804b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 23 10:01:17 2011, MIROD wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Sep 23 07:22:43 2011, Thorsten.Dombach@mabunta.de wrote:
<div class="message-stanza open">&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; no problem. But sorry I cannot understand your answer. Because,
&gt; &gt; when I use the 32 Bit not multithreaded Version
&gt; &gt; with the SAME XML
&gt; &gt; File it works. For my understanding, I would expect that the 64 Bit
&gt; &gt; Version did not crash, because
&gt; &gt; it can address more memory than the 32
&gt; &gt; Bit Version.
&gt; &gt; So how to understand this?
</div>&gt; 
&gt; My guess would be that the 64 bit version requires more space, so when
&gt; you use the 32 bit Perl the entire XML still fits in memory, but when
&gt; you switch to the 64 bit Perl then you go over the machine size. 
&gt; 
&gt; You could check by looking at top while running your code, to see how
&gt; much memory it uses.
&gt; 
&gt; __
&gt; mirod
</div>
-- 
__
mirod
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1417935" href="/Public/Bug/Display.html?id=67271#txn-1417935">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;05&nbsp;08:41:52&nbsp;2014</span>
    <span class="description">MIROD [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.464744</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
