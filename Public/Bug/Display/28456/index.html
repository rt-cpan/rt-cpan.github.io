<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #28456 for SVN-Notify: UTF-8 special characters in subject line not encoded correctly</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #28456 for SVN-Notify: UTF-8 special characters in subject line not encoded correctly</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=SVN-Notify">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=SVN-Notify">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=SVN-Notify">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=SVN-Notify">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/theory/svn-notify/issues/">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/SVN-Notify">SVN-Notify CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">28456</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">10 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=SVN-Notify">SVN-Notify</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jo [...] bitvalve.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-30306-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-30307-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.70    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=28456">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-347808" href="/Public/Bug/Display.html?id=28456#txn-347808">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;24&nbsp;18:02:26&nbsp;2007</span>
    <span class="description">jo [...] bitvalve.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> UTF-8 special characters in subject line not encoded correctly</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 25 Jul 2007 00:02:09 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JÃ¶rg &lt;jo [...] bitvalve.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/347808/156134/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/156134">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

I use SVN::Notify version 2.66
on a Debian etch GNU/Linux 2.6.16.18-amd64 System.
svn, version 1.4.2 &#40;r22196&#41;
perl, v5.8.8

We write German log messages and German Umlauts do not work properly:
I use the following command in the post-commit script:
LANG=en_US.utf8 /usr/bin/svnnotify -p &#34;${REPOS}&#34; -r &#34;${REV}&#34; -s
&#34;${SENDMAIL}&#34; -l &#34;${SVNLOOK}&#34; -H &#34;HTML::ColorDiff&#34; -t &#34;...@example.org&#34;

[Setting LANG=de_DE.utf8 does not work for us, since the output of
svnlook is then localized and SVN::Notify cannot handle that correctly,
it seems.]

The log message inline in the email is encoded correctly, it is
&#34;Hello UTF-8 Test: Umlaute Ã¤ Ã¶ Ã¼&#34;

but the subject field of the email is encoded like this:
&#34;Subject: [37] Hello UTF-8 Test:
=?UTF-8?Q?=20Umlaute=20=EF=BF=BD=20=EF=BF=BD=20=EF=BF=BD?=&#34;

But the byte string EF BF BD is Unicode character U+FFFD, which is the
REPLACEMENT CHARACTER for incoming characters whose value is unknown.


Is this a bug, or am I too stupid to configure SVN::Notify correctly?

Any help is appreciated



Thanks in advance

JÃ¶rg
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-348005" href="/Public/Bug/Display.html?id=28456#txn-348005">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;25&nbsp;09:46:41&nbsp;2007</span>
    <span class="description">http://xlogon.net/joerg -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jo [...] bitvalve.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/348005/156229/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/156229">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 138b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Di. 24. Jul. 2007, 18:02:26, jo@bitvalve.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I use SVN::Notify version 2.66
</div>

I am sorry. We actually use version 2.64

JÃ¶rg
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-348006" href="/Public/Bug/Display.html?id=28456#txn-348006">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;25&nbsp;09:46:44&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-362541" href="/Public/Bug/Display.html?id=28456#txn-362541">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;07:43:17&nbsp;2007</span>
    <span class="description">grousse [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> GROUSSE [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/362541/164067/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/164067">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 219b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Mar. Jul. 24 18:02:26 2007, jo@bitvalve.org a Ã©crit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is this a bug, or am I too stupid to configure SVN::Notify correctly?
</div>I have the same issue. I tried to play with charset and language options
without result.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-418029" href="/Public/Bug/Display.html?id=28456#txn-418029">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;06&nbsp;14:03:50&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">10 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/418029/204155/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/204155">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1007b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jul 24 18:02:26 2007, jo@bitvalve.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The log message inline in the email is encoded correctly, it is
&gt; &#34;Hello UTF-8 Test: Umlaute Ã¤ Ã¶ Ã¼&#34;
&gt; 
&gt; but the subject field of the email is encoded like this:
&gt; &#34;Subject: [37] Hello UTF-8 Test:
&gt; =?UTF-8?Q?=20Umlaute=20=EF=BF=BD=20=EF=BF=BD=20=EF=BF=BD?=&#34;
&gt; 
&gt; But the byte string EF BF BD is Unicode character U+FFFD, which is the
&gt; REPLACEMENT CHARACTER for incoming characters whose value is unknown.
&gt; 
&gt; 
&gt; Is this a bug, or am I too stupid to configure SVN::Notify correctly?
</div>
I believe it&#39;s a bug. Does this patch fix the issue for you?

Index: Notify.pm
===================================================================
--- Notify.pm   &#40;revision 3385&#41;
+++ Notify.pm   &#40;working copy&#41;
@@ -1131,7 +1131,7 @@
     # Q-Encoding &#40;RFC 2047&#41;
     if &#40;PERL58&#41; {
         require Encode;
-        Encode::from_to&#40;$self-&gt;{subject}, $self-&gt;{charset}, &#39;MIME-Q&#39;&#41;;
+        Encode::from_to&#40;$self-&gt;{subject}, &#39;utf8&#39;, &#39;MIME-Q&#39;&#41;;
     }
 
     return $self;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-418056" href="/Public/Bug/Display.html?id=28456#txn-418056">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;06&nbsp;14:13:35&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-418061" href="/Public/Bug/Display.html?id=28456#txn-418061">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;06&nbsp;14:15:46&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Severity Normal added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-418129" href="/Public/Bug/Display.html?id=28456#txn-418129">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;06&nbsp;20:28:21&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/418129/204209/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/204209">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 556b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Feb 06 14:03:50 2008, DWHEELER wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I believe it&#39;s a bug. Does this patch fix the issue for you?
</div>
Better yet, could you check the latest out of Subversion and give it a
try? I&#39;ve just rewritten the handling of character encodings.

  <span class="clickylink"><a target="new" rel="nofollow" href="https://svn.kineticode.com/SVN-Notify/trunk/">https://svn.kineticode.com/SVN-Notify/trunk/</a></span>

You&#39;ll want to use something like:

/usr/bin/svnnotify -p &#34;${REPOS}&#34; -r &#34;${REV}&#34; -s
&#34;${SENDMAIL}&#34; -l &#34;${SVNLOOK}&#34; -H &#34;HTML::ColorDiff&#34; -t &#34;...@example.org&#34;
--charset utf-8 --language de_DE

See also the new --svn-charset and --diff-charset options.

Thanks,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-418130" href="/Public/Bug/Display.html?id=28456#txn-418130">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;06&nbsp;20:28:24&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-422621" href="/Public/Bug/Display.html?id=28456#txn-422621">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;16&nbsp;07:57:04&nbsp;2008</span>
    <span class="description">jo [...] bitvalve.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #28456] UTF-8 special characters in subject line not encoded correctly</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 16 Feb 2008 13:56:18 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> JÃ¶rg &lt;jo [...] bitvalve.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/422621/206490/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/206490">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">David Wheeler via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=28456">http://rt.cpan.org/Ticket/Display.html?id=28456</a></span> &gt;
&gt; 
&gt; On Wed Feb 06 14:03:50 2008, DWHEELER wrote:
&gt; 
<div class="message-stanza open">&gt;&gt; I believe it&#39;s a bug. Does this patch fix the issue for you?
</div></div>
No! This patch does not change anything. Still the same problem.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Better yet, could you check the latest out of Subversion and give it a
&gt; try? I&#39;ve just rewritten the handling of character encodings.
&gt; 
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="https://svn.kineticode.com/SVN-Notify/trunk/">https://svn.kineticode.com/SVN-Notify/trunk/</a></span>
&gt; 
&gt; You&#39;ll want to use something like:
&gt; 
&gt; /usr/bin/svnnotify -p &#34;${REPOS}&#34; -r &#34;${REV}&#34; -s
&gt; &#34;${SENDMAIL}&#34; -l &#34;${SVNLOOK}&#34; -H &#34;HTML::ColorDiff&#34; -t &#34;...@example.org&#34;
&gt; --charset utf-8 --language de_DE
&gt; 
&gt; See also the new --svn-charset and --diff-charset options.
</div>
Yes, I think this works.
Though I could not test it on our productive system.
But I tried revision 3424 on my local machine using your testsendmail
program and this now gives the correct UTF-8 Unicode sequences when
writing umlauts, even in the Subject line.

Is the new handling for character encodings already in the current
upstream version &#40;2.67&#41;? If not, could you please add it?



Thank you

JÃ¶rg
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-423119" href="/Public/Bug/Display.html?id=28456#txn-423119">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;17&nbsp;13:00:24&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28456] UTF-8 special characters in subject line not encoded correctly</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 17 Feb 2008 09:59:47 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;David E. Wheeler&#34; &lt;dwheeler [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/423119/206764/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/206764">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 16, 2008, at 04:57, JÃ¶rg via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; Better yet, could you check the latest out of Subversion and give  
&gt;&gt; it a
&gt;&gt; try? I&#39;ve just rewritten the handling of character encodings.
&gt;&gt;
&gt;&gt;  <span class="clickylink"><a target="new" rel="nofollow" href="https://svn.kineticode.com/SVN-Notify/trunk/">https://svn.kineticode.com/SVN-Notify/trunk/</a></span>
&gt;&gt;
&gt;&gt; You&#39;ll want to use something like:
&gt;&gt;
&gt;&gt; /usr/bin/svnnotify -p &#34;${REPOS}&#34; -r &#34;${REV}&#34; -s
&gt;&gt; &#34;${SENDMAIL}&#34; -l &#34;${SVNLOOK}&#34; -H &#34;HTML::ColorDiff&#34; -t  
&gt;&gt; &#34;...@example.org&#34;
&gt;&gt; --charset utf-8 --language de_DE
&gt;&gt;
&gt;&gt; See also the new --svn-charset and --diff-charset options.
</div>&gt;
&gt; Yes, I think this works.
&gt; Though I could not test it on our productive system.
&gt; But I tried revision 3424 on my local machine using your testsendmail
&gt; program and this now gives the correct UTF-8 Unicode sequences when
&gt; writing umlauts, even in the Subject line.
</div>
Brilliant, thanks for the confirmation.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is the new handling for character encodings already in the current
&gt; upstream version &#40;2.67&#41;? If not, could you please add it?
</div>
No, not yet, but it will be later this week. Lots of changes coming.

Best,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-423803" href="/Public/Bug/Display.html?id=28456#txn-423803">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;18&nbsp;11:06:54&nbsp;2008</span>
    <span class="description">martin [...] unicorn.tv -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> martin [...] unicorn.tv</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/423803/207108/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207108">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello. I ran into the same problem with utf8 text appearing incorrectly.

I used version 2.65 as packaged with Ubuntu 7.10, where i would get utf8
text displayed correctly in the diffs, but in the mail subject and svn
commit logs the text would look like this:

&#34;h?\195?\164r testar ja ?\195?\133?\195?\132?\195?\150 igen!!!&#34;
correct would be: &#34;hÃ¤r testar ja Ã¥Ã¤Ã¶ igen!!!&#34;

So today I installed the svn trunk version on our dev machine at work
and used the following svn post-commit hook:

svnnotify -r &#34;$REV&#34; -p &#34;$REPOS&#34; \
 -C --subject-prefix &#34;[cs] &#34; -d \
 -H &#34;HTML::ColorDiff&#34; \
 --to &#34;svnlog@...&#34; \
 --from &#34;dev-server &lt;svn@...&gt;&#34; \
 --charset utf-8 --language sv_SE

Now the text in the subject is displayed correctly!

But instead, text in commit log &#38; diff is broken. It is now broken in
another way:

Subject: Ã¥Ã¤Ã¶ tredje gÃ¥ngen gillt??
Log message: ÃƒÂ¥ÃƒÂ¤ÃƒÂ¶ tredje gÃƒÂ¥ngen gillt??

And same type of coding error in the diff. This new problem looks like
when you try to display latin1 text as utf8.

I am very willing to test out any changes to this as this is a issue
that is hitting me daily since our commit logs are mostly in Swedish
language
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-423824" href="/Public/Bug/Display.html?id=28456#txn-423824">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;18&nbsp;13:45:26&nbsp;2008</span>
    <span class="description">david [...] justatheory.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28456] UTF-8 special characters in subject line not encoded correctly </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 18 Feb 2008 10:44:45 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;David E. Wheeler&#34; &lt;david [...] justatheory.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/423824/207126/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207126">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 18, 2008, at 08:06, Martin Lindhe via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So today I installed the svn trunk version on our dev machine at work
&gt; and used the following svn post-commit hook:
&gt;
&gt; svnnotify -r &#34;$REV&#34; -p &#34;$REPOS&#34; \
&gt; -C --subject-prefix &#34;[cs] &#34; -d \
&gt; -H &#34;HTML::ColorDiff&#34; \
&gt; --to &#34;svnlog@...&#34; \
&gt; --from &#34;dev-server &lt;svn@...&gt;&#34; \
&gt; --charset utf-8 --language sv_SE
&gt;
&gt; Now the text in the subject is displayed correctly!
</div>
W00t!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But instead, text in commit log &#38; diff is broken. It is now broken in
&gt; another way:
&gt;
&gt; Subject: Ã¥Ã¤Ã¶ tredje gÃ¥ngen gillt??
&gt; Log message: ÃƒÂ¥ÃƒÂ¤ÃƒÂ¶ tredje gÃƒÂ¥ngen gillt??
&gt;
&gt; And same type of coding error in the diff. This new problem looks like
&gt; when you try to display latin1 text as utf8.
</div>
Hrm. In what encoding are your log messages and files kept in svn?  
UTF-8? And what happens if you omit the --language bit?

Could you send me the output of svnlook to use in my tests? I would  
need something like this:

   LANG=sv_SE.utf-8 svnlook svnlook info /path/to/svnroot -r 3426 &gt;  
info.txt

And something like this:

   LANG=sv_SE.utf-8 svnlook svnlook diff /path/to/svnroot -r 3426 &gt;  
diff.txt

Then send me those text files. A small commit that demonstrates the  
above would be best. Please do make sure that the output looks right  
in your text editor, though, and tweak the LANG environment variable  
if you need to get get it right.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am very willing to test out any changes to this as this is a issue
&gt; that is hitting me daily since our commit logs are mostly in Swedish
&gt; language
</div>
Thanks, I appreciate it.

Best,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-424103" href="/Public/Bug/Display.html?id=28456#txn-424103">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;18&nbsp;19:54:10&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28456] UTF-8 special characters in subject line not encoded correctly </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 18 Feb 2008 16:53:34 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;David E. Wheeler&#34; &lt;dwheeler [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/424103/207299/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207299">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 567b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 18, 2008, at 10:45, david@justatheory.com via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;&gt; But instead, text in commit log &#38; diff is broken. It is now broken in
&gt;&gt; another way:
&gt;&gt;
&gt;&gt; Subject: Ã¥Ã¤Ã¶ tredje gÃ¥ngen gillt??
&gt;&gt; Log message: ÃƒÂ¥ÃƒÂ¤ÃƒÂ¶ tredje gÃƒÂ¥ngen gillt??
&gt;&gt;
&gt;&gt; And same type of coding error in the diff. This new problem looks  
&gt;&gt; like
&gt;&gt; when you try to display latin1 text as utf8.
</div>
I think I&#39;ve fixed this. Can you update your checkout of SVN::Notify  
and try again? It should be fixed as of r3434.

   <span class="clickylink"><a target="new" rel="nofollow" href="https://svn.kineticode.com/SVN-Notify/trunk/">https://svn.kineticode.com/SVN-Notify/trunk/</a></span>

Thanks,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-424292" href="/Public/Bug/Display.html?id=28456#txn-424292">#</a>      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;19&nbsp;03:35:09&nbsp;2008</span>
    <span class="description">martin [...] unicorn.tv -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> martin [...] unicorn.tv</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/424292/207374/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207374">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 736b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Feb 18 19:54:10 2008, DWHEELER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think I&#39;ve fixed this. Can you update your checkout of SVN::Notify  
&gt; and try again? It should be fixed as of r3434.
&gt; 
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="https://svn.kineticode.com/SVN-Notify/trunk/">https://svn.kineticode.com/SVN-Notify/trunk/</a></span>
&gt; 
&gt; Thanks,
&gt; 
&gt; David
&gt; 
</div>
I just tried with r3438. Text is displayed correctly again in log
message &#38; in diff!!

But hmm you broke somehting else. In subject there are now &#34;X&#34; instead
of swedish letters. Like this:

Subject: XXXXXX gogogogo
Should be: Ã¥Ã¤Ã¶ gogogogo

apart from that, which does look intentional &#40;?&#41;, it is starting to work!

And regarding earlier question about text format yes the source code is
in utf8, and i believe svn uses utf8 to store the log messages in
aswell, not sure about that...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-424466" href="/Public/Bug/Display.html?id=28456#txn-424466">#</a>      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;19&nbsp;14:27:29&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28456] UTF-8 special characters in subject line not encoded correctly </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 19 Feb 2008 11:26:59 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;David E. Wheeler&#34; &lt;dwheeler [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/424466/207485/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207485">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 704b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 19, 2008, at 00:35, Martin Lindhe via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I just tried with r3438. Text is displayed correctly again in log
&gt; message &#38; in diff!!
</div>
Awesome.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But hmm you broke somehting else. In subject there are now &#34;X&#34; instead
&gt; of swedish letters. Like this:
&gt;
&gt; Subject: XXXXXX gogogogo
&gt; Should be: Ã¥Ã¤Ã¶ gogogogo
&gt;
&gt; apart from that, which does look intentional &#40;?&#41;, it is starting to  
&gt; work!
&gt;
&gt; And regarding earlier question about text format yes the source code  
&gt; is
&gt; in utf8, and i believe svn uses utf8 to store the log messages in
&gt; aswell, not sure about that...
</div>
Ah, I see. I&#39;ve just fixed that, too, I think. Please update your  
checkout and give it another try.

Thanks!

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-424662" href="/Public/Bug/Display.html?id=28456#txn-424662">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;20&nbsp;04:05:08&nbsp;2008</span>
    <span class="description">martin [...] unicorn.tv -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> martin [...] unicorn.tv</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/424662/207610/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207610">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 499b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Feb 19 14:27:29 2008, DWHEELER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Ah, I see. I&#39;ve just fixed that, too, I think. Please update your  
&gt; checkout and give it another try.
&gt; 
&gt; Thanks!
&gt; 
&gt; David
&gt; 
</div>
I just tried r3447, and the problem is actually back to the beginning :&#40;

Subject: ?\195?\165?\195?\164?\195? \182 test!!!
Log message: ?\195?\165?\195?\164?\195?\182 test!!!

utf8 is displayed correctly in diff


Also, i had to fix a bug in Notify.pm to get it working at all. Trying
to figure how to submit that now
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-424862" href="/Public/Bug/Display.html?id=28456#txn-424862">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;20&nbsp;16:23:25&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28456] UTF-8 special characters in subject line not encoded correctly </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 Feb 2008 12:17:40 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;David E. Wheeler&#34; &lt;dwheeler [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/424862/207742/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207742">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 663b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 20, 2008, at 01:05, Martin Lindhe via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I just tried r3447, and the problem is actually back to the  
&gt; beginning :&#40;
&gt;
&gt; Subject: ?\195?\165?\195?\164?\195? \182 test!!!
&gt; Log message: ?\195?\165?\195?\164?\195?\182 test!!!
&gt;
&gt; utf8 is displayed correctly in diff
</div>
Yes, this seems to be a peculiarity of svnlook. See here:

   <span class="clickylink"><a target="new" rel="nofollow" href="http://subversion.tigris.org/servlets/ReadMsg?list=users&#38;msgNo=74948">http://subversion.tigris.org/servlets/ReadMsg?list=users&#38;msgNo=74948</a></span>

If you set --language and --charset to come out to a valid locale on  
your system, it should fix the issue.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, i had to fix a bug in Notify.pm to get it working at all. Trying
&gt; to figure how to submit that now
</div>
Much obliged.

Best,

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-425133" href="/Public/Bug/Display.html?id=28456#txn-425133">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;21&nbsp;03:25:33&nbsp;2008</span>
    <span class="description">martin [...] unicorn.tv -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> martin [...] unicorn.tv</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/425133/207880/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/207880">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Feb 20 16:23:25 2008, DWHEELER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Feb 20, 2008, at 01:05, Martin Lindhe via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; I just tried r3447, and the problem is actually back to the  
&gt; &gt; beginning :&#40;
&gt; &gt;
&gt; &gt; Subject: ?\195?\165?\195?\164?\195? \182 test!!!
&gt; &gt; Log message: ?\195?\165?\195?\164?\195?\182 test!!!
&gt; &gt;
&gt; &gt; utf8 is displayed correctly in diff
</div>&gt; 
&gt; Yes, this seems to be a peculiarity of svnlook. See here:
&gt; 
&gt;    <span class="clickylink"><a target="new" rel="nofollow" href="http://subversion.tigris.org/servlets/ReadMsg?list=users&#38;msgNo=74948">http://subversion.tigris.org/servlets/ReadMsg?list=users&#38;msgNo=74948</a></span>
&gt; 
&gt; If you set --language and --charset to come out to a valid locale on  
&gt; your system, it should fix the issue.
</div>
Well i read your message about svnlook and maybe that is indeed the
issue. However i can happily report that with r3453 it appears to fully
work with utf8 in both subject, log message and the diff!!!

Thanks alot for the help getting this fixed.

PS. here is my post-commit hook:

#!/bin/sh

REPOS=&#34;$1&#34;
REV=&#34;$2&#34;

svnnotify -r &#34;$REV&#34; -p &#34;$REPOS&#34; \
 -C --subject-prefix &#34;[cs] &#34; -d \
 -H &#34;HTML::ColorDiff&#34; \
 --to &#34;svnlog@...&#34; \
 --from &#34;dev-server &lt;svn@dev-server&gt;&#34; \
 --charset utf-8 --language sv_SE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-425392" href="/Public/Bug/Display.html?id=28456#txn-425392">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;21&nbsp;18:06:05&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #28456] UTF-8 special characters in subject line not encoded correctly </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Feb 2008 14:33:40 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-SVN-Notify [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;David E. Wheeler&#34; &lt;dwheeler [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/425392/208062/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/208062">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 515b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Feb 21, 2008, at 00:25, Martin Lindhe via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Well i read your message about svnlook and maybe that is indeed the
&gt; issue. However i can happily report that with r3453 it appears to  
&gt; fully
&gt; work with utf8 in both subject, log message and the diff!!!
</div>
Great, I guess your OS has sv_SE.UTF-8 as a valid locale. Wish mine  
supported UTF-8. :-&#40;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks alot for the help getting this fixed.
&gt;
&gt; PS. here is my post-commit hook:
</div>
Yes, helpful, thank you. I hope to get a new version out soon.

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-433894" href="/Public/Bug/Display.html?id=28456#txn-433894">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;12&nbsp;18:02:33&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-433896" href="/Public/Bug/Display.html?id=28456#txn-433896">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;12&nbsp;18:02:34&nbsp;2008</span>
    <span class="description">dwheeler [...] cpan.org -  Fixed in 2.70 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.843423</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
