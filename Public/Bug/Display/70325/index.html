<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #70324 for Tk-TableMatrix: suspected discrepancy with active cell</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #70324 for Tk-TableMatrix: suspected discrepancy with active cell</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Tk-TableMatrix/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Tk-TableMatrix/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Tk-TableMatrix/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Tk-TableMatrix/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Tk-TableMatrix">Tk-TableMatrix CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">70324</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Tk-TableMatrix/Active/">Tk-TableMatrix</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
henry.merryweather [...] btinternet.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-34052-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-34053-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;17&nbsp;16:42:45&nbsp;2011</span>
    <span class="description">henry.merryweather [...] btinternet.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> suspected discrepancy with active cell</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 17 Aug 2011 21:42:31 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk-TableMatrix [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Henry Merryweather &lt;henry.merryweather [...] btinternet.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have something that I do understand about what is given for the 
selected cell in a table matrix.
The Perl below creates a table matrix and the sub brscmd is used 
whenever a cell is slected using either the left hand mouse key or the 
up/down and left/right keys on the key board.
The selected cell is obtained in two ways. These are
1. from the &#39;standard&#39; argument to the browse sub;
2. using $t-&gt;curselection&#40;&#41; where $t is the table matrix.
Both values are printed out.
When I use the left hand mouse key both values are the same.
When I use the keyboard keys, the value from curselection always seems 
to be that for the previous selection of a cell.
I suspect that something is not as it should be.

use Tk; use Tk::TableMatrix; my $mw = MainWindow-&gt;new; my $arrayVar = 
{}; print &#34;Filling Array...\n&#34;; my &#40;$rows,$cols&#41; = &#40;10, 10&#41;; foreach my 
$row &#40;0..&#40;$rows-1&#41;&#41;{ foreach my $col &#40;0..&#40;$cols-1&#41;&#41;{ 
$arrayVar-&gt;{&#34;$row,$col&#34;} = 2*$row + 3*$col; } } print &#34;Creating 
Table...\n&#34;; my $t = $mw-&gt;Scrolled&#40;&#39;TableMatrix&#39;, -rows =&gt; $rows, -cols 
=&gt; $cols, -width =&gt; 10, -height =&gt; 10, -titlerows =&gt; 1, -titlecols =&gt; 1, 
-variable =&gt; $arrayVar, -coltagcommand =&gt; \&#38;colSub, -browsecommand =&gt; 
\&#38;brscmd, -colstretchmode =&gt; &#39;last&#39;, -rowstretchmode =&gt; &#39;last&#39;, 
-selectmode =&gt; &#39;extended&#39;, -selecttitles =&gt; 0, -drawmode =&gt; &#39;slow&#39;, 
-scrollbars=&gt;&#39;se&#39; &#41;; $t-&gt;pack&#40;-expand =&gt; 1, -fill =&gt; &#39;both&#39;&#41;; 
Tk::MainLoop; sub brscmd { my &#40;$previous_index, $actual_index&#41; = @_; my 
&#40;$row, $col&#41; = split &#39;,&#39;, $actual_index; my &#40;$sel, $js&#41;; my $sel = 
$t-&gt;curselection&#40;&#41;; foreach $js &#40;@$sel&#41; { print &#34;\n[brscmd] actual index 
&lt;$actual_index&gt; from curselection &lt;+$js&gt;\n&#34;; } } Best regards Henry 
Merryweather
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;17&nbsp;16:50:04&nbsp;2011</span>
    <span class="description">henry.merryweather [...] btinternet.com - Ticket #70325:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fwd: suspected discrepancy with active cell</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 17 Aug 2011 21:49:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk-TableMatrix [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Henry Merryweather &lt;henry.merryweather [...] btinternet.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">/I am sorry but I had not fully read what is required with a bug.  
Therefore I am sending this again with as much as I can of that infomration.
Please let me know if you need more.

The results of using perl -v were
/
This is perl 5, version 12, subversion 2 &#40;v5.12.2&#41; built for 
MSWin32-x86-multi-thread
&#40;with 2 registered patches, see perl -V for more detail&#41;


/The results of using perl -V were/

Summary of my perl5 &#40;revision 5 version 12 subversion 2&#41; configuration:

   Platform:
     osname=MSWin32, osvers=5.1, archname=MSWin32-x86-multi-thread
     uname=&#39;&#39;
     config_args=&#39;undef&#39;
     hint=recommended, useposix=true, d_sigaction=undef
     useithreads=define, usemultiplicity=define
     useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
     use64bitint=undef, use64bitall=undef, uselongdouble=undef
     usemymalloc=y, bincompat5005=undef
   Compiler:
     cc=&#39;cl&#39;, ccflags =&#39;-nologo -GF -W3 -MD -Zi -DNDEBUG -O1 -DWIN32 
-D_CONSOLE -DNO_STRICT -DHAVE_DE
S_FCRYPT -D_CRT_SECURE_NO_DEPRECATE -D_CRT_NONSTDC_NO_DEPRECATE  
-DPERL_DEBUGGING_MSTATS -DPERL_IMPL
ICIT_CONTEXT -DUSE_PERLIO&#39;,
     optimize=&#39;-MD -Zi -DNDEBUG -O1&#39;,
     cppflags=&#39;-DWIN32&#39;
     ccversion=&#39;16.00.30319.01&#39;, gccversion=&#39;&#39;, gccosandvers=&#39;&#39;
     intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
     d_longlong=undef, longlongsize=8, d_longdbl=define, longdblsize=8
     ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, 
Off_t=&#39;__int64&#39;, lseeksize=8
     alignbytes=8, prototype=define
   Linker and Libraries:
     ld=&#39;link&#39;, ldflags =&#39;-nologo -nodefaultlib -debug -opt:ref,icf  
-libpath:&#34;C:\Radview\perl5\lib\C
ORE&#34;  -machine:x86 &#34;/manifestdependency:type=&#39;Win32&#39; 
name=&#39;Microsoft.Windows.Common-Controls&#39; versio
n=&#39;6.0.0.0&#39; processorArchitecture=&#39;*&#39; publicKeyToken=&#39;6595b64144ccf1df&#39; 
language=&#39;*&#39;&#34;&#39;
     libpth=\lib
     libs=  oldnames.lib kernel32.lib user32.lib gdi32.lib winspool.lib  
comdlg32.lib advapi32.lib sh
ell32.lib ole32.lib oleaut32.lib  netapi32.lib uuid.lib ws2_32.lib 
mpr.lib winmm.lib  version.lib od
bc32.lib odbccp32.lib comctl32.lib msvcrt.lib
     perllibs=  oldnames.lib kernel32.lib user32.lib gdi32.lib 
winspool.lib  comdlg32.lib advapi32.li
b shell32.lib ole32.lib oleaut32.lib  netapi32.lib uuid.lib ws2_32.lib 
mpr.lib winmm.lib  version.li
b odbc32.lib odbccp32.lib comctl32.lib msvcrt.lib
     libc=msvcrt.lib, so=dll, useshrplib=true, libperl=perl512.lib
     gnulibc_version=&#39;&#39;
   Dynamic Linking:
     dlsrc=dl_win32.xs, dlext=dll, d_dlsymun=undef, ccdlflags=&#39; &#39;
     cccdlflags=&#39; &#39;, lddlflags=&#39;-dll -nologo -nodefaultlib -debug 
-opt:ref,icf  -libpath:&#34;C:\Radview\
perl5\lib\CORE&#34;  -machine:x86 &#34;/manifestdependency:type=&#39;Win32&#39; 
name=&#39;Microsoft.Windows.Common-Contr
ols&#39; version=&#39;6.0.0.0&#39; processorArchitecture=&#39;*&#39; 
publicKeyToken=&#39;6595b64144ccf1df&#39; language=&#39;*&#39;&#34;&#39;


Characteristics of this binary &#40;from libperl&#41;:
   Compile-time options: MULTIPLICITY MYMALLOC PERL_DONT_CREATE_GVSV
                         PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP USE_ITHREADS
                         USE_LARGE_FILES USE_PERLIO USE_PERL_ATOF
   Locally applied patches:
         Add Visual C++ 2010 support
         Disable registry-lookup of missing PERL* environment variables
   Built under MSWin32
   Compiled at Nov 29 2010 10:44:05
   @INC:
     H:/perl5/site/lib
     H:/perl5/lib
     .

/Original e-mail/

I have something that I do understand about what is given for the 
selected cell in a table matrix.
The Perl below creates a table matrix and the sub brscmd is used 
whenever a cell is slected using either the left hand mouse key or the 
up/down and left/right keys on the key board.
The selected cell is obtained in two ways. These are
1. from the &#39;standard&#39; argument to the browse sub;
2. using $t-&gt;curselection&#40;&#41; where $t is the table matrix.
Both values are printed out.
When I use the left hand mouse key both values are the same.
When I use the keyboard keys, the value from curselection always seems 
to be that for the previous selection of a cell.
I suspect that something is not as it should be.

use Tk; use Tk::TableMatrix; my $mw = MainWindow-&gt;new; my $arrayVar = 
{}; print &#34;Filling Array...\n&#34;; my &#40;$rows,$cols&#41; = &#40;10, 10&#41;; foreach my 
$row &#40;0..&#40;$rows-1&#41;&#41;{ foreach my $col &#40;0..&#40;$cols-1&#41;&#41;{ 
$arrayVar-&gt;{&#34;$row,$col&#34;} = 2*$row + 3*$col; } } print &#34;Creating 
Table...\n&#34;; my $t = $mw-&gt;Scrolled&#40;&#39;TableMatrix&#39;, -rows =&gt; $rows, -cols 
=&gt; $cols, -width =&gt; 10, -height =&gt; 10, -titlerows =&gt; 1, -titlecols =&gt; 1, 
-variable =&gt; $arrayVar, -coltagcommand =&gt; \&#38;colSub, -browsecommand =&gt; 
\&#38;brscmd, -colstretchmode =&gt; &#39;last&#39;, -rowstretchmode =&gt; &#39;last&#39;, 
-selectmode =&gt; &#39;extended&#39;, -selecttitles =&gt; 0, -drawmode =&gt; &#39;slow&#39;, 
-scrollbars=&gt;&#39;se&#39; &#41;; $t-&gt;pack&#40;-expand =&gt; 1, -fill =&gt; &#39;both&#39;&#41;; 
Tk::MainLoop; sub brscmd { my &#40;$previous_index, $actual_index&#41; = @_; my 
&#40;$row, $col&#41; = split &#39;,&#39;, $actual_index; my &#40;$sel, $js&#41;; my $sel = 
$t-&gt;curselection&#40;&#41;; foreach $js &#40;@$sel&#41; { print &#34;\n[brscmd] actual index 
&lt;$actual_index&gt; from curselection &lt;+$js&gt;\n&#34;; } } Best regards Henry 
Merryweather
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;20&nbsp;09:35:57&nbsp;2011</span>
    <span class="description">CERNEY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The behavior you are seeing is an artifact of the additional bindings
added by the Tk::TableMatrix::Spreadhsheet package on top of the base
Tk::TableMatrix package.

You can get consistent behavior between the mouse-click and the keyboard
cell selections by using a &#34;afterIdle&#34; call in your browsecmd as shown
below. The callback supplied to the &#34;afterIdle&#34; call will get executed
after all the selection code has been called, which should ensure the
selection has been updated.

Modified brscmd with afterIdle call:

sub brscmd {

        my &#40; $previous_index, $actual_index &#41; = @_;

        my &#40; $row, $col &#41; = split &#39;,&#39;, $actual_index;
        my &#40; $sel, $js &#41;;        
        $t-&gt;afterIdle&#40; sub{
                my $sel = $t-&gt;curselection&#40;&#41;;
                foreach $js &#40;@$sel&#41; {
                        print &#34;[brscmd] actual index &lt;$actual_index&gt;
from curselection &lt;+$js&gt;\n&#34;;
                }
        }
        &#41;;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;20&nbsp;09:35:58&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;20&nbsp;12:29:29&nbsp;2011</span>
    <span class="description">henry.merryweather [...] btinternet.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #70324] suspected discrepancy with active cell</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 20 Aug 2011 17:29:19 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk-TableMatrix [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Henry Merryweather &lt;henry.merryweather [...] btinternet.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for that.  I will try it and let you know what I find.

Best regards

Henry Merryweather

On 20/08/2011 14:35, CERNEY via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=70324">https://rt.cpan.org/Ticket/Display.html?id=70324</a></span>&gt;
&gt;
&gt; The behavior you are seeing is an artifact of the additional bindings
&gt; added by the Tk::TableMatrix::Spreadhsheet package on top of the base
&gt; Tk::TableMatrix package.
&gt;
&gt; You can get consistent behavior between the mouse-click and the keyboard
&gt; cell selections by using a &#34;afterIdle&#34; call in your browsecmd as shown
&gt; below. The callback supplied to the &#34;afterIdle&#34; call will get executed
&gt; after all the selection code has been called, which should ensure the
&gt; selection has been updated.
&gt;
&gt; Modified brscmd with afterIdle call:
&gt;
&gt; sub brscmd {
&gt;
&gt;          my &#40; $previous_index, $actual_index &#41; = @_;
&gt;
&gt;          my &#40; $row, $col &#41; = split &#39;,&#39;, $actual_index;
&gt;          my &#40; $sel, $js &#41;;
&gt;          $t-&gt;afterIdle&#40; sub{
&gt;                  my $sel = $t-&gt;curselection&#40;&#41;;
&gt;                  foreach $js &#40;@$sel&#41; {
&gt;                          print &#34;[brscmd] actual index&lt;$actual_index&gt;
&gt; from curselection&lt;+$js&gt;\n&#34;;
&gt;                  }
&gt;          }
&gt;          &#41;;
&gt; }
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;21&nbsp;04:21:33&nbsp;2011</span>
    <span class="description">henry.merryweather [...] btinternet.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #70324] suspected discrepancy with active cell</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 21 Aug 2011 09:21:17 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk-TableMatrix [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Henry Merryweather &lt;henry.merryweather [...] btinternet.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have now tested that and reverting is fine.  It also sorted out 
something else.

In trying to find a work around to the original problem I added binds so 
that I could tell when either a key or button had been used.  I hoped 
that I would be able to tell from that what to do about the selected 
cell.  Unfortunately the &#39;problem&#39; meant that the bind for the key was 
actioned after the brscmd was complete.  Your fix means that the key 
bind happens in the afterIdle sub so this is now OK as well.

Attached s the Perl code where this is done.

One question.  Are you content that I post this on Perl Monks pages in 
case others have similar problems.

I would like to say that I have found the tablematrix features excellent 
for an application I have just implemented.

Best regards

Henry Merryweather

On 20/08/2011 14:35, CERNEY via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=70324">https://rt.cpan.org/Ticket/Display.html?id=70324</a></span>&gt;
&gt;
&gt; The behavior you are seeing is an artifact of the additional bindings
&gt; added by the Tk::TableMatrix::Spreadhsheet package on top of the base
&gt; Tk::TableMatrix package.
&gt;
&gt; You can get consistent behavior between the mouse-click and the keyboard
&gt; cell selections by using a &#34;afterIdle&#34; call in your browsecmd as shown
&gt; below. The callback supplied to the &#34;afterIdle&#34; call will get executed
&gt; after all the selection code has been called, which should ensure the
&gt; selection has been updated.
&gt;
&gt; Modified brscmd with afterIdle call:
&gt;
&gt; sub brscmd {
&gt;
&gt;          my &#40; $previous_index, $actual_index &#41; = @_;
&gt;
&gt;          my &#40; $row, $col &#41; = split &#39;,&#39;, $actual_index;
&gt;          my &#40; $sel, $js &#41;;
&gt;          $t-&gt;afterIdle&#40; sub{
&gt;                  my $sel = $t-&gt;curselection&#40;&#41;;
&gt;                  foreach $js &#40;@$sel&#41; {
&gt;                          print &#34;[brscmd] actual index&lt;$actual_index&gt;
&gt; from curselection&lt;+$js&gt;\n&#34;;
&gt;                  }
&gt;          }
&gt;          &#41;;
&gt; }
&gt;
&gt;
</div></div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;08:16:20&nbsp;2011</span>
    <span class="description">CERNEY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Posting on perlmonks &#40;or whereever&#41; is fine.

-John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;08:16:34&nbsp;2011</span>
    <span class="description">CERNEY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;10:26:43&nbsp;2011</span>
    <span class="description">henry.merryweather [...] btinternet.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #70324] suspected discrepancy with active cell</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 22 Aug 2011 15:26:30 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tk-TableMatrix [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Henry Merryweather &lt;henry.merryweather [...] btinternet.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ok thanks.

Best regards

Henry Merryweather

On 22/08/2011 13:16, CERNEY via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=70324">https://rt.cpan.org/Ticket/Display.html?id=70324</a></span>&gt;
&gt;
&gt; Posting on perlmonks &#40;or whereever&#41; is fine.
&gt;
&gt; -John
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;10:26:44&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;10&nbsp;01:20:38&nbsp;2020</span>
    <span class="description">CAC [...] cpan.org - Ticket #70325:  Merged into ticket #70324</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;10&nbsp;01:20:38&nbsp;2020</span>
    <span class="description">CAC [...] cpan.org -  Merged into ticket #70324</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;10&nbsp;01:21:17&nbsp;2020</span>
    <span class="description">CAC [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
