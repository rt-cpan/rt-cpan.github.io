<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #114614 for Data-Sah-Coerce: Indexer problems?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #114614 for Data-Sah-Coerce: Indexer problems?</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Data-Sah-Coerce/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Data-Sah-Coerce/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Data-Sah-Coerce/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Data-Sah-Coerce/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Data-Sah-Coerce">Data-Sah-Coerce CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">114614</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Data-Sah-Coerce/Active/">Data-Sah-Coerce</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
SREZIC [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-264514-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.011    </td>
  </tr>
  <tr id="CF-264515-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;23&nbsp;14:13:34&nbsp;2016</span>
    <span class="description">SREZIC [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Indexer problems?</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">0.011 does not seem to be indexed &#40;some eight hours or so after upload&#41;. MetaCPAN still links to the 0.010 version: <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/Data-Sah-Coerce">https://metacpan.org/release/Data-Sah-Coerce</a></span>
And the CPAN.pm shell also lists the old version:

cpan[2]&gt; m Data::Sah::Coerce
Module id = Data::Sah::Coerce
    CPAN_USERID  PERLANCAR &#40;perlancar &lt;perlancar@gmail.com&gt;&#41;
    CPAN_VERSION 0.010
    CPAN_FILE    P/PE/PERLANCAR/Data-Sah-Coerce-0.010.tar.gz
    INST_FILE    &#40;not installed&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;24&nbsp;02:08:54&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 23 May 2016 18:13:34 GMT, SREZIC wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 0.011 does not seem to be indexed &#40;some eight hours or so after
&gt; upload&#41;. MetaCPAN still links to the 0.010 version:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/Data-Sah-Coerce">https://metacpan.org/release/Data-Sah-Coerce</a></span>
&gt; And the CPAN.pm shell also lists the old version:
&gt; 
&gt; cpan[2]&gt; m Data::Sah::Coerce
&gt; Module id = Data::Sah::Coerce
&gt;     CPAN_USERID  PERLANCAR &#40;perlancar &lt;perlancar@gmail.com&gt;&#41;
&gt;     CPAN_VERSION 0.010
&gt;     CPAN_FILE    P/PE/PERLANCAR/Data-Sah-Coerce-0.010.tar.gz
&gt;     INST_FILE    &#40;not installed&#41;
</div>
PAUSE reported indexing success though. I&#39;ll reindex.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;24&nbsp;02:08:54&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;24&nbsp;05:17:29&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 24 May 2016 06:08:54 GMT, PERLANCAR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon, 23 May 2016 18:13:34 GMT, SREZIC wrote:
<div class="message-stanza open">&gt; &gt; 0.011 does not seem to be indexed &#40;some eight hours or so after
&gt; &gt; upload&#41;. MetaCPAN still links to the 0.010 version:
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/Data-Sah-Coerce">https://metacpan.org/release/Data-Sah-Coerce</a></span>
&gt; &gt; And the CPAN.pm shell also lists the old version:
&gt; &gt; 
&gt; &gt; cpan[2]&gt; m Data::Sah::Coerce
&gt; &gt; Module id = Data::Sah::Coerce
&gt; &gt;     CPAN_USERID  PERLANCAR &#40;perlancar &lt;perlancar@gmail.com&gt;&#41;
&gt; &gt;     CPAN_VERSION 0.010
&gt; &gt;     CPAN_FILE    P/PE/PERLANCAR/Data-Sah-Coerce-0.010.tar.gz
&gt; &gt;     INST_FILE    &#40;not installed&#41;
</div>&gt; 
&gt; PAUSE reported indexing success though. I&#39;ll reindex.
</div>
Fixed, but something peculiar about why this happened. I&#39;m cc-ing to Andreas in case he wants to investigate.

I suspect in this case, 0.010 was somehow indexed *after* 0.011. Or, since that shouldn&#39;t have succeeded in the first place, perhaps at the same time &#40;race condition&#41;? I&#39;m guessing the indexer runs in more than one processes/threads? Details below.

Due to network flakiness on my part and also the recent PAUSE random 500 errors, I sometimes upload several distributions &#34;at once&#34; &#40;within seconds from one another, in a single batch, using App::pause CLI: &#39;pause upload *&#39;&#41;. And in this case, 0.010 was uploaded along with 0.011.

The timestamps from PAUSE upload email report look like this:

    Subject: CPAN Upload: P/PE/PERLANCAR/Data-Sah-Coerce-0.011.tar.gz
    To: &#34;perlancar&#34; &lt;perlancar@gmail.com&gt;
    From: PAUSE &lt;upload@pause.perl.org&gt;
    Message-Id: &lt;20160523062859.5E4D8195E@pause.perl.org&gt;
    Date: Mon, 23 May 2016 06:28:59 +0000 &#40;UTC&#41;

    Subject: CPAN Upload: P/PE/PERLANCAR/Data-Sah-Coerce-0.010.tar.gz
    To: &#34;perlancar&#34; &lt;perlancar@gmail.com&gt;
    From: PAUSE &lt;upload@pause.perl.org&gt;
    Message-Id: &lt;20160523062847.E6746195E@pause.perl.org&gt;
    Date: Mon, 23 May 2016 06:28:47 +0000 &#40;UTC&#41;

Which look right. Then, a couple of minutes later, came the PAUSE indexing report emails, which also look right &#40;down to the timestamps of all the Received headers&#41;:

    Subject: PAUSE indexer report PERLANCAR/Data-Sah-Coerce-0.011.tar.gz
    From: PAUSE &lt;upload@pause.perl.org&gt;
    Date: Tue, 24 May 2016 06:56:16 +0000
    Message-Id: &lt;20160524065616.71524153F@pause.perl.org&gt;

    Subject: PAUSE indexer report PERLANCAR/Data-Sah-Coerce-0.010.tar.gz
    From: PAUSE &lt;upload@pause.perl.org&gt;
    Date: Tue, 24 May 2016 06:55:47 +0000
    Message-Id: &lt;20160524065547.989BC153F@pause.perl.org&gt;

The only strange part is that Gmail sorts the 0.010 email after 0.011, which means it thinks the 0.010 email came after 0.011.

After the reindexing, Gmail sorts the 0.011 report email after 0.010. And this time 0.011 is indexed as the latest version.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;24&nbsp;05:17:30&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other Forward Transaction even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;May&nbsp;24&nbsp;05:18:02&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Forwarded Transaction #1629773 to andk@cpan.org</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
