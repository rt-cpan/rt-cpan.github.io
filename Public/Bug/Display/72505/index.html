<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #72505 for IO-Compress: Misuse of length&#40;@array&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #72505 for IO-Compress: Misuse of length&#40;@array&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/IO-Compress/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/IO-Compress/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/IO-Compress/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/IO-Compress/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Compress">IO-Compress CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">72505</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/IO-Compress/Active/">IO-Compress</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
&#39;spro^^*%*^6ut# [...] &#38;$%*c

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
perl5-porters [...] perl.org

<br />
wolfsage [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-226778-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-226779-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.042    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;17&nbsp;16:15:39&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> perl5-porters [...] perl.org, wolfsage [...] gmail.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Misuse of length&#40;@array&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">length&#40;@array&#41; puts @array in scalar context, so @array evaluates to the
length of the array, and then length&#40;&#41; takes the length of the resulting
number.

This is almost never correct, so Matthew Horsfall submitted a patch to
perl to add a warning
&#40;&lt;nntp://nntp.perl.org/CAJ0K8bgyMLK30p6cJTx8ESye-CrguigjwQf2WKES-DuwJYGbwA@mail.gmail.com&gt;&#41;.

This causes test failures, due to the length&#40;@$data&#41; in Extra.pm:

length&#40;&#41; used on @array &#40;did you mean &#34;scalar&#40;@array&#41;&#34;?&#41; at
../lib/IO/Compress/Zlib/Extra.pm line 198.

I’m pretty sure that line of code is wrong, but I haven’t looked at it
too closely.

Is there any chance you could make a new IO-Compress release with that
fixed, so we can integrate it into blead and apply Mr. Horsfall’s patch?

You can test it against a patched perl by checking out the
sprout/length-warning branch or by downloading a snapshot from
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/snapshot/7187e4df1c22bf5f70c9e024abbc3b67c1f2ad7e.tar.gz">http://perl5.git.perl.org/perl.git/snapshot/7187e4df1c22bf5f70c9e024abbc3b67c1f2ad7e.tar.gz</a></span>&gt;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;17&nbsp;18:43:03&nbsp;2011</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the bug report. As it happens the same issue was reported
last week in #72329. Amazing - this bug has probably been lurking for a
few years, then it gets reported twice in the space of a week.

Good idea having the new warning, by the way. I can&#39;t think of a valid
use of length&#40;@array&#41; off hand.

I&#39;ve checked my fix works with the new warnings patch. 

Just senting a refresh &#40;version 2.042&#41; of all the *::Compress::* modules
to CPAN now.

cheers
Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;17&nbsp;18:43:03&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;17&nbsp;19:07:25&nbsp;2011</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Nov 17 18:43:03 2011, PMQS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for the bug report. As it happens the same issue was reported
&gt; last week in #72329. Amazing - this bug has probably been lurking for a
&gt; few years, then it gets reported twice in the space of a week.
</div>
Actually, it’s not so amazing, as it was the same person who reported that bug and submitted 
the warning patch. :-&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Good idea having the new warning, by the way. I can&#39;t think of a valid
&gt; use of length&#40;@array&#41; off hand.
&gt; 
&gt; I&#39;ve checked my fix works with the new warnings patch. 
&gt; 
&gt; Just senting a refresh &#40;version 2.042&#41; of all the *::Compress::* modules
&gt; to CPAN now.
&gt; 
&gt; cheers
&gt; Paul
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;18&nbsp;05:59:22&nbsp;2011</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Nov 17 19:07:25 2011, SPROUT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Nov 17 18:43:03 2011, PMQS wrote:
<div class="message-stanza open">&gt; &gt; Thanks for the bug report. As it happens the same issue was reported
&gt; &gt; last week in #72329. Amazing - this bug has probably been lurking
</div>&gt; for a
<div class="message-stanza open">&gt; &gt; few years, then it gets reported twice in the space of a week.
</div>&gt; 
&gt; Actually, it’s not so amazing, as it was the same person who reported
&gt; that bug and submitted
&gt; the warning patch. :-&#41;
</div>
Duh! :-&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;18&nbsp;06:55:03&nbsp;2011</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;18&nbsp;06:55:04&nbsp;2011</span>
    <span class="description">pmqs [...] cpan.org -  Fixed in 2.042 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;18&nbsp;11:39:24&nbsp;2011</span>
    <span class="description">WolfSage [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oh, sorry about that.

I knew about the test failures and meant to ask for a new release so it
wouldn&#39;t cause problems for make test in blead once my patch was
incorporated but I sort of dropped the ball on that one.

Thanks FC for taking care of that, sorry to waste your time :&#41;

And thanks Paul for handling that so quick!

Cheers,

-- Matthew Horsfall &#40;alh&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;18&nbsp;11:39:26&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;18&nbsp;12:14:25&nbsp;2011</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Nov 18 11:39:24 2011, WOLFSAGE wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Oh, sorry about that.
</div>
No worries Matthew. The &#34;Duh&#34; was to myself for not noticing that the
two bug repors ogiginated from the same source.

Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;19&nbsp;06:33:10&nbsp;2011</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;25&nbsp;10:40:34&nbsp;2012</span>
    <span class="description">gisle [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> perl5-porters [...] perl.org, wolfsage [...] gmail.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72505] Misuse of length&#40;@array&#41; </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 25 Mar 2012 16:40:12 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Compress [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gisle Aas &lt;gisle [...] activestate.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 18. nov. 2011, at 00:43, Paul Marquess via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=72505">https://rt.cpan.org/Ticket/Display.html?id=72505</a></span> &gt;
&gt; 
&gt; Thanks for the bug report. As it happens the same issue was reported
&gt; last week in #72329. Amazing - this bug has probably been lurking for a
&gt; few years, then it gets reported twice in the space of a week.
&gt; 
&gt; Good idea having the new warning, by the way. I can&#39;t think of a valid
&gt; use of length&#40;@array&#41; off hand.
</div>
I upgraded to 5.16-tobe today and it started complaining about my code, saying:

   length&#40;&#41; used on @res &#40;did you mean &#34;scalar&#40;@res&#41;&#34;?&#41;

This was was perfectly fine code that I now had to change because of this warning.

The code looked like this:

            my $count_width = length&#40;@res&#41;;
            for &#40;@res&#41; {
                $count++;
                printf &#34;%*d: %s %s\n&#34;, $count_width, $count, $_-&gt;[0], $_-&gt;[1];
            }

As you can see there are certainly valid uses of length&#40;@array&#41;.  I would prefer for that warning to not be there.

--Gisle
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;25&nbsp;10:40:35&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;25&nbsp;12:35:07&nbsp;2012</span>
    <span class="description">ikegami [...] adaelis.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-IO-Compress [...] rt.cpan.org, perl5-porters [...] perl.org, wolfsage [...] gmail.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72505] Misuse of length&#40;@array&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 25 Mar 2012 12:34:55 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gisle Aas &lt;gisle [...] activestate.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, Mar 25, 2012 at 10:40 AM, Gisle Aas &lt;gisle@activestate.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This was was perfectly fine code that I now had to change because of this
&gt; warning.
&gt;
&gt; As you can see there are certainly valid uses of length&#40;@array&#41;.  I would
&gt; prefer for that warning to not be there.
&gt;
</div>
There are certainly valid uses of numification of non-numeric strings,
stringification of undef, deep recursion, ambiguous use of operators,  etc,
but those warn too. The criteria isn&#39;t whether it has valid uses or not,
it&#39;s a question of how many time it&#39;s used, and for what percentage of
those times it&#39;s used incorrectly.

- Eric
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;25&nbsp;15:31:29&nbsp;2012</span>
    <span class="description">gisle [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-IO-Compress [...] rt.cpan.org, perl5-porters [...] perl.org, wolfsage [...] gmail.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72505] Misuse of length&#40;@array&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 25 Mar 2012 21:31:11 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Brine &lt;ikegami [...] adaelis.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gisle Aas &lt;gisle [...] activestate.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 25. mars 2012, at 18:34, Eric Brine wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sun, Mar 25, 2012 at 10:40 AM, Gisle Aas &lt;gisle@activestate.com&gt; wrote:
&gt; This was was perfectly fine code that I now had to change because of this warning.
&gt;   
&gt; As you can see there are certainly valid uses of length&#40;@array&#41;.  I would prefer for that warning to not be there.
&gt; 
&gt; There are certainly valid uses of numification of non-numeric strings, stringification of undef, deep recursion, ambiguous use of operators,  etc, but those warn too. The criteria isn&#39;t whether it has valid uses or not, it&#39;s a question of how many time it&#39;s used, and for what percentage of those times it&#39;s used incorrectly.
</div>
It&#39;s not so problematic for me that there are warnings for run-time conditions that might indicate errors.  These are conditions that the programmer might not have expected and it&#39;s good to make her be explicit about it. But complaining about length&#40;@array&#41; is a pure static warning.  If we don&#39;t want people to be able to say that, why not just make it a syntax error then?  We can even introduce this using a feature to stay backwards compatible.

I don&#39;t think I ever seen a program that use length&#40;@array&#41; incorrectly. Are we for instance able to point to code on CPAN that use this construct incorrectly?

I&#39;m sure there have been novice Perl programmers that have attempted to write length&#40;@array&#41; when they shouldn&#39;t, but the error would be pretty obvious from the result you get.

--Gisle
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;25&nbsp;19:38:59&nbsp;2012</span>
    <span class="description">doy [...] tozt.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#39;spro^^*%*^6ut# [...] &#38;$%*c.cpan.rt.develooper.com, perl5-porters [...] perl.org, wolfsage [...] gmail.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72505] Misuse of length&#40;@array&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 25 Mar 2012 18:38:50 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Gisle Aas via RT &lt;bug-IO-Compress [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jesse Luehrs &lt;doy [...] tozt.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, Mar 25, 2012 at 03:31:30PM -0400, Gisle Aas via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=72505">https://rt.cpan.org/Ticket/Display.html?id=72505</a></span> &gt;
&gt; 
&gt; 
&gt; On 25. mars 2012, at 18:34, Eric Brine wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; On Sun, Mar 25, 2012 at 10:40 AM, Gisle Aas &lt;gisle@activestate.com&gt; wrote:
&gt; &gt; This was was perfectly fine code that I now had to change because of this warning.
&gt; &gt;   
&gt; &gt; As you can see there are certainly valid uses of length&#40;@array&#41;.  I would prefer for that warning to not be there.
&gt; &gt; 
&gt; &gt; There are certainly valid uses of numification of non-numeric
&gt; &gt; strings, stringification of undef, deep recursion, ambiguous use of
&gt; &gt; operators,  etc, but those warn too. The criteria isn&#39;t whether it
&gt; &gt; has valid uses or not, it&#39;s a question of how many time it&#39;s used,
&gt; &gt; and for what percentage of those times it&#39;s used incorrectly.
</div>&gt; 
&gt; It&#39;s not so problematic for me that there are warnings for run-time
&gt; conditions that might indicate errors.  These are conditions that the
&gt; programmer might not have expected and it&#39;s good to make her be
&gt; explicit about it. But complaining about length&#40;@array&#41; is a pure
&gt; static warning.  If we don&#39;t want people to be able to say that, why
&gt; not just make it a syntax error then?  We can even introduce this
&gt; using a feature to stay backwards compatible.
</div>
Making it a syntax error would not be in line with our deprecation
policy. Deprecating existing syntax requires a warning for at least one
full stable release cycle before we can actually make it an error.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I don&#39;t think I ever seen a program that use length&#40;@array&#41;
&gt; incorrectly. Are we for instance able to point to code on CPAN that
&gt; use this construct incorrectly?
</div>
I can see quite a few misuses of length&#40;@array&#41; in
<span class="clickylink"><a target="new" rel="nofollow" href="http://grep.cpan.me/?q=%5Cblength%5C%28%5C%40">http://grep.cpan.me/?q=%5Cblength%5C%28%5C%40</a></span>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m sure there have been novice Perl programmers that have attempted
&gt; to write length&#40;@array&#41; when they shouldn&#39;t, but the error would be
&gt; pretty obvious from the result you get.
</div>
Only if the code is on a common execution path which is actually tested
&#40;and if the test actually would be different - testing length&#40;@a&#41; == 1
would succeed in both interpretations, for instance&#41;.

-doy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;26&nbsp;17:32:45&nbsp;2012</span>
    <span class="description">gisle [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Gisle Aas via RT &lt;bug-IO-Compress [...] rt.cpan.org&gt;, perl5-porters [...] perl.org, wolfsage [...] gmail.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #72505] Misuse of length&#40;@array&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 Mar 2012 23:32:16 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Jesse Luehrs &lt;doy [...] tozt.net&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gisle Aas &lt;gisle [...] activestate.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 26. mars 2012, at 01:38, Jesse Luehrs wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; I don&#39;t think I ever seen a program that use length&#40;@array&#41;
&gt;&gt; incorrectly. Are we for instance able to point to code on CPAN that
&gt;&gt; use this construct incorrectly?
</div>&gt; 
&gt; I can see quite a few misuses of length&#40;@array&#41; in
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://grep.cpan.me/?q=%5Cblength%5C%28%5C%40">http://grep.cpan.me/?q=%5Cblength%5C%28%5C%40</a></span>
</div>
Indeed.  I withdraw my complaint and I have rewritten my code to use length&#40;scalar&#40;@array&#41;&#41;.

--Gisle
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;14&nbsp;14:53:47&nbsp;2012</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
