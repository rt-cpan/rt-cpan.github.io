<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #43384 for DBD-ODBC: Inserting more than 127 characters into MS Access Text or Memo field gives &#34;Invalid precision value&#34; error</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #43384 for DBD-ODBC: Inserting more than 127 characters into MS Access Text or Memo field gives &#34;Invalid precision value&#34; error</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-ODBC">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-ODBC">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-ODBC">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-ODBC">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-ODBC">DBD-ODBC CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">43384</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-ODBC">DBD-ODBC</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
oystein.torget [...] dnv.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-10188-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.17    </td>
  </tr>
  <tr id="CF-10189-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.18_4    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




dbdimp.c<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/576402/291195/dbdimp.c">
Wed Mar 11 12:19:12 2009 (176.9k) by bohica [...] ntlworld.com
</a>
</font></li>
</ul>


latin1_data.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/576330/291152/latin1_data.txt">
Wed Mar 11 11:02:25 2009 (910b) by oystein.torget [...] dnv.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/567579/286463/latin1_data.txt">
Wed Feb 18 03:43:49 2009 (572b) by oystein.torget [...] dnv.com
</a>
</font></li>
</ul>


test_unicode.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/576330/291155/test_unicode.pl">
Wed Mar 11 11:02:25 2009 (1.1k) by oystein.torget [...] dnv.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/567579/286466/test_unicode.pl">
Wed Feb 18 03:43:49 2009 (869b) by oystein.torget [...] dnv.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/567564/286449/test_unicode.pl">
Wed Feb 18 02:42:52 2009 (654b) by oystein.torget [...] dnv.com
</a>
</font></li>
</ul>


unicode_data.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/576330/291158/unicode_data.txt">
Wed Mar 11 11:02:25 2009 (1k) by oystein.torget [...] dnv.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/567564/286452/unicode_data.txt">
Wed Feb 18 02:42:52 2009 (557b) by oystein.torget [...] dnv.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=43384">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-567564" href="/Public/Bug/Display.html?id=43384#txn-567564">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;18&nbsp;02:42:52&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Inserting more than 127 utf8 characters into MS Access Text or
 Memo field gives &#34;Invalid precision value&#34; error</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/567564/286446/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/286446">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 706b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">When trying to insert more than 127 Unicode characters encoded as utf8 
into a Text or Memo field the following error message is shown:

DBD::ODBC::st execute failed: [Microsoft][ODBC Microsoft Access 
Driver]Invalid precision value  &#40;SQL-HY104&#41;

Inserting 127 characters or less into the field works without any 
problems.

This problem was encountered on .mbd files in MS Access 2000 and 2003 
format.

I have attached a test script and some test data that reproduce the 
error. The test script assumes that the database contains a table 
UNICODE with the fields UNICODE_VARCHAR and UNICODE_TEXT. 
UNICODE_VARCHAR should be a Text field with a size larger than 127. 
UNICODE_TEXT should be a Memo field.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test_unicode.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/567564/286449/test_unicode.pl">Download test_unicode.pl</a><br />
<span class="downloadcontenttype">text/x-perl 654b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!perl

use strict;
use warnings;

use DBI;

my $access_dns = &#34;driver={Microsoft Access Driver &#40;*.mdb&#41;};dbq=unicode.mdb&#34;;
my $dbh = DBI-&gt;connect&#40; &#34;DBI:ODBC:$access_dns&#34; &#41; or die DBI-&gt;errstr&#40;&#41;;
                      
my $insert_sql = &#39;INSERT INTO UNICODE &#40; UNICODE_VARCHAR, UNICODE_TEXT &#41; VALUES &#40; ?, ? &#41;&#39;;
my $insert_stmt = $dbh-&gt;prepare&#40; $insert_sql &#41; or die $dbh-&gt;errstr&#40;&#41;;

open my $UNICODE_DATA, &#39;&lt;:utf8&#39;, &#39;unicode_data.txt&#39; or die $!;
while&#40; my $line = &lt;$UNICODE_DATA&gt; &#41;{
    chomp&#40; $line &#41;;
    my @values = split &#39;,&#39;, $line;
    $insert_stmt-&gt;execute&#40; @values &#41; or warn $dbh-&gt;errstr&#40;&#41;;
}                                      

</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> unicode_data.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/567564/286452/unicode_data.txt">Download unicode_data.txt</a><br />
<span class="downloadcontenttype">text/plain 557b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ã¸,Ã¸
Ã¸Ã¸Ã¸Ã¸Ã¸,Ã¸Ã¸Ã¸Ã¸Ã¸
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567,1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678,fails
fails,12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-567570" href="/Public/Bug/Display.html?id=43384#txn-567570">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;18&nbsp;03:34:43&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Subject changed from &#39;Inserting more than 127 utf8 characters into MS Access Text or Memo field gives &#34;Invalid precision value&#34; error&#39; to &#39;Inserting more than 127 characters into MS Access Text or Memo field gives &#34;Invalid precision value&#34; error&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-567571" href="/Public/Bug/Display.html?id=43384#txn-567571">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;18&nbsp;03:35:58&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-567579" href="/Public/Bug/Display.html?id=43384#txn-567579">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;18&nbsp;03:43:49&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/567579/286460/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/286460">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 604b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">After some more testing I have found that it does not seem to be 
relevant that the characters are encoded as utf8. Inserting more than 
127 characters gives the same error for characters encoded as latin1.

Inserting more than 127 characters have not been a problem with earlier 
versions of the DBD::ODBC driver. I have tested it against version 1.10 
and with that version inserting more than 127 characters in latin1 
encoding seems to work fine.

I have attached an additional file of test data and a updated test 
script that reads both data files an attempts to insert the data into 
the database.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/567579/286463/latin1_data.txt">Download latin1_data.txt</a><br />
<span class="downloadcontenttype">text/plain 572b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">latin1,latin1
Ã¸,Ã¸
Ã¸Ã¸Ã¸Ã¸Ã¸,Ã¸Ã¸Ã¸Ã¸Ã¸
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567,1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678,fails
fails,12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/567579/286466/test_unicode.pl">Download test_unicode.pl</a><br />
<span class="downloadcontenttype">text/x-perl 869b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!perl

use strict;
use warnings;

use DBI;

my $access_dns = &#34;driver={Microsoft Access Driver &#40;*.mdb&#41;};dbq=unicode.mdb&#34;;
my $dbh = DBI-&gt;connect&#40; &#34;DBI:ODBC:$access_dns&#34; &#41; or die DBI-&gt;errstr&#40;&#41;;
                      
my $insert_sql = &#39;INSERT INTO UNICODE &#40; UNICODE_VARCHAR, UNICODE_TEXT &#41; VALUES &#40; ?, ? &#41;&#39;;
my $insert_stmt = $dbh-&gt;prepare&#40; $insert_sql &#41; or die $dbh-&gt;errstr&#40;&#41;;

open my $UNICODE_DATA, &#39;&lt;:utf8&#39;, &#39;unicode_data.txt&#39; or die $!;
while&#40; my $line = &lt;$UNICODE_DATA&gt; &#41;{
    chomp&#40; $line &#41;;
    my @values = split &#39;,&#39;, $line;
    $insert_stmt-&gt;execute&#40; @values &#41; or warn $dbh-&gt;errstr&#40;&#41;;
}                                      

open my $LATIN_DATA, &#39;&lt;&#39;, &#39;latin1_data.txt&#39; or die $!;
while&#40; my $line = &lt;$LATIN_DATA&gt; &#41;{
    chomp&#40; $line &#41;;
    my @values = split &#39;,&#39;, $line;
    $insert_stmt-&gt;execute&#40; @values &#41; or warn $dbh-&gt;errstr&#40;&#41;;
}   </div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-567580" href="/Public/Bug/Display.html?id=43384#txn-567580">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;18&nbsp;03:44:17&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Status changed from &#39;open&#39; to &#39;new&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-570353" href="/Public/Bug/Display.html?id=43384#txn-570353">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;26&nbsp;09:25:43&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/570353/287655/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/287655">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 373b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Apologies for not replying to your bug report sooner. I normally get
emails from the rt system when a bug is posted or changed but I have
received none recently and did not notice this until I spotted the
following thread on perl monks:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=746522">http://www.perlmonks.org/?node_id=746522</a></span>

I will try and look in to this in the next few days.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-570354" href="/Public/Bug/Display.html?id=43384#txn-570354">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;26&nbsp;09:25:44&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-573932" href="/Public/Bug/Display.html?id=43384#txn-573932">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;06&nbsp;11:26:57&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/573932/289761/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/289761">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">DBD::ODBC has changed massively since 1.10. Provisional unicode support 
on Windows was added in 1.14 and full unicode support for all platforms 
was finished in 1.16_2.

The default on Windows is now to build with unicode support &#40;see -u 
and -nou when building&#41;. This means that DBD::ODBC will default to 
using SQLW functions like SQLDriverConnectW so you can use unicode 
connection strings and settings and SQL_WVARCHAR for data where it can. 

You can put DBD::ODBC back to the old behavior with 
odbc_default_bind_type, setting it to SQL_VARCHAR or you can rebuild 
without the ne unicode support.

When you are binding data to an insert usually DBD::ODBC calls 
SQLDescribeParam to find out about the bound type but the MSAccess ODBC 
driver does not support that ODBC API. In the absence of this API and 
not being able to know the data you are binding DBD::ODBC defaults in 
the case of a unicode build to using SQL_WVARCHAR. This means your 
bound data is converted to wide characters - it does not matter if 
there is only ascii characters in the data - it is still converted to 
wide characters &#40;of course this does mean if you have some unicode chrs 
in your perl data encoded in utf-8 they get in the database properly 
now&#41;.

However, I have discovered a problem with MS Access and inserting wide 
chrs into text columns &#40;bare in mind with the unicode support even 
ascii is converted to wide chrs&#41; where it seems to need the number of 
wide chrs instead of the number of bytes for the SQLBindParameter 
ColDisplaySize field. I have changed this and can make a new DBD::ODBC 
available to you if you can build it.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576243" href="/Public/Bug/Display.html?id=43384#txn-576243">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;06:36:51&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576243/291096/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291096">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 327b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have no previous experience with building the DBD::ODBC driver from 
scratch, but if you make your changes available I will try to build it 
and see if the changes you have made fixes the problems with Unicode on 
MS Access.

I tested setting odbc_default_bind_type to 12 and that also fixed the 
problem as you suggested.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576256" href="/Public/Bug/Display.html?id=43384#txn-576256">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;07:04:44&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576256/291101/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291101">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 11 06:36:51 2009, oyse wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have no previous experience with building the DBD::ODBC driver from 
&gt; scratch, but if you make your changes available I will try to build it 
&gt; and see if the changes you have made fixes the problems with Unicode on 
&gt; MS Access.
&gt; 
&gt; I tested setting odbc_default_bind_type to 12 and that also fixed the 
&gt; problem as you suggested.
</div>
It is available from cpan at <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/DBD-ODBC/">http://search.cpan.org/dist/DBD-ODBC/</a></span>.
Select the download button next to 1.18_2.

How you build it slightly depends on what perl distribution you have on
Windows e.g., strawberry perl, active state etc. A reasonable start is
to unpack it and try running perl Makefile.PL to see how you go. If you
are using activestate perl you will need a MS C compiler and nmake on
your path or you will need to install MinGW. If you are using strawberry
perl it comes with a compiler and you can just do:

perl -MCPAN -e shell
install M/MJ/MJEVANS/DBD-ODBC-1.18_2.tar.gz

I can try and help once I know what perl you are running and what
facilities you have.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576330" href="/Public/Bug/Display.html?id=43384#txn-576330">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;11:02:25&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/576330/291149/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291149">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Ons. 11. Mar. 2009 07:04:44, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Mar 11 06:36:51 2009, oyse wrote:
<div class="message-stanza open">&gt; &gt; I have no previous experience with building the DBD::ODBC driver 
</div></div>from 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; scratch, but if you make your changes available I will try to build 
</div></div>it 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; and see if the changes you have made fixes the problems with 
</div></div>Unicode on 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; MS Access.
&gt; &gt; 
&gt; &gt; I tested setting odbc_default_bind_type to 12 and that also fixed 
</div></div>the 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; problem as you suggested.
</div>&gt; 
&gt; It is available from cpan at <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/DBD-ODBC/">http://search.cpan.org/dist/DBD-ODBC/</a></span>.
&gt; Select the download button next to 1.18_2.
&gt; 
&gt; How you build it slightly depends on what perl distribution you have 
</div>on
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Windows e.g., strawberry perl, active state etc. A reasonable start is
&gt; to unpack it and try running perl Makefile.PL to see how you go. If 
</div>you
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; are using activestate perl you will need a MS C compiler and nmake on
&gt; your path or you will need to install MinGW. If you are using 
</div>strawberry
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl it comes with a compiler and you can just do:
&gt; 
&gt; perl -MCPAN -e shell
&gt; install M/MJ/MJEVANS/DBD-ODBC-1.18_2.tar.gz
&gt; 
&gt; I can try and help once I know what perl you are running and what
&gt; facilities you have.
&gt; 
&gt; Martin
</div>
I have both ActiveState and Strawberry Perl installed. I have trouble 
building with ActiveState. The code compiles just fine, but there is a 
problem with the dll file msvcr80.dll when I try to run the tests. The 
error messages is &#34;This application has failed to start because 
MSVCR80.dll was not found. Re-installing the application may fix the 
problem.&#34; I think the problem has something to do with versions of this 
dll, but I haven&#39;t been able to track down the problem.

I have managed to build the latest version under Strawberry Perl and I 
have been running some tests and your changes seems to fix the problem 
in most cases. That is inserting both Unicode and Latin1 text works 
fine with both Text and Memo for more than 127 characters.

There seems to be a slight problem when inserting more than 127 Latin1 
characters into a column with bind type SQL_VARCHAR. The insert works 
fine, but you get an error message that says &#34;Invalid precision value&#34;.

I have attached my updated test files. The test script now assumes that 
the size of the Text field is 150.

Thanks for all the help so far.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/576330/291152/latin1_data.txt">Download latin1_data.txt</a><br />
<span class="downloadcontenttype">text/plain 910b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">latin1,latin1
Ã¸,Ã¸
Ã¸Ã¸Ã¸Ã¸Ã¸,Ã¸Ã¸Ã¸Ã¸Ã¸
1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567,1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678,gives binding error insert ok
ok,12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678
ok,Ã¸Ã¸Ã¸Ã¸Ã¸12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345671234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567012345678901234567890123456789012345678901234567</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/576330/291155/test_unicode.pl">Download test_unicode.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!perl

use strict;
use warnings;

use DBI qw&#40;:sql_types&#41;;;

my $access_dns = &#34;driver={Microsoft Access Driver &#40;*.mdb&#41;};dbq=unicode.mdb&#34;;
my $dbh = DBI-&gt;connect&#40; &#34;DBI:ODBC:$access_dns&#34; &#41; or die DBI-&gt;errstr&#40;&#41;;
                      
my $insert_sql = &#39;INSERT INTO UNICODE &#40; UNICODE_VARCHAR, UNICODE_TEXT &#41; VALUES &#40; ?, ? &#41;&#39;;
my $insert_stmt = $dbh-&gt;prepare&#40; $insert_sql &#41; or die $dbh-&gt;errstr&#40;&#41;;

open my $UNICODE_DATA, &#39;&lt;:utf8&#39;, &#39;unicode_data.txt&#39; or die $!;
while&#40; my $line = &lt;$UNICODE_DATA&gt; &#41;{
    chomp&#40; $line &#41;;
    my @values = split &#39;,&#39;, $line;
    $insert_stmt-&gt;bind_param&#40; 1, $values[0] &#41;;
    $insert_stmt-&gt;bind_param&#40; 2, $values[1], { TYPE =&gt; SQL_WLONGVARCHAR } &#41;;    
    $insert_stmt-&gt;execute&#40;&#41; or warn $dbh-&gt;errstr&#40;&#41;;
}                                      

open my $LATIN_DATA, &#39;&lt;&#39;, &#39;latin1_data.txt&#39; or die $!;
while&#40; my $line = &lt;$LATIN_DATA&gt; &#41;{
    chomp&#40; $line &#41;;
    my @values = split &#39;,&#39;, $line;
    $insert_stmt-&gt;bind_param&#40; 1, $values[0], { TYPE =&gt; SQL_VARCHAR } &#41;;
    $insert_stmt-&gt;bind_param&#40; 2, $values[1], { TYPE =&gt; SQL_LONGVARCHAR } &#41;;       
    $insert_stmt-&gt;execute&#40;&#41; or warn $dbh-&gt;errstr&#40;&#41;;
}   </div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/576330/291158/unicode_data.txt">Download unicode_data.txt</a><br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">unicode,unicode
Ã¸,Ã¸
Ã¸Ã¸Ã¸Ã¸Ã¸,Ã¸Ã¸Ã¸Ã¸Ã¸
ok 1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567,1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567
12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678,ok
ok,12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678
ok Ã¸Ã¸Ã¸34567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567,ok Ã¸Ã¦Ã¥Ã¸Ã¦Ã¸Ã¥Ã¸Ã¦Ã¸Ã¦12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345671234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567012345678901234567890123456789012345678901234567</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576352" href="/Public/Bug/Display.html?id=43384#txn-576352">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;11:12:43&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576352/291168/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291168">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 11 11:02:25 2009, oyse wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have both ActiveState and Strawberry Perl installed. I have trouble 
&gt; building with ActiveState. The code compiles just fine, but there is a 
&gt; problem with the dll file msvcr80.dll when I try to run the tests. The 
&gt; error messages is &#34;This application has failed to start because 
&gt; MSVCR80.dll was not found. Re-installing the application may fix the 
&gt; problem.&#34; I think the problem has something to do with versions of this 
&gt; dll, but I haven&#39;t been able to track down the problem.
</div>
That does not surprise me. You need to have a pretty specific set of
compilers to build it yourself for activestate. If you send your email
address to mjevans@cpan.org I can forward some stuff to you I got from
activestate.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have managed to build the latest version under Strawberry Perl and I 
&gt; have been running some tests and your changes seems to fix the problem 
&gt; in most cases.
</div>
Yes, strawberry perl seems alot easier for building modules.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; That is inserting both Unicode and Latin1 text works 
&gt; fine with both Text and Memo for more than 127 characters.
&gt; 
&gt; There seems to be a slight problem when inserting more than 127 Latin1 
&gt; characters into a column with bind type SQL_VARCHAR. The insert works 
&gt; fine, but you get an error message that says &#34;Invalid precision value&#34;.
&gt; 
&gt; I have attached my updated test files. The test script now assumes that 
&gt; the size of the Text field is 150.
&gt; 
&gt; Thanks for all the help so far.
</div>
Can I just confirm the schema for your table that you are using now.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576364" href="/Public/Bug/Display.html?id=43384#txn-576364">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;11:30:28&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576364/291174/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291174">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 563b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Ons. 11. Mar. 2009 11:12:43, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; That does not surprise me. You need to have a pretty specific set of
&gt; compilers to build it yourself for activestate. If you send your email
&gt; address to mjevans@cpan.org I can forward some stuff to you I got from
&gt; activestate.
</div>
I have sent you an email to the above address.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can I just confirm the schema for your table that you are using now.
</div>
The test file assumes that you have a table named UNICODE with the 
following columns: 
ID AUTOINCREMENT PRIMARY KEY
UNICODE_VARCHAR VARCHAR&#40;150&#41;
UNICODE_TEXT MEMO
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576377" href="/Public/Bug/Display.html?id=43384#txn-576377">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;11:44:40&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576377/291180/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291180">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 302b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 11 11:30:28 2009, oyse wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The test file assumes that you have a table named UNICODE with the 
&gt; following columns: 
&gt; ID AUTOINCREMENT PRIMARY KEY
&gt; UNICODE_VARCHAR VARCHAR&#40;150&#41;
&gt; UNICODE_TEXT MEMO
</div>
Thanks, I&#39;ll try and look into this tonight.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576402" href="/Public/Bug/Display.html?id=43384#txn-576402">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;12:19:12&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/576402/291192/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291192">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 424b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 11 11:44:40 2009, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Mar 11 11:30:28 2009, oyse wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; The test file assumes that you have a table named UNICODE with the 
&gt; &gt; following columns: 
&gt; &gt; ID AUTOINCREMENT PRIMARY KEY
&gt; &gt; UNICODE_VARCHAR VARCHAR&#40;150&#41;
&gt; &gt; UNICODE_TEXT MEMO
</div>&gt; 
&gt; Thanks, I&#39;ll try and look into this tonight.
&gt; 
&gt; Martin
</div>
Try the dbdimp.c I&#39;ve added to this rt report.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/576402/291195/dbdimp.c">Download dbdimp.c</a><br />
<span class="downloadcontenttype">text/x-csrc 176.9k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576428" href="/Public/Bug/Display.html?id=43384#txn-576428">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;15:01:05&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576428/291213/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291213">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 582b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Ons. 11. Mar. 2009 12:19:12, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Try the dbdimp.c I&#39;ve added to this rt report.
&gt; 
&gt; Martin
</div>
Seems like that fixed the problem. I compiled the driver with the new 
file and ran the tests and the &#34;Invalid precision error&#34; disappeared.

I also added a test cases with inserting exactly as many characters as 
the Text column allowed and that also worked without any problems.

Inserting more than the maximum allowed characters &#40;in this case 151&#41; 
also worked fine, but truncated the value silently. Is this the 
intended behaviour or perhaps an MS Access feature?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576651" href="/Public/Bug/Display.html?id=43384#txn-576651">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;12&nbsp;04:50:18&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576651/291326/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291326">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 11 15:01:05 2009, oyse wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Ons. 11. Mar. 2009 12:19:12, MJEVANS wrote:
<div class="message-stanza open">&gt; &gt; Try the dbdimp.c I&#39;ve added to this rt report.
&gt; &gt; 
&gt; &gt; Martin
</div>&gt; 
&gt; Seems like that fixed the problem. I compiled the driver with the new 
&gt; file and ran the tests and the &#34;Invalid precision error&#34; disappeared.
&gt; 
&gt; I also added a test cases with inserting exactly as many characters as 
&gt; the Text column allowed and that also worked without any problems.
&gt; 
&gt; Inserting more than the maximum allowed characters &#40;in this case 151&#41; 
&gt; also worked fine, but truncated the value silently. Is this the 
&gt; intended behaviour or perhaps an MS Access feature?
&gt; 
</div>
I guess that is a feature of access as most drivers will return a data
truncated error. I will try and confirm that properly but I&#39;m sure
DBD::ODBC is not truncated it.

Thanks for working through this with me and testing the changes.

Are you happy for me to write this bug off as fixed now?

The official changes and a test case for access will be in 1.18_3 which
I will release either today but if the other person who reported the SQL
Server issue comes back to me before then it may be later.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-576712" href="/Public/Bug/Display.html?id=43384#txn-576712">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;12&nbsp;07:16:52&nbsp;2009</span>
    <span class="description">oystein.torget [...] dnv.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/576712/291360/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/291360">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 321b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tor. 12. Mar. 2009 04:50:18, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Are you happy for me to write this bug off as fixed now?
</div>
Yes. I have performed some more tests on the updated driver which also 
confirm that the driver behaviour is now as intended.

Thanks again for your excellent help and quick respons.

Best Regards
Ã˜ystein Torget
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-577474" href="/Public/Bug/Display.html?id=43384#txn-577474">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;14&nbsp;10:55:05&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-577476" href="/Public/Bug/Display.html?id=43384#txn-577476">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;14&nbsp;10:55:05&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Severity Normal added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-577477" href="/Public/Bug/Display.html?id=43384#txn-577477">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;14&nbsp;10:55:05&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Fixed in 1.18_4 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.337324</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
