<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #13169 for Module-Build: M::B can&#39;t be upgraded using it&#39;s own API</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #13169 for Module-Build: M::B can&#39;t be upgraded using it&#39;s own API</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Module-Build/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Module-Build/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Module-Build/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Module-Build/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Module-Build">Module-Build CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">13169</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Module-Build/Active/">Module-Build</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-21558-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
0.01</li>
<li>
0.02</li>
<li>
0.03</li>
<li>
0.03_1</li>
<li>
0.04</li>
<li>
0.04_01</li>
<li>
0.05</li>
<li>
0.05_01</li>
<li>
0.06</li>
<li>
0.07</li>
<li>
0.08</li>
<li>
0.09</li>
<li>
0.10</li>
<li>
0.11</li>
<li>
0.12</li>
<li>
0.13</li>
<li>
0.14</li>
<li>
0.15</li>
<li>
0.16</li>
<li>
0.17</li>
<li>
0.18</li>
<li>
0.18_01</li>
<li>
0.18_02</li>
<li>
0.18_03</li>
<li>
0.18_04</li>
<li>
0.19</li>
<li>
0.19_02</li>
<li>
0.19_03</li>
<li>
0.19_04</li>
<li>
0.19_05</li>
<li>
0.20</li>
<li>
0.20_01</li>
<li>
0.20_02</li>
<li>
0.21</li>
<li>
0.21_01</li>
<li>
0.21_02</li>
<li>
0.22</li>
<li>
0.23</li>
<li>
0.24</li>
<li>
0.24_01</li>
<li>
0.25</li>
<li>
0.25_01</li>
<li>
0.25_02</li>
<li>
0.25_03</li>
<li>
0.26</li>
<li>
0.2601</li>
<li>
0.2602</li>
<li>
0.2603</li>
<li>
0.2604</li>
<li>
0.2605</li>
<li>
0.2606</li>
<li>
0.2607</li>
<li>
0.2608</li>
<li>
0.2609</li>
<li>
0.2610</li>
<li>
0.27_01</li>
</ul>
    </td>
  </tr>
  <tr id="CF-21559-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;09&nbsp;09:41:44&nbsp;2005</span>
    <span class="description">kane [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> M::B can&#39;t be upgraded using it&#39;s own API</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Currently it is impossible to upgrade Module::Build using it&#39;s own API.

Assume you have Module::Build installed and you&#39;d like to upgrade it, with a
script like this:

    [kane@coke ~...build/Module-Build-0.2610]$ cat x.pl 
    use lib &#39;/Users/kane/.cpanplus/5.8.3/build/Module-Build-0.2608/lib&#39;;
    
    use Module::Build;
    
    print &#34;Version: $Module::Build::VERSION\n&#34;;
    
    $mb = Module::Build-&gt;new_from_context;
    
If you execute this script, you&#39;ll get the following errors:    
    
    [kane@coke ~...build/Module-Build-0.2610]$ perlc x.pl 
    Version: 0.2608
    /opt/bin/perl -I/Users/kane/.cpanplus/5.8.3/build/Module-Build-0.2608/lib Build.PL
    Checking whether your kit is complete...
    Looks good
     * Optional prerequisite ExtUtils::ParseXS isn&#39;t installed
     * Optional prerequisite ExtUtils::CBuilder isn&#39;t installed
    ERRORS/WARNINGS FOUND IN PREREQUISITES.  You may wish to install the versions
     of the modules indicated above before proceeding with this installation.
    
    Feature &#39;YAML_support&#39; enabled.
    
    Deleting Build
    Removed previous script &#39;Build&#39;
    Creating new &#39;Build&#39; script for &#39;Module-Build&#39; version &#39;0.2610&#39;
     * ERROR: Configuration was initially created with Module::Build version &#39;0.261&#39;,
       but we are now using version &#39;0.2608&#39;.  Please re-run the Build.PL or Makefile.PL script.
       
This is due to the fact that the Build file insists on adding the following lines, which
force the loading of the NOT YET INSTALLED module::build when it shells out to run
it&#39;s own build procedure:
       
    unless &#40;$is_same_dir&#41; {
        die &#40;&#39;This script must be run from /Users/kane/.cpanplus/5.8.3/build/Module-Build-0.2610, not &#39;.$curdir.&#34;\n&#34;.
             &#34;Please re-run the Build.PL script here.\n&#34;&#41;;
      }
      unshift @INC,
        &#40;
         &#39;/Users/kane/.cpanplus/5.8.3/build/Module-Build-0.2610/lib&#39;,
         &#39;/Users/kane/.cpanplus/5.8.3/build/Module-Build-0.2608/lib&#39;
        &#41;;
    }

And since it&#39;s in the &#39;new_from_context&#39; method, it&#39;s impossible to interfere from the calling
code to prevent this from happening.

In praxis this mean no CPANPLUS user can upgrade Module::Bulid.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;27&nbsp;08:59:12&nbsp;2005</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> shlomif [...] iglu.org.il</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[KANE - Thu Jun  9 09:41:44 2005]: 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Currently it is impossible to upgrade Module::Build using it&#39;s own 
&gt;    API. 
&gt;  
&gt; Assume you have Module::Build installed and you&#39;d like to upgrade 
</div>it, 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    with a 
&gt; script like this: 
&gt;  
&gt;     [kane@coke ~...build/Module-Build-0.2610]$ cat x.pl 
&gt;     use lib &#39;/Users/kane/.cpanplus/5.8.3/build/Module-Build- 
&gt;    0.2608/lib&#39;; 
&gt;  
&gt;     use Module::Build; 
&gt;  
&gt;     print &#34;Version: $Module::Build::VERSION\n&#34;; 
&gt;  
&gt;     $mb = Module::Build-&gt;new_from_context; 
&gt;  
&gt; If you execute this script, you&#39;ll get the following errors: 
</div> 
Actually, this script would run fine. What wouldn&#39;t is the following 
script: 
 
&lt;&lt;&lt; 
use Module::Build; 
 
print &#34;Version: $Module::Build::VERSION\n&#34;; 
 
$mb = Module::Build-&gt;new_from_context; 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;&gt;&gt; 
</div> 
This is what CPANPLUS.pm does. 
 
Regards, 
 
       Shlomi Fish 
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;30&nbsp;11:05:12&nbsp;2005</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I believe Jos&#39;s original message was correct - note the two different versions referenced.  The 
same thing would happen in your situation if you had a different version of M::B installed 
than you&#39;re currently installing.

 -Ken
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;30&nbsp;11:05:13&nbsp;2005</span>
    <span class="description">kwilliams [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;05&nbsp;13:55:14&nbsp;2005</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve addressed this in CVS today.  The idea is that we use the already-installed M::B for both 
the &#34;perl Build.PL&#34; stage and the subsequent build stages.  Previously it would find the to-be-
installed M::B for &#34;perl Build.PL&#34;, and then use the already-installed M::B thereafter.

I say &#34;addressed&#34; rather than &#34;fixed&#34; because I&#39;m still not completely happy with the solution.  
There are two problems with it: 1&#41; the bug needs to be fixed in the version already *installed* 
in the user&#39;s system, which means they&#39;ll still need to do one more manual install before 
things will start working from then on, and 2&#41; it will make M::B install itself using an older M::
B, but some of the tests may count on using the to-be-installed version.  2&#41; shouldn&#39;t be as 
bad as it used to be, actually - we&#39;ve been cleaning some of that stuff up.

It might be nice to be able to use the new to-be-installed version of M::B for all the 
installation stages rather than the already-installed one, but that has problems too: 1&#41; I can&#39;t 
figure out how to do it, and 2&#41; even if I could, it might be a nasty trick to play on the caller 
&#40;e.g. CPANPLUS&#41; who thinks they&#39;re using the API of the older M::B.

 -Ken
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;05&nbsp;13:55:15&nbsp;2005</span>
    <span class="description">kwilliams [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
