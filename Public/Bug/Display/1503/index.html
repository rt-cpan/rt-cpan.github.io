<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #1503 for EasyTCP: EasyTCP Encryption</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #1503 for EasyTCP: EasyTCP Encryption</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/EasyTCP/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/EasyTCP/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/EasyTCP/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/EasyTCP/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/EasyTCP">EasyTCP CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">1503</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/EasyTCP/Active/">EasyTCP</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
bobmathews [...] alumni.calpoly.edu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-11838-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-11839-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;08&nbsp;17:07:42&nbsp;2002</span>
    <span class="description">BOBMATH [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> EasyTCP Encryption</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I took a look at EasyTCP, and noticed 4 serious security flaws in its encryption implementation. I&#39;m not an expert on crypto, but I do know that each of these alone is deadly.

1&#41; If Crypt::RSA is not used, symmetric encryption keys are sent across the network in the clear. Anyone who can see the data can also decrypt it, so encryption is worthless in this case.

2&#41; An active attacker &#40;one who can modify packets on the network&#41; can undetectably prevent Crypt::RSA from being used. He simply needs to remove Crypt::RSA from the list of supported encryption modules.

3&#41; A man-in-the-middle attacker can defeat the Crypt::RSA mode by replacing the RSA keys with his own. Here are a couple of tools that automate such an attack against other protocols:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://monkey.org/~dugsong/dsniff/">http://monkey.org/~dugsong/dsniff/</a></span>
  <span class="clickylink"><a target="new" rel="nofollow" href="http://ettercap.sourceforge.net/">http://ettercap.sourceforge.net/</a></span>

Why don&#39;t you use SSL? It has already fixed the problems listed above.

4&#41; Perl&#39;s built-in &#40;insecure&#41; rand&#40;&#41; function is used to generate cryptographic keys. An attacker could connect to the server, discover its internal random number generator state from the session key the server sends back, and use that information to guess the encryption key used with other clients.
  <span class="clickylink"><a target="new" rel="nofollow" href="http://perlmonks.org/index.pl?node_id=151595">http://perlmonks.org/index.pl?node_id=151595</a></span>
</div></div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;08&nbsp;23:27:59&nbsp;2002</span>
    <span class="description">mina.cpan [...] naguib.ca -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Hello Bob

Thanks for your email.  I will address these issues one by one below.

[BOBMATH - Sun Sep  8 17:07:42 2002]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 1&#41; If Crypt::RSA is not used, symmetric encryption keys are sent
&gt;    across the network in the clear. Anyone who can see the data can
&gt;    also decrypt it, so encryption is worthless in this case.
</div>
This is a &#34;chicken before the egg&#34; logical loop. You can&#39;t transmit it
encrypted unless you&#39;ve negotiated an encryption scheme.  This applies
for data as well as the encryption scheme itself in case of symmetric
encryption.  I believe that any encryption is better than no-encryption
at all.

However, having that said, I do not consider any of the symmetric
encryption options quite serious and it states so in the documents, that
for serious security Crypt::RSA should be used.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2&#41; An active attacker &#40;one who can modify packets on the network&#41; can
&gt;    undetectably prevent Crypt::RSA from being used. He simply needs to
&gt;    remove Crypt::RSA from the list of supported encryption modules.
</div>
That is correct.  How do you propose they exchange the &#34;encryption
module availability&#34; list while avoiding the above ?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 3&#41; A man-in-the-middle attacker can defeat the Crypt::RSA mode by
&gt;    replacing the RSA keys with his own. Here are a couple of tools
&gt;    that automate such an attack against other protocols:
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://monkey.org/~dugsong/dsniff/">http://monkey.org/~dugsong/dsniff/</a></span>
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://ettercap.sourceforge.net/">http://ettercap.sourceforge.net/</a></span>
&gt; 
&gt; Why don&#39;t you use SSL? It has already fixed the problems listed above.
</div>
I will look into using the perl SSL module, however it will get quite
tricky if one supports SSL and the other doesn&#39;t.  I don&#39;t want the
module to be hard especially for beginners, I&#39;m also concerned about the
&#34;internal protocol&#34; that EasyTCP offers, and how it could be tunneled
through the SSL socket, or tunnel it through a normal socket if SSL was
not available, and how to detect a listening server is running SSL or
not etc...  I&#39;ll give it some serious thought while your suggestions are
also quite welcome.

Alternatively, I can look into 1. How the SSL protocol circumvents the
above problem or 2: Use signed packets to verify the integrity, however
I will need to study all of the above first for holes.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 4&#41; Perl&#39;s built-in &#40;insecure&#41; rand&#40;&#41; function is used to generate
&gt;    cryptographic keys. An attacker could connect to the server,
&gt;    discover its internal random number generator state from the
&gt;    session key the server sends back, and use that information to
&gt;    guess the encryption key used with other clients.
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://perlmonks.org/index.pl?node_id=151595">http://perlmonks.org/index.pl?node_id=151595</a></span>
</div>
I will fix that by implementing Vipul&#39;s Crypt::Random::Provider::rand
module for as-secure random numbers as possible &#40;AFAIK&#41; without
requiring NET::EasyTCP to use external crypto providers and needing to
be compiled.

Again, thanks for your email.  Let me know what you think of the points
I&#39;ve made.  As with all software I write, I&#39;m always open to suggestions
and don&#39;t shy from change.
</div></div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;10&nbsp;12:40:01&nbsp;2002</span>
    <span class="description">BOBMATH [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[MNAGUIB - Sun Sep  8 23:27:59 2002]: 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [Encryption keys in the clear] 
&gt; This is a &#34;chicken before the egg&#34; logical loop. You can&#39;t transmit 
&gt; it encrypted unless you&#39;ve negotiated an encryption scheme. 
</div> 
Precisely. Either you arrange for the client and server to have a 
shared secret &#40;password&#41; beforehand, or you exchange it with public key 
techniques &#40;typically RSA or DH&#41;. 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I believe that any encryption is better than no-encryption at all. 
</div> 
I suppose it could be a little better than nothing. It might keep your 
little brother from listening in on you with a standard packet sniffer 
when he&#39;s bored, even if it won&#39;t stop a determined attacker. On the 
other fork of the tongue, it&#39;s dangerous to give people a false sense 
of security. 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, having that said, I do not consider any of the symmetric 
&gt; encryption options quite serious and it states so in the documents, 
&gt; that for serious security Crypt::RSA should be used. 
</div> 
That&#39;s fine, as long as the user of the module knows what he&#39;s getting. 
I just reread the module documentation, though, and I didn&#39;t see this 
warning anywhere. There is something in the changelog, but how many 
people read changelogs? I rarely do, unless I want to know if some 
specific bug has been fixed. The main pod documentation should contain 
an analysis of the actual security provided. 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [Removing Crypt::RSA from module list] 
&gt; That is correct.  How do you propose they exchange the &#34;encryption 
&gt; module availability&#34; list while avoiding the above ? 
</div> 
SSL hashes all of the initialization messages into the session key. If 
an attacker modifies anything in transit, the key exchange fails. 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I will look into using the perl SSL module, however it will get quite 
&gt; tricky if one supports SSL and the other doesn&#39;t.  I don&#39;t want the 
&gt; module to be hard especially for beginners ... 
</div> 
I have to admit that SSL is pretty complicated. Security is a 
complicated business, though. 
 
Even if you decide not to use SSL, I think it would be a good idea to 
learn how it solves the common problems. The SSH protocol is also 
pretty well designed &#40;as far as I can tell&#41;, and it&#39;s a lot simpler. 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [Random numbers] 
&gt; I will fix that by implementing Vipul&#39;s Crypt::Random::Provider::rand 
&gt; module ... 
</div> 
Excellent. 
 
 -bob mathews 
 
</div></div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
