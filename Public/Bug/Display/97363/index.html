<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #97363 for Perl-Critic-StricterSubs: Subroutines::ProhibitCallsToUndeclaredSubs thinks 0xA0 is calling the sub &#39;A0&#39; </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #97363 for Perl-Critic-StricterSubs: Subroutines::ProhibitCallsToUndeclaredSubs thinks 0xA0 is calling the sub &#39;A0&#39; </h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Critic-StricterSubs/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Critic-StricterSubs/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Critic-StricterSubs/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Critic-StricterSubs/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/Perl-Critic/Perl-Critic-StricterSubs/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Critic-StricterSubs">Perl-Critic-StricterSubs CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">97363</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Critic-StricterSubs/Active/">Perl-Critic-StricterSubs</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
KENTNL [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-44204-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.03    </td>
  </tr>
  <tr id="CF-44205-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;20&nbsp;10:57:45&nbsp;2014</span>
    <span class="description">KENTNL [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Subroutines::ProhibitCallsToUndeclaredSubs thinks 0xA0 is calling
 the sub &#39;A0&#39;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza">For some reason:<br>

<br>

&nbsp;&nbsp; my $x = 0xA0<br>

<br>

Fails under the guise of it being apparently parsed as:<br>

<br>

&nbsp;&nbsp;&nbsp; &#39;0&#39; x ( A0() )<br>

<br>

At least, thats the best I think I can imagine based on what I&#39;m seeing.<br>

<br>

Either way, here is an attached test that replicates the error.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> hex-isnt-sub.t</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/env perl
# FILENAME: test.pl
# CREATED: 07/21/14 02:49:11 by Kent Fredric &#40;kentnl&#41; &lt;kentfredric@gmail.com&gt;
# ABSTRACT: Test critic policy for 0xA0

use strict;
use warnings;
use utf8;

use Test::More;
use Perl::Critic::TestUtils qw&#40;pcritique pcritique_with_violations&#41;;

local $@;
my $x;
my $fatal = 1;
my $code  = &lt;&lt;&#39;EOF&#39;;

  $x = 0xA0;

  $fatal = 0;

EOF

eval $code;

is&#40; $fatal, 0, &#39;Given code has no errors&#39; &#41; or diag explain $@;
is&#40; $x, 160, &#39;X is expected value&#39; &#41;;

my @violations = pcritique_with_violations&#40; &#39;Subroutines::ProhibitCallsToUndeclaredSubs&#39;, \$code &#41;;

is&#40; scalar @violations, 0, &#34;No violations&#34; &#41; or diag explain \@violations;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;21&nbsp;09:48:08&nbsp;2014</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perl::Critic relies on PPI to do its parsing, and this looks to me like a PPI error. That is unfortunate since Adam Kennedy has moved on from Perl and nobody seems to have picked up the maintenance of PPI. An unpalatable workaround is to use all lower case in the hex numbers, as PPI seems to parse that correctly:

$ # This is the parse we want
$ ppidump &#39;0xa0&#39;
                    PPI::Document
                      PPI::Statement
[    1,   1,   1 ]     PPI::Token::Number::Hex          &#39;0xa0&#39;
$ # All the following parses are incorrect
$ ppidump &#39;0xA0&#39;
                    PPI::Document
                      PPI::Statement
[    1,   1,   1 ]     PPI::Token::Number::Hex          &#39;0x&#39;
[    1,   3,   3 ]     PPI::Token::Word         &#39;A0&#39;
$ ppidump &#39;0XA0&#39;
                    PPI::Document
                      PPI::Statement
[    1,   1,   1 ]     PPI::Token::Number       &#39;0&#39;
[    1,   2,   2 ]     PPI::Token::Word         &#39;XA0&#39;
$ ppidump &#39;0Xa0&#39;
                    PPI::Document
                      PPI::Statement
[    1,   1,   1 ]     PPI::Token::Number       &#39;0&#39;
[    1,   2,   2 ]     PPI::Token::Word         &#39;Xa0&#39;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;21&nbsp;09:48:09&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;21&nbsp;09:48:09&nbsp;2014</span>
    <span class="description">wyant [...] cpan.org -  Status changed from &#39;open&#39; to &#39;new&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;21&nbsp;11:49:01&nbsp;2014</span>
    <span class="description">jeff [...] imaginative-software.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #97363] Subroutines::ProhibitCallsToUndeclaredSubs thinks 0xA0 is calling the sub &#39;A0&#39;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Jul 2014 08:48:47 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic-StricterSubs [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Thalhammer, Jeffrey Ryan&#34; &lt;jeff [...] imaginative-software.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I believe Christian Walde has taken over maintenance of PPI. There is a
new-ish development release on CPAN that has several bug fixes. We should
check that. I&#39;m at a conference this week so I won&#39;t get to it for a few
days.
On Jul 21, 2014 6:48 AM, &#34;Tom Wyant via RT&#34; &lt;
bug-Perl-Critic-StricterSubs@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Perl-Critic-StricterSubs
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=97363">https://rt.cpan.org/Ticket/Display.html?id=97363</a></span> &gt;
&gt;
&gt; Perl::Critic relies on PPI to do its parsing, and this looks to me like a
&gt; PPI error. That is unfortunate since Adam Kennedy has moved on from Perl
&gt; and nobody seems to have picked up the maintenance of PPI. An unpalatable
&gt; workaround is to use all lower case in the hex numbers, as PPI seems to
&gt; parse that correctly:
&gt;
&gt; $ # This is the parse we want
&gt; $ ppidump &#39;0xa0&#39;
&gt;                     PPI::Document
&gt;                       PPI::Statement
&gt; [    1,   1,   1 ]     PPI::Token::Number::Hex          &#39;0xa0&#39;
&gt; $ # All the following parses are incorrect
&gt; $ ppidump &#39;0xA0&#39;
&gt;                     PPI::Document
&gt;                       PPI::Statement
&gt; [    1,   1,   1 ]     PPI::Token::Number::Hex          &#39;0x&#39;
&gt; [    1,   3,   3 ]     PPI::Token::Word         &#39;A0&#39;
&gt; $ ppidump &#39;0XA0&#39;
&gt;                     PPI::Document
&gt;                       PPI::Statement
&gt; [    1,   1,   1 ]     PPI::Token::Number       &#39;0&#39;
&gt; [    1,   2,   2 ]     PPI::Token::Word         &#39;XA0&#39;
&gt; $ ppidump &#39;0Xa0&#39;
&gt;                     PPI::Document
&gt;                       PPI::Statement
&gt; [    1,   1,   1 ]     PPI::Token::Number       &#39;0&#39;
&gt; [    1,   2,   2 ]     PPI::Token::Word         &#39;Xa0&#39;
&gt;
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;21&nbsp;11:49:01&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;22&nbsp;13:32:38&nbsp;2014</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza">I can indeed confirm that with the newest DEV version of PPI <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/MITHALDU/PPI-1.216_01">https://metacpan.org/release/MITHALDU/PPI-1.216_01</a></span><br>

<br>

That this test passes.<br>

<br>

Likewise, this is what App::PPI::Dumper does:<br>

<br>

echo &#39;0xa0&#39; | ppi_dumper /dev/stdin<br>

PPI::Document<br>

&nbsp; PPI::Statement<br>

&nbsp;&nbsp;&nbsp; PPI::Token::Number::Hex &nbsp;&nbsp;&nbsp; &nbsp;&#39;0xa0&#39;<br>

&nbsp; PPI::Token::Whitespace &nbsp;&nbsp;&nbsp; &nbsp;&#39;\n&#39;<br>

<br>

echo &#39;0xA0&#39; | ppi_dumper /dev/stdin<br>

PPI::Document<br>

&nbsp; PPI::Statement<br>

&nbsp;&nbsp;&nbsp; PPI::Token::Number::Hex &nbsp;&nbsp;&nbsp; &nbsp;&#39;0xA0&#39;<br>

&nbsp; PPI::Token::Whitespace &nbsp;&nbsp;&nbsp; &nbsp;&#39;\n&#39;<br>

<br>

echo &#39;0XA0&#39; | ppi_dumper /dev/stdin<br>

PPI::Document<br>

&nbsp; PPI::Statement<br>

&nbsp;&nbsp;&nbsp; PPI::Token::Number::Hex &nbsp;&nbsp;&nbsp; &nbsp;&#39;0XA0&#39;<br>

&nbsp; PPI::Token::Whitespace &nbsp;&nbsp;&nbsp; &nbsp;&#39;\n&#39;<br>


</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
