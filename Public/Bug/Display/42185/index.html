<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #42185 for DBD-DB2: Binding to the return value of a stored procedure silently fails</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #42185 for DBD-DB2: Binding to the return value of a stored procedure silently fails</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-DB2">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-DB2">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-DB2">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-DB2">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-DB2">DBD-DB2 CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">42185</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">30 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-DB2">DBD-DB2</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">opendev [...] us.ibm.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
appfault [...] hotmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
aff [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-10084-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.2    </td>
  </tr>
  <tr id="CF-10085-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




p9744t-46309872.cli<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/573314/289374/p9744t-46309872.cli">
Thu Mar 05 07:11:04 2009 (8k) by aff [...] cpan.org
</a>
</font></li>
</ul>


perltest.appfault.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/573311/289367/perltest.appfault.pl">
Thu Mar 05 06:48:23 2009 (931b) by aff [...] cpan.org
</a>
</font></li>
</ul>


perltest.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/588741/297959/perltest.pl">
Wed Apr 08 18:49:50 2009 (1.6k) by appfault [...] hotmail.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/565365/285494/perltest.pl">
Tue Feb 10 12:01:28 2009 (871b) by appfault [...] hotmail.com
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/562256/283918/perltest.pl">
Mon Feb 02 01:34:24 2009 (779b) by opendev [...] us.ibm.com
</a>
</font></li>
</ul>


sp_return_value.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/925066/479981/sp_return_value.diff">
Tue Apr 19 00:18:50 2011 (3.2k) by opendev [...] us.ibm.com
</a>
</font></li>
</ul>


storedproc.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/573885/289728/storedproc.pl">
Fri Mar 06 07:55:34 2009 (1.5k) by opendev [...] us.ibm.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=42185">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-550812" href="/Public/Bug/Display.html?id=42185#txn-550812">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;06&nbsp;13:21:44&nbsp;2009</span>
    <span class="description">appfault [...] hotmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Binding to the return value of a stored procedure silently fails</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/550812/277408/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/277408">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 403b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Binding to the return value of a stored procedure silently fails

For instance doing something like:

my $bind_value;
my $sth = $dbh-&gt;prepare&#40;&#34;{?=call MYPROC&#40;&#41;}&#34;&#41;;
$sth-&gt;bind_param_inout&#40;1, \$bind_value, 100&#41; or die;
$sth-&gt;execute&#40;&#41; or die;
print Dumper&#40;$bind_value&#41;.&#34;\n&#34;;

Will show the &#34;$VAR1 = undef;&#34; which is not possible.  The variable must
be an integer after the statement successfully executes.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-551079" href="/Public/Bug/Display.html?id=42185#txn-551079">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;07&nbsp;03:24:34&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-551089" href="/Public/Bug/Display.html?id=42185#txn-551089">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;07&nbsp;03:25:08&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-551099" href="/Public/Bug/Display.html?id=42185#txn-551099">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;07&nbsp;04:32:35&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken">30 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/551099/277590/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/277590">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi..

Thank you for reporting the bug for DBD::DB2. However, to proceed
further, I would like to request you to provide me with some additional
information.

1. Please send me the output of the following commands

$ perl -V
$ db2level
$ uname -a

2. Please provide me with the CLITrace for your program to help further.

Steps to take CLI Trace:- 

* Make an environment variable named DB2CLIINIPATH and set it to some
directory where your local db2cli.ini will reside.
eg. in bash, issue
export DB2CLIINIPATH=&lt;dir name where the traces will be generated&gt;

On Windows, issue

set DB2CLIINIPATH=&lt;dir name where the traces will be generated&gt;

* issue the following commands &#40; in windows run these commands in the
DB2 command prompt, issue db2cmd for the same&#41;

db2 update cli cfg for section COMMON using trace 1
db2 update cli cfg for section COMMON using tracepathname &lt;dir name
where the traces will be generated&gt;

* Local db2cli.ini file should be generated in mentioned directory.
* Run the application. Traces will be generated inside the specified
directory.
* To disable the CLI trace issue the following command

db2 update cli cfg for section COMMON using trace 0

* Remember to put the trace off.

-- 
Thanks
Tarun Pasrija
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-560418" href="/Public/Bug/Display.html?id=42185#txn-560418">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;27&nbsp;14:37:28&nbsp;2009</span>
    <span class="description">appfault [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/560418/282957/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/282957">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 430b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Are you saying that you&#39;ve been unable to reproduce the problem?

$ uname -a
Linux scorcho.corp.ud.com 2.4.21-32.ELsmp #1 SMP Fri Apr 15 21:17:59 EDT
2005 i686 i686 i386 GNU/Linux

$ db2level
DB21085I  Instance &#34;db2inst1&#34; uses &#34;32&#34; bits and DB2 code release &#34;SQL08027&#34;
with level identifier &#34;03080106&#34;.
Informational tokens are &#34;DB2 v8.1.0.128&#34;, &#34;s061108&#34;, &#34;MI00175&#34;, and FixPak
&#34;14&#34;.
Product is installed at &#34;/opt/IBM/db2/V8.1&#34;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-562256" href="/Public/Bug/Display.html?id=42185#txn-562256">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;02&nbsp;01:34:24&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/562256/283915/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/283915">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 414b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I have attached a script. I am trying to understand if this is what you
are trying to achieve.? Can you please run the attached script and let
me know the output of the script. Also, if this is not what you wish to
do then can you please send me a reproducible script and your expected
output for the same. Thanks.

-- 
Thanks
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/562256/283918/perltest.pl">Download perltest.pl</a><br />
<span class="downloadcontenttype">text/x-perl 779b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use DBI;
use DBD::DB2;
use DBD::DB2::Constants;

require &#39;connection.pl&#39;;
require &#39;perldutl.pl&#39;;

$DATABASE = &#34;dbname&#34;;
$USERID = &#34;user&#34;;
$PASSWORD = &#34;password&#34;;

$dbh = DBI-&gt;connect&#40;&#34;dbi:DB2:$DATABASE&#34;, &#34;$USERID&#34;, &#34;$PASSWORD&#34;, {PrintError =&gt; 0}&#41;;

$sth = $dbh-&gt;prepare&#40; &#39;DROP PROCEDURE SP_Example&#39; &#41;;
$sth-&gt;execute&#40;&#41;;

$statement = &#34;CREATE PROCEDURE SP_Example &#40;&#41; LANGUAGE SQL BEGIN RETURN 5; END&#34;;
$sth = $dbh-&gt;prepare&#40; $statement &#41;;
$sth-&gt;execute&#40;&#41;;

$sth = $dbh-&gt;prepare&#40; &#39;{ ? = CALL SP_Example&#40; &#41; }&#39; &#41;;
$sth-&gt;bind_param_inout&#40; 1, \$output, 20, { &#39;db2_param_type&#39; =&gt; SQL_PARAM_OUTPUT, &#39;db2_c_type&#39; =&gt; SQL_C_LONG, &#39;db2_type&#39; =&gt; SQL_INTEGER }&#41;;
$rv = $sth-&gt;execute&#40;&#41;;

printf &#40; &#34;the output is %d &#34;, $output &#41;;

$sth-&gt;finish;
$dbh-&gt;disconnect;



</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-565365" href="/Public/Bug/Display.html?id=42185#txn-565365">#</a>      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;12:01:28&nbsp;2009</span>
    <span class="description">appfault [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/565365/285491/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/285491">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 294b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Your script is roughly the same as my example, it outputs:

the output is 0

Which is incorrect, as I reported originally.

I changed the script slightly to add error checking and put the login
params on the command line.  Here&#39;s my version.

When you run that script what do you get as output?
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/565365/285494/perltest.pl">Download perltest.pl</a><br />
<span class="downloadcontenttype">text/x-perl 871b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl

use DBI;
use DBD::DB2;
use DBD::DB2::Constants;

my &#40;$DATABASE, $USERID, $PASSWORD&#41; = @ARGV;

$dbh = DBI-&gt;connect&#40;&#34;dbi:DB2:$DATABASE&#34;, &#34;$USERID&#34;, &#34;$PASSWORD&#34;, {PrintError =&gt; 1}&#41; or die $DBI::errstr;

$sth = $dbh-&gt;prepare&#40; &#39;DROP PROCEDURE SP_Example&#39; &#41; or die $DBI::errstr;
$sth-&gt;execute&#40;&#41;;

$statement = &#34;CREATE PROCEDURE SP_Example &#40;&#41; LANGUAGE SQL BEGIN RETURN 5; END&#34;;
$sth = $dbh-&gt;prepare&#40; $statement &#41; or die $DBI::errstr;
$sth-&gt;execute&#40;&#41; or die $DBI::errstr;

$sth = $dbh-&gt;prepare&#40; &#39;{ ? = CALL SP_Example&#40; &#41; }&#39; &#41; or die $DBI::errstr;
$sth-&gt;bind_param_inout&#40; 1, \$output, 20, { &#39;db2_param_type&#39; =&gt; SQL_PARAM_OUTPUT, &#39;db2_c_type&#39; =&gt; SQL_C_LONG, &#39;db2_type&#39; =&gt; SQL_INTEGER }&#41; or die $DBI::errstr;
$rv = $sth-&gt;execute&#40;&#41; or die $DBI::errstr;

printf&#40;&#34;the output is %d\n&#34;, $output&#41;;

$sth-&gt;finish or die $DBI::errstr;
$dbh-&gt;disconnect or die $DBI::errstr;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-573311" href="/Public/Bug/Display.html?id=42185#txn-573311">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;05&nbsp;06:48:22&nbsp;2009</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/573311/289364/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/289364">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 893b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Feb 10 12:01:28 2009, appfault wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Your script is roughly the same as my example, it outputs:
&gt; the output is 0
</div>
Bug confirmed in the following environment: 

* OS:

Linux 2.6.18-92.1.22.el5 #1 SMP Tue Dec 16 11:57:43 EST 2008
x86_64 x86_64 x86_64 GNU/Linux

* Perl:

This is perl, v5.10.0 built for x86_64-linux

* DB2:

DB21085I  Instance &#34;db2inst1&#34; uses &#34;64&#34; bits and DB2 code release
&#34;SQL09050&#34; 
with level identifier &#34;03010107&#34;.
 Informational tokens are &#34;DB2 v9.5.0.0&#34;, &#34;s071001&#34;, &#34;LINUXAMD6495&#34;, and
Fix 
Pack &#34;0&#34;.
 
Product is installed at &#34;/opt/ibm/db2/V9.5&#34;.

* DBD::DB2:

Module id = DBD::DB2  INST_VERSION 1.3

Consider using &#39;strict&#39; and &#39;warnings&#39; in your perl code.  Enabling
&#39;warnings&#39; prints the following:

  $ perl -w perltest.appfault.pl &lt;DB&gt; &lt;USER&gt; &lt;PASS&gt;
  Argument &#34;^E\0\0\0&#34; isn&#39;t numeric in printf at perltest.appfault.pl
  line 27.
  the output is 0
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/573311/289367/perltest.appfault.pl">Download perltest.appfault.pl</a><br />
<span class="downloadcontenttype">text/x-perl 931b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!perl

use strict;
use warnings;

use DBI;
use DBD::DB2;
use DBD::DB2::Constants;

my &#40;$DATABASE, $USERID, $PASSWORD&#41; = @ARGV;

my $dbh = DBI-&gt;connect&#40;&#34;dbi:DB2:$DATABASE&#34;, &#34;$USERID&#34;, &#34;$PASSWORD&#34;, {PrintError =&gt; 1}&#41; or die $DBI::errstr;

my $sth = $dbh-&gt;prepare&#40; &#39;DROP PROCEDURE SP_Example&#39; &#41; or die $DBI::errstr;
$sth-&gt;execute&#40;&#41;;

my $statement = &#34;CREATE PROCEDURE SP_Example &#40;&#41; LANGUAGE SQL BEGIN RETURN 5; END&#34;;
$sth = $dbh-&gt;prepare&#40; $statement &#41; or die $DBI::errstr;
$sth-&gt;execute&#40;&#41; or die $DBI::errstr;

my $output = undef;

$sth = $dbh-&gt;prepare&#40; &#39;{ ? = CALL SP_Example&#40; &#41; }&#39; &#41; or die $DBI::errstr;
$sth-&gt;bind_param_inout&#40; 1, \$output, 20, { &#39;db2_param_type&#39; =&gt; SQL_PARAM_OUTPUT, &#39;db2_c_type&#39; =&gt; SQL_C_LONG, &#39;db2_type&#39; =&gt; SQL_INTEGER }&#41; or die $DBI::errstr;
my $rv = $sth-&gt;execute&#40;&#41; or die $DBI::errstr;

printf&#40;&#34;the output is %d\n&#34;, $output&#41;;

$sth-&gt;finish or die $DBI::errstr;
$dbh-&gt;disconnect or die $DBI::errstr;

__END__
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-573314" href="/Public/Bug/Display.html?id=42185#txn-573314">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;05&nbsp;07:11:03&nbsp;2009</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/573314/289371/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/289371">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 152b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 07 04:32:35 2009, IBMTORDB2 wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2. Please provide me with the CLITrace for your program to help further.
</div>
Please find a cli trace file.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/573314/289374/p9744t-46309872.cli">Download p9744t-46309872.cli</a><br />
<span class="downloadcontenttype">application/octet-stream 8k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-573885" href="/Public/Bug/Display.html?id=42185#txn-573885">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;06&nbsp;07:55:34&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> opendev [...] us.ibm.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/573885/289725/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/289725">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 817b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi 

Thanks for your reply. I was a little confused before and the clitrace
was really helpful to reproduce the scenario. We had added something
called as a db2_call_return in version 1.6 which was released mid
february which allows you to get a return value from a stored procedure.

Thus if your stored procedure is something like

CREATE PROCEDURE SP_Example &#40;&#41; LANGUAGE SQL BEGIN RETURN 5

and you call the stored proc using

{ ? = CALL SP_Example&#40; &#41; }

Then I believe that you expect the value 5 as a return. You can get this
value now by calling

sth-&gt;{db2_call_return}

However, I am attaching 2 different testcases for your reference. I have
also added comments of what would work and what would not.

-- 
Thanks
Tarun Pasrija
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/573885/289728/storedproc.pl">Download storedproc.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use DBI;
use DBD::DB2;

$DATABASE=&#34;dbname&#34;;
$USERID = &#34;username&#34;;
$PASSWORD = &#34;password&#34;;

my $dbh = DBI-&gt;connect&#40;&#34;dbi:DB2:$DATABASE&#34;, $USERID, $PASSWORD, {PrintError =&gt; 1}&#41;
        or die &#34;Couldn&#39;t connect to database: &#34; . DBI-&gt;errstr;

$sth = $dbh-&gt;prepare&#40; &#34;DROP PROCEDURE swap_email_address&#34;&#41;;
$sth-&gt;execute&#40;&#41;;

$statement = &#34;CREATE PROCEDURE swap_email_address  &#40; INOUT inoutString char&#40;25&#41;,  INOUT outString char&#40;25&#41; &#41; P1:   BEGIN  set inoutString = outString; set outString = inoutString ; return 5; END P1&#34;;
$sth = $dbh-&gt;prepare&#40; $statement &#41;;
$sth-&gt;execute&#40;&#41;;

$sth = $dbh-&gt;prepare&#40; &#34;{?=CALL swap_email_address&#40;?,?&#41;}&#34;&#41;;

my $name = &#34;hello&#34;;
my $second_name = &#34;yellow&#34;;
my $output=100;
print &#34;Values before binding  $name, $second_name \n&#34;;

$sth-&gt;bind_param_inout&#40; 1, \$output, { &#39;db2_param_type&#39; =&gt; SQL_PARAM_INPUT_OUTPUT}&#41; or die;
$sth-&gt;bind_param_inout&#40; 2, \$name, { &#39;db2_param_type&#39; =&gt; SQL_PARAM_INPUT_OUTPUT}&#41;;
$sth-&gt;bind_param_inout&#40; 3, \$second_name, { &#39;db2_param_type&#39; =&gt; SQL_PARAM_INPUT_OUTPUT }&#41;;
$sth-&gt;execute&#40;&#41;;

# The following code does not work like in your previous example since DB2 does not return a value for ?=some storedproc
# my $nooutput;
# $sth-&gt;bind_param_inout&#40; 1, \$nooutput, { &#39;db2_param_type&#39; =&gt; SQL_PARAM_OUTPUT}&#41; or die;
# print &#34;$nooutput&#34; ; // This would give an undef value since DB2 does not return anything. Thus you would need to use db2_call_return.

print &#34;Values after binding  $name, $second_name, $output \n&#34;;
#This would output 10
print &#34;Value for Call return is $sth-&gt;{db2_call_return} \n&#34;;    

$sth-&gt;finish&#40;&#41;;

$dbh-&gt;disconnect;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-574077" href="/Public/Bug/Display.html?id=42185#txn-574077">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;06&nbsp;16:34:13&nbsp;2009</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/574077/289826/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/289826">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Mar 06 07:55:34 2009, IBMTORDB2 wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We had added something called as a db2_call_return in version 1.6
&gt; which was released mid february which allows you to get a return
&gt; value from a stored procedure.
</div>
Tarun,

Thank you for your prompt and helpful response. 

Please note that the version 1.6 of DBD::DB2 seems to be incorrectly
named, which unfortunately means it is no longer available on CPAN
using the normal shell:

  $ sudo perl -MCPAN -e shell
  
  cpan[1]&gt; i DBD::DB2
  
  Strange distribution name [DBD::DB2]
  Module id = DBD::DB2
      DESCRIPTION  DB2 Driver for DBI
      CPAN_USERID  IBMTORDB2 &#40;IBM OpenDev &lt;opendev@us.ibm.com&gt;&#41;
      CPAN_VERSION undef
      CPAN_FILE    Contact Author IBM OpenDev &lt;opendev@us.ibm.com&gt;
      DSLIP_STATUS MdhOo
&#40;mature,developer,hybrid,object-oriented,open-source&#41;
      MANPAGE      DBD::DB2 - DataBase Driver for DB2 UDB
      INST_FILE    /opt/perl/lib/site_perl/5.10.0/x86_64-linux/DBD/DB2.pm
      INST_VERSION 1.3

The expected output should be:
    CPAN_VERSION 1.6

There has been filed a bug report for this issue:

<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43869">https://rt.cpan.org/Ticket/Display.html?id=43869</a></span> &#34;Perl cpan DBD::DB2
-&gt; DBD::DB216 naming breaks index script&#34;

If you are entitled to upload a new version of DBD-DB2 version 1.6, or
knows anyone within IBM who are, I encourage you to address this issue
as soon as possible.

Thanks.

Best regards,
Andreas
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-574080" href="/Public/Bug/Display.html?id=42185#txn-574080">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;06&nbsp;16:34:52&nbsp;2009</span>
    <span class="description">aff [...] cpan.org -  Cc AFF added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-574435" href="/Public/Bug/Display.html?id=42185#txn-574435">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;07&nbsp;11:13:20&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/574435/290068/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/290068">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 208b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks

I have made the necessary corrections and updated the other ticket. The
current version on CPAN is 1.61. 

-- 
Thanks
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-574683" href="/Public/Bug/Display.html?id=42185#txn-574683">#</a>      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;08&nbsp;06:04:14&nbsp;2009</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/574683/290224/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/290224">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 550b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Mar 06 07:55:34 2009, IBMTORDB2 wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We had added something called as a db2_call_return in version 1.6
&gt; which was released mid february which allows you to get a return
&gt; value from a stored procedure. 
</div>
After upgrade to DBD::DB2 version 1.61, your code example works for me
with perl, v5.10.0 built for x86_64-linux, DB2 v9.5.0.0:

$ perl -w storedproc.pl
Values before binding  hello, yellow
Values after binding  yellow                   , yellow                
  , 100
Value for Call return is 5

Thanks.

Best regards,
Andreas
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-574691" href="/Public/Bug/Display.html?id=42185#txn-574691">#</a>      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;08&nbsp;06:44:28&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> opendev [...] us.ibm.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/574691/290231/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/290231">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 142b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Marking this issue closed. Thanks

-- 
Thanks
Tarun Pasrija
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-574694" href="/Public/Bug/Display.html?id=42185#txn-574694">#</a>      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;08&nbsp;06:44:29&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-588734" href="/Public/Bug/Display.html?id=42185#txn-588734">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;08&nbsp;18:21:48&nbsp;2009</span>
    <span class="description">appfault [...] hotmail.com -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-588741" href="/Public/Bug/Display.html?id=42185#txn-588741">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;08&nbsp;18:49:50&nbsp;2009</span>
    <span class="description">appfault [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/588741/297956/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/297956">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 978b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The existence of $sth-&gt;{&#39;db2_call_return&#39;} is nice, but that&#39;s not a
solution to this ticket.  The issue still exists that binding to the
return value silently fails.

The output from &#34;Sun Mar 08 06:04:14 2009&#34; indicates this is still
broken.  It said &#34;Values after binding yellow , yellow , 100&#34; but that&#39;s
wrong - the 100 should have been 5.

The attached script tests for this.  It does a die&#40;&#41; if either style fails.

Also note, per the test there are two different ways it can fail.  It
can fail and return &#34;&#34; or it can fail and return the binary string
&#34;\5\0\0\0&#34;.  The latter is seemingly a failed binary representation of
the correct answer 5, though why it&#39;s being corrupted is unclear.

Checking round 1 db2_call_return value 5 ............... pass
Checking round 1 output bind var value &#34;&#34; .............. FAIL
Checking round 2 db2_call_return value 5 ............... pass
Checking round 2 output bind var value &#34;\5\0\0\0&#34; ...... FAIL
failed at ./perltest.pl line 56.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/588741/297959/perltest.pl">Download perltest.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w

use warnings;
use strict;

use DBI;
use DBD::DB2;
use DBD::DB2::Constants;
use Data::Dumper;
$Data::Dumper::Useqq = 1;
$Data::Dumper::Terse = 1;
$Data::Dumper::Indent = 0;

my &#40;$DATABASE, $USERID, $PASSWORD&#41; = @ARGV;

my $dbh = DBI-&gt;connect&#40;&#34;dbi:DB2:$DATABASE&#34;, &#34;$USERID&#34;, &#34;$PASSWORD&#34;, {PrintError =&gt; 1}&#41; or die $DBI::errstr;

my $sth = $dbh-&gt;prepare&#40; &#39;DROP PROCEDURE SP_Example&#39; &#41; or die $DBI::errstr;
$sth-&gt;execute&#40;&#41;;

my $statement = &#34;CREATE PROCEDURE SP_Example &#40;&#41; LANGUAGE SQL BEGIN RETURN 5; END&#34;;
$sth = $dbh-&gt;prepare&#40; $statement &#41; or die $DBI::errstr;
$sth-&gt;execute&#40;&#41; or die $DBI::errstr;

my $failures = 0;
sub passfail&#40;$$&#41; {
    my &#40;$msg, $ret&#41; = @_;
    print&#40;$msg.&#39; &#39;.&#40;&#39;.&#39;x&#40;55 - length&#40;$msg&#41;&#41;&#41;.&#39; &#39;.&#40;$ret ? &#39;pass&#39; : &#39;FAIL&#39;&#41;.&#34;\n&#34;&#41;;
    $failures++ if &#40;!$ret&#41;;
}

my $round = 0;
foreach my $binds &#40;
    { &#39;db2_param_type&#39; =&gt; SQL_PARAM_OUTPUT },
    { &#39;db2_param_type&#39; =&gt; SQL_PARAM_OUTPUT, &#39;db2_c_type&#39; =&gt; SQL_C_LONG },
&#41; {
    $round++;
    $sth = $dbh-&gt;prepare&#40; &#39;{ ? = CALL SP_Example&#40; &#41; }&#39; &#41; or die $DBI::errstr;
    my $output;
    $sth-&gt;bind_param_inout&#40; 1, \$output, 20, $binds&#41; or die $DBI::errstr;

    $sth-&gt;execute&#40;&#41; or die $DBI::errstr;
    my $output_dcr = $sth-&gt;{&#39;db2_call_return&#39;};

    #printf&#40;&#34;the output bind is &#34;.Dumper&#40;$output&#41;&#41;;
    #printf&#40;&#34;the db2_call_return is &#34;.Dumper&#40;$output_dcr&#41;&#41;;

    $sth-&gt;finish or die $DBI::errstr;

    passfail&#40;&#39;Checking round &#39;.$round.&#39; db2_call_return value &#39;.Dumper&#40;$output_dcr&#41;, $output_dcr eq 5&#41;;
    passfail&#40;&#39;Checking round &#39;.$round.&#39; output bind var value &#39;.Dumper&#40;$output&#41;, $output eq 5&#41;;
}

$dbh-&gt;disconnect or die $DBI::errstr;

die &#39;failed&#39; if $failures;</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-588744" href="/Public/Bug/Display.html?id=42185#txn-588744">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;08&nbsp;18:51:04&nbsp;2009</span>
    <span class="description">appfault [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/588744/297962/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/297962">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 104b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Apr 08 18:49:50 2009, appfault wrote:

The previous comment was using DBI-1.607 and DBD-DB2-1.71.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-590912" href="/Public/Bug/Display.html?id=42185#txn-590912">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;14&nbsp;02:42:00&nbsp;2009</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/590912/299211/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/299211">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 349b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi

Thanks for reporting this. I would get back to you with an update on
this one. 

On Wed Apr 08 18:51:04 2009, appfault wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Apr 08 18:49:50 2009, appfault wrote:
&gt; 
&gt; The previous comment was using DBI-1.607 and DBD-DB2-1.71.
</div>
-- 
Thanks
Tarun Pasrija
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-871783" href="/Public/Bug/Display.html?id=42185#txn-871783">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;21&nbsp;11:37:19&nbsp;2010</span>
    <span class="description">appfault [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> appfault [...] hotmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/871783/451476/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/451476">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 20b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Any status on this?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874484" href="/Public/Bug/Display.html?id=42185#txn-874484">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;28&nbsp;23:17:35&nbsp;2010</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/874484/452858/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/452858">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 563b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Dec 21 11:37:19 2010, appfault wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Any status on this?
</div>Hi,

Tarun, who was handling this module, is moved out of the project. I will
be looking into to this and would need some time to get back to you.
Currently I am able to track down to the cause of the problem and am
seeking help from CLI &#40;The underlying layer through which DBD::DB2 talks
to DB2&#41; team, as looks like this is a bug in CLI.

Will keep you posted on progress made on this defect.

-- 
Thanks
Praveen
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-876265" href="/Public/Bug/Display.html?id=42185#txn-876265">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;03&nbsp;05:49:20&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> rackapur [...] in.ibm.com, aff [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/876265/453815/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/453815">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 341b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

The CLI team sees this is as a defect in their layer. They have asked
for some more time on investigating the problem and would get back on
which fix pak the fix for the issue will be available. Will keep you
posted on the update.

------
Thanks
Praveen
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-917759" href="/Public/Bug/Display.html?id=42185#txn-917759">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;01&nbsp;10:55:12&nbsp;2011</span>
    <span class="description">http://iguanodon.myopenid.com/ -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> don.silvia [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/917759/476049/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/476049">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 349b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Can you please give a status on this?  

Thanks,

On Mon Jan 03 05:49:20 2011, IBMTORDB2 wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; The CLI team sees this is as a defect in their layer. They have asked
&gt; for some more time on investigating the problem and would get back on
&gt; which fix pak the fix for the issue will be available. Will keep you
&gt; posted on the update.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-920074" href="/Public/Bug/Display.html?id=42185#txn-920074">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;07&nbsp;05:17:22&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> aff [...] cpan.org, don.silvia [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/920074/477345/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/477345">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

CLI expects that the return value from stored procedure is always bound
with variable of type SQL_C_LONG. The reason being the data type of the
return value from a Stored Procedure is always of type SQL_INTEGER. To
handle this we have fixed the DBD-DB2 driver with the patch below. You
can apply the patch and try making a stored procedure call as mentioned
below to get the output from a stored procedure.

Patch for dbdimp.c
===================
diff dbdimp.c_new dbdimp.c_version1.80
2436,2449d2435
&lt;                 SQLPOINTER datap;
&lt;                 switch &#40;ctype&#41; {
&lt;                         case SQL_C_SHORT:
&lt;                         case SQL_C_LONG:
&lt;                                 datap = &#38;phs-&gt;ivValue;
&lt;                                 break;
&lt;                         case SQL_C_FLOAT:
&lt;                         case SQL_C_DOUBLE:
&lt;                                 datap = &#38;phs-&gt;dblValue;
&lt;                                 break;
&lt;                         default:
&lt;                                 datap = phs-&gt;buffer;
&lt;                                 break;
&lt;                 }
2457c2443
&lt;                               datap,
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                               phs-&gt;buffer,
</div>2462,2464d2447
&lt;
&lt;       phs-&gt;cType = ctype;     /*Set the cType of the variable to which
the parameter is bound*/
&lt;
2561,2570c2544,2547
&lt;                                               if&#40; phs-&gt;cType ==
SQL_C_LONG || phs-&gt;cType == SQL_C_SHORT &#41; {
&lt;                                                        
sv_setiv&#40;phs-&gt;sv, phs-&gt;ivValue&#41;;
&lt;                                                 } else if&#40; phs-&gt;cType
== SQL_C_DOUBLE || phs-&gt;cType == SQL_C_FLOAT &#41; {
&lt;                                                        
sv_setnv&#40;phs-&gt;sv, phs-&gt;dblValue&#41;;
&lt;                                                 } else {
&lt;                                                         sv_setpvn&#40;
phs-&gt;sv, phs-&gt;buffer, phs-&gt;indp &#41;;
&lt;                                                       if&#40; phs-&gt;indp &gt;
phs-&gt;bufferSize &#41;
&lt;                                                               warn&#40;
&#34;Output buffer too small, data truncated &#34;
&lt;                                                                      
        &#34;for parameter &#39;%s&#39;&#34;, key &#41;;
&lt;                                               }
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                                               sv_setpvn&#40; phs-&gt;sv,
</div>phs-&gt;buffer, phs-&gt;indp &#41;;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                                               if&#40; phs-&gt;indp &gt;
</div>phs-&gt;bufferSize &#41;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                                                       warn&#40; &#34;Output
</div>buffer too small, data truncated &#34;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                                                                      
</div>&#34;for parameter &#39;%s&#39;&#34;, key &#41;;

Patch for dbdimp.h
==================
diff dbdimp.h_new dbdimp.h_version1.80

108d107
&lt;         SQLSMALLINT cType;               /* The parameter cType      
             */
115,116d113
&lt;       IV           ivValue;            /*integer variable to hold the
bound output value */
&lt;       double       dblValue;           /*double variable to hold the
bound output value*/

Changes needed in the Perl program
==================================
You will need to specify the db2_c_type in the bind_param_inout call as
below

$sth-&gt;bind_param_inout&#40; 1, \$bind_value, 4, {&#39;db2_c_type&#39; =&gt; SQL_C_LONG}&#41;;

Let us know if you need any clarifications or if finding any difficulty
applying the patch.

-- 
Thanks
Praveen
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-920077" href="/Public/Bug/Display.html?id=42185#txn-920077">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;07&nbsp;05:17:24&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-924816" href="/Public/Bug/Display.html?id=42185#txn-924816">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;18&nbsp;11:51:47&nbsp;2011</span>
    <span class="description">don.silvia+pause [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/924816/479849/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/479849">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 830b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks, but I&#39;m having trouble applying the patch:

[DBD-DB2-1.80]$ patch -i dbdimp.c.patch dbdimp.c
  Looks like a normal diff.
Hunk #1 failed at line 2436.
Hunk #2 failed at line 2457.
Malformed patch at line 23:
patch: &#39;&lt; &#39; expected at start of line.

I think there are some line wrapping problems.  Is there a way to attach
the patch files ?

Thanks,

On Thu Apr 07 05:17:22 2011, IBMTORDB2 wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; CLI expects that the return value from stored procedure is always bound
&gt; with variable of type SQL_C_LONG. The reason being the data type of the
&gt; return value from a Stored Procedure is always of type SQL_INTEGER. To
&gt; handle this we have fixed the DBD-DB2 driver with the patch below. You
&gt; can apply the patch and try making a stored procedure call as mentioned
&gt; below to get the output from a stored procedure.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-924819" href="/Public/Bug/Display.html?id=42185#txn-924819">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;18&nbsp;11:51:48&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-925066" href="/Public/Bug/Display.html?id=42185#txn-925066">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;19&nbsp;00:18:50&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/925066/479980/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/479980">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 194b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Find attached below the patch file. Let me know if you are still facing
any difficulty.
-- 
Thanks
Praveen
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> sp_return_value.diff</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/925066/479981/sp_return_value.diff">Download sp_return_value.diff</a><br />
<span class="downloadcontenttype">text/x-diff 3.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- 1.80/dbdimp.c	Fri Oct 29 12:04:28 2010
+++ 1.80Ppatch/dbdimp.c	Thu Apr 07 14:07:29 2011
@@ -2433,6 +2433,20 @@
   				maxlen,
   				&#38;phs-&gt;indp &#41;;
 #else
+                SQLPOINTER datap;
+                switch &#40;ctype&#41; {
+                        case SQL_C_SHORT:
+                        case SQL_C_LONG:
+                                datap = &#38;phs-&gt;ivValue;
+                                break;
+                        case SQL_C_FLOAT:
+                        case SQL_C_DOUBLE:
+                                datap = &#38;phs-&gt;dblValue;
+                                break;
+                        default:
+                                datap = phs-&gt;buffer;
+                                break;
+                }
 	  	ret = SQLBindParameter&#40; imp_sth-&gt;phstmt,
   				&#40;SQLUSMALLINT&#41;SvIV&#40; param &#41;,
   				phs-&gt;paramType,
@@ -2440,11 +2454,14 @@
   				sql_type,
   				phs-&gt;bDescribeOK ? phs-&gt;descColumnSize : prec,
   				scale,
-  				phs-&gt;buffer,
+  				datap,
   				maxlen,
   				&#38;phs-&gt;indp &#41;;
 #endif
     	}
+
+	phs-&gt;cType = ctype;	/*Set the cType of the variable to which the parameter is bound*/
+
 	CHECK_ERROR&#40;sth, SQL_HANDLE_STMT, imp_sth-&gt;phstmt, ret, &#34;Bind Failed&#34;&#41;;
     	EOI&#40;ret&#41;;
 	
@@ -2541,10 +2558,16 @@
 			    		}
 #endif
 			    		else {
-				  		sv_setpvn&#40; phs-&gt;sv, phs-&gt;buffer, phs-&gt;indp &#41;;
-						if&#40; phs-&gt;indp &gt; phs-&gt;bufferSize &#41;
-					       		warn&#40; &#34;Output buffer too small, data truncated &#34;
-						  			&#34;for parameter &#39;%s&#39;&#34;, key &#41;;
+						if&#40; phs-&gt;cType == SQL_C_LONG || phs-&gt;cType == SQL_C_SHORT &#41; {
+                                                        sv_setiv&#40;phs-&gt;sv, phs-&gt;ivValue&#41;;
+                                                } else if&#40; phs-&gt;cType == SQL_C_DOUBLE || phs-&gt;cType == SQL_C_FLOAT &#41; {
+                                                        sv_setnv&#40;phs-&gt;sv, phs-&gt;dblValue&#41;;
+                                                } else {
+                                                        sv_setpvn&#40; phs-&gt;sv, phs-&gt;buffer, phs-&gt;indp &#41;;
+							if&#40; phs-&gt;indp &gt; phs-&gt;bufferSize &#41;
+					       			warn&#40; &#34;Output buffer too small, data truncated &#34;
+						  				&#34;for parameter &#39;%s&#39;&#34;, key &#41;;
+						}
 			    		}
 		      		}
 			}
--- 1.80/dbdimp.h	Mon Jan 25 13:28:01 2010
+++ 1.80Ppatch/dbdimp.h	Thu Apr 07 14:04:39 2011
@@ -105,12 +105,15 @@
 	void        *buffer;              /* input and output buffer                */
 	int          bufferSize;          /* size of buffer                         */
 	SQLUSMALLINT paramType;           /* INPUT, OUTPUT or INPUT_OUTPUT          */
+   SQLSMALLINT cType;               /* The parameter cType                    */
 	SQLINTEGER   indp;                /* null indicator or length indicator     */
 	int          bDescribed;          /* already described this parameter       */
 	int          bDescribeOK;         /* describe was successful                */
 	SQLSMALLINT  descSQLType;                                      
 	SQLSMALLINT  descDecimalDigits;                                
 	SQLUINTEGER  descColumnSize;                                   
+	IV	     ivValue;		 /*integer variable to hold the bound output value */
+	double	     dblValue;           /*double variable to hold the bound output value*/
 };
 
 #define dbd_init            db2_init
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-925068" href="/Public/Bug/Display.html?id=42185#txn-925068">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;19&nbsp;00:19:09&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Ticket deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-925069" href="/Public/Bug/Display.html?id=42185#txn-925069">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;19&nbsp;00:19:13&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Status changed from &#39;deleted&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-927826" href="/Public/Bug/Display.html?id=42185#txn-927826">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;25&nbsp;13:34:12&nbsp;2011</span>
    <span class="description">don.silvia+pause [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/927826/481492/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/481492">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 518b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks Praveen, this has fixed the issue for me.  My test environment:

[~]$ perl -v

This is perl 5, version 12, subversion 3 &#40;v5.12.3&#41; built for sun4-solaris

[~]$ db2level
DB21085I  Instance &#34;db2cld1&#34; uses &#34;64&#34; bits and DB2 code release &#34;SQL09054&#34; 
with level identifier &#34;06050107&#34;.
Informational tokens are &#34;DB2 v9.5.0.4&#34;, &#34;s090429&#34;, &#34;U825479&#34;, and Fix Pack 
&#34;4&#34;.


On Tue Apr 19 00:18:50 2011, IBMTORDB2 wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; Find attached below the patch file. Let me know if you are still facing
&gt; any difficulty.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-952182" href="/Public/Bug/Display.html?id=42185#txn-952182">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;03&nbsp;10:47:23&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/952182/495246/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/495246">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 160b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fix available in release 1.81. Marking the issue resolved.
-- 
Thanks
Praveen
IBM OpenSource Application Development Team
India Software Labs, Bangalore &#40;India&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-952184" href="/Public/Bug/Display.html?id=42185#txn-952184">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;03&nbsp;10:47:25&nbsp;2011</span>
    <span class="description">opendev [...] us.ibm.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.796305</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
