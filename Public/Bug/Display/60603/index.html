<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #60603 for Chart-Clicker: Labels on Axis near beginning/end</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #60603 for Chart-Clicker: Labels on Axis near beginning/end</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Chart-Clicker/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Chart-Clicker/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Chart-Clicker/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Chart-Clicker/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/gphat/chart-clicker/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Chart-Clicker">Chart-Clicker CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">60603</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Chart-Clicker/Active/">Chart-Clicker</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rod.taylor [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39472-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.65    </td>
  </tr>
  <tr id="CF-39473-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;20:27:55&nbsp;2010</span>
    <span class="description">rod.taylor [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Labels on Axis near beginning/end</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Labels at the beginning and end of an axis had special rendering code to
nudge the label into full view.

Manually created labels which may be very close to the edge, but not
exactly lower&#40;&#41; or upper&#40;&#41; did not receive the same treatment.

Now they do. Instead of looking at the value it now looks at the
position relative to the bounding box and nudges it accordingly.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Chart_Clicker_Axis__scale_rendering.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">*** ./lib/Chart/Clicker/Axis.pm.orig	2010-08-21 19:47:14.000000000 -0400
--- ./lib/Chart/Clicker/Axis.pm	2010-08-21 20:22:05.000000000 -0400
***************
*** 335,367 ****
              my $iy = $height - $mark;
              my $label = $self-&gt;get_component&#40;$comp_count&#41;;
  
              if&#40;$self-&gt;is_left&#41; {
                  $label-&gt;origin-&gt;x&#40;$iox + $iwidth - $label-&gt;width&#41;;
-                 if&#40;$val == $lower&#41; {
-                     # The first label &#40;being at the bottom&#41; needs to be
-                     # skooched up a bit to fit.
-                     $label-&gt;origin-&gt;y&#40;$iy - $label-&gt;height&#41;;
-                 } elsif&#40;$val == $upper&#41; {
-                     # The last label &#40;being at the top&#41; can be positioned
-                     # exactly at the mark.
-                     $label-&gt;origin-&gt;y&#40;$iy&#41;;
-                 } else {
-                     $label-&gt;origin-&gt;y&#40;$iy - &#40;$label-&gt;height / 2&#41;&#41;;
-                 }
              } else {
- 
                  $label-&gt;origin-&gt;x&#40;$iox&#41;;
-                 if&#40;$val == $lower&#41; {
-                     # The first label &#40;being at the bottom&#41; needs to be
-                     # skooched up a bit to fit.
-                     $label-&gt;origin-&gt;y&#40;$iy - $label-&gt;height&#41;;
-                 } elsif&#40;$val == $upper&#41; {
-                     # The last label &#40;being at the top&#41; can be positioned
-                     # exactly at the mark.
-                     $label-&gt;origin-&gt;y&#40;$iy&#41;;
-                 } else {
-                     $label-&gt;origin-&gt;y&#40;$iy - &#40;$label-&gt;height / 2&#41;&#41;;
-                 }
              }
              # Keep track of how many components we&#39;ve actually grabbed, since
              # we could be skipping any that are in a skip range.
--- 335,362 ----
              my $iy = $height - $mark;
              my $label = $self-&gt;get_component&#40;$comp_count&#41;;
  
+             # Adjust text on the Y axis to fit when it is
+             # too close to the edges
+ 			my $standardYOrigin = $iy - &#40;$label-&gt;height / 2&#41;;
+             #my $lowerYOrigin = $iy - $label-&gt;height;
+             my $lowerYOrigin = $ioy + $iheight - $label-&gt;height;
+             my $upperYOrigin = $ioy;
+             if&#40;$standardYOrigin &gt;= $lowerYOrigin&#41; {
+                 # The first label &#40;being at the bottom&#41; needs to be
+                 # skooched up a bit to fit.
+                 $label-&gt;origin-&gt;y&#40;$lowerYOrigin&#41;;
+             } elsif&#40;$standardYOrigin &lt;= $upperYOrigin&#41; {
+                 # The last label &#40;being at the top&#41; can be positioned
+                 # exactly at the mark.
+                 $label-&gt;origin-&gt;y&#40;$upperYOrigin&#41;;
+             } else {
+                 $label-&gt;origin-&gt;y&#40;$standardYOrigin&#41;;
+             }
+ 
              if&#40;$self-&gt;is_left&#41; {
                  $label-&gt;origin-&gt;x&#40;$iox + $iwidth - $label-&gt;width&#41;;
              } else {
                  $label-&gt;origin-&gt;x&#40;$iox&#41;;
              }
              # Keep track of how many components we&#39;ve actually grabbed, since
              # we could be skipping any that are in a skip range.
***************
*** 400,423 ****
                  }
              }
  
!             if&#40;$self-&gt;is_top&#41; {
  
!                 if&#40;$val == $lower&#41; {
!                     $label-&gt;origin-&gt;x&#40;$ix&#41;;
!                 } elsif&#40;$val == $upper&#41; {
!                     $label-&gt;origin-&gt;x&#40;$ix - $label-&gt;width&#41;;
!                 } else {
!                     $label-&gt;origin-&gt;x&#40;$ix - &#40;$label-&gt;width / 1.8&#41;&#41;;
!                 }
                  $label-&gt;origin-&gt;y&#40;$ioy + $iheight - $label-&gt;height - $bump&#41;;
              } else {
-                 if&#40;$val == $lower&#41; {
-                     $label-&gt;origin-&gt;x&#40;$ix&#41;;
-                 } elsif&#40;$val == $upper&#41; {
-                     $label-&gt;origin-&gt;x&#40;$ix - $label-&gt;width&#41;;
-                 } else {
-                     $label-&gt;origin-&gt;x&#40;$ix - &#40;$label-&gt;width / 1.8&#41;&#41;;
-                 }
                  $label-&gt;origin-&gt;y&#40;$ioy + $bump&#41;;
              }
              # Keep track of how many components we&#39;ve actually grabbed, since
--- 395,416 ----
                  }
              }
  
!             # Adjust the X-origin value to ensure it is within the graph
!             # and does not get snipped when too close to the edge.
!             my $standardXOrigin = $ix - &#40;$label-&gt;width / 1.8&#41;;
!             my $lowerXOrigin = $iox;
!             my $upperXOrigin = $iox + $iwidth - $label-&gt;width;
!             if&#40;$standardXOrigin &lt;= $lowerXOrigin&#41; {
!                 $label-&gt;origin-&gt;x&#40;$lowerXOrigin&#41;;
!             } elsif&#40;$standardXOrigin &gt;= $upperXOrigin&#41; {
!                 $label-&gt;origin-&gt;x&#40;$upperXOrigin&#41;;
!             } else {
!                 $label-&gt;origin-&gt;x&#40;$standardXOrigin&#41;;
!             }
  
!             if&#40;$self-&gt;is_top&#41; {
                  $label-&gt;origin-&gt;y&#40;$ioy + $iheight - $label-&gt;height - $bump&#41;;
              } else {
                  $label-&gt;origin-&gt;y&#40;$ioy + $bump&#41;;
              }
              # Keep track of how many components we&#39;ve actually grabbed, since
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;20:41:03&nbsp;2010</span>
    <span class="description">gphat [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Applied to master on github.  Hanging onto it for a bit, as you have some other pending patches.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;20:41:04&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;21&nbsp;20:41:04&nbsp;2010</span>
    <span class="description">gphat [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
