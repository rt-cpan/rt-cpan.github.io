<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #117084 for Flickr-Upload: OAuth authentication</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #117084 for Flickr-Upload: OAuth authentication</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Flickr-Upload">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Flickr-Upload">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Flickr-Upload">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Flickr-Upload">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Flickr-Upload">Flickr-Upload CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">117084</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Flickr-Upload">Flickr-Upload</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">SSEVERIN [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cpan [...] kensaku-yamaguchi.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-13680-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.51    </td>
  </tr>
  <tr id="CF-13681-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




0001-support-OAuth-authentication.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1660311/891237/0001-support-OAuth-authentication.patch">
Sun Aug 21 01:20:18 2016 (5.8k) by https://me.yahoo.co.jp/a/.s1jk4sXP4Xi_0fY7OJ2.u240qM0mg--#7c583
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=117084">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1660311" href="/Public/Bug/Display.html?id=117084#txn-1660311">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;21&nbsp;01:20:18&nbsp;2016</span>
    <span class="description">https://me.yahoo.co.jp/a/.s1jk4sXP4Xi_0fY7OJ2.u240qM0mg--#7c583 -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> OAuth authentication</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1660311/891236/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/891236">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 264b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Flickr::Upload requires the old Flickr Authentication API for user authentication, and does not, if I understand correctly, support OAuth.  The attached patch allows OAuth to be used to authenticate the user.  &#40;No OAuth support is added to flickr_upload, however.&#41;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0001-support-OAuth-authentication.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1660311/891237/0001-support-OAuth-authentication.patch">Download 0001-support-OAuth-authentication.patch</a><br />
<span class="downloadcontenttype">text/x-diff 5.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From a5d3f8ab49934cbb446bde59245910c3218c23da Mon Sep 17 00:00:00 2001
From: Kensaku Yamaguchi &lt;cpan@kensaku-yamaguchi.org&gt;
Date: Sun, 21 Aug 2016 10:23:47 +0900
Subject: [PATCH] support OAuth authentication

---
 lib/Flickr/Upload.pm | 78 +++++++++++++++++++++++++++++++++++++++++++++-------
 t/oauth.t            | 21 ++++++++++++++
 2 files changed, 89 insertions&#40;+&#41;, 10 deletions&#40;-&#41;
 create mode 100644 t/oauth.t

diff --git a/lib/Flickr/Upload.pm b/lib/Flickr/Upload.pm
index 3af07fd..0d7746e 100644
--- a/lib/Flickr/Upload.pm
+++ b/lib/Flickr/Upload.pm
@@ -5,6 +5,8 @@ use warnings;
 
 use LWP::UserAgent;
 use HTTP::Request::Common;
+use Net::OAuth;
+use URI::Escape;
 use Flickr::API;
 use XML::Simple qw&#40;:strict&#41;;
 use Digest::MD5 qw&#40;md5_hex&#41;;
@@ -45,15 +47,37 @@ Upload an image to L&lt;flickr.com&gt;.
 
 =head2 new
 
+=over
+
+=item Using Flickr Authentication
+
 	my $ua = Flickr::Upload-&gt;new&#40;
 		{
 			&#39;key&#39; =&gt; &#39;90909354&#39;,
 			&#39;secret&#39; =&gt; &#39;37465825&#39;
 		}&#41;;
 
-Instantiates a L&lt;Flickr::Upload&gt; instance. The C&lt;key&gt; argument is your
-API key and the C&lt;secret&gt; is the API secret associated with it. To get an
-API key and secret, go to L&lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://www.flickr.com/services/api/key.gne">https://www.flickr.com/services/api/key.gne</a></span>&gt;.
+=item Using OAuth Authentication
+
+	my $ua = Flickr::Upload-&gt;new&#40;
+		{
+			&#39;consumer_key&#39; =&gt; &#39;your_api_key&#39;,
+			&#39;consumer_secret&#39; =&gt; &#39;your_app_secret&#39;,
+		}&#41;;
+
+=item Retrieve saved configuration &#40;possibly including OAuth access token&#41;
+
+	my $config_file = &#34;$ENV{HOME}/saved-flickr.st&#34;;
+	my $ua = Flickr::Upload-&gt;import_storable_config&#40;$config_file&#41;;
+
+=back
+
+Instantiates a L&lt;Flickr::Upload&gt; instance, using either the Flickr
+Authentication or the OAuth Authentication. The C&lt;key&gt; or
+C&lt;consumer_key&gt; argument is your API key and the C&lt;secret&gt; or
+C&lt;consumer_secret&gt; argument is the API secret associated with it. To
+get an API key and secret, go to
+L&lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://www.flickr.com/services/api/key.gne">https://www.flickr.com/services/api/key.gne</a></span>&gt;.
 
 The resulting L&lt;Flickr::Upload&gt; instance is a subclass of L&lt;Flickr::API&gt;
 and can be used for any other Flickr API calls.  As such,
@@ -73,9 +97,14 @@ L&lt;Flickr::Upload&gt; is also a subclass of L&lt;LWP::UserAgent&gt;.
 
 Taking a L&lt;Flickr::Upload&gt; instance C&lt;$ua&gt; as an argument, this is
 basically a direct interface to the Flickr Photo Upload API. Required
-parameters are C&lt;photo&gt; and C&lt;auth_token&gt;.  Note that the C&lt;auth_token&gt;
-must have been issued against the API key and secret used to instantiate
-the uploader.
+parameters are C&lt;photo&gt; and, when using Flickr Authentication,
+C&lt;auth_token&gt;.  Note that the C&lt;auth_token&gt; must have been issued
+against the API key and secret used to instantiate the uploader.
+
+When using OAuth, C&lt;auth_token&gt; is not required, and the
+L&lt;Flickr::Upload&gt; instance must instead contain a valid L&lt;Net::OAuth&gt;
+access token which can be added by calling the L&lt;Flickr::API&gt;
+C&lt;oauth_access_token&gt; method.
 
 Returns the resulting identifier of the uploaded photo on success,
 C&lt;undef&gt; on failure. According to the API documentation, after an upload the
@@ -97,7 +126,7 @@ sub upload {
 
 	# these are the only things _required_ by the uploader.
 	die &#34;Can&#39;t read photo &#39;$args{&#39;photo&#39;}&#39;&#34; unless $args{&#39;photo&#39;} and -f $args{&#39;photo&#39;};
-	die &#34;Missing &#39;auth_token&#39;&#34; unless defined $args{&#39;auth_token&#39;};
+	die &#34;Missing &#39;auth_token&#39;&#34; unless $self-&gt;is_oauth or defined $args{&#39;auth_token&#39;};
 
 	# create a request object and execute it
 	my $req = $self-&gt;make_upload_request&#40; %args &#41;;
@@ -196,7 +225,11 @@ sub make_upload_request {
 	my %args = @_;
 
 	# _required_ by the uploader.
-	die &#34;Missing &#39;auth_token&#39; argument&#34; unless $args{&#39;auth_token&#39;};
+	unless &#40;$self-&gt;is_oauth&#41; {
+		die &#34;Missing &#39;auth_token&#39; argument&#34; unless $args{&#39;auth_token&#39;};
+	} else {
+		croak &#34;OAuth access token needed&#34; unless defined $self-&gt;{oauth}-&gt;{token};
+	}
 
 	my $uri = $args{&#39;uri&#39;} || &#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://api.flickr.com/services/upload/&#39;">https://api.flickr.com/services/upload/&#39;</a></span>;
 
@@ -205,13 +238,38 @@ sub make_upload_request {
 
 	# Flickr::API includes this with normal requests, but we&#39;re building a custom
 	# message.
-	$args{&#39;api_key&#39;} = $self-&gt;{&#39;api_key&#39;};
+	$args{&#39;api_key&#39;} = $self-&gt;{&#39;api_key&#39;} unless $self-&gt;is_oauth;
 
 	# photo is _not_ included in the sig
 	my $photo = $args{photo};
 	delete $args{photo};
 
-	$args{&#39;api_sig&#39;} = $self-&gt;_sign_args&#40;\%args&#41;;
+	unless&#40; $self-&gt;is_oauth &#41; {
+		$args{&#39;api_sig&#39;} = $self-&gt;_sign_args&#40;\%args&#41;;
+	} else {
+		my %oauth = &#40;
+			&#39;nonce&#39;			=&gt; $self-&gt;_make_nonce&#40;&#41;,
+			&#39;consumer_key&#39;		=&gt; $self-&gt;{oauth}-&gt;{consumer_key},
+			&#39;consumer_secret&#39;	=&gt; $self-&gt;{oauth}-&gt;{consumer_secret},
+			&#39;timestamp&#39;		=&gt; time,
+			&#39;signature_method&#39;	=&gt; $self-&gt;{oauth}-&gt;{signature_method},
+			&#39;version&#39;		=&gt; $self-&gt;{oauth}-&gt;{version},
+			&#39;token&#39;			=&gt; $self-&gt;{oauth}-&gt;{token},
+			&#39;token_secret&#39;		=&gt; $self-&gt;{oauth}-&gt;{token_secret},
+		&#41;;
+		$oauth{extra_params} = \%args;
+		$oauth{request_method} = &#39;POST&#39;;
+		$oauth{request_url} = $uri;
+		$Net::OAuth::PROTOCOL_VERSION = Net::OAuth::PROTOCOL_VERSION_1_0A;
+		my $req = Net::OAuth-&gt;request&#40; &#34;protected resource&#34; &#41;-&gt;new&#40; %oauth &#41;;
+		$req-&gt;sign&#40;&#41;;
+		my $tmp_body = $req-&gt;to_post_body&#40;&#41;;
+		%args = &#40;&#41;;
+		foreach &#40;split &#39;&#38;&#39;, $tmp_body&#41; {
+			my &#40;$name, $val&#41; = split &#39;=&#39;, $_, 2;
+			$args{$name} = URI::Escape::uri_unescape&#40; $val &#41;;
+		}
+	}
 
 	# unlikely that the caller would set up the photo as an array,
 	# but...
diff --git a/t/oauth.t b/t/oauth.t
new file mode 100644
index 0000000..2d7152f
--- /dev/null
+++ b/t/oauth.t
@@ -0,0 +1,21 @@
+use Test::More qw&#40;no_plan&#41;;
+BEGIN { use_ok&#40;&#39;Flickr::Upload&#39;&#41; };
+
+# Load saved configuration including access token. If none, fail nicely.
+my $saved_config = &#39;t/saved_config&#39;;
+-r $saved_config or &#40;print STDERR &#34;No stored Flickr::API config file\n&#34; &#38;&#38; exit 0&#41;;
+my $ua = Flickr::Upload-&gt;import_storable_config&#40;$saved_config&#41;;
+ok&#40;defined $ua&#41;;
+
+my $rc = $ua-&gt;upload&#40;
+	&#39;photo&#39; =&gt; &#39;t/testimage.jpg&#39;,
+	&#39;tags&#39; =&gt; &#34;test kernel perl cat dog&#34;,
+	&#39;description&#39; =&gt; &#34;Flickr Upload test for $0&#34;,
+	&#39;is_public&#39; =&gt; 0,
+	&#39;is_friend&#39; =&gt; 0,
+	&#39;is_family&#39; =&gt; 0,
+&#41;;
+
+ok&#40; defined $rc &#41;;
+
+exit 0;
-- 
2.1.4

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1660474" href="/Public/Bug/Display.html?id=117084#txn-1660474">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;21&nbsp;14:50:51&nbsp;2016</span>
    <span class="description">SSEVERIN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1660474/891330/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/891330">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 901b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks so much for sending this in, Kensaku. I&#39;m reviewing your patch now, and I&#39;ll plan to get a new release out in the next couple of days.

The only issue I see at a glance is that Flickr::Upload&#39;s flickr_upload tool is already using ~/.flickrrc to store authentication information and other settings. This is at odds with your patch &#40;and Flickr::API&#41;, which use, or at least suggest, ~/saved-flickr.st. I think this filename is a bit of an odd choice, but I haven&#39;t yet thought through the pros and cons.

Cheers,
-Steve

On Sun Aug 21 01:20:18 2016, <span class="clickylink"><a target="new" rel="nofollow" href="https://me.yahoo.co.jp/a/.s1jk4sXP4Xi_0fY7OJ2.u240qM0mg--#7c583">https://me.yahoo.co.jp/a/.s1jk4sXP4Xi_0fY7OJ2.u240qM0mg--#7c583</a></span> wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Flickr::Upload requires the old Flickr Authentication API for user
&gt; authentication, and does not, if I understand correctly, support
&gt; OAuth.  The attached patch allows OAuth to be used to authenticate the
&gt; user.  &#40;No OAuth support is added to flickr_upload, however.&#41;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1660475" href="/Public/Bug/Display.html?id=117084#txn-1660475">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;21&nbsp;14:50:51&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1660478" href="/Public/Bug/Display.html?id=117084#txn-1660478">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;21&nbsp;14:50:52&nbsp;2016</span>
    <span class="description">SSEVERIN [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1660653" href="/Public/Bug/Display.html?id=117084#txn-1660653">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;00:07:35&nbsp;2016</span>
    <span class="description">cpan [...] kensaku-yamaguchi.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #117084] OAuth authentication</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 22 Aug 2016 13:07:12 +0900</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Flickr-Upload [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kensaku Yamaguchi &lt;cpan [...] kensaku-yamaguchi.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1660653/891410/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/891410">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Steve, and thank you for looking at the patch.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [...] This is at odds with your patch &#40;and Flickr::API&#41;, which use, or at least suggest, ~/saved-flickr.st. I think this filename is a bit of an odd choice, but I haven&#39;t yet thought through the pros and cons.
</div>
The name ~/saved-flickr.st is from the documentation for Flickr::API, in SYNOPSIS, &#34;Authenticate an OAuth API Object starting with saved configuration.&#34;
The author appears to suggest the use of export_storable_config/import_storable_config to store access token information, which is different from the way flickr_upload uses .flickrrc.
The file name in the documentation is obviously an example.

I haven&#39;t actually considered how flickr_upload might read OAuth access token information from .flickrrc.
Maybe it can read &#34;token&#34; and &#34;token_secret&#34; as two separate strings and construct a Net::OAuth Access Token object from those strings, or maybe it can read the information from a separate file containing the return value of export_config.

Best regards,
Kensaku Yamaguchi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1660863" href="/Public/Bug/Display.html?id=117084#txn-1660863">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;14:19:14&nbsp;2016</span>
    <span class="description">SSEVERIN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1660863/891514/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/891514">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 686b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It would be ideal if flickr_upload could use the same storage as Flickr::API, but it would be a nontrivial change to switch to Storable, which would make .flickrrc no longer readily editable. Maybe I need to have flickr_upload store the OAuth data using export_storable_config in a separate file, something like ~/.flickroauth.

I gather that the command-line flickr_upload tool is not something you&#39;re using, but I would like to enable OAuth through that tool at the same time I release support via the Flickr::Upload API. I do see that Flickr::API&#39;s synopsis contains template code for performing the initial OAuth setup, so I should be able to get this done quickly.

Regards,
-Steve
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1660942" href="/Public/Bug/Display.html?id=117084#txn-1660942">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;17:02:50&nbsp;2016</span>
    <span class="description">SSEVERIN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1660942/891557/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/891557">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 512b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Okay, I have a working command-line process to step you through OAuth write-access authorization and save the resulting credentials in ~/.flickroauth.st. I&#39;ve set it up to check for the old authentication method first, and if that fails, check for OAuth credentials. I&#39;ll need to tidy it up a bit, do some error checking, and write a bit of documentation, but I think it will be usable.

Thanks again for your patch and communication regarding it. I should be able to get a release out tomorrow.

Regards,
-Steve
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1661014" href="/Public/Bug/Display.html?id=117084#txn-1661014">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;22&nbsp;21:05:58&nbsp;2016</span>
    <span class="description">https://me.yahoo.co.jp/a/.s1jk4sXP4Xi_0fY7OJ2.u240qM0mg--#7c583 -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> cpan [...] kensaku-yamaguchi.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1661014/891587/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/891587">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 298b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yes, I used only the module and not the flickr_upload tool, so I did not have enough familiarity with the tool to suggest changes to it in the patch.  Thank you for working on this.  FWIW my feeling is that your solution for flickr_upload is completely reasonable.

Best regards,
Kensaku Yamaguchi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1661230" href="/Public/Bug/Display.html?id=117084#txn-1661230">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;23&nbsp;13:17:12&nbsp;2016</span>
    <span class="description">SSEVERIN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1661230/891686/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/891686">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 80b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve pushed the code to Github, and I&#39;ll look again at the photo-as-array issue.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1661233" href="/Public/Bug/Display.html?id=117084#txn-1661233">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;23&nbsp;13:17:13&nbsp;2016</span>
    <span class="description">SSEVERIN [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.561525</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
