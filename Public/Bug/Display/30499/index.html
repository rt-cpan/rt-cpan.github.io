<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #30499 for Mail-Box: Mail-Box-2.076 &gt; Mail::Transport::IMAP4</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #30499 for Mail-Box: Mail-Box-2.076 &gt; Mail::Transport::IMAP4</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Mail-Box">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Mail-Box">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Mail-Box">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Mail-Box">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Mail-Box">Mail-Box CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">30499</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Mail-Box">Mail-Box</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
kecskemetizsolt [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19874-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19875-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=30499">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-379342" href="/Public/Bug/Display.html?id=30499#txn-379342">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;05&nbsp;10:55:17&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 5 Nov 2007 15:54:48 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/379342/173503/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/173503">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Package: Mail-Box-2.076 &gt;  Mail::Transport::IMAP4

Auth type NTLM is mistyped as ntml both in variable name
$ntml_installed &#40;used in lines 61, 66, 69, 79&#41; and more importantly in
a require statement &#34;require Authen::NTML&#34; in line 67.

Change both to NTLM for clarity and to fix the error when trying to
use auth type NTLM in an IMAP4 connection.

Regards,
Zsolt Kecskemeti


patch------------------------------------------
61c61
&lt; our $ntlm_installed;
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; our $ntml_installed;
</div>66,69c66,69
&lt;     unless&#40;defined $ntlm_installed&#41;
&lt;     {   eval &#34;require Authen::NTLM&#34;;
&lt;         die &#34;NTLM errors:\n$@&#34; if $@ &#38;&#38; $@ !~ /Can&#39;t locate/;
&lt;         $ntlm_installed = ! $@;
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     unless&#40;defined $ntml_installed&#41;
&gt;     {   eval &#34;require Authen::NTML&#34;;
&gt;         die &#34;NTML errors:\n$@&#34; if $@ &#38;&#38; $@ !~ /Can&#39;t locate/;
&gt;         $ntml_installed = ! $@;
</div>79c79
&lt;     {   @types = &#40;&#39;CRAM-MD5&#39;, &#40;$ntlm_installed ? &#39;NTLM&#39; : &#40;&#41;&#41;, &#39;PLAIN&#39;&#41;;
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     {   @types = &#40;&#39;CRAM-MD5&#39;, &#40;$ntml_installed ? &#39;NTLM&#39; : &#40;&#41;&#41;, &#39;PLAIN&#39;&#41;;
</div>endofpatch------------------------------------------
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-379345" href="/Public/Bug/Display.html?id=30499#txn-379345">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;05&nbsp;11:02:56&nbsp;2007</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/379345/173506/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/173506">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 159b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I never use Windows environments, so couldn&#39;t test my poor copy
work.  Would be nice if you could try it with the Mail::IMAPClient
development version 2.99_03.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-379346" href="/Public/Bug/Display.html?id=30499#txn-379346">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;05&nbsp;11:02:59&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-379348" href="/Public/Bug/Display.html?id=30499#txn-379348">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;05&nbsp;11:03:00&nbsp;2007</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-393577" href="/Public/Bug/Display.html?id=30499#txn-393577">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;13&nbsp;13:21:02&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 13 Dec 2007 18:20:40 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/393577/181190/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181190">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 877b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark,

Sorry, I have forgotten about testing this as we have abandoned using
Mail::Box for IMAP4 connections.

But now we are trying to get it working again using 3.02 of
Mail::IMAPClient. It works great, but there is a small thing I have noticed.

In Mail::Transport::IMAP4::createImapClient&#40;&#41; parameters timeout, retry, etc
are not passed to Mail::IMAPClient object when you create it. One way to do
this would be to pass $args to createImapClient&#40;&#41; in init&#40;&#41; and then pass
those over in the line my $client = $class-&gt;new&#40;&#41;;

Best regards,
Zsolt Kecskemeti





On Nov 5, 2007 4:02 PM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt;
wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; I never use Windows environments, so couldn&#39;t test my poor copy
&gt; work.  Would be nice if you could try it with the Mail::IMAPClient
&gt; development version 2.99_03.
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/393577/181191/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181191">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-393578" href="/Public/Bug/Display.html?id=30499#txn-393578">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;13&nbsp;13:21:05&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394222" href="/Public/Bug/Display.html?id=30499#txn-394222">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;04:40:39&nbsp;2007</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/394222/181386/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181386">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 322b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yes, that is by design.
Mail::IMAPClient &#40;which I have taken over from the original author
meanwhile&#41; has a zillion of options.  I do not want to merge them
with my own few.  Therefore, if you want to do anything complicated
with the IMAPClient &#40;and probably you will&#41;, you have to create one
manually.  This is by design.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394224" href="/Public/Bug/Display.html?id=30499#txn-394224">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;04:40:41&nbsp;2007</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394226" href="/Public/Bug/Display.html?id=30499#txn-394226">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;05:29:17&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Dec 2007 10:28:40 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org, bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/394226/181389/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181389">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark,

Well, I would not call passing a few parameters you already have in
Mail::Transport::IMAP4 complicated but if it is a design choice, fine,
no problems there. Of course, I would not bother with the zillion
other ones in IMAPClient either.

There is one other thing I have come across &#40;this is related to IMAPClient&#41;:

I would like to use an IMAP4 mailbox as a backup mailbox. The live
mailbox accepts specific incoming messages, processes them and then I
want to move them to the backup mailbox by using moveMessage. It was
actually working while I was experimenting with it using 2.2.9 but I
know that this might have been rewritten since.

I can connect to the mailbox but when I am calling
$mgr-&gt;moveMessage&#40;$backup_mailbox_folder, $current_msg&#41;; I get the
following:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">--------------debug output start-----------------
DEBUG: Folder INBOX already selected.
DEBUG: Sending: 7 UID SEARCH ALL

DEBUG: Sent 18 bytes

DEBUG: Read: * SEARCH 1 2

      7 OK SEARCH completed.

DEBUG: Sending: 8 UID FETCH 1:2 FLAGS

DEBUG: Sent 23 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      8 OK FETCH completed.

DEBUG: flags: line = &#39;8 UID FETCH 1:2 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;8 OK FETCH completed.
  &#39;

Use of uninitialized value in hash element at
/usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line 1863, &lt;GEN0&gt;
line 120.
        &#40;in cleanup&#41; Can&#39;t use an undefined value as an ARRAY
reference at /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line
1864, &lt;GEN0&gt; line 120.

<div class="message-stanza open">--------------debug output end-----------------

I don&#39;t really know if it is a bug, or it is me doing something wrong.

Regards,
Zsolt Kecskemeti



On Dec 14, 2007 9:40 AM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; Yes, that is by design.
&gt; Mail::IMAPClient &#40;which I have taken over from the original author
&gt; meanwhile&#41; has a zillion of options.  I do not want to merge them
&gt; with my own few.  Therefore, if you want to do anything complicated
&gt; with the IMAPClient &#40;and probably you will&#41;, you have to create one
&gt; manually.  This is by design.
&gt;
</div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394227" href="/Public/Bug/Display.html?id=30499#txn-394227">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;05:29:17&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Dec 2007 10:28:40 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org, bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/394227/181390/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181390">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark,

Well, I would not call passing a few parameters you already have in
Mail::Transport::IMAP4 complicated but if it is a design choice, fine,
no problems there. Of course, I would not bother with the zillion
other ones in IMAPClient either.

There is one other thing I have come across &#40;this is related to IMAPClient&#41;:

I would like to use an IMAP4 mailbox as a backup mailbox. The live
mailbox accepts specific incoming messages, processes them and then I
want to move them to the backup mailbox by using moveMessage. It was
actually working while I was experimenting with it using 2.2.9 but I
know that this might have been rewritten since.

I can connect to the mailbox but when I am calling
$mgr-&gt;moveMessage&#40;$backup_mailbox_folder, $current_msg&#41;; I get the
following:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">--------------debug output start-----------------
DEBUG: Folder INBOX already selected.
DEBUG: Sending: 7 UID SEARCH ALL

DEBUG: Sent 18 bytes

DEBUG: Read: * SEARCH 1 2

      7 OK SEARCH completed.

DEBUG: Sending: 8 UID FETCH 1:2 FLAGS

DEBUG: Sent 23 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      8 OK FETCH completed.

DEBUG: flags: line = &#39;8 UID FETCH 1:2 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;8 OK FETCH completed.
  &#39;

Use of uninitialized value in hash element at
/usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line 1863, &lt;GEN0&gt;
line 120.
        &#40;in cleanup&#41; Can&#39;t use an undefined value as an ARRAY
reference at /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line
1864, &lt;GEN0&gt; line 120.

<div class="message-stanza open">--------------debug output end-----------------

I don&#39;t really know if it is a bug, or it is me doing something wrong.

Regards,
Zsolt Kecskemeti



On Dec 14, 2007 9:40 AM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; Yes, that is by design.
&gt; Mail::IMAPClient &#40;which I have taken over from the original author
&gt; meanwhile&#41; has a zillion of options.  I do not want to merge them
&gt; with my own few.  Therefore, if you want to do anything complicated
&gt; with the IMAPClient &#40;and probably you will&#41;, you have to create one
&gt; manually.  This is by design.
&gt;
</div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394228" href="/Public/Bug/Display.html?id=30499#txn-394228">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;05:29:23&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394229" href="/Public/Bug/Display.html?id=30499#txn-394229">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;05:29:23&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394241" href="/Public/Bug/Display.html?id=30499#txn-394241">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;05:53:24&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Dec 2007 11:52:53 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Zsolt Kecskemeti via RT &lt;bug-Mail-Box [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/394241/181396/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181396">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 818b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071214 10:29]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Use of uninitialized value in hash element at
&gt; /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line 1863, &lt;GEN0&gt;
&gt; line 120.
&gt;         &#40;in cleanup&#41; Can&#39;t use an undefined value as an ARRAY
&gt; reference at /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line
&gt; 1864, &lt;GEN0&gt; line 120.
</div>
Probably I am doing something wrong.  Which version of Mail::IMAPClient
are you using?  I made a fix for a FETCH problem in 3.02.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-394244" href="/Public/Bug/Display.html?id=30499#txn-394244">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;14&nbsp;06:05:48&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 Dec 2007 11:05:28 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/394244/181399/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181399">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The version is 3.02. Can I have a patch for that fix?

Regards,
Zsolt

On Dec 14, 2007 10:53 AM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; * Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071214 10:29]:
<div class="message-stanza open">&gt; &gt; Use of uninitialized value in hash element at
&gt; &gt; /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line 1863, &lt;GEN0&gt;
&gt; &gt; line 120.
&gt; &gt;         &#40;in cleanup&#41; Can&#39;t use an undefined value as an ARRAY
&gt; &gt; reference at /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line
&gt; &gt; 1864, &lt;GEN0&gt; line 120.
</div>&gt;
&gt; Probably I am doing something wrong.  Which version of Mail::IMAPClient
&gt; are you using?  I made a fix for a FETCH problem in 3.02.
&gt; --
&gt; Regards,
&gt;                MarkOv
&gt;
&gt; ------------------------------------------------------------------------
&gt;        Mark Overmeer MSc                                MARKOV Solutions
&gt;        Mark@Overmeer.net                          solutions@overmeer.net
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-395142" href="/Public/Bug/Display.html?id=30499#txn-395142">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;17&nbsp;05:00:33&nbsp;2007</span>
    <span class="description">website [...] craneveer.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Dec 2007 11:00:03 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Zsolt Kecskemeti via RT &lt;bug-Mail-Box [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;website [...] craneveer.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/395142/181836/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181836">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1016b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071214 11:05]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Mail-Box
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt; 
&gt; The version is 3.02. Can I have a patch for that fix?
</div>
I have tried to trace the error &#34;dry&#34;, but are not able to find
a flaw in the path between MailBox and IMAPClient yet.  Could
you try the following for me &#40;in Mail/IMAPClient.pm&#41;:

    sub flags
    {   my &#40;$self, $msgspec&#41; = &#40;shift, shift&#41;;
  + defined $msgspec or confess;
        my $msg
          = UNIVERSAL::isa&#40;$msgspec, &#39;Mail::IMAPClient::MessageSet&#39;&#41;
          ? $msgspec
          : $self-&gt;Range&#40;$msgspec&#41;;

The stack-trace probably helps my investigation.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-395155" href="/Public/Bug/Display.html?id=30499#txn-395155">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;17&nbsp;06:18:49&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Dec 2007 11:18:23 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/395155/181845/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181845">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark,

Somehow Carp does not want to produce trace with confess, actually it
just dies on it with no output whatsoever.

With print Carp::longmess I get the following:

DEBUG: Folder INBOX already selected.
DEBUG: Sending: 5 UID FETCH 1 FLAGS

DEBUG: Sent 21 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      5 OK FETCH completed.

DEBUG: flags: line = &#39;5 UID FETCH 1 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;5 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
DEBUG: Sending: 6 UID FETCH 2 FLAGS

DEBUG: Sent 21 bytes

DEBUG: Read: * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      6 OK FETCH completed.

DEBUG: flags: line = &#39;6 UID FETCH 2 FLAGS&#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;6 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
 at /usr/lib/perl5/site_perl/5.8.5/Mail/Transport/IMAP4.pm line 337
        Mail::Transport::IMAP4::getFlags&#40;&#39;Mail::Transport::IMAP4=HASH&#40;0xa1ea31c&#41;&#39;,
&#39;undef&#39;&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4/Message.pm line 66
        Mail::Box::IMAP4::Message::label&#40;&#39;Mail::Box::IMAP4::Message=HASH&#40;0xa274ad0&#41;&#39;,
&#39;deleted&#39;&#41; called at /usr/lib/perl5/site_perl/5.8.5/Mail/Message.pm
line 413
        Mail::Message::isDeleted&#40;&#39;Mail::Box::IMAP4::Message=HASH&#40;0xa274ad0&#41;&#39;&#41;
called at /usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 440
        Mail::Box::isModified&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa1e293c&#41;&#39;&#41;
called at /usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 348
        Mail::Box::close&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa1e293c&#41;&#39;&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4.pm line 114
        Mail::Box::IMAP4::close&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa1e293c&#41;&#39;&#41;
called at /usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 882
        Mail::Box::DESTROY&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa1e293c&#41;&#39;&#41; called
at perl/modules//ANS/Events/Event.pm line 326
        eval {...} called at perl/modules//ANS/Events/Event.pm line 326
        ANS::Events::Event::Ticket::MailProcessor::_execute_event&#40;&#39;ANS::Events::Event::Ticket::MailProcessor=HASH&#40;0xa1b8d28&#41;&#39;&#41;
called at perl/modules//ANS/Events/Event.pm line 326
        eval {...} called at perl/modules//ANS/Events/Event.pm line 290
        ANS::Events::Event::execute&#40;&#39;ANS::Events::Event::Ticket::MailProcessor=HASH&#40;0xa1b8d28&#41;&#39;&#41;
called at perl/scripts/event-handler-wrapper.pl line 78
DEBUG: Sending: 7 UID SEARCH ALL

DEBUG: Sent 18 bytes

DEBUG: Read: * SEARCH 1 2

      7 OK SEARCH completed.

DEBUG: Sending: 8 UID FETCH 1:2 FLAGS

DEBUG: Sent 23 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      8 OK FETCH completed.

DEBUG: flags: line = &#39;8 UID FETCH 1:2 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;8 OK FETCH completed.
  &#39;

Use of uninitialized value in hash element at
/usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line 1864.
        &#40;in cleanup&#41; Can&#39;t use an undefined value as an ARRAY
reference at /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line
1865.



Regards,
Zsolt Kecskemeti


On Dec 17, 2007 10:00 AM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; * Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071214 11:05]:
<div class="message-stanza open">&gt; &gt;        Queue: Mail-Box
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt; &gt;
&gt; &gt; The version is 3.02. Can I have a patch for that fix?
</div>&gt;
&gt; I have tried to trace the error &#34;dry&#34;, but are not able to find
&gt; a flaw in the path between MailBox and IMAPClient yet.  Could
&gt; you try the following for me &#40;in Mail/IMAPClient.pm&#41;:
&gt;
&gt;     sub flags
&gt;     {   my &#40;$self, $msgspec&#41; = &#40;shift, shift&#41;;
&gt;   + defined $msgspec or confess;
&gt;         my $msg
&gt;           = UNIVERSAL::isa&#40;$msgspec, &#39;Mail::IMAPClient::MessageSet&#39;&#41;
&gt;           ? $msgspec
&gt;           : $self-&gt;Range&#40;$msgspec&#41;;
&gt;
&gt; The stack-trace probably helps my investigation.
&gt; --
&gt;
&gt; Regards,
&gt;                MarkOv
&gt;
&gt; ------------------------------------------------------------------------
&gt;        Mark Overmeer MSc                                MARKOV Solutions
&gt;        Mark@Overmeer.net                          solutions@overmeer.net
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-395157" href="/Public/Bug/Display.html?id=30499#txn-395157">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;17&nbsp;06:45:32&nbsp;2007</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Dec 2007 12:44:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Zsolt Kecskemeti via RT &lt;bug-Mail-Box [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/395157/181847/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181847">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071217 11:18]:

This does clarify some things... the problem happens in &#34;DESTROY&#34;,
which is happening inside your eval
   on at perl/modules//ANS/Events/Event.pm line 326

Probably, something is going wrong during the initiation of the
message before it is completed.  The UID of the message is not
present yet, and therefore destructrion fails.

Try to change lib/Mail/Box/IMAP4/Message.pm

  sub label&#40;@&#41;
  {   my $self = shift;
      my $imap = $self-&gt;folder-&gt;transporter or return;
 -    my $id   = $self-&gt;unique;
 +    my $id   = $self-&gt;unique or return;

To avoid the erroneous path.  Hopefully, you get an error message now.
The trace was very useful.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-395160" href="/Public/Bug/Display.html?id=30499#txn-395160">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;17&nbsp;07:08:35&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 17 Dec 2007 12:06:39 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/395160/181850/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/181850">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Now it gets to writeDelayed but a similar error happens there:

DEBUG: Folder INBOX already selected.
DEBUG: Sending: 5 UID FETCH 1 FLAGS

DEBUG: Sent 21 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      5 OK FETCH completed.

DEBUG: flags: line = &#39;5 UID FETCH 1 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;5 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
DEBUG: Sending: 6 UID FETCH 2 FLAGS

DEBUG: Sent 21 bytes

DEBUG: Read: * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      6 OK FETCH completed.

DEBUG: flags: line = &#39;6 UID FETCH 2 FLAGS&#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;6 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
DEBUG: Folder INBOX already selected.
DEBUG: Folder INBOX already selected.
DEBUG: Sending: 7 UID FETCH 1 FLAGS

DEBUG: Sent 21 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      7 OK FETCH completed.

DEBUG: flags: line = &#39;7 UID FETCH 1 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;7 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
DEBUG: Sending: 8 UID FETCH 2 FLAGS

DEBUG: Sent 21 bytes

DEBUG: Read: * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      8 OK FETCH completed.

DEBUG: flags: line = &#39;8 UID FETCH 2 FLAGS&#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;8 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
DEBUG: Folder INBOX already selected.
DEBUG: Sending: 9 UID FETCH 1 FLAGS

DEBUG: Sent 21 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      9 OK FETCH completed.

DEBUG: flags: line = &#39;9 UID FETCH 1 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;9 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
DEBUG: Sending: 10 UID FETCH 2 FLAGS

DEBUG: Sent 22 bytes

DEBUG: Read: * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      10 OK FETCH completed.

DEBUG: flags: line = &#39;10 UID FETCH 2 FLAGS&#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;10 OK FETCH completed.
  &#39;

DEBUG: Folder INBOX already selected.
 at /usr/lib/perl5/site_perl/5.8.5/Mail/Transport/IMAP4.pm line 337
        Mail::Transport::IMAP4::getFlags&#40;&#39;Mail::Transport::IMAP4=HASH&#40;0xa9aa9ac&#41;&#39;,
&#39;undef&#39;&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4/Message.pm line 109
        Mail::Box::IMAP4::Message::labels&#40;&#39;Mail::Box::IMAP4::Message=HASH&#40;0xaa353b8&#41;&#39;&#41;
called at /usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4/Message.pm
line 163
        Mail::Box::IMAP4::Message::writeDelayed&#40;&#39;Mail::Box::IMAP4::Message=HASH&#40;0xaa353b8&#41;&#39;,
&#39;INBOX&#39;, &#39;Mail::Transport::IMAP4=HASH&#40;0xa9aa9ac&#41;&#39;&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4.pm line 296
        Mail::Box::IMAP4::writeMessages&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;,
&#39;HASH&#40;0xa5ca094&#41;&#39;&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 757
        Mail::Box::write&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;,
&#39;save_deleted&#39;, 0, &#39;force&#39;, 0, &#39;transporter&#39;,
&#39;Mail::Transport::IMAP4=HASH&#40;0xa9aa9ac&#41;&#39;&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4.pm line 268
        Mail::Box::IMAP4::write&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;,
&#39;force&#39;, 0, &#39;save_deleted&#39;, 0&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 362
        Mail::Box::close&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;&#41; called at
/usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4.pm line 114
        Mail::Box::IMAP4::close&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;&#41;
called at /usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 882
        Mail::Box::DESTROY&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;&#41; called
at perl/modules//ANS/Events/Event.pm line 326
        eval {...} called at perl/modules//ANS/Events/Event.pm line 326
        ANS::Events::Event::Ticket::MailProcessor::_execute_event&#40;&#39;ANS::Events::Event::Ticket::MailProcessor=HASH&#40;0xa978740&#41;&#39;&#41;
called at perl/modules//ANS/Events/Event.pm line 326
        eval {...} called at perl/modules//ANS/Events/Event.pm line 290
        ANS::Events::Event::execute&#40;&#39;ANS::Events::Event::Ticket::MailProcessor=HASH&#40;0xa978740&#41;&#39;&#41;
called at perl/scripts/event-handler-wrapper.pl line 78
DEBUG: Sending: 11 UID SEARCH ALL

DEBUG: Sent 19 bytes

DEBUG: Read: * SEARCH 1 2

      11 OK SEARCH completed.

DEBUG: Sending: 12 UID FETCH 1:2 FLAGS

DEBUG: Sent 24 bytes

DEBUG: Read: * 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;

      * 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;

      12 OK FETCH completed.

DEBUG: flags: line = &#39;12 UID FETCH 1:2 FLAGS&#39;

DEBUG: flags: line = &#39;* 1 FETCH &#40;FLAGS &#40;\Seen&#41; UID 1&#41;
  &#39;

DEBUG: flags: line = &#39;* 2 FETCH &#40;FLAGS &#40;\Seen&#41; UID 2&#41;
  &#39;

DEBUG: flags: line = &#39;12 OK FETCH completed.
  &#39;

Use of uninitialized value in hash element at
/usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line 1864.
        &#40;in cleanup&#41; Can&#39;t use an undefined value as an ARRAY
reference at /usr/lib/perl5/site_perl/5.8.5/Mail/IMAPClient.pm line
1865.

Regards,
Zsolt


On Dec 17, 2007 11:45 AM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; * Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071217 11:18]:
&gt;
&gt; This does clarify some things... the problem happens in &#34;DESTROY&#34;,
&gt; which is happening inside your eval
&gt;    on at perl/modules//ANS/Events/Event.pm line 326
&gt;
&gt; Probably, something is going wrong during the initiation of the
&gt; message before it is completed.  The UID of the message is not
&gt; present yet, and therefore destructrion fails.
&gt;
&gt; Try to change lib/Mail/Box/IMAP4/Message.pm
&gt;
&gt;   sub label&#40;@&#41;
&gt;   {   my $self = shift;
&gt;       my $imap = $self-&gt;folder-&gt;transporter or return;
&gt;  -    my $id   = $self-&gt;unique;
&gt;  +    my $id   = $self-&gt;unique or return;
&gt;
&gt; To avoid the erroneous path.  Hopefully, you get an error message now.
&gt; The trace was very useful.
&gt; --
&gt;
&gt; Regards,
&gt;                MarkOv
&gt;
&gt; ------------------------------------------------------------------------
&gt;        Mark Overmeer MSc                                MARKOV Solutions
&gt;        Mark@Overmeer.net                          solutions@overmeer.net
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-398617" href="/Public/Bug/Display.html?id=30499#txn-398617">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;03:54:51&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 Dec 2007 09:54:19 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Zsolt Kecskemeti via RT &lt;bug-Mail-Box [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/398617/182431/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/182431">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071217 12:08]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Mail-Box
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt; 
&gt; Now it gets to writeDelayed but a similar error happens there:
</div>
Have you already figured-out why destroy was called on an incomplete
message object?  It originates in your eval, and it would help me if
I known that contents.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; /usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4.pm line 114
&gt;         Mail::Box::IMAP4::close&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;&#41;
&gt; called at /usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 882
&gt;         Mail::Box::DESTROY&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;&#41; called
&gt; at perl/modules//ANS/Events/Event.pm line 326
&gt;         eval {...} called at perl/modules//ANS/Events/Event.pm line 326
</div>
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-398671" href="/Public/Bug/Display.html?id=30499#txn-398671">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;05:36:00&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 Dec 2007 10:35:17 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/398671/182460/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/182460">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">line 326 of Event.pm:

my $success = $self-&gt;_execute_event&#40;&#41;;

in _execute_event I connect to two mailboxes:

my $obj_mgr     = Mail::Box::Manager-&gt;new&#40;&#41;;

my $pop3 = {
        &#39;type&#39;                  =&gt; &#39;pop3&#39;,
        &#39;username&#39;              =&gt; &#39;tickets.test&#39;,
        &#39;password&#39;              =&gt; &#39;Ticketing1&#39;,
        &#39;server_name&#39;   =&gt; &#39;a.b.c.d&#39;,
        &#39;log&#39;                   =&gt; &#39;DEBUG&#39;,
        &#39;access&#39;                =&gt; &#39;rw&#39;,
};

my $obj_folder = $obj_mgr-&gt;open&#40;%{$pop3&#41;;

my $backup = {
        &#39;type&#39;                  =&gt; &#39;imap4&#39;,
        &#39;folder&#39;                =&gt; &#39;INBOX&#39;,
        &#39;username&#39;              =&gt; &#39;username&#39;,
        &#39;password&#39;              =&gt; &#39;password&#39;,
        &#39;server_name&#39;   =&gt; &#39;a.b.c.d&#39;,
        &#39;server_name&#39;   =&gt; &#39;our.domain.name&#39;,
        &#39;log&#39;                   =&gt; &#39;DEBUG&#39;,
        &#39;trace&#39;                 =&gt; &#39;DEBUG&#39;,
        &#39;authenticate&#39;  =&gt; &#39;LOGIN&#39;,
        &#39;access&#39;                =&gt; &#39;rw&#39;,
};

my $obj_backup = Mail::Box::IMAP4-&gt;new&#40;%{$backup}&#41;;

Connecting to the backup mailbox via IMAP4 works, I can get the folder
name &#40;$obj_backup-&gt;name =&gt; INBOX&#41; and the number of messages
&#40;$obj_backup-&gt;messages =&gt; 2&#41;.

I process the mails from pop3 mailbox one by one:

if &#40;defined&#40; &#40;$obj_folder-&gt;messages&#40;&#39;ACTIVE&#39;&#41;&#41;[0] &#41;&#41; {

        $current_msg = $obj_folder-&gt;messages&#40;&#39;ACTIVE&#39;&#41;&#41;[0];
}

and when I am finished with them I call:

$obj_mgr-&gt;moveMessage&#40;obj_backup, $current_msg&#41;;

Up until I call moveMessage I get no error messages at all.

Regards,
Zsolt Kecskemeti

On Dec 19, 2007 8:54 AM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; * Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071217 12:08]:
<div class="message-stanza open">&gt; &gt;        Queue: Mail-Box
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt; &gt;
&gt; &gt; Now it gets to writeDelayed but a similar error happens there:
</div>&gt;
&gt; Have you already figured-out why destroy was called on an incomplete
&gt; message object?  It originates in your eval, and it would help me if
&gt; I known that contents.
&gt;
<div class="message-stanza open">&gt; &gt; /usr/lib/perl5/site_perl/5.8.5/Mail/Box/IMAP4.pm line 114
&gt; &gt;         Mail::Box::IMAP4::close&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;&#41;
&gt; &gt; called at /usr/lib/perl5/site_perl/5.8.5/Mail/Box.pm line 882
&gt; &gt;         Mail::Box::DESTROY&#40;&#39;Mail::Box::IMAP4=HASH&#40;0xa9a2624&#41;&#39;&#41; called
&gt; &gt; at perl/modules//ANS/Events/Event.pm line 326
&gt; &gt;         eval {...} called at perl/modules//ANS/Events/Event.pm line 326
</div>&gt;
&gt; --
&gt;
&gt; Regards,
&gt;                MarkOv
&gt;
&gt; ------------------------------------------------------------------------
&gt;        Mark Overmeer MSc                                MARKOV Solutions
&gt;        Mark@Overmeer.net                          solutions@overmeer.net
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-398716" href="/Public/Bug/Display.html?id=30499#txn-398716">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;06:23:14&nbsp;2007</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 Dec 2007 12:22:49 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Zsolt Kecskemeti via RT &lt;bug-Mail-Box [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/398716/182486/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/182486">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 664b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071219 10:36]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; my $obj_folder = $obj_mgr-&gt;open&#40;%{$pop3&#41;;
</div>
  my $obj_folder = $obj_mgr-&gt;open&#40;%{$pop3}&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; and when I am finished with them I call:
&gt; $obj_mgr-&gt;moveMessage&#40;obj_backup, $current_msg&#41;;
</div>
 $obj_backup, I hope.
Sorry: I have to leave now... tonight or tomorrow more...
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-398719" href="/Public/Bug/Display.html?id=30499#txn-398719">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;19&nbsp;06:27:39&nbsp;2007</span>
    <span class="description">kecskemetizsolt [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30499] Mail-Box-2.076 &gt; Mail::Transport::IMAP4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 19 Dec 2007 11:27:15 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-Box [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Zsolt Kecskemeti&#34; &lt;kecskemetizsolt [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/398719/182489/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/182489">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 952b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">yes, $obj_backup of course :&#41;

Ok, whenever you have time, I really appreciate your help.

Regards,
Zsolt

On Dec 19, 2007 11:23 AM, Mark Overmeer via RT &lt;bug-Mail-Box@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30499">http://rt.cpan.org/Ticket/Display.html?id=30499</a></span> &gt;
&gt;
&gt; * Zsolt Kecskemeti via RT &#40;bug-Mail-Box@rt.cpan.org&#41; [071219 10:36]:
<div class="message-stanza open">&gt; &gt; my $obj_folder = $obj_mgr-&gt;open&#40;%{$pop3&#41;;
</div>&gt;
&gt;   my $obj_folder = $obj_mgr-&gt;open&#40;%{$pop3}&#41;;
&gt;
<div class="message-stanza open">&gt; &gt; and when I am finished with them I call:
&gt; &gt; $obj_mgr-&gt;moveMessage&#40;obj_backup, $current_msg&#41;;
</div>&gt;
&gt;  $obj_backup, I hope.
&gt; Sorry: I have to leave now... tonight or tomorrow more...
&gt; --
&gt;
&gt; Regards,
&gt;                MarkOv
&gt;
&gt; ------------------------------------------------------------------------
&gt;        Mark Overmeer MSc                                MARKOV Solutions
&gt;        Mark@Overmeer.net                          solutions@overmeer.net
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-785782" href="/Public/Bug/Display.html?id=30499#txn-785782">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;03&nbsp;03:50:24&nbsp;2010</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/785782/407053/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/407053">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 60b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">ancient ticket seems to have re-opened itself. closed again.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-785784" href="/Public/Bug/Display.html?id=30499#txn-785784">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;03&nbsp;03:50:25&nbsp;2010</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.813867</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
