<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #48304 for DBD-ODBC: DBD::ODBC - [Microsoft][SQL Server Native Client 10.0][SQL Server]The  incoming tabular data stream &#40;TDS&#41; remote procedure call &#40;RPC&#41; protocol  stream is incorrect.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #48304 for DBD-ODBC: DBD::ODBC - [Microsoft][SQL Server Native Client 10.0][SQL Server]The  incoming tabular data stream &#40;TDS&#41; remote procedure call &#40;RPC&#41; protocol  stream is incorrect.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBD-ODBC/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBD-ODBC/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBD-ODBC/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBD-ODBC/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-ODBC">DBD-ODBC CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">48304</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBD-ODBC/Active/">DBD-ODBC</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mockodin [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10188-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10189-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.22_3    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;29&nbsp;13:51:35&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> DBD::ODBC - [Microsoft][SQL Server Native Client 10.0][SQL Server]The  incoming tabular data stream &#40;TDS&#41; remote procedure call &#40;RPC&#41; protocol  stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 29 Jul 2009 10:45:59 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Bug:
DBD::ODBC::db do failed: [Microsoft][SQL Server Native Client
10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote
procedure call &#40;RPC&#41; protocol stream is incorrect. Parameter 7 &#40;&#34;&#34;&#41;:
Data type 0xE7 has an invalid data length or metadata length.
&#40;SQL-42000&#41; [for Statement &#34;INSERT INTO longdescs
&#40;bug_id,who,bug_when,thetext,isprivate&#41;
                   VALUES &#40;?,?,?,?,?&#41;&#34;] at Bugzilla/DB/Mssql.pm line 626
        Bugzilla::DB::Mssql::do&#40;undef, &#39;INSERT INTO longdescs
&#40;bug_id,who,bug_when,thetext,isprivate&#41;...&#39;, undef, 9, 1, &#39;2009-07-28
17:45:59.353&#39;, &#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...&#39;,
0&#41; called at Bugzilla/Bug.pm line 540
        Bugzilla::Bug::create&#40;&#39;Bugzilla::Bug&#39;, &#39;HASH&#40;0x408a098&#41;&#39;&#41; called at
D:\WebRoot\Bugzilla\post_bug.cgi line 175

It appears that when inserting to a NVARCHAR&#40;MAX&#41; field in a MSSQL
2008 database, that the precision is being incorrectly calculated.
NVARCHAR&#40;MAX&#41; behaves more inline with a text field in relation to how
much data it will hold, I believe that no precision needs to be sent.

Using Management Studio for mssql 2008 I have tested inserting up to
500k characters in to a nvarchar&#40;max&#41; field with no issues.

<span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-us/library/ms186939.aspx*">http://msdn.microsoft.com/en-us/library/ms186939.aspx*</a></span>
nvarchar* [ &#40; n | *max* &#41; ]

Variable-length Unicode character data. *n** *can be a value from 1 through
4,000. *max indicates that the maximum storage size is 2^31-1 bytes*. The
storage size, in bytes, is two times the number of characters entered + 2
bytes. The data entered can be 0 characters in length.


Environment:
Windows 2008 SP2
64 Bit
IIS7
ActiveState Perl version: 5.10
DBD::ODBC version: 2.22
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;29&nbsp;15:00:49&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jul 29 13:51:35 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Bug:
&gt; DBD::ODBC::db do failed: [Microsoft][SQL Server Native Client
&gt; 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote
&gt; procedure call &#40;RPC&#41; protocol stream is incorrect. Parameter 7 &#40;&#34;&#34;&#41;:
&gt; Data type 0xE7 has an invalid data length or metadata length.
&gt; &#40;SQL-42000&#41; [for Statement &#34;INSERT INTO longdescs
&gt; &#40;bug_id,who,bug_when,thetext,isprivate&#41;
&gt;                    VALUES &#40;?,?,?,?,?&#41;&#34;] at Bugzilla/DB/Mssql.pm line
&gt; 626
&gt;       Bugzilla::DB::Mssql::do&#40;undef, &#39;INSERT INTO longdescs
&gt; &#40;bug_id,who,bug_when,thetext,isprivate&#41;...&#39;, undef, 9, 1, &#39;2009-07-28
&gt; 17:45:59.353&#39;,
&gt; &#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...&#39;,
&gt; 0&#41; called at Bugzilla/Bug.pm line 540
&gt;       Bugzilla::Bug::create&#40;&#39;Bugzilla::Bug&#39;, &#39;HASH&#40;0x408a098&#41;&#39;&#41; called at
&gt; D:\WebRoot\Bugzilla\post_bug.cgi line 175
&gt; 
</div>&lt;snipped&gt;

Don&#39;t quite get this as there are only 5 parameter not 7. Anyway, any
chance you could provide a small self contained working example I can
use to reproduce and can be later used as a test. Something like,
&#34;create table xxx&#40;a type&#41;&#34;, &#34;insert into xxx&#40;?&#41;&#34;.

It would also be useful to know the native client driver version as
there are a number around with some horrendous bugs in which DBD::ODBC
attempts to workaround.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;29&nbsp;15:00:50&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;29&nbsp;20:10:13&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48304] DBD::ODBC - [Microsoft][SQL Server Native  Client 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote  procedure call &#40;RPC&#41; protocol stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 29 Jul 2009 17:09:33 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">While building the script I found it is odder than I though:

values longer than 2000 characters die UNLESS they are longer than 16383 at
which point they work again

I used a ranges of 0-20k in length for my test. I did test separately
inserting lengths in the 64k range which worked fine.

Attached a perl script file for testing.



On Wed, Jul 29, 2009 at 12:00 PM, Martin J Evans via RT &lt;
bug-DBD-ODBC@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=48304">https://rt.cpan.org/Ticket/Display.html?id=48304</a></span> &gt;
&gt;
&gt; On Wed Jul 29 13:51:35 2009, mockodin wrote:
<div class="message-stanza open">&gt; &gt; Bug:
&gt; &gt; DBD::ODBC::db do failed: [Microsoft][SQL Server Native Client
&gt; &gt; 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote
&gt; &gt; procedure call &#40;RPC&#41; protocol stream is incorrect. Parameter 7 &#40;&#34;&#34;&#41;:
&gt; &gt; Data type 0xE7 has an invalid data length or metadata length.
&gt; &gt; &#40;SQL-42000&#41; [for Statement &#34;INSERT INTO longdescs
&gt; &gt; &#40;bug_id,who,bug_when,thetext,isprivate&#41;
&gt; &gt;                    VALUES &#40;?,?,?,?,?&#41;&#34;] at Bugzilla/DB/Mssql.pm line
&gt; &gt; 626
&gt; &gt;       Bugzilla::DB::Mssql::do&#40;undef, &#39;INSERT INTO longdescs
&gt; &gt; &#40;bug_id,who,bug_when,thetext,isprivate&#41;...&#39;, undef, 9, 1, &#39;2009-07-28
&gt; &gt; 17:45:59.353&#39;,
&gt; &gt; &#39;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...&#39;,
&gt; &gt; 0&#41; called at Bugzilla/Bug.pm line 540
&gt; &gt;       Bugzilla::Bug::create&#40;&#39;Bugzilla::Bug&#39;, &#39;HASH&#40;0x408a098&#41;&#39;&#41; called at
&gt; &gt; D:\WebRoot\Bugzilla\post_bug.cgi line 175
&gt; &gt;
</div>&gt; &lt;snipped&gt;
&gt;
&gt; Don&#39;t quite get this as there are only 5 parameter not 7. Anyway, any
&gt; chance you could provide a small self contained working example I can
&gt; use to reproduce and can be later used as a test. Something like,
&gt; &#34;create table xxx&#40;a type&#41;&#34;, &#34;insert into xxx&#40;?&#41;&#34;.
&gt;
&gt; It would also be useful to know the native client driver version as
&gt; there are a number around with some horrendous bugs in which DBD::ODBC
&gt; attempts to workaround.
&gt;
&gt; Martin
&gt; --
&gt; Martin J. Evans
&gt; Wetherby, UK
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;29&nbsp;20:17:56&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It&#39;s in the previous attachment but the driver version is for those not
wanting to download to find out:

SQL Server Native Client 10.0
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;29&nbsp;20:47:50&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Driver: SQL Server v 6.00.6002.18005 &#40;MDAC&#41;
    OK, but has other limitations with SQL 2008
Driver: SQL Native Client v 2005.90.3042.00 &#40;Mssql 2005&#41;
    Fail
Driver: SQL Server Native Client 10.0 v 2007.100.2531.00 &#40;Mssql 2008&#41;
    Fail

Both of the &#34;Native&#34; drivers fail at the same points when accessed from
DBD::ODBC
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;30&nbsp;04:05:20&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Are you capable of build DBD::ODBC yourself if I was to propose a change
to it?

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;30&nbsp;12:37:35&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48304] DBD::ODBC - [Microsoft][SQL Server Native  Client 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote  procedure call &#40;RPC&#41; protocol stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Jul 2009 09:37:16 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Not something I&#39;m overly familiar with. Best bet is the ActiveState guys but
I don&#39;t know how responsive they are.

On Thu, Jul 30, 2009 at 1:05 AM, Martin J Evans via RT &lt;
bug-DBD-ODBC@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=48304">https://rt.cpan.org/Ticket/Display.html?id=48304</a></span> &gt;
&gt;
&gt; Are you capable of build DBD::ODBC yourself if I was to propose a change
&gt; to it?
&gt;
&gt; Martin
&gt; --
&gt; Martin J. Evans
&gt; Wetherby, UK
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;30&nbsp;12:41:13&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jul 30 12:37:35 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Not something I&#39;m overly familiar with. Best bet is the ActiveState
</div>guys but
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I don&#39;t know how responsive they are.
</div>
My problem is that I may have a fix but I cannot know if it fixes it for
you and I can only the driver you are using at different versions. If
you install MinGW from activestate you can build DBD::ODBC yourself. It
is not hard. Are you prepared to/ have time to have a go?

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;30&nbsp;12:54:58&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Might as well, give it a shot. Pulling down MinGW now.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;30&nbsp;13:30:36&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jul 30 12:54:58 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Might as well, give it a shot. Pulling down MinGW now.
</div>
ok - here goes. Install MinGW the download latest DBD::ODBC from CPAN
which is 1.22. Unpack it into a dir and open cmd prompt in that dir.
Edit dbdimp.c and search for the following code:

   /*
    * Yet another workaround for SQL Server native client.
    * If you have a varbinary&#40;max&#41; or varchar&#40;max&#41; you have to pass 0
    * for the column_size or you get HY104 &#34;Invalid precision value&#34;.
    * See rt_38977.t which causes this.
    * The versions of native client I&#39;ve seen this with are:
    * 2007.100.1600.22 sqlncli10.dll driver version = ?
    * 2005.90.1399.00 SQLNCLI.DLL driver version = 09.00.1399
    */
   if &#40;&#40;imp_dbh-&gt;driver_type == DT_SQL_SERVER_NATIVE_CLIENT&#41; &#38;&#38;
       &#40;phs-&gt;strlen_or_ind &lt; 0&#41; &#38;&#38;
       &#40;phs-&gt;param_size == 0&#41;&#41; {
       column_size = 0;
   }

delete the line &#34;&#40;phs-&gt;strlen_or_ind &lt; 0&#41; &#38;&#38;&#34;.

set DBI_DSN=dbi:ODBC:your_dsn_name
set DBI_USER=your_database_user
set DBI_PASS=your_database_password

The rest depends on perl and cpan from ActiveState being on your path
&#40;which they should be&#41;.

Run cpan and you should get a prompt you can enter at. If you have never
used cpan before you may have to answer some questions first.

at the cpan prompt do

test .

It should configure and build DBD::ODBC in the current dir and run the
tests. If they work you can do:

install .

Hopefully, the issue you reported is then fixed :-&#41;

If you have problems it may be quicker to email me at mjevans at cpan
dot org.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;30&nbsp;20:23:37&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Currently fighting with the compiler, it appears that when running make
through cpan

cpan[1]&gt; make .
Going to read &#39;D:\WebRoot\Perl\cpan\Metadata&#39;
  Database was generated on Wed, 29 Jul 2009 09:27:12 GMT
Running make for D:/WebRoot/Perl/cpan/build/DBD-ODBC-1.22/.

  CPAN.pm: Going to build D:/WebRoot/Perl/cpan/build/DBD-ODBC-1.22/.

Set up gcc environment - 3.4.5 &#40;mingw-vista special r3&#41;
Useless use of private variable in void context at Makefile.PL line 677.
You are using a Perl configured with threading enabled.
Please read the warnings in DBI about this.

Press return to continue...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;&gt;&gt;     Remember to actually *READ* the README file!
</div>        And re-read it if you have any problems.



Checking if your kit is complete...
Looks good
Multiple copies of Driver.xst found in:
D:/WebRoot/Perl/site/lib/auto/DBI/ D:/WebRoot/Perl/lib/auto/DBI/ at
Makefile.PL line 114
Using DBI 1.609 &#40;for perl 5.010000 on MSWin32-x64-multi-thread&#41;
installed in D:/WebRoot/Perl/site/lib/auto/DBI/
Note &#40;probably harmless&#41;: No library found for ODBC32.LIB
Note &#40;probably harmless&#41;: No library found for -lkernel32
Note &#40;probably harmless&#41;: No library found for -luser32
Note &#40;probably harmless&#41;: No library found for -lgdi32
Note &#40;probably harmless&#41;: No library found for -lwinspool
Note &#40;probably harmless&#41;: No library found for -lcomdlg32
Note &#40;probably harmless&#41;: No library found for -ladvapi32
Note &#40;probably harmless&#41;: No library found for -lshell32
Note &#40;probably harmless&#41;: No library found for -lole32
Note &#40;probably harmless&#41;: No library found for -loleaut32
Note &#40;probably harmless&#41;: No library found for -lnetapi32
Note &#40;probably harmless&#41;: No library found for -luuid
Note &#40;probably harmless&#41;: No library found for -lws2_32
Note &#40;probably harmless&#41;: No library found for -lmpr
Note &#40;probably harmless&#41;: No library found for -lwinmm
Note &#40;probably harmless&#41;: No library found for -lversion
Note &#40;probably harmless&#41;: No library found for -lodbc32
Note &#40;probably harmless&#41;: No library found for -lodbccp32
Note &#40;probably harmless&#41;: No library found for -lbufferoverflowU
Note &#40;probably harmless&#41;: No library found for -lmsvcrt
Multiple copies of Driver.xst found in:
D:/WebRoot/Perl/site/lib/auto/DBI/ D:/WebRoot/Perl/lib/auto/DBI/ at
Makefile.PL line 688
Using DBI 1.609 &#40;for perl 5.010000 on MSWin32-x64-multi-thread&#41;
installed in D:/WebRoot/Perl/site/lib/auto/DBI/
Writing Makefile for DBD::ODBC

The DBD::ODBC tests will use these values for the database connection:
    DBI_DSN=dbi:ODBC:BUGZILLA           e.g. dbi:ODBC:demo
    DBI_USER=bugus
    DBI_PASS=bugs

D:\WebRoot\Perl\bin\perl.exe -MExtUtils::Command -e &#34;cp&#34; -- Changes
blib\lib\DBD\ODBC\Changes.pm
D:\WebRoot\Perl\bin\perl.exe -MExtUtils::Command -e &#34;cp&#34; -- FAQ
blib\lib\DBD\ODBC\FAQ.pm
syntax error at -e line 1, next char &#41;
Missing right curly or square bracket at -e line 1, at end of line
Execution of -e aborted due to compilation errors.
mingw32-make.exe: *** [pm_to_blib] Error 255
  D:/WebRoot/Perl/cpan/build/DBD-ODBC-1.22/.
  mingw32-make.exe -- NOT OK
Directory &#39;D:/WebRoot/Perl/cpan/build/DBD-ODBC-1.22/.&#39; not below
D:\WebRoot\Perl\cpan\build, will not store persistent state
Failed during this command:
 D:/WebRoot/Perl/cpan/build/DBD-ODBC-1.22/.   : make NO


Apparent Code in Question &#40;Makefile&#41;:
pm_to_blib : $&#40;TO_INST_PM&#41;
        $&#40;NOECHO&#41; $&#40;ABSPERLRUN&#41; -MExtUtils::Install -e &#34;pm_to_blib&#40;{{@ARGV},
&#39;$&#40;INST_LIB&#41;\auto&#39;, q[$&#40;PM_FILTER&#41;], &#39;$&#40;PERM_DIR&#41;&#39;&#41;&#34; -- \
          ODBC.pm $&#40;INST_LIB&#41;\DBD\ODBC.pm 
        $&#40;NOECHO&#41; $&#40;TOUCH&#41; pm_to_bli

The Makefile is being generated but is doubling up most instances of {
&#40;left curly&#41; Running Makefile.PL results in a properly formatted file.
What I don&#39;t know is how to force cpan to use the existing Makefile
without regenerating it.. Back to google I go.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;31&nbsp;14:47:36&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sounds as though it is generating a makefile for the wrong make. Once at
the cpan prompt what does

o conf

show. The make command shown should match the make you are using which
should be on your path and probably supplied by MinGW. You may need to
change the make cpan is using or set MAKE=dmake or something like that.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;31&nbsp;16:34:33&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48304] DBD::ODBC - [Microsoft][SQL Server Native  Client 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote  procedure call &#40;RPC&#41; protocol stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 31 Jul 2009 13:34:15 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Can&#39;t find string terminator &#34;@&#34; anywhere before EOF at -e line 1.
dmake:  Error code 255, while making &#39;ODBC.bs&#39;

Progress... of sorts.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;01&nbsp;03:43:39&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jul 31 16:34:33 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can&#39;t find string terminator &#34;@&#34; anywhere before EOF at -e line 1.
&gt; dmake:  Error code 255, while making &#39;ODBC.bs&#39;
&gt; 
&gt; Progress... of sorts.
</div>
Let me know what version of activestate and windows you have and I&#39;ll
find someone with a Windows box here to work through this.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;12:30:20&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48304] DBD::ODBC - [Microsoft][SQL Server Native  Client 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote  procedure call &#40;RPC&#41; protocol stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 3 Aug 2009 09:29:56 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Windows 2008 Std SP2
ActivePerl-5.10.0.1005-MSWin32-x64-290470

I&#39;m also working on rebuilding a fresh environment, if I get it up and
running and have better results I&#39;ll update.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;14:10:47&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 03 12:30:20 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Windows 2008 Std SP2
&gt; ActivePerl-5.10.0.1005-MSWin32-x64-290470
&gt; 
&gt; I&#39;m also working on rebuilding a fresh environment, if I get it up and
&gt; running and have better results I&#39;ll update.
</div>
I&#39;ve tried with ActivePerl 1005 for x86/32 bit but with MS Developer
studio installed &#40;instead of MinGW&#41; and it built fine with &#34;test .&#34;.
Interestingly, o conf in cpan shows make set to nothing but a dmake file
is output - I&#39;ve no idea why &#40;all this is so much more simple on UNIX :-&#40; &#41;

I need to get hold of a machine without MS developer studio &#40;which I am
really loathe to uninstall on my test machine as it works&#41; and perhaps a
64bit machine to be even closer to your setup. I&#39;ll try to find a
machine tomorrow which I can do this on.

Thanks for your efforts and patience. To be honest, the Windows world
and in particular all the different versions of the SQL Server Driver
for Windows are the bane of my life. Every time I make even the smallest
change I live in fear of it breaking something which I cannot test as it
is virtually impossible for me to have all the possible windows
scenarios and drivers. Let me know if you get anywhere and I&#39;ll do likewise.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;14:24:28&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 03 12:30:20 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Windows 2008 Std SP2
&gt; ActivePerl-5.10.0.1005-MSWin32-x64-290470
&gt; 
&gt; I&#39;m also working on rebuilding a fresh environment, if I get it up and
&gt; running and have better results I&#39;ll update.
</div>
What version of ExtUtils::MakeMaker are you running?

H:\temp\DBD-ODBC-1.22&gt;perl -MExtUtils::MakeMaker -le &#34;print
$ExtUtils::MakeMaker
::VERSION;&#34;
6.42_01

It may be an issue in ExtUtils::MakeMaker - stab in the dark.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;18:28:20&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48304] DBD::ODBC - [Microsoft][SQL Server Native  Client 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote  procedure call &#40;RPC&#41; protocol stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 3 Aug 2009 15:28:01 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Microsoft Windows [Version 6.0.6002]
Copyright &#40;c&#41; 2006 Microsoft Corporation.  All rights reserved.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;perl -MExtUtils::MakeMaker -le &#34;print $ExtUtils::MakeMaker::VERSION;&#34;
</div>6.42_01
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;04&nbsp;06:58:23&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 03 18:28:20 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Microsoft Windows [Version 6.0.6002]
&gt; Copyright &#40;c&#41; 2006 Microsoft Corporation.  All rights reserved.
&gt; 
<div class="message-stanza open">&gt; &gt;perl -MExtUtils::MakeMaker -le &#34;print $ExtUtils::MakeMaker::VERSION;&#34;
</div>&gt; 6.42_01
</div>
I&#39;ve located a 64bit windows machine now.

Where did you get a ppm of MinGW for 64bit activestate from?

ppm install MinGW does not find anything.

I found a separate download of MinGW but it does not include dmake.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;04&nbsp;14:13:29&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48304] DBD::ODBC - [Microsoft][SQL Server Native  Client 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote  procedure call &#40;RPC&#41; protocol stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 4 Aug 2009 11:13:08 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I manually installed them.

That said I was able to get things working. The issue occurred under 32Bit
as well.
Part of my initial setup issue were that I have Visual Studio 2008 installed
and CPAN detected it and tried to use it. Which was actually the right
choice as everything compiled on the first try once I used CPAN with VS2008.

I updated the version number to 1.23 in my test build so that I would know
which version I was running :-&#41;

F:\&gt;perl testODBC.pl
Testing DBD::ODBC Version: 1.23

Connecting to [xxxxx].[test] as bugs ...Connected Successfully

Previous tests proved the break points were from 2001 through 16383
because we know the range needing to be corrected Test 1 is limited to 0-20k
lengths

Test 1: Attempting to add 20K rows of data, starting at a length of 1, each
row will increase in length by 1 till we finish or die
   Test Successful! No Insert Errors Found
   Exiting Test - Status PASS

F:\&gt;ppm install -f DBD::ODBC
Downloading DBD-ODBC-1.22...done
Unpacking DBD-ODBC-1.22...done
Generating HTML for DBD-ODBC-1.22...done
Updating files in site area...done
  10 files updated

F:\&gt;perl testODBC.pl
Testing DBD::ODBC Version: 1.22

Connecting to [xxx].[test] as bugs ...Connected Successfully

Previous tests proved the break points were from 2001 through 16383
because we know the range needing to be corrected Test 1 is limited to 0-20k
lengths

Test 1: Attempting to add 20K rows of data, starting at a length of 1, each
row will increase in length by 1 till we finish or die
Failed at length of 2001
Test 2: Attempting to add 20K rows of data, starting at a length of 20k,
each row will decrease in length by 1 till we finish or die
Failed at length of 16383
   Exiting Test - Status FAIL
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;04&nbsp;15:48:18&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Aug 04 14:13:29 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I manually installed them.
&gt; 
&gt; That said I was able to get things working. The issue occurred under 32Bit
&gt; as well.
&gt; Part of my initial setup issue were that I have Visual Studio 2008
</div>installed
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; and CPAN detected it and tried to use it. Which was actually the right
&gt; choice as everything compiled on the first try once I used CPAN with
</div>VS2008.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
</div>
Argh - I did not realise you already had MS devstudio - that explains
some of it.

What I meant about MinGW was a ppm install MinGW did not work for me -
it was not found in the ppm repository that the out of the box
activestate 5.10 x64 came with.

&lt;snipped output&gt;

Forgive me Michael but I&#39;ve slightly lost sight of the problem now. Is
your output showing with a changed DBD::ODBC &#40;as I susggested&#41; it is now
working but with the stock 1.22 it fails. If that is the case I&#39;ll make
this change permanent and do a new release soon.

Thanks again for you patience and persistence.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;04&nbsp;18:45:19&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #48304] DBD::ODBC - [Microsoft][SQL Server Native  Client 10.0][SQL Server]The incoming tabular data stream &#40;TDS&#41; remote  procedure call &#40;RPC&#41; protocol stream is incorrect.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 4 Aug 2009 15:44:59 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Is your output showing with a changed DBD::ODBC &#40;as I suggested&#41; it is now
&gt; working but with the stock 1.22 it fails. If that is the case I&#39;ll make
&gt; this change permanent and do a new release soon.
&gt;
&gt; Correct, the first half was with modified code per your instructions, the
</div>2nd part was with release version &#40;1.22&#41;. I included the retest under 1.22
only to verify the issue occured under 32Bit as well as under the originally
reported 64Bit, in case anyone question it later. So yes the change you
recommended did appear to solve the issue.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;05&nbsp;03:06:00&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Aug 04 18:45:19 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Correct, the first half was with modified code per your
</div></div>instructions, the
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2nd part was with release version &#40;1.22&#41;. I included the retest under 1.22
&gt; only to verify the issue occured under 32Bit as well as under the
</div>originally
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; reported 64Bit, in case anyone question it later. So yes the change you
&gt; recommended did appear to solve the issue.
</div>
OK, I&#39;ll commit this change and prepare a new release. I&#39;ll probably do
a development release first just in case it causes any problems.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;21&nbsp;05:46:09&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;21&nbsp;05:46:10&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Fixed in 1.22_3 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
