<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #80458 for Text-BibTeX: libtext-bibtex-perl: syntactically invalid BibTeX file crashes perl</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #80458 for Text-BibTeX: libtext-bibtex-perl: syntactically invalid BibTeX file crashes perl</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Text-BibTeX/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Text-BibTeX/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Text-BibTeX/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Text-BibTeX/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Text-BibTeX">Text-BibTeX CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">80458</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Text-BibTeX/Active/">Text-BibTeX</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
bremner [...] debian.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-31784-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-31785-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




btcheck<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1134036/596756/btcheck">
Sun Oct 28 20:59:23 2012 (862b) by DDB [...] cpan.org
</a>
</font></li>
</ul>


crash.bib<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1134036/596755/crash.bib">
Sun Oct 28 20:59:23 2012 (2.2k) by DDB [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;28&nbsp;20:45:46&nbsp;2012</span>
    <span class="description">DDB [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> DDB [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> libtext-bibtex-perl: syntactically invalid BibTeX file crashes perl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This bug has been forwarded from <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/691715">http://bugs.debian.org/691715</a></span>

I verified that the same thing happens with Text-BibTeX 0.65

Thanks in advance,
David Bremner, Debian Perl Group
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;28&nbsp;20:59:23&nbsp;2012</span>
    <span class="description">DDB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here are the files. When I run the script btcheck on the attached bib
file, it crashes perl 5.14 with the following backtrace

/lib/x86_64-linux-gnu/libc.so.6&#40;__fortify_fail+0x37&#41;[0x7f9f39cc5f37]
/lib/x86_64-linux-gnu/libc.so.6&#40;+0xebdf0&#41;[0x7f9f39cc4df0]
/lib/x86_64-linux-gnu/libc.so.6&#40;+0xead37&#41;[0x7f9f39cc3d37]
/usr/lib/libbtparse.so.1&#40;zzFAIL+0xe4&#41;[0x7f9f38eabdc4]
/usr/lib/libbtparse.so.1&#40;body+0xdf&#41;[0x7f9f38eab56f]
/usr/lib/libbtparse.so.1&#40;entry+0x1ea&#41;[0x7f9f38eab98a]
/usr/lib/libbtparse.so.1&#40;bt_parse_entry+0x100&#41;[0x7f9f38ea9d40]
/usr/lib/perl5/auto/Text/BibTeX/BibTeX.so&#40;XS_Text__BibTeX__Entry__parse+0x
135&#41;[0x7f9f390c1a45]
/usr/lib/libperl.so.5.14&#40;Perl_pp_entersub+0x58c&#41;[0x7f9f3a6ba3cc]
/usr/lib/libperl.so.5.14&#40;Perl_runops_standard+0x16&#41;[0x7f9f3a6b19a6]
/usr/lib/libperl.so.5.14&#40;perl_run+0x3a5&#41;[0x7f9f3a6535b5]
/usr/bin/perl&#40;main+0x149&#41;[0x400f89]
/lib/x86_64-linux-gnu/libc.so.6&#40;__libc_start_main+0xfd&#41;[0x7f9f39bf7ead]
/usr/bin/perl[0x400fc1]
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> crash.bib</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">@PREAMBLE{ {\providecommand{\noopsort}[1]{}} }

@comment{
suppcollection{Eymeric_b,
xref={Kors},
sortkey=&#34;Kors_E&#34;,
author={{\ \ \ \ \ \ Nicholau Eymeric}},
title=&#34;Directorum inquisitorum&#34;,
pages=&#34;60-64&#34;,
keywords={primary},
}
@incollection{1437,
crossref={Kors},
author=&#34;Ponce Feugeyron&#34;,
title=&#34;Errores Gazariorum, 1437&#34;,
subtitle={},
pages=&#34;159-162&#34;,
options={skipbib=true},
}
@suppcollection{1437_b,
xref={Kors},
sortkey=&#34;Kors_F&#34;,
booktitle={},
author={{\ \ \ \ \ \ Feugeyron, Ponce.}},
title=&#34;Errores Gazariorum, 1437&#34;,
pages=&#34;159-162&#34;,
keywords={primary},
}

@incollection{1628,
crossref={Kors},
author=&#34;Johannes Junius&#34;,
title=&#34;Letter to Veronica &#40;24 July 1628&#41;&#34;,
shorttitle=&#34;Bamberg&#34;,
subtitle={},
pages=&#34;351-353&#34;,
options={skipbib=true},
}
@suppcollection{1628_b,
xref={Kors},
sortkey=&#34;Kors_F&#34;,
author={{\ \ \ \ \ \ Junius, Johannes.}},
title=&#34;Letter to Veronica &#40;24 July 1628&#41;&#34;,
pages=&#34;351-353&#34;,
keywords={primary},
}
@collection{Kors,
sortkey=&#34;Kors_A&#34;,
title=&#34;Witchcraft in Europe 400-1700&#34;,
shortbooktitle=&#34;Witchcraft...&#34;,
subtitle=&#34;A Documentary History&#34;,
booktitle=&#34;Witchcraft in Europe 400-1700&#34;,
booksubtitle=&#34;A Documentary History&#34;,
edition=&#34;2&#34;,
editor=&#34;Alan Charles Kors and Edward Peters&#34;,
year=&#34;2001&#34;,
publisher=&#34;University of Pennsylvania Press&#34;,
keywords={primary},
}


@online{HermannLoeher,
author=&#34;Hermann LÃ¶her&#34;,
title=&#34;HochnÃ¶tige Unterhanige WemÃ¼tige Klage der Frommen UnschÃ¼ltigen&#34;,
year=&#34;1676&#34;,
address=&#34;Amsterdam&#34;,
editor=&#34;Thomas P. Becker and Theresia Becker&#34;,
url=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://extern.historicum.net/loeher/">http://extern.historicum.net/loeher/</a></span>&#34;,
urldate=&#34;2011-06-22&#34;,
keywords={primary,critic},
annote=&#34;Hermann LÃ¶her &#40;1595-1678&#41; was a judge &#40;SchÃ¶ffen&#41; during the
                  1631 witch-trials in Rheinbach in the diocese of
                  Trier.  He became uneasy about procedures during the
                  3rd trial, but was convinced during the 4th that
                  Kommisar Buirmann was manipulating the outcomes for
                  political ends.  After recognizing that as a
                  dissenting judge, he would be denounced himself, he
                  fled to Amsterdam with his family on 3 August
                  1636. He spent the remainder of his life collecting
                  evidence against witch hunting.  This memoir was
                  written at age 80.&#34;,
}


</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> btcheck</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1134036/596756/btcheck">Download btcheck</a><br />
<span class="downloadcontenttype">application/octet-stream 862b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;28&nbsp;20:59:24&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;07:37:38&nbsp;2012</span>
    <span class="description">ambs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello

Thank you for the report. I&#39;ll give it a look.

Cheers
ambs


On Sun Oct 28 20:59:23 2012, DDB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here are the files. When I run the script btcheck on the attached bib
&gt; file, it crashes perl 5.14 with the following backtrace
&gt; 
&gt; /lib/x86_64-linux-gnu/libc.so.6&#40;__fortify_fail+0x37&#41;[0x7f9f39cc5f37]
&gt; /lib/x86_64-linux-gnu/libc.so.6&#40;+0xebdf0&#41;[0x7f9f39cc4df0]
&gt; /lib/x86_64-linux-gnu/libc.so.6&#40;+0xead37&#41;[0x7f9f39cc3d37]
&gt; /usr/lib/libbtparse.so.1&#40;zzFAIL+0xe4&#41;[0x7f9f38eabdc4]
&gt; /usr/lib/libbtparse.so.1&#40;body+0xdf&#41;[0x7f9f38eab56f]
&gt; /usr/lib/libbtparse.so.1&#40;entry+0x1ea&#41;[0x7f9f38eab98a]
&gt; /usr/lib/libbtparse.so.1&#40;bt_parse_entry+0x100&#41;[0x7f9f38ea9d40]
&gt; /usr/lib/perl5/auto/Text/BibTeX/BibTeX.so&#40;XS_Text__BibTeX__Entry__parse+0x
&gt; 135&#41;[0x7f9f390c1a45]
&gt; /usr/lib/libperl.so.5.14&#40;Perl_pp_entersub+0x58c&#41;[0x7f9f3a6ba3cc]
&gt; /usr/lib/libperl.so.5.14&#40;Perl_runops_standard+0x16&#41;[0x7f9f3a6b19a6]
&gt; /usr/lib/libperl.so.5.14&#40;perl_run+0x3a5&#41;[0x7f9f3a6535b5]
&gt; /usr/bin/perl&#40;main+0x149&#41;[0x400f89]
&gt; /lib/x86_64-linux-gnu/libc.so.6&#40;__libc_start_main+0xfd&#41;[0x7f9f39bf7ead]
&gt; /usr/bin/perl[0x400fc1]
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;08:32:33&nbsp;2012</span>
    <span class="description">ambs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

Fixed on 0.66. I think :&#41;

Cheers
ambs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;08:32:34&nbsp;2012</span>
    <span class="description">ambs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;19:27:47&nbsp;2012</span>
    <span class="description">DDB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for looking at this. When I discovered the Debian package
compiled version of 0.66 still crashed, I went back and checked, and the
previous versions of Text-BibTeX seem to only have the problem with the
Debian package as well. So it looks like I bothered you over something
that is probably my fault. Sorry about that.

David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;19:27:48&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;19:32:09&nbsp;2012</span>
    <span class="description">ambs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 29 19:27:47 2012, DDB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for looking at this. When I discovered the Debian package
&gt; compiled version of 0.66 still crashed, I went back and checked, and the
&gt; previous versions of Text-BibTeX seem to only have the problem with the
&gt; Debian package as well. So it looks like I bothered you over something
&gt; that is probably my fault. Sorry about that.
</div>
Hello
that is weird. with bibparse the example you provided made the binary fail.
Now it no longer fails.
but probably it fails somewhere else.

can you give me more details how you are testing it?
thanks
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;19:32:49&nbsp;2012</span>
    <span class="description">DDB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It could also be that the bug is only detected in the Debian version
because of the hardening options.  Until I know more, I&#39;ll leave the
ticket resolved.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;20:26:37&nbsp;2012</span>
    <span class="description">DDB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> 691715 [...] bugs.debian.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Using bibparse is nice, it eliminates some complications.

OK, here is my current test, on the bib file above.

install debian compile 0.66 into /usr

Install 0.66 from source into /usr/local.

run bibparse, no crash.

mv /usr/local/lib/libbtparse.so out of the way, so 

ldd /usr/local/bin/bibparse reports 

libbtparse.so =&gt; /usr/lib/libbtparse.so

i.e. linked to the debian version.

Now bibparse crashes on that file again with a buffer overflow, after
printing

@preamble
\providecommand{\noopsort}[1]{}

crash.bib, line 5, warning: possible runaway string started at line 3
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;20:51:16&nbsp;2012</span>
    <span class="description">691715 [...] bugs.debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug#691715: Info received &#40;[rt.cpan.org #80458] libtext-bibtex-perl: syntactically invalid BibTeX file crashes perl&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 30 Oct 2012 00:51:03 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Text-BibTeX [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> owner [...] bugs.debian.org &#40;Debian Bug Tracking System&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for the additional information you have supplied regarding
this Bug report.

This is an automatically generated reply to let you know your message
has been received.

Your message is being forwarded to the package maintainers and other
interested parties for their attention; they will reply in due course.

Your message has been sent to the package maintainer&#40;s&#41;:
 Debian Perl Group &lt;pkg-perl-maintainers@lists.alioth.debian.org&gt;

If you wish to submit further information on this problem, please
send it to 691715@bugs.debian.org.

Please do not send mail to owner@bugs.debian.org unless you wish
to report a problem with the Bug-tracking system.

-- 
691715: <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=691715">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=691715</a></span>
Debian Bug Tracking System
Contact owner@bugs.debian.org with problems
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;20:59:52&nbsp;2012</span>
    <span class="description">DDB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> 691715 [...] bugs.debian.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
I was able to duplicate the crash with the upstream version by adding 
the definition _FORTIFY_SOURCE=2 or _FORTIFY_SOURCE=1

--- a/inc/MyBuilder.pm
+++ b/inc/MyBuilder.pm
@@ -168,6 +168,7 @@ sub ACTION_create_objects {
         $object =~ s/\.c/.o/;
         next if $self-&gt;up_to_date&#40;$file, $object&#41;;
         $cbuilder-&gt;compile&#40;object_file  =&gt; $object,
+                          extra_compiler_flags=&gt;[&#34;-D_FORTIFY_SOURCE=2&#34;],
                            source       =&gt; $file,
                            include_dirs =&gt; [&#34;btparse/src&#34;]&#41;;
     }

FORTIFY_SOURCE attempts to catch some buffer overflows; the best
reference I could find at the moment is 

<span class="clickylink"><a target="new" rel="nofollow" href="http://gcc.gnu.org/ml/gcc-patches/2004-09/msg02055.html">http://gcc.gnu.org/ml/gcc-patches/2004-09/msg02055.html</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;29&nbsp;21:03:11&nbsp;2012</span>
    <span class="description">691715 [...] bugs.debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug#691715: Info received &#40;[rt.cpan.org #80458] libtext-bibtex-perl: syntactically invalid BibTeX file crashes perl&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 30 Oct 2012 01:03:03 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Text-BibTeX [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> owner [...] bugs.debian.org &#40;Debian Bug Tracking System&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for the additional information you have supplied regarding
this Bug report.

This is an automatically generated reply to let you know your message
has been received.

Your message is being forwarded to the package maintainers and other
interested parties for their attention; they will reply in due course.

Your message has been sent to the package maintainer&#40;s&#41;:
 Debian Perl Group &lt;pkg-perl-maintainers@lists.alioth.debian.org&gt;

If you wish to submit further information on this problem, please
send it to 691715@bugs.debian.org.

Please do not send mail to owner@bugs.debian.org unless you wish
to report a problem with the Bug-tracking system.

-- 
691715: <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=691715">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=691715</a></span>
Debian Bug Tracking System
Contact owner@bugs.debian.org with problems
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;30&nbsp;11:24:49&nbsp;2012</span>
    <span class="description">ambs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello.

Where does it come the original btparse library installed in /usr/lib?

And, is there any software shipped in debian that depends on it? &#40;and
what software?&#41;

Thank you
ambs


On Mon Oct 29 20:59:52 2012, DDB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I was able to duplicate the crash with the upstream version by adding 
&gt; the definition _FORTIFY_SOURCE=2 or _FORTIFY_SOURCE=1
&gt; 
&gt; --- a/inc/MyBuilder.pm
&gt; +++ b/inc/MyBuilder.pm
&gt; @@ -168,6 +168,7 @@ sub ACTION_create_objects {
&gt;          $object =~ s/\.c/.o/;
&gt;          next if $self-&gt;up_to_date&#40;$file, $object&#41;;
&gt;          $cbuilder-&gt;compile&#40;object_file  =&gt; $object,
&gt; +                          extra_compiler_flags=&gt;[&#34;-D_FORTIFY_SOURCE=2&#34;],
&gt;                             source       =&gt; $file,
&gt;                             include_dirs =&gt; [&#34;btparse/src&#34;]&#41;;
&gt;      }
&gt; 
&gt; FORTIFY_SOURCE attempts to catch some buffer overflows; the best
&gt; reference I could find at the moment is 
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://gcc.gnu.org/ml/gcc-patches/2004-09/msg02055.html">http://gcc.gnu.org/ml/gcc-patches/2004-09/msg02055.html</a></span>
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;30&nbsp;12:35:13&nbsp;2012</span>
    <span class="description">bremner [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #80458] libtext-bibtex-perl: syntactically invalid BibTeX file crashes perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 30 Oct 2012 13:34:38 -0300</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Text-BibTeX [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Bremner &lt;bremner [...] debian.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Alberto Simões via RT &lt;bug-Text-BibTeX@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Where does it come the original btparse library installed in /usr/lib?
</div>
It is built from Text-BibTeX sources, with the patch at 

<span class="clickylink"><a target="new" rel="nofollow" href="http://patch-tracker.debian.org/patch/series/view/libtext-bibtex-perl/0.64-1/0003-Introduce-a-btparse_api_version-note-and-use-it-in-d.patch">http://patch-tracker.debian.org/patch/series/view/libtext-bibtex-perl/0.64-1/0003-Introduce-a-btparse_api_version-note-and-use-it-in-d.patch</a></span>

to add an SONAME.

Of course, the point of my last message about defining _FORTIFY_SOURCE
is that it doesn&#39;t have to do with the Debian library per se &#40;unless I
screwed up the test, of course&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And, is there any software shipped in debian that depends on it? &#40;and
&gt; what software?&#41;
</div>
Currently it does not have reverse dependencies within debian.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;03&nbsp;14:15:25&nbsp;2012</span>
    <span class="description">ambs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 30 12:35:13 2012, bremner@debian.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Alberto Simões via RT &lt;bug-Text-BibTeX@rt.cpan.org&gt; writes:
&gt; 
<div class="message-stanza open">&gt; &gt;
&gt; &gt; Where does it come the original btparse library installed in
</div>&gt; /usr/lib?
&gt; 
&gt; It is built from Text-BibTeX sources, with the patch at
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://patch-tracker.debian.org/patch/series/view/libtext-bibtex-">http://patch-tracker.debian.org/patch/series/view/libtext-bibtex-</a></span>
&gt; perl/0.64-1/0003-Introduce-a-btparse_api_version-note-and-use-it-in-
&gt; d.patch
&gt; 
&gt; to add an SONAME.
&gt; 
&gt; Of course, the point of my last message about defining _FORTIFY_SOURCE
&gt; is that it doesn&#39;t have to do with the Debian library per se &#40;unless I
&gt; screwed up the test, of course&#41;.
</div>
I asked because you said to &#34;move /usr/local/lib/libbtparse out of the
way&#34;, so that /usr/lib/libbtparse is used. My question is, is the
/usr/lib/libbtparse you are currently using, the one shipped with
Test::BibTeX 0.66?

Cheers
ambs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;03&nbsp;17:12:48&nbsp;2012</span>
    <span class="description">bremner [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #80458] libtext-bibtex-perl: syntactically invalid BibTeX file crashes perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 03 Nov 2012 17:12:34 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Text-BibTeX [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Bremner &lt;bremner [...] debian.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Alberto Simões via RT &lt;bug-Text-BibTeX@rt.cpan.org&gt; writes:


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I asked because you said to &#34;move /usr/local/lib/libbtparse out of the
&gt; way&#34;, so that /usr/lib/libbtparse is used. My question is, is the
&gt; /usr/lib/libbtparse you are currently using, the one shipped with
&gt; Test::BibTeX 0.66?
</div>
Yes, with the patch at


<span class="clickylink"><a target="new" rel="nofollow" href="http://patch-tracker.debian.org/patch/series/view/libtext-bibtex-perl/0.64-1/0003-Introduce-a-btparse_api_version-note-and-use-it-in-d.patch">http://patch-tracker.debian.org/patch/series/view/libtext-bibtex-perl/0.64-1/0003-Introduce-a-btparse_api_version-note-and-use-it-in-d.patch</a></span>

Of course, I don&#39;t think this is relevant, because I can duplicate the
problem without the debian package as explained in a followup message.

d
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;03&nbsp;17:21:22&nbsp;2012</span>
    <span class="description">ambs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Of course, I don&#39;t think this is relevant, because I can duplicate the
&gt; problem without the debian package as explained in a followup message.
</div>
Oh, sorry, I misunderstood that message.
Added a 
  extra_compiler_flags=&gt;[&#34;-D_FORTIFY_SOURCE=2&#34;],
but I can&#39;t reproduce the bug &#40;with Mac OS X&#41;:

[ambs@stravinski Text-BibTeX]$ bibparse crash.bib 
@preamble
\providecommand{\noopsort}[1]{}

crash.bib, line 5, warning: possible runaway string started at line 3
crash.bib, line 85, syntax error: at end of input, expected one of:
start of entry &#40;&#34;{&#34; or &#34;&#40;&#34;&#41; or quoted string &#40;{...} or &#34;...&#34;&#41;
@comment



I tried with FORTIFY_SOURCE=1 and it worked correctly as well.
Tomorrow I&#39;ll install a virtual machine and do there some tests.

Cheers
ambs
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;25&nbsp;15:10:21&nbsp;2015</span>
    <span class="description">DALEEVANS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> DDB [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I duplicated this bug and I believe I fixed it.  It&#39;s caused by the unclosed comment block in the sample data file.  Patch at

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/daleevans/Text-BibTeX/commit/5a3639bba354290bfda7d2c24161c94bf2a416c5">https://github.com/daleevans/Text-BibTeX/commit/5a3639bba354290bfda7d2c24161c94bf2a416c5</a></span>
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
