<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #52832 for XML-Bare: Several memory leaks</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #52832 for XML-Bare: Several memory leaks</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=XML-Bare">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=XML-Bare">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=XML-Bare">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=XML-Bare">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-Bare">XML-Bare CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">52832</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=XML-Bare">XML-Bare</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">cpan [...] codechild.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mar.kolya [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-43826-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.45    </td>
  </tr>
  <tr id="CF-43827-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.48    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




patch.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/707430/364955/patch.diff">
Wed Dec 16 11:33:42 2009 (5.2k) by mar.kolya [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=52832">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-707430" href="/Public/Bug/Display.html?id=52832#txn-707430">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;16&nbsp;11:33:42&nbsp;2009</span>
    <span class="description">mar.kolya [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Several memory leaks</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/707430/364952/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/364952">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 274b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">In case parse&#40;&#41; is not called after call to new memory allocated by
&#39;new&#39; for the xml tree is never freed.

&#39;parser&#39; and &#39;data&#39; variables are not freed in c_parse&#40;&#41; and c_parsefile&#40;&#41;

Please see patch attached with fixes for this. This patch also includes
changes for 52762.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> patch.diff</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/707430/364955/patch.diff">Download patch.diff</a><br />
<span class="downloadcontenttype">text/x-diff 5.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ru XML-Bare-0.45/Bare.pm XML-Bare-0.45.new/Bare.pm
--- XML-Bare-0.45/Bare.pm	2009-08-02 17:09:54.000000000 -0400
+++ XML-Bare-0.45.new/Bare.pm	2009-12-16 10:19:03.585038611 -0500
@@ -38,6 +38,7 @@
   
   if&#40; $self-&gt;{ &#39;text&#39; } &#41; {
     XML::Bare::c_parse&#40; $self-&gt;{&#39;text&#39;} &#41;;
+    $self-&gt;{&#39;structroot&#39;} = XML::Bare::get_root&#40;&#41;;
   }
   else {
     my $res = open&#40; XML, $self-&gt;{ &#39;file&#39; } &#41;;
@@ -51,6 +52,7 @@
     }
     close&#40; XML &#41;;
     XML::Bare::c_parse&#40; $self-&gt;{&#39;text&#39;} &#41;;
+    $self-&gt;{&#39;structroot&#39;} = XML::Bare::get_root&#40;&#41;;
   }
   bless $self, $class;
   return $self if&#40; !wantarray &#41;;
@@ -59,6 +61,7 @@
 
 sub DESTROY {
   my $self = shift;
+  $self-&gt;free_tree&#40;&#41;;
   undef $self-&gt;{&#39;xml&#39;};
 }
 
@@ -779,7 +782,13 @@
   return &#39;&#39;;
 }
 
-sub free_tree { my $self = shift; XML::Bare::free_tree_c&#40; $self-&gt;{&#39;structroot&#39;} &#41;; }
+sub free_tree {
+    my $self = shift;
+    if&#40;$self-&gt;{&#39;structroot&#39;}&#41; {
+	XML::Bare::free_tree_c&#40;$self-&gt;{&#39;structroot&#39;}&#41;;
+	delete&#40;$self-&gt;{&#39;structroot&#39;}&#41;;
+    }
+}
 
 1;
 
diff -ru XML-Bare-0.45/Bare.xs XML-Bare-0.45.new/Bare.xs
--- XML-Bare-0.45/Bare.xs	2009-08-02 17:12:19.000000000 -0400
+++ XML-Bare-0.45.new/Bare.xs	2009-12-16 11:28:17.879011654 -0500
@@ -227,6 +227,10 @@
       if&#40; i != &#40; length - 1 &#41; &#41; curnode = curnode-&gt;next;
     }
     curnode = curnode-&gt;parent;
+  } else {
+    SV * sv = newSVpvn&#40; curnode-&gt;value, curnode-&gt;vallen &#41;;
+    SvUTF8_on&#40;sv&#41;;
+    hv_store&#40; output, &#34;content&#34;, 7, sv, vhash &#41;;
   }
   
   if&#40; numatts &#41; {
@@ -242,23 +246,24 @@
   return outputref;
 }
 
-struct parserc *parser = 0;
-
 MODULE = XML::Bare         PACKAGE = XML::Bare
 
 SV *
 xml2obj&#40;&#41;
   CODE:
-    curnode = parser-&gt;pcurnode;
-    if&#40; curnode-&gt;err &#41; RETVAL = newSViv&#40; curnode-&gt;err &#41;;
-    else RETVAL = cxml2obj&#40;&#41;;
+    if&#40; root-&gt;err &#41; RETVAL = newSViv&#40; root-&gt;err &#41;;
+    else {
+      curnode = root;
+      RETVAL = cxml2obj&#40;&#41;;
+    }
   OUTPUT:
     RETVAL
     
 SV *
 xml2obj_simple&#40;&#41;
   CODE:
-    curnode = parser-&gt;pcurnode;
+    PERL_HASH&#40;vhash, &#34;content&#34;, 7&#41;;
+    curnode = root;
     RETVAL = cxml2obj_simple&#40;&#41;;
   OUTPUT:
     RETVAL
@@ -275,9 +280,8 @@
     PERL_HASH&#40;ihash, &#34;_i&#34;, 2 &#41;;
     PERL_HASH&#40;zhash, &#34;_z&#34;, 2 &#41;;
     PERL_HASH&#40;cdhash, &#34;_cdata&#34;, 6 &#41;;
-    parser = &#40;struct parserc *&#41; malloc&#40; sizeof&#40; struct parserc &#41; &#41;;
-    root = parserc_parse&#40; parser, text &#41;;
-    
+    root = parserc_parse&#40; text &#41;;
+
 void
 c_parsefile&#40;filename&#41;
   char * filename
@@ -305,8 +309,8 @@
     rootpos = data;
     fread&#40; data, 1, len, handle &#41;;
     fclose&#40; handle &#41;;
-    parser = &#40;struct parserc *&#41; malloc&#40; sizeof&#40; struct parserc &#41; &#41;;
-    root = parserc_parse&#40; parser, data &#41;;
+    root = parserc_parse&#40; data &#41;;
+    free&#40; data &#41;;
 
 SV *
 get_root&#40;&#41;
@@ -321,4 +325,4 @@
   CODE:
     struct nodec *rootnode;
     rootnode = INT2PTR&#40; struct nodec *, SvUV&#40; rootsv &#41; &#41;;
-    del_nodec&#40; rootnode &#41;;
\ No newline at end of file
+    del_nodec&#40; rootnode &#41;;
Only in XML-Bare-0.45.new: Makefile.old
diff -ru XML-Bare-0.45/parser.c XML-Bare-0.45.new/parser.c
--- XML-Bare-0.45/parser.c	2009-08-02 17:09:54.000000000 -0400
+++ XML-Bare-0.45.new/parser.c	2009-12-16 11:15:11.398014171 -0500
@@ -1,5 +1,6 @@
 #include &#34;parser.h&#34;
-#include&lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;stdio.h&gt;
 #ifdef DARWIN
   #include &#34;stdlib.h&#34;
 #endif
@@ -69,7 +70,7 @@
 
 //#define DEBUG
 
-struct nodec* parserc_parse&#40; struct parserc *self, char *xmlin &#41; {
+struct nodec* parserc_parse&#40; char *xmlin &#41; {
     char  *tagname, *attname, *attval, *val;
     struct nodec *root    = new_nodec&#40;&#41;;
     int    tagname_len    = 0;
@@ -582,15 +583,12 @@
       goto ename_x;
     error:
       root-&gt;err = - &#40; int &#41; &#40; cpos - &#38;xmlin[0] &#41;;
-      self-&gt;pcurnode = root;
       //root-&gt;err = 1;
       return root;
     done:
       #ifdef DEBUG
       printf&#40;&#34;done\n&#34;, *cpos&#41;;
       #endif
-      self-&gt;pcurnode = root;
-      self-&gt;pcurnode-&gt;curchild = self-&gt;pcurnode-&gt;firstchild;
       #ifdef DEBUG
       printf&#40;&#34;returning\n&#34;, *cpos&#41;;
       #endif
diff -ru XML-Bare-0.45/parser.h XML-Bare-0.45.new/parser.h
--- XML-Bare-0.45/parser.h	2009-08-02 17:09:54.000000000 -0400
+++ XML-Bare-0.45.new/parser.h	2009-12-16 11:22:14.918523469 -0500
@@ -50,9 +50,4 @@
 
 struct attc* new_attc&#40; struct nodec *newparent &#41;;
 
-struct parserc {
-  struct nodec *pcurnode;
-  struct attc  *curatt;
-};
-
-struct nodec* parserc_parse&#40; struct parserc *self, char *newbuf &#41;;
+struct nodec* parserc_parse&#40; char *newbuf &#41;;
diff -ru XML-Bare-0.45/t/Basic.t XML-Bare-0.45.new/t/Basic.t
--- XML-Bare-0.45/t/Basic.t	2009-08-02 17:10:02.000000000 -0400
+++ XML-Bare-0.45.new/t/Basic.t	2009-12-16 10:41:51.429041159 -0500
@@ -1,7 +1,6 @@
 #!/usr/bin/perl -w
 
 use strict;
-
 use Test::More qw&#40;no_plan&#41;;
 
 use_ok&#40; &#39;XML::Bare&#39;, qw/xmlin/ &#41;;
@@ -30,6 +29,10 @@
 is&#40; $root-&gt;{xml}-&gt;{node}-&gt;{value}, &#39;&lt;cval&gt;&#39;, &#39;reading of cdata&#39; &#41;;
 is&#40; $simple-&gt;{node}, &#39;&lt;cval&gt;&#39;, &#39;simple - reading of cdata&#39; &#41;;
 
+&#40; $xml, $root, $simple &#41; = reparse&#40; &#34;&lt;xml&gt;&lt;node att=\&#34;12\&#34;&gt;&lt;![CDATA[&lt;cval&gt;]]&gt;&lt;/node&gt;&lt;/xml&gt;&#34; &#41;;
+is&#40; $root-&gt;{xml}-&gt;{node}-&gt;{value}, &#39;&lt;cval&gt;&#39;, &#39;reading of cdata&#39; &#41;;
+is&#40; $simple-&gt;{node}-&gt;{content}, &#39;&lt;cval&gt;&#39;, &#39;simple - reading of cdata&#39; &#41;;
+
 &#40; $xml, $root, $simple &#41; = reparse&#40; &#34;&lt;xml&gt;&lt;node&gt;a&lt;/node&gt;&lt;node&gt;b&lt;/node&gt;&lt;/xml&gt;&#34; &#41;;
 is&#40; $root-&gt;{xml}-&gt;{node}-&gt;[1]-&gt;{value}, &#39;b&#39;, &#39;multiple node array creation&#39; &#41;;
 is&#40; $simple-&gt;{node}[1], &#39;b&#39;, &#39;simple - multiple node array creation&#39; &#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-707473" href="/Public/Bug/Display.html?id=52832#txn-707473">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;16&nbsp;12:21:36&nbsp;2009</span>
    <span class="description">mar.kolya [...] gmail.com -  Severity Normal added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-707474" href="/Public/Bug/Display.html?id=52832#txn-707474">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;16&nbsp;12:21:36&nbsp;2009</span>
    <span class="description">mar.kolya [...] gmail.com -  Broken in 0.45 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1204974" href="/Public/Bug/Display.html?id=52832#txn-1204974">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;24&nbsp;13:35:13&nbsp;2013</span>
    <span class="description">cpan [...] codechild.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1204974/636234/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/636234">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The module has been changed to work in a multi-threaded environment in version 0.48. Note that the patch you provided was included in the 0.46 and 0.47 versions of the module, but the changes are no longer included, for specific reasons.

The parser should be freed immediately in all cases. It is done whenever a parser is allocated, not on destruction of the objection. The parser does not need to live for the life of the object the way the module works. More changes still need to be made to ensure error handling is still done properly.

The get_root function has been removed entirely because it is not needed.

The patch seems to arbitrarily include &#34;stdlib.h&#34; even when it is not needed. Is there some purpose to this?

The patch removes &#39;pcurnode&#39; references within the module. In fact, it removes all references to the parser object entirely. This is unacceptable; while the parser object is not used to potential right now, it is there intentionally so that it can be extended to allow error checking to be more advanced and pass state of the parser back to perl.

I believe it is true that there are additional memory leaks in the system, but I don&#39;t believe these patches address those additional problems. &#40; nor is it described here when those occur &#41;

In summary, the issue described by this ticket should be fixed in 0.48 and 0.49. It was also &#34;fixed&#34; in 0.46 and 0.47, but not in an appropriate fashion.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1204975" href="/Public/Bug/Display.html?id=52832#txn-1204975">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;24&nbsp;13:35:13&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1204977" href="/Public/Bug/Display.html?id=52832#txn-1204977">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;24&nbsp;13:35:13&nbsp;2013</span>
    <span class="description">cpan [...] codechild.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1204979" href="/Public/Bug/Display.html?id=52832#txn-1204979">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;24&nbsp;13:35:14&nbsp;2013</span>
    <span class="description">cpan [...] codechild.com -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1204980" href="/Public/Bug/Display.html?id=52832#txn-1204980">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;24&nbsp;13:35:24&nbsp;2013</span>
    <span class="description">cpan [...] codechild.com -  Fixed in 0.48 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.381103</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
