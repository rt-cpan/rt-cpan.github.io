<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #101579 for DBD-ODBC: Issue with bound parameters in DBD-ODBC 1.50 &#40;DB is SQLServer 2008 10.0.5500&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #101579 for DBD-ODBC: Issue with bound parameters in DBD-ODBC 1.50 &#40;DB is SQLServer 2008 10.0.5500&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-ODBC">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-ODBC">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-ODBC">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-ODBC">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-ODBC">DBD-ODBC CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">101579</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-ODBC">DBD-ODBC</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
lorgle [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10188-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10189-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.51_3    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




test_load.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1454016/773414/test_load.pl">
Fri Jan 16 17:57:34 2015 (2k) by lorgle [...] gmail.com
</a>
</font></li>
</ul>


test_output_DBD-ODBC-1.43.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1454016/773413/test_output_DBD-ODBC-1.43.txt">
Fri Jan 16 17:57:34 2015 (516b) by lorgle [...] gmail.com
</a>
</font></li>
</ul>


test_output_DBD-ODBC-1.50.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1454016/773415/test_output_DBD-ODBC-1.50.txt">
Fri Jan 16 17:57:34 2015 (808b) by lorgle [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=101579">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454016" href="/Public/Bug/Display.html?id=101579#txn-1454016">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;16&nbsp;17:57:34&nbsp;2015</span>
    <span class="description">lorgle [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Issue with bound parameters in DBD-ODBC 1.50 &#40;DB is SQLServer 2008 10.0.5500&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Jan 2015 14:56:54 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> laura &lt;lorgle [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454016/773411/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773411">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi there,

Found this address as the quickest way to report a bug in DBD::ODBC via
rt.cpan.org/Public/Bug/Report.html?Queue=DBD-ODBC so am writing.

Distribution: DBD-ODBC-1.50
Perl version: 5.20.1 &#40;Strawberry perl, 32-bit version&#41;
Operating System: MS Windows 7 Professional SP1

We ran into some odd behavior with DBD::ODBC when we upgraded from 1.43 to
1.50 recently - previously-working insert statements &#40;using placeholders&#41;
started failing with a &#34;DBD::ODBC::st execute failed: [Microsoft][ODBC SQL
Server Driver]String data, right truncation &#40;SQL-22001&#41;&#34; error message -
even if the only data being inserted was numeric.  Not all inserts failed,
but the majority did &#40;982 out of 1000 would fail&#41;.  I tried a little
testing &#40;test_load.pl, attached&#41; and found that the first insert would
succeed, but subsequent ones failed, regardless of the data values being
inserted.  I could get the inserts working if, instead of using
placeholders, I built the statement anew for each row.  &#40;Of course, that
came along with a significant performance hit.&#41;

Reverting to DBD-ODBC-1.43 resulted in all methods being able to
successfully insert the data into our table.

The output of the test script running with DBD-ODBC-1.50 is attached
&#40;test_output_DBD-ODBC-1.50.txt&#41;, as is the output of the same script
running with DBD-ODBC-1.43 &#40;test_output_DBD-ODBC-1.43.txt&#41;.

If there&#39;s more info/traces I can gather that would be helpful, just let me
know and I&#39;d be happy to.

Thank you for making DBD-ODBC possible!

Laura
lorgle@gmail.com
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454016/773412/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773412">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.4k</span>
</div>
<div class="messagebody">
</div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454016/773413/test_output_DBD-ODBC-1.43.txt">Download test_output_DBD-ODBC-1.43.txt</a><br />
<span class="downloadcontenttype">text/plain 516b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454016/773414/test_load.pl">Download test_load.pl</a><br />
<span class="downloadcontenttype">text/x-perl 2k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454016/773415/test_output_DBD-ODBC-1.50.txt">Download test_output_DBD-ODBC-1.50.txt</a><br />
<span class="downloadcontenttype">text/plain 808b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454104" href="/Public/Bug/Display.html?id=101579#txn-1454104">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;04:16:34&nbsp;2015</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454104/773454/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773454">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jan 16 17:57:34 2015, lorgle@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi there,
&gt; 
&gt; Found this address as the quickest way to report a bug in DBD::ODBC via
&gt; rt.cpan.org/Public/Bug/Report.html?Queue=DBD-ODBC so am writing.
&gt; 
&gt; Distribution: DBD-ODBC-1.50
&gt; Perl version: 5.20.1 &#40;Strawberry perl, 32-bit version&#41;
&gt; Operating System: MS Windows 7 Professional SP1
&gt; 
&gt; We ran into some odd behavior with DBD::ODBC when we upgraded from 1.43 to
&gt; 1.50 recently - previously-working insert statements &#40;using placeholders&#41;
&gt; started failing with a &#34;DBD::ODBC::st execute failed: [Microsoft][ODBC SQL
&gt; Server Driver]String data, right truncation &#40;SQL-22001&#41;&#34; error message -
&gt; even if the only data being inserted was numeric.  Not all inserts failed,
&gt; but the majority did &#40;982 out of 1000 would fail&#41;.  I tried a little
&gt; testing &#40;test_load.pl, attached&#41; and found that the first insert would
&gt; succeed, but subsequent ones failed, regardless of the data values being
&gt; inserted.  I could get the inserts working if, instead of using
&gt; placeholders, I built the statement anew for each row.  &#40;Of course, that
&gt; came along with a significant performance hit.&#41;
&gt; 
&gt; Reverting to DBD-ODBC-1.43 resulted in all methods being able to
&gt; successfully insert the data into our table.
&gt; 
&gt; The output of the test script running with DBD-ODBC-1.50 is attached
&gt; &#40;test_output_DBD-ODBC-1.50.txt&#41;, as is the output of the same script
&gt; running with DBD-ODBC-1.43 &#40;test_output_DBD-ODBC-1.43.txt&#41;.
&gt; 
&gt; If there&#39;s more info/traces I can gather that would be helpful, just let me
&gt; know and I&#39;d be happy to.
&gt; 
&gt; Thank you for making DBD-ODBC possible!
&gt; 
&gt; Laura
&gt; lorgle@gmail.com
</div>
Thanks for the RT.

Just to let you know I have reproduced it with you example and will try and find the problem this weekend.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454105" href="/Public/Bug/Display.html?id=101579#txn-1454105">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;04:16:34&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454111" href="/Public/Bug/Display.html?id=101579#txn-1454111">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;04:51:09&nbsp;2015</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454111/773460/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773460">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jan 17 04:16:34 2015, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Jan 16 17:57:34 2015, lorgle@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; Hi there,
&gt; &gt;
&gt; &gt; Found this address as the quickest way to report a bug in DBD::ODBC
&gt; &gt; via
&gt; &gt; rt.cpan.org/Public/Bug/Report.html?Queue=DBD-ODBC so am writing.
&gt; &gt;
&gt; &gt; Distribution: DBD-ODBC-1.50
&gt; &gt; Perl version: 5.20.1 &#40;Strawberry perl, 32-bit version&#41;
&gt; &gt; Operating System: MS Windows 7 Professional SP1
&gt; &gt;
&gt; &gt; We ran into some odd behavior with DBD::ODBC when we upgraded from
&gt; &gt; 1.43 to
&gt; &gt; 1.50 recently - previously-working insert statements &#40;using
&gt; &gt; placeholders&#41;
&gt; &gt; started failing with a &#34;DBD::ODBC::st execute failed:
&gt; &gt; [Microsoft][ODBC SQL
&gt; &gt; Server Driver]String data, right truncation &#40;SQL-22001&#41;&#34; error
&gt; &gt; message -
&gt; &gt; even if the only data being inserted was numeric.  Not all inserts
&gt; &gt; failed,
&gt; &gt; but the majority did &#40;982 out of 1000 would fail&#41;.  I tried a little
&gt; &gt; testing &#40;test_load.pl, attached&#41; and found that the first insert
&gt; &gt; would
&gt; &gt; succeed, but subsequent ones failed, regardless of the data values
&gt; &gt; being
&gt; &gt; inserted.  I could get the inserts working if, instead of using
&gt; &gt; placeholders, I built the statement anew for each row.  &#40;Of course,
&gt; &gt; that
&gt; &gt; came along with a significant performance hit.&#41;
&gt; &gt;
&gt; &gt; Reverting to DBD-ODBC-1.43 resulted in all methods being able to
&gt; &gt; successfully insert the data into our table.
&gt; &gt;
&gt; &gt; The output of the test script running with DBD-ODBC-1.50 is attached
&gt; &gt; &#40;test_output_DBD-ODBC-1.50.txt&#41;, as is the output of the same script
&gt; &gt; running with DBD-ODBC-1.43 &#40;test_output_DBD-ODBC-1.43.txt&#41;.
&gt; &gt;
&gt; &gt; If there&#39;s more info/traces I can gather that would be helpful, just
&gt; &gt; let me
&gt; &gt; know and I&#39;d be happy to.
&gt; &gt;
&gt; &gt; Thank you for making DBD-ODBC possible!
&gt; &gt;
&gt; &gt; Laura
&gt; &gt; lorgle@gmail.com
</div>&gt; 
&gt; Thanks for the RT.
&gt; 
&gt; Just to let you know I have reproduced it with you example and will
&gt; try and find the problem this weekend.
&gt; 
&gt; Martin
</div>
Hi,

I&#39;ve fixed the problem.

If you could let me know your real name I&#39;ll credit you with finding the issue in the Changes file.

Would you be prepared to test the fix? If so, let me know and I&#39;ll mail you a new distribution.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454157" href="/Public/Bug/Display.html?id=101579#txn-1454157">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;08:51:24&nbsp;2015</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454157/773495/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773495">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jan 17 04:51:09 2015, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Sat Jan 17 04:16:34 2015, MJEVANS wrote:
<div class="message-stanza open">&gt; &gt; On Fri Jan 16 17:57:34 2015, lorgle@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; Hi there,
&gt; &gt; &gt;
&gt; &gt; &gt; Found this address as the quickest way to report a bug in DBD::ODBC
&gt; &gt; &gt; via
&gt; &gt; &gt; rt.cpan.org/Public/Bug/Report.html?Queue=DBD-ODBC so am writing.
&gt; &gt; &gt;
&gt; &gt; &gt; Distribution: DBD-ODBC-1.50
&gt; &gt; &gt; Perl version: 5.20.1 &#40;Strawberry perl, 32-bit version&#41;
&gt; &gt; &gt; Operating System: MS Windows 7 Professional SP1
&gt; &gt; &gt;
&gt; &gt; &gt; We ran into some odd behavior with DBD::ODBC when we upgraded from
&gt; &gt; &gt; 1.43 to
&gt; &gt; &gt; 1.50 recently - previously-working insert statements &#40;using
&gt; &gt; &gt; placeholders&#41;
&gt; &gt; &gt; started failing with a &#34;DBD::ODBC::st execute failed:
&gt; &gt; &gt; [Microsoft][ODBC SQL
&gt; &gt; &gt; Server Driver]String data, right truncation &#40;SQL-22001&#41;&#34; error
&gt; &gt; &gt; message -
&gt; &gt; &gt; even if the only data being inserted was numeric.  Not all inserts
&gt; &gt; &gt; failed,
&gt; &gt; &gt; but the majority did &#40;982 out of 1000 would fail&#41;.  I tried a
&gt; &gt; &gt; little
&gt; &gt; &gt; testing &#40;test_load.pl, attached&#41; and found that the first insert
&gt; &gt; &gt; would
&gt; &gt; &gt; succeed, but subsequent ones failed, regardless of the data values
&gt; &gt; &gt; being
&gt; &gt; &gt; inserted.  I could get the inserts working if, instead of using
&gt; &gt; &gt; placeholders, I built the statement anew for each row.  &#40;Of course,
&gt; &gt; &gt; that
&gt; &gt; &gt; came along with a significant performance hit.&#41;
&gt; &gt; &gt;
&gt; &gt; &gt; Reverting to DBD-ODBC-1.43 resulted in all methods being able to
&gt; &gt; &gt; successfully insert the data into our table.
&gt; &gt; &gt;
&gt; &gt; &gt; The output of the test script running with DBD-ODBC-1.50 is
&gt; &gt; &gt; attached
&gt; &gt; &gt; &#40;test_output_DBD-ODBC-1.50.txt&#41;, as is the output of the same
&gt; &gt; &gt; script
&gt; &gt; &gt; running with DBD-ODBC-1.43 &#40;test_output_DBD-ODBC-1.43.txt&#41;.
&gt; &gt; &gt;
&gt; &gt; &gt; If there&#39;s more info/traces I can gather that would be helpful,
&gt; &gt; &gt; just
&gt; &gt; &gt; let me
&gt; &gt; &gt; know and I&#39;d be happy to.
&gt; &gt; &gt;
&gt; &gt; &gt; Thank you for making DBD-ODBC possible!
&gt; &gt; &gt;
&gt; &gt; &gt; Laura
&gt; &gt; &gt; lorgle@gmail.com
</div>&gt; &gt;
&gt; &gt; Thanks for the RT.
&gt; &gt;
&gt; &gt; Just to let you know I have reproduced it with you example and will
&gt; &gt; try and find the problem this weekend.
&gt; &gt;
&gt; &gt; Martin
</div>&gt; 
&gt; Hi,
&gt; 
&gt; I&#39;ve fixed the problem.
&gt; 
&gt; If you could let me know your real name I&#39;ll credit you with finding
&gt; the issue in the Changes file.
&gt; 
&gt; Would you be prepared to test the fix? If so, let me know and I&#39;ll
&gt; mail you a new distribution.
&gt; 
&gt; Martin
</div>
I&#39;ve uploaded 1.51_3 and 1.51_4 development releases which should fix your issue.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454186" href="/Public/Bug/Display.html?id=101579#txn-1454186">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;10:08:56&nbsp;2015</span>
    <span class="description">bohica [...] ntlworld.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454188" href="/Public/Bug/Display.html?id=101579#txn-1454188">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;10:09:06&nbsp;2015</span>
    <span class="description">bohica [...] ntlworld.com -  Fixed in 1.51_3 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454194" href="/Public/Bug/Display.html?id=101579#txn-1454194">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;11:27:28&nbsp;2015</span>
    <span class="description">lorgle [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101579] Resolved: Issue with bound parameters in DBD-ODBC 1.50 &#40;DB is SQLServer 2008 10.0.5500&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 17 Jan 2015 08:26:53 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> laura &lt;lorgle [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454194/773519/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773519">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 601b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fantastic, thanks!  Having trouble with the bitcard login so hopefully this
will get back to you.

My full name is Laura Cox and I&#39;ll be happy to test out the fix - won&#39;t be
back in the office till Monday but will download the new releases then to
test.

Many thanks for the quick action on this.

Laura

On Sat, Jan 17, 2015 at 7:08 AM, Martin J Evans via RT &lt;
bug-DBD-ODBC@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101579">https://rt.cpan.org/Ticket/Display.html?id=101579</a></span> &gt;
&gt;
&gt; According to our records, your request has been resolved. If you have any
&gt; further questions or concerns, please respond to this message.
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454194/773520/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773520">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.5k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454196" href="/Public/Bug/Display.html?id=101579#txn-1454196">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;17&nbsp;11:47:15&nbsp;2015</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454196/773522/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773522">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 869b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jan 17 11:27:28 2015, lorgle@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Fantastic, thanks!  Having trouble with the bitcard login so hopefully this
&gt; will get back to you.
&gt; 
&gt; My full name is Laura Cox and I&#39;ll be happy to test out the fix - won&#39;t be
&gt; back in the office till Monday but will download the new releases then to
&gt; test.
&gt; 
&gt; Many thanks for the quick action on this.
&gt; 
&gt; Laura
</div>
Thanks Laura. I&#39;ve updated the changes file and it will be in the next release.

In the meantime either of 1.51_3 or 1.51_4 should contain the fix for you but I&#39;d obviously prefer you to try 1.51_4.

See the Changes file for the reason for the problem you found but basically it boils down to improving the unicode support which broke your case with numerics.

Please get back to me with results.

You can also find me as mje on irc.perl.org in #dbi.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454739" href="/Public/Bug/Display.html?id=101579#txn-1454739">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;19&nbsp;09:31:59&nbsp;2015</span>
    <span class="description">lorgle [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101579] Issue with bound parameters in DBD-ODBC 1.50 &#40;DB is SQLServer 2008 10.0.5500&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 19 Jan 2015 06:31:19 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> laura &lt;lorgle [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454739/773873/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773873">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Martin,

I installed 1.51_4 and tested out our loading script and everything worked
successfully.

Thanks again for your quick action on this!

Laura

On Sat, Jan 17, 2015 at 8:47 AM, Martin J Evans via RT &lt;
bug-DBD-ODBC@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101579">https://rt.cpan.org/Ticket/Display.html?id=101579</a></span> &gt;
&gt;
&gt; On Sat Jan 17 11:27:28 2015, lorgle@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; Fantastic, thanks!  Having trouble with the bitcard login so hopefully
</div>&gt; this
<div class="message-stanza open">&gt; &gt; will get back to you.
&gt; &gt;
&gt; &gt; My full name is Laura Cox and I&#39;ll be happy to test out the fix - won&#39;t
</div>&gt; be
<div class="message-stanza open">&gt; &gt; back in the office till Monday but will download the new releases then to
&gt; &gt; test.
&gt; &gt;
&gt; &gt; Many thanks for the quick action on this.
&gt; &gt;
&gt; &gt; Laura
</div>&gt;
&gt; Thanks Laura. I&#39;ve updated the changes file and it will be in the next
&gt; release.
&gt;
&gt; In the meantime either of 1.51_3 or 1.51_4 should contain the fix for you
&gt; but I&#39;d obviously prefer you to try 1.51_4.
&gt;
&gt; See the Changes file for the reason for the problem you found but
&gt; basically it boils down to improving the unicode support which broke your
&gt; case with numerics.
&gt;
&gt; Please get back to me with results.
&gt;
&gt; You can also find me as mje on irc.perl.org in #dbi.
&gt;
&gt; Martin
&gt; --
&gt; Martin J. Evans
&gt; Wetherby, UK
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454739/773874/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773874">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2.4k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1454741" href="/Public/Bug/Display.html?id=101579#txn-1454741">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;19&nbsp;09:37:09&nbsp;2015</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1454741/773876/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/773876">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 499b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jan 19 09:31:59 2015, lorgle@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Martin,
&gt; 
&gt; I installed 1.51_4 and tested out our loading script and everything
&gt; worked
&gt; successfully.
&gt; 
&gt; Thanks again for your quick action on this!
&gt; 
&gt; Laura
</div>
Hi Laura,

Thanks for coming back and confirming that.

Also, it makes it so much easier to find an issue when the reporter provides a self contained script demonstrating the problem. So, you helped yourself get a quicker reponse ;-&#41;

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.541231</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
