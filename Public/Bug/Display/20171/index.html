<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #20171 for Tie-DxHash: Tie::DxHash bug... internal pointer not being reset?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #20171 for Tie-DxHash: Tie::DxHash bug... internal pointer not being reset?</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Tie-DxHash">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Tie-DxHash">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Tie-DxHash">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Tie-DxHash">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Tie-DxHash">Tie-DxHash CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">20171</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Tie-DxHash">Tie-DxHash</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">KRUSCOE [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cpan [...] mfoxx.myspamkiller.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-32902-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.93    </td>
  </tr>
  <tr id="CF-32903-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




tie_dxhash_bug_demo.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/215211/85842/tie_dxhash_bug_demo.txt">
Wed Jun 28 16:24:51 2006 (1.8k) by Guest
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=20171">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-215211" href="/Public/Bug/Display.html?id=20171#txn-215211">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;28&nbsp;16:24:51&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Tie::DxHash bug... internal pointer not being reset?</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/215211/85839/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/85839">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Tie::DxHash v0.93 &#40;i assume, just got it today by doing a 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">CPAN&gt;install command&#41;.
</div>
* Perl v5.8.8

* 2.6.9-xenU #2 Wed Nov 10 13:54:13 CST 2004 i686 GNU/Linux  &#40;debian 
3.0 linux build&#41;.

I am trying to use Tie::DxHash inside of &lt;Perl&gt; sections in my 
httpd.conf file &#40;apache 2.0.54 with mod_perl 2.0.2&#41;.  I put together 
this simplified sample code &#40;that I&#39;ve attached&#41; to demonstrate the 
issue I&#39;m having with the package.

**HOWEVER** I also tested the attached code in just a simple .pl perl 
program, and it also behaves exactly the same way.

Basically, you can see the code has 3 sections in it.  

The first one demonstrates using Tie::IxHash.  You can see that 
ordering is maintained &#40;unlike a regular hash&#41; as expected, but that 
duplicate indexes are overwritten, rather than duplicated.

The second section demonstrates the same code with Tie::DxHash 
instead.  Also, notice I have commented out the call to the &#34;keys&#34; 
function in this section.  The output is as expected, order is 
preserved, and duplicate keys are not overwritten but added to the end.

The third section illustrates the &#34;bug&#34;.  By simply uncommenting out 
the call to the keys function, it causes the rest of the assignment 
calls that add key/value pairs to the hash to &#34;fail&#34; &#40;apparently, 
though no warning output or errors seem to be given&#41;.  The result 
output then only shows the original contents of the hash before the 
call to &#34;keys&#34;.

I had some working code doing something similar, with IxHash, but have 
run across the need for duplicate keys, so I tried to just switch to 
DxHash, and have run into this issue now.

I actually discovered this *not* while using &#34;keys&#34;, but using a while 
loop with &#34;each&#34;, but the behavior is exactly the same.  I thought 
from what I read online that &#34;keys&#34; function calls should reset an 
internal iteration pointer &#40;that &#34;each&#34; is using, for instance&#41;, and 
so I guessed that perhaps DxHash had some issue with not resetting 
after the last call to &#34;each&#34;, so I tried to put in the &#34;keys&#34; call, 
as a bunch of websites say to do, and still, nothing.

This simplified example in the attached code shows that merely 
obtaining the number of keys &#40;with keys in the scalar context&#41; messes 
something up with the hash, so that it cannot be added to after that.

In fact, to add to the mix, in the perl only version &#40;not in apache&#41;, 
i get some additional warning output when I make a call to the &#34;print 
Dumper&#34;, *then* add some values, *then* &#34;print Dumper&#34; again.  The 
warning output doesn&#39;t occur until that second call to the attempted-
changed hash, and it says &#34;Use of uninitialized value in string eq 
at /usr/local/lib/perl5/site_perl/5.8.8/Tie/DxHash.pm line 69.&#34;

So, my guess from all of this is that there is some bug with how 
Tie::DxHash is handling and resetting the internal iterator/pointer.  
Can you confirm such?  Fix or workaround?
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> tie_dxhash_bug_demo.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/215211/85842/tie_dxhash_bug_demo.txt">Download tie_dxhash_bug_demo.txt</a><br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;Perl&gt;

use Data::Dumper;
use Tie::DxHash;
use Tie::IxHash;

#################################################################################

my %ix_temp;
tie&#40;%ix_temp, Tie::IxHash&#41;;

$ix_temp{&#34;a&#34;} = &#39;1&#39;;
$ix_temp{&#34;b&#34;} = &#39;2&#39;;
$ix_temp{&#34;c&#34;} = &#39;3&#39;;

my $ix_keys = scalar keys %ix_temp;

$ix_temp{&#34;a&#34;} = &#39;sss&#39;;
$ix_temp{&#34;b&#34;} = &#39;ttt&#39;;
$ix_temp{&#34;f&#34;} = &#39;3&#39;;

print Dumper %ix_temp;

# prints out:
#   $VAR1 = &#39;a&#39;;
#   $VAR2 = &#39;sss&#39;;
#   $VAR3 = &#39;b&#39;;
#   $VAR4 = &#39;ttt&#39;;
#   $VAR5 = &#39;c&#39;;
#   $VAR6 = &#39;3&#39;;
#   $VAR7 = &#39;f&#39;;
#   $VAR8 = &#39;3&#39;;
#
# correct, expected behavior

#################################################################################

my %dx_temp;
tie&#40;%dx_temp, Tie::DxHash&#41;;

$dx_temp{&#34;a&#34;} = &#39;1&#39;;
$dx_temp{&#34;b&#34;} = &#39;2&#39;;
$dx_temp{&#34;c&#34;} = &#39;3&#39;;

#my $dx_keys = scalar keys %dx_temp;

$dx_temp{&#34;a&#34;} = &#39;sss&#39;;
$dx_temp{&#34;b&#34;} = &#39;ttt&#39;;
$dx_temp{&#34;f&#34;} = &#39;3&#39;;

print Dumper %dx_temp;

# prints out:
#   $VAR1 = &#39;a&#39;;
#   $VAR2 = &#39;1&#39;;
#   $VAR3 = &#39;b&#39;;
#   $VAR4 = &#39;2&#39;;
#   $VAR5 = &#39;c&#39;;
#   $VAR6 = &#39;3&#39;;
#   $VAR7 = &#39;a&#39;;
#   $VAR8 = &#39;sss&#39;;
#   $VAR9 = &#39;b&#39;;
#   $VAR10 = &#39;ttt&#39;;
#   $VAR11 = &#39;f&#39;;
#   $VAR12 = &#39;3&#39;;
#
# correct, expected behavior, notice the &#34;keys&#34; function call is commented out

#################################################################################

my %dx_temp2;
tie&#40;%dx_temp2, Tie::DxHash&#41;;

$dx_temp2{&#34;a&#34;} = &#39;1&#39;;
$dx_temp2{&#34;b&#34;} = &#39;2&#39;;
$dx_temp2{&#34;c&#34;} = &#39;3&#39;;

my $dx_keys2 = scalar keys %dx_temp2;

$dx_temp2{&#34;a&#34;} = &#39;sss&#39;;
$dx_temp2{&#34;b&#34;} = &#39;ttt&#39;;
$dx_temp2{&#34;f&#34;} = &#39;3&#39;;

print Dumper %dx_temp2;

# prints out:
#   $VAR1 = &#39;a&#39;;
#   $VAR2 = &#39;1&#39;;
#   $VAR3 = &#39;b&#39;;
#   $VAR4 = &#39;2&#39;;
#   $VAR5 = &#39;c&#39;;
#   $VAR6 = &#39;3&#39;;
#
# unexpected behavior/bug. calling &#34;keys&#34; function apparently causes subsequent assignments to the hash to fail.

&lt;/Perl&gt;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275397" href="/Public/Bug/Display.html?id=20171#txn-275397">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;20:33:18&nbsp;2006</span>
    <span class="description">KRUSCOE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/275397/122968/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/122968">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 642b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So, my guess from all of this is that there is some bug with how 
&gt; Tie::DxHash is handling and resetting the internal iterator/pointer.  
&gt; Can you confirm such?  Fix or workaround?
</div>
Many thanks for the bug report and sorry for not getting back to you
&#40;much&#41; sooner.  I have been at sea for the past two years and only
arrived in Australia a couple of weeks ago.

As you suggest, the bug &#40;actually in the implementation of the NEXTKEY
method&#41; is highlighted when using any function which resets the hash&#39;s
internal iterator.

The latest updated version fixes the issue.  Please let me know if you
have any more problems.

Regards
Kevin
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275398" href="/Public/Bug/Display.html?id=20171#txn-275398">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;20:33:21&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275400" href="/Public/Bug/Display.html?id=20171#txn-275400">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;20:33:22&nbsp;2006</span>
    <span class="description">KRUSCOE [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275402" href="/Public/Bug/Display.html?id=20171#txn-275402">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;20:33:24&nbsp;2006</span>
    <span class="description">KRUSCOE [...] cpan.org -  Given to KRUSCOE</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-279197" href="/Public/Bug/Display.html?id=20171#txn-279197">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;27&nbsp;10:29:23&nbsp;2006</span>
    <span class="description">mfoxx [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20171] Tie::DxHash bug... internal pointer not being reset?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Dec 2006 09:32:04 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Tie-DxHash [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;mfoxx&#34; &lt;mfoxx [...] hotmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/279197/124855/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/124855">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Kevin-
Thank you so much for responding.  I included your new version, and it works
great!  Guess it paid to be patient on this one... I just went back to using
IxHash when I discovered the issue with DxHash, and just figured since I
didn&#39;t really have a pressing need for the DxHash functionality quite yet,
I&#39;d just wait and be patient to see if a fix ever came, and it finally did!

BTW, I am using this in conjunction with some perl code I wrote and embedded
in my httpd.conf file, which actually pulls all my virtual host info from a
mysql database, instead of being in the conf file itself.  I do this so I
can manage virtual hosts via web scripts that modify the database tables,
and never need to interact with the file, thereby being safer.  The need for
DxHash comes in that, for instance, I may want to have 2 or 3 entries for a
virtual host that are &#34;ServerAlias&#34;.  This gives rise to the need for
duplicate keys.  I need the ordering functionality &#40;like IxHash&#41; because
there are a few apache vhost directives in which their order inside the
entry matters, so I maintain an order-override column in my database to
force certain particular configurables &#40;from IxHash&#41; to be the first in the
vhost perl hash, but without DxHash, the behavior was unpredictable.
Neither of these needs had been a problem actually yet, but it might have
been in the future, so I definitely appreciate the updated code.

Actually, there was one particular use which necessitated at least IxHash
usage in the first place.  One peculiarity of Apache is that in a multiple
vhost config environment, the very first vhost configuration found is the
one used for any default, later unmatched apache requests.  So, say one of
the vhosts is disabled &#40;for an account being on hold, for instance&#41;... I
need for the very first vhost entry, the default one for the server, to take
over.  Of course, this means I need to control what goes into the first
entry, thus the need for an order preserving hash.  :&#41;

I currently have about 300 records across about 40 virtual host entries, and
my apache starts up almost instantaneously, so I don&#39;t think speed of the
key algorithm as you mentioned in the documentation is any problem for my
data set size.  Even if I had a much larger data set, and Apache took 5 or
10 seconds to load, since I rarely restart apache, and even then only when
apache config data would change, which should be not very often at all, I
think even a 30 second or more restart time wouldn&#39;t be *that* bad.

But, just out of curiosity, at about how many records &#40;loop iterations, hash
key inserts, etc&#41; would you think this DxHash code might have speed issues
where it was taking say greater than 10 seconds to loop through?  10,000?
more?

--Kyle Simpson








<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Kevin Ruscoe via RT&#34; &lt;bug-Tie-DxHash@rt.cpan.org&gt;
To: &lt;cpan@mfoxx.myspamkiller.com&gt;
Sent: Monday, December 11, 2006 7:33 PM
Subject: [rt.cpan.org #20171] Tie::DxHash bug... internal pointer not being
reset?


<div class="message-stanza open">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=20171">http://rt.cpan.org/Ticket/Display.html?id=20171</a></span> &gt;
&gt;
&gt; Hi
&gt;
<div class="message-stanza open">&gt; &gt; So, my guess from all of this is that there is some bug with how
&gt; &gt; Tie::DxHash is handling and resetting the internal iterator/pointer.
&gt; &gt; Can you confirm such?  Fix or workaround?
</div>&gt;
&gt; Many thanks for the bug report and sorry for not getting back to you
&gt; &#40;much&#41; sooner.  I have been at sea for the past two years and only
&gt; arrived in Australia a couple of weeks ago.
&gt;
&gt; As you suggest, the bug &#40;actually in the implementation of the NEXTKEY
&gt; method&#41; is highlighted when using any function which resets the hash&#39;s
&gt; internal iterator.
&gt;
&gt; The latest updated version fixes the issue.  Please let me know if you
&gt; have any more problems.
&gt;
&gt; Regards
&gt; Kevin
&gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-279198" href="/Public/Bug/Display.html?id=20171#txn-279198">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;27&nbsp;10:29:26&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-279257" href="/Public/Bug/Display.html?id=20171#txn-279257">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;27&nbsp;18:42:28&nbsp;2006</span>
    <span class="description">kevin [...] sapphireoflondon.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #20171] Tie::DxHash bug... internal pointer not being reset?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Dec 2006 09:42:01 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Tie-DxHash [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ruscoe &lt;kevin [...] sapphireoflondon.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/279257/124893/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/124893">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 879b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Kyle

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; I included your new version, and it works great!
</div>
Good stuff.  Apologies again that it took so long.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; which actually pulls all my virtual host info from a mysql database, 
</div>instead of being in the conf file itself

That sounds like a good option.  I have never had the need myself, since 
I have never needed more than
a handful of vhosts which did not change very often.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; at about how many records &#40;loop iterations, hash key inserts, etc&#41; 
</div>would you think this DxHash code
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; might have speed issues where it was taking say greater than 10 
</div>seconds to loop through? 10,000?

Probably at least that many.  I only mentioned that in the docs in case 
somebody found a use for the
module - unrelated to Apache cfg - which involved much larger data 
sets.  I should not imagine that any
performance problems would arise when used to configure Apache.

Regards
Kevin
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-390463" href="/Public/Bug/Display.html?id=20171#txn-390463">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;20:29:03&nbsp;2007</span>
    <span class="description">KRUSCOE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/390463/179463/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/179463">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 76b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This was resolved several months ago.  Think it was reset to open in errorl
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-390465" href="/Public/Bug/Display.html?id=20171#txn-390465">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;20:29:10&nbsp;2007</span>
    <span class="description">KRUSCOE [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.611387</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
