<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #55660 for Win32-API: [PATCH] Partial win64 support for Win32::API</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #55660 for Win32-API: [PATCH] Partial win64 support for Win32::API</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Win32-API">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Win32-API">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Win32-API">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Win32-API">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-API">Win32-API CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">55660</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">3 hours (180 min)

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Win32-API">Win32-API</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">BULKDD [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
RIVY [...] cpan.org

<br />
SBennett [...] accelrys.com

<br />
steven.bauer [...] amd.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
KENTNL [...] cpan.org

<br />
kmx [...] cpan.org

<br />
ROBINS [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35436-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35437-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




0001-Don-t-build-or-test-Callback-module-on-x64_64-it-doe.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/801785/415649/0001-Don-t-build-or-test-Callback-module-on-x64_64-it-doe.patch">
Fri Jul 09 05:26:39 2010 (2k) by SBennett [...] accelrys.com
</a>
</font></li>
</ul>


0001-Split-the-platform-specific-parts-of-Call-into-a-sep.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/749196/387413/0001-Split-the-platform-specific-parts-of-Call-into-a-sep.patch">
Wed Mar 17 10:09:55 2010 (17k) by SBennett [...] accelrys.com
</a>
</font></li>
</ul>


0002-Add-support-for-DWORD_PTR-type-in-function-arguments.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/801785/415650/0002-Add-support-for-DWORD_PTR-type-in-function-arguments.patch">
Fri Jul 09 05:26:39 2010 (48.9k) by SBennett [...] accelrys.com
</a>
</font></li>
</ul>


0002-Initial-x86_64-support-in-Win32-API.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/749196/387414/0002-Initial-x86_64-support-in-Win32-API.patch">
Wed Mar 17 10:09:56 2010 (7.2k) by SBennett [...] accelrys.com
</a>
</font></li>
</ul>


0003-Add-an-x64-platform-to-the-API_test-project-and-an-x.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/749196/387412/0003-Add-an-x64-platform-to-the-API_test-project-and-an-x.patch">
Wed Mar 17 10:09:54 2010 (60.5k) by SBennett [...] accelrys.com
</a>
</font></li>
</ul>


0004-Add-a-x64-bug-fix-call_x64_real-func.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/884091/458185/0004-Add-a-x64-bug-fix-call_x64_real-func.txt">
Thu Jan 20 01:18:25 2011 (413b) by jain_vipin_swm [...] yahoo.com
</a>
</font></li>
</ul>


image001.gif<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/558206/281683/image001.gif">
Thu Jan 22 14:22:57 2009 (8.8k) by steven.bauer [...] amd.com
</a>
</font></li>
</ul>


mylog<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/884080/458179/mylog">
Thu Jan 20 01:14:27 2011 (413b) by jain_vipin_swm [...] yahoo.com
</a>
</font></li>
</ul>


win32_api_build_failure.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/905993/469989/win32_api_build_failure.txt">
Wed Mar 02 17:44:18 2011 (4.9k) by ddascalescu+perl [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=55660">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-558206" href="/Public/Bug/Display.html?id=55660#txn-558206">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;22&nbsp;14:22:57&nbsp;2009</span>
    <span class="description">steven.bauer [...] amd.com - Ticket #42685:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Version of Win32::API for 64-bit Windows</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 22 Jan 2009 13:17:38 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Bauer, Steven&#34; &lt;steven.bauer [...] amd.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/558206/281683/image001.gif">Download image001.gif</a><br />
<span class="downloadcontenttype">image/gif 8.8k</span>
</div>
<div class="messagebody">
<img alt="image001.gif" title="image001.gif" src="/Ticket/Attachment/558206/281683/" /></div>
</div>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/558206/281681/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/281681">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 765b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">My apologies if this is the wrong forum for posting  this request.
Please let me know if there&#39;s a more appropriate forum.

 

We have a variety of perl programs running under Activestate Perl for
32-bit Windows.  We want to move our code base to 64-bit Perl to run on
64-bit Windows.

 

Win32::API is not available in the 64-bit  environment form either
ActiveState or CPAN from what we can see.  We&#39;ve tried compiling in the
64-bit environment and the inline assembly in API.xs will not compile
because the MS 64 bit compiler will not support inline assembly.  Have
you worked on a 64-bit port of this module?

 

Steven Bauer

Client Analysis

Senior Software Engineer; Performance CoE
7171 Southwest Pkwy., M/S B400.1B
Austin, TX 78735
T &#40;512&#41; 602-3155

 

 
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/558206/281682/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/281682">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.5k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-558275" href="/Public/Bug/Display.html?id=55660#txn-558275">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;22&nbsp;18:37:03&nbsp;2009</span>
    <span class="description">cosimo [...] cpan.org - Ticket #42685:  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-558282" href="/Public/Bug/Display.html?id=55660#txn-558282">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;22&nbsp;18:45:46&nbsp;2009</span>
    <span class="description">cosimo [...] cpan.org - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/558282/281723/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/281723">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 353b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Steven,

thanks for contacting me.
Yes, that&#39;s true. There is still no version ready for 64-bit.

The &#34;plan&#34; is to add support for 64-bit architecture but the problem is 
that I don&#39;t have access to a x64 XP/Vista machine and I don&#39;t have a 
license for the 64-bit MSVC compiler.

All the development work for Win32::API is done on my own laptop...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-558283" href="/Public/Bug/Display.html?id=55660#txn-558283">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;22&nbsp;18:45:47&nbsp;2009</span>
    <span class="description">The RT System itself - Ticket #42685:  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-558341" href="/Public/Bug/Display.html?id=55660#txn-558341">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;22&nbsp;21:17:59&nbsp;2009</span>
    <span class="description">msjuniorc [...] hotmail.com - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/558341/281750/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/281750">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 695b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Cosimo,
&#34;Commencing this month &#40;12-2008&#41;, Microsoft will be providing every CPAN
author with free access to a centrally-hosted virtual machine
environment containing every major version of Windows.&#34;

For more info &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~Alias/journal/38036">http://use.perl.org/~Alias/journal/38036</a></span>&#34;.

Giuseppe &#34;Jr.&#34;

On Thu Jan 22 18:45:46 2009, COSIMO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Steven,
&gt; 
&gt; thanks for contacting me.
&gt; Yes, that&#39;s true. There is still no version ready for 64-bit.
&gt; 
&gt; The &#34;plan&#34; is to add support for 64-bit architecture but the problem is 
&gt; that I don&#39;t have access to a x64 XP/Vista machine and I don&#39;t have a 
&gt; license for the 64-bit MSVC compiler.
&gt; 
&gt; All the development work for Win32::API is done on my own laptop...
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-558376" href="/Public/Bug/Display.html?id=55660#txn-558376">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;22&nbsp;23:14:38&nbsp;2009</span>
    <span class="description">steven.bauer [...] amd.com - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #42685] Version of Win32::API for 64-bit Windows </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 22 Jan 2009 20:24:12 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Bauer, Steven&#34; &lt;steven.bauer [...] amd.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/558376/281766/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/281766">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Giuseppe and Cosimo,

I was about to recommend that I think we can work out some kind of arrangement to get the work done via the systems/licenses I have available.

I&#39;d be willing to have either myself or one of my team work on getting the 64 bit version working.

Steve


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Giuseppe J. C. via RT [mailto:bug-Win32-API@rt.cpan.org] 
Sent: Thursday, January 22, 2009 8:18 PM
To: Bauer, Steven
Subject: [rt.cpan.org #42685] Version of Win32::API for 64-bit Windows 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=42685">https://rt.cpan.org/Ticket/Display.html?id=42685</a></span> &gt;

Cosimo,
&#34;Commencing this month &#40;12-2008&#41;, Microsoft will be providing every CPAN
author with free access to a centrally-hosted virtual machine
environment containing every major version of Windows.&#34;

For more info &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~Alias/journal/38036">http://use.perl.org/~Alias/journal/38036</a></span>&#34;.

Giuseppe &#34;Jr.&#34;

On Thu Jan 22 18:45:46 2009, COSIMO wrote:
<div class="message-stanza open">&gt; Hi Steven,
&gt; 
&gt; thanks for contacting me.
&gt; Yes, that&#39;s true. There is still no version ready for 64-bit.
&gt; 
&gt; The &#34;plan&#34; is to add support for 64-bit architecture but the problem is 
&gt; that I don&#39;t have access to a x64 XP/Vista machine and I don&#39;t have a 
&gt; license for the 64-bit MSVC compiler.
&gt; 
&gt; All the development work for Win32::API is done on my own laptop...
&gt; 
</div>



</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-559205" href="/Public/Bug/Display.html?id=55660#txn-559205">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;24&nbsp;09:39:09&nbsp;2009</span>
    <span class="description">cosimo [...] cpan.org - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/559205/282264/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/282264">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 540b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Gio. 22 Gen. 2009 23:14:38, steven.bauer@amd.com wrote:
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I was about t
</div>o recommend that I think we can
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; work out some kind of arrangement to get the work done via the
&gt; systems/licenses I have available.
</div>
That would be cool.
Can you provide ssh access to a test system?
In the meantime, since I knew about Adam&#39;s blog post, I mailed him 
asking for updates.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;d be willing to have either
&gt; myself or one of my team work on getting the 64 bit version working.
</div>
Thanks. I know I will need some help with the 64 bit inline assembly.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-559208" href="/Public/Bug/Display.html?id=55660#txn-559208">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;24&nbsp;11:00:22&nbsp;2009</span>
    <span class="description">steven.bauer [...] amd.com - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #42685] Version of Win32::API for 64-bit Windows </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 24 Jan 2009 09:59:42 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Bauer, Steven&#34; &lt;steven.bauer [...] amd.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/559208/282267/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/282267">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I don&#39;t know what&#39;s available through the developer center,  but with cutbacks, etc.  It may be limited.  I&#39;ll look into it on Monday.

The point where we decided to contact you is when we learned that the Microsoft 64 bit compiler doesn&#39;t support inline assembly.  The docmentation says to use intrinsic functions instead.  Also, from what I understand,  the calling  conventions &#40;stack frame,  etc&#41;  are different for 64 bit routine vs 32 bit.  It may not be a straightforward port.  The  code will need to know if the target is 32 or 64 bit.
   

Sent from my Windows MobileÂ® phone.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Cosimo Streppone via RT &lt;bug-Win32-API@rt.cpan.org&gt;
Sent: Saturday, January 24, 2009 8:39 AM
To: steven.bauer@amd.com &lt;steven.bauer@amd.com&gt;
Subject: [rt.cpan.org #42685] Version of Win32::API for 64-bit Windows 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=42685">https://rt.cpan.org/Ticket/Display.html?id=42685</a></span> &gt;

On Gio. 22 Gen. 2009 23:14:38, steven.bauer@amd.com wrote:
 
<div class="message-stanza open">&gt; I was about t
</div>o recommend that I think we can
<div class="message-stanza open">&gt; work out some kind of arrangement to get the work done via the
&gt; systems/licenses I have available.
</div>
That would be cool.
Can you provide ssh access to a test system?
In the meantime, since I knew about Adam&#39;s blog post, I mailed him 
asking for updates.

<div class="message-stanza open">&gt; I&#39;d be willing to have either
&gt; myself or one of my team work on getting the 64 bit version working.
</div>
Thanks. I know I will need some help with the 64 bit inline assembly.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-560158" href="/Public/Bug/Display.html?id=55660#txn-560158">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;26&nbsp;16:27:19&nbsp;2009</span>
    <span class="description">steven.bauer [...] amd.com - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #42685] Version of Win32::API for 64-bit Windows </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 Jan 2009 15:23:50 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Bauer, Steven&#34; &lt;steven.bauer [...] amd.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/560158/282789/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/282789">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Cosmio,

I looked at Adam&#39;s blog post, and Vista64 isn&#39;t on the list, and it looks like a straight testing environment, no development tools.  Perhaps I misunderstood.

I talked to my manager about the possibility of setting up a machine and the response was, &#34;It&#39;s possible, but we don&#39;t really want to go through the hassle&#34;

Is there a time when you and I as well as Giuseppe could talk via Skype or something like it?

Steve

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Cosimo Streppone via RT [mailto:bug-Win32-API@rt.cpan.org] 
Sent: Saturday, January 24, 2009 8:39 AM
To: Bauer, Steven
Subject: [rt.cpan.org #42685] Version of Win32::API for 64-bit Windows 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=42685">https://rt.cpan.org/Ticket/Display.html?id=42685</a></span> &gt;

On Gio. 22 Gen. 2009 23:14:38, steven.bauer@amd.com wrote:
 
<div class="message-stanza open">&gt; I was about t
</div>o recommend that I think we can
<div class="message-stanza open">&gt; work out some kind of arrangement to get the work done via the
&gt; systems/licenses I have available.
</div>
That would be cool.
Can you provide ssh access to a test system?
In the meantime, since I knew about Adam&#39;s blog post, I mailed him 
asking for updates.

<div class="message-stanza open">&gt; I&#39;d be willing to have either
&gt; myself or one of my team work on getting the 64 bit version working.
</div>
Thanks. I know I will need some help with the 64 bit inline assembly.


</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-560160" href="/Public/Bug/Display.html?id=55660#txn-560160">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;26&nbsp;16:33:05&nbsp;2009</span>
    <span class="description">cosimo [...] cpan.org - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/560160/282791/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/282791">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 648b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Lun. 26 Gen. 2009 16:27:19, steven.bauer@amd.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I looked at Adam&#39;s blog post, and Vista64 isn&#39;t on the
&gt; list, and it looks like a straight testing environment, no development
&gt; tools.  Perhaps I misunderstood.
</div>
I don&#39;t think so.
I&#39;m in touch with Adam, and he should have a final update on this in a 
few days.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I talked to my manager about the
&gt; possibility of setting up a machine and the response was, &#34;It&#39;s
&gt; possible, but we don&#39;t really want to go through the hassle&#34;
</div>
Mmh...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is there a time when you and I as well as Giuseppe could
&gt; talk via Skype or something like it?
</div>
Sure. I&#39;m sending you details by mail.
Cheers,
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-744256" href="/Public/Bug/Display.html?id=55660#txn-744256">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;08&nbsp;07:02:28&nbsp;2010</span>
    <span class="description">csjewell [...] cpan.org - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/744256/384808/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/384808">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">1&#41; I know Adam has 2003_x64 and 2008_x64 machines in the VM farm.

2&#41; We just hit this when compiling Strawberry-64, FYI. &#40;Linking to this
from RT 55336, by the way.&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">cpan&gt; install Win32::API
</div>CPAN::SQLite not installed, trying to work without
Going to read &#39;C:\vanilla\cpan\sources\authors\01mailrc.txt.gz&#39;
............................................................................DONE
Going to read &#39;C:\vanilla\cpan\sources\modules\02packages.details.txt.gz&#39;
  Database was generated on Mon, 08 Mar 2010 05:37:30 GMT
............................................................................DONE
Going to read &#39;C:\vanilla\cpan\sources\modules\03modlist.data.gz&#39;
............................................................................DONE
Running install for module &#39;Win32::API&#39;
Running make for C/CO/COSIMO/Win32-API-0.59.tar.gz
Checksum for
C:\vanilla\cpan\sources\authors\id\C\CO\COSIMO\Win32-API-0.59.tar.gz ok
Scanning cache C:\vanilla\cpan\build for sizes
............................................................................DONE

  CPAN.pm: Going to build C/CO/COSIMO/Win32-API-0.59.tar.gz

Checking if your kit is complete...
Looks good
Writing Makefile for Win32::API::Callback
Writing Makefile for Win32::API
cp Type.pm blib\lib\Win32/API/Type.pm
cp Callback.pm blib\lib\Win32/API/Callback.pm
cp Test.pm blib\lib\Win32/API/Test.pm
cp Struct.pm blib\lib\Win32/API/Struct.pm
cp API.pm blib\lib\Win32/API.pm
C:\vanilla\perl\bin\perl.exe C:\vanilla\perl\lib\ExtUtils\xsubpp 
-typemap C:\vanilla\perl\lib\ExtUtils\typemap  Callbac
k.xs &gt; Callback.xsc &#38;&#38; C:\vanilla\perl\bin\perl.exe -MExtUtils::Command
-e &#34;mv&#34; -- Callback.xsc Callback.c
gcc -c          -s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE
-DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPE
RL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields
-DPERL_MSVCRT_READFIX -s -O2          -DVERSION=\&#34;0.59\&#34;    -DXS_VER
SION=\&#34;0.59\&#34;  &#34;-IC:\vanilla\perl\lib\CORE&#34;   Callback.c
Callback.xs: In function &#39;CallbackMakeStruct&#39;:
Callback.xs:250: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;CallbackTemplate&#39;:
Callback.xs:305: warning: cast to pointer from integer of different size
Callback.xs:313: warning: cast to pointer from integer of different size
Callback.xs: In function &#39;CallbackCreate&#39;:
Callback.xs:581: warning: cast from pointer to integer of different size
Callback.xs:596: warning: cast from pointer to integer of different size
Callback.xs:597: warning: cast from pointer to integer of different size
Callback.xs:637: warning: cast from pointer to integer of different size
Callback.xs:687: warning: cast from pointer to integer of different size
Callback.xs:738: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;XS_Win32__API__Callback_CallbackCreate&#39;:
Callback.xs:868: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;XS_Win32__API__Callback_PushSelf&#39;:
Callback.xs:896: warning: cast from pointer to integer of different size
Running Mkbootstrap for Win32::API::Callback &#40;&#41;
C:\vanilla\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644
Callback.bs
C:\vanilla\perl\bin\perl.exe -MExtUtils::Mksymlists \
     -e &#34;Mksymlists&#40;&#39;NAME&#39;=&gt;\&#34;Win32::API::Callback\&#34;, &#39;DLBASE&#39; =&gt;
&#39;Callback&#39;, &#39;DL_FUNCS&#39; =&gt; {  }, &#39;FUNCLIST&#39; =&gt; [], &#39;IMP
ORTS&#39; =&gt; {  }, &#39;DL_VARS&#39; =&gt; []&#41;;&#34;
dlltool --def Callback.def --output-exp dll.exp
g++ -o ..\blib\arch\auto\Win32\API\Callback\Callback.dll -Wl,--base-file
-Wl,dll.base -mdll -s -L&#34;C:\vanilla\perl\lib\CO
RE&#34; -L&#34;C:\vanilla\c\lib&#34; Callback.o -Wl,--image-base,0x21000000 
C:\vanilla\perl\lib\CORE\libperl511.a -lmoldname -lkern
el32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32
-loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lw
inmm -lversion -lodbc32 -lodbccp32 -lcomctl32 dll.exp
dlltool --def Callback.def --base-file dll.base --output-exp dll.exp
g++ -o ..\blib\arch\auto\Win32\API\Callback\Callback.dll -mdll -s
-L&#34;C:\vanilla\perl\lib\CORE&#34; -L&#34;C:\vanilla\c\lib&#34; Call
back.o -Wl,--image-base,0x21000000 
C:\vanilla\perl\lib\CORE\libperl511.a -lmoldname -lkernel32 -luser32
-lgdi32 -lwinsp
ool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid
-lws2_32 -lmpr -lwinmm -lversion -lodbc32 -lodb
ccp32 -lcomctl32 dll.exp
C:\vanilla\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 755
..\blib\arch\auto\Win32\API\Callback\Callback.dll
C:\vanilla\perl\bin\perl.exe -MExtUtils::Command -e &#34;cp&#34; -- Callback.bs
..\blib\arch\auto\Win32\API\Callback\Callback.bs

C:\vanilla\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644
..\blib\arch\auto\Win32\API\Callback\Callback.bs
C:\vanilla\perl\bin\perl.exe C:\vanilla\perl\lib\ExtUtils\xsubpp 
-typemap C:\vanilla\perl\lib\ExtUtils\typemap -typemap
 typemap  API.xs &gt; API.xsc &#38;&#38; C:\vanilla\perl\bin\perl.exe
-MExtUtils::Command -e &#34;mv&#34; -- API.xsc API.c
gcc -c          -s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE
-DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPE
RL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields
-DPERL_MSVCRT_READFIX -s -O2          -DVERSION=\&#34;0.59\&#34;    -DXS_VER
SION=\&#34;0.59\&#34;  &#34;-IC:\vanilla\perl\lib\CORE&#34;   API.c
API.xs: In function &#39;XS_Win32__API_GetProcAddress&#39;:
API.xs:127: warning: cast from pointer to integer of different size
API.xs: In function &#39;XS_Win32__API_PointerTo&#39;:
API.xs:206: warning: cast from pointer to integer of different size
API.xs: In function &#39;XS_Win32__API_ReadMemory&#39;:
API.xs:223: warning: cast to pointer from integer of different size
C:\Users\Curtis\AppData\Local\Temp\ccaSXrib.s: Assembler messages:
C:\Users\Curtis\AppData\Local\Temp\ccaSXrib.s:3043: Error: suffix or
operands invalid for `push&#39;
C:\Users\Curtis\AppData\Local\Temp\ccaSXrib.s:3046: Error: suffix or
operands invalid for `push&#39;
dmake.EXE:  Error code 129, while making &#39;API.o&#39;
  COSIMO/Win32-API-0.59.tar.gz
  C:\vanilla\c\bin\dmake.EXE -- NOT OK
Running make test
  Can&#39;t test without successful make
Running make install
  Make had returned bad status, install seems impossible
Failed during this command:
 COSIMO/Win32-API-0.59.tar.gz                 : make NO

3&#41; ActiveState&#39;s PPM build farm has hit this, too.

<span class="clickylink"><a target="new" rel="nofollow" href="http://ppm4.activestate.com/MSWin32-x64/5.10/1000/C/CO/COSIMO/Win32-API-0.59.d/log-20090706T033449.txt">http://ppm4.activestate.com/MSWin32-x64/5.10/1000/C/CO/COSIMO/Win32-API-0.59.d/log-20090706T033449.txt</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-749196" href="/Public/Bug/Display.html?id=55660#txn-749196">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;17&nbsp;10:09:53&nbsp;2010</span>
    <span class="description">SBennett [...] accelrys.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Partial win64 support for Win32::API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 17 Mar 2010 14:07:23 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/749196/387411/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/387411">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 975b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The attached three patches &#40;against Win32-API-0.59&#41; implement initial support for 64-bit Windows in Win32-API.

I didn&#39;t attempt to port Win32::API::Callback. It looks like considerably more effort than Win32::API itself, and as our application doesn&#39;t need it I couldn&#39;t justify the paid time to spend on it. This is, however, sufficient for Win32::API tests to pass against a 64-bit ActivePerl 5.8.9.

At present, only MSVC++ toolchains will work, as its assembly dialect is different from GNU. I don&#39;t have a gcc-based build of Perl to work with to port it, but it should only require a straightforward translation of call_asm_x64_msvc.asm into call_asm_x64_gnu.asm.

The required changes to Makefile.PL are also somewhat hackish, purely because I don&#39;t know of a better way to detect what architecture we&#39;re targeting.

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/749196/387412/0003-Add-an-x64-platform-to-the-API_test-project-and-an-x.patch">Download 0003-Add-an-x64-platform-to-the-API_test-project-and-an-x.patch</a><br />
<span class="downloadcontenttype">text/x-diff 60.5k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/749196/387413/0001-Split-the-platform-specific-parts-of-Call-into-a-sep.patch">Download 0001-Split-the-platform-specific-parts-of-Call-into-a-sep.patch</a><br />
<span class="downloadcontenttype">text/x-diff 17k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/749196/387414/0002-Initial-x86_64-support-in-Win32-API.patch">Download 0002-Initial-x86_64-support-in-Win32-API.patch</a><br />
<span class="downloadcontenttype">text/x-diff 7.2k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-749351" href="/Public/Bug/Display.html?id=55660#txn-749351">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;17&nbsp;16:36:18&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> libwin32 [...] perl.org, csjewell [...] cpan.org, adamk [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/749351/387510/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/387510">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Il Mer 17 Mar 2010 10:09:53, SBennett@accelrys.com ha scritto:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The attached three patches &#40;against Win32-API-0.59&#41; implement initial
&gt;    support for 64-bit Windows in Win32-API.
&gt; 
&gt; I didn&#39;t attempt to
&gt;    port Win32::API::Callback. It looks like considerably more effort
&gt;    than Win32::API itself, and as our application doesn&#39;t need it I
&gt;    couldn&#39;t justify the paid time to spend on it. This is, however,
&gt;    sufficient for Win32::API tests to pass against a 64-bit ActivePerl
&gt;    5.8.9.
&gt; 
&gt; At present, only MSVC++ toolchains will work, as its
&gt;    assembly dialect is different from GNU. I don&#39;t have a gcc-based
&gt;    build of Perl to work with to port it, but it should only require a
&gt;    straightforward translation of call_asm_x64_msvc.asm into
&gt;    call_asm_x64_gnu.asm.
&gt; 
&gt; The required changes to Makefile.PL are
&gt;    also somewhat hackish, purely because I don&#39;t know of a better way
&gt;    to detect what architecture we&#39;re targeting.
</div>
Hi Stephen,

fantastic news! Thank you and your company for this.
I will try to get things moving by getting this code in and releasing 
Win32::API 0.60 as-is.

Then I can start working on gcc x86-64 support.
It will definitely be easier now that you opened the way.

Great stuff!

-- 
Cosimo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-749355" href="/Public/Bug/Display.html?id=55660#txn-749355">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;17&nbsp;16:36:22&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-749357" href="/Public/Bug/Display.html?id=55660#txn-749357">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;17&nbsp;16:36:37&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Given to COSIMO</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-757079" href="/Public/Bug/Display.html?id=55660#txn-757079">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;01&nbsp;09:05:06&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">120 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> adamk [...] cpan.org, libwin32 [...] perl.org, csjewell [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/757079/391491/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/391491">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 402b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Stephen,

thanks for your great work again.
I had some CRLF troubles incorporating your patch, but then I switched 
to a Linux machine and I managed to.

The repository on github is updated.

  <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/">http://github.com/cosimo/perl5-win32-api/</a></span>

This is the commit with all the changes.

  <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/">http://github.com/cosimo/perl5-win32-api/</a></span>
commit/641b4fefc365e094ab13c6f4d86902eeb71deb77

I haven&#39;t tested it yet...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-757084" href="/Public/Bug/Display.html?id=55660#txn-757084">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;01&nbsp;09:05:11&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-757336" href="/Public/Bug/Display.html?id=55660#txn-757336">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;02&nbsp;01:12:25&nbsp;2010</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;libwin32 [...] perl.org&gt;, &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Apr 2010 16:10:22 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/757336/391654/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/391654">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Cosimo Streppone via RT&#34; &lt;bug-Win32-API@rt.cpan.org&gt;
Cc: &lt;adamk@cpan.org&gt;; &lt;libwin32@perl.org&gt;; &lt;csjewell@cpan.org&gt;
Sent: Friday, April 02, 2010 12:05 AM
Subject: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API


<div class="message-stanza open">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=55660">https://rt.cpan.org/Ticket/Display.html?id=55660</a></span> &gt;
&gt;
&gt; Hi Stephen,
&gt;
&gt; thanks for your great work again.
&gt; I had some CRLF troubles incorporating your patch, but then I switched
&gt; to a Linux machine and I managed to.
&gt;
&gt; The repository on github is updated.
&gt;
</div>
I&#39;ve just done a
git clone git://github.com/cosimo/perl5-win32-api.git win32-api

and then tried to build Win32::API from those sources on Vista64. I&#39;m 
running the w64 version of ActivePerl-5.10.1 &#40;build 1007&#41;, and I&#39;m using the 
same compiler that built that ActivePerl &#40;afaik&#41; - namely, the Microsoft 
Platform SDK for Windows Server 2003 R2.

The compiling of API.c  terminates with the following:

###################################
API.xs&#40;235&#41; : warning C4101: &#39;words_pushed&#39; : unreferenced local variable
        ml  -c call_asm_x64_msvc.asm
&#39;ml&#39; is not recognized as an internal or external command,
operable program or batch file.
NMAKE : fatal error U1077: &#39;ml&#39; : return code &#39;0x1&#39;
Stop.
###################################

Apparently I need an ml.exe. If I can&#39;t get one that works with this 
compiler, I guess that means I need to use a different compiler.

I did try using the one that comes with my 32-bit MSVC++ 7.0, but that leads 
to numerous errors in call_asm_x64_msvc.asm &#40;that appear to be syntactical&#41;. 
They begin with:

###################################
 Assembling: call_asm_x64_msvc.asm
call_asm_x64_msvc.asm&#40;1&#41; : error A2013: .MODEL must precede this directive
call_asm_x64_msvc.asm&#40;4&#41; : error A2034: must be in segment block : 
Call_x64_real

call_asm_x64_msvc.asm&#40;7&#41; : error A2034: must be in segment block
call_asm_x64_msvc.asm&#40;8&#41; : error A2034: must be in segment block
call_asm_x64_msvc.asm&#40;9&#41; : error A2034: must be in segment block
call_asm_x64_msvc.asm&#40;10&#41; : error A2034: must be in segment block
call_asm_x64_msvc.asm&#40;12&#41; : error A2034: must be in segment block
call_asm_x64_msvc.asm&#40;13&#41; : error A2034: must be in segment block
call_asm_x64_msvc.asm&#40;14&#41; : error A2008: syntax error : .

etc., etc.
###################################

I&#39;ll try and get hold of a suitable ml.exe.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-757339" href="/Public/Bug/Display.html?id=55660#txn-757339">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;02&nbsp;01:12:32&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-757346" href="/Public/Bug/Display.html?id=55660#txn-757346">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;02&nbsp;01:44:09&nbsp;2010</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;libwin32 [...] perl.org&gt;, &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Apr 2010 16:42:36 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/757346/391658/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/391658">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Sisyphus&#34; &lt;sisyphus1@optusnet.com.au&gt;

<div class="message-stanza open">&gt;
&gt; I&#39;ll try and get hold of a suitable ml.exe.
&gt;
</div>
Duh - I already have one. But it&#39;s called ml64.exe, not ml.exe.
Anyway, renaming ml64.exe to ml.exe &#40;temporarily&#41; allows the build to 
complete.

For me, There are some failing tests &#40;including a couple of segfaults&#41;:

###############################
Test Summary Report
-------------------
t/00_API.t        &#40;Wstat: 1280 Tests: 11 Failed: 0&#41;
  Non-zero exit status: 5
  Parse errors: Bad plan.  You planned 25 tests but ran 11.
t/01_Struct.t     &#40;Wstat: 1280 Tests: 5 Failed: 0&#41;
  Non-zero exit status: 5
  Parse errors: Bad plan.  You planned 7 tests but ran 5.
Files=6, Tests=53, 19 wallclock secs &#40; 0.17 usr +  0.11 sys =  0.28 CPU&#41;
Result: FAIL
Failed 2/6 test programs. 0/53 subtests failed.
NMAKE : fatal error U1077: &#39;C:\_64\perl1007\bin\perl.exe&#39; : return code 
&#39;0xff&#39;
Stop.
###############################

Is that as anticipated ?

Now ... to try and find out why ml.exe is being called, instead of ml64.exe.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-768622" href="/Public/Bug/Display.html?id=55660#txn-768622">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;26&nbsp;18:01:24&nbsp;2010</span>
    <span class="description">SBennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;libwin32 [...] perl.org&#34; &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 Apr 2010 23:01:06 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sisyphus &lt;sisyphus1 [...] optusnet.com.au&gt;, &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/768622/397697/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/397697">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Apologies for the delayed reply -- I was rather busy at the time and then subsequently just forgot about this.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ###############################
&gt; Test Summary Report
&gt; -------------------
&gt; t/00_API.t        &#40;Wstat: 1280 Tests: 11 Failed: 0&#41;
&gt;   Non-zero exit status: 5
&gt;   Parse errors: Bad plan.  You planned 25 tests but ran 11.
&gt; t/01_Struct.t     &#40;Wstat: 1280 Tests: 5 Failed: 0&#41;
&gt;   Non-zero exit status: 5
&gt;   Parse errors: Bad plan.  You planned 7 tests but ran 5.
&gt; Files=6, Tests=53, 19 wallclock secs &#40; 0.17 usr +  0.11 sys =  0.28 CPU&#41;
&gt; Result: FAIL
&gt; Failed 2/6 test programs. 0/53 subtests failed.
&gt; NMAKE : fatal error U1077: &#39;C:\_64\perl1007\bin\perl.exe&#39; : return code
&gt; &#39;0xff&#39;
&gt; Stop.
&gt; ###############################
&gt;
&gt; Is that as anticipated ?
</div>
No; the Win32::API tests should pass &#40;and do on my build&#41;. Can you find out which tests exactly are failing? That looks somewhat like the testsuite is crashing perl; in which test?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Now ... to try and find out why ml.exe is being called, instead of ml64.exe.
</div>
That sounds like your environment is set up for the 32-bit MSVC++ toolchain, instead of the x64 one. Assuming you&#39;re using the vcvars batch file to set up your environment for NMAKE, are you giving it the right arguments for an x64 build?

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-769273" href="/Public/Bug/Display.html?id=55660#txn-769273">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;28&nbsp;03:21:14&nbsp;2010</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 28 Apr 2010 17:19:51 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Stephen Bennett&#34; &lt;SBennett [...] accelrys.com&gt;, &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/769273/398020/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/398020">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Stephen Bennett&#34; &lt;SBennett@accelrys.com&gt;
To: &#34;Sisyphus&#34; &lt;sisyphus1@optusnet.com.au&gt;; &lt;bug-Win32-API@rt.cpan.org&gt;
Cc: &lt;libwin32@perl.org&gt;
Sent: Tuesday, April 27, 2010 8:01 AM
Subject: RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for
Win32::API


<div class="message-stanza open">&gt; Apologies for the delayed reply -- I was rather busy at the time and then
&gt; subsequently just forgot about this.
&gt;
<div class="message-stanza open">&gt;&gt; ###############################
&gt;&gt; Test Summary Report
&gt;&gt; -------------------
&gt;&gt; t/00_API.t        &#40;Wstat: 1280 Tests: 11 Failed: 0&#41;
&gt;&gt;   Non-zero exit status: 5
&gt;&gt;   Parse errors: Bad plan.  You planned 25 tests but ran 11.
&gt;&gt; t/01_Struct.t     &#40;Wstat: 1280 Tests: 5 Failed: 0&#41;
&gt;&gt;   Non-zero exit status: 5
&gt;&gt;   Parse errors: Bad plan.  You planned 7 tests but ran 5.
&gt;&gt; Files=6, Tests=53, 19 wallclock secs &#40; 0.17 usr +  0.11 sys =  0.28 CPU&#41;
&gt;&gt; Result: FAIL
&gt;&gt; Failed 2/6 test programs. 0/53 subtests failed.
&gt;&gt; NMAKE : fatal error U1077: &#39;C:\_64\perl1007\bin\perl.exe&#39; : return code
&gt;&gt; &#39;0xff&#39;
&gt;&gt; Stop.
&gt;&gt; ###############################
&gt;&gt;
&gt;&gt; Is that as anticipated ?
</div>&gt;
&gt; No; the Win32::API tests should pass &#40;and do on my build&#41;. Can you find
&gt; out which tests exactly are failing? That looks somewhat like the
&gt; testsuite is crashing perl; in which test?
</div>
It&#39;s test 12 that crashes. When I clear the pop-up the test script aborts - 
no more tests get run in that script.

Here&#39;s the output:

C:\cygwin\home\Rob\GIT\win32-api&gt;perl -Mblib t/00_API.t
1..25
ok 1 - use Win32::API;
ok 2 - use Win32::API::Test;
ok 3 - use Win32;
ok 4 - loaded
# API test dll found at &#40;API_test64.dll&#41;
ok 5 - found API test dll
ok 6 - GetCurrentProcessId&#40;&#41; function found
ok 7 - GetCurrentProcessId&#40;&#41; result ok
ok 8 - GetCurrentProcessId&#40;&#41; result ok
ok 9 - Import of GetCurrentProcessId&#40;&#41; function from kernel32.dll
ok 10 - GetCurrentProcessId&#40;&#41; result ok
ok 11 - sum_integers&#40;&#41; function defined

It&#39;s the &#39;$function-&gt;Call&#40;2, 3&#41;&#39; that causes the crash - which I guess means 
that the dll being accessed &#40;&#34;our own DLL&#34;&#41; is not to my compiler&#39;s liking.

<div class="message-stanza open">&gt;
<div class="message-stanza open">&gt;&gt; Now ... to try and find out why ml.exe is being called, instead of
&gt;&gt; ml64.exe.
</div>&gt;
&gt; That sounds like your environment is set up for the 32-bit MSVC++
&gt; toolchain, instead of the x64 one. Assuming you&#39;re using the vcvars batch
&gt; file to set up your environment for NMAKE, are you giving it the right
&gt; arguments for an x64 build?
</div>
I&#39;m using the Microsoft Platform SDK for Windows Server 2003 R2 compiler
&#40;same as ActiveState use to build x64 ActivePerl&#41; and, to set up the
environment I run:

SetEnv.cmd /XP64 /RETAIL

That&#39;s the correct thing to do, afaik, and I&#39;ve been getting good mileage
out of it.

I notice, however, that &#39;nmake /P&#39; lists:

AS = ml

instead of the expected &#39;AS = ml64&#39; - so, I guess either it&#39;s a bug in
nmake, or it&#39;s an nmake that expects a 32-bit environment. &#40;I&#39;ve checked,
and there&#39;s no &#39;nmake64.exe&#39; or anything like that.&#41;

As a fix, I&#39;ve simply created a copy of ml64.exe named ml.exe in the same 
folder. &#40;The 32-bit ml.exe is in a folder that&#39;s not in my path.&#41;

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-769274" href="/Public/Bug/Display.html?id=55660#txn-769274">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;28&nbsp;03:32:13&nbsp;2010</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 28 Apr 2010 17:30:43 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Stephen Bennett&#34; &lt;SBennett [...] accelrys.com&gt;, &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/769274/398021/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/398021">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 353b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Sisyphus&#34; &lt;sisyphus1@optusnet.com.au&gt;

<div class="message-stanza open">&gt; which I guess means that the dll being accessed &#40;&#34;our own DLL&#34;&#41; is not to 
&gt; my compiler&#39;s liking.
</div>
Sorry - just so that there&#39;s no doubt, the dll that&#39;s being accessed is 
API_test64.dll &#40;though you probably deduced as much from the test output I 
posted :-&#41;

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-769292" href="/Public/Bug/Display.html?id=55660#txn-769292">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;28&nbsp;04:51:22&nbsp;2010</span>
    <span class="description">SBennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;libwin32 [...] perl.org&#34; &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 28 Apr 2010 09:50:34 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Sisyphus &lt;sisyphus1 [...] optusnet.com.au&gt;, &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/769292/398034/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/398034">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 432b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sorry - just so that there&#39;s no doubt, the dll that&#39;s being accessed is
&gt; API_test64.dll &#40;though you probably deduced as much from the test output I
&gt; posted :-&#41;
</div>
Is it possible that that DLL got garbled in the passage through patches, RT, etc? I&#39;d try rebuilding it locally, if you can.

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-769303" href="/Public/Bug/Display.html?id=55660#txn-769303">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;28&nbsp;05:43:10&nbsp;2010</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 28 Apr 2010 19:41:41 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Stephen Bennett&#34; &lt;SBennett [...] accelrys.com&gt;, &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/769303/398041/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/398041">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Stephen Bennett&#34; &lt;SBennett@accelrys.com&gt;
To: &#34;Sisyphus&#34; &lt;sisyphus1@optusnet.com.au&gt;; &lt;bug-Win32-API@rt.cpan.org&gt;
Cc: &lt;libwin32@perl.org&gt;
Sent: Wednesday, April 28, 2010 6:50 PM
Subject: RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for 
Win32::API


<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; Sorry - just so that there&#39;s no doubt, the dll that&#39;s being accessed is
&gt;&gt; API_test64.dll &#40;though you probably deduced as much from the test output 
&gt;&gt; I
&gt;&gt; posted :-&#41;
</div>&gt;
&gt; Is it possible that that DLL got garbled in the passage through patches, 
&gt; RT, etc? I&#39;d try rebuilding it locally, if you can.
</div>
Here are some digest values for that file &#40;which was downloaded from the 
Win32-API git repo&#41;:

MD5: e83d79cbbed32588a0d897e829a03726
SHA1: d71457f0dc3ad356241d644ce8bcc479d1cee1b9
SHA256: ba2c3e1966977805c04e0a8a55b0eba6c2b9a4867d567638eca81b0583d9fd2c

Is your file the same ?

In any case, I&#39;ll try to rebuild the API_test64.dll when I get the time - as 
that will probably fix the problem, irrespective of the cause. &#40;I&#39;ll get 
back when I&#39;ve tested that out.&#41;

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-772704" href="/Public/Bug/Display.html?id=55660#txn-772704">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;05&nbsp;06:42:21&nbsp;2010</span>
    <span class="description">ROBINS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/772704/400031/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/400031">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Apr 01 15:05:06 2010, COSIMO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is the commit with all the changes.
&gt; 
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/">http://github.com/cosimo/perl5-win32-api/</a></span>
&gt; commit/641b4fefc365e094ab13c6f4d86902eeb71deb77
</div>
I have just tested this commit on Strawberry Perl 5.12.0 x64. It fails.
I guess it was not expected to work, but I guess it should be mentioned
anyway.

C:\Users\robin\perl\perl5-win32-api&gt;perl Makefile.PL
Checking if your kit is complete...
Looks good
Writing Makefile for Win32::API::Callback
Writing Makefile for Win32::API

C:\Users\robin\perl\perl5-win32-api&gt;dmake
cp Type.pm blib\lib\Win32/API/Type.pm
cp Callback.pm blib\lib\Win32/API/Callback.pm
cp Test.pm blib\lib\Win32/API/Test.pm
cp Struct.pm blib\lib\Win32/API/Struct.pm
cp API.pm blib\lib\Win32/API.pm
C:\Programs\strawberry-perl\perl\bin\perl.exe
C:\Programs\strawberry-perl\perl\lib\ExtUtils\xsubpp  -typemap
C:\Programs\strawberry-perl\perl\lib\ExtUtils\typemap  Callback.xs &gt;
Callback.xsc &#38;&#38; C:\Programs\strawberry-perl\perl\bin\perl.exe
-MExtUtils::Command -e &#34;mv&#34; -- Callback.xsc Callback.c
gcc -c          -s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE
-DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS
-fno-strict-aliasing -mms-bitfields -DPERL_MSVCRT_READFIX -s -O2     
-DVERSION=\&#34;0.60_64\&#34;     -DXS_VERSION=\&#34;0.60_64\&#34; 
&#34;-IC:\Programs\strawberry-perl\perl\lib\CORE&#34;   Callback.c
Callback.xs: In function &#39;CallbackMakeStruct&#39;:
Callback.xs:250: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;CallbackTemplate&#39;:
Callback.xs:305: warning: cast to pointer from integer of different size
Callback.xs:313: warning: cast to pointer from integer of different size
Callback.xs: In function &#39;CallbackCreate&#39;:
Callback.xs:581: warning: cast from pointer to integer of different size
Callback.xs:596: warning: cast from pointer to integer of different size
Callback.xs:597: warning: cast from pointer to integer of different size
Callback.xs:637: warning: cast from pointer to integer of different size
Callback.xs:687: warning: cast from pointer to integer of different size
Callback.xs:738: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;XS_Win32__API__Callback_CallbackCreate&#39;:
Callback.xs:868: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;XS_Win32__API__Callback_PushSelf&#39;:
Callback.xs:896: warning: cast from pointer to integer of different size
Running Mkbootstrap for Win32::API::Callback &#40;&#41;
C:\Programs\strawberry-perl\perl\bin\perl.exe -MExtUtils::Command -e
&#34;chmod&#34; -- 644 Callback.bs
C:\Programs\strawberry-perl\perl\bin\perl.exe -MExtUtils::Mksymlists \
     -e &#34;Mksymlists&#40;&#39;NAME&#39;=&gt;\&#34;Win32::API::Callback\&#34;, &#39;DLBASE&#39; =&gt;
&#39;Callback&#39;, &#39;DL_FUNCS&#39; =&gt; {  }, &#39;FUNCLIST&#39; =&gt; [], &#39;IMPORTS&#39; =&gt; {
}, &#39;DL_VARS&#39; =&gt; []&#41;;&#34;
dlltool --def Callback.def --output-exp dll.exp
g++ -o ..\blib\arch\auto\Win32\API\Callback\Callback.dll -Wl,--base-file
-Wl,dll.base -mdll -s -L&#34;C:\Programs\strawberry-perl\perl\lib\CORE&#34;
-L&#34;C:\Programs\strawberry-perl\c\lib&#34; Callback.o
-Wl,--image-base,0x21000000 
C:\Programs\strawberry-perl\perl\lib\CORE\libperl511.a -lmoldname
-lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32
-lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion
-lodbc32 -lodbccp32 -lcomctl32 dll.exp
dlltool --def Callback.def --base-file dll.base --output-exp dll.exp
g++ -o ..\blib\arch\auto\Win32\API\Callback\Callback.dll -mdll -s
-L&#34;C:\Programs\strawberry-perl\perl\lib\CORE&#34;
-L&#34;C:\Programs\strawberry-perl\c\lib&#34; Callback.o
-Wl,--image-base,0x21000000 
C:\Programs\strawberry-perl\perl\lib\CORE\libperl511.a -lmoldname
-lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32
-lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion
-lodbc32 -lodbccp32 -lcomctl32 dll.exp
C:\Programs\strawberry-perl\perl\bin\perl.exe -MExtUtils::Command -e
&#34;chmod&#34; -- 755 ..\blib\arch\auto\Win32\API\Callback\Callback.dll
C:\Programs\strawberry-perl\perl\bin\perl.exe -MExtUtils::Command -e
&#34;cp&#34; -- Callback.bs ..\blib\arch\auto\Win32\API\Callback\Callback.bs
C:\Programs\strawberry-perl\perl\bin\perl.exe -MExtUtils::Command -e
&#34;chmod&#34; -- 644 ..\blib\arch\auto\Win32\API\Callback\Callback.bs
C:\Programs\strawberry-perl\perl\bin\perl.exe
C:\Programs\strawberry-perl\perl\lib\ExtUtils\xsubpp  -typemap
C:\Programs\strawberry-perl\perl\lib\ExtUtils\typemap -typemap typemap 
API.xs &gt; API.xsc &#38;&#38; C:\Programs\strawberry-perl\perl\bin\perl.exe
-MExtUtils::Command -e &#34;mv&#34; -- API.xsc API.c
gcc -c          -s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE
-DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS
-fno-strict-aliasing -mms-bitfields -DPERL_MSVCRT_READFIX -s -O2     
-DVERSION=\&#34;0.60_64\&#34;     -DXS_VERSION=\&#34;0.60_64\&#34; 
&#34;-IC:\Programs\strawberry-perl\perl\lib\CORE&#34;   API.c
In file included from API.xs:47:
call_x86_64.h: In function &#39;Call_asm&#39;:
call_x86_64.h:53: warning: assignment makes integer from pointer without
a cast
call_x86_64.h:73: warning: assignment makes integer from pointer without
a cast
call_x86_64.h:97: warning: assignment makes pointer from integer without
a cast
API.xs: In function &#39;XS_Win32__API_GetProcAddress&#39;:
API.xs:108: warning: cast from pointer to integer of different size
API.xs: In function &#39;XS_Win32__API_PointerTo&#39;:
API.xs:187: warning: cast from pointer to integer of different size
API.xs: In function &#39;XS_Win32__API_ReadMemory&#39;:
API.xs:204: warning: cast to pointer from integer of different size
Running Mkbootstrap for Win32::API &#40;&#41;
C:\Programs\strawberry-perl\perl\bin\perl.exe -MExtUtils::Command -e
&#34;chmod&#34; -- 644 API.bs
C:\Programs\strawberry-perl\perl\bin\perl.exe -MExtUtils::Mksymlists \
     -e &#34;Mksymlists&#40;&#39;NAME&#39;=&gt;\&#34;Win32::API\&#34;, &#39;DLBASE&#39; =&gt; &#39;API&#39;,
&#39;DL_FUNCS&#39; =&gt; {  }, &#39;FUNCLIST&#39; =&gt; [], &#39;IMPORTS&#39; =&gt; {  }, &#39;DL_VARS&#39; =&gt; []&#41;;&#34;
dlltool --def API.def --output-exp dll.exp
g++ -o blib\arch\auto\Win32\API\API.dll -Wl,--base-file -Wl,dll.base
-mdll -s -L&#34;C:\Programs\strawberry-perl\perl\lib\CORE&#34;
-L&#34;C:\Programs\strawberry-perl\c\lib&#34; API.o call_asm_x64_gnu.o
-Wl,--image-base,0x253c0000 
C:\Programs\strawberry-perl\perl\lib\CORE\libperl511.a -lmoldname
-lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32
-lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion
-lodbc32 -lodbccp32 -lcomctl32 dll.exp
g++: call_asm_x64_gnu.o: No such file or directory
dmake:  Error code 129, while making &#39;blib\arch\auto\Win32\API\API.dll&#39;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-772708" href="/Public/Bug/Display.html?id=55660#txn-772708">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;05&nbsp;06:42:37&nbsp;2010</span>
    <span class="description">ROBINS [...] cpan.org -  Cc ROBINS added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-772713" href="/Public/Bug/Display.html?id=55660#txn-772713">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;05&nbsp;06:48:44&nbsp;2010</span>
    <span class="description">SBennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 5 May 2010 11:48:28 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/772713/400039/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/400039">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 984b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have just tested this commit on Strawberry Perl 5.12.0 x64. It fails.
&gt; I guess it was not expected to work, but I guess it should be mentioned
&gt; anyway.
</div>
Quite so. At the time I did this, I couldn&#39;t find an x64 Strawberry build
anywhere, so I was only able to test with ActivePerl and MSVC compilers.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; g++: call_asm_x64_gnu.o: No such file or directory
&gt; dmake:  Error code 129, while making &#39;blib\arch\auto\Win32\API\API.dll&#39;
</div>
Since the assembly syntaxes used by Visual Studio&#39;s ml64 and GNU&#39;s assembler
are so different, it&#39;s not feasible to have one file that can use both. To fix
this, someone will have to write the equivalent Call_x64_real function for GCC
to do the same that the MSVC assembly one does. It should be slightly easier,
since &#40;IIRC&#41; GCC on x64 still supports inline assembly, where MSVC doesn&#39;t.

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-774486" href="/Public/Bug/Display.html?id=55660#txn-774486">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;09&nbsp;08:50:52&nbsp;2010</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 9 May 2010 22:49:19 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Stephen Bennett&#34; &lt;SBennett [...] accelrys.com&gt;, &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/774486/401030/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/401030">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Sisyphus&#34; &lt;sisyphus1@optusnet.com.au&gt;

<div class="message-stanza open">&gt; In any case, I&#39;ll try to rebuild the API_test64.dll when I get the time - 
&gt; as that will probably fix the problem, irrespective of the cause. &#40;I&#39;ll 
&gt; get back when I&#39;ve tested that out.&#41;
</div>
Yes, I think that fixes the problem. The only test script that now fails is 
01_Struct.t.

I built the API_test64.dll manually by running:

cl -c API_test.cpp
cl /LD API_test.obj API_test.def bufferoverflowU.lib
I then renamed the API_test.dll that was produced, to API_test64.dll.

For that to work, in API_test.h, I had to first change:

#ifdef API_TEST_EXPORTS
#define API_TEST_API  __declspec&#40;dllexport&#41;
#else
#define API_TEST_API  __declspec&#40;dllimport&#41;
#endif

to:

#ifdef API_TEST_EXPORTS
#define API_TEST_API  /* __declspec&#40;dllexport&#41; */
#else
#define API_TEST_API  /* __declspec&#40;dllimport&#41; */
#endif

Otherwise, when trying to compile the obj file, I got errors of the type:

API_test.cpp&#40;31&#41; : error C2491: &#39;nAPI_test&#39; : definition of dllimport data 
not allowed
API_test.cpp&#40;33&#41; : error C2491: &#39;sum_integers&#39; : definition of dllimport 
function not allowed
API_test.cpp&#40;37&#41; : error C2491: &#39;sum_integers_ref&#39; : definition of dllimport 
function not allowed
[and more similar]

I suspect that we need to build the API_test64.dll as part of the Win32::API 
build procedure &#40;rather than supply a pre-built API_test64.dll&#41;.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-774494" href="/Public/Bug/Display.html?id=55660#txn-774494">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;09&nbsp;09:09:00&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/774494/401036/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/401036">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun May 09 08:50:52 2010, sisyphus1@optusnet.com.au wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; ----- Original Message -----
&gt; From: &#34;Sisyphus&#34; &lt;sisyphus1@optusnet.com.au&gt;
&gt; 
<div class="message-stanza open">&gt; &gt; In any case, I&#39;ll try to rebuild the API_test64.dll when I get the
</div>&gt; time -
&gt; 
&gt; Yes, I think that fixes the problem. The only test script that now
&gt; fails is
&gt; 01_Struct.t.
&gt; 
&gt; I built the API_test64.dll manually by running:
&gt; 
&gt; cl -c API_test.cpp
&gt; cl /LD API_test.obj API_test.def bufferoverflowU.lib
&gt; I then renamed the API_test.dll that was produced, to API_test64.dll.
</div>
Excellent.

Please send me your API_test64.dll.
I&#39;ll include it in the distribution.
I know that&#39;s not optimal, but at least we can move forward.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; For that to work, in API_test.h, I had to first change:
&gt; 
&gt; #ifdef API_TEST_EXPORTS
&gt; #define API_TEST_API  __declspec&#40;dllexport&#41;
&gt; #else
&gt; #define API_TEST_API  __declspec&#40;dllimport&#41;
&gt; #endif
&gt; 
&gt; to:
&gt; 
&gt; #ifdef API_TEST_EXPORTS
&gt; #define API_TEST_API  /* __declspec&#40;dllexport&#41; */
&gt; #else
&gt; #define API_TEST_API  /* __declspec&#40;dllimport&#41; */
&gt; #endif
&gt; 
&gt; Otherwise, when trying to compile the obj file, I got errors of the
&gt; type:
&gt; 
&gt; API_test.cpp&#40;31&#41; : error C2491: &#39;nAPI_test&#39; : definition of dllimport
&gt; data
&gt; not allowed
&gt; API_test.cpp&#40;33&#41; : error C2491: &#39;sum_integers&#39; : definition of
&gt; dllimport
&gt; function not allowed
&gt; API_test.cpp&#40;37&#41; : error C2491: &#39;sum_integers_ref&#39; : definition of
&gt; dllimport
&gt; function not allowed
&gt; [and more similar]
</div>
That&#39;s strange. I don&#39;t understand.
I&#39;m trying to get access to a x64 environment with a working MSVC, to 
test this. It&#39;s not so easy atm.

Thanks guys for your contribution on this.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-775005" href="/Public/Bug/Display.html?id=55660#txn-775005">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;10&nbsp;08:19:17&nbsp;2010</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 May 2010 22:17:35 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;, &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Sisyphus&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/775005/401346/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/401346">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----- 
From: &#34;Cosimo Streppone via RT&#34; &lt;bug-Win32-API@rt.cpan.org&gt;

<div class="message-stanza open">&gt;
&gt; Please send me your API_test64.dll.
</div>
Sure - I&#39;ll send it to you offlist. &#40;Anyone else wants one just let me 
know.&#41;

<div class="message-stanza open"><div class="message-stanza open">&gt;&gt;
&gt;&gt; Otherwise, when trying to compile the obj file,
</div></div>
&#40;by which I meant that when I ran &#39;cl -c API_test.cpp&#39;&#41;

<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; I got errors of the
&gt;&gt; type:
&gt;&gt;
&gt;&gt; API_test.cpp&#40;31&#41; : error C2491: &#39;nAPI_test&#39; : definition of dllimport
&gt;&gt; data
&gt;&gt; not allowed
&gt;&gt; API_test.cpp&#40;33&#41; : error C2491: &#39;sum_integers&#39; : definition of
&gt;&gt; dllimport
&gt;&gt; function not allowed
&gt;&gt; API_test.cpp&#40;37&#41; : error C2491: &#39;sum_integers_ref&#39; : definition of
&gt;&gt; dllimport
&gt;&gt; function not allowed
&gt;&gt; [and more similar]
</div>&gt;
&gt; That&#39;s strange. I don&#39;t understand.
</div>
Yes, seems odd to me that the existing source is &#40;apparently&#41; legal for some 
MS compilers, but not others.

<div class="message-stanza open">&gt; I&#39;m trying to get access to a x64 environment with a working MSVC, to
&gt; test this.
</div>
The compiler I&#39;m using &#40;which is the same compiler that ActiveState used to 
build their x64 perl&#41; is not strictly an MSVC++ compiler - it&#39;s the 
&#34;Microsoft Platform SDK for Windows Server 2003 R2&#34;.

Jan reckons it&#39;s still freely available, and he&#39;s probably right. But I can 
no longer find a link to the damn thing - every link I come up with morphs 
into a download of  &#34;Microsoft Platform SDK for Windows Server 2008&#34;, which 
&#40;I think&#41; is not the same thing.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-775136" href="/Public/Bug/Display.html?id=55660#txn-775136">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;10&nbsp;15:08:35&nbsp;2010</span>
    <span class="description">jand [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 May 2010 09:41:26 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;&#39;Sisyphus&#39;&#34; &lt;sisyphus1 [...] optusnet.com.au&gt;, &lt;bug-Win32-API [...] rt.cpan.org&gt;, &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Jan Dubois&#34; &lt;jand [...] activestate.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/775136/401421/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/401421">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 10 May 2010, Sisyphus wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The compiler I&#39;m using &#40;which is the same compiler that ActiveState used to
&gt; build their x64 perl&#41; is not strictly an MSVC++ compiler - it&#39;s the
&gt; &#34;Microsoft Platform SDK for Windows Server 2003 R2&#34;.
&gt; 
&gt; Jan reckons it&#39;s still freely available, and he&#39;s probably right. But I can
&gt; no longer find a link to the damn thing - every link I come up with morphs
&gt; into a download of  &#34;Microsoft Platform SDK for Windows Server 2008&#34;, which
&gt; &#40;I think&#41; is not the same thing.
</div>
You are probably always clicking on the DVD/ISO or Web Setup links that follow
the &#34;Note: this SDK has been replaced by the Windows Server 2008 SDK&#34; entry.
Those do indeed go to the newer SDK.  The actual download links are at the
very bottom of the original page:

ISO image download:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=E15438AC-60BE-41BD-AA14-7F1E0F19CA0D&#38;displaylang=en">http://www.microsoft.com/downloads/details.aspx?FamilyId=E15438AC-60BE-41BD-AA14-7F1E0F19CA0D&#38;displaylang=en</a></span>

Web setup:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=0BAF2B35-C656-4969-ACE8-E4C0C0716ADB&#38;displaylang=en">http://www.microsoft.com/downloads/details.aspx?FamilyId=0BAF2B35-C656-4969-ACE8-E4C0C0716ADB&#38;displaylang=en</a></span>

Full download:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=484269E2-3B89-47E3-8EB7-1F2BE6D7123A&#38;displaylang=en#filelist">http://www.microsoft.com/downloads/details.aspx?FamilyId=484269E2-3B89-47E3-8EB7-1F2BE6D7123A&#38;displaylang=en#filelist</a></span>

Cheers,
-Jan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-776294" href="/Public/Bug/Display.html?id=55660#txn-776294">#</a>      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;12&nbsp;15:47:48&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/776294/402040/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/402040">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 478b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon May 10 08:19:17 2010, sisyphus1@optusnet.com.au wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ----- Original Message -----
&gt; From: &#34;Cosimo Streppone via RT&#34; &lt;bug-Win32-API@rt.cpan.org&gt;
&gt; 
<div class="message-stanza open">&gt; &gt; Please send me your API_test64.dll.
</div>&gt; 
&gt; Sure - I&#39;ll send it to you offlist. &#40;Anyone else wants one just let me
&gt; know.&#41;
</div>
Thanks to Rob, the 64-bits version of the test library is now available 
in the Win32::API git repository here:

<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/blob/master/API_test64.dll">http://github.com/cosimo/perl5-win32-api/blob/master/API_test64.dll</a></span>

-- 
Cosimo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-787564" href="/Public/Bug/Display.html?id=55660#txn-787564">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;07&nbsp;08:56:43&nbsp;2010</span>
    <span class="description">KENTNL [...] cpan.org -  Cc KENTNL added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-800277" href="/Public/Bug/Display.html?id=55660#txn-800277">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;04&nbsp;16:34:38&nbsp;2010</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> adamk [...] cpan.org, sisyphus1 [...] optusnet.com.au, csjewell [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/800277/414857/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/414857">with headers</a>
<br />
<span class="downloadcontenttype">text/html 478b</span>
</div>
<div class="messagebody">
<div class="message-stanza">Hi cosimo,<br>

<br>

please cosider applying my patch for building Win32::API with 64bit GNU compiler/assembler (e.g. strawberry perl).<br>

<br>

Look at:&nbsp;<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/kmx/perl5-win32-api">http://github.com/kmx/perl5-win32-api</a></span> (I&nbsp;have just sent you pull request via github)<br>

<br>

With this patch Win32::API builds fine on 64strawberry perl; however there are still 2 failing tests:<br>

t/01_Struct.t - test 5 (perl.exe crashes)<br>

t/03_undef.t - test 3<br>

<br>

--<br>

kmx<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-800282" href="/Public/Bug/Display.html?id=55660#txn-800282">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;04&nbsp;16:35:54&nbsp;2010</span>
    <span class="description">kmx [...] cpan.org -  Cc KMX added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-800486" href="/Public/Bug/Display.html?id=55660#txn-800486">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;06&nbsp;04:23:12&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/800486/414986/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/414986">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 267b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jul 04 16:34:38 2010, KMX wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; please cosider applying my patch for building Win32::API with 64bit
&gt; GNU compiler/assembler &#40;e.g. strawberry perl&#41;.
</div>
Thanks, applied.

I really need to get a hold of a 64 bit machine, or I&#39;ll never be able to 
test this...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-801785" href="/Public/Bug/Display.html?id=55660#txn-801785">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;09&nbsp;05:26:39&nbsp;2010</span>
    <span class="description">SBennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 9 Jul 2010 09:15:13 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/801785/415648/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/415648">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 607b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Another two patches: First, don&#39;t build or test the Callback module on x86_64, since it doesn&#39;t work. Second, add support for the DWORD_PTR type, which is different sizes on 32- and 64-bit Windows.

A patch I&#39;m about to write for Win32::SystemInfo needs this second change, even if nothing else does.

The second patch again includes rebuilt DLLs; somebody may want to check these and see if they suffer from the same mangling that my previous attempt did.

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/801785/415649/0001-Don-t-build-or-test-Callback-module-on-x64_64-it-doe.patch">Download 0001-Don-t-build-or-test-Callback-module-on-x64_64-it-doe.patch</a><br />
<span class="downloadcontenttype">text/x-diff 2k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/801785/415650/0002-Add-support-for-DWORD_PTR-type-in-function-arguments.patch">Download 0002-Add-support-for-DWORD_PTR-type-in-function-arguments.patch</a><br />
<span class="downloadcontenttype">text/x-diff 48.9k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-801793" href="/Public/Bug/Display.html?id=55660#txn-801793">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;09&nbsp;05:47:25&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/801793/415657/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/415657">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 539b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jul 09 05:26:39 2010, SBennett@accelrys.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Another two patches: First, don&#39;t build or test the Callback module on
&gt; x86_64, since it doesn&#39;t work. Second, add support for the DWORD_PTR
&gt; type, which is different sizes on 32- and 64-bit Windows.
</div>
Hi Stephen,

do you have a github account?
I just added KMX to the perl5-win32-api repository
and I could add you too.
I don&#39;t want to be a bottleneck for the great work you&#39;re doing.

<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/">http://github.com/cosimo/perl5-win32-api/</a></span>

I will apply the patches you sent by this week.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-801973" href="/Public/Bug/Display.html?id=55660#txn-801973">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;09&nbsp;11:00:45&nbsp;2010</span>
    <span class="description">SBennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 9 Jul 2010 16:00:29 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/801973/415761/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/415761">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 216b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Stephen,
&gt;
&gt; do you have a github account?
</div>
I do now -- spb.

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-801987" href="/Public/Bug/Display.html?id=55660#txn-801987">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;09&nbsp;11:16:59&nbsp;2010</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/801987/415771/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/415771">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 224b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jul 09 11:00:45 2010, SBennett@accelrys.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Hi Stephen,
&gt; &gt;
&gt; &gt; do you have a github account?
</div>&gt; 
&gt; I do now -- spb.
</div>

Cool.

You and KMX have now full power over <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-">http://github.com/cosimo/perl5-win32-</a></span>
api/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-802724" href="/Public/Bug/Display.html?id=55660#txn-802724">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;12&nbsp;11:36:22&nbsp;2010</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> SBennett [...] accelrys.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/802724/416148/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/416148">with headers</a>
<br />
<span class="downloadcontenttype">text/html 6.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza">Hi Stephen,<br>

<br>

I have just notice you patches commited to github. <br>

<br>

I completely agree with the patch fixing pointer length but as for the changes in Types.pm we have also to fixed the following items which have sizeof(&lt;item&gt;) == 4 on Win32 however sizeof(&lt;item&gt;) == 8 on Win64 (not all of them are technically pointers):<br>

<br>


    
    
        
            HACCEL
        
        
            HANDLE
        
        
            HBITMAP
        
        
            HBRUSH
        
        
            HCOLORSPACE
        
        
            HCONV
        
        
            HCONVLIST
        
        
            HCURSOR
        
        
            HDC
        
        
            HDDEDATA
        
        
            HDESK
        
        
            HDROP
        
        
            HDWP
        
        
            HENHMETAFILE
        
        
            HFONT
        
        
            HGDIOBJ
        
        
            HGLOBAL
        
        
            HHOOK
        
        
            HICON
        
        
            HIMC
        
        
            HINSTANCE
        
        
            HKEY
        
        
            HKL
        
        
            HLOCAL
        
        
            HMENU
        
        
            HMETAFILE
        
        
            HMODULE
        
        
            HPALETTE
        
        
            HPEN
        
        
            HRGN
        
        
            HRSRC
        
        
            HSZ
        
        
            HWINSTA
        
        
            HWND
        
        
            LPARAM
        
        
            LRESULT
        
        
            SC_HANDLE
        
        
            SC_LOCK
        
        
            SERVICE_STATUS_HANDLE
        
        
            SIZE_T
        
        
            SSIZE_T
        
        
            UINT_PTR
        
        
            WPARAM
        
    

<br>

We should probably introduce another type &quot;nickname&quot; e.g. _L for 64 bit &quot;long long&quot; (just proposal following your convention &quot;P&quot; vs. &quot;_P&quot;) <br>

<br>

--<br>

kmx<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-802729" href="/Public/Bug/Display.html?id=55660#txn-802729">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;12&nbsp;11:52:56&nbsp;2010</span>
    <span class="description">SBennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 12 Jul 2010 16:52:33 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;SBennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/802729/416153/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/416153">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 847b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ah yes, I&#39;d forgotten about those.

However, I&#39;d suggest they can probably just use the _P name as DWORD_PTR does -- MSDN lists them all as being equivalent either to a HANDLE &#40;hence PVOID&#41; or a *_PTR type &#40;hence pointer sized&#41;[1]. The argument in favour of having separate _P and _L size markers would be future-proofing, but experience suggests there&#39;s absolutely no telling what the Win32 API will look like for any possible future architecture, so I&#39;d rather handle the current possibilities in the simplest manner possible.

So yes, they&#39;re not technically pointers but are all defined as being the same size as a pointer.

[1]: <span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-us/library/aa383751&#40;VS.85&#41;.aspx">http://msdn.microsoft.com/en-us/library/aa383751&#40;VS.85&#41;.aspx</a></span>

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-802733" href="/Public/Bug/Display.html?id=55660#txn-802733">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;12&nbsp;12:03:38&nbsp;2010</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;KENTNL [...] cpan.org&gt;, &lt;ROBINS [...] cpan.org&gt;, &lt;kmx [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 12 Jul 2010 18:03:19 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/802733/416157/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/416157">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 846b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, I&#39;d suggest they can probably just use 
&gt; the _P name as DWORD_PTR does -- MSDN lists them
&gt; all as being equivalent either to a HANDLE &#40;hence
&gt; PVOID&#41; or a *_PTR type &#40;hence pointer sized&#41;[1]. The
&gt; argument in favour of having separate _P and _L size
&gt; markers would be future-proofing, but experience
&gt; suggests there&#39;s absolutely no telling what the Win32 API
&gt; will look like for any possible future architecture, so I&#39;d
&gt; rather handle the current possibilities in the simplest
&gt; manner possible.
</div>
OK, I agree.

--
kmx

So yes, they&#39;re not technically pointers but are all defined as being the same size as a pointer.

[1]: <span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-us/library/aa383751&#40;VS.85&#41;.aspx">http://msdn.microsoft.com/en-us/library/aa383751&#40;VS.85&#41;.aspx</a></span>

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-802811" href="/Public/Bug/Display.html?id=55660#txn-802811">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;12&nbsp;15:46:15&nbsp;2010</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/802811/416195/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/416195">with headers</a>
<br />
<span class="downloadcontenttype">text/html 224b</span>
</div>
<div class="messagebody">
<div class="message-stanza">I have just commited some changes to github repo.<br>

<br>

Now the only failing test seems to be t/03_undef.t (test 3) - which is related to another RT 39730 (reopened by me a minute ago).<br>

<br>

--<br>

kmx<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-803214" href="/Public/Bug/Display.html?id=55660#txn-803214">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;13&nbsp;09:37:25&nbsp;2010</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> SBennett [...] accelrys.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/803214/416390/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/416390">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza">Latest progress with Win32::API<br>

<br>

1/ I have commited another set of small changes fixing 64bit-pointer-size issues<br>

<br>

2/ we have still t/03_undef.t failing sometimes (surprisingly on ActivePerl not on Strawberry Perl - at least on my Win7 box)<br>

<br>

3/ a new issue appeared in Struct.pm - after Stephen added another DWORD_PTR item in testing structure it turned out that implemented alignment in C struct packing (see &quot;sub getPack&quot; in Struct.pm) does not work properly as the algorithm aligns all stuct items to the size of the biggest one - which is simply not correct (but works in some cases). My investigation revealed that C struct alignment is kind of &quot;dark magic&quot; (now you can observe this on failing tests 6-7 in t/01_Struct.t - just on32bit!!; on 64bit the alignment is &quot;accidentally&quot; calculated correctly)<br>

<br>

That is all from me. For a while I will not be able to work on this RT (all I have done is either commited in github or described here).<br>

<br>

--<br>

kmx<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-807912" href="/Public/Bug/Display.html?id=55660#txn-807912">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;23&nbsp;02:36:48&nbsp;2010</span>
    <span class="description">temp1002 [...] debusschere.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> temp1002 [...] debusschere.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/807912/418840/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/418840">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for working on this  port.
I just ran the tests with 2 fails, have not had time to
work through them.

Using
This is perl 5, version 12, subversion 0 &#40;v5.12.0&#41; built for
MSWin32-x64-multi-thread
gcc version 4.4.3 &#40;GCC&#41;

t/00_API.t .......... 1/25 # API test dll found at &#40;API_test64.dll&#41;

#   Failed test &#39;sum_integers&#40;&#41; function defined&#39;
#   at t/00_API.t line 86.
Can&#39;t call method &#34;Call&#34; on an undefined value at t/00_API.t line 88.
# Looks like you planned 25 tests but ran 11.
# Looks like you failed 1 test of 11 run.
# Looks like your test exited with 5 just after 11.
t/00_API.t .......... Dubious, test returned 5 &#40;wstat 1280, 0x500&#41;
Failed 15/25 subtests
t/01_Struct.t ....... 1/7
#   Failed test &#39;mangle_simple_struct&#40;&#41; function&#39;
#   at t/01_Struct.t line 52.
# $^E=Access is denied
Can&#39;t call method &#34;Call&#34; on an undefined value at t/01_Struct.t line 55.
# Looks like you planned 7 tests but ran 5.
# Looks like you failed 1 test of 5 run.
# Looks like your test exited with 5 just after 5.
t/01_Struct.t ....... Dubious, test returned 5 &#40;wstat 1280, 0x500&#41;
Failed 3/7 subtests
t/02_GetProcess.t ... 1/3 # $result=3032
# $$=3032
t/02_GetProcess.t ... ok
t/03_undef.t ........ # Win32::API 0.60_64
t/03_undef.t ........ 1/3 # Import: The handle is invalid
t/03_undef.t ........ ok
t/04_rt_48006.t ..... 1/3 # Size is 296. Should be 296
t/04_rt_48006.t ..... ok
t/05_more_struct.t .. ok

Test Summary Report
-------------------
t/00_API.t        &#40;Wstat: 1280 Tests: 11 Failed: 1&#41;
  Failed test:  11
  Non-zero exit status: 5
  Parse errors: Bad plan.  You planned 25 tests but ran 11.
t/01_Struct.t     &#40;Wstat: 1280 Tests: 5 Failed: 1&#41;
  Failed test:  5
  Non-zero exit status: 5
  Parse errors: Bad plan.  You planned 7 tests but ran 5.
Files=6, Tests=53,  1 wallclock secs &#40; 0.05 usr +  0.03 sys =  0.08 CPU&#41;
Result: FAIL
Failed 2/6 test programs. 2/53 subtests failed.
dmake.exe:  Error code 255, while making &#39;test_dynamic&#39;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-872544" href="/Public/Bug/Display.html?id=55660#txn-872544">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;22&nbsp;20:35:36&nbsp;2010</span>
    <span class="description">mkanat [...] cpan.org - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/872544/451837/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/451837">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 81b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">At this point, this is a duplicate of ticket 55660 and should be merged 
into it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-872548" href="/Public/Bug/Display.html?id=55660#txn-872548">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;22&nbsp;20:36:12&nbsp;2010</span>
    <span class="description">mkanat [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/872548/451841/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/451841">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 39b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">  Any hope of progress on this?

  -Max
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874336" href="/Public/Bug/Display.html?id=55660#txn-874336">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;28&nbsp;14:46:38&nbsp;2010</span>
    <span class="description">RIVY [...] cpan.org -  Requestor RIVY added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-874337" href="/Public/Bug/Display.html?id=55660#txn-874337">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;28&nbsp;14:47:44&nbsp;2010</span>
    <span class="description">RIVY [...] cpan.org - Ticket #42685:  Requestor RIVY added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-884080" href="/Public/Bug/Display.html?id=55660#txn-884080">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;20&nbsp;01:14:27&nbsp;2011</span>
    <span class="description">jain_vipin_swm [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jain_vipin_swm [...] yahoo.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/884080/458178/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/458178">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 17 10:09:53 2010, SBennett@accelrys.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The attached three patches &#40;against Win32-API-0.59&#41; implement initial
&gt;    support for 64-bit Windows in Win32-API.
&gt; 
&gt; I didn&#39;t attempt to
&gt;    port Win32::API::Callback. It looks like considerably more effort
&gt;    than Win32::API itself, and as our application doesn&#39;t need it I
&gt;    couldn&#39;t justify the paid time to spend on it. This is, however,
&gt;    sufficient for Win32::API tests to pass against a 64-bit ActivePerl
&gt;    5.8.9.
&gt; 
&gt; At present, only MSVC++ toolchains will work, as its
&gt;    assembly dialect is different from GNU. I don&#39;t have a gcc-based
&gt;    build of Perl to work with to port it, but it should only require a
&gt;    straightforward translation of call_asm_x64_msvc.asm into
&gt;    call_asm_x64_gnu.asm.
&gt; 
&gt; The required changes to Makefile.PL are
&gt;    also somewhat hackish, purely because I don&#39;t know of a better way
&gt;    to detect what architecture we&#39;re targeting.
&gt; 
&gt; Accelrys Limited
&gt;    &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
&gt; Registered office: 334 Cambridge Science
&gt;    Park, Cambridge, CB4 0WN, UK
&gt; Registered in England: 2326316
</div>
It seems that call_x64_real assembly function has a bug. It causes a 
perl crash if we call a Windows API needing more than 4 parameters.
Ex. 
Win32::DriveInfo::GetFreeDiskSpace,Win32::DriveInfo::GetFreeDiskSpaceEx.

These APIs expect more than 4 parameter, so some of the parameters 
&#40;nstack = nparams - available_registers&#41; are copied from copystack 
block of assembly code. This code has a bug which I fixed. I attached a 
patch for this.

Basically, we were subtracting before testing for zero, this resulted 
into non-zero value when rax = 0 and instruction &#34;sub rax 1&#34; executed.

-Vipin
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> mylog</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/884080/458179/mylog">Download mylog</a><br />
<span class="downloadcontenttype">text/plain 413b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff --git a/call_asm_x64_msvc.asm b/call_asm_x64_msvc.asm
index 7f8b2b0..43e8941 100755
--- a/call_asm_x64_msvc.asm
+++ b/call_asm_x64_msvc.asm
@@ -38,12 +38,11 @@ Call_x64_real PROC FRAME
     ; Except not if there isn&#39;t any
     test rax, rax
     jz docall
-    sub rax, 1
 
 copystack:
+    sub rax, 1
     mov r10, qword ptr [rsi+8*rax]
     push r10
-    sub rax, 1
     test rax, rax
     jnz copystack
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-884091" href="/Public/Bug/Display.html?id=55660#txn-884091">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;20&nbsp;01:18:25&nbsp;2011</span>
    <span class="description">jain_vipin_swm [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jain_vipin_swm [...] yahoo.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/884091/458184/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/458184">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 17 10:09:53 2010, SBennett@accelrys.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The attached three patches &#40;against Win32-API-0.59&#41; implement initial
&gt;    support for 64-bit Windows in Win32-API.
&gt; 
&gt; I didn&#39;t attempt to
&gt;    port Win32::API::Callback. It looks like considerably more effort
&gt;    than Win32::API itself, and as our application doesn&#39;t need it I
&gt;    couldn&#39;t justify the paid time to spend on it. This is, however,
&gt;    sufficient for Win32::API tests to pass against a 64-bit ActivePerl
&gt;    5.8.9.
&gt; 
&gt; At present, only MSVC++ toolchains will work, as its
&gt;    assembly dialect is different from GNU. I don&#39;t have a gcc-based
&gt;    build of Perl to work with to port it, but it should only require a
&gt;    straightforward translation of call_asm_x64_msvc.asm into
&gt;    call_asm_x64_gnu.asm.
&gt; 
&gt; The required changes to Makefile.PL are
&gt;    also somewhat hackish, purely because I don&#39;t know of a better way
&gt;    to detect what architecture we&#39;re targeting.
&gt; 
&gt; Accelrys Limited
&gt;    &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
&gt; Registered office: 334 Cambridge Science
&gt;    Park, Cambridge, CB4 0WN, UK
&gt; Registered in England: 2326316
</div>

I attached a patch to fix a bug when Windows API is used which requires 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 4 parameters.
</div>
-Vipin
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0004-Add-a-x64-bug-fix-call_x64_real-func.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/884091/458185/0004-Add-a-x64-bug-fix-call_x64_real-func.txt">Download 0004-Add-a-x64-bug-fix-call_x64_real-func.txt</a><br />
<span class="downloadcontenttype">text/plain 413b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff --git a/call_asm_x64_msvc.asm b/call_asm_x64_msvc.asm
index 7f8b2b0..43e8941 100755
--- a/call_asm_x64_msvc.asm
+++ b/call_asm_x64_msvc.asm
@@ -38,12 +38,11 @@ Call_x64_real PROC FRAME
     ; Except not if there isn&#39;t any
     test rax, rax
     jz docall
-    sub rax, 1
 
 copystack:
+    sub rax, 1
     mov r10, qword ptr [rsi+8*rax]
     push r10
-    sub rax, 1
     test rax, rax
     jnz copystack
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-884171" href="/Public/Bug/Display.html?id=55660#txn-884171">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;20&nbsp;04:55:09&nbsp;2011</span>
    <span class="description">Stephen.Bennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 20 Jan 2011 09:54:46 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;Stephen.Bennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/884171/458227/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/458227">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 488b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I attached a patch to fix a bug when Windows API is used which requires
<div class="message-stanza open">&gt; &gt; 4 parameters.
</div>&gt;
&gt; -Vipin
</div>
This is fixed in git for both ASM dialects; thanks.

I remember now noticing this a few months back and forgetting about it before I had time to investigate whether it really was wrong -- apparently this code path isn&#39;t often hit.

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-884552" href="/Public/Bug/Display.html?id=55660#txn-884552">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;20&nbsp;17:51:52&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/884552/458404/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/458404">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 538b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 20 04:55:09 2011, Stephen.Bennett@accelrys.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I attached a patch to fix a bug when Windows API is used which
</div>&gt; requires
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; 4 parameters.
</div>&gt; &gt;
&gt; &gt; -Vipin
</div>&gt; 
&gt; This is fixed in git for
&gt; both ASM dialects; thanks.
&gt; 
&gt; I remember now noticing this a few
&gt; months back and forgetting about it before I had time to investigate
&gt; whether it really was wrong -- apparently this code path isn&#39;t often
&gt; hit.
</div>
I&#39;d say this is worth a new release on CPAN.
I could pack things up for 0.60.
What you guys think?

-- 
Cosimo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-886723" href="/Public/Bug/Display.html?id=55660#txn-886723">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;25&nbsp;02:22:06&nbsp;2011</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/886723/459581/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/459581">with headers</a>
<br />
<span class="downloadcontenttype">text/html 585b</span>
</div>
<div class="messagebody">
<div class="message-stanza"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I'd say this is worth a new release on CPAN. <br>

&gt; I could pack things up for 0.60. <br>

&gt; What you guys think? <br>
</div><br>

The current github version on strawberry perl x64 has the only issue - t\03_undef.t crashes (I think it is more about broken test that broken Win32::API). This has to be fixed before release.<br>

<br>

Apart from that I do not have a good feeling about struct alignment on x64 (which I was hacking in July/2010) - it may be broken for some specific corner cases. But I would not consider this a show stopper.<br>

<br>

--<br>

kmx<br>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-886773" href="/Public/Bug/Display.html?id=55660#txn-886773">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;25&nbsp;05:11:53&nbsp;2011</span>
    <span class="description">Stephen.Bennett [...] accelrys.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Jan 2011 10:11:14 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephen Bennett &lt;Stephen.Bennett [...] accelrys.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/886773/459614/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/459614">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 734b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The current github version on strawberry perl x64 has the only issue -
&gt; t\03_undef.t crashes &#40;I think it is more about broken test that broken
&gt; Win32::API&#41;. This has to be fixed before release.
</div>
This also fails on ActivePerl x64 &#40;but doesn&#39;t crash&#41;:

# Win32::API 0.60_64
# Import: The handle is invalid
# PeekNamedPipe: The handle is invalid

#   Failed test &#39;&#40;RT \#39730&#41; sample API &#40;PeekNamedPipe&#41; works with undef values&#39;
#   at t/03_undef.t line 60.
# Looks like you failed 1 test of 3.

I&#39;ve not had a chance to investigate properly, and likely won&#39;t for a while.

Accelrys Limited &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
Registered office: 334 Cambridge Science Park, Cambridge, CB4 0WN, UK
Registered in England: 2326316
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898531" href="/Public/Bug/Display.html?id=55660#txn-898531">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;04:56:29&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> steven.bauer [...] amd.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/898531/465895/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/465895">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 80b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is now a duplicate of #55660, so rejecting &#40;no way to file as 
duplicate?&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898536" href="/Public/Bug/Display.html?id=55660#txn-898536">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;04:56:30&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org - Ticket #42685:  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898854" href="/Public/Bug/Display.html?id=55660#txn-898854">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;12:41:41&nbsp;2011</span>
    <span class="description">JDB [...] cpan.org - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/898854/466118/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/466118">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 47b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ticket was supposed to be merged, not rejected.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898857" href="/Public/Bug/Display.html?id=55660#txn-898857">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;12:41:42&nbsp;2011</span>
    <span class="description">The RT System itself - Ticket #42685:  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898988" href="/Public/Bug/Display.html?id=55660#txn-898988">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;16:28:51&nbsp;2011</span>
    <span class="description">cosimo [...] streppone.it - Ticket #42685:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #42685] Version of Win32::API for 64-bit Windows </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 18 Feb 2011 08:28:37 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-API [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Cosimo Streppone&#34; &lt;cosimo [...] streppone.it&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/898988/466222/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/466222">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 272b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 18 Feb 2011 04:41:42 +1100, Jan Dubois via RT  
&lt;bug-Win32-API@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Ticket was supposed to be merged, not rejected.
</div>
Sorry, but I have no idea how to do that.
I might be a bit stupid, but the user interface doesn&#39;t help me very much.

-- 
Cosimo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-899011" href="/Public/Bug/Display.html?id=55660#txn-899011">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;16:46:24&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org - Ticket #42685:  Merged into ticket #55660</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-899012" href="/Public/Bug/Display.html?id=55660#txn-899012">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;16:46:24&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org -  Merged into ticket #55660</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-905993" href="/Public/Bug/Display.html?id=55660#txn-905993">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;02&nbsp;17:44:18&nbsp;2011</span>
    <span class="description">ddascalescu+perl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> AZAWAWI [...] cpan.org, chorny [...] cpan.org, adamk [...] cpan.org,
 libwin32 [...] perl.org, cosimo [...] streppone.it</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/905993/469988/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/469988">with headers</a>
<br />
<span class="downloadcontenttype">text/html 222b</span>
</div>
<div class="messagebody">
<div class="message-stanza">Any chance to push v0.60? I'm trying to install Padre, which depends on Win32::API. I&nbsp;seem to have the same error with &quot;operands invalid for 'push'&quot; (log attached).<br>

<br>

--<br>

Dan Dascalescu<br>
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> win32_api_build_failure.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/905993/469989/win32_api_build_failure.txt">Download win32_api_build_failure.txt</a><br />
<span class="downloadcontenttype">text/plain 4.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">--&gt; Working on Win32::API
Fetching <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/C/CO/COSIMO/Win32-API-0.59.tar.gz">http://search.cpan.org/CPAN/authors/id/C/CO/COSIMO/Win32-API-0.59.tar.gz</a></span>
-&gt; OK
Unpacking Win32-API-0.59.tar.gz
Entering Win32-API-0.59
Configuring Win32-API-0.55
Running Makefile.PL
Checking if your kit is complete...
Looks good
Writing Makefile for Win32::API::Callback
Writing Makefile for Win32::API
-&gt; OK
Finding PREREQ from Makefile ...
Checking if you have Win32 0 ... Yes &#40;0.39&#41;
Building and testing Win32-API-0.55
cp Type.pm blib\lib\Win32/API/Type.pm
cp Callback.pm blib\lib\Win32/API/Callback.pm
cp Test.pm blib\lib\Win32/API/Test.pm
cp Struct.pm blib\lib\Win32/API/Struct.pm
cp API.pm blib\lib\Win32/API.pm
C:\strawberry\perl\bin\perl.exe C:\strawberry\perl\lib\ExtUtils\xsubpp  -typemap C:\strawberry\perl\lib\ExtUtils\typemap  Callback.xs &gt; Callback.xsc &#38;&#38; C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;mv&#34; -- Callback.xsc Callback.c
gcc -c   	-s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields -DPERL_MSVCRT_READFIX -s -O2 	  -DVERSION=\&#34;0.59\&#34; 	-DXS_VERSION=\&#34;0.59\&#34;  &#34;-IC:\strawberry\perl\lib\CORE&#34;   Callback.c
Callback.xs: In function &#39;CallbackMakeStruct&#39;:
Callback.xs:250: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;CallbackTemplate&#39;:
Callback.xs:305: warning: cast to pointer from integer of different size
Callback.xs:313: warning: cast to pointer from integer of different size
Callback.xs: In function &#39;CallbackCreate&#39;:
Callback.xs:581: warning: cast from pointer to integer of different size
Callback.xs:596: warning: cast from pointer to integer of different size
Callback.xs:597: warning: cast from pointer to integer of different size
Callback.xs:637: warning: cast from pointer to integer of different size
Callback.xs:687: warning: cast from pointer to integer of different size
Callback.xs:738: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;XS_Win32__API__Callback_CallbackCreate&#39;:
Callback.xs:868: warning: cast from pointer to integer of different size
Callback.xs: In function &#39;XS_Win32__API__Callback_PushSelf&#39;:
Callback.xs:896: warning: cast from pointer to integer of different size
Running Mkbootstrap for Win32::API::Callback &#40;&#41;
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644 Callback.bs
C:\strawberry\perl\bin\perl.exe -MExtUtils::Mksymlists \
     -e &#34;Mksymlists&#40;&#39;NAME&#39;=&gt;\&#34;Win32::API::Callback\&#34;, &#39;DLBASE&#39; =&gt; &#39;Callback&#39;, &#39;DL_FUNCS&#39; =&gt; {  }, &#39;FUNCLIST&#39; =&gt; [], &#39;IMPORTS&#39; =&gt; {  }, &#39;DL_VARS&#39; =&gt; []&#41;;&#34;
dlltool --def Callback.def --output-exp dll.exp
g++ -o ..\blib\arch\auto\Win32\API\Callback\Callback.dll -Wl,--base-file -Wl,dll.base -mdll -s -L&#34;C:\strawberry\perl\lib\CORE&#34; -L&#34;C:\strawberry\c\lib&#34; Callback.o -Wl,--image-base,0x21000000  C:\strawberry\perl\lib\CORE\libperl512.a -lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion -lodbc32 -lodbccp32 -lcomctl32 dll.exp
dlltool --def Callback.def --base-file dll.base --output-exp dll.exp
g++ -o ..\blib\arch\auto\Win32\API\Callback\Callback.dll -mdll -s -L&#34;C:\strawberry\perl\lib\CORE&#34; -L&#34;C:\strawberry\c\lib&#34; Callback.o -Wl,--image-base,0x21000000  C:\strawberry\perl\lib\CORE\libperl512.a -lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion -lodbc32 -lodbccp32 -lcomctl32 dll.exp 
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 755 ..\blib\arch\auto\Win32\API\Callback\Callback.dll
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;cp&#34; -- Callback.bs ..\blib\arch\auto\Win32\API\Callback\Callback.bs
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644 ..\blib\arch\auto\Win32\API\Callback\Callback.bs
C:\strawberry\perl\bin\perl.exe C:\strawberry\perl\lib\ExtUtils\xsubpp  -typemap C:\strawberry\perl\lib\ExtUtils\typemap -typemap typemap  API.xs &gt; API.xsc &#38;&#38; C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;mv&#34; -- API.xsc API.c
gcc -c   	-s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields -DPERL_MSVCRT_READFIX -s -O2 	  -DVERSION=\&#34;0.59\&#34; 	-DXS_VERSION=\&#34;0.59\&#34;  &#34;-IC:\strawberry\perl\lib\CORE&#34;   API.c
API.xs: In function &#39;XS_Win32__API_GetProcAddress&#39;:
API.xs:127: warning: cast from pointer to integer of different size
API.xs: In function &#39;XS_Win32__API_PointerTo&#39;:
API.xs:206: warning: cast from pointer to integer of different size
API.xs: In function &#39;XS_Win32__API_ReadMemory&#39;:
API.xs:223: warning: cast to pointer from integer of different size
C:\Users\A\AppData\Local\Temp\ccyvhME8.s: Assembler messages:
C:\Users\A\AppData\Local\Temp\ccyvhME8.s:3129: Error: suffix or operands invalid for `push&#39;
C:\Users\A\AppData\Local\Temp\ccyvhME8.s:3132: Error: suffix or operands invalid for `push&#39;
dmake.exe:  Error code 129, while making &#39;API.o&#39;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-906123" href="/Public/Bug/Display.html?id=55660#txn-906123">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;02&nbsp;21:13:14&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/906123/470018/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/470018">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 473b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 02 17:44:18 2011, dandv wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Any chance to push v0.60? I&#39;m trying to install Padre, which depends 
</div>on Win32::API
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I seem to have the same error with &#34;operands invalid for &#39;push&#39;&#34; &#40;log 
</div>attached&#41;.

Hi there,

does the current github version work for you?

  <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/">http://github.com/cosimo/perl5-win32-api/</a></span>

That would be pushed as 0.60, but several problems have been reported 
already, last one by Jan Dubois. You can read about it in this same 
ticket history.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-908181" href="/Public/Bug/Display.html?id=55660#txn-908181">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;08&nbsp;20:33:47&nbsp;2011</span>
    <span class="description">mcrose [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> mcrose [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/908181/471142/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/471142">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 02 21:13:14 2011, COSIMO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Mar 02 17:44:18 2011, dandv wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; Any chance to push v0.60? I&#39;m trying to install Padre, which depends 
</div>&gt; on Win32::API
<div class="message-stanza open">&gt; &gt; I seem to have the same error with &#34;operands invalid for &#39;push&#39;&#34; &#40;log 
</div>&gt; attached&#41;.
&gt; 
&gt; Hi there,
&gt; 
&gt; does the current github version work for you?
&gt; 
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/">http://github.com/cosimo/perl5-win32-api/</a></span>
&gt; 
&gt; That would be pushed as 0.60, but several problems have been reported 
&gt; already, last one by Jan Dubois. You can read about it in this same 
&gt; ticket history.
</div>
I&#39;ve pulled the latest ver. It builds, but perl crashes running tests:

C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-api-6ec0306&gt;dmake
Skip blib\lib\Win32/API/Type.pm &#40;unchanged&#41;
Skip blib\lib\Win32/API/Test.pm &#40;unchanged&#41;
Skip blib\lib\Win32/API/Struct.pm &#40;unchanged&#41;
Skip blib\lib\Win32/API.pm &#40;unchanged&#41;
gcc -c          -s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE
-DUSE_SITECUSTOMIZE -DPERL_I
MPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields
-DPERL_MSVCRT_READFIX -s -O2
          -DVERSION=\&#34;0.60_64\&#34;         -DXS_VERSION=\&#34;0.60_64\&#34; 
&#34;-IC:\strawberry\perl\lib\CORE&#34;
API.c
as  call_asm_x64_gnu.s -o call_asm_x64_gnu.o
Running Mkbootstrap for Win32::API &#40;&#41;
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644 API.bs
dlltool --def API.def --output-exp dll.exp
g++ -o blib\arch\auto\Win32\API\API.dll -Wl,--base-file -Wl,dll.base
-mdll -s -L&#34;C:\strawberry\perl\
lib\CORE&#34; -L&#34;C:\strawberry\c\lib&#34; API.o call_asm_x64_gnu.o
-Wl,--image-base,0x253c0000  C:\strawberr
y\perl\lib\CORE\libperl512.a -lmoldname -lkernel32 -luser32 -lgdi32
-lwinspool -lcomdlg32 -ladvapi32
 -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm
-lversion -lodbc32 -lodbccp32
 -lcomctl32 dll.exp
dlltool --def API.def --base-file dll.base --output-exp dll.exp
g++ -o blib\arch\auto\Win32\API\API.dll -mdll -s
-L&#34;C:\strawberry\perl\lib\CORE&#34; -L&#34;C:\strawberry\c\
lib&#34; API.o call_asm_x64_gnu.o -Wl,--image-base,0x253c0000 
C:\strawberry\perl\lib\CORE\libperl512.a
-lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32 -ladvapi32
-lshell32 -lole32 -loleaut32
 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion -lodbc32 -lodbccp32
-lcomctl32 dll.exp
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 755
blib\arch\auto\Win32\API\API.d
ll
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;cp&#34; -- API.bs
blib\arch\auto\Win32\API\API.b
s
C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644
blib\arch\auto\Win32\API\API.b
s

C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-api-6ec0306&gt;dmake
test
C:\strawberry\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&#34;test_harness&#40;0, &#39;blib\lib&#39;, &#39;blib\ar
ch&#39;&#41;&#34; t/*.t
t/00_API.t .......... 1/25 # API test dll found at &#40;API_test64.dll&#41;
Argument &#34;japh&#34; isn&#39;t numeric in pack at
C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-
api-6ec0306\blib\lib/Win32/API/Type.pm line 211.
t/00_API.t .......... ok
t/01_Struct.t ....... 1/7 # $^E=
t/01_Struct.t ....... ok
t/02_GetProcess.t ... 1/3 # $result=5080
# $$=5080
t/02_GetProcess.t ... ok
t/03_undef.t ........ # Win32::API 0.60_64
t/03_undef.t ........ 1/3 # Import: The handle is invalid


Faulting application name: perl.exe, version: 0.0.0.0, time stamp:
0x4c5228ad
Faulting module name: API.dll, version: 0.0.0.0, time stamp: 0x4d76d74e
Exception code: 0xc0000005
Fault offset: 0x0000000000002f06
Faulting process id: 0x10dc
Faulting application start time: 0x01cbddf90c7dbc0e
Faulting application path: C:\STRAWB~1\perl\bin\perl.exe
Faulting module path:
C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-api-6ec0306\blib\arch\auto\Win32\API\API.dll
Report Id: 4b551f57-49ec-11e0-9979-005056c00008
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-908185" href="/Public/Bug/Display.html?id=55660#txn-908185">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;08&nbsp;20:35:08&nbsp;2011</span>
    <span class="description">mcrose [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> mcrose [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/908185/471146/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/471146">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 08 20:33:47 2011, Oesor wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Mar 02 21:13:14 2011, COSIMO wrote:
<div class="message-stanza open">&gt; &gt; On Wed Mar 02 17:44:18 2011, dandv wrote:
&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; Any chance to push v0.60? I&#39;m trying to install Padre, which
</div></div>&gt; depends
<div class="message-stanza open">&gt; &gt; on Win32::API
<div class="message-stanza open">&gt; &gt; &gt; I seem to have the same error with &#34;operands invalid for &#39;push&#39;&#34;
</div></div>&gt; &#40;log
<div class="message-stanza open">&gt; &gt; attached&#41;.
&gt; &gt;
&gt; &gt; Hi there,
&gt; &gt;
&gt; &gt; does the current github version work for you?
&gt; &gt;
&gt; &gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/cosimo/perl5-win32-api/">http://github.com/cosimo/perl5-win32-api/</a></span>
&gt; &gt;
&gt; &gt; That would be pushed as 0.60, but several problems have been
</div>&gt; reported
<div class="message-stanza open">&gt; &gt; already, last one by Jan Dubois. You can read about it in this same
&gt; &gt; ticket history.
</div>&gt; 
&gt; I&#39;ve pulled the latest ver. It builds, but perl crashes running tests:
&gt; 
&gt; C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-api-
<div class="message-stanza open">&gt; 6ec0306&gt;dmake
</div>&gt; Skip blib\lib\Win32/API/Type.pm &#40;unchanged&#41;
&gt; Skip blib\lib\Win32/API/Test.pm &#40;unchanged&#41;
&gt; Skip blib\lib\Win32/API/Struct.pm &#40;unchanged&#41;
&gt; Skip blib\lib\Win32/API.pm &#40;unchanged&#41;
&gt; gcc -c          -s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64
&gt; -DCONSERVATIVE
&gt; -DUSE_SITECUSTOMIZE -DPERL_I
&gt; MPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -fno-strict-aliasing
&gt; -mms-bitfields
&gt; -DPERL_MSVCRT_READFIX -s -O2
&gt;           -DVERSION=\&#34;0.60_64\&#34;         -DXS_VERSION=\&#34;0.60_64\&#34;
&gt; &#34;-IC:\strawberry\perl\lib\CORE&#34;
&gt; API.c
&gt; as  call_asm_x64_gnu.s -o call_asm_x64_gnu.o
&gt; Running Mkbootstrap for Win32::API &#40;&#41;
&gt; C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644
&gt; API.bs
&gt; dlltool --def API.def --output-exp dll.exp
&gt; g++ -o blib\arch\auto\Win32\API\API.dll -Wl,--base-file -Wl,dll.base
&gt; -mdll -s -L&#34;C:\strawberry\perl\
&gt; lib\CORE&#34; -L&#34;C:\strawberry\c\lib&#34; API.o call_asm_x64_gnu.o
&gt; -Wl,--image-base,0x253c0000  C:\strawberr
&gt; y\perl\lib\CORE\libperl512.a -lmoldname -lkernel32 -luser32 -lgdi32
&gt; -lwinspool -lcomdlg32 -ladvapi32
&gt;  -lshell32 -lole32 -loleaut32 -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm
&gt; -lversion -lodbc32 -lodbccp32
&gt;  -lcomctl32 dll.exp
&gt; dlltool --def API.def --base-file dll.base --output-exp dll.exp
&gt; g++ -o blib\arch\auto\Win32\API\API.dll -mdll -s
&gt; -L&#34;C:\strawberry\perl\lib\CORE&#34; -L&#34;C:\strawberry\c\
&gt; lib&#34; API.o call_asm_x64_gnu.o -Wl,--image-base,0x253c0000
&gt; C:\strawberry\perl\lib\CORE\libperl512.a
&gt; -lmoldname -lkernel32 -luser32 -lgdi32 -lwinspool -lcomdlg32
&gt; -ladvapi32
&gt; -lshell32 -lole32 -loleaut32
&gt;  -lnetapi32 -luuid -lws2_32 -lmpr -lwinmm -lversion -lodbc32
&gt; -lodbccp32
&gt; -lcomctl32 dll.exp
&gt; C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 755
&gt; blib\arch\auto\Win32\API\API.d
&gt; ll
&gt; C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;cp&#34; -- API.bs
&gt; blib\arch\auto\Win32\API\API.b
&gt; s
&gt; C:\strawberry\perl\bin\perl.exe -MExtUtils::Command -e &#34;chmod&#34; -- 644
&gt; blib\arch\auto\Win32\API\API.b
&gt; s
&gt; 
&gt; C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-api-
<div class="message-stanza open">&gt; 6ec0306&gt;dmake
</div>&gt; test
&gt; C:\strawberry\perl\bin\perl.exe &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34;
&gt; &#34;test_harness&#40;0, &#39;blib\lib&#39;, &#39;blib\ar
&gt; ch&#39;&#41;&#34; t/*.t
&gt; t/00_API.t .......... 1/25 # API test dll found at &#40;API_test64.dll&#41;
&gt; Argument &#34;japh&#34; isn&#39;t numeric in pack at
&gt; C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-
&gt; api-6ec0306\blib\lib/Win32/API/Type.pm line 211.
&gt; t/00_API.t .......... ok
&gt; t/01_Struct.t ....... 1/7 # $^E=
&gt; t/01_Struct.t ....... ok
&gt; t/02_GetProcess.t ... 1/3 # $result=5080
&gt; # $$=5080
&gt; t/02_GetProcess.t ... ok
&gt; t/03_undef.t ........ # Win32::API 0.60_64
&gt; t/03_undef.t ........ 1/3 # Import: The handle is invalid
&gt; 
&gt; 
&gt; Faulting application name: perl.exe, version: 0.0.0.0, time stamp:
&gt; 0x4c5228ad
&gt; Faulting module name: API.dll, version: 0.0.0.0, time stamp:
&gt; 0x4d76d74e
&gt; Exception code: 0xc0000005
&gt; Fault offset: 0x0000000000002f06
&gt; Faulting process id: 0x10dc
&gt; Faulting application start time: 0x01cbddf90c7dbc0e
&gt; Faulting application path: C:\STRAWB~1\perl\bin\perl.exe
&gt; Faulting module path:
&gt; C:\strawberry\cpan\build\Win32-API-0.60\cosimo-perl5-win32-api-
&gt; 6ec0306\blib\arch\auto\Win32\API\API.dll
&gt; Report Id: 4b551f57-49ec-11e0-9979-005056c00008
&gt; 
&gt; 
</div>
oh, heh, this is mentioned above as well.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-911857" href="/Public/Bug/Display.html?id=55660#txn-911857">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;18&nbsp;22:46:28&nbsp;2011</span>
    <span class="description">cosimo [...] streppone.it -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fwd: [rt.cpan.org #55660] Fwd: CPAN Upload: C/CO/COSIMO/Win32-API-0.60.tar.gz</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 19 Mar 2011 13:46:12 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-API [...] rt.cpan.org&#34; &lt;bug-Win32-API [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Cosimo Streppone&#34; &lt;cosimo [...] streppone.it&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/911857/472991/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/472991">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 740b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I decided to push 0.60 on CPAN by
temporarily disabling the 03_undef.t test case.

Github source is tagged &#34;CPAN-v0.60&#34;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">------- Forwarded message -------
From: PAUSE &lt;upload@pause.perl.org&gt;
To: &#34;Cosimo Streppone&#34; &lt;cosimo@streppone.it&gt;
Subject: CPAN Upload: C/CO/COSIMO/Win32-API-0.60.tar.gz
Date: Sat, 19 Mar 2011 10:48:00 +1100

The uploaded file

        Win32-API-0.60.tar.gz

has entered CPAN as

      file: $CPAN/authors/id/C/CO/COSIMO/Win32-API-0.60.tar.gz
      size: 302060 bytes
       md5: 750e5aa784822a2a9d88f5b9f5bf03d9

No action is required on your part
Request entered by: COSIMO &#40;Cosimo Streppone&#41;
Request entered on: Fri, 18 Mar 2011 23:46:44 GMT
Request completed:  Fri, 18 Mar 2011 23:48:00 GMT

Thanks,


-- 
Cosimo
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912320" href="/Public/Bug/Display.html?id=55660#txn-912320">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;21&nbsp;04:13:40&nbsp;2011</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: Fwd: [rt.cpan.org #55660] Fwd: CPAN Upload: C/CO/COSIMO/Win32-API-0.60.tar.gz</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Mar 2011 09:13:30 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-API [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912320/473190/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473190">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Cosimo,

Win32-API-0.60 unfortunately fails to build on strawberry perl

on 32bit
API.xs:49:23: call_i686.h: No such file or directory

on 64bit
API.xs:47:25: error: call_x86_64.h: No such file or directory

--
kmx


Writing Makefile for Win32::API
CPAN: Module::CoreList loaded ok &#40;v2.36&#41;
cp Type.pm blib\lib\Win32/API/Type.pm
cp Test.pm blib\lib\Win32/API/Test.pm
cp Struct.pm blib\lib\Win32/API/Struct.pm
cp API.pm blib\lib\Win32/API.pm
D:\strawberry64\perl\bin\perl.exe D:\strawberry64\perl\lib\ExtUtils\xsubpp 
-typemap D:\strawberry64\perl\lib\ExtUtils\typemap -typemap typemap  API.xs
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; API.xsc &#38;&#38; D:\strawberry64\perl\bin\perl.exe -MExtUtils::Command -e &#34;mv&#34;
</div>-- API.xsc API.c
gcc -c          -s -O2 -DWIN32 -DHAVE_DES_FCRYPT -DWIN64 -DCONSERVATIVE
-DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS
-fno-strict-aliasing -mms-bitfields -DPERL_MSVCRT_READFIX -s -O2
-DVERSION=\&#34;0.60\&#34;    -DXS_VERSION=\&#34;0.60\&#34; 
&#34;-ID:\strawberry64\perl\lib\CORE&#34;   API.c
API.xs:47:25: error: call_x86_64.h: No such file or directory
dmake.EXE:  Error code 129, while making &#39;API.o&#39;
  LOCAL/Win32-API-0.60.tar.gz
  D:\strawberry64\c\bin\dmake.EXE -- NOT OK
CPAN: YAML loaded ok &#40;v0.71&#41;
Running make test
  Can&#39;t test without successful make
Running make install
  Make had returned bad status, install seems impossible
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912579" href="/Public/Bug/Display.html?id=55660#txn-912579">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;21&nbsp;20:05:28&nbsp;2011</span>
    <span class="description">cosimo [...] streppone.it -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> libwin32 [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: Fwd: [rt.cpan.org #55660] Fwd: CPAN Upload: C/CO/COSIMO/Win32-API-0.60.tar.gz</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 22 Mar 2011 11:04:58 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-API [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Cosimo Streppone&#34; &lt;cosimo [...] streppone.it&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912579/473322/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473322">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 578b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 21 Mar 2011 19:13:41 +1100, kmx via RT &lt;bug-Win32-API@rt.cpan.org&gt;  
wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Win32-API
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=55660">https://rt.cpan.org/Ticket/Display.html?id=55660</a></span> &gt;
&gt;
&gt; Hi Cosimo,
&gt;
&gt; Win32-API-0.60 unfortunately fails to build on strawberry perl
&gt;
&gt; on 32bit
&gt; API.xs:49:23: call_i686.h: No such file or directory
&gt;
&gt; on 64bit
&gt; API.xs:47:25: error: call_x86_64.h: No such file or directory
</div>
Sorry, my bad.
Should be fixed in 0.61, hitting CPAN as we speak.

Keep the feedback coming, please!
I *want* Win32::API to build and run on Strawberry 64 bit.

-- 
Cosimo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912837" href="/Public/Bug/Display.html?id=55660#txn-912837">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;11:44:15&nbsp;2011</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: Fwd: [rt.cpan.org #55660] Fwd: CPAN Upload: C/CO/COSIMO/Win32-API-0.60.tar.gz</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 22 Mar 2011 16:44:00 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-API [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912837/473468/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473468">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 612b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sorry, my bad.
&gt; Should be fixed in 0.61, hitting CPAN as we speak.
&gt;
&gt; Keep the feedback coming, please!
&gt; I *want* Win32::API to build and run on Strawberry 64 bit.
&gt;
</div>
Unfortunately there are still some issues:

1/ cosmetics - META.yml contains wrong version
see <span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/COSIMO/Win32-API-0.61/META.yml">http://cpansearch.perl.org/src/COSIMO/Win32-API-0.61/META.yml</a></span>

2/ 32bit Strawberry Perl &#40;both 5.10, 5.12&#41; crashes during t/03_Jim_Shaw.t

3/ 32bit Active Perl &#40;all 5.8, 5.10, 5.12&#41; fails &#40;no crash&#41; during
t/03_Jim_Shaw.t

Good news - 64bit  Strawberry Perl 5.12 and 64bit Active perl 5.12 PASS &#40;as
callback part is disabled on 64bit&#41;.

--
kmx
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-913001" href="/Public/Bug/Display.html?id=55660#txn-913001">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;18:41:47&nbsp;2011</span>
    <span class="description">cosimo [...] streppone.it -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;libwin32 [...] perl.org&#34; &lt;libwin32 [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: Fwd: [rt.cpan.org #55660] Fwd: CPAN Upload: C/CO/COSIMO/Win32-API-0.60.tar.gz</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 23 Mar 2011 09:41:33 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-API [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Cosimo Streppone&#34; &lt;cosimo [...] streppone.it&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/913001/473570/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473570">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, 23 Mar 2011 02:44:16 +1100, kmx via RT &lt;bug-Win32-API@rt.cpan.org&gt;  
wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue Mar 22 11:44:15 2011: Request 55660 was acted upon.
&gt; Transaction: Correspondence added by kmx@volny.cz
&gt;        Queue: Win32-API
&gt;      Subject: Re: Fwd: [rt.cpan.org #55660] Fwd: CPAN Upload:  
&gt; C/CO/COSIMO/Win32-API-0.60.tar.gz
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: &#40;no value&#41;
&gt;        Owner: COSIMO
&gt;   Requestors: RIVY@cpan.org, SBennett@accelrys.com, steven.bauer@amd.com
&gt;       Status: open
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=55660">http://rt.cpan.org/Ticket/Display.html?id=55660</a></span> &gt;
&gt;
<div class="message-stanza open">&gt;&gt; Sorry, my bad.
&gt;&gt; Should be fixed in 0.61, hitting CPAN as we speak.
&gt;&gt;
&gt;&gt; Keep the feedback coming, please!
&gt;&gt; I *want* Win32::API to build and run on Strawberry 64 bit.
</div>&gt;
&gt; Unfortunately there are still some issues:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 1/ cosmetics - META.yml contains wrong version
&gt; 2/ 32bit Strawberry Perl &#40;both 5.10, 5.12&#41; crashes during t/03_Jim_Shaw.t
&gt; 3/ 32bit Active Perl &#40;all 5.8, 5.10, 5.12&#41; fails &#40;no crash&#41; during  
&gt; t/03_Jim_Shaw.t
</div>
That&#39;s a new test that was missing from the manifest.
I&#39;ll make sure it is skipped until we understand a bit more.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Good news - 64bit  Strawberry Perl 5.12 and 64bit Active perl 5.12 PASS  
&gt; &#40;as callback part is disabled on 64bit&#41;.
</div>
\o/

I&#39;ll try to address these problems asap
and push 0.62.

We could end up with 0.64 to have proper 64 bits support :&#41;

-- 
Cosimo
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-971472" href="/Public/Bug/Display.html?id=55660#txn-971472">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;28&nbsp;16:06:22&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">60 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> adamk [...] cpan.org, kmx [...] cpan.org, kmx [...] volny.cz, ROBINS [...] cpan.org,
 Stephen.Bennett [...] accelrys.com, jain_vipin_swm [...] yahoo.com, SBennett [...] accelrys.com,
 temp1002 [...] debusschere.com, jand [...] activestate.com, chorny [...] cpan.org,
 mcrose [...] gmail.com, libwin32 [...] perl.org, sisyphus1 [...] optusnet.com.au,
 steven.bauer [...] amd.com, KENTNL [...] cpan.org, csjewell [...] cpan.org, AZAWAWI [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/971472/505536/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/505536">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 338b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">All issues mentioned in this ticket should be addressed in the current 
CPAN version of Win32::API.

I&#39;m closing this ticket as resolved. Adam/Curtis, are you applying some 
patch/fix to build Strawberry on 64 bits?

Thanks to all of you for contributing to this ticket.
Please open new ones if there&#39;s still issues with 64 bits support.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-971477" href="/Public/Bug/Display.html?id=55660#txn-971477">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;28&nbsp;16:06:24&nbsp;2011</span>
    <span class="description">cosimo [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975114" href="/Public/Bug/Display.html?id=55660#txn-975114">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;07&nbsp;17:13:51&nbsp;2011</span>
    <span class="description">adam [...] ali.as -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adamk [...] cpan.org, kmx [...] cpan.org, kmx [...] volny.cz, ROBINS [...] cpan.org,  Stephen.Bennett [...] accelrys.com, jain_vipin_swm [...] yahoo.com, SBennett [...] accelrys.com,  temp1002 [...] debusschere.com, jand [...] activestate.com, chorny [...] cpan.org,  mcrose [...] gmail.com, libwin32 [...] perl.org, sisyphus1 [...] optusnet.com.au,  steven.bauer [...] amd.com, KENTNL [...] cpan.org, csjewell [...] cpan.org, AZAWAWI [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #55660] [PATCH] Partial win64 support for Win32::API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 8 Sep 2011 07:13:43 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-API [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/975114/507465/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507465">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 699b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I haven&#39;t heard much of anything from Curtis recently, and our last
few releases are very late or missing.

I&#39;ll look at getting more involved again in development and look at a
new release.

Adam K

On 29 August 2011 06:06, Cosimo Streppone via RT
&lt;bug-Win32-API@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=55660">https://rt.cpan.org/Ticket/Display.html?id=55660</a></span> &gt;
&gt;
&gt; All issues mentioned in this ticket should be addressed in the current
&gt; CPAN version of Win32::API.
&gt;
&gt; I&#39;m closing this ticket as resolved. Adam/Curtis, are you applying some
&gt; patch/fix to build Strawberry on 64 bits?
&gt;
&gt; Thanks to all of you for contributing to this ticket.
&gt; Please open new ones if there&#39;s still issues with 64 bits support.
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975117" href="/Public/Bug/Display.html?id=55660#txn-975117">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;07&nbsp;17:13:53&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1087612" href="/Public/Bug/Display.html?id=55660#txn-1087612">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;06&nbsp;21:21:02&nbsp;2012</span>
    <span class="description">bulk88&#40;1&#41; [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bulk88&#40;1&#41; [...] hotmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1087612/571698/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/571698">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 17 10:09:53 2010, SBennett@accelrys.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The attached three patches &#40;against Win32-API-0.59&#41; implement initial
&gt;    support for 64-bit Windows in Win32-API.
&gt; 
&gt; I didn&#39;t attempt to
&gt;    port Win32::API::Callback. It looks like considerably more effort
&gt;    than Win32::API itself, and as our application doesn&#39;t need it I
&gt;    couldn&#39;t justify the paid time to spend on it. This is, however,
&gt;    sufficient for Win32::API tests to pass against a 64-bit ActivePerl
&gt;    5.8.9.
&gt; 
&gt; At present, only MSVC++ toolchains will work, as its
&gt;    assembly dialect is different from GNU. I don&#39;t have a gcc-based
&gt;    build of Perl to work with to port it, but it should only require a
&gt;    straightforward translation of call_asm_x64_msvc.asm into
&gt;    call_asm_x64_gnu.asm.
&gt; 
&gt; The required changes to Makefile.PL are
&gt;    also somewhat hackish, purely because I don&#39;t know of a better way
&gt;    to detect what architecture we&#39;re targeting.
&gt; 
&gt; Accelrys Limited
&gt;    &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://accelrys.com">http://accelrys.com</a></span>&#41;
&gt; Registered office: 334 Cambridge Science
&gt;    Park, Cambridge, CB4 0WN, UK
&gt; Registered in England: 2326316
</div>

Your &#40;IDK if you will get this from CPAN&#39;s web interface&#41; asm is broken.
RSI register is non-volatile.
<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=77677">https://rt.cpan.org/Public/Bug/Display.html?id=77677</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1087620" href="/Public/Bug/Display.html?id=55660#txn-1087620">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;06&nbsp;21:50:12&nbsp;2012</span>
    <span class="description">bulk88&#40;1&#41; [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bulk88&#40;1&#41; [...] hotmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1087620/571706/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/571706">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 597b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jul 04 16:34:38 2010, KMX wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi cosimo,
&gt; 
&gt; please cosider applying my patch for building Win32::API with 64bit
&gt; GNU
&gt; compiler/assembler &#40;e.g. strawberry perl&#41;.
&gt; 
&gt; Look at: <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/kmx/perl5-win32-api">http://github.com/kmx/perl5-win32-api</a></span> &#40;I have just sent you
&gt; pull
&gt; request via github&#41;
&gt; 
&gt; With this patch Win32::API builds fine on 64strawberry perl; however
&gt; there are
&gt; still 2 failing tests:
&gt; t/01_Struct.t - test 5 &#40;perl.exe crashes&#41;
&gt; t/03_undef.t - test 3
&gt; 
&gt; --
&gt; kmx
</div>
Your GCC asm code will crash if there are more than 4 parameters. See
<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=77677">https://rt.cpan.org/Public/Bug/Display.html?id=77677</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Steal even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1130627" href="/Public/Bug/Display.html?id=55660#txn-1130627">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;19&nbsp;01:09:40&nbsp;2012</span>
    <span class="description">BULKDD [...] cpan.org -  Stolen from COSIMO</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1131121" href="/Public/Bug/Display.html?id=55660#txn-1131121">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;19&nbsp;21:17:09&nbsp;2012</span>
    <span class="description">BULKDD [...] cpan.org -  Reference to ticket #77677 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1131126" href="/Public/Bug/Display.html?id=55660#txn-1131126">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;19&nbsp;21:26:19&nbsp;2012</span>
    <span class="description">BULKDD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> adamkennedybackup [...] gmail.com, adamk [...] cpan.org, kmx [...] cpan.org,
 kmx [...] volny.cz, Stephen.Bennett [...] accelrys.com, jain_vipin_swm [...] yahoo.com,
 bulk88 [...] hotmail.com, SBennett [...] accelrys.com, temp1002 [...] debusschere.com,
 jand [...] activestate.com, chorny [...] cpan.org, mcrose [...] gmail.com, sisyphus1 [...] optusnet.com.au,
 libwin32 [...] perl.org, steven.bauer [...] amd.com, cosimo [...] streppone.it,
 KENTNL [...] cpan.org, csjewell [...] cpan.org, AZAWAWI [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1131126/595148/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/595148">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 364b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">In <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77677">https://rt.cpan.org/Ticket/Display.html?id=77677</a></span> I identified
problems with the x64 support, basically if &gt; 4 params, usually a crash
on GCC, and theoretical but not seen in practice crash on VC. Both
problems were identified and fixed in Win32::API 0.70, so I am closing
this bug. If you all are still having problems, reply and this ticket
will reopen itself.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1131131" href="/Public/Bug/Display.html?id=55660#txn-1131131">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;19&nbsp;21:26:23&nbsp;2012</span>
    <span class="description">BULKDD [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 2.40573</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
