<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #84661 for Unicode-LineBreak: Object only accepts unicode strings</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #84661 for Unicode-LineBreak: Object only accepts unicode strings</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Unicode-LineBreak">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Unicode-LineBreak">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Unicode-LineBreak">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Unicode-LineBreak">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Unicode-LineBreak">Unicode-LineBreak CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">84661</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Unicode-LineBreak">Unicode-LineBreak</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">hatuka [...] nezumi.nu
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MARKOV [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-227344-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2012.10    </td>
  </tr>
  <tr id="CF-227345-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2013.004_26    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=84661">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1202593" href="/Public/Bug/Display.html?id=84661#txn-1202593">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;16&nbsp;06:25:36&nbsp;2013</span>
    <span class="description">MARKOV [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Object only accepts unicode strings</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1202593/634913/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634913">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 917b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Handling strings is correctly is difficult in Perl.  Sometimes we need to know the internals.  The official rule is: users should not need to know whether a string has the utf8 flag on or not.

When I do this:

  my $latin1 = chr 230;
  my $gc = Unicode::GCString-&gt;new&#40;$latin1&#41;;

I get the error

  _new: Unicode string must be given. at /home/perl/5.16.2/lib/site_perl/5.16.2/x86_64-linux/Unicode/GCString.pm line 46.

So: this does not follow Perl&#39;s rule of &#34;it just works&#34;.  I can do

  my $latin1 = chr 230;
  my $gc = Unicode::GCString-&gt;new&#40;decode latin1 =&gt; $latin1&#41;;

Now, I do not get the error.  Great.  So, for correctly calling your object in
any circumstance, I need to call:

  my $gc = Unicode::GCString-&gt;new&#40;is_utf8&#40;$s&#41; ? $s : decode&#40;latin1 =&gt; $s&#41;&#41;;

Which is inconvenient.

Please make your new&#40;&#41; internally this smart.  &#34;man perlunicode&#34; says that non-utf8 strings
are to be interpreted as in latin1.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1202698" href="/Public/Bug/Display.html?id=84661#txn-1202698">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;16&nbsp;10:51:24&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1202698/634974/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634974">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mark,

On 2013-4月-16 火 06:25:36, MARKOV wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Handling strings is correctly is difficult in Perl.  Sometimes we need
&gt; to know the internals.  The official rule is: users should not need to
&gt; know whether a string has the utf8 flag on or not.
&gt; 
&gt; When I do this:
&gt; 
&gt;   my $latin1 = chr 230;
&gt;   my $gc = Unicode::GCString-&gt;new&#40;$latin1&#41;;
&gt; 
&gt; I get the error
&gt; 
&gt;   _new: Unicode string must be given. at
&gt; /home/perl/5.16.2/lib/site_perl/5.16.2/x86_64-
&gt; linux/Unicode/GCString.pm line 46.
&gt; 
&gt; So: this does not follow Perl&#39;s rule of &#34;it just works&#34;.  I can do
&gt; 
&gt;   my $latin1 = chr 230;
&gt;   my $gc = Unicode::GCString-&gt;new&#40;decode latin1 =&gt; $latin1&#41;;
&gt; 
&gt; Now, I do not get the error.  Great.  So, for correctly calling your
&gt; object in
&gt; any circumstance, I need to call:
&gt; 
&gt;   my $gc = Unicode::GCString-&gt;new&#40;is_utf8&#40;$s&#41; ? $s : decode&#40;latin1 =&gt;
&gt; $s&#41;&#41;;
&gt; 
&gt; Which is inconvenient.
&gt; 
&gt; Please make your new&#40;&#41; internally this smart.  &#34;man perlunicode&#34; says
&gt; that non-utf8 strings
&gt; are to be interpreted as in latin1.
</div>
IMO It is the feature.

Unicode::GCString upgrades a Unicode string, not byte-string, to
a grapheme cluster string.

In fact, why is it natural that code point 230 is the small AE?
It may be the small C with circumflex for Central Europian users.
Moreover, it may be the first byte of Chinese characters encoded
by UTF-8 &#40;not utf8-flagged string&#41;.

Programmers, not users, must decode byte-string to character-
string &#40;Unicde string&#41; properly, and then feed it to new&#40;&#41; method.


Regards,

-- 
--- nezumi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1202699" href="/Public/Bug/Display.html?id=84661#txn-1202699">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;16&nbsp;10:51:24&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1202744" href="/Public/Bug/Display.html?id=84661#txn-1202744">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;16&nbsp;11:35:17&nbsp;2013</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84661] Object only accepts unicode strings</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 16 Apr 2013 17:34:42 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Hatuka*nezumi - IKEDA Soji via RT &lt;bug-Unicode-LineBreak [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1202744/634998/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634998">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Hatuka*nezumi - IKEDA Soji via RT &#40;bug-Unicode-LineBreak@rt.cpan.org&#41; [130416 14:51]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Please make your new&#40;&#41; internally this smart.  &#34;man perlunicode&#34; says
&gt; &gt; that non-utf8 strings
&gt; &gt; are to be interpreted as in latin1.
</div>&gt; 
&gt; IMO It is the feature.
&gt; 
&gt; Unicode::GCString upgrades a Unicode string, not byte-string, to
&gt; a grapheme cluster string.
&gt; 
&gt; In fact, why is it natural that code point 230 is the small AE?
&gt; It may be the small C with circumflex for Central Europian users.
&gt; Moreover, it may be the first byte of Chinese characters encoded
&gt; by UTF-8 &#40;not utf8-flagged string&#41;.
</div>
Not according to the perlunicode manual-page:

  ... implicit upgrading from byte strings to Unicode strings
  assumes that they were encoded in ISO 8859-1 &#40;Latin-1&#41;, ...

Prove:

  perl -we &#39;binmode STDOUT,&#34;:encoding&#40;utf8&#41;&#34;;print chr&#40;230&#41;.&#34;\N{U+00E6}\n&#34;&#39;
  # the first character gets converted into utf8, because the second is
  # utf8.  It uses the latin1 interpretation for the conversion.


A PV can contain three things:
  1&#41; bytes
  2&#41; latin1 string
  3&#41; utf8 string

Scalars with other than latin1/utf8 content are bytes.  You can easily
distiguish &#40;3&#41;.  The program cannot distiguish between &#40;1&#41; and &#40;2&#41;,
which is a problem.  I still like this idea:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~juerd/BLOB">http://search.cpan.org/~juerd/BLOB</a></span>

Of course, many people confuse bytes with text.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Programmers, not users, must decode byte-string to character-
&gt; string &#40;Unicde string&#41; properly, and then feed it to new&#40;&#41; method.
</div>
The official advice is: decode the data when it arrives into your program,
encode it when it leaves your program.  When you do that correctly,
inside the program your texts are either latin1 or utf8, nothing else.

I do *not* want to know for each call into modules whether I have to
apply encoding or decoding to get it to work.  Your program processes
text &#40;hence not bytes&#41;, so I expect it to handle both &#40;2&#41; and &#40;3&#41;.
In my opinion, this does not qualify as &#39;leaving the program&#39;.

When you decide to adapt your definition of text to Perl&#39;s definition,
then it is one extra line of code, and your documentation gets a little
shorter.  It will not break existing applications of your module: it
extends functionality.
-- 
Sorry for complaining,

               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1203018" href="/Public/Bug/Display.html?id=84661#txn-1203018">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;17&nbsp;10:39:46&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1203018/635151/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/635151">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 16 Apr 2013 11:35:17 -0400
&#34;Mark Overmeer via RT&#34; &lt;bug-Unicode-LineBreak@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * Hatuka*nezumi - IKEDA Soji via RT &#40;bug-Unicode-LineBreak@rt.cpan.org&#41; [130416 14:51]:
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; Please make your new&#40;&#41; internally this smart.  &#34;man perlunicode&#34; says
&gt; &gt; &gt; that non-utf8 strings
&gt; &gt; &gt; are to be interpreted as in latin1.
</div>&gt; &gt; 
&gt; &gt; IMO It is the feature.
&gt; &gt; 
&gt; &gt; Unicode::GCString upgrades a Unicode string, not byte-string, to
&gt; &gt; a grapheme cluster string.
&gt; &gt; 
&gt; &gt; In fact, why is it natural that code point 230 is the small AE?
&gt; &gt; It may be the small C with circumflex for Central Europian users.
&gt; &gt; Moreover, it may be the first byte of Chinese characters encoded
&gt; &gt; by UTF-8 &#40;not utf8-flagged string&#41;.
</div>&gt; 
&gt; Not according to the perlunicode manual-page:
&gt; 
&gt;   ... implicit upgrading from byte strings to Unicode strings
&gt;   assumes that they were encoded in ISO 8859-1 &#40;Latin-1&#41;, ...
&gt; 
&gt; Prove:
&gt; 
&gt;   perl -we &#39;binmode STDOUT,&#34;:encoding&#40;utf8&#41;&#34;;print chr&#40;230&#41;.&#34;\N{U+00E6}\n&#34;&#39;
&gt;   # the first character gets converted into utf8, because the second is
&gt;   # utf8.  It uses the latin1 interpretation for the conversion.
&gt; 
&gt; 
&gt; A PV can contain three things:
&gt;   1&#41; bytes
&gt;   2&#41; latin1 string
&gt;   3&#41; utf8 string
&gt; 
&gt; Scalars with other than latin1/utf8 content are bytes.  You can easily
&gt; distiguish &#40;3&#41;.  The program cannot distiguish between &#40;1&#41; and &#40;2&#41;,
&gt; which is a problem.  I still like this idea:
&gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~juerd/BLOB">http://search.cpan.org/~juerd/BLOB</a></span>
&gt; 
&gt; Of course, many people confuse bytes with text.
&gt; 
<div class="message-stanza open">&gt; &gt; Programmers, not users, must decode byte-string to character-
&gt; &gt; string &#40;Unicde string&#41; properly, and then feed it to new&#40;&#41; method.
</div>&gt; 
&gt; The official advice is: decode the data when it arrives into your program,
&gt; encode it when it leaves your program.  When you do that correctly,
&gt; inside the program your texts are either latin1 or utf8, nothing else.
</div>
I got it.

I thought if the advice had been done, texts inside program could
be utf8 &#40;Unicode string&#41; _at all_.  However, your example above
points out that it is impossible: Perl5 does not have notation for
Unicode literals with code points lower than 256.  So byte-strings
given by codes have to be treated as character-strings.

# IMHO, this &#34;implicit upgrade&#34; feature can not be benefit but
# trouble for non-West-European users.

Anyway, we have to admit this feature &#40;or lack of feature&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I do *not* want to know for each call into modules whether I have to
&gt; apply encoding or decoding to get it to work.  Your program processes
&gt; text &#40;hence not bytes&#41;, so I expect it to handle both &#40;2&#41; and &#40;3&#41;.
&gt; In my opinion, this does not qualify as &#39;leaving the program&#39;.
&gt; 
&gt; When you decide to adapt your definition of text to Perl&#39;s definition,
&gt; then it is one extra line of code, and your documentation gets a little
&gt; shorter.  It will not break existing applications of your module: it
&gt; extends functionality.
</div>
I now understood that everything to do is simply convert byte-
string to utf8-flagged string using such as bytes_to_utf8&#40;&#41;.

I will able to add it to next development release.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -- 
&gt; Sorry for complaining,
&gt; 
&gt;                MarkOv
</div>
Nothing.  Thank you for good suggestion!

Regards.

-- 
 --- nezumi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1212036" href="/Public/Bug/Display.html?id=84661#txn-1212036">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;14&nbsp;12:52:58&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1212038" href="/Public/Bug/Display.html?id=84661#txn-1212038">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;14&nbsp;12:52:58&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1212039" href="/Public/Bug/Display.html?id=84661#txn-1212039">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;May&nbsp;14&nbsp;12:52:58&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Fixed in 2013.004_26 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.231038</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
