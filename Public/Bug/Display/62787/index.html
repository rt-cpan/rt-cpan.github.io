<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #62787 for DBIx-Class: Join syntax errors when using MS Access</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #62787 for DBIx-Class: Join syntax errors when using MS Access</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBIx-Class/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBIx-Class/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBIx-Class/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBIx-Class/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBIx-Class">DBIx-Class CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">62787</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBIx-Class/Active/">DBIx-Class</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
bob [...] rdolson.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-10410-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.08124    </td>
  </tr>
  <tr id="CF-10411-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.08191    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;06&nbsp;20:42:56&nbsp;2010</span>
    <span class="description">bob [...] rdolson.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Join syntax errors when using MS Access</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When using joins in DBIx::Class against a Microsoft Access &#40;Jet&#41; database, the queries fail 
because the Access SQL engine requires parenthesis that other database engines do not.

For example:


    my @res = $self-&gt;schema-&gt;resultset&#40;&#39;Dog&#39;&#41;-&gt;search&#40;
                                                  { &#39;EventDateID.EventID&#39; =&gt; 56 },
                                                  { join =&gt;  { DogEntry =&gt;
                                                           { &#39;TitleEventDateID&#39; =&gt; &#39;EventDateID&#39; } },
                                                    &#39;+select&#39; =&gt; [ &#39;EventDateID.EventDate&#39; ] ,
                                                    &#39;+as&#39; =&gt; [&#39;date&#39;],
                                                  }
                                                     &#41;;


fails with


DBIx::Class::ResultSet::search&#40;&#41;: DBI Exception: DBD::Proxy::st execute failed: Server returned 
error: Failed to execute method CallMethod: DBD::ODBC::st execute failed: [Microsoft][ODBC 
Microsoft Access Driver] Syntax error &#40;missing operator&#41; in query expression &#39;DogEntry.DogID 
= me.DogID LEFT JOIN tblTitleEvent TitleEventDateID ON TitleEventDateID.TitleEventDateID = 
DogEntry.TitleEventDateID LEFT JOIN tblEventDate EventDateID ON EventDateID.EventDateID = 
TitleEventDateID.EventDateID&#39;. &#40;SQL-42000&#41; [for Statement &#34;SELECT me.DogID, me.OwnerID, 
me.HandlerID, me.BreedID, me.HeightatWithers, me.RegisteredName, me.CallName, 
me.Breeder, me.Sex, me.DateofBirth, me.Sire, me.Dam, me.RecordAddDateTime, me.DEOID, 
EventDateID.EventDate FROM tblDog me LEFT JOIN trelDogEntry DogEntry ON DogEntry.DogID 
= me.DogID LEFT JOIN tblTitleEvent TitleEventDateID ON TitleEventDateID.TitleEventDateID = 
DogEntry.TitleEventDateID LEFT JOIN tblEventDate EventDateID ON EventDateID.EventDateID = 
TitleEventDateID.EventDateID WHERE &#40; EventDateID.EventID = ? &#41;&#34; with ParamValues: 1=&#39;5.6.&#39;] 
at C:\strawberry\perl\vendor\lib/DBI/ProxyServer.pm line 341.

The attached patch to DBIx::Class::SQLMaker adds the appropriate parentheses. I 
unfortunately don&#39;t have a database handy to check this patch to see if it affects other 
database engines.

With the patch installed the query above executes properly.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> SQLMaker.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- SQLMaker.pm.orig	2010-11-06 19:36:43.000000000 -0500
+++ SQLMaker.pm	2010-11-06 19:38:03.000000000 -0500
@@ -324,6 +324,7 @@
 sub _recurse_from {
   my &#40;$self, $from, @join&#41; = @_;
   my @sqlf;
+  push&#40;@sqlf, &#39;&#40;&#39; x scalar&#40;@join&#41;&#41;;
   push&#40;@sqlf, $self-&gt;_make_as&#40;$from&#41;&#41;;
   foreach my $j &#40;@join&#41; {
     my &#40;$to, $on&#41; = @$j;
@@ -347,6 +348,7 @@
       push&#40;@sqlf, $self-&gt;_make_as&#40;$to&#41;&#41;;
     }
     push&#40;@sqlf, &#39; ON &#39;, $self-&gt;_join_condition&#40;$on&#41;&#41;;
+    push&#40;@sqlf, &#39;&#41;&#39;&#41;;
   }
   return join&#40;&#39;&#39;, @sqlf&#41;;
 }
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;07&nbsp;16:46:22&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Including this code as is would be wasted effort, as there is a good
chance this change will get thrown away the next time someone decides to
rewrite the join generation code.

Please supply a test in addition to the actual fix. For prototypes look
at e.g. t/sqlmaker/oracle.t. Note that these tests run without the
presence of the relevant database, which increases the chances of it not
being broken by a drive-by refactor.

Since you are dealing with parenthesis you will also need to activate
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~frew/SQL-Abstract-1.69/lib/SQL/Abstract/Test.pm#$parenthesis_significant">http://search.cpan.org/~frew/SQL-Abstract-1.69/lib/SQL/Abstract/Test.pm#$parenthesis_significant</a></span>,
so that is_same_sql_bind will not optimize away parenthesis.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;07&nbsp;16:46:23&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;07&nbsp;19:26:36&nbsp;2010</span>
    <span class="description">bob [...] rdolson.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62787] Join syntax errors when using MS Access </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 7 Nov 2010 18:26:28 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Robert Olson &lt;bob [...] rdolson.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Are you saying it is wasted effort because I did not submit a test, or  
for some other reason?

On Nov 7, 2010, at 3:46 PM, Peter Rabbitson via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=62787">https://rt.cpan.org/Ticket/Display.html?id=62787</a></span> &gt;
&gt;
&gt; Including this code as is would be wasted effort, as there is a good
&gt; chance this change will get thrown away the next time someone  
&gt; decides to
&gt; rewrite the join generation code.
&gt;
&gt; Please supply a test in addition to the actual fix. For prototypes  
&gt; look
&gt; at e.g. t/sqlmaker/oracle.t. Note that these tests run without the
&gt; presence of the relevant database, which increases the chances of it  
&gt; not
&gt; being broken by a drive-by refactor.
&gt;
&gt; Since you are dealing with parenthesis you will also need to activate
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~frew/SQL-Abstract-1.69/lib/SQL/Abstract/Test.pm#$parenthesis_significant">http://search.cpan.org/~frew/SQL-Abstract-1.69/lib/SQL/Abstract/Test.pm#$parenthesis_significant</a></span> 
&gt; ,
&gt; so that is_same_sql_bind will not optimize away parenthesis.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;07&nbsp;19:41:36&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Nov 07 19:26:36 2010, bob@rdolson.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Are you saying it is wasted effort because I did not submit a test, or
&gt; for some other reason?
</div>
I am saying that me applying this without a test is a waste. It *will*
get broken, as there are at least 2 total rewrites &#40;from different
angles&#41; due on the join-resolution code in the next 6mo or so. There is
no way your change will survive &#40;as it is has no immediately obvious
benefit&#41; unless there is a regression test to catch a behavior change.

Since I am not familiar with the intricacies of the Access SQL dialect,
I am asking you to write a test to go along with your change. Moreover I
pointed out plenty of resources to get you started.

Nevertheless please ask for clarification if the existing tests seem
overwhelming.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;07&nbsp;19:59:47&nbsp;2010</span>
    <span class="description">bob [...] rdolson.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62787] Join syntax errors when using MS Access </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 7 Nov 2010 18:59:37 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Robert Olson &lt;bob [...] rdolson.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m happy to write a test for it. However, after a few minutes of  
poking at the oraclejoin test it&#39;s not clear to me what the correct  
syntax is in the SqlMaker::select&#40;&#41; routine to trigger the nested join  
case; I didn&#39;t see docs in the obvious places for the exact syntax of  
that method.

On Nov 7, 2010, at 6:41 PM, Peter Rabbitson via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=62787">https://rt.cpan.org/Ticket/Display.html?id=62787</a></span> &gt;
&gt;
&gt; On Sun Nov 07 19:26:36 2010, bob@rdolson.org wrote:
<div class="message-stanza open">&gt;&gt; Are you saying it is wasted effort because I did not submit a test,  
&gt;&gt; or
&gt;&gt; for some other reason?
</div>&gt;
&gt; I am saying that me applying this without a test is a waste. It *will*
&gt; get broken, as there are at least 2 total rewrites &#40;from different
&gt; angles&#41; due on the join-resolution code in the next 6mo or so. There  
&gt; is
&gt; no way your change will survive &#40;as it is has no immediately obvious
&gt; benefit&#41; unless there is a regression test to catch a behavior change.
&gt;
&gt; Since I am not familiar with the intricacies of the Access SQL  
&gt; dialect,
&gt; I am asking you to write a test to go along with your change.  
&gt; Moreover I
&gt; pointed out plenty of resources to get you started.
&gt;
&gt; Nevertheless please ask for clarification if the existing tests seem
&gt; overwhelming.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;07&nbsp;20:36:02&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Nov 07 19:59:47 2010, bob@rdolson.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m happy to write a test for it. However, after a few minutes of  
&gt; poking at the oraclejoin test it&#39;s not clear to me what the correct  
&gt; syntax is in the SqlMaker::select&#40;&#41; routine to trigger the nested join  
&gt; case; I didn&#39;t see docs in the obvious places for the exact syntax of  
&gt; that method.
&gt; 
</div>
I guess I pointed you in the wrong direction - you can use DBIC
natively, instead look here:
<span class="clickylink"><a target="new" rel="nofollow" href="http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-Class.git;a=blob;f=t/sqlmaker/sqlite.t;h=86fcc82d9c1aa35530b43ce4dbbda6474119da35;hb=HEAD">http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-Class.git;a=blob;f=t/sqlmaker/sqlite.t;h=86fcc82d9c1aa35530b43ce4dbbda6474119da35;hb=HEAD</a></span>

Sorry for the confusion
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;07&nbsp;20:44:08&nbsp;2010</span>
    <span class="description">bob [...] rdolson.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62787] Join syntax errors when using MS Access </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 7 Nov 2010 19:43:58 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Robert Olson &lt;bob [...] rdolson.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I guess I pointed you in the wrong direction - you can use DBIC
&gt; natively, instead look here:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-Class.git;a=blob;f=t/sqlmaker/sqlite.t;h=86fcc82d9c1aa35530b43ce4dbbda6474119da35;hb=HEAD">http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-Class.git;a=blob;f=t/sqlmaker/sqlite.t;h=86fcc82d9c1aa35530b43ce4dbbda6474119da35;hb=HEAD</a></span>
&gt;
&gt; Sorry for the confusion
</div>
Aha, cool. I&#39;m hip deep in application code at the moment but I will  
look into putting together some tests for this change. DBIC is such a  
marked improvement over writing visual basic code :-&#41; &#40;I write a ton  
of perl code at my day job, but for some side jobs I use commercial  
software based on MS Access and am writing extensions for it&#41;.

--bob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;24&nbsp;21:00:06&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Nov 07 20:44:08 2010, bob@rdolson.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I guess I pointed you in the wrong direction - you can use DBIC
&gt; &gt; natively, instead look here:
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-">http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-</a></span>
</div>&gt;
</div>Class.git;a=blob;f=t/sqlmaker/sqlite.t;h=86fcc82d9c1aa35530b43ce4dbbda6474119da35;hb=HEAD
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;
&gt; &gt; Sorry for the confusion
</div>&gt; 
&gt; Aha, cool. I&#39;m hip deep in application code at the moment but I will
&gt; look into putting together some tests for this change. DBIC is such a
&gt; marked improvement over writing visual basic code :-&#41; &#40;I write a ton
&gt; of perl code at my day job, but for some side jobs I use commercial
&gt; software based on MS Access and am writing extensions for it&#41;.
</div>
Stalling ticket, waiting for a new patch from author.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;24&nbsp;21:00:08&nbsp;2010</span>
    <span class="description">ribasushi [...] leporine.io -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;04&nbsp;22:05:39&nbsp;2011</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

what version of Access are you using? I am using Access 2010.

I have the following join code in the tests I&#39;m currently working on 
which executes just fine:

  my $joined_artist = $schema-&gt;resultset&#40;&#39;Artist&#39;&#41;-&gt;search&#40;{
    artistid =&gt; $first_artistid,
  }, {
    join =&gt; [ &#39;cds&#39; ],
    &#39;+select&#39; =&gt; [ &#39;cds.title&#39; ],
    &#39;+as&#39;     =&gt; [ &#39;cd_title&#39;  ],
  }&#41;-&gt;next;

  is $joined_artist-&gt;get_column&#40;&#39;cd_title&#39;&#41;, &#39;Some Album&#39;, &#39;join works&#39;;

SELECT me.artistid, me.name, me.rank, me.charfield, cds.title FROM 
artist me LEFT JOIN cd cds ON cds.artist = me.artistid WHERE &#40; artistid 
= ? &#41;: &#39;1&#39;
ok 48 - join works

Do you see this problem with only multiple joins or is a single join 
enough to reproduce it?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;04&nbsp;22:05:41&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;04&nbsp;22:09:36&nbsp;2011</span>
    <span class="description">bob [...] rdolson.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62787] Join syntax errors when using MS Access </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 4 Feb 2011 21:09:27 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Robert Olson &lt;bob [...] rdolson.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It was probably in access 2003.

I&#39;ll have to dig up the code and give it a shot in the newer access. &#40;I was just thinking about that project; it got sidelined due to other stuff going on&#41;.

--bob

On Feb 4, 2011, at 9:05 PM, Rafael Kitover via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=62787">https://rt.cpan.org/Ticket/Display.html?id=62787</a></span> &gt;
&gt; 
&gt; Hi,
&gt; 
&gt; what version of Access are you using? I am using Access 2010.
&gt; 
&gt; I have the following join code in the tests I&#39;m currently working on 
&gt; which executes just fine:
&gt; 
&gt;  my $joined_artist = $schema-&gt;resultset&#40;&#39;Artist&#39;&#41;-&gt;search&#40;{
&gt;    artistid =&gt; $first_artistid,
&gt;  }, {
&gt;    join =&gt; [ &#39;cds&#39; ],
&gt;    &#39;+select&#39; =&gt; [ &#39;cds.title&#39; ],
&gt;    &#39;+as&#39;     =&gt; [ &#39;cd_title&#39;  ],
&gt;  }&#41;-&gt;next;
&gt; 
&gt;  is $joined_artist-&gt;get_column&#40;&#39;cd_title&#39;&#41;, &#39;Some Album&#39;, &#39;join works&#39;;
&gt; 
&gt; SELECT me.artistid, me.name, me.rank, me.charfield, cds.title FROM 
&gt; artist me LEFT JOIN cd cds ON cds.artist = me.artistid WHERE &#40; artistid 
&gt; = ? &#41;: &#39;1&#39;
&gt; ok 48 - join works
&gt; 
&gt; Do you see this problem with only multiple joins or is a single join 
&gt; enough to reproduce it?
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;19&nbsp;05:09:50&nbsp;2011</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 04 22:09:36 2011, bob@rdolson.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It was probably in access 2003.
&gt; 
&gt; I&#39;ll have to dig up the code and give it a shot in the newer access.
&gt; &#40;I was just thinking about that project; it got sidelined due to other
&gt; stuff going on&#41;.
&gt; 
&gt; --bob
</div>
In the process of testing my Schema::Loader driver, I found out that 
you do need the parenthesis for a two-step join, so reproduced on 
Access 2010.

I&#39;m adding some code similar to your patch.

What is your name, email address and IRC handle you want to use for the 
CONTRIBUTORS section?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;19&nbsp;08:03:54&nbsp;2011</span>
    <span class="description">bob [...] rdolson.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62787] Join syntax errors when using MS Access </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 19 Feb 2011 07:03:41 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Robert Olson &lt;bob [...] rdolson.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Feb 19, 2011, at 4:09 AM, Rafael Kitover via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=62787">https://rt.cpan.org/Ticket/Display.html?id=62787</a></span> &gt;
&gt; 
&gt; On Fri Feb 04 22:09:36 2011, bob@rdolson.org wrote:
<div class="message-stanza open">&gt;&gt; It was probably in access 2003.
&gt;&gt; 
&gt;&gt; I&#39;ll have to dig up the code and give it a shot in the newer access.
&gt;&gt; &#40;I was just thinking about that project; it got sidelined due to other
&gt;&gt; stuff going on&#41;.
&gt;&gt; 
&gt;&gt; --bob
</div>&gt; 
&gt; In the process of testing my Schema::Loader driver, I found out that 
&gt; you do need the parenthesis for a two-step join, so reproduced on 
&gt; Access 2010.
&gt; 
&gt; I&#39;m adding some code similar to your patch.
&gt; 
&gt; What is your name, email address and IRC handle you want to use for the 
&gt; CONTRIBUTORS section?
</div>
I&#39;m sorry I hadn&#39;t gotten a chance to get back and check this - that is great that you are incorporating a fix. Thank you.

Robert Olson
bob@rdolson.org
No IRC handle.

--bob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;01&nbsp;10:08:46&nbsp;2011</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please test the hopefully complete MSAccess support that just merged to
mainline:

<span class="clickylink"><a target="new" rel="nofollow" href="http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-Class.git;a=commit;h=726c8f65ef37b47aad62e29a306f64528a00f65d">http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=dbsrgits/DBIx-Class.git;a=commit;h=726c8f65ef37b47aad62e29a306f64528a00f65d</a></span>

Marking ticket as patched, but feel free to reopen it if more problems
are identified.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;01&nbsp;10:08:47&nbsp;2011</span>
    <span class="description">ribasushi [...] leporine.io -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;07&nbsp;08:31:54&nbsp;2011</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please try the newly-release DBIC 0.08191. It contains a massive amount
of MSAccess support code, your particular issue should be among the
resolved problems.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;07&nbsp;08:31:55&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;07&nbsp;08:31:55&nbsp;2011</span>
    <span class="description">ribasushi [...] leporine.io -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;May&nbsp;07&nbsp;08:34:29&nbsp;2011</span>
    <span class="description">ribasushi [...] leporine.io -  Fixed in 0.08191 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
