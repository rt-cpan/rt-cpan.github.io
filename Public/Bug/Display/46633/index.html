<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #46633 for ExtUtils-MakeMaker: 6.52 causes link errors in Time::HiRes on VMS</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #46633 for ExtUtils-MakeMaker: 6.52 causes link errors in Time::HiRes on VMS</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=ExtUtils-MakeMaker">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=ExtUtils-MakeMaker">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=ExtUtils-MakeMaker">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=ExtUtils-MakeMaker">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/ExtUtils-MakeMaker">ExtUtils-MakeMaker CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">46633</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=ExtUtils-MakeMaker">ExtUtils-MakeMaker</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cberry [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-12494-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
6.52    </td>
  </tr>
  <tr id="CF-12495-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




self_libs_fix.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/614362/311902/self_libs_fix.txt">
Thu Jun 04 13:45:59 2009 (764b) by craigberry [...] mac.com
</a>
</font></li>
</ul>


undef_LIBS.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/614198/311810/undef_LIBS.txt">
Wed Jun 03 20:53:13 2009 (568b) by craigberry [...] mac.com
</a>
</font></li>
</ul>


vms_650_652_diff.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/613817/311594/vms_650_652_diff.txt">
Tue Jun 02 20:30:17 2009 (12.8k) by cberry [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=46633">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-613817" href="/Public/Bug/Display.html?id=46633#txn-613817">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;20:30:17&nbsp;2009</span>
    <span class="description">cberry [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 6.52 causes link errors in Time::HiRes on VMS</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/613817/311591/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/311591">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 868b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">After 6.52 came into blead, the blead build broke on VMS with a pile of
linker errors when it got to the Time::HiRes extension.  I&#39;ve attached a
diff of the generated dsscrip.mms for Time::HiRes comparing 6.50 to
6.52.  The most obvious problem is right here:

@@ -293,9 +296,6 @@ PERLTYPE =

 # Time::HiRes might depend on some other libraries:

 # See ExtUtils::Liblist for details

 #

-EXTRALIBS =

-LDLOADLIBS = [--]DBGPerlShr.exe/Share

-BSLOADLIBS =

where a very important library has gone missing.  The odd thing is none
of the other extensions in core have this problem.  They all still have
the line that looks like:

LDLOADLIBS = [--]DBGPerlShr.exe/Share

The only likely suspect I can see that makes Time::HiRes different is
that it passes LIBS to WriteMakefile&#40;&#41;.

I will have a look at Liblist and see what&#39;s changed -- for now this is
just a report.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> vms_650_652_diff.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/613817/311594/vms_650_652_diff.txt">Download vms_650_652_diff.txt</a><br />
<span class="downloadcontenttype">text/plain 12.8k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-613826" href="/Public/Bug/Display.html?id=46633#txn-613826">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;21:34:39&nbsp;2009</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46633] 6.52 causes link errors in Time::HiRes on VMS</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 02 Jun 2009 18:34:16 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/613826/311600/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/311600">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 587b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Craig A. Berry via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The only likely suspect I can see that makes Time::HiRes different is
&gt; that it passes LIBS to WriteMakefile&#40;&#41;.
&gt; 
&gt; I will have a look at Liblist and see what&#39;s changed -- for now this is
&gt; just a report.
</div>
This change is the prime suspect.
<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/schwern/extutils-makemaker/commit/6963c4e0a03f3f6399f2964e7ca4f3e187255c3b">http://github.com/schwern/extutils-makemaker/commit/6963c4e0a03f3f6399f2964e7ca4f3e187255c3b</a></span>

Liblist hasn&#39;t changed since September.


-- 
52. Not allowed to yell &#34;Take that Cobra&#34; at the rifle range.
    -- The 213 Things Skippy Is No Longer Allowed To Do In The U.S. Army
           <span class="clickylink"><a target="new" rel="nofollow" href="http://skippyslist.com/list/">http://skippyslist.com/list/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-613827" href="/Public/Bug/Display.html?id=46633#txn-613827">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;21:34:40&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-613859" href="/Public/Bug/Display.html?id=46633#txn-613859">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;23:32:14&nbsp;2009</span>
    <span class="description">craigberry [...] mac.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46633] 6.52 causes link errors in Time::HiRes on VMS</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 02 Jun 2009 22:31:55 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Craig A. Berry&#34; &lt;craigberry [...] mac.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/613859/311617/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/311617">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 2, 2009, at 8:34 PM, Michael G Schwern via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46633">https://rt.cpan.org/Ticket/Display.html?id=46633</a></span> &gt;
&gt;
&gt; Craig A. Berry via RT wrote:
<div class="message-stanza open">&gt;&gt; The only likely suspect I can see that makes Time::HiRes different is
&gt;&gt; that it passes LIBS to WriteMakefile&#40;&#41;.
&gt;&gt;
&gt;&gt; I will have a look at Liblist and see what&#39;s changed -- for now  
&gt;&gt; this is
&gt;&gt; just a report.
</div>&gt;
&gt; This change is the prime suspect.
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/schwern/extutils-makemaker/commit/6963c4e0a03f3f6399f2964e7ca4f3e187255c3b">http://github.com/schwern/extutils-makemaker/commit/6963c4e0a03f3f6399f2964e7ca4f3e187255c3b</a></span>
</div>

Maybe, though from reading code &#40;not yet watching in the debugger&#41;, I  
think a more likely suspect is:

&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://perl5.git.perl.org/perl.git/blobdiff/20f91e418dfa8bdf6cf78614bfebebc28a7613ee..5bdf71cc9217764029fb9a321295118de3bb8e72:/lib/ExtUtils/MM_Any.pm">http://perl5.git.perl.org/perl.git/blobdiff/20f91e418dfa8bdf6cf78614bfebebc28a7613ee..5bdf71cc9217764029fb9a321295118de3bb8e72:/lib/ExtUtils/MM_Any.pm</a></span> 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt;
</div>
For some reason I can&#39;t find a proper pointer to that change at  
github.com.

In this section here in MM_Any.pm:

+    foreach my $libs &#40; @{$self-&gt;{LIBS}} &#41;{
+        $libs =~ s/^\s*&#40;.*\S&#41;\s*$/$1/; # remove leading and trailing  
whitespace
+        my&#40;@libs&#41; = $self-&gt;extliblist&#40;$libs&#41;;
+        if &#40;$libs[0] or $libs[1] or $libs[2]&#41;{
+            # LD_RUN_PATH now computed by ExtUtils::Liblist
+            &#40;$self-&gt;{EXTRALIBS},  $self-&gt;{BSLOADLIBS},
+             $self-&gt;{LDLOADLIBS}, $self-&gt;{LD_RUN_PATH}&#41; = @libs;
+            last;
+        }
+    }

it sure looks to me like $self-&gt;{LDLOADLIBS} will be overwritten with  
the third element of @libs regardless of whether that element exists  
as long as any of the first three elements exists and is true.   
Similar could be said of EXTRALIBS, BSLOADLIBS, or LD_RUN_PATH.   
Unless extliblist is guaranteed to return exactly the right number of  
values in the right places.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________________
Craig A. Berry
mailto:craigberry@mac.com

&#34;... getting out of a sonnet is much more
  difficult than getting in.&#34;
                  Brad Leithauser
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-613862" href="/Public/Bug/Display.html?id=46633#txn-613862">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;23:59:58&nbsp;2009</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46633] 6.52 causes link errors in Time::HiRes on VMS</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 02 Jun 2009 20:59:30 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/613862/311620/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/311620">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">craigberry@mac.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; For some reason I can&#39;t find a proper pointer to that change at  
&gt; github.com.
&gt; 
&gt; In this section here in MM_Any.pm:
&gt; 
&gt; +    foreach my $libs &#40; @{$self-&gt;{LIBS}} &#41;{
&gt; +        $libs =~ s/^\s*&#40;.*\S&#41;\s*$/$1/; # remove leading and trailing  
&gt; whitespace
&gt; +        my&#40;@libs&#41; = $self-&gt;extliblist&#40;$libs&#41;;
&gt; +        if &#40;$libs[0] or $libs[1] or $libs[2]&#41;{
&gt; +            # LD_RUN_PATH now computed by ExtUtils::Liblist
&gt; +            &#40;$self-&gt;{EXTRALIBS},  $self-&gt;{BSLOADLIBS},
&gt; +             $self-&gt;{LDLOADLIBS}, $self-&gt;{LD_RUN_PATH}&#41; = @libs;
&gt; +            last;
&gt; +        }
&gt; +    }
&gt; 
&gt; it sure looks to me like $self-&gt;{LDLOADLIBS} will be overwritten with  
&gt; the third element of @libs regardless of whether that element exists  
&gt; as long as any of the first three elements exists and is true.   
&gt; Similar could be said of EXTRALIBS, BSLOADLIBS, or LD_RUN_PATH.   
&gt; Unless extliblist is guaranteed to return exactly the right number of  
&gt; values in the right places.
</div>
That was last touched by ecb0efd8 and it should have just been a code move out
of MM_Unix-&gt;init_others&#40;&#41; and into MM_Any-&gt;init_others.  Its possible that
subtly changed the order of initialization.


-- 
The mind is a terrible thing,
and it must be stopped.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-614010" href="/Public/Bug/Display.html?id=46633#txn-614010">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;09:21:20&nbsp;2009</span>
    <span class="description">craigberry [...] mac.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46633] 6.52 causes link errors in Time::HiRes on VMS</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 03 Jun 2009 08:20:23 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Craig A. Berry&#34; &lt;craigberry [...] mac.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/614010/311712/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/311712">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 2, 2009, at 10:59 PM, Michael G Schwern via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; craigberry@mac.com via RT wrote:
<div class="message-stanza open">&gt;&gt;
&gt;&gt; In this section here in MM_Any.pm:
&gt;&gt;
&gt;&gt; +    foreach my $libs &#40; @{$self-&gt;{LIBS}} &#41;{
&gt;&gt; +        $libs =~ s/^\s*&#40;.*\S&#41;\s*$/$1/; # remove leading and trailing
&gt;&gt; whitespace
&gt;&gt; +        my&#40;@libs&#41; = $self-&gt;extliblist&#40;$libs&#41;;
&gt;&gt; +        if &#40;$libs[0] or $libs[1] or $libs[2]&#41;{
&gt;&gt; +            # LD_RUN_PATH now computed by ExtUtils::Liblist
&gt;&gt; +            &#40;$self-&gt;{EXTRALIBS},  $self-&gt;{BSLOADLIBS},
&gt;&gt; +             $self-&gt;{LDLOADLIBS}, $self-&gt;{LD_RUN_PATH}&#41; = @libs;
&gt;&gt; +            last;
&gt;&gt; +        }
&gt;&gt; +    }
&gt;&gt;
&gt;&gt;
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; That was last touched by ecb0efd8 and it should have just been a  
&gt; code move out
&gt; of MM_Unix-&gt;init_others&#40;&#41; and into MM_Any-&gt;init_others.  Its  
&gt; possible that
&gt; subtly changed the order of initialization.
</div>

Here&#39;s what the debugger says right before that code executes:

ExtUtils::MM_Any::init_others&#40;../../lib/ExtUtils/MM_Any.pm:1785&#41;:
1785:       foreach my $libs &#40; @{$self-&gt;{LIBS}} &#41;{
   DB&lt;9&gt; x $self-&gt;{LIBS}
0  ARRAY&#40;0x7b2f60&#41;
      empty array


which I guess shouldn&#39;t be a surprise since an empty array is exactly  
what the Makefile.PL passes in for LIB, except apparently there&#39;s an  
expectation that standard libraries still get appended or prepended or  
something.  But here we never execute the loop because the array is  
empty.

FWIW, extliblist does seem to return the right things even when passed  
an empty array:

   DB&lt;13&gt; x $self-&gt;extliblist&#40;&#41;
0  &#39;&#39;
1  &#39;&#39;
2  &#39;[--]DBGPerlShr.exe/Share&#39;
3  &#39;&#39;

Gotta go, but will look further tonight.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________________
Craig A. Berry
mailto:craigberry@mac.com

&#34;... getting out of a sonnet is much more
  difficult than getting in.&#34;
                  Brad Leithauser
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-614198" href="/Public/Bug/Display.html?id=46633#txn-614198">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;20:53:13&nbsp;2009</span>
    <span class="description">craigberry [...] mac.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46633] 6.52 causes link errors in Time::HiRes on VMS</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 03 Jun 2009 19:52:51 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Craig A. Berry&#34; &lt;craigberry [...] mac.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/614198/311809/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/311809">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 3, 2009, at 8:21 AM, craigberry@mac.com via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46633">https://rt.cpan.org/Ticket/Display.html?id=46633</a></span> &gt;
&gt;
&gt;
&gt; On Jun 2, 2009, at 10:59 PM, Michael G Schwern via RT wrote:
&gt;
<div class="message-stanza open">&gt;&gt;
&gt;&gt; craigberry@mac.com via RT wrote:
<div class="message-stanza open">&gt;&gt;&gt;
&gt;&gt;&gt; In this section here in MM_Any.pm:
&gt;&gt;&gt;
&gt;&gt;&gt; +    foreach my $libs &#40; @{$self-&gt;{LIBS}} &#41;{
&gt;&gt;&gt; +        $libs =~ s/^\s*&#40;.*\S&#41;\s*$/$1/; # remove leading and  
&gt;&gt;&gt; trailing
&gt;&gt;&gt; whitespace
&gt;&gt;&gt; +        my&#40;@libs&#41; = $self-&gt;extliblist&#40;$libs&#41;;
&gt;&gt;&gt; +        if &#40;$libs[0] or $libs[1] or $libs[2]&#41;{
&gt;&gt;&gt; +            # LD_RUN_PATH now computed by ExtUtils::Liblist
&gt;&gt;&gt; +            &#40;$self-&gt;{EXTRALIBS},  $self-&gt;{BSLOADLIBS},
&gt;&gt;&gt; +             $self-&gt;{LDLOADLIBS}, $self-&gt;{LD_RUN_PATH}&#41; = @libs;
&gt;&gt;&gt; +            last;
&gt;&gt;&gt; +        }
&gt;&gt;&gt; +    }
&gt;&gt;&gt;
&gt;&gt;&gt;
</div></div>&gt;
<div class="message-stanza open">&gt;&gt; That was last touched by ecb0efd8 and it should have just been a
&gt;&gt; code move out
&gt;&gt; of MM_Unix-&gt;init_others&#40;&#41; and into MM_Any-&gt;init_others.  Its
&gt;&gt; possible that
&gt;&gt; subtly changed the order of initialization.
</div>&gt;
&gt;
&gt; Here&#39;s what the debugger says right before that code executes:
&gt;
&gt; ExtUtils::MM_Any::init_others&#40;../../lib/ExtUtils/MM_Any.pm:1785&#41;:
&gt; 1785:       foreach my $libs &#40; @{$self-&gt;{LIBS}} &#41;{
&gt;   DB&lt;9&gt; x $self-&gt;{LIBS}
&gt; 0  ARRAY&#40;0x7b2f60&#41;
&gt;      empty array
&gt;
&gt;
&gt; which I guess shouldn&#39;t be a surprise since an empty array is exactly
&gt; what the Makefile.PL passes in for LIB, except apparently there&#39;s an
&gt; expectation that standard libraries still get appended or prepended or
&gt; something.  But here we never execute the loop because the array is
&gt; empty.
</div>

The code wasn&#39;t just moved, it was refactored.  The old code checked  
not only for the whole array being undef but also for element zero  
being undef and forced it to an array with one zero-length element in  
both cases.  With the attached patch the new code now does that as  
well.  With this, Time::HiRes now builds fine in blead on VMS.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________________
Craig A. Berry
mailto:craigberry@mac.com

&#34;... getting out of a sonnet is much more
  difficult than getting in.&#34;
                  Brad Leithauser
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/614198/311810/undef_LIBS.txt">Download undef_LIBS.txt</a><br />
<span class="downloadcontenttype">text/plain 568b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-614362" href="/Public/Bug/Display.html?id=46633#txn-614362">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;04&nbsp;13:45:58&nbsp;2009</span>
    <span class="description">craigberry [...] mac.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> cberry [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46633] 6.52 causes link errors in Time::HiRes on VMS</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 04 Jun 2009 12:45:15 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Craig A. Berry&#34; &lt;craigberry [...] mac.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/614362/311901/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/311901">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 918b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 3, 2009, at 7:53 PM, craigberry@mac.com via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The code wasn&#39;t just moved, it was refactored.  The old code checked
&gt; not only for the whole array being undef but also for element zero
&gt; being undef and forced it to an array with one zero-length element in
&gt; both cases.  With the attached patch the new code now does that as
&gt; well.  With this, Time::HiRes now builds fine in blead on VMS.
</div>

Well, that patch generated a warning in one of the tests, so instead  
of revising the new code, the patch attached here just replaces it  
with the old code, which is easier to read anyway.  With this in  
blead, the build goes fine on both Mac OS X and VMS, and there are no  
new test failures as a result of it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________________
Craig A. Berry
mailto:craigberry@mac.com

&#34;... getting out of a sonnet is much more
  difficult than getting in.&#34;
                  Brad Leithauser
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/614362/311902/self_libs_fix.txt">Download self_libs_fix.txt</a><br />
<span class="downloadcontenttype">text/plain 764b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-615225" href="/Public/Bug/Display.html?id=46633#txn-615225">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;07&nbsp;21:37:40&nbsp;2009</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/615225/312440/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/312440">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 394b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for digging this out!  I&#39;ve fixed it in
d7a7ee105de60f87f8fd3c03cd95fb99383129f6

Instead of reverting I&#39;ve kept the table format.  I find it much easier
to see what&#39;s going on and all the logic is gathered together.  &#34;unless
@{$self-&gt;{LIBS}} &#38;&#38; defined $self-&gt;{LIBS}[0];&#34; is a bit mind mending.

I also pulled it out into its own method and wrote a test for it so it
won&#39;t happen again!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-615228" href="/Public/Bug/Display.html?id=46633#txn-615228">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;07&nbsp;21:37:42&nbsp;2009</span>
    <span class="description">mschwern [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.602533</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
