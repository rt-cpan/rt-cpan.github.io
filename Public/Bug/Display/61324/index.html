<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #61324 for Crypt-SSLeay: Broken  for *static* &#40;also&#41; openssl builds on Win32</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #61324 for Crypt-SSLeay: Broken  for *static* &#40;also&#41; openssl builds on Win32</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Crypt-SSLeay/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Crypt-SSLeay/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Crypt-SSLeay/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Crypt-SSLeay/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Crypt-SSLeay">Crypt-SSLeay CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">61324</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Crypt-SSLeay/Active/">Crypt-SSLeay</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">nanis [...] runu.moc.invalid
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
sisyphus [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8676-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.58    </td>
  </tr>
  <tr id="CF-8677-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;14&nbsp;05:42:21&nbsp;2010</span>
    <span class="description">sisyphus [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Broken  for *static* &#40;also&#41; openssl builds on Win32</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Sinan,

The report at <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=61249">https://rt.cpan.org/Ticket/Display.html?id=61249</a></span> is 
definitely pertinent. I considered adding my comments to it, rather 
than opening a fresh bug report - but I&#39;m building Crypt::SSLeay 0.58 
on Win32 &#40;x64&#41; against a *static* &#40;MinGW64-built&#41; openssl library, and 
that other report was concerned only with *dynamic* openssl.

I couldn&#39;t get anywhere with the Makefile.PL that ships with the 
Crypt::SSLeay 0.58 source. Here&#39;s the Makefile.PL that I ended up using:

###################################
use ExtUtils::MakeMaker;

WriteMakefile&#40;
    NAME          =&gt; &#39;Crypt::SSLeay&#39;,
    AUTHOR        =&gt; &#39;A. Sinan Unur &lt;nanis@cpan.org&gt;&#39;,
    ABSTRACT_FROM =&gt; &#39;SSLeay.pm&#39;,
    VERSION_FROM  =&gt; &#39;SSLeay.pm&#39;,
    LIBS          =&gt; &#39;-LC:/_64/msys/1.0/local/lib -lz -
LC:/_64/msys/1.0/local/ssl/lib -lssl -lcrypto&#39;,
    INC           =&gt; &#34;-IC:/_64/msys/1.0/local/ssl/include&#34;,
    clean         =&gt; {
        FILES =&gt; &#39;crypt_ssleay_version.h test.config&#39;,
    },
&#41;;
###################################

I doubt that the &#39;clean&#39; entry makes sense - it&#39;s just something that 
was left there after I copied stuff from the original Makefile.PL.

Both of those paths in the LIBS entry are in my $Config{libpth} and the 
path that&#39;s specified in INC is in my $ENV{CPATH}.

In addition to that, in SSLeay.xs, I replaced:

#include &#34;crypt_ssleay_version.h&#34;

with:

#################################
#include &lt;openssl/pkcs12.h&gt;
#include &lt;openssl/ssl.h&gt;
#include &lt;openssl/crypto.h&gt;

#define CRYPT_SSLEAY_free OPENSSL_free
#################################

&#40;Is there really a need for the Makefile.PL to determine what 
CRYPT_SSLEAY_free needs to be set to ? Couldn&#39;t the xs file examine the 
OpenSSL version and handle that all by itself ?&#41;

It then built, tested and installed fine.

What annoyed me the most is that I had to rewrite &#40;and wade through&#41; so 
much. Given that MinGW will by default find headers that are in $ENV
{CPATH} and that the relevant libraries were to be found in $Config
{libpth}, I believe I should not have been subjected to so much 
frustration.

Anyway, I got there in the end - and I&#39;m happy to happy to help out 
further if I can. &#40;Just let me know.&#41;

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;14&nbsp;08:32:23&nbsp;2010</span>
    <span class="description">nanis [...] runu.moc.invalid -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Rob:

The current Makefile.PL is a re-write of the previous one. It helped me
understand what was going on to try to factor out bits and pieces. 

The next version will be simpler. My aim with 0.58 was to mainly
understand and disentangle. My goal for 0.59 version is to streamline
Makefile.PL and for 0.60 is to incorporate threading support.

I do not have access to a 64-bit Windows machine, so reports like yours
are especially valuable.

Could you also tell me which version of OpenSSL you are using?

I will give you a heads up when I have something ready to be tested.
That should be in about two weeks&#39; time.

Thank you again for your help &#38; input.

-- Sinan

On Tue Sep 14 05:42:21 2010, SISYPHUS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Sinan,
&gt; 
&gt; The report at <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=61249">https://rt.cpan.org/Ticket/Display.html?id=61249</a></span> is 
&gt; definitely pertinent. I considered adding my comments to it, rather 
&gt; than opening a fresh bug report - but I&#39;m building Crypt::SSLeay 0.58 
&gt; on Win32 &#40;x64&#41; against a *static* &#40;MinGW64-built&#41; openssl library, and 
&gt; that other report was concerned only with *dynamic* openssl.
&gt; 
&gt; I couldn&#39;t get anywhere with the Makefile.PL that ships with the 
&gt; Crypt::SSLeay 0.58 source. Here&#39;s the Makefile.PL that I ended up using:
&gt; 
&gt; ###################################
&gt; use ExtUtils::MakeMaker;
&gt; 
&gt; WriteMakefile&#40;
&gt;     NAME          =&gt; &#39;Crypt::SSLeay&#39;,
&gt;     AUTHOR        =&gt; &#39;A. Sinan Unur &lt;nanis@cpan.org&gt;&#39;,
&gt;     ABSTRACT_FROM =&gt; &#39;SSLeay.pm&#39;,
&gt;     VERSION_FROM  =&gt; &#39;SSLeay.pm&#39;,
&gt;     LIBS          =&gt; &#39;-LC:/_64/msys/1.0/local/lib -lz -
&gt; LC:/_64/msys/1.0/local/ssl/lib -lssl -lcrypto&#39;,
&gt;     INC           =&gt; &#34;-IC:/_64/msys/1.0/local/ssl/include&#34;,
&gt;     clean         =&gt; {
&gt;         FILES =&gt; &#39;crypt_ssleay_version.h test.config&#39;,
&gt;     },
&gt; &#41;;
&gt; ###################################
&gt; 
&gt; I doubt that the &#39;clean&#39; entry makes sense - it&#39;s just something that 
&gt; was left there after I copied stuff from the original Makefile.PL.
&gt; 
&gt; Both of those paths in the LIBS entry are in my $Config{libpth} and the 
&gt; path that&#39;s specified in INC is in my $ENV{CPATH}.
&gt; 
&gt; In addition to that, in SSLeay.xs, I replaced:
&gt; 
&gt; #include &#34;crypt_ssleay_version.h&#34;
&gt; 
&gt; with:
&gt; 
&gt; #################################
&gt; #include &lt;openssl/pkcs12.h&gt;
&gt; #include &lt;openssl/ssl.h&gt;
&gt; #include &lt;openssl/crypto.h&gt;
&gt; 
&gt; #define CRYPT_SSLEAY_free OPENSSL_free
&gt; #################################
&gt; 
&gt; &#40;Is there really a need for the Makefile.PL to determine what 
&gt; CRYPT_SSLEAY_free needs to be set to ? Couldn&#39;t the xs file examine the 
&gt; OpenSSL version and handle that all by itself ?&#41;
&gt; 
&gt; It then built, tested and installed fine.
&gt; 
&gt; What annoyed me the most is that I had to rewrite &#40;and wade through&#41; so 
&gt; much. Given that MinGW will by default find headers that are in $ENV
&gt; {CPATH} and that the relevant libraries were to be found in $Config
&gt; {libpth}, I believe I should not have been subjected to so much 
&gt; frustration.
&gt; 
&gt; Anyway, I got there in the end - and I&#39;m happy to happy to help out 
&gt; further if I can. &#40;Just let me know.&#41;
&gt; 
&gt; Cheers,
&gt; Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;14&nbsp;08:32:24&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;14&nbsp;08:32:37&nbsp;2010</span>
    <span class="description">nanis [...] runu.moc.invalid -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;14&nbsp;20:36:31&nbsp;2010</span>
    <span class="description">sisyphus [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Sep 14 08:32:23 2010, NANIS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Rob:
&gt; 
&gt; The current Makefile.PL is a re-write of the previous one. It helped 
</div>me
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; understand what was going on to try to factor out bits and pieces. 
</div>
Yes, wading through Makfile.PL&#39;s these days is often not a simple task, 
these days :-&#41; 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The next version will be simpler.
</div>
The Makefile.PL that I used &#40;above&#41; can, of course, be simplified to:

###################
use ExtUtils::MakeMaker;

WriteMakefile&#40;
    NAME          =&gt; &#39;Crypt::SSLeay&#39;,
    AUTHOR        =&gt; &#39;A. Sinan Unur &lt;nanis@cpan.org&gt;&#39;,
    ABSTRACT_FROM =&gt; &#39;SSLeay.pm&#39;,
    VERSION_FROM  =&gt; &#39;SSLeay.pm&#39;,
    LIBS =&gt; &#39;-lz -lssl -lcrypto&#39;,
&#41;;

#########################

I think that would also work if I built against a dynamic openssl 
library. The &#39;-lz&#39; would not be needed, but shouldn&#39;t cause a problem - 
and if MakeMaker couldn&#39;t find -lz, it would just remove it without 
making any fuss.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I do not have access to a 64-bit Windows machine, so reports like 
</div>yours
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; are especially valuable.
</div>
It&#39;s the same for 32-bit Windows. The above Makefile.PL, along with the 
changes to the SSLeay.xs &#40;mentioned earlier&#41; works fine for both my x86 
and x64 builds of perl 5.12.2.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Could you also tell me which version of OpenSSL you are using?
</div>
Currently using 0.9.8n, built &#40;by me&#41; from source in the MSYS shell 
using mingw32 for the 32-bit build and MinGW64 for the 64-bit build.

I&#39;m using the x86 and x64 builds of ActivePerl build 1202 &#40;5.12.2&#41;, 
with the mingw32 &#40;gcc-3.4.5&#41; and MinGW64 &#40;gcc-4.6.0&#41; compilers 
respectively.

With Strawberry Perl, there appears to be 3 openssl import libraries - 
named libeay32.a, libssl32.a and libssl32eay.a, though the last 2 are 
identical to each other. My Strawberry uses version 0.9.8l of the 
openssl library, and I don&#39;t have to make any additional alterations 
&#40;other than the ones mentioned previously&#41; to SSLeay.xs in order for it 
to build Crypt-SSLeay-0.58.

For a Makefile.PL that works with both Strawberry-5.12.1 &#40;x86 and x64&#41; 
and my ActivePerl-5.12.2 &#40;x86 and x64&#41; the following works fine:

#######################################
use ExtUtils::MakeMaker;

WriteMakefile&#40;
    NAME          =&gt; &#39;Crypt::SSLeay&#39;,
    AUTHOR        =&gt; &#39;A. Sinan Unur &lt;nanis@cpan.org&gt;&#39;,
    ABSTRACT_FROM =&gt; &#39;SSLeay.pm&#39;,
    VERSION_FROM  =&gt; &#39;SSLeay.pm&#39;,
    LIBS =&gt; &#39;-lz -lssl -lcrypto -lssl32 -lssleay32 -leay32&#39;,
&#41;;

####################################### 

That of course relies on the libraries and headers being in locations 
that are found by default - otherwise, I could still use the same 
Makefile.PL, but would have to provide INC and LIBS command line 
arguments &#40;or somesuch&#41; so that the library could be found.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I will give you a heads up when I have something ready to be tested.
&gt; That should be in about two weeks&#39; time.
</div>
That would be fine.

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;06&nbsp;07:48:22&nbsp;2012</span>
    <span class="description">nanis [...] runu.moc.invalid -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Rob:

In the spirit of your recommendation, I threw out all the guessing that
was going on. If the OpenSSL headers and libraries are not in places
where they would be found by default by your build tools, please set the
appropriate environment variables before running `perl Makefile.PL`.

For example, if you are using ActiveState Perl and MinGW installed using
ppm, and you installed OpenSSL in `C:\opt\openssl-1.0.1c`, then you
would issue the following commands to build `Crypt::SSLeay`:

    C:\temp\Crypt-SSLeay&gt; set
LIBRARY_PATH=C:\opt\openssl-1.0.1c\lib;%LIBRARY_PATH%
    C:\temp\Crypt-SSLeay&gt; set CPATH=C:\opt\openssl-1.0.1c\include;%CPATH%
    C:\temp\Crypt-SSLeay&gt; perl Makefile.PL --live-tests
    C:\temp\Crypt-SSLeay&gt; dmake test

If you are using a Microsoft compiler &#40;keep in mind that `perl` and
OpenSSL need to have been built using the same compiler as well&#41;, you
would use:

    C:\temp\Crypt-SSLeay&gt; set LIB=C:\opt\openssl-1.0.1c\lib;%LIB%
    C:\temp\Crypt-SSLeay&gt; set
INCLUDE=C:\opt\openssl-1.0.1c\include;%INCLUDE%
    C:\temp\Crypt-SSLeay&gt; perl Makefile.PL --live-tests
    C:\temp\Crypt-SSLeay&gt; nmake test

I would appreciate it if you could try out 0.64. Thank you for your
feedback.

-- Sinan

On Tue Sep 14 20:36:31 2010, SISYPHUS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Sep 14 08:32:23 2010, NANIS wrote:
<div class="message-stanza open">&gt; &gt; Hi Rob:
&gt; &gt; 
&gt; &gt; The current Makefile.PL is a re-write of the previous one. It helped 
</div>&gt; me
<div class="message-stanza open">&gt; &gt; understand what was going on to try to factor out bits and pieces. 
</div>&gt; 
&gt; Yes, wading through Makfile.PL&#39;s these days is often not a simple task, 
&gt; these days :-&#41; 
&gt; 
<div class="message-stanza open">&gt; &gt; The next version will be simpler.
</div>&gt; 
&gt; The Makefile.PL that I used &#40;above&#41; can, of course, be simplified to:
&gt; 
&gt; ###################
&gt; use ExtUtils::MakeMaker;
&gt; 
&gt; WriteMakefile&#40;
&gt;     NAME          =&gt; &#39;Crypt::SSLeay&#39;,
&gt;     AUTHOR        =&gt; &#39;A. Sinan Unur &lt;nanis@cpan.org&gt;&#39;,
&gt;     ABSTRACT_FROM =&gt; &#39;SSLeay.pm&#39;,
&gt;     VERSION_FROM  =&gt; &#39;SSLeay.pm&#39;,
&gt;     LIBS =&gt; &#39;-lz -lssl -lcrypto&#39;,
&gt; &#41;;
&gt; 
&gt; #########################
&gt; 
&gt; I think that would also work if I built against a dynamic openssl 
&gt; library. The &#39;-lz&#39; would not be needed, but shouldn&#39;t cause a problem - 
&gt; and if MakeMaker couldn&#39;t find -lz, it would just remove it without 
&gt; making any fuss.
&gt; 
<div class="message-stanza open">&gt; &gt; I do not have access to a 64-bit Windows machine, so reports like 
</div>&gt; yours
<div class="message-stanza open">&gt; &gt; are especially valuable.
</div>&gt; 
&gt; It&#39;s the same for 32-bit Windows. The above Makefile.PL, along with the 
&gt; changes to the SSLeay.xs &#40;mentioned earlier&#41; works fine for both my x86 
&gt; and x64 builds of perl 5.12.2.
&gt; 
<div class="message-stanza open">&gt; &gt; Could you also tell me which version of OpenSSL you are using?
</div>&gt; 
&gt; Currently using 0.9.8n, built &#40;by me&#41; from source in the MSYS shell 
&gt; using mingw32 for the 32-bit build and MinGW64 for the 64-bit build.
&gt; 
&gt; I&#39;m using the x86 and x64 builds of ActivePerl build 1202 &#40;5.12.2&#41;, 
&gt; with the mingw32 &#40;gcc-3.4.5&#41; and MinGW64 &#40;gcc-4.6.0&#41; compilers 
&gt; respectively.
&gt; 
&gt; With Strawberry Perl, there appears to be 3 openssl import libraries - 
&gt; named libeay32.a, libssl32.a and libssl32eay.a, though the last 2 are 
&gt; identical to each other. My Strawberry uses version 0.9.8l of the 
&gt; openssl library, and I don&#39;t have to make any additional alterations 
&gt; &#40;other than the ones mentioned previously&#41; to SSLeay.xs in order for it 
&gt; to build Crypt-SSLeay-0.58.
&gt; 
&gt; For a Makefile.PL that works with both Strawberry-5.12.1 &#40;x86 and x64&#41; 
&gt; and my ActivePerl-5.12.2 &#40;x86 and x64&#41; the following works fine:
&gt; 
&gt; #######################################
&gt; use ExtUtils::MakeMaker;
&gt; 
&gt; WriteMakefile&#40;
&gt;     NAME          =&gt; &#39;Crypt::SSLeay&#39;,
&gt;     AUTHOR        =&gt; &#39;A. Sinan Unur &lt;nanis@cpan.org&gt;&#39;,
&gt;     ABSTRACT_FROM =&gt; &#39;SSLeay.pm&#39;,
&gt;     VERSION_FROM  =&gt; &#39;SSLeay.pm&#39;,
&gt;     LIBS =&gt; &#39;-lz -lssl -lcrypto -lssl32 -lssleay32 -leay32&#39;,
&gt; &#41;;
&gt; 
&gt; ####################################### 
&gt; 
&gt; That of course relies on the libraries and headers being in locations 
&gt; that are found by default - otherwise, I could still use the same 
&gt; Makefile.PL, but would have to provide INC and LIBS command line 
&gt; arguments &#40;or somesuch&#41; so that the library could be found.
&gt;  
<div class="message-stanza open">&gt; &gt; I will give you a heads up when I have something ready to be tested.
&gt; &gt; That should be in about two weeks&#39; time.
</div>&gt; 
&gt; That would be fine.
&gt; 
&gt; Cheers,
&gt; Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;06&nbsp;07:48:23&nbsp;2012</span>
    <span class="description">nanis [...] runu.moc.invalid -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
