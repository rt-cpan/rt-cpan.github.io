<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #67866 for DateTime-Format-Epoch: Wrong date being returned</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #67866 for DateTime-Format-Epoch: Wrong date being returned</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DateTime-Format-Epoch">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DateTime-Format-Epoch">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DateTime-Format-Epoch">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DateTime-Format-Epoch">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DateTime-Format-Epoch">DateTime-Format-Epoch CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">67866</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DateTime-Format-Epoch">DateTime-Format-Epoch</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
m.nooning [...] comcast.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-9868-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.13    </td>
  </tr>
  <tr id="CF-9869-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




test.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/930343/482859/test.pl">
Mon May 02 09:38:36 2011 (1.1k) by m.nooning [...] comcast.net
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/929901/482612/test.pl">
Sat Apr 30 17:00:08 2011 (779b) by m.nooning [...] comcast.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=67866">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-929901" href="/Public/Bug/Display.html?id=67866#txn-929901">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;30&nbsp;17:00:08&nbsp;2011</span>
    <span class="description">m.nooning [...] comcast.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Wrong date being returned</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/929901/482611/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482611">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 376b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">For example, instead of 2011-04-30, I am get back 2052-08-27.
The results are pasted after the __END__ statement in the attached code
snippet.

Windows XP Home SP3 Build 2600, X86-based, 32 bit.
Time Zone: Eastern Daylight Time

ActiveState Perl v5.12.2 on Windows XP Version 5.1.2600
Binary build 1202 [293621]

$DateTime::VERSION 0.68
$DateTime::Format::Epoch::VERSION 0.13
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/929901/482612/test.pl">Download test.pl</a><br />
<span class="downloadcontenttype">text/x-perl 779b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use DateTime;
use DateTime::Format::Epoch;

my $epoch = time&#40;&#41;;
print &#40;&#34;time&#40;&#41; epoch is $epoch\n&#34;&#41;;

$dt = DateTime-&gt;from_epoch&#40; 
    epoch=&gt; $epoch,
    time_zone  =&gt; &#34;America/New_York&#34;,
&#41;;
print&#40;&#34;DateTime Formatted yyyy-mm-dd is &#34;, $dt-&gt;ymd&#40;&#39;-&#39;&#41;, &#34;\n&#34;&#41;;

my $formatter = DateTime::Format::Epoch-&gt;new&#40; epoch =&gt; $dt &#41;;

my $dt2 = $formatter-&gt;parse_datetime&#40; $epoch &#41;;
print &#40;&#34;formatter-&gt;parse_datetime dt2 = &#34;, $dt2, &#34;\n&#34;&#41;;

$formatter-&gt;format_datetime&#40;$dt2&#41;;
print &#40;&#34;formatter-&gt;parse_datetime given dt2: &#34;, $formatter-&gt;format_datetime&#40;$dt2&#41;, &#34;\n&#34;&#41;;

__END__

The results are pasted below.

C:\&gt;perl test.pl
time&#40;&#41; epoch is 1304196367
DateTime Formatted yyyy-mm-dd is 2011-04-30
formatter-&gt;parse_datetime dt2 = 2052-08-27T17:32:14
formatter-&gt;parse_datetime given dt2: 1304196367
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-929918" href="/Public/Bug/Display.html?id=67866#txn-929918">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;30&nbsp;17:36:28&nbsp;2011</span>
    <span class="description">CHORNY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/929918/482621/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482621">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 559b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Apr 30 17:00:08 2011, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; For example, instead of 2011-04-30, I am get back 2052-08-27.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; my $formatter = DateTime::Format::Epoch-&gt;new&#40; epoch =&gt; $dt &#41;;
</div>
$dt here is start date. From documentation: &#34;This datetime is the
starting point of the day count&#34;. See
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/perldoc?DateTime::Format::Epoch">http://search.cpan.org/perldoc?DateTime::Format::Epoch</a></span>
So you add 41 &#40;years from 1970&#41; to 2011. 2052 is correct.

I guess documentation should be more clear here, so if you can provide
better words, I&#39;ll modify documentation.

-- 
Alexandr Ciornii, <span class="clickylink"><a target="new" rel="nofollow" href="http://chorny.net">http://chorny.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-929921" href="/Public/Bug/Display.html?id=67866#txn-929921">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;30&nbsp;17:36:29&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-929922" href="/Public/Bug/Display.html?id=67866#txn-929922">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;30&nbsp;17:36:51&nbsp;2011</span>
    <span class="description">CHORNY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-930340" href="/Public/Bug/Display.html?id=67866#txn-930340">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;02&nbsp;08:54:02&nbsp;2011</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #67866] Wrong date being returned</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 02 May 2011 08:53:50 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DateTime-Format-Epoch [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/930340/482855/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482855">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Naturally, care must be taken when reading the explanations to discern 
properly.  Then there are the readers preset expectations.  You know.  
The ones that automatically sway the interpretation of anything that is 
written.  The module in question is a good case in point.

I would have expected something of the form

     $current_parsed_date_and_time = $formatter-&gt;parse_datetime&#40; $epoch &#41;;

to give back the answer assuming a start date of 1970-01-01T00:00:00Z.

I think the solution is to add something that would jar the user&#39;s brain 
a bit.  The first sentence of the description section reads:

This module can convert a DateTime object &#40;or any object that can be 
converted to a DateTime object&#41; to the number of seconds since a given 
epoch.

I think the two sentences added below would be good.

This module can convert a DateTime object &#40;or any object that can be 
converted to a DateTime object&#41; to the number of seconds since a given 
epoch.  Note that &#34;a given epoch&#34; does not imply the standard Unix epoch 
of 1970-01-01T00:00:00Z.  The counting will start from whatever epoch 
you gave in the creation of the original DateTime object.

By the way, I think &#34;skip_leap_secondss&#34; should be &#34;skip_leap_seconds&#34;

Thank you.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-930342" href="/Public/Bug/Display.html?id=67866#txn-930342">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;02&nbsp;08:54:03&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-930343" href="/Public/Bug/Display.html?id=67866#txn-930343">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;02&nbsp;09:38:36&nbsp;2011</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> m.nooning [...] comcast.net</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/930343/482858/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482858">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 151b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Is there still an error here?  Where did the extra five hours &#40;T05&#41; come
from?  Again, the answers are pasted after the __END__ statement in the
code.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/930343/482859/test.pl">Download test.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use DateTime;
use DateTime::Format::Epoch;

my $epoch = time&#40;&#41;;
print &#40;&#34;time&#40;&#41; epoch is $epoch\n&#34;&#41;;

my  $dt = DateTime-&gt;new&#40;
      time_zone =&gt; &#39;America/New_York&#39;,
      year       =&gt; 1970,
      month      =&gt; 1,
      day        =&gt; 1,
      hour       =&gt; 0,
      minute     =&gt; 0,
      second     =&gt; 0,
  &#41;;

print &#40;&#34;dt is $dt\n&#34;&#41;;

my $formatter = DateTime::Format::Epoch-&gt;new&#40;
                      epoch          =&gt; $dt,
                      unit           =&gt; &#39;seconds&#39;,
                      type           =&gt; &#39;int&#39;,    # or &#39;float&#39;, &#39;bigint&#39;
                      skip_leap_seconds =&gt; 1,
                      start_at       =&gt; 0,
                      local_epoch    =&gt; undef,
                  &#41;;

my $formatter = DateTime::Format::Epoch-&gt;new&#40; epoch =&gt; $dt, &#41;;

my $dt2 = $formatter-&gt;parse_datetime&#40; epoch =&gt; $dt &#41;;
print &#40;&#34;First, formatter-&gt;parse_datetime dt2 = &#34;, $dt2, &#34;\n&#34;&#41;;

$formatter-&gt;format_datetime&#40;$dt2&#41;;
print &#40;&#34;Second, formatter-&gt;parse_datetime given dt2: &#34;, $formatter-&gt;format_datetime&#40;$dt2&#41;, &#34;\n&#34;&#41;;


__END__

The results are pasted below.
time&#40;&#41; epoch is 1304343099
dt is 1970-01-01T00:00:00
First, formatter-&gt;parse_datetime dt2 = 1970-01-01T05:00:00
Second, formatter-&gt;parse_datetime given dt2: 0
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-930352" href="/Public/Bug/Display.html?id=67866#txn-930352">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;02&nbsp;10:34:03&nbsp;2011</span>
    <span class="description">pijll [...] gmx.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/930352/482865/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482865">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 725b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon 02 Mei 2011 09:38:36, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is there still an error here?  Where did the extra five hours &#40;T05&#41; 
</div>come
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; from?
</div>
By default, epochs are converted to UTC. You specify an epoch of 
midnight, New York time, which is 05:00:00UTC. The output of parse_time 
is in UTC. If you want to keep the same timezone, change the 
local_epoch parameter to 1 in the definition of the formatter.

By the way, this line:
my $dt2 = $formatter-&gt;parse_datetime&#40; epoch =&gt; $dt &#41;;
does not do what you think it does.

parse_datetime takes a single parameter, which should be a number. In 
this case, the string &#34;epoch&#34; is interpreted as 0. You should get a 
warning about this if you run the test script with -w.

Eugene
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-930385" href="/Public/Bug/Display.html?id=67866#txn-930385">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;02&nbsp;11:44:35&nbsp;2011</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #67866] Wrong date being returned</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 02 May 2011 11:44:18 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DateTime-Format-Epoch [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Malcolm Nooning &lt;m.nooning [...] comcast.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/930385/482882/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482882">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Excellent explanation.  Thanks

May I suggest some spoon feeding for people who do not normally work 
with date and time verbiage?  The doc already uses &#39;America/Chicago&#39; in 
one example, so, where the CPAN doc says:

      By default, the returned object will be in the UTC time zone.

it might help to change it to:

By default, the returned object will be in the UTC time zone.  That 
means that, for example, if you specify time_zone =&gt; &#39;America/Chicago&#39;, 
there will be a 6 hour difference in the result.

One more thing, the CPAN documentation for DateTime::Format::Epoch has
      parse_datetime&#40;$secs&#41;
but it also has
      ... parse_datetime accepts the same four element list ...

Again, great module, and thank you very much for such quick responses.


On 5/2/2011 10:34 AM, Eugene van der Pijll via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=67866">https://rt.cpan.org/Ticket/Display.html?id=67866</a></span>&gt;
&gt;
&gt; On Mon 02 Mei 2011 09:38:36, m.nooning@comcast.net wrote:
<div class="message-stanza open">&gt;&gt; Is there still an error here?  Where did the extra five hours &#40;T05&#41;
</div>&gt; come
<div class="message-stanza open">&gt;&gt; from?
</div>&gt; By default, epochs are converted to UTC. You specify an epoch of
&gt; midnight, New York time, which is 05:00:00UTC. The output of parse_time
&gt; is in UTC. If you want to keep the same timezone, change the
&gt; local_epoch parameter to 1 in the definition of the formatter.
&gt;
&gt; By the way, this line:
&gt; my $dt2 = $formatter-&gt;parse_datetime&#40; epoch =&gt;  $dt &#41;;
&gt; does not do what you think it does.
&gt;
&gt; parse_datetime takes a single parameter, which should be a number. In
&gt; this case, the string &#34;epoch&#34; is interpreted as 0. You should get a
&gt; warning about this if you run the test script with -w.
&gt;
&gt; Eugene
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.431585</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
