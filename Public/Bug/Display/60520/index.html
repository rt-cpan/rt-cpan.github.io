<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #60520 for Spreadsheet-ParseExcel: problem with 0 enterpretation</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #60520 for Spreadsheet-ParseExcel: problem with 0 enterpretation</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Spreadsheet-ParseExcel/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">60520</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Spreadsheet-ParseExcel/Active/">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
andrea.pfister [...] mmsag.ch

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;19&nbsp;09:34:09&nbsp;2010</span>
    <span class="description">andrea.pfister [...] mmsag.ch -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> problem with 0 enterpretation</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 19 Aug 2010 15:33:56 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Spreadsheet-ParseExcel [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Pfister Andrea&#34; &lt;andrea.pfister [...] mmsag.ch&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi

 

I use your Modul since 2 years and i&#39;m very happy with it.

 

Version: 0.54

 

Now i have a problem with zeros definition. If some one make this definition  #&#39;##0.;&#40;#&#39;##0&#41;;&#34;―&#34; in excel then i get a 0 in perl.

 

Is there a way to get the ― from the interface? 

 

Best regards

 

Andrea


Multimedia Solutions AGAndrea Pfister | SoftwareentwicklerinDorfstr. 29 | CH-8037 Zurich | Schweiz T +41 44 446 83 30 | T direkt +41 44 446 83 15 | F +41 44 446 83 38andrea.pfister@mmsag.ch | <span class="clickylink"><a target="new" rel="nofollow" href="http://www.mmsag.ch">http://www.mmsag.ch</a></span> 

75-Jahre-Firmenjubilaum und ein neues Druckzentrum im Jahr 2010 - gute Grunde zum Feiern. Am Freitag, 24. September 2010, offnen wir um 15 Uhr die Tore zur Open-House-Veranstaltung.

Erfolgreiches erstes Geschaftsberichte-Symposium - Impressionen und Prasentationen.

The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Any review, retransmission, dissemination or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any computer.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;23&nbsp;11:20:11&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Aug 19 09:34:09 2010, andrea.pfister@mmsag.ch wrote:
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Now i have a problem with zeros definition. If some one make this
&gt;    definition  #&#39;##0.;&#40;#&#39;##0&#41;;&#34;―&#34; in excel then i get a 0 in perl.
&gt; 
&gt; Is there a way to get the ― from the interface?
</div>

Hi,

You can get the format that will be applied as follows:


#!/usr/bin/perl -w

use strict;
use Spreadsheet::ParseExcel;

my $parser   = Spreadsheet::ParseExcel-&gt;new&#40;&#41;;
my $workbook = $parser-&gt;parse&#40;&#39;new_file.xls&#39;&#41;;


for my $worksheet &#40; $workbook-&gt;worksheets&#40;&#41; &#41; {

    my &#40; $row_min, $row_max &#41; = $worksheet-&gt;row_range&#40;&#41;;
    my &#40; $col_min, $col_max &#41; = $worksheet-&gt;col_range&#40;&#41;;

    for my $row &#40; $row_min .. $row_max &#41; {
        for my $col &#40; $col_min .. $col_max &#41; {

            my $cell = $worksheet-&gt;get_cell&#40; $row, $col &#41;;
            next unless $cell;

            my $format_str = $workbook-&gt;{FmtClass}-&gt;FmtStringDef&#40; $cell-&gt;{FormatNo}, 
$workbook &#41;;

            print &#34;Row, Col      = &#40;$row, $col&#41;\n&#34;;
            print &#34;Unformatted   = &#34;, $cell-&gt;unformatted&#40;&#41;, &#34;\n&#34;;
            print &#34;Format string = &#34;, $format_str, &#34;\n&#34;;
            print &#34;Value         = &#34;, $cell-&gt;value&#40;&#41;,       &#34;\n&#34;;
            print &#34;\n&#34;;
        }
    }
}
__END__

The syntax is a bit unwieldy and it will be hopefully simplified in a later release.

Anyway, I would recommend matching the format string with the format that is giving 
problems and substitute the cell value as necessary.

Note, the format stored in the file may not be the same as the format that you applied in the 
Excel dialog. Excel stores formats with US style punctuation so the your format would 
probably be stored as something like: &#39;#,##0.;&#40;#,##0&#41;;&#34;-&#34;&#39;


John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;23&nbsp;11:20:12&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;26&nbsp;02:53:04&nbsp;2010</span>
    <span class="description">andrea.pfister [...] mmsag.ch -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AW: [rt.cpan.org #60520] problem with 0 enterpretation </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 26 Aug 2010 08:52:48 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Spreadsheet-ParseExcel [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Pfister Andrea&#34; &lt;andrea.pfister [...] mmsag.ch&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you I will try this.

Have a nice day!

Andrea

Multimedia Solutions AGAndrea Pfister | SoftwareentwicklerinDorfstr. 29 | CH-8037 Zürich | Schweiz T +41 44 446 83 30 | T direkt +41 44 446 83 15 | F +41 44 446 83 38andrea.pfister@mmsag.ch | <span class="clickylink"><a target="new" rel="nofollow" href="http://www.mmsag.ch">http://www.mmsag.ch</a></span> 
75-Jahre-Firmenjubiläum und ein neues Druckzentrum im Jahr 2010 - gute Gründe zum Feiern. Am Freitag, 24. September 2010, öffnen wir um 15 Uhr die Tore zur Open-House-Veranstaltung.

Erfolgreiches erstes Geschäftsberichte-Symposium - Impressionen und Präsentationen.
The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Any review, retransmission, dissemination or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any computer.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Ursprüngliche Nachricht-----
Von: John McNamara via RT [mailto:bug-Spreadsheet-ParseExcel@rt.cpan.org] 
Gesendet: Montag, 23. August 2010 17:20
An: Pfister Andrea
Betreff: [rt.cpan.org #60520] problem with 0 enterpretation 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60520">https://rt.cpan.org/Ticket/Display.html?id=60520</a></span> &gt;

On Thu Aug 19 09:34:09 2010, andrea.pfister@mmsag.ch wrote:
 
<div class="message-stanza open">&gt; 
&gt; Now i have a problem with zeros definition. If some one make this
&gt;    definition  #&#39;##0.;&#40;#&#39;##0&#41;;&#34;―&#34; in excel then i get a 0 in perl.
&gt; 
&gt; Is there a way to get the ― from the interface?
</div>

Hi,

You can get the format that will be applied as follows:


#!/usr/bin/perl -w

use strict;
use Spreadsheet::ParseExcel;

my $parser   = Spreadsheet::ParseExcel-&gt;new&#40;&#41;;
my $workbook = $parser-&gt;parse&#40;&#39;new_file.xls&#39;&#41;;


for my $worksheet &#40; $workbook-&gt;worksheets&#40;&#41; &#41; {

    my &#40; $row_min, $row_max &#41; = $worksheet-&gt;row_range&#40;&#41;;
    my &#40; $col_min, $col_max &#41; = $worksheet-&gt;col_range&#40;&#41;;

    for my $row &#40; $row_min .. $row_max &#41; {
        for my $col &#40; $col_min .. $col_max &#41; {

            my $cell = $worksheet-&gt;get_cell&#40; $row, $col &#41;;
            next unless $cell;

            my $format_str = $workbook-&gt;{FmtClass}-&gt;FmtStringDef&#40; $cell-&gt;{FormatNo}, 
$workbook &#41;;

            print &#34;Row, Col      = &#40;$row, $col&#41;\n&#34;;
            print &#34;Unformatted   = &#34;, $cell-&gt;unformatted&#40;&#41;, &#34;\n&#34;;
            print &#34;Format string = &#34;, $format_str, &#34;\n&#34;;
            print &#34;Value         = &#34;, $cell-&gt;value&#40;&#41;,       &#34;\n&#34;;
            print &#34;\n&#34;;
        }
    }
}
__END__

The syntax is a bit unwieldy and it will be hopefully simplified in a later release.

Anyway, I would recommend matching the format string with the format that is giving 
problems and substitute the cell value as necessary.

Note, the format stored in the file may not be the same as the format that you applied in the 
Excel dialog. Excel stores formats with US style punctuation so the your format would 
probably be stored as something like: &#39;#,##0.;&#40;#,##0&#41;;&#34;-&#34;&#39;


John.
-- 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;26&nbsp;03:34:02&nbsp;2010</span>
    <span class="description">andrea.pfister [...] mmsag.ch -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AW: [rt.cpan.org #60520] problem with 0 enterpretation </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 26 Aug 2010 09:33:50 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Spreadsheet-ParseExcel [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Pfister Andrea&#34; &lt;andrea.pfister [...] mmsag.ch&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Hi John

I try it, but i gat the rong Formatting string

My Code:

my $format_str = $p-&gt;{workbook}-&gt;{FmtClass}-&gt;FmtStringDef&#40;
$CurrentCell-&gt;{FormatNo}, $p-&gt;{workbook} &#41;;                     
                                        
if &#40;$format_str and $CurrentCell-&gt;Value&#40;&#41;&#41;
{
        warn &#34;...............................&#34;;
        warn $CurrentCell-&gt;Value&#40;&#41;;
        warn $CurrentCell-&gt;{&#39;Val&#39;};
        warn $format_str;
        warn &#34;------------------------------&#34;;
}


I have a Format in Excel like this #&#39;##0.;&#40;#&#39;##0.&#41;;&#34;-&#34;;_&#40;@_&#41;

And the output of the program is 

...............................
0.00000. 
0 
_ &#34;SFr.&#34;\ * #,##0_ ;_ &#34;SFr.&#34;\ * \-#,##0_ ;_ &#34;SFr.&#34;\ * &#34;-&#34;_ ;_ @_ 
------------------------------

Did I do something wrong?

Greeting

Andrea





Multimedia Solutions AGAndrea Pfister | SoftwareentwicklerinDorfstr. 29 | CH-8037 Zurich | Schweiz T +41 44 446 83 30 | T direkt +41 44 446 83 15 | F +41 44 446 83 38andrea.pfister@mmsag.ch | <span class="clickylink"><a target="new" rel="nofollow" href="http://www.mmsag.ch">http://www.mmsag.ch</a></span> 

75-Jahre-Firmenjubilaum und ein neues Druckzentrum im Jahr 2010 - gute Grunde zum Feiern. Am Freitag, 24. September 2010, offnen wir um 15 Uhr die Tore zur Open-House-Veranstaltung.

Erfolgreiches erstes Geschaftsberichte-Symposium - Impressionen und Prasentationen.

The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Any review, retransmission, dissemination or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any computer.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;26&nbsp;10:57:55&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Aug 26 03:34:02 2010, andrea.pfister@mmsag.ch wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I have a Format in Excel like this #&#39;##0.;&#40;#&#39;##0.&#41;;&#34;-&#34;;_&#40;@_&#41;
&gt; 
&gt; And the output of the program is
&gt; 
&gt; ...............................
&gt; 0.00000.
&gt; 0
&gt; _ &#34;SFr.&#34;\ * #,##0_ ;_ &#34;SFr.&#34;\ * \-#,##0_ ;_ &#34;SFr.&#34;\ * &#34;-&#34;_ ;_ @_
&gt; ------------------------------
&gt; 
&gt; Did I do something wrong?
</div>

Hi,

You didn&#39;t do anything wrong. Excel doesn&#39;t store the format in the same
way as it displays it. It the above example it has added a locale and
escaped some of the characters.

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;05:17:14&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Question answered, I hope.

Closing the issue,

John.
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;05:17:15&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;05:17:31&nbsp;2010</span>
    <span class="description">andrea.pfister [...] mmsag.ch -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Abwesenheitsnotiz: [rt.cpan.org #60520] problem with 0 enterpretation </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 21 Sep 2010 11:17:18 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;John McNamara via RT&#34; &lt;bug-Spreadsheet-ParseExcel [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Pfister Andrea&#34; &lt;andrea.pfister [...] mmsag.ch&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sehr geehrte Damen und Herren,

besten Dank für Ihre Nachricht. Heute bin ich abwesend. Ihre E-Mail wird nicht weitergeleitet. In dringenden Fällen rufen Sie bitte unsere Hauptnummer an &#40;Telefon 044 446 83 30&#41;.

--

Dear Sir or Madam,

thank you for your message. Unfortunately, i&#39;m not available today. For immediate assistance, please contact our switchboard &#40;+41 44 446 83 30&#41;. Your email will not be forwarded.


Freundliche Grüsse | With best regards

Andrea Pfister

Multimedia Solutions AGAndrea Pfister | SoftwareentwicklerinDorfstr. 29 | CH-8037 Zürich | Schweiz T +41 44 446 83 30 | T direkt +41 44 446 83 15 | F +41 44 446 83 38andrea.pfister@mmsag.ch | <span class="clickylink"><a target="new" rel="nofollow" href="http://www.mmsag.ch">http://www.mmsag.ch</a></span> 

75-Jahre-Firmenjubiläum und ein neues Druckzentrum im Jahr 2010 - gute Gründe zum Feiern. Am Freitag, 24. September 2010, öffnen wir um 15 Uhr die Tore zur Open-House-Veranstaltung.

Erfolgreiches erstes Geschäftsberichte-Symposium - Impressionen und Präsentationen.

The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material. Any review, retransmission, dissemination or other use of, or taking of any action in reliance upon, this information by persons or entities other than the intended recipient is prohibited. If you received this in error, please contact the sender and delete the material from any computer.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;05:17:32&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;05:19:25&nbsp;2010</span>
    <span class="description">jmcnamara [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
