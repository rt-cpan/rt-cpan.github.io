<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #105973 for Net-Appliance-Session: Issue with Palo Alto Device. Connection drops.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #105973 for Net-Appliance-Session: Issue with Palo Alto Device. Connection drops.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-Appliance-Session/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-Appliance-Session/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-Appliance-Session/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-Appliance-Session/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-Appliance-Session">Net-Appliance-Session CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">105973</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-Appliance-Session/Active/">Net-Appliance-Session</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
me [...] marcosg.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-41116-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-41117-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;20&nbsp;02:49:20&nbsp;2015</span>
    <span class="description">me [...] marcosg.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Issue with Palo Alto Device. Connection drops.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 20 Jul 2015 16:49:07 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Appliance-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marcos Georgopoulos &lt;me [...] marcosg.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I am trying to use your library to connect to a Palo Alto Firewall device.
I can connect fine however issuing a command seems to cause the connection
to close.  However as far as the device is concerned the session is still
connected.


Here is the output of my debug when trying to log in and issue a command
&#39;show interface management&#39;

[   0.009087] pr finding prompt
[   0.012640] tr creating Net::Telnet wrapper for ssh
[   0.014011] tr connecting with:  ssh -o StrictHostKeyChecking=no -o
UserKnownHostsFile=/dev/null -o CheckHostIP=no -l admin 172.16.118.119
Warning: Permanently added &#39;172.16.118.119&#39; &#40;RSA&#41; to the list of known
hosts.
[   0.393653] ph  reading phrasebook
/usr/local/share/perl/5.18.2/Net/CLI/Interact/phrasebook/cisco/pb
[   0.394259] ph   storing prompt generic
[   0.398026] ph   storing prompt basic
[   0.398248] ph   storing prompt privileged
[   0.398453] ph   storing prompt configure
[   0.398737] ph   storing prompt user
[   0.398953] ph   storing prompt pass
[   0.399157] ph   storing prompt prompt
[   0.399371] ph   storing macro begin_privileged
[   0.399941] ph   storing macro end_privileged
[   0.400181] ph   storing macro begin_configure
[   0.400413] ph   storing macro end_configure
[   0.400644] ph   storing macro disconnect
[   0.400965] pr   nope, doesn&#39;t &#40;yet&#41; match privileged
[   0.401090] pr   nope, doesn&#39;t &#40;yet&#41; match configure
[   0.401208] pr   nope, doesn&#39;t &#40;yet&#41; match basic
[   0.401343] pr   nope, doesn&#39;t &#40;yet&#41; match prompt
[   0.401460] pr   nope, doesn&#39;t &#40;yet&#41; match pass
[   0.401593] pr   nope, doesn&#39;t &#40;yet&#41; match generic
[   0.401715] pr   nope, doesn&#39;t &#40;yet&#41; match user
[   0.401816] pr   no match so far, more data?
[   0.428824] du   SEEN:
Warning: Permanently added &#39;172.16.118.119&#39; &#40;RSA&#41; to the list of known
hosts.
Password:
[   0.429082] pr   nope, doesn&#39;t &#40;yet&#41; match privileged
[   0.429208] pr   nope, doesn&#39;t &#40;yet&#41; match configure
[   0.429326] pr   nope, doesn&#39;t &#40;yet&#41; match basic
[   0.429463] pr   nope, doesn&#39;t &#40;yet&#41; match prompt
[   0.429583] pr  hit, matches prompt pass
[   0.430179] pr  prompt has been set to &#40;?^:[Pp]assword: ?$&#41;
[   0.432026] pr output matching prompt was &#34;Password: &#34;
[   0.432228] di  trimmed command response:
Warning: Permanently added &#39;172.16.118.119&#39; &#40;RSA&#41; to the list of known
hosts.
[   0.433138] pr finding prompt
[   0.433342] du   SEEN:

[   0.433467] pr   nope, doesn&#39;t &#40;yet&#41; match privileged
[   0.433584] pr   nope, doesn&#39;t &#40;yet&#41; match configure
[   0.433700] pr   nope, doesn&#39;t &#40;yet&#41; match basic
[   0.433813] pr   nope, doesn&#39;t &#40;yet&#41; match prompt
[   0.433926] pr   nope, doesn&#39;t &#40;yet&#41; match pass
[   0.434040] pr   nope, doesn&#39;t &#40;yet&#41; match generic
[   0.434154] pr   nope, doesn&#39;t &#40;yet&#41; match user
[   0.434245] pr   no match so far, more data?
[   0.450952] du   SEEN:

Last login: Sun Jul 19 23:39:27 2015 from 172.16.118.115
[   0.451194] pr   nope, doesn&#39;t &#40;yet&#41; match privileged
[   0.451348] pr   nope, doesn&#39;t &#40;yet&#41; match configure
[   0.451473] pr   nope, doesn&#39;t &#40;yet&#41; match basic
[   0.451623] pr   nope, doesn&#39;t &#40;yet&#41; match prompt
[   0.451774] pr   nope, doesn&#39;t &#40;yet&#41; match pass
[   0.451943] pr   nope, doesn&#39;t &#40;yet&#41; match generic
[   0.452059] pr   nope, doesn&#39;t &#40;yet&#41; match user
[   0.452167] pr   no match so far, more data?
[   1.072714] du   SEEN:

Last login: Sun Jul 19 23:39:27 2015 from 172.16.118.115
Welcome admin.
[   1.072957] pr   nope, doesn&#39;t &#40;yet&#41; match privileged
[   1.073066] pr   nope, doesn&#39;t &#40;yet&#41; match configure
[   1.073187] pr   nope, doesn&#39;t &#40;yet&#41; match basic
[   1.073314] pr   nope, doesn&#39;t &#40;yet&#41; match prompt
[   1.073419] pr   nope, doesn&#39;t &#40;yet&#41; match pass
[   1.073539] pr   nope, doesn&#39;t &#40;yet&#41; match generic
[   1.073643] pr   nope, doesn&#39;t &#40;yet&#41; match user
[   1.073722] pr   no match so far, more data?
[   1.318642] du   SEEN:

Last login: Sun Jul 19 23:39:27 2015 from 172.16.118.115
Welcome admin.
admin@PA-3020&gt;
[   1.318892] pr   nope, doesn&#39;t &#40;yet&#41; match privileged
[   1.319002] pr   nope, doesn&#39;t &#40;yet&#41; match configure
[   1.319113] pr  hit, matches prompt basic
[   1.319222] pr  prompt has been set to &#40;?^:&gt; ?$&#41;
[   1.319646] pr output matching prompt was &#34;admin@PA-3020&gt; &#34;
[   1.319814] di  trimmed command response:
Last login: Sun Jul 19 23:39:27 2015 from 172.16.118.115
Welcome admin.
[   1.324264] en running command show interface management
[   1.324434] en executing actions
[   1.325430] en   dispatching to execute method
[   1.327353] tr  callback received for send
[   1.327810] di queueing data for send: &#34;show interface management&#34;
[   1.328053] tr  callback received for match
[   1.348550] du   SEEN:
show interface management
[   1.348808] tr   nope, doesn&#39;t &#40;yet&#41; match &#40;?^:&gt; ?$&#41;
[   1.364072] du   SEEN:
Connection to 172.16.118.119 closed.
[   1.364362] tr   nope, doesn&#39;t &#40;yet&#41; match &#40;?^:&gt; ?$&#41;
read error: Input/output error at
/usr/local/share/perl/5.18.2/Net/CLI/Interact/Transport/Wrapper/Net_Telnet.pm
line 35


When I log in via putty, here is the expected output


login as: admin
Using keyboard-interactive authentication.
Password:
Last login: Sun Jul 19 23:42:34 2015 from 172.16.118.115

Welcome admin.
admin@PA-3020&gt; show interface management

-------------------------------------------------------------------------------
Name: Management Interface
Link status:
  Runtime link speed/duplex/state: 100/full/up
  Configured link speed/duplex/state: auto/auto/auto
MAC address:
  Port MAC address 00:1b:17:ab:ac:c0

Ip address: 172.16.118.119
Netmask: 255.255.255.0
Default gateway: 172.16.118.254
Ipv6 address: unknown
Ipv6 link local address: unknown
Ipv6 default gateway: unknown
-------------------------------------------------------------------------------

I&#39;m not sure how to troubleshoot this further.

Many thanks.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;23&nbsp;17:23:17&nbsp;2015</span>
    <span class="description">OLIVER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Well, it looks like a genuine disconnect from the SSH side: &#34;Connection to 172.16.118.119 closed.&#34;.

However you could try the Net::OpenSSH module instead of the Net::TELNET wrapper to openssh.

Set the &#34;transport&#34; option to &#34;Net_OpenSSH&#34; and it should be enough.

-- 
regards,
oliver.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;23&nbsp;17:23:18&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;23&nbsp;17:23:19&nbsp;2015</span>
    <span class="description">OLIVER [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;24&nbsp;00:38:15&nbsp;2015</span>
    <span class="description">me [...] marcosg.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #105973] Issue with Palo Alto Device. Connection drops.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 24 Jul 2015 14:37:58 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Appliance-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marcos Georgopoulos &lt;me [...] marcosg.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you very much for that.

I am trying to use the Net_OpenSSH option however I when I set the
&#39;transport&#39; to &#39;Net_OpenSSH&#39;

I get the following error when trying to connect;

&#34;coercion for &#34;connect_options&#34; failed: Missing required argument: master
at &#40;eval 609&#41; line 55.

I&#39;ve read through the CPAN documentation but cannot work out what I am
doing wrong. Do you have an example of how to use the &#39;Net_OpenSSH&#39; option?

thank you.


On Fri, Jul 24, 2015 at 7:23 AM, Oliver Gorwits via RT &lt;
bug-Net-Appliance-Session@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=105973">https://rt.cpan.org/Ticket/Display.html?id=105973</a></span> &gt;
&gt;
&gt; Hi,
&gt;
&gt; Well, it looks like a genuine disconnect from the SSH side: &#34;Connection to
&gt; 172.16.118.119 closed.&#34;.
&gt;
&gt; However you could try the Net::OpenSSH module instead of the Net::TELNET
&gt; wrapper to openssh.
&gt;
&gt; Set the &#34;transport&#34; option to &#34;Net_OpenSSH&#34; and it should be enough.
&gt;
&gt; --
&gt; regards,
&gt; oliver.
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
