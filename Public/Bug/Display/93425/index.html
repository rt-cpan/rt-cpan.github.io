<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #93425 for Spreadsheet-ParseExcel: Color index leaks from one workbook to another.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #93425 for Spreadsheet-ParseExcel: Color index leaks from one workbook to another.</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-ParseExcel">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-ParseExcel">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-ParseExcel">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-ParseExcel">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">93425</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-ParseExcel">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
tlhackque [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.59    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.61    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=93425">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331988" href="/Public/Bug/Display.html?id=93425#txn-1331988">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;06:24:28&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Color index leaks from one workbook to another.</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331988/706600/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706600">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Color index leaks from one workbook to another.

If you open a workbook &#38; parse it, the global palette &#40;@aColor&#41; is updated.

Parse another, and it uses the updated global.  This can get the colors wrong in the second workbook.

Correct behavior is for each workbook to start from the initial palette and maintain it from there.


Fix is in <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/tlhackque/spreadsheet-parseexcel">https://github.com/tlhackque/spreadsheet-parseexcel</a></span> 

Deprecates S:P:E:ColorIdxToRGB - this now applies to the last parsed workbook, which is compatible with existing code.  &#40;It does produce the right answer most of the time, but different wrong answers when it&#39;s wrong&#41;.

Replacement is $workbook-&gt;ColorIdxToRGB.


diff --git a/lib/Spreadsheet/ParseExcel.pm b/lib/Spreadsheet/ParseExcel.pm
index a96af12..e65fa88 100644
--- a/lib/Spreadsheet/ParseExcel.pm
+++ b/lib/Spreadsheet/ParseExcel.pm
@@ -22,7 +22,7 @@ use Config;
 use Crypt::RC4;
 use Digest::Perl::MD5;
 
-our $VERSION = &#39;0.59&#39;;
+our $VERSION = &#39;0.60&#39;;
 
 use Spreadsheet::ParseExcel::Workbook;
 use Spreadsheet::ParseExcel::Worksheet;
@@ -31,6 +31,7 @@ use Spreadsheet::ParseExcel::Format;
 use Spreadsheet::ParseExcel::Cell;
 use Spreadsheet::ParseExcel::FmtDefault;
 
+my $oCurrentBook;
 my @aColor = &#40;
     &#39;000000&#39;,    # 0x00
     &#39;FFFFFF&#39;, &#39;FFFFFF&#39;, &#39;FFFFFF&#39;, &#39;FFFFFF&#39;,
@@ -514,10 +515,12 @@ sub parse {
     my &#40; $self, $source, $formatter &#41; = @_;
 
     my $workbook = Spreadsheet::ParseExcel::Workbook-&gt;new&#40;&#41;;
+    $oCurrentBook = $workbook;
     $workbook-&gt;{SheetCount} = 0;
     $workbook-&gt;{CellHandler} = $self-&gt;{CellHandler};
     $workbook-&gt;{NotSetCell}  = $self-&gt;{NotSetCell};
     $workbook-&gt;{Object}      = $self-&gt;{Object};
+    $workbook-&gt;{aColor}      = [ @aColor ];
 
     my &#40; $biff_data, $data_length &#41; = $self-&gt;_get_content&#40; $source, $workbook &#41;;
     return undef if not $biff_data;
@@ -1634,7 +1637,7 @@ sub _subPalette {
     for &#40; my $i = 0 ; $i &lt; unpack&#40; &#39;v&#39;, $sWk &#41; ; $i++ &#41; {
 
         #        push @aColor, unpack&#40;&#39;H6&#39;, substr&#40;$sWk, $i*4+2&#41;&#41;;
-        $aColor[ $i + 8 ] = unpack&#40; &#39;H6&#39;, substr&#40; $sWk, $i * 4 + 2 &#41; &#41;;
+        $oBook-&gt;{aColor}[ $i + 8 ] = unpack&#40; &#39;H6&#39;, substr&#40; $sWk, $i * 4 + 2 &#41; &#41;;
     }
 }
 
@@ -2479,12 +2482,19 @@ sub _NewCell {
 #------------------------------------------------------------------------------
 # ColorIdxToRGB &#40;for Spreadsheet::ParseExcel&#41;
 #
-# TODO JMN Make this a Workbook method and re-document.
+# Returns for most recently opened book for compatibility, use
+# Workbook::ColorIdxToRGB instead
 #
 #------------------------------------------------------------------------------
 sub ColorIdxToRGB {
     my &#40; $sPkg, $iIdx &#41; = @_;
-    return &#40; &#40; defined $aColor[$iIdx] &#41; ? $aColor[$iIdx] : $aColor[0] &#41;;
+
+
+    unless&#40; defined $oCurrentBook &#41; {
+       return &#40; &#40; defined $aColor[$iIdx] &#41; ? $aColor[$iIdx] : $aColor[0] &#41;;
+    }
+
+    return $oCurrentBook-&gt;ColorIdxToRGB&#40; $iIdx &#41;;
 }
 
 
@@ -2996,7 +3006,12 @@ Returns the style of an underlined font where the value has the following meanin
 
 =head2 $font-&gt;{Color}
 
-Returns the color index for the font. The index can be converted to a RGB string using the C&lt;ColorIdxToRGB&#40;&#41;&gt; Parser method.
+Returns the color index for the font. The mapping to an RGB color is defined by each workbook.
+
+The index can be converted to a RGB string using the C&lt;$workbook-&gt;ColorIdxToRGB&#40;&#41;&gt; Parser method.
+
+&#40;Older versions of C&lt;Spreadsheet::ParseExcel&gt; provided the C&lt;ColorIdxToRGB&gt; class method, which is deprecated.&#41;
+
 
 =head2 $font-&gt;{Strikeout}
 
diff --git a/lib/Spreadsheet/ParseExcel/Workbook.pm b/lib/Spreadsheet/ParseExcel/Workbook.pm
index ba0381f..d58f98b 100644
--- a/lib/Spreadsheet/ParseExcel/Workbook.pm
+++ b/lib/Spreadsheet/ParseExcel/Workbook.pm
@@ -33,6 +33,14 @@ sub new {
 }
 
 ###############################################################################
+sub ColorIdxToRGB {
+    my&#40; $oBook, $iIdx &#41; = @_;
+
+    my $palette = $oBook-&gt;{aColor};
+    return &#40; &#40; defined $palette-&gt;[$iIdx] &#41; ? $palette-&gt;[$iIdx] : $palette-&gt;[0] &#41;;
+}
+
+###############################################################################
 #
 # worksheet&#40;&#41;
 #
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1332014" href="/Public/Bug/Display.html?id=93425#txn-1332014">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;08:07:09&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1332014/706620/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706620">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 497b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 28 06:24:28 2014, tlhackque wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; +Returns the color index for the font. The mapping to an RGB color is
&gt; defined by each workbook.
&gt; +
&gt; +The index can be converted to a RGB string using the C&lt;$workbook-
<div class="message-stanza open">&gt; &gt;ColorIdxToRGB&#40;&#41;&gt; Parser method.
</div></div>
Hi Timothe,

That look okay overall and as the TODO testifies, it was on the back of my mind to do it eventually.

If the method is being made public then it should have a under_score style name like:


    $workbook-&gt;color_id_to_rgb&#40;&#41;

John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1332015" href="/Public/Bug/Display.html?id=93425#txn-1332015">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;08:07:09&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1332027" href="/Public/Bug/Display.html?id=93425#txn-1332027">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;08:52:07&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93425] Color index leaks from one workbook to another.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Feb 2014 08:51:58 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque &lt;tlhackque [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1332027/706630/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706630">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 28-Feb-14 08:07, John McNamara via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93425">https://rt.cpan.org/Ticket/Display.html?id=93425</a></span> &gt;
&gt;
&gt; On Fri Feb 28 06:24:28 2014, tlhackque wrote:
&gt;
<div class="message-stanza open">&gt;&gt; +Returns the color index for the font. The mapping to an RGB color is
&gt;&gt; defined by each workbook.
&gt;&gt; +
&gt;&gt; +The index can be converted to a RGB string using the C&lt;$workbook-
<div class="message-stanza open">&gt;&gt;&gt; ColorIdxToRGB&#40;&#41;&gt; Parser method.
</div></div>&gt; Hi Timothe,
&gt;
&gt; That look okay overall and as the TODO testifies, it was on the back of my mind to do it eventually.
&gt;
&gt; If the method is being made public then it should have a under_score style name like:
&gt;
&gt;
&gt;      $workbook-&gt;color_id_to_rgb&#40;&#41;
&gt;
&gt; John
</div>
I&#39;ve hit several of your TODOs as I&#39;ve needed things for my project.   I 
appreciate that you left hints even where you left things as TODOs.

I will change the name - though I was trying to remain consistent with 
the the previous method&#39;s name.  I thought that updating callers would 
be easier &#40;switch $parser-&gt; to $workbook-&gt;&#41;.   I guess it depends on 
what kind of consistency we want to achieve.

Re: overall style: I&#39;m focused on my project, not S:P:E.  I&#39;ll code 
patches in whatever the native style du jour is, but switching is out of 
scope.



-- 
This communication may not represent my employer&#39;s views,
if any, on the matters discussed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1332059" href="/Public/Bug/Display.html?id=93425#txn-1332059">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;10:06:20&nbsp;2014</span>
    <span class="description">jmcnamara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1332059/706653/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706653">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 659b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 28 08:52:07 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I guess it depends on what kind of consistency we want to achieve.
</div>
Hi Timothe,

Basically, no camel case names in new code, and use names like $workbook, $worksheet, etc. instead of $oBook, $oSheet.

Old, untouched code can stay as it is.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Re: overall style: I&#39;m focused on my project, not S:P:E.  I&#39;ll code
&gt; patches in whatever the native style du jour is, but switching is out
&gt; of scope.
</div>
I think that it is only fair that if you are submitting code that will mainly &#40;if not only&#41; benefit your project that you make the effort to make that code acceptable to the maintainers. And add tests.


John
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1332067" href="/Public/Bug/Display.html?id=93425#txn-1332067">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;28&nbsp;10:24:05&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93425] Color index leaks from one workbook to another.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 28 Feb 2014 10:23:56 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque &lt;tlhackque [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1332067/706660/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706660">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 28-Feb-14 10:06, John McNamara via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93425">https://rt.cpan.org/Ticket/Display.html?id=93425</a></span> &gt;
&gt;
&gt; On Fri Feb 28 08:52:07 2014, tlhackque wrote:
<div class="message-stanza open">&gt;&gt; I guess it depends on what kind of consistency we want to achieve.
</div>&gt; Hi Timothe,
&gt;
&gt; Basically, no camel case names in new code, and use names like $workbook, $worksheet, etc. instead of $oBook, $oSheet.
&gt;
&gt; Old, untouched code can stay as it is.
&gt;
&gt;
<div class="message-stanza open">&gt;&gt; Re: overall style: I&#39;m focused on my project, not S:P:E.  I&#39;ll code
&gt;&gt; patches in whatever the native style du jour is, but switching is out
&gt;&gt; of scope.
</div>&gt; I think that it is only fair that if you are submitting code that will mainly &#40;if not only&#41; benefit your project that you make the effort to make that code acceptable to the maintainers. And add tests.
&gt;
&gt;
&gt; John
&gt;
&gt;
&gt;
&gt;
&gt;
</div>I wasn&#39;t clear.  What I meant was that I am not inclined to switch the 
style of existing routines where I just add a line or two of code.    Or 
whole files, just because I touch them.

I&#39;m happy to write new code in whatever style.  With no guidance [except 
that the module was unmaintained], I used the existing style.  That&#39;s 
normal when submitting patches.

Given your guidance, I will make the new hook routines use lowercase 
names.  It would be good to add a note to the README documenting this so 
future contributors don&#39;t have to redo work.

I have already changed the name of the color index routine as requested 
and committed tests for the new routines.

I&#39;m trying to be reasonable - but not to become the defacto maintainer 
of the module.

I&#39;m glad to see that there is hope for a release - which I think will 
benefit others.



-- 
This communication may not represent my employer&#39;s views,
if any, on the matters discussed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1333019" href="/Public/Bug/Display.html?id=93425#txn-1333019">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;03&nbsp;13:17:52&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1333019/707167/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/707167">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 195b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
I believe I have all of your changes committed to runrig/master. Examine the latest Changes file, let me know if I listed everything so I know what tickets to close. I&#39;ll get this released soon.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1333692" href="/Public/Bug/Display.html?id=93425#txn-1333692">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;19:07:15&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1333692/707531/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/707531">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 13b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in 0.61
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1333695" href="/Public/Bug/Display.html?id=93425#txn-1333695">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;19:07:16&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1333697" href="/Public/Bug/Display.html?id=93425#txn-1333697">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;04&nbsp;19:07:16&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Fixed in 0.61 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.396952</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
