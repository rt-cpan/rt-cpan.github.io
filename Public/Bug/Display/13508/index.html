<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #13508 for PAR: cannot find Glib.dll on win32, despite being packaged in the exe</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #13508 for PAR: cannot find Glib.dll on win32, despite being packaged in the exe</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/PAR/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/PAR/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/PAR/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/PAR/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/PAR">PAR CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">13508</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/PAR/Active/">PAR</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
schmorp [...] schmorp.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24530-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24531-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;01&nbsp;21:24:16&nbsp;2005</span>
    <span class="description">schmorp [...] schmorp.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 2 Jul 2005 03:23:49 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-par [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi!

I am trying to par-package a perl script trhat uses Glib/Gtk2 on windows,
with activestate perl.

The problem is, the .exe always complains about missing Glib.dll &#40;the perl
interface to libglib&#41;. When I add the directory containing Glib.dll, all
it&#39;s file are added, but not Glib.dll.

However, Glib.dll is actually part of the generated .exe, but it is
renamed to &#34;af084d9e.dll&#34; &#40;which is probably on purpose&#41;.

The same happened to all other dlls, such as libgobject, libgtk and so on.

Now, the obvious question is, how do I make it work, so that
Glib.pm/DynaLoader finds Glib.dll, and Glib.dll finds all it&#39;s dependend
dlls?

I use activestate perl 5.8.7, Perl Packager, version 0.12 &#40;PAR version 0.89&#41;.

The command to invoke pp was:

   /perl/bin/perl /perl/bin/pp -o kgsueme.exe -a /gtk2/bin --gui -x kgsueme 

where /gtk2/bin contains all the dlls required to run.

I&#39;d be thankful for any insights, but this problem is not of high priority
even for me, so feel free to ignore me :&#41;

If you need more info, I&#39;d be happy to provide what I can.

Greetings,

-- 
                The choice of a
      -----==-     _GNU_
      ----==-- _       generation     Marc Lehmann
      ---==---&#40;_&#41;__  __ ____  __      pcg@goof.com
      --==---/ / _ \/ // /\ \/ /      <span class="clickylink"><a target="new" rel="nofollow" href="http://schmorp.de/">http://schmorp.de/</a></span>
      -=====/_/_//_/\_,_/ /_/\_\      XX11-RIPE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;31&nbsp;07:29:01&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fr. 01. Jul. 2005, 21:24:16, schmorp@schmorp.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am trying to par-package a perl script trhat uses Glib/Gtk2 on
&gt; windows,
&gt; with activestate perl.
&gt; 
&gt; The problem is, the .exe always complains about missing Glib.dll &#40;the
&gt; perl
&gt; interface to libglib&#41;. When I add the directory containing Glib.dll,
&gt; all
&gt; it&#39;s file are added, but not Glib.dll.
&gt; 
&gt; However, Glib.dll is actually part of the generated .exe, but it is
&gt; renamed to &#34;af084d9e.dll&#34; &#40;which is probably on purpose&#41;.
&gt; 
&gt; The same happened to all other dlls, such as libgobject, libgtk and so
&gt; on.
&gt; 
&gt; Now, the obvious question is, how do I make it work, so that
&gt; Glib.pm/DynaLoader finds Glib.dll, and Glib.dll finds all it&#39;s
&gt; dependend
&gt; dlls?
&gt; 
&gt; I use activestate perl 5.8.7, Perl Packager, version 0.12 &#40;PAR version
&gt; 0.89&#41;.
&gt; 
&gt; The command to invoke pp was:
&gt; 
&gt;    /perl/bin/perl /perl/bin/pp -o kgsueme.exe -a /gtk2/bin --gui -x
&gt; kgsueme
&gt; 
&gt; where /gtk2/bin contains all the dlls required to run.
&gt; 
&gt; I&#39;d be thankful for any insights, but this problem is not of high
&gt; priority
&gt; even for me, so feel free to ignore me :&#41;
&gt; 
&gt; If you need more info, I&#39;d be happy to provide what I can.
</div>
Hi Marc,

packaging additional shared libraries into .par&#39;s or pp-ed binaries
should be done with -l. You can&#39;t package a complete directory as far as
I know.

HTH,
Steffen

P.S.: Sorry for the extremely belated reply.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;31&nbsp;07:29:03&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;31&nbsp;07:29:07&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;31&nbsp;15:14:05&nbsp;2006</span>
    <span class="description">schmorp [...] schmorp.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 31 Aug 2006 21:13:45 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Steffen Müller via RT &lt;bug-PAR [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Aug 31, 2006 at 07:29:05AM -0400, Steffen Müller via RT &lt;bug-PAR@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; If you need more info, I&#39;d be happy to provide what I can.
</div>&gt; 
&gt; Hi Marc,
&gt; 
&gt; packaging additional shared libraries into .par&#39;s or pp-ed binaries
&gt; should be done with -l. You can&#39;t package a complete directory as far as
&gt; I know.
</div>
I am not packaging *additional shared libraries*, I am packaging a perl
module. Glib.dll is the perl inetrface to libglib.

Also, Glib.dll *is* being packaged automatically by par, the problem is
that par renames it to some gibberish file &#40;as I already explained&#41;.

-l is certainly not going to help as PAR does not load Glib.dll but its own
renamed version of it. packaging Glib.dll in addition will clash with the
version par itself packaged.

This is a bug in par, and cannot be solved with commandline switches.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; P.S.: Sorry for the extremely belated reply.
</div>
Yeah, and on top of that thanks for completely ignoring my bug report and
simply closing it without reading it and cetrainly without resolving it :/

If you don&#39;t understand something, feel free to aks. But please don&#39;t just
blindly close completely valid und unresolved bugs!

-- 
                The choice of a
      -----==-     _GNU_
      ----==-- _       generation     Marc Lehmann
      ---==---&#40;_&#41;__  __ ____  __      pcg@goof.com
      --==---/ / _ \/ // /\ \/ /      <span class="clickylink"><a target="new" rel="nofollow" href="http://schmorp.de/">http://schmorp.de/</a></span>
      -=====/_/_//_/\_,_/ /_/\_\      XX11-RIPE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;31&nbsp;15:14:06&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;31&nbsp;15:46:34&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Do. 31. Aug. 2006, 15:14:05, schmorp@schmorp.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu, Aug 31, 2006 at 07:29:05AM -0400, Steffen Müller via RT &lt;bug-
&gt; PAR@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; Hi Marc,
&gt; &gt;
&gt; &gt; packaging additional shared libraries into .par&#39;s or pp-ed binaries
&gt; &gt; should be done with -l. You can&#39;t package a complete directory as
</div>&gt; far as
<div class="message-stanza open">&gt; &gt; I know.
</div>&gt; 
&gt; I am not packaging *additional shared libraries*, I am packaging a
&gt; perl
&gt; module. Glib.dll is the perl inetrface to libglib.
</div>
Right. Sorry, I missed that.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, Glib.dll *is* being packaged automatically by par, the problem
&gt; is
&gt; that par renames it to some gibberish file &#40;as I already explained&#41;.
</div>
FYI, that&#39;s because the dlls for various dependencies might clash.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -l is certainly not going to help as PAR does not load Glib.dll but
&gt; its own
&gt; renamed version of it. packaging Glib.dll in addition will clash with
&gt; the
&gt; version par itself packaged.
</div>
Certainly... Have you tried? -l makes sure the name is retained because
some dlls use other dlls and PAR can&#39;t intercept and mangle the name.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is a bug in par, and cannot be solved with commandline switches.
</div>
Possibly. Or:
<span class="clickylink"><a target="new" rel="nofollow" href="http://mail.gnome.org/archives/gtk-perl-list/2005-April/msg00187.html">http://mail.gnome.org/archives/gtk-perl-list/2005-April/msg00187.html</a></span>
Now, I know there is a difference between what that guy had problems
with &#40;gtk+&#41; and what you have problems with &#40;Glib.dll as part of a CPAN
module&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; P.S.: Sorry for the extremely belated reply.
</div>&gt; 
&gt; Yeah, and on top of that thanks for completely ignoring my bug report
&gt; and
&gt; simply closing it without reading it and cetrainly without resolving
&gt; it :/
</div>
Dare accuse me of not reading things and ignorance. Misreading is a
different thing. And usually an honest mistake. Which was the case here.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you don&#39;t understand something, feel free to aks. But please don&#39;t
&gt; just
&gt; blindly close completely valid und unresolved bugs!
</div>
Which are readily reopened by a reply. If I ask &#40;which you suggested I
do&#41; and you answer, the ticket&#39;s reopened. If you don&#39;t answer, a ticket
which I can&#39;t work on without the answer isn&#39;t valid. Now, no, I didn&#39;t
ask. But that&#39;s the reason I got into the habit of not waiting for a
reply before closing old tickets. &#40;And the same logic readily applies if
I wrongfully think the problem should be solved with command line options.&#41;

On an unrelated note, if you are so inclined, retry using PAR 0.952
which might have a slightly different way of handling dlls.

When answering, always keep in mind that the one you are answering to is
also working on this in his spare time, so let&#39;s keep the tone down.
Thank you.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;01&nbsp;05:53:35&nbsp;2006</span>
    <span class="description">schmorp [...] schmorp.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 1 Sep 2006 11:53:07 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Steffen Müller via RT &lt;bug-PAR [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Aug 31, 2006 at 03:46:37PM -0400, Steffen Müller via RT &lt;bug-PAR@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=13508">http://rt.cpan.org/Ticket/Display.html?id=13508</a></span> &gt;
&gt; 
<div class="message-stanza open">&gt; &gt; that par renames it to some gibberish file &#40;as I already explained&#41;.
</div>&gt; 
&gt; FYI, that&#39;s because the dlls for various dependencies might clash.
</div>
Well, they don&#39;t on the system where it is being packaged, so this is
eitehr a bug or a limittaion in par that could be solved &#40;e..g by not
putting everything into a flat hierarchy and relying on the normla perl
mechanism&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; -l is certainly not going to help as PAR does not load Glib.dll but
</div>&gt; 
&gt; Certainly... Have you tried? -l makes sure the name is retained because
</div>
Yes, that was the first thing I tried. It still loaded the &lt;hash&gt;.dll instead
of Glin.dll.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Possibly. Or:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://mail.gnome.org/archives/gtk-perl-list/2005-April/msg00187.html">http://mail.gnome.org/archives/gtk-perl-list/2005-April/msg00187.html</a></span>
&gt; Now, I know there is a difference between what that guy had problems
&gt; with &#40;gtk+&#41; and what you have problems with &#40;Glib.dll as part of a CPAN
&gt; module&#41;.
</div>
Right, I am the only one who managed to package gtk+ with perl on windows
so far, to my knowledge, and I had to work around some other par bugs
&#40;such as adding its own defective entry to @INC _multiple_ times during
program execution&#41; but thats not the actual problem.

The actual problem is and stays that par &#40;version 1.52&#41; does not correctly
package perl modules using xs and shared objects.

In case it matters, here is what I do a as workaround:

1. par keeps  alot of crust in @INC leading to clashes if a user has a
different but incompatible pelr installed:

      @INC = grep ref, @INC; # weed out all paths except pars loader refs

2. I pre-push my own libdir in @INC, both at BEGIN time as well as on main
program start, because par pushes its own handler in front of it.

3. I manually package all Glib and gtk2-module related files into my own
hierarchy. No @INC handler required, no renaming required, simply works.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ask. But that&#39;s the reason I got into the habit of not waiting for a
&gt; reply before closing old tickets. &#40;And the same logic readily applies if
&gt; I wrongfully think the problem should be solved with command line options.&#41;
</div>
A bad habit, but no permanent harm was done. Your behaviour is frustrating to
those who invest a lot of time investigating and openign bug reports. Many
people I know don&#39;t have the stamina to reopen bug reports, especially if
they aren&#39;t bold enough to know that they know the problem better than the
ones caring for bug reports: It should be the opposite.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On an unrelated note, if you are so inclined, retry using PAR 0.952
&gt; which might have a slightly different way of handling dlls.
</div>
I will, although I can&#39;t say when, but as soon as I can.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When answering, always keep in mind that the one you are answering to is
&gt; also working on this in his spare time, so let&#39;s keep the tone down.
</div>
If you don&#39;t care about fixing par then you are free to ignore bug reports.
If you don&#39;t like the tone and this is the reason for not fixing bugs, then
par stays as bad a product as it is. It might be that that is fine to you,
and me, and everybody else, or might be a bad state of affairs. Its not my
choice to make.

Remember that its my spare time, too, and I invested far more time on this
problem than you, giving a detailed bug report and being open to explain
more if need be.

I was not asking you to invest your spare time - you either give it, or if
you don&#39;t want to give it, stay out of bug business. The only thing I ask
is to not suppress valid bug reports &#40;I am not saying that this is case
here, of course!&#41;.

If you don&#39;t honor this either and think its ok to frustrate people
investing _their_ time to help, you might just as well ignore any bug
reports.

Thank you for investing your time.

-- 
                The choice of a
      -----==-     _GNU_
      ----==-- _       generation     Marc Lehmann
      ---==---&#40;_&#41;__  __ ____  __      pcg@goof.com
      --==---/ / _ \/ // /\ \/ /      <span class="clickylink"><a target="new" rel="nofollow" href="http://schmorp.de/">http://schmorp.de/</a></span>
      -=====/_/_//_/\_,_/ /_/\_\      XX11-RIPE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;01&nbsp;08:32:04&nbsp;2006</span>
    <span class="description">audreyt [...] audreyt.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> mlehmann [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 1 Sep 2006 20:31:53 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PAR [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Audrey Tang&#34; &lt;audreyt.org [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">2006/9/1, Marc Lehmann via RT &lt;bug-PAR@rt.cpan.org&gt;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Right, I am the only one who managed to package gtk+ with perl on windows
&gt; so far, to my knowledge, and I had to work around some other par bugs
&gt; &#40;such as adding its own defective entry to @INC _multiple_ times during
&gt; program execution&#41; but thats not the actual problem.
</div>
Hi Marc!  First, I&#39;ve send you a commit bit for
<span class="clickylink"><a target="new" rel="nofollow" href="http://svn.openfoundry.org/par/">http://svn.openfoundry.org/par/</a></span>. :-&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; On an unrelated note, if you are so inclined, retry using PAR 0.952
&gt; &gt; which might have a slightly different way of handling dlls.
</div>&gt;
&gt; I will, although I can&#39;t say when, but as soon as I can.
</div>
In fact, the Glib.dll problem &#40;DynaLoader-specific name mangling defeats
third-party shared object loading&#41; is the same as the Wx.dll problem we
diagnosed and resolved on PAR 0.952, so there&#39;s a high probability that
it&#39;s already resolved.

If not, please send me a one-liner that exhibits the problem &#40;pp -e &#34;...&#34;&#41;;
I&#39;m quite willing to investigate some more.  If you&#39;d like to trace it, the
logic is in PAR.pm line 671 as of PAR 0.952.

Thanks!
Audrey
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;03&nbsp;05:35:29&nbsp;2006</span>
    <span class="description">perl [...] nevcal.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Steffen Müller via RT &lt;bug-PAR [...] rt.cpan.org&gt;,  par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 03 Oct 2006 02:35:04 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Glenn Linderman &lt;perl [...] NevCal.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On approximately 9/1/2006 2:53 AM, came the following characters from 
the keyboard of Marc Lehmann:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Right, I am the only one who managed to package gtk+ with perl on windows
&gt; so far, to my knowledge, and I had to work around some other par bugs
&gt; &#40;such as adding its own defective entry to @INC _multiple_ times during
&gt; program execution&#41; but thats not the actual problem.
&gt;
&gt; The actual problem is and stays that par &#40;version 1.52&#41; does not correctly
&gt; package perl modules using xs and shared objects.
&gt;
&gt; In case it matters, here is what I do a as workaround:
&gt;
&gt; 1. par keeps  alot of crust in @INC leading to clashes if a user has a
&gt; different but incompatible pelr installed:
&gt;
&gt;       @INC = grep ref, @INC; # weed out all paths except pars loader refs
&gt;
&gt; 2. I pre-push my own libdir in @INC, both at BEGIN time as well as on main
&gt; program start, because par pushes its own handler in front of it.
&gt;
&gt; 3. I manually package all Glib and gtk2-module related files into my own
&gt; hierarchy. No @INC handler required, no renaming required, simply works.
&gt;   
</div>Well, I finally found a few minutes tonight while waiting for something 
else, to see if I could get ImageMagick working with PAR in a similar 
manner.  I have a couple questions about what you do for #2 and #3.

3. Do you use a -A file that lists all the pieces of GTK for reference 
in the pp command?  How do you deal with relative vs absolute path 
names, and where/how do you target the location of the extracted 
pieces?  Do you move them under your build environment so you can 
reference them relative, and let them get unpacked under inc, or maybe a 
level lower?

2. Does &#34;pre-push&#34; mean &#34;unshift&#34;?  And is the path  $ENV{&#39;PAR_TEMP&#39;} . 
&#39;/inc&#39;  ?  Or something way different?

-- 
Glenn -- <span class="clickylink"><a target="new" rel="nofollow" href="http://nevcal.com/">http://nevcal.com/</a></span>
===========================
A protocol is complete when there is nothing left to remove.
-- Stuart Cheshire, Apple Computer, regarding Zero Configuration Networking
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;03&nbsp;06:32:18&nbsp;2006</span>
    <span class="description">schmorp [...] schmorp.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Oct 2006 12:31:53 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Glenn Linderman via RT &lt;bug-PAR [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Oct 03, 2006 at 05:35:30AM -0400, Glenn Linderman via RT &lt;bug-PAR@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Well, I finally found a few minutes tonight while waiting for something 
&gt; else, to see if I could get ImageMagick working with PAR in a similar 
&gt; manner.  I have a couple questions about what you do for #2 and #3.
</div>
Well, according to Audrey, there should not be any problem left - I
unfortunately still did not have time to recheck this with current versions
of PAR, so all I can offer is my &#40;supposedly&#41; outdated solution. Please note
that the real problemc ame from the fact that PAR renamed dll&#39;s so they
couldn&#39;t be found anymore.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 3. Do you use a -A file that lists all the pieces of GTK for reference 
&gt; in the pp command?
</div>
Yes.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; How do you deal with relative vs absolute path names, and where/how do
&gt; you target the location of the extracted pieces?
</div>
The problem arose on windows just because we package gtk+ only there. On
windows, gtk+ doesn&#39;t use absolute paths so there is no problem. On unix, the
problem is immense, as you would have to rewrite lots of config files with
absolute paths in them, something I didn&#39;t try yet.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2. Does &#34;pre-push&#34; mean &#34;unshift&#34;?  And is the path  $ENV{&#39;PAR_TEMP&#39;} . 
&gt; &#39;/inc&#39;  ?  Or something way different?
</div>
This is what I do &#40;slightly simplified, I actually wrote down every
single .dll file manually to exclude the ones not required&#41; to call pp on
windows:

   <span class="clickylink"><a target="new" rel="nofollow" href="http://data.plan9.de/ppwin">http://data.plan9.de/ppwin</a></span>

As you can see, I simply package all Gtk2 and Glib-related files and
libraries manually, which works just fine.

In the binary, I do this at the very beginning:

   <span class="clickylink"><a target="new" rel="nofollow" href="http://txt.schmorp.de/2629b6fdba568e7cda3ed953cbaf8613.txt">http://txt.schmorp.de/2629b6fdba568e7cda3ed953cbaf8613.txt</a></span>

This first checks wether par is running &#40;I found no
good/official/documented way to do this, so take this with a grain of
salt&#41;.

Then I remove all paths from @INC except the one from PAR &#40;because
otherwise perl would try to find dlls at places where it was originally
compiled, not where it is run, and there might be a completely
incompatible version of perl installed there, we rtan into that problem&#41;.

This, again, is not documented or official, so future versions of par might
break,

Then I extract additional files packaged under /root, this is where I put my
own data files and stuff.

Again this uses undocumented functionality &#40;PAR_TEMP&#41; that might not work in
future versions.

I do not use @INC in _that_ project, but I have another win32 project using
par, where I do:

      unshift @INC, $ENV{PAR_TEMP};

in the BEGIN block and:

   unshift @INC, $ENV{PAR_TEMP}
      if %PAR::LibCache;

_directly_ after it, as PAR removes my handler again &#40;just like renaming
dlls, I never found out why it acts this irrationally, and the only thing
that kept me from writing my own wrapper was that I thought it had to be
possible - it cost me two days to work around par :&#41;.

-- 
                The choice of a
      -----==-     _GNU_
      ----==-- _       generation     Marc Lehmann
      ---==---&#40;_&#41;__  __ ____  __      pcg@goof.com
      --==---/ / _ \/ // /\ \/ /      <span class="clickylink"><a target="new" rel="nofollow" href="http://schmorp.de/">http://schmorp.de/</a></span>
      -=====/_/_//_/\_,_/ /_/\_\      XX11-RIPE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;03&nbsp;19:58:55&nbsp;2006</span>
    <span class="description">perl [...] nevcal.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;, Steffen Müller via RT &lt;bug-PAR [...] rt.cpan.org&gt;,  par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 03 Oct 2006 16:58:25 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Glenn Linderman &lt;perl [...] NevCal.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Glenn Linderman &lt;perl [...] NevCal.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On approximately 10/3/2006 2:35 AM, came the following characters from 
the keyboard of Glenn Linderman:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On approximately 9/1/2006 2:53 AM, came the following characters from 
&gt; the keyboard of Marc Lehmann:
<div class="message-stanza open">&gt;&gt; Right, I am the only one who managed to package gtk+ with perl on 
&gt;&gt; windows
&gt;&gt; so far, to my knowledge, and I had to work around some other par bugs
&gt;&gt; &#40;such as adding its own defective entry to @INC _multiple_ times during
&gt;&gt; program execution&#41; but thats not the actual problem.
&gt;&gt;
&gt;&gt; The actual problem is and stays that par &#40;version 1.52&#41; does not 
&gt;&gt; correctly
&gt;&gt; package perl modules using xs and shared objects.
&gt;&gt;
&gt;&gt; In case it matters, here is what I do a as workaround:
&gt;&gt;
&gt;&gt; 1. par keeps  alot of crust in @INC leading to clashes if a user has a
&gt;&gt; different but incompatible pelr installed:
&gt;&gt;
&gt;&gt;       @INC = grep ref, @INC; # weed out all paths except pars loader 
&gt;&gt; refs
&gt;&gt;
&gt;&gt; 2. I pre-push my own libdir in @INC, both at BEGIN time as well as on 
&gt;&gt; main
&gt;&gt; program start, because par pushes its own handler in front of it.
&gt;&gt;
&gt;&gt; 3. I manually package all Glib and gtk2-module related files into my own
&gt;&gt; hierarchy. No @INC handler required, no renaming required, simply works.
&gt;&gt;   
</div>&gt; Well, I finally found a few minutes tonight while waiting for 
&gt; something else, to see if I could get ImageMagick working with PAR in 
&gt; a similar manner.  I have a couple questions about what you do for #2 
&gt; and #3.
&gt;
&gt; 3. Do you use a -A file that lists all the pieces of GTK for reference 
&gt; in the pp command?  How do you deal with relative vs absolute path 
&gt; names, and where/how do you target the location of the extracted 
&gt; pieces?  Do you move them under your build environment so you can 
&gt; reference them relative, and let them get unpacked under inc, or maybe 
&gt; a level lower?
</div>So I tried this; and it works to some extent, but the .dll files do not 
get unpacked into the tree I set up under inc.  There must be some 
overriding logic that prevents .dll files from being unpacked; it is 
likely the same logic that caused the problem in the first place.  Did 
you have to add code to unpack all the .dll files, or is there some pp 
switch I am missing that would override that logic, and unpack my .dll 
files?
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2. Does &#34;pre-push&#34; mean &#34;unshift&#34;?  And is the path  $ENV{&#39;PAR_TEMP&#39;} 
&gt; . &#39;/inc&#39;  ?  Or something way different?
</div>So I told it to put all the ImageMagick files in &#34;im/&#34; so I  

unshift @INC, $ENV{&#39;PAR_TEMP&#39;} . &#39;\\inc\\im&#39;;

That seems reasonable to me, but I haven&#39;t gotten everything working, 
either, due to the above problem with .dlls not being extracted, and 
another problem with another package.

-- 
Glenn -- <span class="clickylink"><a target="new" rel="nofollow" href="http://nevcal.com/">http://nevcal.com/</a></span>
===========================
A protocol is complete when there is nothing left to remove.
-- Stuart Cheshire, Apple Computer, regarding Zero Configuration Networking
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;05&nbsp;02:50:16&nbsp;2006</span>
    <span class="description">perl [...] nevcal.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;, Steffen Müller via RT &lt;bug-PAR [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 04 Oct 2006 23:49:39 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Glenn Linderman &lt;perl [...] NevCal.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On approximately 10/3/2006 4:58 PM, came the following characters from 
the keyboard of Glenn Linderman:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On approximately 10/3/2006 2:35 AM, came the following characters from 
&gt; the keyboard of Glenn Linderman:
<div class="message-stanza open">&gt;&gt; On approximately 9/1/2006 2:53 AM, came the following characters from 
&gt;&gt; the keyboard of Marc Lehmann:
<div class="message-stanza open">&gt;&gt;&gt; Right, I am the only one who managed to package gtk+ with perl on 
&gt;&gt;&gt; windows
&gt;&gt;&gt; so far, to my knowledge, and I had to work around some other par bugs
&gt;&gt;&gt; &#40;such as adding its own defective entry to @INC _multiple_ times during
&gt;&gt;&gt; program execution&#41; but thats not the actual problem.
&gt;&gt;&gt;
&gt;&gt;&gt; The actual problem is and stays that par &#40;version 1.52&#41; does not 
&gt;&gt;&gt; correctly
&gt;&gt;&gt; package perl modules using xs and shared objects.
&gt;&gt;&gt;
&gt;&gt;&gt; In case it matters, here is what I do a as workaround:
&gt;&gt;&gt;
&gt;&gt;&gt; 1. par keeps  alot of crust in @INC leading to clashes if a user has a
&gt;&gt;&gt; different but incompatible pelr installed:
&gt;&gt;&gt;
&gt;&gt;&gt;       @INC = grep ref, @INC; # weed out all paths except pars loader 
&gt;&gt;&gt; refs
&gt;&gt;&gt;
&gt;&gt;&gt; 2. I pre-push my own libdir in @INC, both at BEGIN time as well as on 
&gt;&gt;&gt; main
&gt;&gt;&gt; program start, because par pushes its own handler in front of it.
&gt;&gt;&gt;
&gt;&gt;&gt; 3. I manually package all Glib and gtk2-module related files into my own
&gt;&gt;&gt; hierarchy. No @INC handler required, no renaming required, simply works.
&gt;&gt;&gt;   
</div>&gt;&gt; Well, I finally found a few minutes tonight while waiting for 
&gt;&gt; something else, to see if I could get ImageMagick working with PAR in 
&gt;&gt; a similar manner.  I have a couple questions about what you do for #2 
&gt;&gt; and #3.
&gt;&gt;
&gt;&gt; 3. Do you use a -A file that lists all the pieces of GTK for reference 
&gt;&gt; in the pp command?  How do you deal with relative vs absolute path 
&gt;&gt; names, and where/how do you target the location of the extracted 
&gt;&gt; pieces?  Do you move them under your build environment so you can 
&gt;&gt; reference them relative, and let them get unpacked under inc, or maybe 
&gt;&gt; a level lower?
</div>&gt; So I tried this; and it works to some extent, but the .dll files do not 
&gt; get unpacked into the tree I set up under inc.  There must be some 
&gt; overriding logic that prevents .dll files from being unpacked; it is 
&gt; likely the same logic that caused the problem in the first place.  Did 
&gt; you have to add code to unpack all the .dll files, or is there some pp 
&gt; switch I am missing that would override that logic, and unpack my .dll 
&gt; files?
</div>
So here is code to a working work-around for the PAR problem of not 
extracting .dll files that refer to each other in a consistent place so 
that they can find each other.  So for each module that needs to be 
unpacked, -X the module, and then create a -A list for it.  For 
Image::Magick, that would have the following contents:

manual_modules.txt:
c:\perl\site\lib\auto\Image\Magick;lgl\auto\Image\Magick
c:\perl\site\lib\Image\Magick.pm;lgl\Image\Magick.pm

pp ... -X Image::Magick -A manual_modules.txt

This could be done for several modules, if necessary.

Corresponding code to put at the top of packaged script.

sub PAR_fakeout
{ if &#40; $0 =~ m@[.]exe$@ &#41; # must be PAR, eh?
   { @INC = grep ref, @INC; # throw away everything but PAR
     unshift @INC, $ENV{&#39;PAR_TEMP&#39;} . &#39;\\inc\\lgl&#39;;
   }
   return;
}
sub PAR_extract
{ my &#40; $drive, $path, $zip &#41;;
   $zip = PAR::par_handle&#40; $0 &#41;;
   $drive = substr&#40; $ENV{&#39;PAR_TEMP&#39;}, 0, 2 &#41;;
   $path = substr&#40; $ENV{&#39;PAR_TEMP&#39;}, 2 &#41; . &#39;\\inc\\lgl&#39;;
   # return if -f $drive . $path . &#39;\some.dll&#39;;
   $path =~ s@\\@/@g;
   $zip-&gt;extractTree&#40; &#39;lgl&#39;, $path, $drive &#41;;
   return;
}
BEGIN
{ PAR_fakeout&#40;&#41;; # do it at compile time
   PAR_extract&#40;&#41;; # also extract .dll files from inside lgl path
}
PAR_fakeout&#40;&#41;; # and also at run time

PROs:

It works.

It might be a prototype for what a new PAR/pp option could do.

CONs:

It extracts the modules packaged this way on every run.  Depending on 
their size, this may or may not be an issue.  Clearly one _could_ code a 
-f check for a particular .dll file &#40;since they are the ones PAR doesn&#39;t 
extract automatically&#41; and assume that if one is there, they all are. 
Such a check would best be made on the last-to-be-extracted .dll file. 
This would hard code one file name in the above code, a commented form 
of the check is shown in the code.

PAR extracts the non-DLL files, so those wind up getting extracted 
twice.  One could play games enumerating all the various DLL files in 
one directory in the PAR file, and the non-DLL files in another, and 
then when doing the extract of DLLs extract the DLLs into the non-DLL 
directory... but that would exacerbate the next CON.  And it is likely 
that the DLLs dominate the size of such modules anyway, so this CON is 
not nearly as severe as the previous one.

It adds complexity to the build options.  &#39;Twould be better if PAR/pp 
would take an extra option --always_extract_dlls_for Image::Magick that 
would cause them to be extracted along with the other source codes.  Or 
even a switch with global applicability  --always_extract_dlls  that 
would apply to all DLLs, as everything works using this technique, 
unlike the current technique.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; 2. Does &#34;pre-push&#34; mean &#34;unshift&#34;?  And is the path  $ENV{&#39;PAR_TEMP&#39;} 
&gt;&gt; . &#39;/inc&#39;  ?  Or something way different?
</div>&gt; So I told it to put all the ImageMagick files in &#34;im/&#34; so I 
&gt; unshift @INC, $ENV{&#39;PAR_TEMP&#39;} . &#39;\\inc\\im&#39;;
&gt; 
&gt; That seems reasonable to me, but I haven&#39;t gotten everything working, 
&gt; either, due to the above problem with .dlls not being extracted, and 
&gt; another problem with another package.
</div>

-- 
Glenn -- <span class="clickylink"><a target="new" rel="nofollow" href="http://nevcal.com/">http://nevcal.com/</a></span>
===========================
A protocol is complete when there is nothing left to remove.
-- Stuart Cheshire, Apple Computer, regarding Zero Configuration Networking
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;06&nbsp;05:09:36&nbsp;2006</span>
    <span class="description">schmorp [...] schmorp.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 6 Oct 2006 11:08:57 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Glenn Linderman via RT &lt;bug-PAR [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Oct 05, 2006 at 02:50:17AM -0400, Glenn Linderman via RT &lt;bug-PAR@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So here is code to a working work-around for the PAR problem of not 
&gt; extracting .dll files that refer to each other in a consistent place so 
</div>
Now I understand. Your problem is similar, but ultimately different.

My problem wasn&#39;t that dlls aren&#39;t being unpacked, but that they were being
unpacked under the wrong name.

   use Glib; # pull in Glib.dll as _another_ name
   use Gtk2; # pull in Gtk2.dll and Glib.dll, which isn&#39;t anywhere

So the dlls are being loaded and unpacked, but under the wrong name.

Packaging Glib.dll manually did not work either, as Gtk2 would refer to
Glib.dll and Glib would refer to the &lt;md5&gt;.dll copy, resulting in crashes.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; CONs:
&gt; 
&gt; It extracts the modules packaged this way on every run.  Depending on 
</div>
It should be made to use the cache par assumingly provides &#40;I could never
get the cache to work, so I do not use caching, but in theory that would
alleviate the speed problems&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -f check for a particular .dll file &#40;since they are the ones PAR doesn&#39;t 
</div>
From what I read, par internally should do this, so when implementing
such an option it could be taken care of. So the switch would trade a
&#40;possibly&#41; slower first-time startup with a faster second-time startup.

-- 
                The choice of a
      -----==-     _GNU_
      ----==-- _       generation     Marc Lehmann
      ---==---&#40;_&#41;__  __ ____  __      pcg@goof.com
      --==---/ / _ \/ // /\ \/ /      <span class="clickylink"><a target="new" rel="nofollow" href="http://schmorp.de/">http://schmorp.de/</a></span>
      -=====/_/_//_/\_,_/ /_/\_\      XX11-RIPE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;06&nbsp;12:37:52&nbsp;2006</span>
    <span class="description">perl [...] nevcal.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Glenn Linderman via RT &lt;bug-PAR [...] rt.cpan.org&gt;,  par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 06 Oct 2006 09:37:24 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Glenn Linderman &lt;perl [...] NevCal.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On approximately 10/6/2006 2:08 AM, came the following characters from 
the keyboard of Marc Lehmann:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu, Oct 05, 2006 at 02:50:17AM -0400, Glenn Linderman via RT &lt;bug-PAR@rt.cpan.org&gt; wrote:
&gt;   
<div class="message-stanza open">&gt;&gt; So here is code to a working work-around for the PAR problem of not 
&gt;&gt; extracting .dll files that refer to each other in a consistent place so 
&gt;&gt;     
</div>&gt; Now I understand. Your problem is similar, but ultimately different.
&gt;
&gt; My problem wasn&#39;t that dlls aren&#39;t being unpacked, but that they were being
&gt; unpacked under the wrong name.
&gt;
&gt;    use Glib; # pull in Glib.dll as _another_ name
&gt;    use Gtk2; # pull in Gtk2.dll and Glib.dll, which isn&#39;t anywhere
&gt;
&gt; So the dlls are being loaded and unpacked, but under the wrong name.
&gt;
&gt; Packaging Glib.dll manually did not work either, as Gtk2 would refer to
&gt; Glib.dll and Glib would refer to the &lt;md5&gt;.dll copy, resulting in crashes.
&gt;   
</div>Well, my understanding is that ImageMagick is kind of like your Gtk2... 
it pulls in the first .dll file, which goes looking for the rest of 
them, and they are nowhere to be found.  The first one is unpacked as a 
temp file, so it cannot be found in the lib\auto\Image\Magick directory 
when looking at the par_cache area after the fact, either.  But looking 
for a file of its size in the par_cache area, one can compare and 
discover that that first .dll does get extracted... but it can&#39;t find 
its siblings &#40;which aren&#39;t referenced via standard Perl autoload 
techniques&#41; by their proper names in the same directory as the first .dll.

So I guess that is slightly different, but curing the &#34;different name&#34; 
and &#34;different location&#34; problems would seem to help us both.  So I&#39;m 
not at all sure what you have done to cure your problem.  From what you 
said, I thought I was doing what you did up until the need to actually 
extract the .dlls to the right place.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; CONs:
&gt;&gt;
&gt;&gt; It extracts the modules packaged this way on every run.  Depending on 
&gt;&gt;     
</div>&gt; It should be made to use the cache par assumingly provides &#40;I could never
&gt; get the cache to work, so I do not use caching, but in theory that would
&gt; alleviate the speed problems&#41;.
&gt;   
</div>If you are referring to the on-disk cache under $ENV{&#39;PAR_TEMP&#39;}, that 
is where I expected the Image::Magick .dlls to be extracted to.  And 
some versions of PAR actually did it, and over time with &#34;fixed&#34; so that 
they didn&#39;t anymore.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; -f check for a particular .dll file &#40;since they are the ones PAR doesn&#39;t 
&gt;&gt;     
</div>&gt;
&gt; From what I read, par internally should do this, so when implementing
&gt; such an option it could be taken care of. So the switch would trade a
&gt; &#40;possibly&#41; slower first-time startup with a faster second-time startup.
&gt;
&gt;   
</div>Well, yes, it does, for files that it actually unpacks, which doesn&#39;t 
include the &#34;other&#34; ImageMagick .dll files as far as I can determine... 
there are a bunch of .dll files in the par cache, but not enough of the 
right byte size to be the ImageMagick ones.

-- 
Glenn -- <span class="clickylink"><a target="new" rel="nofollow" href="http://nevcal.com/">http://nevcal.com/</a></span>
===========================
A protocol is complete when there is nothing left to remove.
-- Stuart Cheshire, Apple Computer, regarding Zero Configuration Networking
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;13&nbsp;15:16:08&nbsp;2006</span>
    <span class="description">schmorp [...] schmorp.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> par [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #13508] cannot find Glib.dll on win32, despite being packaged in the exe</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 13 Oct 2006 21:15:28 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Audrey Tang via RT &lt;bug-PAR [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Marc Lehmann &lt;schmorp [...] schmorp.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Sep 01, 2006 at 08:32:05AM -0400, Audrey Tang via RT &lt;bug-PAR@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In fact, the Glib.dll problem &#40;DynaLoader-specific name mangling defeats
&gt; third-party shared object loading&#41; is the same as the Wx.dll problem we
&gt; diagnosed and resolved on PAR 0.952, so there&#39;s a high probability that
&gt; it&#39;s already resolved.
</div>
I installed par-0.956 and modified my script &#40;which worked fine with
earlier versions of par&#41;, to:

- no longer -X Gtk2 -X Glib
- no longer include Glib.dll, Glib.pm etc. files for Glib and Gtk2

and promptly got the same problem again: Glib.dll not found. On closer
inspection, Glib.dll is now indeed packaged, but still not found.

Likely this is because it is not in the PATH, nor whereever Gtk2.dll
expects it &#40;namely in shlib/Glib.dll, while par packages it into
lib/auto/Glib/Glib.dll&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If not, please send me a one-liner that exhibits the problem &#40;pp -e &#34;...&#34;&#41;;
</div>
I have no idea how to make a one-liner, because I still have to package all
the libraries, and this makes it longer than the valid line length on
windows.

I would guess the moral equivalent that exhibits the problem is:

   pp -e &#34;use Gtk2&#34;

running under an environment not having perl but everything else &#40;libgtk
etc.&#41;.

This would stop because Gtk2 can&#39;t find Glib.dll

-- 
                The choice of a
      -----==-     _GNU_
      ----==-- _       generation     Marc Lehmann
      ---==---&#40;_&#41;__  __ ____  __      pcg@goof.com
      --==---/ / _ \/ // /\ \/ /      <span class="clickylink"><a target="new" rel="nofollow" href="http://schmorp.de/">http://schmorp.de/</a></span>
      -=====/_/_//_/\_,_/ /_/\_\      XX11-RIPE
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;02&nbsp;20:13:20&nbsp;2007</span>
    <span class="description">mgrimes [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> MGRIMES [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">These fixes have been extremely helpful. Thanks Marc in particular. I
have put some of this into a package and tweaked Marc&#39;s ppwin script,
both of which I am attaching in case someone else might find them useful.

I still have one problem though. I am using Gtk2::GladeXML to implement
the interface. Using Marc&#39;s kludge, I have been successful in getting
the pp&#39;ed app to run displaying the interface, but once I run    
signal_autoconnect_from_package I get the following error:


Can&#39;t locate object method &#34;signal_connect&#34; via package &#34;Gtk2::Button&#34;
at Gtk2/GladeXML.pm line 40.

There is not Gtk2/Button.pm file on my system or in the par archive, so
this doesn&#39;t appear to be just a matter of adding that to the -A addfile
list. I really don&#39;t know the inner workings of Gtk2 to understand where
things are going wrong. If I comment out that one line from my app, the
interface comes up beautifully &#40;although it obviously doesn&#39;t do anything&#41;.

Any guidance from the experts?

Thanks,
Mark
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">package PAR::GTK2Kludge;

# This is a package implementing the fix discovered by Marc Lehmann. Thanks
# for sharing this solution; I would have never figured this out!
# The original can be found at: <span class="clickylink"><a target="new" rel="nofollow" href="http://txt.schmorp.de/2629b6fdba568e7cda3ed953cbaf8613.txt">http://txt.schmorp.de/2629b6fdba568e7cda3ed953cbaf8613.txt</a></span>

use strict;
use warnings;

our $VERSION = &#39;0.20&#39;;

BEGIN {
	my $dbg; for&#40;@ARGV&#41;{ $dbg++ if /^-d|^--debug/;}

	print &#34;Running kludge\n&#34; if $dbg;
	if &#40;%PAR::LibCache&#41; {
		print &#34;kludging\n&#34; if $dbg;
		@INC = grep ref, @INC; # weed out all paths except pars loader refs

			while &#40;my &#40;$filename, $zip&#41; = each %PAR::LibCache&#41; {
				for &#40;$zip-&gt;memberNames&#41; {
					next unless m!^root/&#40;.*&#41;!;
					print &#34;zip: $_\n&#34; if $dbg;
					$zip-&gt;extractMember &#40;$_, &#34;$ENV{PAR_TEMP}/$1&#34;&#41;
						unless -e &#34;$ENV{PAR_TEMP}/$1&#34;;
				}
			}

		if &#40;$^O eq &#34;MSWin32&#34;&#41; {
			$ENV{GTK_RC_FILES} = &#34;$ENV{PAR_TEMP}/share/themes/MS-Windows/gtk-2.0/gtkrc&#34;;
		}

		print &#34;Inc:\n&#34;, join&#40;&#34;\n&#34;,@INC&#41;,&#34;\n&#34; if $dbg;
		print &#34;Temp:\n&#34;, $ENV{PAR_TEMP},&#34;\n&#34; if $dbg;
		print &#34;Path:\n&#34;, $ENV{PATH},&#34;\n&#34; if $dbg;
		
		print &#34;Chdir to $ENV{PAT_TEMP}\n&#34; if $dbg;
		chdir $ENV{PAR_TEMP} if $ENV{PAR_TEMP};
	}
}

1;

__END__
# Below is stub documentation for your module. You&#39;d better edit it!

=head1 NAME

PACKAGE - Perl extension for blah blah blah

=head1 SYNOPSIS

  use PACKAGE;
  blah blah blah

=head1 DESCRIPTION

Stub documentation for PACKAGE, created by h2xs. It looks like the
author of the extension was negligent enough to leave the stub
unedited.

Blah blah blah.

=head2 EXPORT

None by default.



=head1 SEE ALSO

Mention other useful documentation such as the documentation of
related modules or operating system documentation &#40;such as man pages
in UNIX&#41;, or any relevant external documentation such as RFCs or
standards.

If you have a mailing list set up for your module, mention it here.

If you have a web site set up for your module, mention it here.

=head1 AUTHOR

mgrimes, E&lt;lt&gt;mgrimes at cpan dot org&lt;gt&gt;

=head1 COPYRIGHT AND LICENSE

Copyright &#40;C&#41; 2006 by mgrimes

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself, either Perl version 5.8.2 or,
at your option, any later version of Perl 5 you may have available.


=cut

</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;07&nbsp;01:46:22&nbsp;2008</span>
    <span class="description">Martin.Schlemmer [...] nwu.ac.za -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Martin.Schlemmer [...] nwu.ac.za</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have the same problem, and resolved it with the patch from bug #32589,
and adding the DLLs via the -l switch &#40;I do not package all the Gtk+
files, as I use a merge module with my installers&#41;.  I also use
Gtk2::GladeXML, which also needed to be added to the patch to work. 

Patch for reference and sample script I use to build the executables
attached.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/perl/bin/perl -w

use strict;

use FindBin;
use pp;

my $version = &#39;1.0.0&#39;;
my $script = &#34;$FindBin::Bin/test.pl&#34;;
my @libs = qw&#40;
	Cairo/Cairo.dll
	Glib/Glib.dll
	Gtk2/Gtk2.dll
	Gtk2/GladeXML/GladeXML.dll
&#41;;

@ARGV = &#40;&#41;;

push &#40;@ARGV, &#39;-z&#39;&#41;;
push &#40;@ARGV, &#39;9&#39;&#41;;
push &#40;@ARGV, &#39;--gui&#39;&#41;;
push &#40;@ARGV, &#39;-N&#39;&#41;;
push &#40;@ARGV, &#34;ProductVersion=$version&#34;&#41;;
push &#40;@ARGV, &#39;-N&#39;&#41;;
push &#40;@ARGV, &#34;FileVersion=$version&#34;&#41;;

for my $file &#40;@libs&#41; {
	for my $dir &#40;@INC&#41; {
		my $lib = &#34;$dir/auto/$file&#34;;
		
		if &#40;-f $lib&#41; {
			push &#40;@ARGV, &#39;-l&#39;&#41;;
			push &#40;@ARGV, $lib&#41;;
			last;
		}
	}
}

push &#40;@ARGV, &#39;-o&#39;&#41;;
push &#40;@ARGV, &#34;$FindBin::Bin/test.exe&#34;&#41;;
push &#40;@ARGV, &#34;$script&#34;&#41;;

pp-&gt;go&#40;&#41;;

</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -uprN Module-ScanDeps-0.82/lib/Module/ScanDeps.pm Module-ScanDeps-0.82.az/lib/Module/ScanDeps.pm
--- Module-ScanDeps-0.82/lib/Module/ScanDeps.pm	2008-01-28 18:28:03.000000000 +0200
+++ Module-ScanDeps-0.82.az/lib/Module/ScanDeps.pm	2008-01-31 20:57:34.000000000 +0200
@@ -914,6 +914,7 @@ sub add_deps {
             my &#40;$path, $basename&#41; = &#40;$1, $2&#41;;
 
             foreach &#40;_glob_in_inc&#40;&#34;auto/$path&#34;&#41;&#41; {
+				next if $_-&gt;{file} =~ m{&#40;Glib&#41;|&#40;Cairo&#41;|&#40;Gtk2&#41;|&#40;GladeXML&#41;} and $^O eq &#39;MSWin32&#39;;
                 next if $_-&gt;{file} =~ m{\bauto/$path/.*/};  # weed out subdirs
                 next if $_-&gt;{name} =~ m/&#40;?:^|\/&#41;\.&#40;?:exists|packlist&#41;$/;
                 my $ext = lc&#40;$1&#41; if $_-&gt;{name} =~ /&#40;\.[^.]+&#41;$/;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;31&nbsp;21:33:13&nbsp;2012</span>
    <span class="description">mzhou [...] cse.unsw.edu.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> mzhou [...] cse.unsw.edu.au</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">We solved this problem for Biodiverse &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://biodiverse.googlecode.co">http://biodiverse.googlecode.co</a></span>&#41; 
by patching PAR to extract DLLs with their original names instead of 
CRCs. I&#39;m aware that names are much more likely to crash than CRCs, so 
perhaps an option embedded into the .exe when pp builds it could choose 
between whether to use name or CRC?



On Thu Feb 07 01:46:22 2008, azarah wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have the same problem, and resolved it with the patch from bug 
</div>#32589,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; and adding the DLLs via the -l switch &#40;I do not package all the Gtk+
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; files, as I use a merge module with my installers&#41;.  I also use
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Gtk2::GladeXML, which also needed to be added to the patch to work. 
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Patch for reference and sample script I use to build the executables
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; attached.
</div></div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Heavy.pm.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Heavy.pm	2011-12-02 15:15:22.000000000 +1100
+++ Heavy.pm	2012-10-30 16:25:52.124835500 +1100
@@ -145,7 +145,7 @@
     else {
         $filename = File::Spec-&gt;catfile&#40;
             &#40;$ENV{PAR_TEMP} || File::Spec-&gt;tmpdir&#41;,
-            &#40;$name || &#40;$member-&gt;crc32String . &#34;.$DynaLoader::dl_dlext&#34;&#41;&#41;
+            &#40;$name || &#40;&#40;File::Spec-&gt;splitpath &#40;$member-&gt;fileName&#41;&#41;[-1]&#41;&#41;
         &#41;;
         &#40;$filename&#41; = $filename =~ /^&#40;[\x20-\xff]+&#41;$/;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;04&nbsp;12:46:19&nbsp;2012</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2012-10-31 21:33:13, mzhou wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We solved this problem for Biodiverse &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://biodiverse.googlecode.co">http://biodiverse.googlecode.co</a></span>&#41; 
&gt; by patching PAR to extract DLLs with their original names instead of 
&gt; CRCs. I&#39;m aware that names are much more likely to crash than CRCs, so 
&gt; perhaps an option embedded into the .exe when pp builds it could choose 
&gt; between whether to use name or CRC?
</div>
The last thing PAR or PAR::Packer needs is another option!
The correct solution is to stop extracting DLLs with CRC names
altogether. Recent versions of PAR::Packer will extract any DLL
with its full pathname anyway - except for the &#34;embedded&#34; ones
&#40;cf. PAR::Tutorial&#41; which are extracted in stage 2 of the bootstrap
of a packed executable. If this could be modified to use full
pathnames, too, the whole CRC names thing could be removed.
This would probably also remove the need for PAR to muck 
with DynaLoader.

Cheers, Roderich 
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
