<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #40692 for Yahoo-Marketing-APT: Yahoo/Marketing/DateTimeAccessor.pm causes invalid dateTime fields &#40;E1021&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #40692 for Yahoo-Marketing-APT: Yahoo/Marketing/DateTimeAccessor.pm causes invalid dateTime fields &#40;E1021&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Yahoo-Marketing-APT/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Yahoo-Marketing-APT/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Yahoo-Marketing-APT/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Yahoo-Marketing-APT/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Yahoo-Marketing-APT">Yahoo-Marketing-APT CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">40692</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Yahoo-Marketing-APT/Active/">Yahoo-Marketing-APT</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
noel [...] burton-krahn.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-224020-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-224021-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;05&nbsp;13:32:44&nbsp;2008</span>
    <span class="description">noel [...] burton-krahn.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Yahoo/Marketing/DateTimeAccessor.pm causes invalid dateTime fields &#40;E1021&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 5 Nov 2008 10:32:22 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Yahoo-Marketing-APT [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Noel Burton-Krahn&#34; &lt;noel [...] burton-krahn.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I called  getHistoricalDataForKeywords, and kept getting an E1021 error.  I
tracked the problem down to DateTimeAccessor, and fixed it by
converting DateTime objects to formatted strings.  My fix and example
code are below.

Regards,

Noel Burton-Krahn
noel@burton-krahn.com


software versions:

        This is perl, v5.8.8 built for i486-linux-gnu-thread-multi
        Yahoo::Marketing 4.30
        SOAP::Lite 0.710.08

The old Yahoo/Marketing/DateTimeAccessor.pm.  Converting to DateTime and
calling set_formatter results in invalid dateTime structs in XML.

        sub _force_datetime_object {
            my &#40; $self, $value &#41; = @_;

            if&#40; defined $value &#41;{
                unless&#40; ref $value &#41;{  # not a date time object
                    $value = DateTime::Format::ISO8601-&gt;new-&gt;parse_datetime&#40; $value &#41;;
                }
                # let&#39;s hope it looks like a duck... er, DateTime object
                $value-&gt;set_formatter&#40; DateTime::Format::W3CDTF-&gt;new &#41;;
            }

            return $value;
        }

The fixed Yahoo/Marketing/DateTimeAccessor.pm.

        sub _force_datetime_object {
            my &#40; $self, $value &#41; = @_;

            if&#40; defined $value &#41;{
                unless&#40; ref $value &#41;{  # not a date time object
                    $value = DateTime::Format::ISO8601-&gt;new-&gt;parse_datetime&#40; $value &#41;;
                }
                # NBK - 2008-11-05 - convert the value to a string like
                # YYYY-mm-ddTHH:MM:SS+zz:zz.  If it&#39;s left as a DateTime
                # object, SOAP::Lite encode it as an unparseable DateTime
                # struct in XML.
                $value = DateTime::Format::W3CDTF-&gt;new-&gt;format_datetime&#40;$value&#41;;
            }

            return $value;
        }



Sample code to reproduce:

        use SOAP::Lite;
        SOAP::Lite-&gt;import&#40;+trace =&gt; &#39;all&#39;&#41;;
        my $endDate = DateTime-&gt;now-&gt;subtract&#40;days =&gt; 1&#41;;
        my $startDate = DateTime-&gt;now-&gt;subtract&#40;months =&gt; 3&#41;;
        my $service = $self-&gt;config_service&#40;Yahoo::Marketing::ForecastService-&gt;new&#41;;
        my $result = $service-&gt;getHistoricalDataForKeywords&#40;
                keywords =&gt; [
                        Yahoo::Marketing::HistoricalKeyword-&gt;new
                        -&gt;keyword&#40;$keyword&#41;
                ],
                historicalRequestData =&gt; Yahoo::Marketing::HistoricalRequestData-&gt;new
                -&gt;accountID&#40;$cfg-&gt;{ews_account_id}&#41;
                -&gt;matchTypes&#40;[qw&#40;AdvancedMatch&#41;]&#41;
                -&gt;marketID&#40;$marketID&#41;
                -&gt;startDate&#40;$startDate&#41;
                -&gt;endDate&#40;$endDate&#41;
                &#41;;

XML sent to Yahoo.  The startDate and endDate structs are not valid
dateTimes:

        SOAP::Transport::HTTP::Client::send_receive: POST
<span class="clickylink"><a target="new" rel="nofollow" href="https://ews11.marketing.ews.yahooapis.com:443/services/V4/ForecastService">https://ews11.marketing.ews.yahooapis.com:443/services/V4/ForecastService</a></span>
HTTP/1.1
        Accept: text/xml
        Accept: multipart/*
        Accept: application/soap
        Content-Length: 1752
        Content-Type: text/xml; charset=utf-8
        SOAPAction:


        &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
        &lt;soap:Envelope xmlns:namesp1=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://namespaces.soaplite.com/perl">http://namespaces.soaplite.com/perl</a></span>&#34;
soap:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34;
xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;
xmlns:ysm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34;&gt;
          &lt;soap:Header&gt;
            &lt;wsse:Security xmlns:wsse=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/ws/2002/04/secext">http://schemas.xmlsoap.org/ws/2002/04/secext</a></span>&#34;&gt;
              &lt;wsse:UsernameToken soapenc:arrayType=&#34;xsd:string[2]&#34;
xsi:type=&#34;soapenc:Array&#34;&gt;
                &lt;wsse:Username xsi:type=&#34;xsd:string&#34;&gt;USERNAME&lt;/wsse:Username&gt;
                &lt;wsse:Password xsi:type=&#34;xsd:string&#34;&gt;PASSWORD&lt;/wsse:Password&gt;
              &lt;/wsse:UsernameToken&gt;
            &lt;/wsse:Security&gt;
            &lt;license xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;
xsi:type=&#34;xsd:string&#34;&gt;06E1D3B637E57AEF&lt;/license&gt;
            &lt;masterAccountID xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;
xsi:type=&#34;xsd:string&#34;&gt;1121899&lt;/masterAccountID&gt;
          &lt;/soap:Header&gt;
          &lt;soap:Body&gt;
            &lt;getHistoricalDataForKeywords
xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;&gt;
              &lt;keywords xsi:type=&#34;tns:ArrayOfHistoricalKeyword&#34;&gt;
                &lt;HistoricalKeyword&gt;
                  &lt;keyword xsi:type=&#34;xsd:string&#34;&gt;gadgets&lt;/keyword&gt;
                &lt;/HistoricalKeyword&gt;
              &lt;/keywords&gt;
              &lt;historicalRequestData xsi:type=&#34;tns:HistoricalRequestData&#34;&gt;
                &lt;accountID xsi:type=&#34;xsd:string&#34;&gt;9857894300&lt;/accountID&gt;
                &lt;endDate href=&#34;#ref-2008&#34; xsi:type=&#34;xsd:dateTime&#34; /&gt;
                &lt;marketID xsi:type=&#34;xsd:string&#34;&gt;US&lt;/marketID&gt;
                &lt;matchTypes xsi:type=&#34;tns:ArrayOfKeywordForecastMatchType&#34;&gt;
                  &lt;KeywordForecastMatchType
xsi:type=&#34;xsd:string&#34;&gt;AdvancedMatch&lt;/KeywordForecastMatchType&gt;
                &lt;/matchTypes&gt;
                &lt;startDate href=&#34;#ref-2008&#34; xsi:type=&#34;xsd:dateTime&#34; /&gt;
              &lt;/historicalRequestData&gt;
            &lt;/getHistoricalDataForKeywords&gt;
            &lt;DateTime xsi:type=&#34;namesp1:DateTime&#34; id=&#34;ref-2008&#34;&gt;
              &lt;local_rd_secs xsi:type=&#34;xsd:int&#34;&gt;64197&lt;/local_rd_secs&gt;
              &lt;local_rd_days xsi:type=&#34;xsd:int&#34;&gt;733259&lt;/local_rd_days&gt;
              &lt;locale href=&#34;#ref-142707740&#34;
xsi:type=&#34;namesp1:DateTime__Locale__en_US&#34; /&gt;
              &lt;rd_nanosecs xsi:type=&#34;xsd:int&#34;&gt;0&lt;/rd_nanosecs&gt;
              &lt;utc_rd_secs xsi:type=&#34;xsd:int&#34;&gt;64197&lt;/utc_rd_secs&gt;
              &lt;local_c href=&#34;#ref-178882332&#34; /&gt;
              &lt;formatter href=&#34;#ref-178882476&#34;
xsi:type=&#34;namesp1:DateTime__Format__W3CDTF&#34; /&gt;
              &lt;utc_year xsi:type=&#34;xsd:int&#34;&gt;2009&lt;/utc_year&gt;
              &lt;tz href=&#34;#ref-178882524&#34; xsi:type=&#34;namesp1:DateTime__TimeZone__UTC&#34; /&gt;
              &lt;offset_modifier xsi:type=&#34;xsd:int&#34;&gt;0&lt;/offset_modifier&gt;
              &lt;utc_rd_days xsi:type=&#34;xsd:int&#34;&gt;733259&lt;/utc_rd_days&gt;
            &lt;/DateTime&gt;
            &lt;DateTime__Locale__en_US
xsi:type=&#34;namesp1:DateTime__Locale__en_US&#34; id=&#34;ref-142707740&#34;&gt;
              &lt;default_time_format_length
xsi:type=&#34;xsd:string&#34;&gt;medium&lt;/default_time_format_length&gt;
              &lt;native_territory xsi:type=&#34;xsd:string&#34;&gt;United States&lt;/native_territory&gt;
              &lt;native_language xsi:type=&#34;xsd:string&#34;&gt;English&lt;/native_language&gt;
              &lt;native_complete_name xsi:type=&#34;xsd:string&#34;&gt;English United
States&lt;/native_complete_name&gt;
              &lt;en_language xsi:type=&#34;xsd:string&#34;&gt;English&lt;/en_language&gt;
              &lt;id xsi:type=&#34;xsd:string&#34;&gt;en_US&lt;/id&gt;
              &lt;default_date_format_length
xsi:type=&#34;xsd:string&#34;&gt;medium&lt;/default_date_format_length&gt;
              &lt;en_complete_name xsi:type=&#34;xsd:string&#34;&gt;English United
States&lt;/en_complete_name&gt;
              &lt;en_territory xsi:type=&#34;xsd:string&#34;&gt;United States&lt;/en_territory&gt;
            &lt;/DateTime__Locale__en_US&gt;
          &lt;/soap:Body&gt;
        &lt;/soap:Envelope&gt;

XML fault returned from Yahoo

        SOAP::Transport::HTTP::Client::send_receive: HTTP/1.1 500 Internal Server Error
        Connection: close
        Date: Wed, 05 Nov 2008 17:49:53 GMT
        Content-Type: text/xml;charset=UTF-8
        Client-Date: Wed, 05 Nov 2008 17:49:58 GMT
        Client-Peer: 72.30.33.57:443
        Client-Response-Num: 1
        Client-SSL-Cert-Issuer: /C=US/O=Equifax/OU=Equifax Secure Certificate Authority
        Client-SSL-Cert-Subject: /C=US/ST=California/L=Santa Clara/O=Yahoo!
Inc./OU=Yahoo/CN=*.marketing.ews.yahooapis.com
        Client-SSL-Cipher: DHE-RSA-AES256-SHA
        Client-SSL-Warning: Peer certificate not verified
        Client-Transfer-Encoding: chunked
        P3P: policyref=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://p3p.yahoo.com/w3c/p3p.xml">http://p3p.yahoo.com/w3c/p3p.xml</a></span>&#34;, CP=&#34;CAO DSP COR
CUR ADM DEV TAI PSA PSD IVAi IVDi CONi TELo OTPi OUR DELi SAMi OTRi
UNRi PUBi IND PHY ONL UNI PUR FIN COM NAV INT DEM CNT STA POL HEA PRE
GOV&#34;
        X-Powered-By: Servlet 2.4; JBoss-4.0.2 &#40;build: CVSTag=JBoss_4_0_2
date=200505022023&#41;/Tomcat-5.5

        
        &lt;soap:Envelope xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34;
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34;
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;
          &lt;soap:Header&gt;
            &lt;yns:sid xmlns:yns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;&gt;sk1-1adsrvcs-003.ysm.sk1.yahoo.com&lt;/yns:sid&gt;
            &lt;yns:stime xmlns:yns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;&gt;Wed
Nov 05 09:49:53 PST 2008&lt;/yns:stime&gt;
          &lt;/soap:Header&gt;
          &lt;soap:Body&gt;
            &lt;soap:Fault&gt;
              &lt;faultcode&gt;soap:Client&lt;/faultcode&gt;
              &lt;faultstring&gt;Invalid parameter.&lt;/faultstring&gt;
              &lt;detail&gt;
                &lt;yns:ApiFault xmlns:yns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;&gt;
                  &lt;yns:code xmlns:yns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;&gt;E1021&lt;/yns:code&gt;
                  &lt;yns:message
xmlns:yns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;&gt;Invalid
parameter.&lt;/yns:message&gt;
                &lt;/yns:ApiFault&gt;
              &lt;/detail&gt;
            &lt;/soap:Fault&gt;
          &lt;/soap:Body&gt;
        &lt;/soap:Envelope&gt;
        SOAP::Deserializer::deserialize: &#40;&#41;
        SOAP::Parser::decode: &#40;&#41;
        SOAP::SOM::new: &#40;&#41;
        SOAP::SOM::DESTROY: &#40;&#41;
        error calling module: SOAP FAULT!

fixed XML sent to Yahoo with fix:

        SOAP::Transport::HTTP::Client::send_receive: POST
<span class="clickylink"><a target="new" rel="nofollow" href="https://ews11.marketing.ews.yahooapis.com:443/services/V4/ForecastService">https://ews11.marketing.ews.yahooapis.com:443/services/V4/ForecastService</a></span>
HTTP/1.1
        Accept: text/xml
        Accept: multipart/*
        Accept: application/soap
        Content-Length: 1752
        Content-Type: text/xml; charset=utf-8
        SOAPAction:

        &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
        &lt;soap:Envelope xmlns:namesp1=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://namespaces.soaplite.com/perl">http://namespaces.soaplite.com/perl</a></span>&#34;
soap:encodingStyle=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
xmlns:soap=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/envelope/">http://schemas.xmlsoap.org/soap/envelope/</a></span>&#34;
xmlns:soapenc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/soap/encoding/">http://schemas.xmlsoap.org/soap/encoding/</a></span>&#34;
xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;
xmlns:ysm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;
xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34;&gt;
          &lt;soap:Header&gt;
            &lt;wsse:Security xmlns:wsse=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://schemas.xmlsoap.org/ws/2002/04/secext">http://schemas.xmlsoap.org/ws/2002/04/secext</a></span>&#34;&gt;
              &lt;wsse:UsernameToken soapenc:arrayType=&#34;xsd:string[2]&#34;
xsi:type=&#34;soapenc:Array&#34;&gt;
                &lt;wsse:Username xsi:type=&#34;xsd:string&#34;&gt;USERNAME&lt;/wsse:Username&gt;
                &lt;wsse:Password xsi:type=&#34;xsd:string&#34;&gt;PASSWORD&lt;/wsse:Password&gt;
              &lt;/wsse:UsernameToken&gt;
            &lt;/wsse:Security&gt;
            &lt;license xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;
xsi:type=&#34;xsd:string&#34;&gt;06E1D3B637E57AEF&lt;/license&gt;
            &lt;masterAccountID xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;
xsi:type=&#34;xsd:string&#34;&gt;1121899&lt;/masterAccountID&gt;
          &lt;/soap:Header&gt;
          &lt;soap:Body&gt;
            &lt;getHistoricalDataForKeywords
xmlns=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://marketing.ews.yahooapis.com/V4">http://marketing.ews.yahooapis.com/V4</a></span>&#34;&gt;
              &lt;keywords xsi:type=&#34;tns:ArrayOfHistoricalKeyword&#34;&gt;
                &lt;HistoricalKeyword&gt;
                  &lt;keyword xsi:type=&#34;xsd:string&#34;&gt;gadgets&lt;/keyword&gt;
                &lt;/HistoricalKeyword&gt;
              &lt;/keywords&gt;
              &lt;historicalRequestData xsi:type=&#34;tns:HistoricalRequestData&#34;&gt;
                &lt;accountID xsi:type=&#34;xsd:string&#34;&gt;9857894300&lt;/accountID&gt;
                &lt;endDate xsi:type=&#34;xsd:dateTime&#34;&gt;2008-11-04T18:11:20Z&lt;/endDate&gt;
                &lt;marketID xsi:type=&#34;xsd:string&#34;&gt;US&lt;/marketID&gt;
                &lt;matchTypes xsi:type=&#34;tns:ArrayOfKeywordForecastMatchType&#34;&gt;
                  &lt;KeywordForecastMatchType
xsi:type=&#34;xsd:string&#34;&gt;AdvancedMatch&lt;/KeywordForecastMatchType&gt;
                &lt;/matchTypes&gt;
                &lt;startDate xsi:type=&#34;xsd:dateTime&#34;&gt;2008-08-05T18:11:20Z&lt;/startDate&gt;
              &lt;/historicalRequestData&gt;
            &lt;/getHistoricalDataForKeywords&gt;
          &lt;/soap:Body&gt;
        &lt;/soap:Envelope&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;13:18:59&nbsp;2009</span>
    <span class="description">SHENJ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">thanks for reporting the bug and providing a fix.

this bug is also reported in the ticket: 
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=40434">http://rt.cpan.org/Public/Bug/Display.html?id=40434</a></span>

and it&#39;s resolved in Yahoo::Marketing version 4.31.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;13:19:00&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;10&nbsp;13:19:00&nbsp;2009</span>
    <span class="description">SHENJ [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
