<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #16863 for GDGraph: No / misplaced y-ticks for two_axes</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #16863 for GDGraph: No / misplaced y-ticks for two_axes</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/GDGraph/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/GDGraph/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/GDGraph/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/GDGraph/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/GDGraph">GDGraph CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p>There are plenty of good ideas of what people can do published here on the queue. Turning a patch from the tracker into a pull request is not one of them. In order to get maintainers' attention way more quickier, PR should have at least a sample included. We know it's hard to test images generating software, but it doesn't mean we can not test numbers produced by intermediate algorithms used to generate these images, so either a test or a sample.</p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">16863</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/GDGraph/Active/">GDGraph</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">bwarfield [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
etimme [...] gmail.com

<br />
janne [...] janne.nu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-14346-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.4305    </td>
  </tr>
  <tr id="CF-14347-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.4308    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




sample95.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/191644/69559/sample95.png">
Mon May 01 12:43:43 2006 (8.9k) by Guest
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;02&nbsp;06:42:41&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> No / misplaced y-ticks for two_axes</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When drawing y-ticks the axis number is submitted as dataset number. This has to be adjusted by adding 1, otherwise the pixels will be calculated to way off the canvas.

GDGraph-1.4305/Graph/axestype.pm
1056c1056
&lt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, $axis&#41;;
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, $axis + 1&#41;;
</div>
This is perl, v5.8.7 built for i386-linux

Linux pc1183 2.6.12-12mdk #1 Fri Sep 9 18:15:22 CEST 2005 i686 Intel&#40;R&#41; Pentium&#40;R&#41; 4 CPU 2.66GHz unknown GNU/Linux

/ Jan Sundberg
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;02&nbsp;09:16:52&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> janne [...] janne.nu</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[guest - Mon Jan  2 06:42:41 2006]:

It&#39;s more complicated than that:

- when calculating ticks for y2 one has to be sure min &#38; max comes from
$self-&gt;y_min[2] and $self-&gt;y_max[2] and *not* go via use_axis!

One solution is to supply negative argument when calculating ticks for y2:

GDGraph-1.4305/Graph/axestype.pm
1056c1056
&lt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, $axis&#41;;
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, -$axis&#41;;
</div>1883c1883,1885
&lt;               ? $self-&gt;{y_min}[$self-&gt;{use_axis}[$i-1]]
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;               ? $i &lt; 0 ?
&gt;                   $self-&gt;{y_min}[-$i]
&gt;                   : $self-&gt;{y_min}[$self-&gt;{use_axis}[$i-1]]
</div>1887c1889,1891
&lt;               ? $self-&gt;{y_max}[$self-&gt;{use_axis}[$i-1]]
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;               ? $i &lt; 0
&gt;                   ? $self-&gt;{y_max}[-$i]
&gt;                   : $self-&gt;{y_max}[$self-&gt;{use_axis}[$i-1]]
</div>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When drawing y-ticks the axis number is submitted as dataset number.
&gt;    This has to be adjusted by adding 1, otherwise the pixels will be
&gt;    calculated to way off the canvas.
&gt; 
&gt; GDGraph-1.4305/Graph/axestype.pm
&gt; 1056c1056
&gt; &lt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, $axis&#41;;
&gt; ---
<div class="message-stanza open">&gt; &gt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, $axis + 1&#41;;
</div>&gt; 
&gt; This is perl, v5.8.7 built for i386-linux
&gt; 
&gt; Linux pc1183 2.6.12-12mdk #1 Fri Sep 9 18:15:22 CEST 2005 i686
&gt;    Intel&#40;R&#41; Pentium&#40;R&#41; 4 CPU 2.66GHz unknown GNU/Linux
&gt; 
&gt; / Jan Sundberg
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;19&nbsp;00:04:02&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">First off, I&#39;m sorry I didn&#39;t reply to this already—I hadn&#39;t spotted it, and I didn&#39;t get an e-mail 
about it.  Could you possibly provide some code &#40;modifying sample95.pl might be easiest&#41; 
that demonstrates the precise nature of the bug?  I&#39;m not fully understanding it from your 
description,  and the few things I&#39;ve tried by way of attempting to break the tick-mark code 
haven&#39;t produced any problems that seem to match &#40;though I observe that range calculations 
are broken, which may be closely related&#41;.


On Mon Jan 02 09:16:52 2006, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [guest - Mon Jan  2 06:42:41 2006]:
&gt; 
&gt; It&#39;s more complicated than that:
&gt; 
&gt; - when calculating ticks for y2 one has to be sure min &#38; max comes from
&gt; $self-&gt;y_min[2] and $self-&gt;y_max[2] and *not* go via use_axis!
&gt; 
&gt; One solution is to supply negative argument when calculating ticks for y2:
&gt; 
&gt; GDGraph-1.4305/Graph/axestype.pm
&gt; 1056c1056
&gt; &lt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, $axis&#41;;
&gt; ---
<div class="message-stanza open">&gt; &gt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, -$axis&#41;;
</div>&gt; 1883c1883,1885
&gt; &lt;               ? $self-&gt;{y_min}[$self-&gt;{use_axis}[$i-1]]
&gt; ---
<div class="message-stanza open">&gt; &gt;               ? $i &lt; 0 ?
&gt; &gt;                   $self-&gt;{y_min}[-$i]
&gt; &gt;                   : $self-&gt;{y_min}[$self-&gt;{use_axis}[$i-1]]
</div>&gt; 1887c1889,1891
&gt; &lt;               ? $self-&gt;{y_max}[$self-&gt;{use_axis}[$i-1]]
&gt; ---
<div class="message-stanza open">&gt; &gt;               ? $i &lt; 0
&gt; &gt;                   ? $self-&gt;{y_max}[-$i]
&gt; &gt;                   : $self-&gt;{y_max}[$self-&gt;{use_axis}[$i-1]]
</div>&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;19&nbsp;00:04:03&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;19&nbsp;04:00:46&nbsp;2006</span>
    <span class="description">janne [...] janne.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I haven&#39;t able to produce an example where the misplaced ticks occur.
When I tried &#40;by 100-folding the second and third dataset, i.e. y2 axis,
in sample95.pl&#41; I got:

[5] Maximum for y2 too small at sample95.pl line 91 at sample95.pl line 91.

which can be related to my other bug report &#40;16880&#41;, I&#39;ll have to check
later.

Regarding this one, I&#39;m simply saying that in draw_y_ticks_v, iteration
is performed over the two axes in order to process both axes but the
axis number supplied to val_to_pixel is interpreted as a dataset number!

There has to be a way to tell val_to_pixel to use a specific axis, and
not to go via use_axis all the time, since you want to process the two
axes, not the two first datasets.

I chose the simple way indicating an axis number with a negative number
and a dataset number with a positive.


On Thu Jan 19 00:04:02 2006, BWARFIELD wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; First off, I&#39;m sorry I didn&#39;t reply to this already—I hadn&#39;t spotted
&gt; it, and I didn&#39;t get an e-mail
&gt; about it.  Could you possibly provide some code &#40;modifying sample95.pl
&gt; might be easiest&#41;
&gt; that demonstrates the precise nature of the bug?  I&#39;m not fully
&gt; understanding it from your
&gt; description,  and the few things I&#39;ve tried by way of attempting to
&gt; break the tick-mark code
&gt; haven&#39;t produced any problems that seem to match &#40;though I observe
&gt; that range calculations
&gt; are broken, which may be closely related&#41;.
&gt; 
&gt; 
&gt; On Mon Jan 02 09:16:52 2006, guest wrote:
<div class="message-stanza open">&gt; &gt; [guest - Mon Jan  2 06:42:41 2006]:
&gt; &gt;
&gt; &gt; It&#39;s more complicated than that:
&gt; &gt;
&gt; &gt; - when calculating ticks for y2 one has to be sure min &#38; max comes
</div>&gt; from
<div class="message-stanza open">&gt; &gt; $self-&gt;y_min[2] and $self-&gt;y_max[2] and *not* go via use_axis!
&gt; &gt;
&gt; &gt; One solution is to supply negative argument when calculating ticks
</div>&gt; for y2:
<div class="message-stanza open">&gt; &gt;
&gt; &gt; GDGraph-1.4305/Graph/axestype.pm
&gt; &gt; 1056c1056
&gt; &gt; &lt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, $axis&#41;;
&gt; &gt; ---
<div class="message-stanza open">&gt; &gt; &gt;             my &#40;$x, $y&#41; = $self-&gt;val_to_pixel&#40;0, $value, -$axis&#41;;
</div>&gt; &gt; 1883c1883,1885
&gt; &gt; &lt;               ? $self-&gt;{y_min}[$self-&gt;{use_axis}[$i-1]]
&gt; &gt; ---
<div class="message-stanza open">&gt; &gt; &gt;               ? $i &lt; 0 ?
&gt; &gt; &gt;                   $self-&gt;{y_min}[-$i]
&gt; &gt; &gt;                   : $self-&gt;{y_min}[$self-&gt;{use_axis}[$i-1]]
</div>&gt; &gt; 1887c1889,1891
&gt; &gt; &lt;               ? $self-&gt;{y_max}[$self-&gt;{use_axis}[$i-1]]
&gt; &gt; ---
<div class="message-stanza open">&gt; &gt; &gt;               ? $i &lt; 0
&gt; &gt; &gt;                   ? $self-&gt;{y_max}[-$i]
&gt; &gt; &gt;                   : $self-&gt;{y_max}[$self-&gt;{use_axis}[$i-1]]
</div>&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;11&nbsp;18:28:58&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;01&nbsp;12:43:43&nbsp;2006</span>
    <span class="description">Guest - Ticket #19012:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> problem with y2 tick scale labeling with two_axes / use_axis</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">y2 tick scale labeling issue with GD::Graph 1.4307. Data plotted against
the y2 axis will scale correctly in the graph, however labels will not
be plotted correctly. The y2max value will be obeyed, but it seems to
draw values relative to the y1 axis.

IE y1max is 40, y2max is 8, y_tick_number is 8, y_label_skip is 2, the
y2 labels will draw 2, 4, 6, 8, and these will be visually below our
first line &#40;which is y1 axis&#39;s 10&#41;, or missing if y2max is larger than
y1max.

This bug might be related to 16863 &#34;No / misplaced y-ticks for two_axes&#34;.

To replicate modify sample95.pl as follows:

#   use_axis            =&gt; [1, 2, 2],
    use_axis            =&gt; [1, 1, 2],

Note, [ 1, 2, 1 ] seems to work correctly.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> sample95.png</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/191644/69559/sample95.png">Download sample95.png</a><br />
<span class="downloadcontenttype">image/png 8.9k</span>
</div>
<div class="messagebody">
<img alt="sample95.png" title="sample95.png" src="/Ticket/Attachment/191644/69559/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;01&nbsp;17:10:39&nbsp;2006</span>
    <span class="description">Guest - Ticket #19012:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> etimme [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Problem is definetly the same as in the previous report mentioned in the
original post.

Bug is in GD::Graph::axestype.pm draw_y_ticks_h and draw_y_ticks_v and
their interaction with val_to_pixel, which expects a dataset as its
third parameter. We pass it an &#34;axis&#34;, so sometimes it works &#40;when our
second data set has an &#34;use_axis&#34; value of 2, like in the examples&#41; and
sometimes it does not &#40;when our second data set has an &#34;use_axis&#34; value
of 1&#41;.

I chose to create a new function val_axis_to_pixel that is called only
by draw_y_ticks_h and draw_y_ticks_v. I then changed the y_min and y_max
calculations as follows :

    my $y_min = $self-&gt;{two_axes}
        ? $self-&gt;{y_min}[$i]
        : $self-&gt;{y_min}[1];

    my $y_max = $self-&gt;{two_axes}
        ? $self-&gt;{y_max}[$i]
        : $self-&gt;{y_max}[1];

There were no other changes as compared to val_to_pixel.

I have not tested the solution posted in the previous bug thread by
janne@janne.nu &#40;pass a negative value to val_to_pixel&#41; but it looks like
it does the same thing without defining a new function.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;01&nbsp;17:10:41&nbsp;2006</span>
    <span class="description">The RT System itself - Ticket #19012:  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;01&nbsp;17:15:22&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> etimme [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 19 04:00:46 2006, janne@janne.nu wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I haven&#39;t able to produce an example where the misplaced ticks occur.
</div>
I&#39;ve posted an example of the bug with a screenshot in bug #19012 with
my own explanation. That bug is the same as the one in this thread, and
is probably fixed by janne@janne.nu&#39;s patch.

val_to_pixel should be passed a data set, not an axis, as its third
parameter. When we are drawing axes we pass &#34;1&#34; when we are drawing y1,
and &#34;2&#34; when we are drawing y2. If your second data set has an
&#34;use_axis&#34; value of &#34;2&#34; &#40;as in all examples&#41; this bug will not show up.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;14&nbsp;23:53:40&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org - Ticket #19012:  Merged into ticket #16863</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;14&nbsp;23:53:40&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Merged into ticket #16863</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;15&nbsp;22:54:37&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Well, an ideal solution to this would probably be changing val_to_pixel so that it expects &#40;and all 
of the calls to it so that it *gets*&#41; an axis number instead of a dataset number.  On the other 
hand, that would require roughly 23 code changes, and the negative-number approach takes 
only three, so for now I&#39;ll use that one &#40;since it&#39;s all internal, it&#39;s theoretically possible I&#39;ll change 
it to work the other way at some future point, if it seems like a good idea&#41;.  Thanks very much 
to you both!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;15&nbsp;22:54:39&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;May&nbsp;18&nbsp;15:00:53&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Fixed in 1.4308 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
