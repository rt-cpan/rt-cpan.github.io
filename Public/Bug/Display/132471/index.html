<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #132471 for Unicode-Char: Will not work in 5.32 going forward</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #132471 for Unicode-Char: Will not work in 5.32 going forward</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Unicode-Char/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Unicode-Char/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Unicode-Char/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Unicode-Char/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Unicode-Char">Unicode-Char CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">132471</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Unicode-Char/Active/">Unicode-Char</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
khw [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39486-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39487-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;11:42:24&nbsp;2020</span>
    <span class="description">khw [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Will not work in 5.32 going forward</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This module reads lib/unicore/Name.pl.  That file is an core-perl-internal file, and its format has changed, so the module now fails.  Since Perl v5.16, there has been an alternative method for getting this information.  And the recipe to do so is already written out for you.,

perldoc Unicode::UCD

look for the &#34;Getting every available name&#34; description.  Here it is for your convenience

  my &#40;%name, %cp, %cps, $n&#41;;
  # All codepoints
  foreach my $cat &#40;qw&#40; Name Name_Alias &#41;&#41; {
      my &#40;$codepoints, $names, $format, $default&#41; = prop_invmap&#40;$cat&#41;;
      # $format =&gt; &#34;n&#34;, $default =&gt; &#34;&#34;
      foreach my $i &#40;0 .. @$codepoints - 2&#41; {
          my &#40;$cp, $n&#41; = &#40;$codepoints-&gt;[$i], $names-&gt;[$i]&#41;;
          # If $n is a ref, the same codepoint has multiple names
          foreach my $name &#40;ref $n ? @$n : $n&#41; {
              $name{$cp} //= $name;
              $cp{$name} //= $cp;
          }
      }
  }
  # Named sequences
  {   my %ns = namedseq&#40;&#41;;
      foreach my $name &#40;sort { $ns{$a} cmp $ns{$b} } keys %ns&#41; {
          $cp{$name} //= [ map { ord } split &#34;&#34; =&gt; $ns{$name} ];
      }
  }

It may be there are bugs in the earlier versions of Unicode::UCD.  Or there might not be.  But you could do the Name.pl thing on versions 5.30 and earlier, and the above recipe for later.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;12:30:04&nbsp;2020</span>
    <span class="description">khw [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #132471]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 1 May 2020 10:28:44 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Unicode-Char [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karl Williamson &lt;khw [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Grepping CPAN, it appears Encode also reads Name.pl
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;22:17:50&nbsp;2020</span>
    <span class="description">DANKOGAI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I took a look at the repository and found reading lib/unicore/Name.pl has already been useless. whoa!

* it is only used by bin/enc2xs
  * in there it is used to init @uname &#40;by &#38;char_names&#41; where $uname[$xxxx] returns the name of the 
U+xxxx
  * and it adds the name to the ucm **COMMENT** if available.

as a matter of fact char_names&#40;&#41; is already a noop!  Run the code below and see what happens.

    use strict;
    use warnings;
    use Data::Dumper;
    
    my @uname;
    
    sub char_names
    {
     my $s = do &#34;unicore/Name.pl&#34;;
     die &#34;char_names: unicore/Name.pl: $!\n&#34; unless defined $s;
     pos&#40;$s&#41; = 0;
     while &#40;$s =~ /\G&#40;[0-9a-f]+&#41;\t&#40;[0-9a-f]*&#41;\t&#40;.*?&#41;\s*\n/igc&#41;
      {
       my $name = $3;
       my $s = hex&#40;$1&#41;;
       last if $s &gt;= 0x10000;
       my $e = length&#40;$2&#41; ? hex&#40;$2&#41; : $s;
       for &#40;my $i = $s; $i &lt;= $e; $i++&#41;
        {
         $uname[$i] = $name;
         #print sprintf&#40;&#34;U%04X $name\n&#34;,$i&#41;;                                        
        }
      }
    }
    
    char_names&#40;&#41;;
    warn Dumper \@uname;

So it is safe to remove the definition and usage of &#38;char_names.

Dan the Maintainer Thereof

On Fri May 01 11:42:24 2020, khw wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This module reads lib/unicore/Name.pl.  That file is an core-perl-
&gt; internal file, and its format has changed, so the module now fails.
&gt; Since Perl v5.16, there has been an alternative method for getting
&gt; this information.  And the recipe to do so is already written out for
&gt; you.,
&gt; 
&gt; perldoc Unicode::UCD
&gt; 
&gt; look for the &#34;Getting every available name&#34; description.  Here it is
&gt; for your convenience
&gt; 
&gt; my &#40;%name, %cp, %cps, $n&#41;;
&gt; # All codepoints
&gt; foreach my $cat &#40;qw&#40; Name Name_Alias &#41;&#41; {
&gt;     my &#40;$codepoints, $names, $format, $default&#41; = prop_invmap&#40;$cat&#41;;
&gt;     # $format =&gt; &#34;n&#34;, $default =&gt; &#34;&#34;
&gt;     foreach my $i &#40;0 .. @$codepoints - 2&#41; {
&gt;         my &#40;$cp, $n&#41; = &#40;$codepoints-&gt;[$i], $names-&gt;[$i]&#41;;
&gt;         # If $n is a ref, the same codepoint has multiple names
&gt;         foreach my $name &#40;ref $n ? @$n : $n&#41; {
&gt;             $name{$cp} //= $name;
&gt;             $cp{$name} //= $cp;
&gt;         }
&gt;     }
&gt; }
&gt; # Named sequences
&gt; {   my %ns = namedseq&#40;&#41;;
&gt;     foreach my $name &#40;sort { $ns{$a} cmp $ns{$b} } keys %ns&#41; {
&gt;         $cp{$name} //= [ map { ord } split &#34;&#34; =&gt; $ns{$name} ];
&gt;     }
&gt; }
&gt; 
&gt; It may be there are bugs in the earlier versions of Unicode::UCD.  Or
&gt; there might not be.  But you could do the Name.pl thing on versions
&gt; 5.30 and earlier, and the above recipe for later.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;22:17:51&nbsp;2020</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;22:38:07&nbsp;2020</span>
    <span class="description">DANKOGAI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have made &#38;char_names of bin/enc2xs officially a no-op.

    sub char_names{} # cf. <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=132471">https://rt.cpan.org/Ticket/Display.html?id=132471</a></span>

and VERSION++&#39;ed.

Dan the Maintainer Thereof
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;22:38:08&nbsp;2020</span>
    <span class="description">DANKOGAI [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;02&nbsp;20:13:03&nbsp;2020</span>
    <span class="description">jkeenan [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri May 01 22:38:07 2020, DANKOGAI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have made &#38;char_names of bin/enc2xs officially a no-op.
&gt; 
&gt;     sub char_names{} # cf. <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=132471">https://rt.cpan.org/Ticket/Display.html?id=132471</a></span>
&gt; 
&gt; and VERSION++&#39;ed.
&gt; 
&gt; Dan the Maintainer Thereof8ced1423dbb2a874f2d95e9c5c4c46960c2bf318
</div>
Thanks. Encode v3.06 merged into perl 5 blead 8ced1423dbb2a874f2d95e9c5c4c46960c2bf318.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
