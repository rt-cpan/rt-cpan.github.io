<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #43694 for Math-BigInt: The as_int&#40;&#41; method on BigFloat objects loses precision on integers</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #43694 for Math-BigInt: The as_int&#40;&#41; method on BigFloat objects loses precision on integers</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Math-BigInt">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Math-BigInt">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Math-BigInt">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Math-BigInt">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Math-BigInt">Math-BigInt CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">43694</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Math-BigInt">Math-BigInt</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
emazep [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-20500-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.89    </td>
  </tr>
  <tr id="CF-20501-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Math-BigInt-1.96-patch-id-43694.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/850318/440234/Math-BigInt-1.96-patch-id-43694.txt">
Tue Nov 02 16:08:39 2010 (1.3k) by peter.john.acklam [...] gmail.com
</a>
</font></li>
</ul>


perl-V.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/570841/287937/perl-V.txt">
Fri Feb 27 04:33:22 2009 (2.6k) by emazep [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=43694">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-570841" href="/Public/Bug/Display.html?id=43694#txn-570841">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;27&nbsp;04:33:22&nbsp;2009</span>
    <span class="description">emazep [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> The as_int&#40;&#41; method on BigFloat objects loses precision on integers</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/570841/287934/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/287934">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 264b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The as_int&#40;&#41; method on BigFloat objects loses precision even on integer
values, while it shouldn&#39;t:

perl -MMath::BigFloat -e &#39;print
Math::BigFloat-&gt;new&#40;&#39;1234567890987654321&#39;&#41;-&gt;as_int, &#34;\n&#34;&#39;
# 1234567890987650000

Thanks for your invaluable work,
Emanuele Zeppieri
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> perl-V.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/570841/287937/perl-V.txt">Download perl-V.txt</a><br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Summary of my perl5 &#40;revision 5 version 10 subversion 0 patch 34065&#41; configuration:
  Platform:
    osname=cygwin, osvers=1.5.25&#40;0.15642&#41;, archname=cygwin-thread-multi-64int
    uname=&#39;cygwin_nt-5.1 reini 1.5.25&#40;0.15642&#41; 2008-06-12 19:34 i686 cygwin &#39;
    config_args=&#39;-de -Dmksymlinks -Dusethreads -Dmad=y -Dusedevel&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=define, usemultiplicity=define
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=define, use64bitall=undef, uselongdouble=undef
    usemymalloc=y, bincompat5005=undef
  Compiler:
    cc=&#39;gcc&#39;, ccflags =&#39;-DPERL_USE_SAFE_PUTENV -U__STRICT_ANSI__ -fno-strict-aliasing -pipe -I/usr/local/include&#39;,
    optimize=&#39;-O3&#39;,
    cppflags=&#39;-DPERL_USE_SAFE_PUTENV -U__STRICT_ANSI__ -fno-strict-aliasing -pipe -I/usr/local/include&#39;
    ccversion=&#39;&#39;, gccversion=&#39;3.4.4 &#40;cygming special, gdc 0.12, using dmd 0.125&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
    ivtype=&#39;long long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;g++&#39;, ldflags =&#39; -Wl,--enable-auto-import -Wl,--export-all-symbols -Wl,--stack,8388608 -Wl,--enable-auto-image-base -L/usr/local/lib&#39;
    libpth=/usr/local/lib /usr/lib /lib
    libs=-lgdbm -ldb -ldl -lcrypt -lgdbm_compat
    perllibs=-ldl -lcrypt
    libc=/usr/lib/libc.a, so=dll, useshrplib=true, libperl=libperl.a
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=dll, d_dlsymun=undef, ccdlflags=&#39; &#39;
    cccdlflags=&#39; &#39;, lddlflags=&#39; --shared  -Wl,--enable-auto-import -Wl,--export-all-symbols -Wl,--stack,8388608 -Wl,--enable-auto-image-base -L/usr/local/lib&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: MULTIPLICITY MYMALLOC PERL_DONT_CREATE_GVSV
                        PERL_IMPLICIT_CONTEXT PERL_MAD PERL_MALLOC_WRAP
                        PERL_USE_SAFE_PUTENV USE_64_BIT_INT USE_ITHREADS
                        USE_LARGE_FILES USE_PERLIO USE_REENTRANT_API
  Locally applied patches:
	MAINT34065
	CYG11 no-bs
	CYG12 no archlib in otherlibdirs
	CYG14 Dynaloader
	CYG15 static-Win32CORE
	Bug#55162 File::Spec::case_tolerant performance
  Built under cygwin
  Compiled at Jun 30 2008 16:05:15
  %ENV:
    CYGWIN=&#34;&#34;
  @INC:
    /usr/lib/perl5/5.10/i686-cygwin
    /usr/lib/perl5/5.10
    /usr/lib/perl5/site_perl/5.10/i686-cygwin
    /usr/lib/perl5/site_perl/5.10
    /usr/lib/perl5/vendor_perl/5.10/i686-cygwin
    /usr/lib/perl5/vendor_perl/5.10
    /usr/lib/perl5/vendor_perl/5.10
    /usr/lib/perl5/site_perl/5.8
    /usr/lib/perl5/vendor_perl/5.8
    .
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-850234" href="/Public/Bug/Display.html?id=43694#txn-850234">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;02&nbsp;10:46:07&nbsp;2010</span>
    <span class="description">peter.john.acklam [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/850234/440188/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/440188">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The problem can be traced to the second last line of the as_number&#40;&#41;
method in Math::BigFloat. The line is

  $z = Math::BigInt-&gt;new&#40; $x-&gt;{sign} . $MBI-&gt;_num&#40;$z&#41;&#41;;

Before this line $z = [987654321, 234567890, 1] on my computer. It might
be different on other computers, depending on $BASE, but it will be
something equivalent. So far, so good.

Now, $MBI-&gt;_num&#40;$z&#41; returns the Perl scalar 1.23456789098765e+18, which
is then used to construct a Math::BigInt object with the value
1234567890987650000. Clearly, using $MBI-&gt;_num&#40;$z&#41; here is a mistake.

I&#39;m not really sure whether the main problem is in the code or the
documentation. The name as_number&#40;&#41; suggests that returning a Perl
scalar is the right thing, whereas the name as_int&#40;&#41; suggests that
returning a Math::BigInt &#40;or a Perl scalar integer&#41; is the right thing.

This bug is two years&#40;!&#41; old, so it&#39;s time to fix it. I don&#39;t have a
patch yet, but I&#39;ll write one. In the meantime, it would be nice if the
maintainers did some maintaining. I have written six patches over the
last few weeks. So far I have not received any feedback on any of the
patches from any of the maintainers. Has maintenance stalled?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-850237" href="/Public/Bug/Display.html?id=43694#txn-850237">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;02&nbsp;10:46:07&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-850318" href="/Public/Bug/Display.html?id=43694#txn-850318">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;02&nbsp;16:08:39&nbsp;2010</span>
    <span class="description">peter.john.acklam [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/850318/440233/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/440233">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 264b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This bug was introduced in version 1.70.

In Math::BigFloat -&gt; as_number&#40;&#41; I changed _num&#40;&#41; to _str&#40;&#41;. The former
returns a Perl scalar, but the latter returns a string, preserving all
digits. I also added a test to confirms the correct behaviour.

Patch included.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Math-BigInt-1.96-patch-id-43694.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/850318/440234/Math-BigInt-1.96-patch-id-43694.txt">Download Math-BigInt-1.96-patch-id-43694.txt</a><br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ur Math-BigInt-1.96-orig/lib/Math/BigFloat.pm Math-BigInt-1.96-patched-id-43694/lib/Math/BigFloat.pm
--- Math-BigInt-1.96-orig/lib/Math/BigFloat.pm	2010-09-28 06:34:04.000000000 +0200
+++ Math-BigInt-1.96-patched-id-43694/lib/Math/BigFloat.pm	2010-11-02 21:01:44.171875000 +0100
@@ -3693,7 +3693,7 @@
     {
     $MBI-&gt;_lsft&#40; $z, $x-&gt;{_e},10&#41;;
     }
-  $z = Math::BigInt-&gt;new&#40; $x-&gt;{sign} . $MBI-&gt;_num&#40;$z&#41;&#41;;
+  $z = Math::BigInt-&gt;new&#40; $x-&gt;{sign} . $MBI-&gt;_str&#40;$z&#41;&#41;;
   $z;
   }
 
diff -ur Math-BigInt-1.96-orig/t/bigfltpm.inc Math-BigInt-1.96-patched-id-43694/t/bigfltpm.inc
--- Math-BigInt-1.96-orig/t/bigfltpm.inc	2010-09-13 16:28:42.000000000 +0200
+++ Math-BigInt-1.96-patched-id-43694/t/bigfltpm.inc	2010-11-02 20:26:02.968750000 +0100
@@ -587,6 +587,7 @@
 -2:-2
 -123.456:-123
 -200:-200
+71243225429896467497217836789578596379:71243225429896467497217836789578596379
 # test for bug in brsft&#40;&#41; not handling cases that return 0
 0.000641:0
 0.0006412:0
diff -ur Math-BigInt-1.96-orig/t/bigfltpm.t Math-BigInt-1.96-patched-id-43694/t/bigfltpm.t
--- Math-BigInt-1.96-orig/t/bigfltpm.t	2010-09-13 16:28:42.000000000 +0200
+++ Math-BigInt-1.96-patched-id-43694/t/bigfltpm.t	2010-11-02 21:02:18.453125000 +0100
@@ -1,7 +1,7 @@
 #!/usr/bin/perl -w
 
 use strict;
-use Test::More tests =&gt; 2316
+use Test::More tests =&gt; 2317
     + 5;		# own tests
 
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-850325" href="/Public/Bug/Display.html?id=43694#txn-850325">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;02&nbsp;16:28:31&nbsp;2010</span>
    <span class="description">jonathan [...] leto.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Florian Ragwitz &lt;rafl [...] debian.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43694] The as_int&#40;&#41; method on BigFloat objects loses precision on integers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 2 Nov 2010 13:28:08 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Math-BigInt [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jonathan Leto &lt;jonathan [...] leto.net&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/850325/440241/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/440241">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Howdy Peter,

Thanks for all of your bug reports recently. Maintenance hasn&#39;t
stalled, but the current
maintainers of these modules, myself included, don&#39;t have copious free
time to hack
on it. Perhaps you would like a commit bit on the relevant repos, so
that we are not a
bottleneck towards improving them?

I definitely give you a +1 for a commit bit.

Duke


On Tue, Nov 2, 2010 at 7:46 AM, Peter John Acklam via RT
&lt;bug-Math-BigInt@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: Math-BigInt
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43694">https://rt.cpan.org/Ticket/Display.html?id=43694</a></span> &gt;
&gt;
&gt; The problem can be traced to the second last line of the as_number&#40;&#41;
&gt; method in Math::BigFloat. The line is
&gt;
&gt;  $z = Math::BigInt-&gt;new&#40; $x-&gt;{sign} . $MBI-&gt;_num&#40;$z&#41;&#41;;
&gt;
&gt; Before this line $z = [987654321, 234567890, 1] on my computer. It might
&gt; be different on other computers, depending on $BASE, but it will be
&gt; something equivalent. So far, so good.
&gt;
&gt; Now, $MBI-&gt;_num&#40;$z&#41; returns the Perl scalar 1.23456789098765e+18, which
&gt; is then used to construct a Math::BigInt object with the value
&gt; 1234567890987650000. Clearly, using $MBI-&gt;_num&#40;$z&#41; here is a mistake.
&gt;
&gt; I&#39;m not really sure whether the main problem is in the code or the
&gt; documentation. The name as_number&#40;&#41; suggests that returning a Perl
&gt; scalar is the right thing, whereas the name as_int&#40;&#41; suggests that
&gt; returning a Math::BigInt &#40;or a Perl scalar integer&#41; is the right thing.
&gt;
&gt; This bug is two years&#40;!&#41; old, so it&#39;s time to fix it. I don&#39;t have a
&gt; patch yet, but I&#39;ll write one. In the meantime, it would be nice if the
&gt; maintainers did some maintaining. I have written six patches over the
&gt; last few weeks. So far I have not received any feedback on any of the
&gt; patches from any of the maintainers. Has maintenance stalled?
&gt;
</div>


-- 
Jonathan &#34;Duke&#34; Leto
jonathan@leto.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://leto.net">http://leto.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-850341" href="/Public/Bug/Display.html?id=43694#txn-850341">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;02&nbsp;17:56:01&nbsp;2010</span>
    <span class="description">emazep [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43694] The as_int&#40;&#41; method on BigFloat objects loses precision on integers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 02 Nov 2010 22:55:50 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Math-BigInt [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Emanuele Zeppieri &lt;emazep [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/850341/440252/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/440252">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 474b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2010-11-02 21:08, Peter John Acklam via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43694">https://rt.cpan.org/Ticket/Display.html?id=43694</a></span>&gt;
&gt;
&gt; This bug was introduced in version 1.70.
&gt;
&gt; In Math::BigFloat -&gt;  as_number&#40;&#41; I changed _num&#40;&#41; to _str&#40;&#41;. The former
&gt; returns a Perl scalar, but the latter returns a string, preserving all
&gt; digits. I also added a test to confirms the correct behaviour.
&gt;
&gt; Patch included.
</div>
It seems the correct solution also to me.

Thank you very much Peter!

-Emanuele
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-850534" href="/Public/Bug/Display.html?id=43694#txn-850534">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;03&nbsp;03:01:31&nbsp;2010</span>
    <span class="description">peter.john.acklam [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> jonathan [...] leto.net, rafl [...] debian.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/850534/440355/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/440355">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 624b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">If none of you have time to apply the patch&#40;es&#41;, then I&#39;ll be happy to
do it. When you say &#34;+1 for a commit bit&#34;, are you referring to
git://perl5.git.perl.org/perl.git or some other repo?

Peter

On Tue Nov 02 16:28:31 2010, LETO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Howdy Peter,
&gt; 
&gt; Thanks for all of your bug reports recently. Maintenance hasn&#39;t
&gt; stalled, but the current
&gt; maintainers of these modules, myself included, don&#39;t have copious free
&gt; time to hack
&gt; on it. Perhaps you would like a commit bit on the relevant repos, so
&gt; that we are not a
&gt; bottleneck towards improving them?
&gt; 
&gt; I definitely give you a +1 for a commit bit.
&gt; 
&gt; Duke
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-850576" href="/Public/Bug/Display.html?id=43694#txn-850576">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;03&nbsp;06:27:34&nbsp;2010</span>
    <span class="description">rafl [...] debian.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-Math-BigInt [...] rt.cpan.org, jonathan [...] leto.net</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43694] The as_int&#40;&#41; method on BigFloat objects loses precision on integers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 03 Nov 2010 11:26:25 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> pjacklam [...] online.no</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Florian Ragwitz &lt;rafl [...] debian.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/850576/440385/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/440385">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Peter John Acklam via RT&#34; &lt;bug-Math-BigInt@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If none of you have time to apply the patch&#40;es&#41;, then I&#39;ll be happy to
&gt; do it.
</div>
At least for me, it&#39;s not so much the applying, but the
reviewing. However, reviewing would also be a whole lot easier if there
was a git repository to just fetch from.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When you say &#34;+1 for a commit bit&#34;, are you referring to
&gt; git://perl5.git.perl.org/perl.git or some other repo?
</div>
Handing out commit bits to perl itself unfortunately isn&#39;t quite as easy
as one would hope. However, There&#39;s repositories for all of the bigint
stuff on github.

They all live at <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/rafl">http://github.com/rafl</a></span>, for example
<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/rafl/Math-BigInt">http://github.com/rafl/Math-BigInt</a></span> and
<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/rafl/Math-BigInt-FastCalc">http://github.com/rafl/Math-BigInt-FastCalc</a></span>.

Math-BigRat, the only exception, is at
<span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/leto/Math-BigRat">http://github.com/leto/Math-BigRat</a></span>.

While all the bigint modules actually have the perl core as their
canonical upstream, I&#39;ll be happy to sync changes between the individual
repositories for the CPAN versions and the core, like I&#39;ve been doing in
the past.

If you want, you can get a commit bit for all of those so you can create
branches for the individual issues you&#39;ve been working on. Alternatively
you can just click the Fork button on any of those repositories to get
your own repository of them.

I&#39;d actually prefer the latter, as that requires the contributor to
explicitly tell someone about his changes via private email, or githubs
pull request, or whatever, so they can be pulled in - avoiding the
problem of forgotten branches. However, I&#39;ll be happy to cope with
whatever works for you.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/850576/440386/">Download &#40;untitled&#41;</a><br />
<span class="downloadcontenttype">application/pgp-signature 197b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-855168" href="/Public/Bug/Display.html?id=43694#txn-855168">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;15&nbsp;03:17:35&nbsp;2010</span>
    <span class="description">rafl [...] debian.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.675041</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
