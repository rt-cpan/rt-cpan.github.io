<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #123702 for Net-DNS: &#39;use base&#39; should not be used in packages with several subpackages defined</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #123702 for Net-DNS: &#39;use base&#39; should not be used in packages with several subpackages defined</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-DNS/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-DNS/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">123702</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-DNS/Active/">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
daa [...] open.ch

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.13    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;21&nbsp;10:13:48&nbsp;2017</span>
    <span class="description">daa [...] open.ch -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> &#39;use base&#39; should not be used in packages with several
 subpackages defined</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">We have been debugging a very rarely occurring bug with Net::DNS v1.12 and v1.13 and perl v5.20.

***  FATAL PROGRAM ERROR!!  Unknown instance method &#39;rcode&#39;
        ***  which the program has attempted to call for the object:
        ***
        .       IN      OPT
        ***
        ***  THIS IS A BUG IN THE CALLING SOFTWARE, which incorrectly assumes
        ***  that the object would be of a particular type.  The type of an
        ***  object should be checked before calling any of its methods.
        ***
        Attempt to reload Net/DNS/RR/OPT.pm aborted.
        Compilation failed in require at &#40;eval 172&#41; line 2.
        Net::DNS::RR 1569 at /opt/OSAGperlm/lib/Net/DNS/Header.pm line 172.
        Net::DNS::Header::rcode&#40;Net::DNS::Header=REF&#40;0x32d9580&#41;, &#34;FORMERR&#34;&#41; called at /opt/OSAGperlm/lib/Net/DNS/Packet.pm line 273
        Net::DNS::Packet::reply&#40;Net::DNS::Packet=HASH&#40;0x3eadff8&#41;&#41; called at /opt/OSAGperlm/lib/Net/DNS/Nameserver.pm line 193
        Net::DNS::Nameserver::make_reply&#40;Net::DNS::Nameserver=HASH&#40;0x2ce2410&#41;, Net::DNS::Packet=HASH&#40;0x3eadff8&#41;, &#34;127.0.0.1&#34;, HASH&#40;0x35eca50&#41;&#41; called at /opt/OSAGperlm/lib/Net/DNS/Nameserver.pm line 410
        Net::DNS::Nameserver::udp_connection&#40;Net::DNS::Nameserver=HASH&#40;0x2ce2410&#41;, IO::Socket::INET=GLOB&#40;0x3eb5d08&#41;&#41; called at /opt/OSAGperlm/lib/Net/DNS/Nameserver.pm line 464
        Net::DNS::Nameserver::loop_once&#40;Net::DNS::Nameserver=HASH&#40;0x2ce2410&#41;, 10&#41; called at /opt/OSAGperlm/lib/Net/DNS/Nameserver.pm line 541

We have been able to track the bug down to the following:

1&#41; Net/DNS/RR/OPT.pm and Net/DNS/DomainName.pm declares several packages in the same file and is using &#34;use base&#34; to load the parent class &#40;which is in the same file&#41;.
2&#41; Our program does daemonize and change its GID/UID to a user which is not able to read the current working directory. 
3&#41; This triggers a side effect of &#34;use base&#34; which will fail as the current working directory is not readable when requiring Net::DNS::RR::OPT::DHU which is actually in OPT.pm which has already been loaded.

The fix is to use either a newer version of perl which does not automatically include the current working directory in the @INC or to use &#34;use parent -norequire&#34; instead of use base. This is described here: <span class="clickylink"><a target="new" rel="nofollow" href="http://perldoc.perl.org/parent.html">http://perldoc.perl.org/parent.html</a></span>

The attached patch does exactly does, it will use &#39;use parent -norequire&#39; for all packages which have the parent in the same .pm file declared. We have been fixing a similar issue in libwww-perl recently: <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/libwww-perl/libwww-perl/pull/259/files">https://github.com/libwww-perl/libwww-perl/pull/259/files</a></span>

Please let me know if you need further information on this.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net-DNS-v1.13.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ur Net-DNS-1.13/lib/Net/DNS/DomainName.pm Net-DNS-1.13-patched/lib/Net/DNS/DomainName.pm
--- Net-DNS-1.13/lib/Net/DNS/DomainName.pm	2017-10-18 11:00:36.000000000 +0200
+++ Net-DNS-1.13-patched/lib/Net/DNS/DomainName.pm	2017-11-21 15:39:51.000000000 +0100
@@ -155,7 +155,7 @@
 ########################################

 package Net::DNS::DomainName1035;
-use base qw&#40;Net::DNS::DomainName&#41;;
+use parent -norequire, qw&#40;Net::DNS::DomainName&#41;;

 =head1 Net::DNS::DomainName1035

@@ -217,7 +217,7 @@
 ########################################

 package Net::DNS::DomainName2535;
-use base qw&#40;Net::DNS::DomainName&#41;;
+use parent -norequire, qw&#40;Net::DNS::DomainName&#41;;

 =head1 Net::DNS::DomainName2535

diff -ur Net-DNS-1.13/lib/Net/DNS/RR/OPT.pm Net-DNS-1.13-patched/lib/Net/DNS/RR/OPT.pm
--- Net-DNS-1.13/lib/Net/DNS/RR/OPT.pm	2017-10-18 11:00:36.000000000 +0200
+++ Net-DNS-1.13-patched/lib/Net/DNS/RR/OPT.pm	2017-11-21 15:38:33.000000000 +0100
@@ -230,10 +230,10 @@


 package Net::DNS::RR::OPT::DHU;					# RFC6975
-use base qw&#40;Net::DNS::RR::OPT::DAU&#41;;
+use parent -norequire, qw&#40;Net::DNS::RR::OPT::DAU&#41;;

 package Net::DNS::RR::OPT::N3U;					# RFC6975
-use base qw&#40;Net::DNS::RR::OPT::DAU&#41;;
+use parent -norequire, qw&#40;Net::DNS::RR::OPT::DAU&#41;;


 package Net::DNS::RR::OPT::CLIENT_SUBNET;			# RFC7871
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;23&nbsp;12:37:51&nbsp;2017</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">8&lt;
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We have been able to track the bug down to the following:
&gt; 
&gt; 1&#41; Net/DNS/RR/OPT.pm and Net/DNS/DomainName.pm declares several
&gt; packages in the same file and is using &#34;use base&#34; to load the parent
&gt; class &#40;which is in the same file&#41;.
</div>
Thanks for your persistence in getting to the root of this problem.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  2&#41; Our program does daemonize and change its GID/UID to a user which
&gt; is not able to read the current working directory.
</div>
which we agree is logically unnecessary


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 3&#41; This triggers a side effect of &#34;use base&#34; which will fail as the
&gt; current working directory is not readable when requiring
&gt; Net::DNS::RR::OPT::DHU which is actually in OPT.pm which has already
&gt; been loaded.
</div>
Disagree.

The problem arises because OPT.pm has *not* been loaded.  Arguably, the compiler should recognise the existence of Net::DNS::RR::OPT 
when it encounters the second package declaration, not when the require is complete. But even if that were fixed tomorrow, we would still need to be compatible with older Perls.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The fix is to use either a newer version of perl which does not
&gt; automatically include the current working directory in the @INC
</div>
Would require 5.26.0, which is far too restrictive


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; use &#34;use parent -norequire&#34; instead of use base. This is described
&gt; here: <span class="clickylink"><a target="new" rel="nofollow" href="http://perldoc.perl.org/parent.html">http://perldoc.perl.org/parent.html</a></span>
</div>
This really amounts to not much more than:

  our @ISA = qw&#40;Net::DNS::DomainName&#41;;

but also comes with unwelcome portability concerns:


$ echo &#39;perl -w DomainName.pm ; exit 0&#39; | perlbrew use 5.24.3

A sub-shell is launched with 5.24.3 as the activated perl. Run &#39;exit&#39; to finish it.

Subroutine canonical redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 68.
Subroutine decode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 96.
Subroutine encode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 139.
Subroutine _wire redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 146.
Subroutine encode redefined at DomainName.pm line 194.
Subroutine encode redefined at DomainName.pm line 253.



$ echo &#39;perl -w DomainName.pm ; exit 0&#39; | perlbrew use 5.16.3

A sub-shell is launched with 5.16.3 as the activated perl. Run &#39;exit&#39; to finish it.

Subroutine canonical redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 68.
Subroutine decode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 96.
Subroutine encode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 139.
Subroutine _wire redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 146.
Subroutine encode redefined at DomainName.pm line 194.
Subroutine encode redefined at DomainName.pm line 253.



$ echo &#39;perl -w Mailbox.pm ; exit 0&#39; | perlbrew use 5.8.9

A sub-shell is launched with 5.8.9 as the activated perl. Run &#39;exit&#39; to finish it.

Can&#39;t locate parent.pm in @INC &#40;@INC contains: /home/rwf/perl5/lib/perl5/i686-linux /home/rwf/perl5/lib/perl5 /home/rwf/devel /home/rwf/devel/extra/lib /home/rwf/perl5/perlbrew/perls/perl-5.8.9/lib/5.8.9/i686-linux /home/rwf/perl5/perlbrew/perls/perl-5.8.9/lib/5.8.9 /home/rwf/perl5/perlbrew/perls/perl-5.8.9/lib/site_perl/5.8.9/i686-linux /home/rwf/perl5/perlbrew/perls/perl-5.8.9/lib/site_perl/5.8.9 .&#41; at Mailbox.pm line 110.
BEGIN failed--compilation aborted at Mailbox.pm line 110.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;23&nbsp;12:37:52&nbsp;2017</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;24&nbsp;05:58:57&nbsp;2017</span>
    <span class="description">kb [...] open.ch -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kb [...] open.ch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Nov 23 12:37:51 2017, rwfranks@acm.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; 3&#41; This triggers a side effect of &#34;use base&#34; which will fail as the
&gt; &gt; current working directory is not readable when requiring
&gt; &gt; Net::DNS::RR::OPT::DHU which is actually in OPT.pm which has already
&gt; &gt; been loaded.
</div>&gt; 
&gt; Disagree.
&gt; 
&gt; The problem arises because OPT.pm has *not* been loaded.  Arguably,
&gt; the compiler should recognise the existence of Net::DNS::RR::OPT
&gt; when it encounters the second package declaration, not when the
&gt; require is complete. But even if that were fixed tomorrow, we would
&gt; still need to be compatible with older Perls.
&gt; 
</div>
I disagree with your disagreement: The problem arises when loading OPT.pm which contains not only the definition of Net::DNS::RR::OPT, but also for Net::DNS::RR::OPT::DAU which is the parent of Net::DNS::RR::OPT::DHU and Net::DNS::RR::OPT::N3U.

What now happens is that &#34;use base&#34; tries to open a DAU.pm. Normally it fails silently if it does not find it, but it explodes if the lookup fails due to missing directory permissions.

As this file lookup is not necessary &#40;and is inefficient&#41; there are 3 options to fix it:

1&#41; use &#34;use parent -norequire&#34; instead of use base, but this is not backward compatible
2&#41; use good old @ISA which does exactly what needed, but needs to be guarded by strong comments so that it does not get &#34;modernized&#34; again.
3&#41; Move the definition of Net::DNS::RR::OPT::DAU into a own DAU.pm file
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;29&nbsp;07:48:05&nbsp;2017</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Nov 24 05:58:57 2017, kb@open.ch wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I disagree with your disagreement:
</div>
I now agree with your disagreement with my disagreement.

I was misinterpreting the result of this experiment, which replaces &#34;use base&#34; by its expanded equivalent and warns when invoked:

 package Net::DNS::DomainName;
 BEGIN { my $b = qw&#40;Net::DNS::Domain&#41;; require base; base-&gt;import&#40;$b&#41;; warn &#34;use base $b;&#34; }
 .
 .

 package Net::DNS::DomainName1035;
 BEGIN { my $b = qw&#40;Net::DNS::DomainName&#41;; require base; base-&gt;import&#40;$b&#41;; warn &#34;use base $b;&#34; }
 .
 .

 package Net::DNS::DomainName2535;
 BEGIN { my $b = qw&#40;Net::DNS::DomainName&#41;; require base; base-&gt;import&#40;$b&#41;; warn &#34;use base $b;&#34; }
 .
 .

$ perl -w ~/devel/Net/DNS/DomainName.pm

 use base Net::DNS::Domain; at /home/rwf/devel/Net/DNS/DomainName.pm line 43.
 use base Net::DNS::Domain; at /home/rwf/devel/Net/DNS/DomainName.pm line 43.
 Subroutine canonical redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 68.
 Subroutine decode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 96.
 Subroutine encode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 139.
 Subroutine _wire redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 146.
 use base Net::DNS::DomainName; at /home/rwf/devel/Net/DNS/DomainName.pm line 158.
 use base Net::DNS::DomainName; at /home/rwf/devel/Net/DNS/DomainName.pm line 220.
 use base Net::DNS::DomainName; at /home/rwf/devel/Net/DNS/DomainName.pm line 158.
 Subroutine encode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 193.
 use base Net::DNS::DomainName; at /home/rwf/devel/Net/DNS/DomainName.pm line 220.
 Subroutine encode redefined at /home/rwf/devel/Net/DNS/DomainName.pm line 251.


3 options to fix it:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; 1&#41; use &#34;use parent -norequire&#34; instead of use base, but this is not
&gt; backward compatible
&gt; 2&#41; use good old @ISA which does exactly what needed, but needs to be
&gt; guarded by strong comments so that it does not get &#34;modernized&#34; again.
&gt; 3&#41; Move the definition of Net::DNS::RR::OPT::DAU into a own DAU.pm
&gt; file
</div>
Propose to choose option 2.
The Perl code is generated using a macro processor, and there is already a reference to this report in the M4 source.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;30&nbsp;03:32:55&nbsp;2017</span>
    <span class="description">kb [...] open.ch -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kb [...] open.ch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Nice

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Propose to choose option 2.
&gt; The Perl code is generated using a macro processor, and there is
&gt; already a reference to this report in the M4 source.
</div>
Can we help somehow? Patch?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;07&nbsp;05:21:09&nbsp;2017</span>
    <span class="description">NLNETLABS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fix will be in the upcoming 1.14 release
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;07&nbsp;05:21:10&nbsp;2017</span>
    <span class="description">NLNETLABS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
