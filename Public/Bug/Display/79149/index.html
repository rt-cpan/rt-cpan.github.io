<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #79149 for Regexp-Grammars: 5.17.3: Eval-group not allowed at runtime </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #79149 for Regexp-Grammars: 5.17.3: Eval-group not allowed at runtime </h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Regexp-Grammars">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Regexp-Grammars">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Regexp-Grammars">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Regexp-Grammars">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Regexp-Grammars">Regexp-Grammars CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">79149</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Regexp-Grammars">Regexp-Grammars</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
d.thomas [...] its.uq.edu.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
CARNIL [...] cpan.org

<br />
gregoa [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-228600-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-228601-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=79149">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112069" href="/Public/Bug/Display.html?id=79149#txn-1112069">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;22&nbsp;17:16:18&nbsp;2012</span>
    <span class="description">d.thomas [...] its.uq.edu.au -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 5.17.3: Eval-group not allowed at runtime</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112069/584839/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584839">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 583b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
RHEL5, my first build with 5.17.x

Regexp-Grammars-1.021.tar.gz  [worked in 5.16.1]

t/alias_literal.t ................... Eval-group not allowed at runtime, use re &#39;eval&#39; in regex m/&#40;?{; 
*Regexp::Grammars::LOGFILE
                        = Regexp::Grammars::_open_log&#40;&#39;&gt;&gt;&#39;,&#39;-&#39;&#41;; }&#41;&#40;&#40;?{; @! = &#40;&#41; if !.../ at 
t/alias_literal.t line 11.
# Looks like your test exited with 255 before it could output anything.
t/alias_literal.t ................... Dubious, test returned 255 &#40;wstat 65280, 0xff00&#41;
No subtests run 

...


Result: FAIL
Failed 59/61 test programs. 0/2 subtests failed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1219922" href="/Public/Bug/Display.html?id=79149#txn-1219922">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;03&nbsp;17:03:32&nbsp;2013</span>
    <span class="description">CARNIL [...] cpan.org -  Cc CARNIL added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1224652" href="/Public/Bug/Display.html?id=79149#txn-1224652">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;16&nbsp;11:00:31&nbsp;2013</span>
    <span class="description">gregoa [...] cpan.org -  Cc GREGOA added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1227034" href="/Public/Bug/Display.html?id=79149#txn-1227034">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;22&nbsp;09:33:54&nbsp;2013</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1227034/648302/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/648302">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 895b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi all,

On Wed Aug 22 17:16:18 2012, d.thomas@its.uq.edu.au wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; RHEL5, my first build with 5.17.x
&gt; 
&gt; Regexp-Grammars-1.021.tar.gz  [worked in 5.16.1]
&gt; 
&gt; t/alias_literal.t ................... Eval-group not allowed at
&gt; runtime, use re &#39;eval&#39; in regex m/&#40;?{;
&gt; *Regexp::Grammars::LOGFILE
&gt;                         = Regexp::Grammars::_open_log&#40;&#39;&gt;&gt;&#39;,&#39;-&#39;&#41;;
&gt; }&#41;&#40;&#40;?{; @! = &#40;&#41; if !.../ at
&gt; t/alias_literal.t line 11.
&gt; # Looks like your test exited with 255 before it could output
&gt; anything.
&gt; t/alias_literal.t ................... Dubious, test returned 255
&gt; &#40;wstat 65280, 0xff00&#41;
&gt; No subtests run
&gt; 
</div>
This now happens with Regexp-Grammars-1.028 consistently on all perl-5.18.0:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.cpantesters.org/distro/R/Regexp-Grammars.html#Regexp-Grammars-1.028">http://www.cpantesters.org/distro/R/Regexp-Grammars.html#Regexp-Grammars-1.028</a></span>

Please fix it.

Regards,

-- Shlomi Fish

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ...
&gt; 
&gt; 
&gt; Result: FAIL
&gt; Failed 59/61 test programs. 0/2 subtests failed.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1227035" href="/Public/Bug/Display.html?id=79149#txn-1227035">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;22&nbsp;09:33:55&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1228058" href="/Public/Bug/Display.html?id=79149#txn-1228058">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;25&nbsp;01:56:27&nbsp;2013</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79149] 5.17.3: Eval-group not allowed at runtime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Jun 2013 15:55:33 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Grammars [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1228058/648852/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/648852">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This now happens with Regexp-Grammars-1.028 consistently on all perl-5.18.0
&gt; Please fix it
</div>
Unfortunately, it appears to be unfixable.

Perl 5.18 changed how &#39;qr&#39; constant overloadings are parsed and the
scope in which they are subsequently compiled. This change appears to
make it impossible to reliably create &#39;qr&#39; overloadings that inject code
blocks into a regex, as it prevents the overloaded regexes from
compiling properly in many cases, even with an explicit &#39;use re &#34;eval&#34;&#39;
in scope. In a few cases, the use of a &#39;qr&#39; overloading causes Perl
5.18 to segfault.

Because Regexp::Grammars relies on &#39;qr&#39; overloads to inject code blocks
into regexes, the module is simply not compatible with Perl 5.18.

After well over a month of pounding on the problem, I have been unable
to find a workaround for this fundamental incompatibility, and there
seems little prospect of a fix unless the behaviour of regex
parsing/compilation is changed again in some future release of Perl.

At present, if you rely on Regexp::Grammars for your parsing needs, your
alternatives are either not to upgrade to Perl 5.18, or else to consider
switching to another parsing system, such as Marpa.

I deeply regret that Regexp::Grammars can no longer be maintained due to
these backwards-incompatible changes in Perl 5.18.

When I have more time &#40;i.e. not soon&#41;, I will look at whether I can
construct a simple-enough failure case to report the issue to P5P. But
I&#39;m not particularly hopeful this issue can be fixed, even by them.

Meanwhile, I have just uploaded release 1.029, which carps most of the
above warning/explanation when run under 5.18, and which also sidesteps
the testing problem by the simple expedient of skipping the tests that
fail or segfault under 5.18. This means you can install and try the
module under 5.18 &#40;in case your usage is one of the few that Perl 5.18
doesn&#39;t break&#41;, but with no guarantees, warranty, or support. It&#39;s far
from ideal, but it&#39;s all I can offer at present.

Damian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1228246" href="/Public/Bug/Display.html?id=79149#txn-1228246">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;25&nbsp;08:51:32&nbsp;2013</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1228246/648962/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/648962">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jun 25 01:56:27 2013, damian@conway.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; This now happens with Regexp-Grammars-1.028 consistently on all
</div>&gt; perl-5.18.0
<div class="message-stanza open">&gt; &gt; Please fix it
</div>&gt; 
&gt; Unfortunately, it appears to be unfixable.
&gt; 
&gt; Perl 5.18 changed how &#39;qr&#39; constant overloadings are parsed and the
&gt; scope in which they are subsequently compiled. This change appears to
&gt; make it impossible to reliably create &#39;qr&#39; overloadings that inject
&gt; code
&gt; blocks into a regex, as it prevents the overloaded regexes from
&gt; compiling properly in many cases, even with an explicit &#39;use re
&gt; &#34;eval&#34;&#39;
&gt; in scope. In a few cases, the use of a &#39;qr&#39; overloading causes Perl
&gt; 5.18 to segfault.
&gt; 
&gt; Because Regexp::Grammars relies on &#39;qr&#39; overloads to inject code
&gt; blocks
&gt; into regexes, the module is simply not compatible with Perl 5.18.
&gt; 
&gt; After well over a month of pounding on the problem, I have been unable
&gt; to find a workaround for this fundamental incompatibility, and there
&gt; seems little prospect of a fix unless the behaviour of regex
&gt; parsing/compilation is changed again in some future release of Perl.
&gt; 
&gt; At present, if you rely on Regexp::Grammars for your parsing needs,
&gt; your
&gt; alternatives are either not to upgrade to Perl 5.18, or else to
&gt; consider
&gt; switching to another parsing system, such as Marpa.
&gt; 
&gt; I deeply regret that Regexp::Grammars can no longer be maintained due
&gt; to
&gt; these backwards-incompatible changes in Perl 5.18.
&gt; 
&gt; When I have more time &#40;i.e. not soon&#41;, I will look at whether I can
&gt; construct a simple-enough failure case to report the issue to P5P. But
&gt; I&#39;m not particularly hopeful this issue can be fixed, even by them.
&gt; 
&gt; Meanwhile, I have just uploaded release 1.029, which carps most of the
&gt; above warning/explanation when run under 5.18, and which also
&gt; sidesteps
&gt; the testing problem by the simple expedient of skipping the tests that
&gt; fail or segfault under 5.18. This means you can install and try the
&gt; module under 5.18 &#40;in case your usage is one of the few that Perl 5.18
&gt; doesn&#39;t break&#41;, but with no guarantees, warranty, or support. It&#39;s far
&gt; from ideal, but it&#39;s all I can offer at present.
</div>
That is all most unfortunate.

If there are crashes, there is definitely a bug in perl.  I suspect the main problem may have to do with concatenation overloading.  It has bothered me for some time that perl regexp compilation will trigger concatenation overloading, which makes little sense to me, as it is for *strings*, not regexps, which, as you see, are a completely different creature.

I wonder whether disabling string concatenation overloading will fix it.  In any case, I think this should really be fixed at perl’s end.  Please do report a bug, so this can be fixed for 5.20 &#40;or 5.18.1 or .2, if the changes are not too sweeping&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1228410" href="/Public/Bug/Display.html?id=79149#txn-1228410">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;25&nbsp;17:17:09&nbsp;2013</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79149] 5.17.3: Eval-group not allowed at runtime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 26 Jun 2013 07:16:13 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Grammars [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1228410/649069/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/649069">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If there are crashes, there is definitely a bug in perl. I suspect the
&gt; main problem may have to do with concatenation overloading. It has
&gt; bothered me for some time that perl regexp compilation will trigger
&gt; concatenation overloading, which makes little sense to me, as it is
&gt; for *strings*, not regexps, which, as you see, are a completely
&gt; different creature.
&gt;
&gt; I wonder whether disabling string concatenation overloading will fix
&gt; it.
</div>
The problem with doing that is that the &#39;qr&#39; constant overloading is
only passed the compile-time constant parts of a regex. So if you
have:

    /abc $var def/

then the overloading is called twice &#40;with &#39;abc &#39; and &#39; def&#39;
respectively&#41;. The only way to grab and process the *entire* regex is to
have the first call return an object with concatenation overloading, so
that the eventual run-time concatenation of the contents of $var can be
trapped and produce yet another object, which can trap the second
concatenation to produce a final object...whose stringify or &#39;qr&#39;
coercion can then finally process the entire regex pattern to produce
the desired effect &#40;in this case, inserting the necessary parsing
machinery&#41;.

Without that elaborate work-around, Regexp::Grammars regexes could not
contain any interpolations, which would make them vastly less useful. It
may still come to that, if I can find no other solutions, but it would be a
significant loss of utility, if it does.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In any case, I think this should really be fixed at perl’s end.
</div>
Agreed.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Please do report a bug, so this can be fixed for 5.20 &#40;or 5.18.1 or
&gt; .2, if the changes are not too sweeping&#41;.
</div>
I certainly intend to, as soon as I can spare enough time to boil an example
down to less than the 2500 lines of the module itself. ;-&#41;

But, as I&#39;m in final preparation for a five-week round-the-world speaking tour,
&#34;as soon as I can&#34; will probably not be &#34;as soon as I&#39;d prefer&#34;.

Damian


Damian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1250577" href="/Public/Bug/Display.html?id=79149#txn-1250577">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;18&nbsp;02:03:48&nbsp;2013</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1250577/661671/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/661671">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 254b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Lexical::Var 0.008 has just been released, and works with 5.18.

In &lt;CAATtAp7gmiU3rsPGY51wE7HfZyV-SU08vqn0DE=6E6CabQVKVQ@mail.gmail.com&gt; you said:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I will definitely revisit it as a possible solution on its next release.
</div>
I hope that is still true. :-&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1250707" href="/Public/Bug/Display.html?id=79149#txn-1250707">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;18&nbsp;19:44:41&nbsp;2013</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79149] 5.17.3: Eval-group not allowed at runtime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 18 Aug 2013 16:43:48 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Grammars [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1250707/661768/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/661768">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 650b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Father Chrysostomos reported:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Lexical::Var 0.008 has just been released, and works with 5.18.
</div>
And with Regexp::Grammars. :-&#41;

Between the recent release of 5.18.1 and this release, the number of
outstanding issues has been significantly reduced. Though not, alas, to
zero yet, as it appears that Dave&#39;s patch for lexical hashes used inside
regex code blocks didn&#39;t make it into 5.18.1 &#40;???&#41;

Anyway, I&#39;ll release an update the R::G this morning, with now only a
few skips in the test suite under 5.18.

Many thanks to everyone who has worked to resurrect my module
&#40;and, more importantly, to fix these fundamental issues in Perl itself&#41;.

Damian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1326196" href="/Public/Bug/Display.html?id=79149#txn-1326196">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;13&nbsp;10:24:17&nbsp;2014</span>
    <span class="description">paul [...] city-fan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> paul [...] city-fan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1326196/703369/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/703369">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 103b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Now that perl 5.18.2 has been out for a while, what&#39;s the compatibility situation for Regexp-Grammars?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1326829" href="/Public/Bug/Display.html?id=79149#txn-1326829">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;14&nbsp;20:54:56&nbsp;2014</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79149] 5.17.3: Eval-group not allowed at runtime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 15 Feb 2014 12:54:08 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Grammars [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1326829/703742/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/703742">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 308b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Now that perl 5.18.2 has been out for a while, what&#39;s the
&gt; compatibility situation for Regexp-Grammars?
</div>
I haven&#39;t had a chance to revisit the issue since 5.18.2 was released.
I will look into it as soon as I am a little less swamped with work.
Probably in early March. I apologize for the delay.

Damian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1326842" href="/Public/Bug/Display.html?id=79149#txn-1326842">#</a>      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;15&nbsp;01:23:28&nbsp;2014</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79149] 5.17.3: Eval-group not allowed at runtime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 15 Feb 2014 17:22:38 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Grammars [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1326842/703745/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/703745">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 398b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Now that perl 5.18.2 has been out for a while, what&#39;s the
&gt; compatibility situation for Regexp-Grammars?
</div>
Well, despite the prediction of a delay until March, I&#39;ve now had a
chance to investigate.

The bug in Perl that is breaking Regexp::Grammars is still present in
5.18.2. I have raised the issue again with the folks who may be able to
expedite a fix.

Sorry this is not better news.

Damian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1373740" href="/Public/Bug/Display.html?id=79149#txn-1373740">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;08&nbsp;14:31:09&nbsp;2014</span>
    <span class="description">CARNIL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1373740/729410/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/729410">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 657b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Damian!

On Sat Feb 15 01:23:28 2014, damian@conway.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Now that perl 5.18.2 has been out for a while, what&#39;s the
&gt; &gt; compatibility situation for Regexp-Grammars?
</div>&gt; 
&gt; Well, despite the prediction of a delay until March, I&#39;ve now had a
&gt; chance to investigate.
&gt; 
&gt; The bug in Perl that is breaking Regexp::Grammars is still present in
&gt; 5.18.2. I have raised the issue again with the folks who may be able to
&gt; expedite a fix.
&gt; 
&gt; Sorry this is not better news.
&gt; 
&gt; Damian
</div>

Perl 5.20 was released at end of may. Do you know if all problems are now resolved affecting Regexp::Grammars?

Thanks a lot for any information,

Regards,
Salvatore
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1374281" href="/Public/Bug/Display.html?id=79149#txn-1374281">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;10&nbsp;17:43:30&nbsp;2014</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79149] 5.17.3: Eval-group not allowed at runtime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Jun 2014 07:42:41 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Grammars [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1374281/729749/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/729749">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 444b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Salvatore,

I have good news regarding Regexp::Grammars.

I have now made all the modifications necessary
to allow the module to run correctly under Perl 5.10 to Perl 5.20
&#40;except under Perl 5.18, whose regex overloading is
still broken under 5.18.2&#41;.

I just uploaded the new release to CPAN, so you
should be able to grab it within the next few hours.

My thanks to everyone for their patience and help in
overcoming this problem.

Damian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1374284" href="/Public/Bug/Display.html?id=79149#txn-1374284">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;10&nbsp;18:06:53&nbsp;2014</span>
    <span class="description">DCONWAY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.61872</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
