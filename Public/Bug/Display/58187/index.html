<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #58187 for Statistics-Descriptive: patch for skewness and kurtosis functions</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #58187 for Statistics-Descriptive: patch for skewness and kurtosis functions</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Statistics-Descriptive">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Statistics-Descriptive">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Statistics-Descriptive">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Statistics-Descriptive">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Statistics-Descriptive">Statistics-Descriptive CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">58187</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Statistics-Descriptive">Statistics-Descriptive</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
SLAFFAN [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-29728-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
3.0100    </td>
  </tr>
  <tr id="CF-29729-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




skew_and_kurt_patch.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/787433/407965/skew_and_kurt_patch.diff">
Mon Jun 07 02:44:54 2010 (3.5k) by SLAFFAN [...] cpan.org
</a>
</font></li>
</ul>


skew_and_kurt_patch_mk2.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/792801/410950/skew_and_kurt_patch_mk2.diff">
Fri Jun 18 00:47:27 2010 (4.9k) by SLAFFAN [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=58187">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-787433" href="/Public/Bug/Display.html?id=58187#txn-787433">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;07&nbsp;02:44:54&nbsp;2010</span>
    <span class="description">SLAFFAN [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> patch for skewness and kurtosis functions</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/787433/407964/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/407964">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 369b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Attached is a diff file to add skewness and kurtosis functions in
Statistics::Descriptive::Full &#40;3.0100&#41;.  It includes regression tests
and POD updates.

It would be nice to have these available via S::D::Sparse using higher
order moments, but that can be patched in when developed.  The OO
inheritance means users won&#39;t notice anything when it happens.

Shawn Laffan.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> skew_and_kurt_patch.diff</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/787433/407965/skew_and_kurt_patch.diff">Download skew_and_kurt_patch.diff</a><br />
<span class="downloadcontenttype">text/x-diff 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: lib/Statistics/Descriptive.pm
===================================================================
--- lib/Statistics/Descriptive.pm	&#40;revision 4433&#41;
+++ lib/Statistics/Descriptive.pm	&#40;working copy&#41;
@@ -10,7 +10,7 @@
 		  ##Perl5.  01-03 weren&#39;t bug free.
 use vars &#40;qw&#40;$VERSION $Tolerance&#41;&#41;;
 
-$VERSION = &#39;3.0100&#39;;
+$VERSION = &#39;3.0200&#39;;
 
 $Tolerance = 0.0;
 
@@ -247,6 +247,7 @@
 __PACKAGE__-&gt;_make_private_accessors&#40;
     [qw&#40;data frequency geometric_mean harmonic_mean 
         least_squares_fit median mode
+	skewness kurtosis
        &#41;
     ]
 &#41;;
@@ -599,6 +600,71 @@
     return $self-&gt;_geometric_mean&#40;&#41;;
 }
 
+sub skewness {
+    my $self = shift;
+
+    if &#40;!defined&#40;$self-&gt;_skewness&#40;&#41;&#41;&#41;
+    {
+	my $n    = $self-&gt;count&#40;&#41;;
+	my $sd   = $self-&gt;standard_deviation&#40;&#41;;
+	
+	my $skew;
+	
+	#  skip if insufficient records
+	if &#40; $sd &#38;&#38; $n &gt; 2&#41; {
+	    
+	    my $mean = $self-&gt;mean&#40;&#41;;
+	    
+	    my $sum_pow3;
+	    
+	    foreach my $rec &#40; $self-&gt;get_data &#41; {
+		my $value  = &#40;&#40;$rec - $mean&#41; / $sd&#41;;
+	        $sum_pow3 +=  $value ** 3;
+	    }
+	    
+	    my $correction = $n / &#40; &#40;$n-1&#41; * &#40;$n-2&#41; &#41;;
+	    
+	    $skew = $correction * $sum_pow3;
+	}
+
+        $self-&gt;_skewness&#40;$skew&#41;;
+    }
+
+    return $self-&gt;_skewness&#40;&#41;;
+}
+
+sub kurtosis {
+    my $self = shift;
+
+    if &#40;!defined&#40;$self-&gt;_kurtosis&#40;&#41;&#41;&#41;
+    {
+	my $kurt;
+	
+	my $n  = $self-&gt;count&#40;&#41;;
+	my $sd   = $self-&gt;standard_deviation&#40;&#41;;
+	
+	if &#40; $sd &#38;&#38; $n &gt; 3&#41; {
+
+	    my $mean = $self-&gt;mean&#40;&#41;;
+	    
+	    my $sum_pow4;
+	    foreach my $rec &#40; $self-&gt;get_data &#41; {
+		$sum_pow4 += &#40; &#40;$rec - $mean &#41; / $sd &#41; ** 4;
+	    }
+	    
+	    my $correction1 = &#40; $n * &#40;$n+1&#41; &#41; / &#40; &#40;$n-1&#41; * &#40;$n-2&#41; * &#40;$n-3&#41; &#41;;
+	    my $correction2 = &#40; 3  * &#40;$n-1&#41; ** 2&#41; / &#40; &#40;$n-2&#41; * &#40;$n-3&#41; &#41;;
+	    
+	    $kurt = &#40; $correction1 * $sum_pow4 &#41; - $correction2;
+	}
+	
+        $self-&gt;_kurtosis&#40;$kurt&#41;;
+    }
+
+    return $self-&gt;_kurtosis&#40;&#41;;
+}
+
+
 sub frequency_distribution_ref
 {
     my $self = shift;
@@ -895,6 +961,19 @@
 is called.  Calling the method without an argument returns the value of
 the flag.
 
+=item $stat-&gt;skewness&#40;&#41;;
+
+Returns the skewness of the data. 
+A value of zero is no skew, negative is a left skewed tail,
+positive is a right skewed tail. 
+This is consistent with Excel.
+
+=item $stat-&gt;kurtosis&#40;&#41;;
+
+Returns the kurtosis of the data.
+Positive is peaked, negative is flattened.
+
+
 =item $x = $stat-&gt;percentile&#40;25&#41;;
 
 =item &#40;$x, $index&#41; = $stat-&gt;percentile&#40;25&#41;;
@@ -1170,6 +1249,10 @@
 
 =over 4
 
+=item v3.0200
+
+Add skewness and kurtosis.
+
 =item v2.3
 
 Rolled into November 1998
Index: t/descr.t
===================================================================
--- t/descr.t	&#40;revision 4433&#41;
+++ t/descr.t	&#40;working copy&#41;
@@ -3,7 +3,7 @@
 use strict;
 use warnings;
 
-use Test::More tests =&gt; 23;
+use Test::More;
 
 use Benchmark;
 use Statistics::Descriptive;
@@ -372,3 +372,47 @@
     &#41;
 }
 
+{
+    my $stat = Statistics::Descriptive::Full-&gt;new&#40;&#41;;
+
+    $stat-&gt;add_data&#40;1 .. 9, 100&#41;;
+
+    # TEST
+    is &#40;$stat-&gt;skewness&#40;&#41;,
+        3.11889574523909,
+        &#39;Skewness of 3.11889574523909&#39;
+    &#41;;
+
+    # TEST
+    is &#40;$stat-&gt;kurtosis&#40;&#41;,
+        9.79924471616366,
+        &#39;Kurtosis of 9.79924471616366&#39;
+    &#41;;
+
+}
+
+{
+    my $stat = Statistics::Descriptive::Full-&gt;new&#40;&#41;;
+
+    $stat-&gt;add_data&#40;1,2&#41;;
+    my $def;
+
+    # TEST
+    $def = defined $stat-&gt;skewness&#40;&#41; ? 1 : 0;
+    is &#40;$def,
+        0,
+        &#39;Skewness is undef for 2 samples&#39;
+    &#41;;
+
+    $stat-&gt;add_data &#40;1&#41;;
+
+    # TEST
+    $def = defined $stat-&gt;kurtosis&#40;&#41; ? 1 : 0;
+    is &#40;$def,
+        0,
+        &#39;Kurtosis is undef for 3 samples&#39;
+    &#41;;
+
+}
+
+done_testing&#40;&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-787451" href="/Public/Bug/Display.html?id=58187#txn-787451">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;07&nbsp;03:50:39&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/787451/407971/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/407971">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Shawn,

On Mon Jun 07 02:44:54 2010, SLAFFAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Attached is a diff file to add skewness and kurtosis functions in
&gt; Statistics::Descriptive::Full &#40;3.0100&#41;.  It includes regression tests
&gt; and POD updates.
&gt; 
&gt; It would be nice to have these available via S::D::Sparse using higher
&gt; order moments, but that can be patched in when developed.  The OO
&gt; inheritance means users won&#39;t notice anything when it happens.
&gt; 
</div>
Here are some comments on your patch:

1. You should not bump the $VERSION in the patch.

2. You&#39;ve added skewness and kurtosis to the private accessors, and you
seem to memoise them but there doesn&#39;t appear to be a public interface
to reset them. So they may be cached and not updated when further data
is added. 

3. You seem to have mixed tabs and spaces. Please keep the patch
spaces-only and 4-spaces wide.

4. You should use in_between&#40;&#41; in t/descr.t for testing the exact values
of skewness and kurtosis, because exactly comparing floating point
numbers is unreliable.

5. Please don&#39;t get rid of the plan and use &#34;done_testing&#40;&#41;&#34;. Instead,
you should use Test-Count - <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/Test-Count/">http://search.cpan.org/dist/Test-Count/</a></span> . See:

<span class="clickylink"><a target="new" rel="nofollow" href="http://use.perl.org/~Alias/journal/39916">http://use.perl.org/~Alias/journal/39916</a></span>

6. You also need to update the Changes.

----

Please correct the patch and resubmit.

Regards,

-- Shlomi Fish
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-787454" href="/Public/Bug/Display.html?id=58187#txn-787454">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;07&nbsp;03:50:41&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-791887" href="/Public/Bug/Display.html?id=58187#txn-791887">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;16&nbsp;08:34:51&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/791887/410419/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/410419">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 735b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Shawn,

On Mon Jun 07 02:44:54 2010, SLAFFAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Attached is a diff file to add skewness and kurtosis functions in
&gt; Statistics::Descriptive::Full &#40;3.0100&#41;.  It includes regression tests
&gt; and POD updates.
&gt; 
&gt; It would be nice to have these available via S::D::Sparse using higher
&gt; order moments, but that can be patched in when developed.  The OO
&gt; inheritance means users won&#39;t notice anything when it happens.
&gt; 
&gt; Shawn Laffan.
</div>
I commented on your patch with some errata over a week ago, and yet you
didn&#39;t respond. Please correct the patch according to my input, or I&#39;ll
have to close this bug, and drop the patch. If you wish you can send a
simple acknowledgement that you&#39;re dealing with it.

Regards,

-- Shlomi Fish
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-792801" href="/Public/Bug/Display.html?id=58187#txn-792801">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;00:47:27&nbsp;2010</span>
    <span class="description">SLAFFAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/792801/410949/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/410949">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Shlomi,

Here&#39;s the revised patch.  It&#39;s diffed against revision 4455 of the svn
repository.

In response to your comments:

1.  Done.  Version now left alone.

2.  The code is modelled on the harmonic_mean sub.  I&#39;ve stepped through
the code and checked that the values are cleared when new data are
added.  I&#39;ve also added tests for this in descr.t.

3.  Whoops.  Better pay closer attention to my IDE in future.

4.  is_between&#40;&#41; is now used for the tests I added.  I used a tolerance
of +/-1e-13 around the expected which should provide plenty of precision
while still allowing for floating point differences.

5.  done_testing&#40;&#41; approach removed and the test count updated instead.  

6.  Change document updated.  I&#39;ve listed the version number in that as
3.0???, so it&#39;s up to you to change as you see fit.  This version number
place-holder text is also in the Revision History section of the POD.  
That said, one could argue that the revision history in the POD could be
removed since the Change document is the up-to-date listing and the POD
only has up to version 2.3 &#40;released 1998&#41;.  That&#39;s your call, though.


Let me know if there are any more modifications needed.

Regards,
Shawn.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> skew_and_kurt_patch_mk2.diff</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/792801/410950/skew_and_kurt_patch_mk2.diff">Download skew_and_kurt_patch_mk2.diff</a><br />
<span class="downloadcontenttype">text/x-diff 4.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: Changes
===================================================================
--- Changes	&#40;revision 4455&#41;
+++ Changes	&#40;working copy&#41;
@@ -1,5 +1,12 @@
 Revision history for Perl extension Statistics::Descriptive.
 
+
+
+
+3.0???      June 2010
+    - Added skewness and kurtosis
+        - <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=58187">https://rt.cpan.org/Ticket/Display.html?id=58187</a></span>
+
 3.0102      June 15, 2010
     - Add the $VERSION variable to Statistics::Descriptive::Sparse and
     Statistics::Descriptive::Full. This was done to silence the CPAN indexer.
Index: lib/Statistics/Descriptive.pm
===================================================================
--- lib/Statistics/Descriptive.pm	&#40;revision 4455&#41;
+++ lib/Statistics/Descriptive.pm	&#40;working copy&#41;
@@ -255,6 +255,7 @@
 __PACKAGE__-&gt;_make_private_accessors&#40;
     [qw&#40;data frequency geometric_mean harmonic_mean 
         least_squares_fit median mode
+        skewness kurtosis
        &#41;
     ]
 &#41;;
@@ -607,6 +608,71 @@
     return $self-&gt;_geometric_mean&#40;&#41;;
 }
 
+sub skewness {
+    my $self = shift;
+
+    if &#40;!defined&#40;$self-&gt;_skewness&#40;&#41;&#41;&#41;
+    {
+        my $n    = $self-&gt;count&#40;&#41;;
+        my $sd   = $self-&gt;standard_deviation&#40;&#41;;
+        
+        my $skew;
+        
+        #  skip if insufficient records
+        if &#40; $sd &#38;&#38; $n &gt; 2&#41; {
+            
+            my $mean = $self-&gt;mean&#40;&#41;;
+            
+            my $sum_pow3;
+            
+            foreach my $rec &#40; $self-&gt;get_data &#41; {
+                my $value  = &#40;&#40;$rec - $mean&#41; / $sd&#41;;
+                $sum_pow3 +=  $value ** 3;
+            }
+            
+            my $correction = $n / &#40; &#40;$n-1&#41; * &#40;$n-2&#41; &#41;;
+            
+            $skew = $correction * $sum_pow3;
+        }
+
+        $self-&gt;_skewness&#40;$skew&#41;;
+    }
+
+    return $self-&gt;_skewness&#40;&#41;;
+}
+
+sub kurtosis {
+    my $self = shift;
+
+    if &#40;!defined&#40;$self-&gt;_kurtosis&#40;&#41;&#41;&#41;
+    {
+        my $kurt;
+        
+        my $n  = $self-&gt;count&#40;&#41;;
+        my $sd   = $self-&gt;standard_deviation&#40;&#41;;
+        
+        if &#40; $sd &#38;&#38; $n &gt; 3&#41; {
+
+            my $mean = $self-&gt;mean&#40;&#41;;
+            
+            my $sum_pow4;
+            foreach my $rec &#40; $self-&gt;get_data &#41; {
+                $sum_pow4 += &#40; &#40;$rec - $mean &#41; / $sd &#41; ** 4;
+            }
+            
+            my $correction1 = &#40; $n * &#40;$n+1&#41; &#41; / &#40; &#40;$n-1&#41; * &#40;$n-2&#41; * &#40;$n-3&#41; &#41;;
+            my $correction2 = &#40; 3  * &#40;$n-1&#41; ** 2&#41; / &#40; &#40;$n-2&#41; * &#40;$n-3&#41; &#41;;
+            
+            $kurt = &#40; $correction1 * $sum_pow4 &#41; - $correction2;
+        }
+        
+        $self-&gt;_kurtosis&#40;$kurt&#41;;
+    }
+
+    return $self-&gt;_kurtosis&#40;&#41;;
+}
+
+
 sub frequency_distribution_ref
 {
     my $self = shift;
@@ -903,6 +969,19 @@
 is called.  Calling the method without an argument returns the value of
 the flag.
 
+=item $stat-&gt;skewness&#40;&#41;;
+
+Returns the skewness of the data. 
+A value of zero is no skew, negative is a left skewed tail,
+positive is a right skewed tail. 
+This is consistent with Excel.
+
+=item $stat-&gt;kurtosis&#40;&#41;;
+
+Returns the kurtosis of the data.
+Positive is peaked, negative is flattened.
+
+
 =item $x = $stat-&gt;percentile&#40;25&#41;;
 
 =item &#40;$x, $index&#41; = $stat-&gt;percentile&#40;25&#41;;
@@ -1178,6 +1257,10 @@
 
 =over 4
 
+=item v3.0???
+
+Add skewness and kurtosis.
+
 =item v2.3
 
 Rolled into November 1998
Index: t/descr.t
===================================================================
--- t/descr.t	&#40;revision 4455&#41;
+++ t/descr.t	&#40;working copy&#41;
@@ -3,7 +3,7 @@
 use strict;
 use warnings;
 
-use Test::More tests =&gt; 22;
+use Test::More tests =&gt; 29;
 
 use Benchmark;
 use Statistics::Descriptive;
@@ -346,3 +346,70 @@
     &#41;
 }
 
+{
+    my $stat = Statistics::Descriptive::Full-&gt;new&#40;&#41;;
+    my $expected;
+    
+    $stat-&gt;add_data&#40;1 .. 9, 100&#41;;
+#my $x = $stat-&gt;harmonic_mean;
+    # TEST
+    $expected = 3.11889574523909;
+    is_between &#40;$stat-&gt;skewness&#40;&#41;,
+        $expected - 1E-13,
+        $expected + 1E-13,
+        &#34;Skewness of $expected +/- 1E-13&#34;
+    &#41;;
+
+    # TEST
+    $expected = 9.79924471616366;
+    is_between &#40;$stat-&gt;kurtosis&#40;&#41;,
+        $expected - 1E-13,
+        $expected + 1E-13,
+        &#34;Kurtosis of $expected +/- 1E-13&#34;
+    &#41;;
+    
+    $stat-&gt;add_data&#40;100 .. 110&#41;;
+    
+    #  now check that cached skew and kurt values are recalculated
+    
+    # TEST
+    $expected = -0.306705104889384;
+    is_between &#40;$stat-&gt;skewness&#40;&#41;,
+        $expected - 1E-13,
+        $expected + 1E-13,
+        &#34;Skewness of $expected +/- 1E-13&#34;
+    &#41;;
+
+    # TEST
+    $expected = -2.09839497356215;
+    is_between &#40;$stat-&gt;kurtosis&#40;&#41;,
+        $expected - 1E-13,
+        $expected + 1E-13,
+        &#34;Kurtosis of $expected +/- 1E-13&#34;
+    &#41;;
+}
+
+{
+    my $stat = Statistics::Descriptive::Full-&gt;new&#40;&#41;;
+
+    $stat-&gt;add_data&#40;1,2&#41;;
+    my $def;
+
+    # TEST
+    $def = defined $stat-&gt;skewness&#40;&#41; ? 1 : 0;
+    is &#40;$def,
+        0,
+        &#39;Skewness is undef for 2 samples&#39;
+    &#41;;
+
+    $stat-&gt;add_data &#40;1&#41;;
+
+    # TEST
+    $def = defined $stat-&gt;kurtosis&#40;&#41; ? 1 : 0;
+    is &#40;$def,
+        0,
+        &#39;Kurtosis is undef for 3 samples&#39;
+    &#41;;
+
+}
+
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-792831" href="/Public/Bug/Display.html?id=58187#txn-792831">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;03:31:45&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/792831/410965/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/410965">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 829b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Shawn,

thanks for the revised patch, I applied it after some small revisions
and released Statistics-Descriptive-3.0200. 

On Fri Jun 18 00:47:27 2010, SLAFFAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Shlomi,
&gt; 
&gt; Here&#39;s the revised patch.  It&#39;s diffed against revision 4455 of the svn
&gt; repository.
&gt; 
&gt; In response to your comments:
&gt; 
&gt; 1.  Done.  Version now left alone.
&gt; 
&gt; 2.  The code is modelled on the harmonic_mean sub.  I&#39;ve stepped through
&gt; the code and checked that the values are cleared when new data are
&gt; added.  I&#39;ve also added tests for this in descr.t.
&gt; 
</div>
To avoid me having to see my points and your replies to them in
different browser pane, and have to jump back and forth, next time
please use rt.cpan.org&#39;s reply-to-comment feature and reply inline. See:

<span class="clickylink"><a target="new" rel="nofollow" href="http://en.wikipedia.org/wiki/Posting_style">http://en.wikipedia.org/wiki/Posting_style</a></span>

Regards,

-- Shlomi Fish 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-792834" href="/Public/Bug/Display.html?id=58187#txn-792834">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;03:31:47&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-793084" href="/Public/Bug/Display.html?id=58187#txn-793084">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;18:14:35&nbsp;2010</span>
    <span class="description">SLAFFAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/793084/411125/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/411125">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 970b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jun 18 03:31:45 2010, SHLOMIF wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Shawn,
&gt; 
&gt; thanks for the revised patch, I applied it after some small revisions
&gt; and released Statistics-Descriptive-3.0200. 
&gt; 
&gt; On Fri Jun 18 00:47:27 2010, SLAFFAN wrote:
<div class="message-stanza open">&gt; &gt; Hi Shlomi,
&gt; &gt; 
&gt; &gt; Here&#39;s the revised patch.  It&#39;s diffed against revision 4455 of the svn
&gt; &gt; repository.
&gt; &gt; 
&gt; &gt; In response to your comments:
&gt; &gt; 
&gt; &gt; 1.  Done.  Version now left alone.
&gt; &gt; 
&gt; &gt; 2.  The code is modelled on the harmonic_mean sub.  I&#39;ve stepped through
&gt; &gt; the code and checked that the values are cleared when new data are
&gt; &gt; added.  I&#39;ve also added tests for this in descr.t.
&gt; &gt; 
</div>&gt; 
&gt; To avoid me having to see my points and your replies to them in
&gt; different browser pane, and have to jump back and forth, next time
&gt; please use rt.cpan.org&#39;s reply-to-comment feature and reply inline. See:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://en.wikipedia.org/wiki/Posting_style">http://en.wikipedia.org/wiki/Posting_style</a></span>
&gt; 
&gt; Regards,
&gt; 
&gt; -- Shlomi Fish 
</div>

No worries Shlomi.

Regards, 
Shawn.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-793086" href="/Public/Bug/Display.html?id=58187#txn-793086">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;18:14:36&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-793206" href="/Public/Bug/Display.html?id=58187#txn-793206">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;19&nbsp;03:19:32&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/793206/411191/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/411191">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 61b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Resolving as adding a reply reopens the ticket automatically.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-793209" href="/Public/Bug/Display.html?id=58187#txn-793209">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;19&nbsp;03:19:33&nbsp;2010</span>
    <span class="description">SHLOMIF [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.534394</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
