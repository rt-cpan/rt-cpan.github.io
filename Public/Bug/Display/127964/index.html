<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #127964 for Net-Duo: Net::Duo and new pagination requirements for Duo API</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #127964 for Net-Duo: Net::Duo and new pagination requirements for Duo API</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-Duo/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-Duo/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-Duo/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-Duo/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-Duo">Net-Duo CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">127964</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-Duo/Active/">Net-Duo</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">RRA [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
das1 [...] lehigh.edu

<br />
iglesias [...] uci.edu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-262838-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-262839-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.02    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;07&nbsp;17:48:12&nbsp;2018</span>
    <span class="description">iglesias [...] uci.edu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 7 Dec 2018 14:41:25 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Duo [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike Iglesias &lt;iglesias [...] uci.edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">As noted here:

<span class="clickylink"><a target="new" rel="nofollow" href="https://help.duo.com/s/article/4744?language=en_US&#38;mkt_tok=eyJpIjoiT1dFeE1ESmtNemMwTURrNCIsInQiOiJRN0ZQWmcrcXJ1WEk3aVA2Q2FIMlVZSThwVE44S0hvS1BxZ0gwTWdNdmRZdHB6U3hwR0RpRHRTbVlGSTMwSnVrVEh0UlBTV1BuRHJlMmhvTktTcFNcL0p0YkpYMFJoaUJmT2tvazdVZkZPdFJmNTRnTVdVTGV1R2o2UjB4NVhjWEcifQ%3D%3D">https://help.duo.com/s/article/4744?language=en_US&#38;mkt_tok=eyJpIjoiT1dFeE1ESmtNemMwTURrNCIsInQiOiJRN0ZQWmcrcXJ1WEk3aVA2Q2FIMlVZSThwVE44S0hvS1BxZ0gwTWdNdmRZdHB6U3hwR0RpRHRTbVlGSTMwSnVrVEh0UlBTV1BuRHJlMmhvTktTcFNcL0p0YkpYMFJoaUJmT2tvazdVZkZPdFJmNTRnTVdVTGV1R2o2UjB4NVhjWEcifQ%3D%3D</a></span>

Duo is changing their APIs to do &#34;pagination&#34;, where you only get a certain
number of records back when you do an API request, like to get all the user&#39;s
information.

Will Net::Duo be updated to handle this?  We have several Perl scripts that
produce reports on Duo users, integrations, etc., that would need to be
rewritten if Net::Duo is not updated to handle pagination.

Thank you for your time, and for Net::Duo.


-- 
Mike Iglesias                          Email:       iglesias@uci.edu
University of California, Irvine       phone:       949-824-6926
Office of Information Technology       FAX:         949-824-2270
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;22&nbsp;12:13:44&nbsp;2019</span>
    <span class="description">das1 [...] lehigh.edu -  Requestor das1@lehigh.edu added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;28&nbsp;10:09:54&nbsp;2019</span>
    <span class="description">cjbrabec [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 07 17:48:12 2018, iglesias@uci.edu wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Duo is changing their APIs to do &#34;pagination&#34;, where you only get a
&gt; certain
&gt; number of records back when you do an API request, like to get all the
&gt; user&#39;s
&gt; information.
</div>
We also ran into this issue at NCSU. We&#39;re only using this API for the
/admin/v1/users call in our reporting. I made a fork of the code on github
and wrote a POC-quality patch to add pagination for that one call. 

fork is here: <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cjbnc/net-duo">https://github.com/cjbnc/net-duo</a></span>

To implement pagination, I split the call_json&#40;&#41; function into three pieces:
- call_raw_json&#40;&#41; = most of the original call_json code, except it returns the 
  whole data result, not just the response piece. This is needed to get the
  metadata piece that contains the pagination offset
- call_json&#40;&#41; = a new wrapper function that calls call_raw_json&#40;&#41; but
  still returns only the response piece, just like the original
- call_paged_json&#40;&#41; = a new wrapper function that makes repeated calls
  to call_raw_json&#40;&#41; for each page of data and assembles the result into 
  a single array

And I updated Admin::users&#40;&#41; to use the new call_paged_json&#40;&#41;

In practice, it works for us. Instead of making one API call for 40,700 users,
now we make 136 calls for 300 users each. Wheee!

Adding this to other calls may be as simple as updating call_json&#40;&#41; to call_paged_json&#40;&#41; in those calls. That assumes the pagination works the same
and accepts the same max limit of 300 that I used.

Another note, &#39;./Build test&#39; fails on the Mock users call because it expects
to see no Content, but instead sees that the paged call adds the limit and offset variables to the request. 

Hope this is useful.

Charles
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;28&nbsp;10:09:55&nbsp;2019</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;28&nbsp;13:02:21&nbsp;2019</span>
    <span class="description">RRA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127964] Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Feb 2019 09:54:38 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Charles Brabec via RT&#34; &lt;bug-Net-Duo [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Russ Allbery &lt;rra [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi folks,

My apologies for not having responded to this bug earlier.  The reality is
that this package is orphaned.  It was something I wrote at my previous
job, and I no longer use it personally &#40;and probably won&#39;t in the future&#41;.
I had thought I would be able to keep maintaining it after I changed jobs,
but in retrospect that was unrealistic.

That said, I feel bad about leaving people in the lurch, so I&#39;m going to
try to get out a new release that fixes this problem.  I&#39;ve set aside some
time this weekend to work on that.  Thank you very much for the analysis
of the change that&#39;s needed!  I may ask for a tester of a pre-release
version on GitHub, since I don&#39;t personally have access to a Duo account
with a sufficiently large number of users.

Going forward, obviously this package should have an owner who is actively
using it and interested in maintaining it.  If anyone wants to take it
over, let me know.

-- 
#!/usr/bin/perl -- Russ Allbery, Just Another Perl Hacker
$^=q;@!&gt;~|{&gt;krw&gt;yn{u&lt;$$&lt;[~||&lt;Juukn{=,&lt;S~|}&lt;Jwx}qn{&lt;Yn{u&lt;Qjltn{ &gt; 0gFzD gD,
 00Fz, 0,,&#40; 0hF 0g&#41;F/=, 0&gt; &#34;L$/GEIFewe{,$/ 0C$~&gt; &#34;@=,m,|,&#40;e 0.&#41;, 01,pnn,y{
rw} &gt;;,$0=q,$,,&#40;$_=$^&#41;=~y,$/ C-~&gt;&lt;@=\n\r,-~$:-u/ #y,d,s,&#40;\$.&#41;,$1,gee,print
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;28&nbsp;13:24:49&nbsp;2019</span>
    <span class="description">iglesias [...] uci.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127964] Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Feb 2019 10:11:17 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Duo [...] rt.cpan.org, das1 [...] lehigh.edu</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike Iglesias &lt;iglesias [...] uci.edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I switched our scripts over to using the Duo API calls, and their method of
handling pagination is similar to what Charles did - they have a
json_paging_api_call that sets up the paging and a &#34;next&#34; call that gives you
the next object you asked for.  The next call does the paging behind the
scenes so you don&#39;t have to worry about it.

I can help out with the testing if you need it as I still have copies of the
Net::Duo scripts.


Mike


On 2/28/19 10:02 AM, Russ Allbery via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=127964">https://rt.cpan.org/Ticket/Display.html?id=127964</a></span> &gt;
&gt; 
&gt; Hi folks,
&gt; 
&gt; My apologies for not having responded to this bug earlier.  The reality is
&gt; that this package is orphaned.  It was something I wrote at my previous
&gt; job, and I no longer use it personally &#40;and probably won&#39;t in the future&#41;.
&gt; I had thought I would be able to keep maintaining it after I changed jobs,
&gt; but in retrospect that was unrealistic.
&gt; 
&gt; That said, I feel bad about leaving people in the lurch, so I&#39;m going to
&gt; try to get out a new release that fixes this problem.  I&#39;ve set aside some
&gt; time this weekend to work on that.  Thank you very much for the analysis
&gt; of the change that&#39;s needed!  I may ask for a tester of a pre-release
&gt; version on GitHub, since I don&#39;t personally have access to a Duo account
&gt; with a sufficiently large number of users.
&gt; 
&gt; Going forward, obviously this package should have an owner who is actively
&gt; using it and interested in maintaining it.  If anyone wants to take it
&gt; over, let me know.
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;28&nbsp;14:49:33&nbsp;2019</span>
    <span class="description">das1 [...] lehigh.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Feb 28 10:09:54 2019, cjbrabec wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Dec 07 17:48:12 2018, iglesias@uci.edu wrote:
<div class="message-stanza open">&gt; &gt; Duo is changing their APIs to do &#34;pagination&#34;, where you only get a
&gt; &gt; certain
&gt; &gt; number of records back when you do an API request, like to get all
&gt; &gt; the
&gt; &gt; user&#39;s
&gt; &gt; information.
</div>&gt; 
&gt; We also ran into this issue at NCSU. We&#39;re only using this API for the
&gt; /admin/v1/users call in our reporting. I made a fork of the code on
&gt; github
&gt;  and wrote a POC-quality patch to add pagination for that one call.
&gt; 
&gt; fork is here: <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/cjbnc/net-duo">https://github.com/cjbnc/net-duo</a></span>
&gt; 
&gt; To implement pagination, I split the call_json&#40;&#41; function into three
&gt; pieces:
&gt;  - call_raw_json&#40;&#41; = most of the original call_json code, except it
&gt; returns the
&gt;   whole data result, not just the response piece. This is needed to
&gt; get the
&gt;   metadata piece that contains the pagination offset
&gt; - call_json&#40;&#41; = a new wrapper function that calls call_raw_json&#40;&#41; but
&gt;   still returns only the response piece, just like the original
&gt; - call_paged_json&#40;&#41; = a new wrapper function that makes repeated calls
&gt;    to call_raw_json&#40;&#41; for each page of data and assembles the result
&gt; into
&gt;   a single array
&gt; 
&gt; And I updated Admin::users&#40;&#41; to use the new call_paged_json&#40;&#41;
&gt; 
&gt; In practice, it works for us. Instead of making one API call for
&gt; 40,700 users,
&gt; now we make 136 calls for 300 users each. Wheee!
&gt; 
&gt; Adding this to other calls may be as simple as updating call_json&#40;&#41; to
&gt; call_paged_json&#40;&#41; in those calls. That assumes the pagination works
&gt; the same
&gt; and accepts the same max limit of 300 that I used.
&gt; 
&gt; Another note, &#39;./Build test&#39; fails on the Mock users call because it
&gt; expects
&gt;  to see no Content, but instead sees that the paged call adds the
&gt; limit and offset variables to the request.
&gt; 
&gt; Hope this is useful.
&gt; 
&gt; Charles
</div>
Thanks Charles - Very useful - I&#39;m glad I didn&#39;t have to figure this out.  - Dan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;02&nbsp;13:52:25&nbsp;2019</span>
    <span class="description">RRA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127964] Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 02 Mar 2019 10:52:10 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Mike Iglesias via RT&#34; &lt;bug-Net-Duo [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Russ Allbery &lt;rra [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Mike Iglesias via RT&#34; &lt;bug-Net-Duo@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I switched our scripts over to using the Duo API calls, and their method
&gt; of handling pagination is similar to what Charles did - they have a
&gt; json_paging_api_call that sets up the paging and a &#34;next&#34; call that
&gt; gives you the next object you asked for.  The next call does the paging
&gt; behind the scenes so you don&#39;t have to worry about it.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I can help out with the testing if you need it as I still have copies of
&gt; the Net::Duo scripts.
</div>
Thank you!  The code on the master branch at:

    <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/rra/net-duo">https://github.com/rra/net-duo</a></span>

should hopefully do the right thing.  I updated the test suite and
switched to paginated calls for the integrations&#40;&#41; and users&#40;&#41; methods.
Testing would be greatly appreciated, since I&#39;ve only tested it against my
understanding of the API documentation and not against the actual API &#40;I
no longer have access to the admin API for a Duo account&#41;.

I have a bit more work to do before making a release &#40;mostly to make it
clear that the package is orphaned and is looking for a new maintainer&#41;,
but will try to get a new release ASAP out once I have confirmation that
this works.

-- 
#!/usr/bin/perl -- Russ Allbery, Just Another Perl Hacker
$^=q;@!&gt;~|{&gt;krw&gt;yn{u&lt;$$&lt;[~||&lt;Juukn{=,&lt;S~|}&lt;Jwx}qn{&lt;Yn{u&lt;Qjltn{ &gt; 0gFzD gD,
 00Fz, 0,,&#40; 0hF 0g&#41;F/=, 0&gt; &#34;L$/GEIFewe{,$/ 0C$~&gt; &#34;@=,m,|,&#40;e 0.&#41;, 01,pnn,y{
rw} &gt;;,$0=q,$,,&#40;$_=$^&#41;=~y,$/ C-~&gt;&lt;@=\n\r,-~$:-u/ #y,d,s,&#40;\$.&#41;,$1,gee,print
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;02&nbsp;20:28:09&nbsp;2019</span>
    <span class="description">iglesias [...] uci.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127964] Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 2 Mar 2019 17:27:36 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Duo [...] rt.cpan.org, das1 [...] lehigh.edu</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike Iglesias &lt;iglesias [...] uci.edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m out of town this weekend but I can test Monday evening or Tuesday.


Mike

On 3/2/19 10:52 AM, Russ Allbery via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=127964">https://rt.cpan.org/Ticket/Display.html?id=127964</a></span> &gt;
&gt; 
&gt; &#34;Mike Iglesias via RT&#34; &lt;bug-Net-Duo@rt.cpan.org&gt; writes:
&gt; 
<div class="message-stanza open">&gt;&gt; I switched our scripts over to using the Duo API calls, and their method
&gt;&gt; of handling pagination is similar to what Charles did - they have a
&gt;&gt; json_paging_api_call that sets up the paging and a &#34;next&#34; call that
&gt;&gt; gives you the next object you asked for.  The next call does the paging
&gt;&gt; behind the scenes so you don&#39;t have to worry about it.
</div>&gt; 
<div class="message-stanza open">&gt;&gt; I can help out with the testing if you need it as I still have copies of
&gt;&gt; the Net::Duo scripts.
</div>&gt; 
&gt; Thank you!  The code on the master branch at:
&gt; 
&gt;     <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/rra/net-duo">https://github.com/rra/net-duo</a></span>
&gt; 
&gt; should hopefully do the right thing.  I updated the test suite and
&gt; switched to paginated calls for the integrations&#40;&#41; and users&#40;&#41; methods.
&gt; Testing would be greatly appreciated, since I&#39;ve only tested it against my
&gt; understanding of the API documentation and not against the actual API &#40;I
&gt; no longer have access to the admin API for a Duo account&#41;.
&gt; 
&gt; I have a bit more work to do before making a release &#40;mostly to make it
&gt; clear that the package is orphaned and is looking for a new maintainer&#41;,
&gt; but will try to get a new release ASAP out once I have confirmation that
&gt; this works.
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;05&nbsp;10:50:50&nbsp;2019</span>
    <span class="description">iglesias [...] uci.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127964] Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 5 Mar 2019 07:50:21 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-Duo [...] rt.cpan.org, das1 [...] lehigh.edu</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mike Iglesias &lt;iglesias [...] uci.edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I ran some tests using your new code with some scripts that produce listings
of users and integrations, and they produce the same output as the scripts
using Duo&#39;s perl API package.  At least from my perspective your new code is
working.


Mike

On 3/2/19 10:52 AM, Russ Allbery via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=127964">https://rt.cpan.org/Ticket/Display.html?id=127964</a></span> &gt;
&gt; 
&gt; &#34;Mike Iglesias via RT&#34; &lt;bug-Net-Duo@rt.cpan.org&gt; writes:
&gt; 
<div class="message-stanza open">&gt;&gt; I switched our scripts over to using the Duo API calls, and their method
&gt;&gt; of handling pagination is similar to what Charles did - they have a
&gt;&gt; json_paging_api_call that sets up the paging and a &#34;next&#34; call that
&gt;&gt; gives you the next object you asked for.  The next call does the paging
&gt;&gt; behind the scenes so you don&#39;t have to worry about it.
</div>&gt; 
<div class="message-stanza open">&gt;&gt; I can help out with the testing if you need it as I still have copies of
&gt;&gt; the Net::Duo scripts.
</div>&gt; 
&gt; Thank you!  The code on the master branch at:
&gt; 
&gt;     <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/rra/net-duo">https://github.com/rra/net-duo</a></span>
&gt; 
&gt; should hopefully do the right thing.  I updated the test suite and
&gt; switched to paginated calls for the integrations&#40;&#41; and users&#40;&#41; methods.
&gt; Testing would be greatly appreciated, since I&#39;ve only tested it against my
&gt; understanding of the API documentation and not against the actual API &#40;I
&gt; no longer have access to the admin API for a Duo account&#41;.
&gt; 
&gt; I have a bit more work to do before making a release &#40;mostly to make it
&gt; clear that the package is orphaned and is looking for a new maintainer&#41;,
&gt; but will try to get a new release ASAP out once I have confirmation that
&gt; this works.
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;05&nbsp;17:43:37&nbsp;2019</span>
    <span class="description">RRA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127964] Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 05 Mar 2019 14:43:27 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Mike Iglesias via RT&#34; &lt;bug-Net-Duo [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Russ Allbery &lt;rra [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Mike Iglesias via RT&#34; &lt;bug-Net-Duo@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I ran some tests using your new code with some scripts that produce
&gt; listings of users and integrations, and they produce the same output as
&gt; the scripts using Duo&#39;s perl API package.  At least from my perspective
&gt; your new code is working.
</div>
Awesome, thank you so much!  I got a bit sidetracked by a bad cold, but
the new release should be out today or tomorrow.

-- 
#!/usr/bin/perl -- Russ Allbery, Just Another Perl Hacker
$^=q;@!&gt;~|{&gt;krw&gt;yn{u&lt;$$&lt;[~||&lt;Juukn{=,&lt;S~|}&lt;Jwx}qn{&lt;Yn{u&lt;Qjltn{ &gt; 0gFzD gD,
 00Fz, 0,,&#40; 0hF 0g&#41;F/=, 0&gt; &#34;L$/GEIFewe{,$/ 0C$~&gt; &#34;@=,m,|,&#40;e 0.&#41;, 01,pnn,y{
rw} &gt;;,$0=q,$,,&#40;$_=$^&#41;=~y,$/ C-~&gt;&lt;@=\n\r,-~$:-u/ #y,d,s,&#40;\$.&#41;,$1,gee,print
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;07&nbsp;01:09:05&nbsp;2019</span>
    <span class="description">RRA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127964] Net::Duo and new pagination requirements for Duo API</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 06 Mar 2019 22:08:56 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Russ Allbery via RT&#34; &lt;bug-Net-Duo [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Russ Allbery &lt;rra [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Russ Allbery via RT&#34; &lt;bug-Net-Duo@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Awesome, thank you so much!  I got a bit sidetracked by a bad cold, but
&gt; the new release should be out today or tomorrow.
</div>
Net::Duo 1.02 has now been released with a fix for this problem.

-- 
#!/usr/bin/perl -- Russ Allbery, Just Another Perl Hacker
$^=q;@!&gt;~|{&gt;krw&gt;yn{u&lt;$$&lt;[~||&lt;Juukn{=,&lt;S~|}&lt;Jwx}qn{&lt;Yn{u&lt;Qjltn{ &gt; 0gFzD gD,
 00Fz, 0,,&#40; 0hF 0g&#41;F/=, 0&gt; &#34;L$/GEIFewe{,$/ 0C$~&gt; &#34;@=,m,|,&#40;e 0.&#41;, 01,pnn,y{
rw} &gt;;,$0=q,$,,&#40;$_=$^&#41;=~y,$/ C-~&gt;&lt;@=\n\r,-~$:-u/ #y,d,s,&#40;\$.&#41;,$1,gee,print
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;04&nbsp;23:18:46&nbsp;2020</span>
    <span class="description">RRA [...] cpan.org -  Fixed in 1.02 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;04&nbsp;23:18:46&nbsp;2020</span>
    <span class="description">RRA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This was fixed in 1.02 but was never closed. Doing that belatedly.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;04&nbsp;23:18:47&nbsp;2020</span>
    <span class="description">RRA [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;04&nbsp;23:18:47&nbsp;2020</span>
    <span class="description">RRA [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
