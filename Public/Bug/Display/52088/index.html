<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #52088 for Convert-ASN1: ASN.1 encoding of integers &gt; 0x7FFFFFFF</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #52088 for Convert-ASN1: ASN.1 encoding of integers &gt; 0x7FFFFFFF</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Convert-ASN1/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Convert-ASN1/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Convert-ASN1/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Convert-ASN1/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/gbarr/perl-Convert-ASN1/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Convert-ASN1">Convert-ASN1 CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">52088</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Convert-ASN1/Active/">Convert-ASN1</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gbarr [...] pobox.com

<br />
markus [...] wernig.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-7912-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-7913-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




smime.p7s<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/697666/359760/smime.p7s">
Thu Nov 26 06:48:13 2009 (5.4k) by markus [...] wernig.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;06:48:13&nbsp;2009</span>
    <span class="description">markus [...] wernig.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> gbarr [...] pobox.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ASN.1 encoding of integers &gt; 0x7FFFFFFF</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 26 Nov 2009 12:44:00 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Convert-ASN1 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Markus Wernig &lt;markus [...] wernig.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello

I have noted that Convert::ASN1 encodes integers &gt; 0x7FFFFFFF
differently from what I would expect.

The following example should demonstrate the behaviour:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- BEGIN EXAMPLE -----
#!/usr/bin/perl

use Convert::ASN1 qw &#40; :all &#41;;
use strict;

my $asn = Convert::ASN1-&gt;new;
$asn-&gt;configure&#40;&#39;encoding&#39; =&gt; &#39;DER&#39;&#41;;

$asn-&gt;prepare&#40;q&lt;

        int INTEGER

<div class="message-stanza open">&gt;&#41; or print &#34;Error preparing was: &#34;, $asn-&gt;{&#39;error&#39;}, &#34;\n&#34;;
</div>
my $pdu = undef;
$pdu = $asn-&gt;encode&#40;
        int     =&gt; 0xDEADBEEF
&#41; or print &#34;Error encoding was: &#34;, $asn-&gt;{&#39;error&#39;}, &#34;\n&#34;;

print unpack&#40;&#39;H*&#39;, $pdu&#41;, &#34;\n&#34;;

<div class="message-stanza open">----- END EXAMPLE -----

This results in an ASN.1 Hex representation of:

020500deadbeef

Which I don`t understand. I would have expected it to be

0204deadbeef

instead.

0x80000000 results in 02050080000000
0x7FFFFFFF results in 02047FFFFFFF

To my understanding, encoding an extra leading byte with 00 contradicts
X.690, which states in 8.3.2:
&#34;If the contents octets of an integer value encoding consist of more
than one octet, then the bits of the first octet
and bit 8 of the second octet:
a&#41; shall not all be ones; and
b&#41; shall not all be zero.&#34;

I assume this has to do with signedness and the size of an integer on
the system the program is run on, but could not find any reference to it
in the documentation. The results are the same on 32 and 64 bit systems.

I&#39;m not quite sure if this is a bug, and would be grateful if you could
have a look at it. If this is intended behaviour, could you please share
the rationale behind it &#40;any pointer welcome&#41;.

Thank you very much

Markus


-- 
Markus Wernig
Unix/Network Security Engineer - CISSP, CCSE
GPG: CA558BF7
<span class="clickylink"><a target="new" rel="nofollow" href="http://xfer.ch">http://xfer.ch</a></span>
---------------------------------------------
Linux User Group Bern - <span class="clickylink"><a target="new" rel="nofollow" href="http://lugbe.ch">http://lugbe.ch</a></span>
---------------------------------------------
</div></div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/697666/359760/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/x-pkcs7-signature 5.4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:53:13&nbsp;2009</span>
    <span class="description">gbarr [...] pobox.com - Ticket #52093:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> bug-Convert-ASN1 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: ASN.1 encoding of integers &gt; 0x7FFFFFFF</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 26 Nov 2009 09:52:43 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Markus Wernig &lt;markus [...] wernig.net&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Graham Barr &lt;gbarr [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Nov 26, 2009, at 5:44 AM, Markus Wernig wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello
&gt; 
&gt; I have noted that Convert::ASN1 encodes integers &gt; 0x7FFFFFFF
&gt; differently from what I would expect.
&gt; 
&gt; The following example should demonstrate the behaviour:
&gt; 
&gt; ----- BEGIN EXAMPLE -----
&gt; #!/usr/bin/perl
&gt; 
&gt; use Convert::ASN1 qw &#40; :all &#41;;
&gt; use strict;
&gt; 
&gt; my $asn = Convert::ASN1-&gt;new;
&gt; $asn-&gt;configure&#40;&#39;encoding&#39; =&gt; &#39;DER&#39;&#41;;
&gt; 
&gt; $asn-&gt;prepare&#40;q&lt;
&gt; 
&gt;        int INTEGER
&gt; 
<div class="message-stanza open">&gt;&gt; &#41; or print &#34;Error preparing was: &#34;, $asn-&gt;{&#39;error&#39;}, &#34;\n&#34;;
</div>&gt; 
&gt; my $pdu = undef;
&gt; $pdu = $asn-&gt;encode&#40;
&gt;        int     =&gt; 0xDEADBEEF
&gt; &#41; or print &#34;Error encoding was: &#34;, $asn-&gt;{&#39;error&#39;}, &#34;\n&#34;;
&gt; 
&gt; print unpack&#40;&#39;H*&#39;, $pdu&#41;, &#34;\n&#34;;
&gt; ----- END EXAMPLE -----
&gt; 
&gt; This results in an ASN.1 Hex representation of:
&gt; 
&gt; 020500deadbeef
&gt; 
&gt; Which I don`t understand. I would have expected it to be
&gt; 
&gt; 0204deadbeef
&gt; 
&gt; instead.
&gt; 
&gt; 0x80000000 results in 02050080000000
&gt; 0x7FFFFFFF results in 02047FFFFFFF
&gt; 
&gt; To my understanding, encoding an extra leading byte with 00 contradicts
&gt; X.690, which states in 8.3.2:
&gt; &#34;If the contents octets of an integer value encoding consist of more
&gt; than one octet, then the bits of the first octet
&gt; and bit 8 of the second octet:
&gt; a&#41; shall not all be ones; and
&gt; b&#41; shall not all be zero.&#34;
</div>
How does it contradict? that states that the left most 9 bits cannot all be the same

in binary the first byte and bit 8 of the second byte are 00000001

basically the left most bit denotes sign, 0xDEADBEEF is unsigned but 0204DEADBEEF is a negative number because the left most bit is 1

Graham.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I assume this has to do with signedness and the size of an integer on
&gt; the system the program is run on, but could not find any reference to it
&gt; in the documentation. The results are the same on 32 and 64 bit systems.
&gt; 
&gt; I&#39;m not quite sure if this is a bug, and would be grateful if you could
&gt; have a look at it. If this is intended behaviour, could you please share
&gt; the rationale behind it &#40;any pointer welcome&#41;.
&gt; 
&gt; Thank you very much
&gt; 
&gt; Markus
&gt; 
&gt; 
&gt; -- 
&gt; Markus Wernig
&gt; Unix/Network Security Engineer - CISSP, CCSE
&gt; GPG: CA558BF7
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://xfer.ch">http://xfer.ch</a></span>
&gt; ---------------------------------------------
&gt; Linux User Group Bern - <span class="clickylink"><a target="new" rel="nofollow" href="http://lugbe.ch">http://lugbe.ch</a></span>
&gt; ---------------------------------------------
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:54:02&nbsp;2009</span>
    <span class="description">GBARR [...] CPAN.ORG -  Status changed from &#39;new&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:54:54&nbsp;2009</span>
    <span class="description">GBARR [...] CPAN.ORG - Ticket #52093:  Merged into ticket #52088</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;10:54:54&nbsp;2009</span>
    <span class="description">GBARR [...] CPAN.ORG -  Merged into ticket #52088</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
