<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #6883 for libwww-perl: Incorrect HTTP status code returned if RST packet is received from server upon HTTP request</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #6883 for libwww-perl: Incorrect HTTP status code returned if RST packet is received from server upon HTTP request</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/libwww-perl/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/libwww-perl">libwww-perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">6883</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/libwww-perl/Active/">libwww-perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
sgt_b [...] security-forums.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-18330-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
5.800    </td>
  </tr>
  <tr id="CF-18331-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;07&nbsp;18:00:39&nbsp;2004</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Incorrect HTTP status code returned if RST packet is received
 from server upon HTTP request</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Running Perl 5.8.3 on Slackware Linux 9.1 Kernel 2.6.4
libwww-perl-5.800
Webserver running Apache 2.0.49 on FreeBSD 4.10
In a Denial of Service condition, the webserver will begin sending out RST packets for all new connections. While this condition is taking place, a request is sent by the following perl script. The status code of 200 is returned, when the only response the script received from its request was an RST packet.
Here is the test script:
-------------
#!/usr/bin/perl
use LWP;
use HTTP::Request::Common;
use HTTP::Response;

$ua = LWP::UserAgent-&gt;new;
$response = $ua-&gt;request&#40;GET &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://victim.local.net">http://victim.local.net</a></span>&#34;&#41;;
if &#40;$response-&gt;is_success&#41; {
        print &#34;success &#34;, $response-&gt;code&#40;&#41;.&#34;\n&#34;;
}else{
        print &#34;failed &#34;, $response-&gt;code&#40;&#41;.&#34;\n&#34;;
}
--------------

The following packet trace was generated from this script. 192.168.3.17 is the script host, and 192.168.3.31 is the webserver.

--------------
21:18:17.965957 192.168.3.17.3939 &gt; 192.168.3.31.80: S [tcp sum ok] 2630041349:2630041349&#40;0&#41; win 5840 &lt;mss 1460,sackOK,timestamp 20538814 0,nop,wscale 0&gt; &#40;DF&#41; &#40;ttl 64, id 23227, len 60&#41;
0x0000   4500 003c 5abb 4000 4006 5880 c0a8 0311        E..&lt;Z.@.@.X.....
0x0010   c0a8 031f 0f63 0050 9cc3 3f05 0000 0000        .....c.P..?.....
0x0020   a002 16d0 5743 0000 0204 05b4 0402 080a        ....WC..........
0x0030   0139 65be 0000 0000 0103 0300                  .9e.........
21:18:17.965993 192.168.3.31.80 &gt; 192.168.3.17.3939: S [tcp sum ok] 645439017:645439017&#40;0&#41; ack 2630041350 win 57344 &lt;mss 1460,nop,wscale 0,nop,nop,timestamp 18079034 20538814&gt; &#40;DF&#41; &#40;ttl 64, id 56437, len 60&#41;
0x0000   4500 003c dc75 4000 4006 d6c5 c0a8 031f        E..&lt;.u@.@.......
0x0010   c0a8 0311 0050 0f63 2678 9e29 9cc3 3f06        .....P.c&#38;x.&#41;..?.
0x0020   a012 e000 ee12 0000 0204 05b4 0103 0300        ................
0x0030   0101 080a 0113 dd3a 0139 65be                  .......:.9e.
21:18:17.969021 192.168.3.17.3939 &gt; 192.168.3.31.80: . [tcp sum ok] ack 1 win 5840 &lt;nop,nop,timestamp 20538817 18079034&gt; &#40;DF&#41; &#40;ttl 64, id 23228, len 52&#41;
0x0000   4500 0034 5abc 4000 4006 5887 c0a8 0311        E..4Z.@.@.X.....
0x0010   c0a8 031f 0f63 0050 9cc3 3f06 2678 9e2a        .....c.P..?.&#38;x.*
0x0020   8010 16d0 e304 0000 0101 080a 0139 65c1        .............9e.
0x0030   0113 dd3a                                      ...:
21:18:18.195585 192.168.3.17.3939 &gt; 192.168.3.31.80: P [tcp sum ok] 1:121&#40;120&#41; ack 1 win 5840 &lt;nop,nop,timestamp 20539044 18079034&gt; &#40;DF&#41; &#40;ttl 64, id 23229, len 172&#41;
0x0000   4500 00ac 5abd 4000 4006 580e c0a8 0311        E...Z.@.@.X.....
0x0010   c0a8 031f 0f63 0050 9cc3 3f06 2678 9e2a        .....c.P..?.&#38;x.*
0x0020   8018 16d0 f814 0000 0101 080a 0139 66a4        .............9f.
0x0030   0113 dd3a 4745 5420 2f20 4854 5450 2f31        ...:GET./.HTTP/1
0x0040   2e31 0d0a 5445 3a20 6465 666c 6174 652c        .1..TE:.deflate,
0x0050   677a 6970 3b71 3d30 2e33 0d0a 436f 6e6e        gzip;q=0.3..Conn
0x0060   6563 7469 6f6e 3a20 5445 2c20 636c 6f73        ection:.TE,.clos
0x0070   650d 0a48 6f73 743a 2076 6963 7469 6d2e        e..Host:.victim.
0x0080   6c6f 6361 6c2e 6e65 740d 0a55 7365 722d        local.net..User-
0x0090   4167 656e 743a 206c 6962 7777 772d 7065        Agent:.libwww-pe
0x00a0   726c 2f35 2e38 3030 0d0a 0d0a                  rl/5.800....
21:18:18.195614 192.168.3.31.80 &gt; 192.168.3.17.3939: R [tcp sum ok] 645439018:645439018&#40;0&#41; win 0 &#40;ttl 64, id 56538, len 40&#41;
0x0000   4500 0028 dcda 0000 4006 1675 c0a8 031f        E..&#40;....@..u....
0x0010   c0a8 0311 0050 0f63 2678 9e2a 0000 0000        .....P.c&#38;x.*....
0x0020   5004 0000 540a 0000                            P...T... 
------------------------

The script outputs the following:

------------------------

sgt_b@slacktop:~/perl$ ./test.pl  
success 200
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;15&nbsp;16:28:40&nbsp;2004</span>
    <span class="description">GAAS [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
