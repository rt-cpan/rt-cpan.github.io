<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #7087 for Text-Diff: Test failure on Cygwin - easy fix</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #7087 for Text-Diff: Test failure on Cygwin - easy fix</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Text-Diff/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Text-Diff/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Text-Diff/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Text-Diff/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Text-Diff">Text-Diff CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">7087</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">10 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Text-Diff/Active/">Text-Diff</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
maxb [...] ukf.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-31890-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.35    </td>
  </tr>
  <tr id="CF-31891-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;25&nbsp;13:23:18&nbsp;2004</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Test failure on Cygwin - easy fix</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The testsuite fails on Cygwin, hindering CPAN install.

The problem is a small one: The same output temporary file is used twice consecutively. Windows can sometimes be lazy about releasing file locks, with the result that the second use fails. The fix is trivial - use a different temporary file name for the second test.

Patch attached.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Text-Diff-0.35/t/outputs.t.orig	2004-07-24 11:37:00.127883200 +0100
+++ Text-Diff-0.35/t/outputs.t	2004-07-24 11:38:53.420790400 +0100
@@ -30,11 +30,11 @@
 
 sub {
     require IO::File ;
-    my $fh = IO::File-&gt;new&#40; &#34;&gt;output.t.foo&#34; &#41; ;
+    my $fh = IO::File-&gt;new&#40; &#34;&gt;output.t.foo2&#34; &#41; ;
     _d $fh ;
     $fh = undef ;
-    ok slurp &#34;output.t.foo&#34;, $expected ;
-    unlink &#34;output.t.foo&#34; or warn $! ;
+    ok slurp &#34;output.t.foo2&#34;, $expected ;
+    unlink &#34;output.t.foo2&#34; or warn $! ;
 },
 
 sub { ok 0 &lt; index&#40; diff&#40; \&#34;\n&#34;, \&#34;&#34;, { STYLE =&gt; &#34;Table&#34; } &#41;, &#34;\\n&#34; &#41; },
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;21&nbsp;16:24:54&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> cpan [...] pjedwards.co.uk</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jul 25 13:23:18 2004, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The testsuite fails on Cygwin, hindering CPAN install.
&gt; 
&gt; The problem is a small one: The same output temporary file is used
&gt;    twice consecutively. Windows can sometimes be lazy about releasing
&gt;    file locks, with the result that the second use fails. The fix is
&gt;    trivial - use a different temporary file name for the second test.
&gt; 
&gt; Patch attached.
</div>
Just wanted to add that this test case, &#40;and suggested patch for Cygwin&#41;
fail on VMS, a filename with two periods &#39;.&#39; is not a valid filename
under VMS.

From: <span class="clickylink"><a target="new" rel="nofollow" href="http://perldoc.perl.org/perlport.html#Files-and-Filesystems">http://perldoc.perl.org/perlport.html#Files-and-Filesystems</a></span>

&#34;Do not have two files or directories of the same name with different 
case, like test.pl and Test.pl, as many platforms have case-insensitive 
&#40;or at least case-forgiving&#41; filenames. Also, try not to have non-word 
characters &#40;except for .&#41; in the names, and keep them to the 8.3 
convention, for maximum portability, onerous a burden though this may 
appear.&#34;

Thanks,

Peter &#40;Stig&#41; Edwards
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;21&nbsp;16:24:55&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;19&nbsp;10:13:44&nbsp;2007</span>
    <span class="description">alexander.danel [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> alexander.danel [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">With &#39;cygwin&#39;, in module Text::Diff, for the error:

    t/outputs.......No such file or directory at t/outputs.t line 37,
&lt;SLURP&gt; line 6.

I had to comment out line 29, where the &#39;unlink &#34;output.t.foo&#34;&#39; 
command appears.  &#40;There are two &#39;unlink&#39; commands in the file, 
only this, the first one, needs to be commented out.&#41;

The proposed patch of using two different names didn&#39;t work or me.

AL_X

#  - - - - - - - - - -  
On Sun Jul 25 13:23:18 2004, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The testsuite fails on Cygwin, hindering CPAN install.
&gt; 
&gt; The problem is a small one: The same output temporary file is used
&gt;    twice consecutively. Windows can sometimes be lazy about releasing
&gt;    file locks, with the result that the second use fails. The fix is
&gt;    trivial - use a different temporary file name for the second test.
&gt; 
&gt; Patch attached.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;07&nbsp;07:30:40&nbsp;2007</span>
    <span class="description">RURBAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">10 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 19 10:13:44 2007, alexander.danel@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; With &#39;cygwin&#39;, in module Text::Diff, for the error:
&gt; 
&gt;     t/outputs.......No such file or directory at t/outputs.t line 37,
&gt; &lt;SLURP&gt; line 6.
</div>
Works for me, cygwin perl-5.8.8 and perl-5.10.0.
But I improved the patch a bit.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I had to comment out line 29, where the &#39;unlink &#34;output.t.foo&#34;&#39; 
&gt; command appears.  &#40;There are two &#39;unlink&#39; commands in the file, 
&gt; only this, the first one, needs to be commented out.&#41;
&gt; 
&gt; The proposed patch of using two different names didn&#39;t work or me.
&gt; 
&gt; AL_X
&gt; 
&gt; #  - - - - - - - - - -  
&gt; On Sun Jul 25 13:23:18 2004, guest wrote:
<div class="message-stanza open">&gt; &gt; The testsuite fails on Cygwin, hindering CPAN install.
&gt; &gt; 
&gt; &gt; The problem is a small one: The same output temporary file is used
&gt; &gt;    twice consecutively. Windows can sometimes be lazy about releasing
&gt; &gt;    file locks, with the result that the second use fails. The fix is
&gt; &gt;    trivial - use a different temporary file name for the second test.
&gt; &gt; 
&gt; &gt; Patch attached.
</div>&gt; 
&gt; 
</div>

-- 
Reini Urban
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">difforig Text-Diff-0.35

2007-10-07  Reini Urban &lt;rurban@x-ray.at&gt;

diff -ub  Text-Diff-0.35/lib/Text/Diff.pm.orig
--- Text-Diff-0.35/lib/Text/Diff.pm.orig	2002-08-27 17:53:13.000000000 +0000
+++ Text-Diff-0.35/lib/Text/Diff.pm	2007-10-07 11:27:03.843750000 +0000
@@ -1,6 +1,6 @@
 package Text::Diff;
 
-$VERSION = 0.35;
+$VERSION = &#34;0.35_01&#34;;
 
 =head1 NAME
 
diff -ub  Text-Diff-0.35/t/general.t.orig
--- Text-Diff-0.35/t/general.t.orig	2001-12-16 12:42:15.000000000 +0000
+++ Text-Diff-0.35/t/general.t	2007-10-07 11:23:49.859375000 +0000
@@ -126,8 +126,8 @@
         warn &#34;# diff options: $diff_opts\n&#34; ;
         warn &#34;# my options: $Diff_opts\n&#34; ;
         ## Merge the outputs using A::D
-        my @E = split /^/g, $expect ;
-        my @G = split /^/g, $output ;
+        my @E = split /^/, $expect ;
+        my @G = split /^/, $output ;
         my $w = length &#34;Expected&#34; ;
         for &#40; @E, @G &#41; {
             s/\n/\\n/g ;
diff -ub  Text-Diff-0.35/t/outputs.t.orig
--- Text-Diff-0.35/t/outputs.t.orig	2002-08-27 17:52:50.000000000 +0000
+++ Text-Diff-0.35/t/outputs.t	2007-10-07 11:22:33.609375000 +0000
@@ -30,11 +30,11 @@
 
 sub {
     require IO::File ;
-    my $fh = IO::File-&gt;new&#40; &#34;&gt;output.t.foo&#34; &#41; ;
+    my $fh = IO::File-&gt;new&#40; &#34;&gt;output.t.foo2&#34; &#41; ;
     _d $fh ;
     $fh = undef ;
-    ok slurp &#34;output.t.foo&#34;, $expected ;
-    unlink &#34;output.t.foo&#34; or warn $! ;
+    ok slurp &#34;output.t.foo2&#34;, $expected ;
+    unlink &#34;output.t.foo2&#34; or warn $! ;
 },
 
 sub { ok 0 &lt; index&#40; diff&#40; \&#34;\n&#34;, \&#34;&#34;, { STYLE =&gt; &#34;Table&#34; } &#41;, &#34;\\n&#34; &#41; },
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">---
comment: &#34;#7087: Test failure on Cygwin - easy fix&#34;
match:
  distribution: &#34;^RBS/Text-Diff-0\.35\.tar\.gz$&#34;
patches:
  - &#34;../Text-Diff-0.35.patch&#34;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;06&nbsp;18:08:00&nbsp;2008</span>
    <span class="description">dm_bradford [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> davembradford [...] gmail.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">closing the file in slurp&#40;&#41; worked for me:
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Text-Diff-0.35/t/outputs.t	2002-08-27 13:52:50.000000000 -0400
+++ Text-Diff-0.35.good/t/outputs.t	2008-06-06 17:47:43.563500000 -0400
@@ -9,7 +9,7 @@
 
 sub _d&#40;$&#41; { diff \@A, \@B, { OUTPUT =&gt; shift } }
 
-sub slurp { open SLURP, &#34;&lt;&#34; . shift or die $! ; return join &#34;&#34;, &lt;SLURP&gt; }
+sub slurp { open SLURP, &#34;&lt;&#34; . shift or die $! ; my $jj = join &#34;&#34;, &lt;SLURP&gt;; close SLURP; return $jj }
 
 my $expected  = _d undef ;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;06&nbsp;18:13:42&nbsp;2008</span>
    <span class="description">dm_bradford [...] hotmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jun 06 18:08:00 2008, DBRADFORD wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; closing the file in slurp&#40;&#41; worked for me:
</div>
Reposting to display plain text

--- Text-Diff-0.35/t/outputs.t  2002-08-27 13:52:50.000000000 -0400
+++ Text-Diff-0.35.good/t/outputs.t     2008-06-06 17:47:43.563500000 -0400
@@ -9,7 +9,7 @@
 
 sub _d&#40;$&#41; { diff \@A, \@B, { OUTPUT =&gt; shift } }
 
-sub slurp { open SLURP, &#34;&lt;&#34; . shift or die $! ; return join &#34;&#34;, &lt;SLURP&gt; }
+sub slurp { open SLURP, &#34;&lt;&#34; . shift or die $! ; my $jj = join &#34;&#34;,
&lt;SLURP&gt;; close SLURP; return $jj }
 
 my $expected  = _d undef ;
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -u Text-Diff-0.35/t/general.t Text-Diff-0.35.good/t/general.t
--- Text-Diff-0.35/t/general.t	2001-12-16 07:42:15.000000000 -0500
+++ Text-Diff-0.35.good/t/general.t	2008-06-06 17:48:34.204125000 -0400
@@ -126,8 +126,8 @@
         warn &#34;# diff options: $diff_opts\n&#34; ;
         warn &#34;# my options: $Diff_opts\n&#34; ;
         ## Merge the outputs using A::D
-        my @E = split /^/g, $expect ;
-        my @G = split /^/g, $output ;
+        my @E = split /^/, $expect ;
+        my @G = split /^/, $output ;
         my $w = length &#34;Expected&#34; ;
         for &#40; @E, @G &#41; {
             s/\n/\\n/g ;
diff -u Text-Diff-0.35/t/outputs.t Text-Diff-0.35.good/t/outputs.t
--- Text-Diff-0.35/t/outputs.t	2002-08-27 13:52:50.000000000 -0400
+++ Text-Diff-0.35.good/t/outputs.t	2008-06-06 17:47:43.563500000 -0400
@@ -9,7 +9,7 @@
 
 sub _d&#40;$&#41; { diff \@A, \@B, { OUTPUT =&gt; shift } }
 
-sub slurp { open SLURP, &#34;&lt;&#34; . shift or die $! ; return join &#34;&#34;, &lt;SLURP&gt; }
+sub slurp { open SLURP, &#34;&lt;&#34; . shift or die $! ; my $jj = join &#34;&#34;, &lt;SLURP&gt;; close SLURP; return $jj }
 
 my $expected  = _d undef ;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;28&nbsp;17:35:26&nbsp;2009</span>
    <span class="description">amir.aharoni [...] mail.huji.ac.il -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> amir.aharoni [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jul 25 13:23:18 2004, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The testsuite fails on Cygwin, hindering CPAN install.
&gt; 
&gt; The problem is a small one: The same output temporary file is used
&gt;    twice consecutively. Windows can sometimes be lazy about releasing
&gt;    file locks, with the result that the second use fails. The fix is
&gt;    trivial - use a different temporary file name for the second test.
&gt; 
&gt; Patch attached.
</div>
Is it possible to incorporate this patch to the version on CPAN?

It is impossible now to install this module using CPAN shell on Cygwin,
and also impossible to install other modules that depend on this one -
Test::Differences, Test::Most, Padre and probably others.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;04&nbsp;02:41:47&nbsp;2009</span>
    <span class="description">ddascalescu+perl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ddascalescu+perl [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Quick update:

I just got co-maintenance for this module and am working through thru
bug queue.

On Windows, the issue is that file HANDLES &#40;like &#34;SLURP&#34;&#41; apparently
aren&#39;t automatically closed as soon as they go out of scope. I didn&#39;t
dig into why this happens because it&#39;s 2002-era code anyway.

The modern way of doing a slurp is like this:

sub slurp {
    open my $file_in, &#39;&lt;&#39;, shift or die $!;
    local $/; return &lt;$file_in&gt;;
}

Tests pass. Stay tuned, I&#39;ll try to release a new version tomorrow.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
