<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #132683 for Regexp-Debugger: Regexp::Debugger always treats &#34;#&#34; as a comment character regardless of the /x flag.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #132683 for Regexp-Debugger: Regexp::Debugger always treats &#34;#&#34; as a comment character regardless of the /x flag.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Regexp-Debugger/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Regexp-Debugger/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Regexp-Debugger/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Regexp-Debugger/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Regexp-Debugger">Regexp-Debugger CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">132683</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Regexp-Debugger/Active/">Regexp-Debugger</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
deven [...] ties.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-244830-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
0.001000</li>
<li>
0.001001</li>
<li>
0.001002</li>
<li>
0.001003</li>
<li>
0.001004</li>
<li>
0.001005</li>
<li>
0.001006</li>
<li>
0.001007</li>
<li>
0.001008</li>
<li>
0.001009</li>
<li>
0.001010</li>
<li>
0.001011</li>
<li>
0.001012</li>
<li>
0.001013</li>
<li>
0.001014</li>
<li>
0.001015</li>
<li>
0.001016</li>
<li>
0.001017</li>
<li>
0.001018</li>
<li>
0.001019</li>
<li>
0.001020</li>
<li>
0.001021</li>
<li>
0.001022</li>
<li>
0.002000</li>
<li>
0.002001</li>
<li>
0.002002</li>
<li>
0.002003</li>
<li>
0.002004</li>
</ul>
    </td>
  </tr>
  <tr id="CF-244831-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;22&nbsp;19:57:43&nbsp;2020</span>
    <span class="description">deven [...] ties.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Regexp::Debugger always treats &#34;#&#34; as a comment character
 regardless of the /x flag.</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Regexp::Debugger is awesome!  But I did find a bug in it relating to the /x flag...

Here is a very simple test case:

     perl -MRegexp::Debugger -e &#39;/&#40;#&#41;/&#39;

This is a perfectly valid regular expression which should match &#40;and capture&#41; a literal &#34;#&#34; character, but if Regexp::Debugger is loaded, it treats the &#34;#&#34; as a comment character, incorrectly commenting out the closing parenthesis and causing an error:

Unmatched &#40; in regex; marked by &lt;-- HERE in m/&#40;?#R_d:0&#41;&#40;?&gt;\A&#40;?{Regexp::Debugger::_reset_debugger_state&#40;&#41;}&#41;&#40;?!&#41;|\G&#40;?{Regexp::Debugger::_reset_debugger_state_rematch&#40;&#41;}&#41;&#40;?!&#41;&#41;|&#40; &lt;-- HERE ?:&#40;?{Regexp::Debugger::_report_event&#40;0, 0, pos&#40;&#41;&#41;; $^R}&#41;&#40;?=[\d\D]?&#40;?{1}&#41;&#41;&#40;?:&#40;&#40;?{Regexp::Debugger::_report_event&#40;0, 1, pos&#40;&#41;&#41;; $^R}&#41;&#40;?=[\d\D]?&#40;?{1}&#41;&#41;&#40;?:&#40;?&gt;&#40;?{local $Regexp::Debugger::prevpos=pos}&#41;#&#41;&#40;?{
            if &#40;defined $Regexp::Debugger::prevpos &#38;&#38; $Regexp::Debugger::prevpos &lt; pos&#41;{
                Regexp::Debugger::_report_event&#40;0, 2, $Regexp::Debugger::prevpos&#41;;
                Regexp::Debugger::_report_event&#40;0, 2+1, pos&#40;&#41;&#41;;
            }$^R }&#41;|&#40;?{
                Regexp::Debugger::_report_event&#40;0, 2, pos&#40;&#41;&#41;;
            $^R
            }&#41;&#40;?!&#41;&#41;&#41;&#40;?{Regexp::Debugger::_report_event&#40;0, 4, pos&#40;&#41;&#41;; $^R}&#41;&#40;?=[\d\D]?&#40;?{1}&#41;&#41;|&#40;?{Regexp::Debugger::_report_event&#40;0, 5, pos&#40;&#41;&#41;; $^R}&#41;&#40;?=[\d\D]?&#40;?{1}&#41;&#41;&#40;?!&#41;&#41;/ at &#40;eval 8&#41; line 8.

&#40;This regular expression can also be entered into &#34;rxrx&#34; with similar results.&#41;

The &#34;#&#34; should behave as a comment character like this IF the /x flag is on, but in this case it isn&#39;t, so it should match literally.  &#40;Using &#34;\#&#34; is a workaround for this bug.&#41;

This bug is present in every version of Regexp::Debugger from 0.001000 through 0.002004, which is the current version.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;22&nbsp;23:37:36&nbsp;2020</span>
    <span class="description">DCONWAY [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;22&nbsp;23:37:54&nbsp;2020</span>
    <span class="description">damian [...] conway.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #132683] Regexp::Debugger always treats &#34;#&#34; as a comment character regardless of the /x flag.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 23 May 2020 03:37:11 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Debugger [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Damian Conway &lt;damian [...] conway.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Deven,

It is indeed annoying that R::D can&#39;t reliably detect the presence or
absence
of /x on the regexes it modifies.

Unfortunately, as far as I can discover, there is simply no mechanism
available
in Perl to acquire that information within the overload::constant mechanism
that the module uses to inject its debugging behaviours into each regex.

The module&#39;s documentation is very long, so you may well have missed it,
but the &#34;LIMITATIONS&#34; section near the end of the docs specifically
highlights
this very problem in some detail.

And that would have been the end of my response, except that working on
your example led me to come up with a sneaky approach that now makes
the module much better at correctly inferring whether the /x flag is likely
to be in use or not. In fact, sufficiently much better that it now
correctly
handles your particular example &#40;and most other non-/x cases as well&#41;.
It&#39;s still not perfect, but at least it&#39;s no longer hopeless. :-&#41;

Alas, I don&#39;t foresee that I&#39;m going to be able to fully fix this issue for
all possible cases; not until overload::constant is extended to explicitly
provide the necessary information. Which I suspect it never will be. :-&#40;

Anyway, give the latest release &#40;just uploaded to CPAN&#41; a try and see
if it works better for you.

Thanks again for bringing this issue to my attention,
Damian
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
