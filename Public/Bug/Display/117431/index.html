<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #117431 for DateTime-TimeZone: Fwd: DateTime::TimeZone giving error Can&#39;t locate object method &#34;offset_as_string&#34;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #117431 for DateTime-TimeZone: Fwd: DateTime::TimeZone giving error Can&#39;t locate object method &#34;offset_as_string&#34;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DateTime-TimeZone/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DateTime-TimeZone/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DateTime-TimeZone/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DateTime-TimeZone/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/houseabsolute/DateTime-TimeZone/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/DateTime-TimeZone">DateTime-TimeZone CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">117431</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DateTime-TimeZone/Active/">DateTime-TimeZone</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
don [...] beusee.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-9962-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-9963-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;02&nbsp;03:51:03&nbsp;2016</span>
    <span class="description">don [...] beusee.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fwd: DateTime::TimeZone giving error Can&#39;t locate object method &#34;offset_as_string&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Sep 2016 00:56:03 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DateTime-TimeZone [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Don Beusee &lt;don [...] beusee.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I was trying to install the latest bugzilla, which uses this package, 
and I found the behavior difficult to troubleshoot.  See the below email 
chain and the simple perl program I used to troubleshoot the issue.  My 
simple test program &#40;see the email chain below&#41; was getting:

Can&#39;t locate object method &#34;offset_as_string&#34; via package 
&#34;DateTime::TimeZone::Tzfile&#34; at test.pl line 25.

I finally narrowed down the error was due to my linux &#40;fedora 23&#41; system 
didn&#39;t have the timezone location defined, even though the date command 
returned the proper timezone &#40;PDT&#41;.

My suggestion is that when this package cannot determine the location, 
give a more meaningful error about the need to configure the timezone 
*location*.

Thanks,
-Don

------------------------------------------------------------------------
*From:* Don Beusee
*Sent:* Tuesday, August 30, 2016 7:15PM
*To:* Support-bugzilla
*Subject:* Re: Installing recent versions of bugzilla giving error Can&#39;t 
locate object method &#34;offset_as_string&#34;

Problem solved!  I figured it out by installing FC23 fresh on a new VM, 
and I noticed it worked there, and it returns an object type matching 
the timezone location instead of DateTime::TimeZone::Tzfile &#40;for 
instance, DateTime::TimeZone::America::Los_Angeles&#41;.  So the 
DateTime::TimeZone doesn&#39;t error out indicating it cannot determine the 
timezone location.  Even though the system knew it was in PDT timezone 
as the date command demonstrated, that isn&#39;t enough for this package.  I 
had to run system-config-date and set the timezone from there to set it 
to the closest location - in my case, to Los Angeles.  I&#39;m actually 
surprised more people haven&#39;t run into this issue.

-Don

------------------------------------------------------------------------
*From:* Don Beusee
*Sent:* Tuesday, August 30, 2016 4:57PM
*To:* Support-bugzilla
*Subject:* Re: Installing recent versions of bugzilla giving error Can&#39;t 
locate object method &#34;offset_as_string&#34;

Emmanuel ,

I have another system, running Fedora 20 x86, and the script works 
there.  This system has an earlier version of DateTime::TimeZone.

I modified the simple script to confirm the version of the 
DateTime::TimeZone package that is actually loaded:

#!/usr/bin/perl
use DateTime::TimeZone;
print &#34;version=&#34; . $DateTime::TimeZone::VERSION . &#34;\n&#34;;
my $ltz = DateTime::TimeZone-&gt;new&#40;name =&gt; &#39;local&#39;&#41;;
print &#34;tz offset=&#34; . $ltz-&gt;offset_as_string&#40;-25200&#41; . &#34;\n&#34;;


When I run this on the Fedora 20 x86 system, I get:

[root@pp10-vm ~]# perl test.pl
version=1.76
tz offset=-0700
[root@pp10-vm ~]#

When I run it on the fedora 23 x64 system, I get:

[root@pp10 bugzilla-5.1.1]# perl test.pl
version=2.01
Can&#39;t locate object method &#34;offset_as_string&#34; via package 
&#34;DateTime::TimeZone::Tzfile&#34; at test.pl line 5.
[root@pp10 bugzilla-5.1.1]#

I just added more code to display all the loaded package versions.

Can you run the script below and send all the output back to me?

#!/usr/bin/perl
#BEGIN {
#@INC=&#40;
#        #&#39;/usr/local/lib64/perl5&#39;.
#        #&#39;/usr/local/share/perl5&#39;,
#    &#39;/usr/lib64/perl5/vendor_perl&#39;,
#    &#39;/usr/share/perl5/vendor_perl&#39;,
#    &#39;/usr/lib64/perl5&#39;,
#    &#39;/usr/share/perl5&#39;,
#    #&#39;.&#39;
#    &#41;;
#}
use DateTime::TimeZone;
print &#34;DateTime::TimeZone::VERSION=&#34; . $DateTime::TimeZone::VERSION . &#34;\n&#34;;
my $ltz = DateTime::TimeZone-&gt;new&#40;name =&gt; &#39;local&#39;&#41;;
#print join $/, keys %INC;
foreach my $pp &#40;keys %INC&#41; {
     my $p=$pp;
     $p =~ s,/,::,g;
     $p =~ s,.pm$,,;
     my $v=$p-&gt;VERSION;
     printf &#34;%-70s %s\n&#34;, $INC{$pp}, $v;
}
print &#34;\n$ltz\n&#34;;
print &#34;tz offset=&#34; . $ltz-&gt;offset_as_string&#40;-25200&#41; . &#34;\n&#34;;

On my system, this script produces this output:

[root@pp10 bugzilla-5.1.1]# perl test.pl
DateTime::TimeZone::VERSION=2.01
/usr/share/perl5/File/Find.pm 1.29
/usr/lib64/perl5/vendor_perl/Sub/Name.pm 0.14
/usr/local/lib64/perl5/Scalar/Util.pm 1.45
/usr/lib64/perl5/vendor_perl/Params/Validate.pm 1.24
/usr/share/perl5/vars.pm 1.03
/usr/share/perl5/vendor_perl/DateTime/TimeZone/Tzfile.pm 0.010
/usr/share/perl5/vendor_perl/Module/Runtime.pm 0.014
/usr/lib64/perl5/vendor_perl/Params/Validate/XS.pm 1.24
/usr/lib64/perl5/Fcntl.pm 1.13
/usr/lib64/perl5/IO/File.pm 1.16
/usr/share/perl5/vendor_perl/DateTime/TimeZone/Local/Unix.pm 2.01
/usr/share/perl5/vendor_perl/DateTime/TimeZone/Floating.pm 2.01
/usr/lib64/perl5/vendor_perl/Params/Validate/Constants.pm 1.24
/usr/share/perl5/vendor_perl/Carp.pm 1.38
/usr/share/perl5/XSLoader.pm 0.22
/usr/share/perl5/vendor_perl/DateTime/TimeZone/OlsonDB/Change.pm 2.01
/usr/share/perl5/vendor_perl/Try/Tiny.pm 0.22
/usr/lib64/perl5/vendor_perl/File/Spec.pm 3.62
/usr/share/perl5/vendor_perl/Module/Implementation.pm 0.09
/usr/lib64/perl5/vendor_perl/Params/Classify.pm 0.013
/usr/lib64/perl5/vendor_perl/File/Spec/Unix.pm 3.62
/usr/share/perl5/vendor_perl/Exporter.pm 5.72
/usr/share/perl5/vendor_perl/constant.pm 1.33
/usr/lib64/perl5/IO/Seekable.pm 1.1
/usr/lib64/perl5/Config.pm 5.022002
/usr/lib64/perl5/IO/Handle.pm 1.35
/usr/share/perl5/warnings.pm 1.34
/usr/share/perl5/File/Basename.pm 2.85
/usr/share/perl5/File/Compare.pm 1.1006
/usr/lib64/perl5/IO.pm 1.35_01
/usr/share/perl5/Symbol.pm 1.07
/usr/share/perl5/vendor_perl/DateTime/TimeZone/Catalog.pm 2.01
/usr/share/perl5/SelectSaver.pm 1.02
/usr/lib64/perl5/vendor_perl/Cwd.pm 3.62
/usr/share/perl5/vendor_perl/DateTime/TimeZone/Local.pm 2.01
/usr/share/perl5/vendor_perl/DateTime/TimeZone/SystemV.pm 0.009
/usr/share/perl5/vendor_perl/DateTime/TimeZone/UTC.pm 2.01
/usr/share/perl5/vendor_perl/parent.pm 0.234
/usr/share/perl5/vendor_perl/DateTime/TimeZone/OffsetOnly.pm 2.01
/usr/share/perl5/vendor_perl/Class/Singleton.pm 1.5
/usr/share/perl5/vendor_perl/Date/ISO8601.pm 0.004
/usr/share/perl5/strict.pm 1.09
/usr/share/perl5/vendor_perl/DateTime/TimeZone.pm 2.01
/usr/share/perl5/integer.pm 1.01
/usr/share/perl5/warnings/register.pm 1.04
/usr/local/lib64/perl5/List/Util.pm 1.45

DateTime::TimeZone::Tzfile=HASH&#40;0x1b041b8&#41;
Can&#39;t locate object method &#34;offset_as_string&#34; via package 
&#34;DateTime::TimeZone::Tzfile&#34; at test.pl line 25.
[root@pp10 bugzilla-5.1.1]#

Thanks,
-Don

------------------------------------------------------------------------
*From:* Emmanuel Seyman
*Sent:* Tuesday, August 30, 2016 4:46AM
*To:* Support-bugzilla
*Subject:* Re: Installing recent versions of bugzilla giving error Can&#39;t 
locate object method &#34;offset_as_string&#34;

* Don Beusee [30/08/2016 04:12] :

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                        This is on a Fedora 2.3 system with the packages
</div>
Fedora 2? Fedora 3? Fedora 23?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This small test program demonstrates the error:
&gt;
&gt; use DateTime::TimeZone;
&gt; my $ltz = DateTime::TimeZone-&gt;new&#40;name =&gt; &#39;local&#39;&#41;;
&gt; print $ltz-&gt;offset_as_string&#40;-25200&#41; . &#34;\n&#34;;
</div>
This works fine on my system &#40;Fedora 24, perl-DateTime-TimeZone-2.01-1&#41;.
I suspect something is wonky with your timezone. What does the &#39;date&#39;
command return?

Emmanuel
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">_______________________________________________
support-bugzilla mailing list
support-bugzilla@lists.mozilla.org
<span class="clickylink"><a target="new" rel="nofollow" href="https://lists.mozilla.org/listinfo/support-bugzilla">https://lists.mozilla.org/listinfo/support-bugzilla</a></span>
PLEASE putsupport-bugzilla@lists.mozilla.org  in the To: field when you reply.
</div></div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;02&nbsp;09:57:52&nbsp;2016</span>
    <span class="description">DROLSKY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 02 03:51:03 2016, don@beusee.com wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; #!/usr/bin/perl
&gt; #BEGIN {
&gt; #@INC=&#40;
&gt; #        #&#39;/usr/local/lib64/perl5&#39;.
&gt; #        #&#39;/usr/local/share/perl5&#39;,
&gt; #    &#39;/usr/lib64/perl5/vendor_perl&#39;,
&gt; #    &#39;/usr/share/perl5/vendor_perl&#39;,
&gt; #    &#39;/usr/lib64/perl5&#39;,
&gt; #    &#39;/usr/share/perl5&#39;,
&gt; #    #&#39;.&#39;
&gt; #    &#41;;
&gt; #}
&gt; use DateTime::TimeZone;
&gt; print &#34;DateTime::TimeZone::VERSION=&#34; . $DateTime::TimeZone::VERSION .
&gt; &#34;\n&#34;;
&gt; my $ltz = DateTime::TimeZone-&gt;new&#40;name =&gt; &#39;local&#39;&#41;;
&gt; #print join $/, keys %INC;
&gt; foreach my $pp &#40;keys %INC&#41; {
&gt;      my $p=$pp;
&gt;      $p =~ s,/,::,g;
&gt;      $p =~ s,.pm$,,;
&gt;      my $v=$p-&gt;VERSION;
&gt;      printf &#34;%-70s %s\n&#34;, $INC{$pp}, $v;
&gt; }
&gt; print &#34;\n$ltz\n&#34;;
&gt; print &#34;tz offset=&#34; . $ltz-&gt;offset_as_string&#40;-25200&#41; . &#34;\n&#34;;
&gt; 
&gt; On my system, this script produces this output:
&gt; 
&gt; [root@pp10 bugzilla-5.1.1]# perl test.pl
&gt; DateTime::TimeZone::VERSION=2.01
&gt; /usr/share/perl5/File/Find.pm 1.29
&gt; /usr/lib64/perl5/vendor_perl/Sub/Name.pm 0.14
&gt; /usr/local/lib64/perl5/Scalar/Util.pm 1.45
&gt; /usr/lib64/perl5/vendor_perl/Params/Validate.pm 1.24
&gt; /usr/share/perl5/vars.pm 1.03
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Tzfile.pm 0.010
&gt; /usr/share/perl5/vendor_perl/Module/Runtime.pm 0.014
&gt; /usr/lib64/perl5/vendor_perl/Params/Validate/XS.pm 1.24
&gt; /usr/lib64/perl5/Fcntl.pm 1.13
&gt; /usr/lib64/perl5/IO/File.pm 1.16
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Local/Unix.pm 2.01
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Floating.pm 2.01
&gt; /usr/lib64/perl5/vendor_perl/Params/Validate/Constants.pm 1.24
&gt; /usr/share/perl5/vendor_perl/Carp.pm 1.38
&gt; /usr/share/perl5/XSLoader.pm 0.22
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/OlsonDB/Change.pm 2.01
&gt; /usr/share/perl5/vendor_perl/Try/Tiny.pm 0.22
&gt; /usr/lib64/perl5/vendor_perl/File/Spec.pm 3.62
&gt; /usr/share/perl5/vendor_perl/Module/Implementation.pm 0.09
&gt; /usr/lib64/perl5/vendor_perl/Params/Classify.pm 0.013
&gt; /usr/lib64/perl5/vendor_perl/File/Spec/Unix.pm 3.62
&gt; /usr/share/perl5/vendor_perl/Exporter.pm 5.72
&gt; /usr/share/perl5/vendor_perl/constant.pm 1.33
&gt; /usr/lib64/perl5/IO/Seekable.pm 1.1
&gt; /usr/lib64/perl5/Config.pm 5.022002
&gt; /usr/lib64/perl5/IO/Handle.pm 1.35
&gt; /usr/share/perl5/warnings.pm 1.34
&gt; /usr/share/perl5/File/Basename.pm 2.85
&gt; /usr/share/perl5/File/Compare.pm 1.1006
&gt; /usr/lib64/perl5/IO.pm 1.35_01
&gt; /usr/share/perl5/Symbol.pm 1.07
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Catalog.pm 2.01
&gt; /usr/share/perl5/SelectSaver.pm 1.02
&gt; /usr/lib64/perl5/vendor_perl/Cwd.pm 3.62
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Local.pm 2.01
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/SystemV.pm 0.009
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/UTC.pm 2.01
&gt; /usr/share/perl5/vendor_perl/parent.pm 0.234
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/OffsetOnly.pm 2.01
&gt; /usr/share/perl5/vendor_perl/Class/Singleton.pm 1.5
&gt; /usr/share/perl5/vendor_perl/Date/ISO8601.pm 0.004
&gt; /usr/share/perl5/strict.pm 1.09
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone.pm 2.01
&gt; /usr/share/perl5/integer.pm 1.01
&gt; /usr/share/perl5/warnings/register.pm 1.04
&gt; /usr/local/lib64/perl5/List/Util.pm 1.45
&gt; 
&gt; DateTime::TimeZone::Tzfile=HASH&#40;0x1b041b8&#41;
&gt;  Can&#39;t locate object method &#34;offset_as_string&#34; via package
&gt; &#34;DateTime::TimeZone::Tzfile&#34; at test.pl line 25.
</div>
I am _extremely_ confused. DateTime::TimeZone::TzFile is its own CPAN
distribution, and is not part of DateTime::TimeZone. When you call
DateTime::TimeZone-&gt;new&#40; name =&gt; &#39;local&#39; &#41; it is 100% impossible that you
would get a DateTime::TimeZone::TzFile object back.

When you ask for the local time zone from DT::TZ &#40;my distro, against which you
reported this bug&#41;, it either returns a time zone object from the DT::TZ
distro &#40;something like DateTime::TimeZone::America::Los_Angeles&#41; or throws an
exception. It has _never_ returned a DT::TZ::TzFile object.

See <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/DateTime::TimeZone#The-local-time-zone">https://metacpan.org/pod/DateTime::TimeZone#The-local-time-zone</a></span> for more
details on how this works.

The error you&#39;re seeing makes sense since the DateTime::TimeZone::TzFile class
&#40;not provided by my distro&#41; doesn&#39;t provide an offset_as_string
method. Actually, DT::TZ only provides this as a class method anyway. It&#39;s not
really meaningful to call this on an object, though it would work, I guess.

So I&#39;m not sure what&#39;s going on. One possibility is that the code above is not
actually the code that you ran, _or_ you somehow have a weirdly patched
version of DateTime::TimeZone on your system. Either way, I don&#39;t think this
is a bug in this distro, nor is it really a bug in DT::TZ::TzFile, AFAICT.


Cheers,

-dave
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;02&nbsp;09:57:53&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;02&nbsp;12:55:42&nbsp;2016</span>
    <span class="description">don [...] beusee.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #117431] Fwd: DateTime::TimeZone giving error Can&#39;t locate object method &#34;offset_as_string&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Sep 2016 09:55:18 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DateTime-TimeZone [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Don Beusee &lt;don [...] beusee.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It IS the code I ran, and no, the packages have NOT been modified!  It did
not error out on the new&#40;&#41; call and I did in fact get the Tzfile object
until I configured the timezone location.

After I configured my system for location Los Angeles, I did indeed get a
DateTime::TimeZone::America::Los_Angeles object, but before that I got a
DateTime::TimeZone::Tzfile object!

If you give me some debug code, I&#39;ll get my system back into the state
where the location is not configured, and I&#39;ll run it for you and return
the output to you.

-Don
On Sep 2, 2016 6:57 AM, &#34;Dave Rolsky via RT&#34; &lt;
bug-DateTime-TimeZone@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=117431">https://rt.cpan.org/Ticket/Display.html?id=117431</a></span> &gt;
&gt;
&gt; On Fri Sep 02 03:51:03 2016, don@beusee.com wrote:
&gt;
<div class="message-stanza open">&gt; &gt; #!/usr/bin/perl
&gt; &gt; #BEGIN {
&gt; &gt; #@INC=&#40;
&gt; &gt; #        #&#39;/usr/local/lib64/perl5&#39;.
&gt; &gt; #        #&#39;/usr/local/share/perl5&#39;,
&gt; &gt; #    &#39;/usr/lib64/perl5/vendor_perl&#39;,
&gt; &gt; #    &#39;/usr/share/perl5/vendor_perl&#39;,
&gt; &gt; #    &#39;/usr/lib64/perl5&#39;,
&gt; &gt; #    &#39;/usr/share/perl5&#39;,
&gt; &gt; #    #&#39;.&#39;
&gt; &gt; #    &#41;;
&gt; &gt; #}
&gt; &gt; use DateTime::TimeZone;
&gt; &gt; print &#34;DateTime::TimeZone::VERSION=&#34; . $DateTime::TimeZone::VERSION .
&gt; &gt; &#34;\n&#34;;
&gt; &gt; my $ltz = DateTime::TimeZone-&gt;new&#40;name =&gt; &#39;local&#39;&#41;;
&gt; &gt; #print join $/, keys %INC;
&gt; &gt; foreach my $pp &#40;keys %INC&#41; {
&gt; &gt;      my $p=$pp;
&gt; &gt;      $p =~ s,/,::,g;
&gt; &gt;      $p =~ s,.pm$,,;
&gt; &gt;      my $v=$p-&gt;VERSION;
&gt; &gt;      printf &#34;%-70s %s\n&#34;, $INC{$pp}, $v;
&gt; &gt; }
&gt; &gt; print &#34;\n$ltz\n&#34;;
&gt; &gt; print &#34;tz offset=&#34; . $ltz-&gt;offset_as_string&#40;-25200&#41; . &#34;\n&#34;;
&gt; &gt;
&gt; &gt; On my system, this script produces this output:
&gt; &gt;
&gt; &gt; [root@pp10 bugzilla-5.1.1]# perl test.pl
&gt; &gt; DateTime::TimeZone::VERSION=2.01
&gt; &gt; /usr/share/perl5/File/Find.pm 1.29
&gt; &gt; /usr/lib64/perl5/vendor_perl/Sub/Name.pm 0.14
&gt; &gt; /usr/local/lib64/perl5/Scalar/Util.pm 1.45
&gt; &gt; /usr/lib64/perl5/vendor_perl/Params/Validate.pm 1.24
&gt; &gt; /usr/share/perl5/vars.pm 1.03
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Tzfile.pm 0.010
&gt; &gt; /usr/share/perl5/vendor_perl/Module/Runtime.pm 0.014
&gt; &gt; /usr/lib64/perl5/vendor_perl/Params/Validate/XS.pm 1.24
&gt; &gt; /usr/lib64/perl5/Fcntl.pm 1.13
&gt; &gt; /usr/lib64/perl5/IO/File.pm 1.16
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Local/Unix.pm 2.01
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Floating.pm 2.01
&gt; &gt; /usr/lib64/perl5/vendor_perl/Params/Validate/Constants.pm 1.24
&gt; &gt; /usr/share/perl5/vendor_perl/Carp.pm 1.38
&gt; &gt; /usr/share/perl5/XSLoader.pm 0.22
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/OlsonDB/Change.pm 2.01
&gt; &gt; /usr/share/perl5/vendor_perl/Try/Tiny.pm 0.22
&gt; &gt; /usr/lib64/perl5/vendor_perl/File/Spec.pm 3.62
&gt; &gt; /usr/share/perl5/vendor_perl/Module/Implementation.pm 0.09
&gt; &gt; /usr/lib64/perl5/vendor_perl/Params/Classify.pm 0.013
&gt; &gt; /usr/lib64/perl5/vendor_perl/File/Spec/Unix.pm 3.62
&gt; &gt; /usr/share/perl5/vendor_perl/Exporter.pm 5.72
&gt; &gt; /usr/share/perl5/vendor_perl/constant.pm 1.33
&gt; &gt; /usr/lib64/perl5/IO/Seekable.pm 1.1
&gt; &gt; /usr/lib64/perl5/Config.pm 5.022002
&gt; &gt; /usr/lib64/perl5/IO/Handle.pm 1.35
&gt; &gt; /usr/share/perl5/warnings.pm 1.34
&gt; &gt; /usr/share/perl5/File/Basename.pm 2.85
&gt; &gt; /usr/share/perl5/File/Compare.pm 1.1006
&gt; &gt; /usr/lib64/perl5/IO.pm 1.35_01
&gt; &gt; /usr/share/perl5/Symbol.pm 1.07
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Catalog.pm 2.01
&gt; &gt; /usr/share/perl5/SelectSaver.pm 1.02
&gt; &gt; /usr/lib64/perl5/vendor_perl/Cwd.pm 3.62
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Local.pm 2.01
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/SystemV.pm 0.009
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/UTC.pm 2.01
&gt; &gt; /usr/share/perl5/vendor_perl/parent.pm 0.234
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/OffsetOnly.pm 2.01
&gt; &gt; /usr/share/perl5/vendor_perl/Class/Singleton.pm 1.5
&gt; &gt; /usr/share/perl5/vendor_perl/Date/ISO8601.pm 0.004
&gt; &gt; /usr/share/perl5/strict.pm 1.09
&gt; &gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone.pm 2.01
&gt; &gt; /usr/share/perl5/integer.pm 1.01
&gt; &gt; /usr/share/perl5/warnings/register.pm 1.04
&gt; &gt; /usr/local/lib64/perl5/List/Util.pm 1.45
&gt; &gt;
&gt; &gt; DateTime::TimeZone::Tzfile=HASH&#40;0x1b041b8&#41;
&gt; &gt;  Can&#39;t locate object method &#34;offset_as_string&#34; via package
&gt; &gt; &#34;DateTime::TimeZone::Tzfile&#34; at test.pl line 25.
</div>&gt;
&gt; I am _extremely_ confused. DateTime::TimeZone::TzFile is its own CPAN
&gt; distribution, and is not part of DateTime::TimeZone. When you call
&gt; DateTime::TimeZone-&gt;new&#40; name =&gt; &#39;local&#39; &#41; it is 100% impossible that you
&gt; would get a DateTime::TimeZone::TzFile object back.
&gt;
&gt; When you ask for the local time zone from DT::TZ &#40;my distro, against which
&gt; you
&gt; reported this bug&#41;, it either returns a time zone object from the DT::TZ
&gt; distro &#40;something like DateTime::TimeZone::America::Los_Angeles&#41; or
&gt; throws an
&gt; exception. It has _never_ returned a DT::TZ::TzFile object.
&gt;
&gt; See <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/DateTime::TimeZone#The-local-time-zone">https://metacpan.org/pod/DateTime::TimeZone#The-local-time-zone</a></span> for
&gt; more
&gt; details on how this works.
&gt;
&gt; The error you&#39;re seeing makes sense since the DateTime::TimeZone::TzFile
&gt; class
&gt; &#40;not provided by my distro&#41; doesn&#39;t provide an offset_as_string
&gt; method. Actually, DT::TZ only provides this as a class method anyway. It&#39;s
&gt; not
&gt; really meaningful to call this on an object, though it would work, I guess.
&gt;
&gt; So I&#39;m not sure what&#39;s going on. One possibility is that the code above is
&gt; not
&gt; actually the code that you ran, _or_ you somehow have a weirdly patched
&gt; version of DateTime::TimeZone on your system. Either way, I don&#39;t think
&gt; this
&gt; is a bug in this distro, nor is it really a bug in DT::TZ::TzFile, AFAICT.
&gt;
&gt;
&gt; Cheers,
&gt;
&gt; -dave
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;02&nbsp;15:07:26&nbsp;2016</span>
    <span class="description">don [...] beusee.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #117431] Fwd: DateTime::TimeZone giving error Can&#39;t locate object method &#34;offset_as_string&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Sep 2016 12:12:24 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DateTime-TimeZone [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Don Beusee &lt;don [...] beusee.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I figured out what must have happened.  /etc/localtime was a copy of an 
earlier version of the zoneinfo.  I don&#39;t know how this originally 
happened, since I never paid any attention to this file.  I did upgrade 
from Fedora 20 to Fedora 23 some time in the last year.

To reproduce the issue, I copied a Fedora 20 file to my Fedora 23 system 
and now I get a Tzfile object again.

Line 17 from DateTime/TimeZone/Local.pm produces the Tzfile object:
my $tz = $subclass-&gt;$meth&#40;&#41;;

$subclass-&gt;$meth resolves to:
DateTime::TimeZone::Local::Unix-&gt;FromEtcLocaltimeContent

Note that the date command works - it knows it&#39;s in PDT and it returns 
the correct time.

-Don

------------------------------------------------------------------------
*From:* Dave Rolsky Via Rt
*Sent:* Friday, September 02, 2016 6:57AM
*To:* Don
*Subject:* [rt.cpan.org #117431] Fwd: DateTime::TimeZone giving error 
Can&#39;t locate object method &#34;offset_as_string&#34;

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=117431">https://rt.cpan.org/Ticket/Display.html?id=117431</a></span> &gt;

On Fri Sep 02 03:51:03 2016, don@beusee.com wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; #!/usr/bin/perl
&gt; #BEGIN {
&gt; #@INC=&#40;
&gt; #        #&#39;/usr/local/lib64/perl5&#39;.
&gt; #        #&#39;/usr/local/share/perl5&#39;,
&gt; #    &#39;/usr/lib64/perl5/vendor_perl&#39;,
&gt; #    &#39;/usr/share/perl5/vendor_perl&#39;,
&gt; #    &#39;/usr/lib64/perl5&#39;,
&gt; #    &#39;/usr/share/perl5&#39;,
&gt; #    #&#39;.&#39;
&gt; #    &#41;;
&gt; #}
&gt; use DateTime::TimeZone;
&gt; print &#34;DateTime::TimeZone::VERSION=&#34; . $DateTime::TimeZone::VERSION .
&gt; &#34;\n&#34;;
&gt; my $ltz = DateTime::TimeZone-&gt;new&#40;name =&gt; &#39;local&#39;&#41;;
&gt; #print join $/, keys %INC;
&gt; foreach my $pp &#40;keys %INC&#41; {
&gt;       my $p=$pp;
&gt;       $p =~ s,/,::,g;
&gt;       $p =~ s,.pm$,,;
&gt;       my $v=$p-&gt;VERSION;
&gt;       printf &#34;%-70s %s\n&#34;, $INC{$pp}, $v;
&gt; }
&gt; print &#34;\n$ltz\n&#34;;
&gt; print &#34;tz offset=&#34; . $ltz-&gt;offset_as_string&#40;-25200&#41; . &#34;\n&#34;;
&gt;
&gt; On my system, this script produces this output:
&gt;
&gt; [root@pp10 bugzilla-5.1.1]# perl test.pl
&gt; DateTime::TimeZone::VERSION=2.01
&gt; /usr/share/perl5/File/Find.pm 1.29
&gt; /usr/lib64/perl5/vendor_perl/Sub/Name.pm 0.14
&gt; /usr/local/lib64/perl5/Scalar/Util.pm 1.45
&gt; /usr/lib64/perl5/vendor_perl/Params/Validate.pm 1.24
&gt; /usr/share/perl5/vars.pm 1.03
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Tzfile.pm 0.010
&gt; /usr/share/perl5/vendor_perl/Module/Runtime.pm 0.014
&gt; /usr/lib64/perl5/vendor_perl/Params/Validate/XS.pm 1.24
&gt; /usr/lib64/perl5/Fcntl.pm 1.13
&gt; /usr/lib64/perl5/IO/File.pm 1.16
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Local/Unix.pm 2.01
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Floating.pm 2.01
&gt; /usr/lib64/perl5/vendor_perl/Params/Validate/Constants.pm 1.24
&gt; /usr/share/perl5/vendor_perl/Carp.pm 1.38
&gt; /usr/share/perl5/XSLoader.pm 0.22
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/OlsonDB/Change.pm 2.01
&gt; /usr/share/perl5/vendor_perl/Try/Tiny.pm 0.22
&gt; /usr/lib64/perl5/vendor_perl/File/Spec.pm 3.62
&gt; /usr/share/perl5/vendor_perl/Module/Implementation.pm 0.09
&gt; /usr/lib64/perl5/vendor_perl/Params/Classify.pm 0.013
&gt; /usr/lib64/perl5/vendor_perl/File/Spec/Unix.pm 3.62
&gt; /usr/share/perl5/vendor_perl/Exporter.pm 5.72
&gt; /usr/share/perl5/vendor_perl/constant.pm 1.33
&gt; /usr/lib64/perl5/IO/Seekable.pm 1.1
&gt; /usr/lib64/perl5/Config.pm 5.022002
&gt; /usr/lib64/perl5/IO/Handle.pm 1.35
&gt; /usr/share/perl5/warnings.pm 1.34
&gt; /usr/share/perl5/File/Basename.pm 2.85
&gt; /usr/share/perl5/File/Compare.pm 1.1006
&gt; /usr/lib64/perl5/IO.pm 1.35_01
&gt; /usr/share/perl5/Symbol.pm 1.07
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Catalog.pm 2.01
&gt; /usr/share/perl5/SelectSaver.pm 1.02
&gt; /usr/lib64/perl5/vendor_perl/Cwd.pm 3.62
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/Local.pm 2.01
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/SystemV.pm 0.009
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/UTC.pm 2.01
&gt; /usr/share/perl5/vendor_perl/parent.pm 0.234
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone/OffsetOnly.pm 2.01
&gt; /usr/share/perl5/vendor_perl/Class/Singleton.pm 1.5
&gt; /usr/share/perl5/vendor_perl/Date/ISO8601.pm 0.004
&gt; /usr/share/perl5/strict.pm 1.09
&gt; /usr/share/perl5/vendor_perl/DateTime/TimeZone.pm 2.01
&gt; /usr/share/perl5/integer.pm 1.01
&gt; /usr/share/perl5/warnings/register.pm 1.04
&gt; /usr/local/lib64/perl5/List/Util.pm 1.45
&gt;
&gt; DateTime::TimeZone::Tzfile=HASH&#40;0x1b041b8&#41;
&gt;   Can&#39;t locate object method &#34;offset_as_string&#34; via package
&gt; &#34;DateTime::TimeZone::Tzfile&#34; at test.pl line 25.
</div>
I am _extremely_ confused. DateTime::TimeZone::TzFile is its own CPAN
distribution, and is not part of DateTime::TimeZone. When you call
DateTime::TimeZone-&gt;new&#40; name =&gt; &#39;local&#39; &#41; it is 100% impossible that you
would get a DateTime::TimeZone::TzFile object back.

When you ask for the local time zone from DT::TZ &#40;my distro, against which you
reported this bug&#41;, it either returns a time zone object from the DT::TZ
distro &#40;something like DateTime::TimeZone::America::Los_Angeles&#41; or throws an
exception. It has _never_ returned a DT::TZ::TzFile object.

See <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/DateTime::TimeZone#The-local-time-zone">https://metacpan.org/pod/DateTime::TimeZone#The-local-time-zone</a></span> for more
details on how this works.

The error you&#39;re seeing makes sense since the DateTime::TimeZone::TzFile class
&#40;not provided by my distro&#41; doesn&#39;t provide an offset_as_string
method. Actually, DT::TZ only provides this as a class method anyway. It&#39;s not
really meaningful to call this on an object, though it would work, I guess.

So I&#39;m not sure what&#39;s going on. One possibility is that the code above is not
actually the code that you ran, _or_ you somehow have a weirdly patched
version of DateTime::TimeZone on your system. Either way, I don&#39;t think this
is a bug in this distro, nor is it really a bug in DT::TZ::TzFile, AFAICT.


Cheers,

-dave
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;03&nbsp;10:04:01&nbsp;2016</span>
    <span class="description">DROLSKY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 02 15:07:26 2016, don@beusee.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I figured out what must have happened.  /etc/localtime was a copy of
&gt; an
&gt; earlier version of the zoneinfo.  I don&#39;t know how this originally
&gt; happened, since I never paid any attention to this file.  I did
&gt; upgrade
&gt; from Fedora 20 to Fedora 23 some time in the last year.
&gt; 
&gt; To reproduce the issue, I copied a Fedora 20 file to my Fedora 23
&gt; system
&gt; and now I get a Tzfile object again.
&gt; 
&gt; Line 17 from DateTime/TimeZone/Local.pm produces the Tzfile object:
&gt; my $tz = $subclass-&gt;$meth&#40;&#41;;
&gt; 
&gt; $subclass-&gt;$meth resolves to:
&gt; DateTime::TimeZone::Local::Unix-&gt;FromEtcLocaltimeContent
</div>
Which cannot return a DT::TZ::TzFile object. It you look at that method,
you&#39;ll see that it ultimately calls back to DateTime::TimeZone-&gt;new with a
time zone name &#40;that isn&#39;t &#34;local&#34;&#41;.

The only way I can see this happening is if you had a locally patched version
of the DateTime-TimeZone distro or if something was monkey-patching it in the
process where this happened. Maybe Red Hat did this? They&#39;ve done some weird
stuff with their Perl in the past, though this would be a new level of
weirdness.

Somewhat unrelatedly, whatever software is calling -&gt;offset_as_seconds on a
time zone _object_ should be fixed. This method should be called as a class
method on DateTime::TimeZone.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;03&nbsp;10:04:07&nbsp;2016</span>
    <span class="description">DROLSKY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;03&nbsp;17:09:54&nbsp;2016</span>
    <span class="description">don [...] beusee.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #117431] Fwd: DateTime::TimeZone giving error Can&#39;t locate object method &#34;offset_as_string&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 3 Sep 2016 14:14:33 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DateTime-TimeZone [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Don Beusee &lt;don [...] beusee.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I debugged this further, and found out you are right!  Unix.pm is 
modified in the Fedora Project.  I don&#39;t know why they modified it, 
because your package from CPAN works correctly.  I get the correct error 
with the FC20 localtime file and I get the correct result with the FC23 
localtime file.

I filed this Fedora bug just now:

<span class="clickylink"><a target="new" rel="nofollow" href="https://bugzilla.redhat.com/show_bug.cgi?id=1372923">https://bugzilla.redhat.com/show_bug.cgi?id=1372923</a></span>

I agree with you regarding offset_as_seconds&#40;&#41;.

-Don

------------------------------------------------------------------------
*From:* Dave Rolsky Via Rt
*Sent:* Saturday, September 03, 2016 7:04AM
*To:* Don
*Subject:* [rt.cpan.org #117431] Fwd: DateTime::TimeZone giving error 
Can&#39;t locate object method &#34;offset_as_string&#34;

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=117431">https://rt.cpan.org/Ticket/Display.html?id=117431</a></span> &gt;

On Fri Sep 02 15:07:26 2016, don@beusee.com wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I figured out what must have happened.  /etc/localtime was a copy of
&gt; an
&gt; earlier version of the zoneinfo.  I don&#39;t know how this originally
&gt; happened, since I never paid any attention to this file.  I did
&gt; upgrade
&gt; from Fedora 20 to Fedora 23 some time in the last year.
&gt;
&gt; To reproduce the issue, I copied a Fedora 20 file to my Fedora 23
&gt; system
&gt; and now I get a Tzfile object again.
&gt;
&gt; Line 17 from DateTime/TimeZone/Local.pm produces the Tzfile object:
&gt; my $tz = $subclass-&gt;$meth&#40;&#41;;
&gt;
&gt; $subclass-&gt;$meth resolves to:
&gt; DateTime::TimeZone::Local::Unix-&gt;FromEtcLocaltimeContent
</div>
Which cannot return a DT::TZ::TzFile object. It you look at that method,
you&#39;ll see that it ultimately calls back to DateTime::TimeZone-&gt;new with a
time zone name &#40;that isn&#39;t &#34;local&#34;&#41;.

The only way I can see this happening is if you had a locally patched version
of the DateTime-TimeZone distro or if something was monkey-patching it in the
process where this happened. Maybe Red Hat did this? They&#39;ve done some weird
stuff with their Perl in the past, though this would be a new level of
weirdness.

Somewhat unrelatedly, whatever software is calling -&gt;offset_as_seconds on a
time zone _object_ should be fixed. This method should be called as a class
method on DateTime::TimeZone.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
