<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #3346 for GDGraph: Option to add space between groups of bars</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #3346 for GDGraph: Option to add space between groups of bars</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/GDGraph/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/GDGraph/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/GDGraph/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/GDGraph/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/GDGraph">GDGraph CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p>There are plenty of good ideas of what people can do published here on the queue. Turning a patch from the tracker into a pull request is not one of them. In order to get maintainers' attention way more quickier, PR should have at least a sample included. We know it's hard to test images generating software, but it doesn't mean we can not test numbers produced by intermediate algorithms used to generate these images, so either a test or a sample.</p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">3346</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/GDGraph/Active/">GDGraph</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">bwarfield [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Ben_Warfield [...] nrgn.com

<br />
grantm [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-14346-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.43    </td>
  </tr>
  <tr id="CF-14347-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.4305    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




gdgraphpatch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/86475/11341/gdgraphpatch">
Tue Aug 26 14:08:39 2003 (4k) by 
</a>
</font></li>
</ul>


group_spacing.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/106604/20291/group_spacing.patch">
Tue Jun 29 05:39:08 2004 (1.5k) by 
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;26&nbsp;14:08:39&nbsp;2003</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Option to add space between groups of bars</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When working with a multiple-data-set bar graph, I find it preferable to have the groups for each X value separated by a little additional space to make it clear where one X value ends and the next begins.  This is obviously too trivial a feature to ask somebody else to implement, so I did it myself, adding a new group_spacing option &#40;analogous to bar_spacing&#41; for GD::Graph::bars and GD::Graph::hbars.  The accompanying patch changes Graph.pm &#40;to document the option&#41;, Graph/axestype.pm, Graph/bars.pm and samples/Makefile &#40;since I also added sample code for the new option&#41;.  I hope it meets with approval.

Since I&#39;m not sure I can attach multiple files, I&#39;m including the new sample file &#40;which I&#39;ve called sample19.pl, because it seemed to fit there&#41; in this message instead of as an attachment--it&#39;s basically just a slightly tweaked version of sample12.pl, in any case.

Thanks for the great modules!

    --Ben Warfield

#!/usr/local/bin/perl

use strict;
use GD::Graph::bars;
use GD::Graph::hbars;
require &#39;save.pl&#39;;

my @data = &#40; 
    [&#34;1st&#34;,&#34;2nd&#34;,&#34;3rd&#34;,&#34;4th&#34;,&#34;5th&#34;,&#34;6th&#34;,&#34;7th&#34;],
    [    5,   12,   24,   33,   19,   18,    6],
    [    5,   11,   13,   28,   23,   13,    1],
    [    2,    8,   10,   20,   18,   21,    3],
    [    10,  20,   19,   36,   23,   19,   11],
&#41;;

my @names = qw/sample19 sample19-h/;
my @dim = &#40;600,400&#41;;
for my $my_graph &#40;GD::Graph::bars-&gt;new&#40;@dim&#41;,GD::Graph::hbars-&gt;new&#40;@dim&#41;&#41;
{
    my $name = shift @names;
    print STDERR &#34;Processing $name\n&#34;;

    $my_graph-&gt;set&#40; 
        x_label         =&gt; &#39;X Label&#39;,
        y_label         =&gt; &#39;Y label&#39;,
        title           =&gt; &#39;Four data sets &#40;with grouping space&#41;&#39;,
        y_max_value     =&gt; 40,
        y_tick_number   =&gt; 8,
        y_label_skip    =&gt; 2,
        bar_spacing     =&gt; 2,
        shadow_depth    =&gt; 3,
        group_spacing   =&gt; 4,
        accent_treshold =&gt; 200,

        transparent     =&gt; 0,
    &#41;;

    $my_graph-&gt;set_legend&#40;qw&#40;Harry Ron Neville Hermione&#41;&#41;;
    $my_graph-&gt;plot&#40;\@data&#41;;
    save_chart&#40;$my_graph, $name&#41;;
}
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/86475/11341/gdgraphpatch">Download gdgraphpatch</a><br />
<span class="downloadcontenttype">application/octet-stream 4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;29&nbsp;05:39:08&nbsp;2004</span>
    <span class="description">grantm [...] cpan.org - Ticket #6786:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bars are not grouped on a graphs with multiple data series</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The attached patch implements a bargroup_spacing option to control the amount of space between groups of bars.  I prefer to use it with bar_spacing set to 0 so that all the matching items from each data series are close together.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Only in lib/GD/Graph: .axestype.pm.swp
Only in lib/GD/Graph: .bars.pm.swp
diff -ru lib-orig/GD/Graph/axestype.pm lib/GD/Graph/axestype.pm
--- lib-orig/GD/Graph/axestype.pm	2004-06-22 20:33:01.000000000 +1200
+++ lib/GD/Graph/axestype.pm	2004-06-18 22:42:00.000000000 +1200
@@ -177,6 +177,7 @@
     # Spacing between the bars
     bar_width       =&gt; undef,
     bar_spacing     =&gt; 0,
+    bargroup_spacing =&gt; 0,
 
     # cycle through colours per data point, not set
     cycle_clrs      =&gt; 0,
diff -ru lib-orig/GD/Graph/bars.pm lib/GD/Graph/bars.pm
--- lib-orig/GD/Graph/bars.pm	2004-06-22 20:33:01.000000000 +1200
+++ lib/GD/Graph/bars.pm	2004-06-22 22:15:51.000000000 +1200
@@ -255,6 +255,7 @@
 
         # calculate left and right of bar
         my &#40;$l, $r&#41;;
+        my $gs = $self-&gt;{bargroup_spacing} ? $self-&gt;{bargroup_spacing} : 0;
 
         if &#40;ref $self eq &#39;GD::Graph::mixed&#39; || $self-&gt;{overwrite}&#41;
         {
@@ -264,12 +265,13 @@
         else
         {
             $l = $xp 
-                - $self-&gt;{x_step}/2
-                + &#40;$ds - 1&#41; * $self-&gt;{x_step}/$self-&gt;{_data}-&gt;num_sets
-                + $bar_s + 1;
+                - $self-&gt;{x_step}/2 + $gs / 2
+                + &#40;$ds - 1&#41; * &#40;$self-&gt;{x_step} - $gs&#41;/$self-&gt;{_data}-&gt;num_sets
+                + $bar_s
+                + &#40;$gs ? 0 : 1&#41;;
             $r = $xp 
-                - $self-&gt;{x_step}/2
-                + $ds * $self-&gt;{x_step}/$self-&gt;{_data}-&gt;num_sets
+                - $self-&gt;{x_step}/2 + $gs / 2
+                + $ds * &#40;$self-&gt;{x_step} - $gs&#41;/$self-&gt;{_data}-&gt;num_sets
                 - $bar_s;
         }
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;11&nbsp;18:52:32&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org - Ticket #6786:  Merged into ticket #3346</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;11&nbsp;18:52:32&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Merged into ticket #3346</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;11&nbsp;18:53:37&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Dependency on ticket #1363 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;11&nbsp;18:54:00&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;11&nbsp;18:54:00&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Fixed in 1.4305 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;Feb&nbsp;11&nbsp;18:54:12&nbsp;2006</span>
    <span class="description">bwarfield [...] cpan.org -  Given to BWARFIELD</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
