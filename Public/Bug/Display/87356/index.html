<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #87356 for CPAN: App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #87356 for CPAN: App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CPAN/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CPAN/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CPAN/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CPAN/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CPAN">CPAN CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">87356</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CPAN/Active/">CPAN</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jeff.holt [...] method-r.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8164-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-8165-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;26&nbsp;12:14:07&nbsp;2013</span>
    <span class="description">jeff.holt [...] method-r.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 26 Jul 2013 11:13:54 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeff Holt &lt;jeff.holt [...] method-r.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have a need to build modules of indeterminate type &#40;MM or MB&#41; and it
seems reasonable to use &#34;cpan -ft .&#34; to do so. The pod for App::Cpan
declares no constraints upon the caller except, by inference, that @ARGV
must be set properly before calling App::Cpan-&gt;run&#40;&#41;.

The problem I have is that I want to make many modules in the same
execution. So, one should expect the code to look something like this:

use App::Cpan;
for &#40;@modules&#41; {
   chdir&#40;$_&#41;;
   App::Cpan-&gt;run&#40;&#34;-t&#34;, &#34;.&#34;&#41;;
}


Well, that doesn&#39;t work because I get a cpan&gt; prompt. I had to reread the
pod to figure out that run &#40;and its descendants&#41; use @ARGV. Really? Ok,
I&#39;ll do the un-perly thing to move forward.

use App::Cpan;
for &#40;@modules&#41; {
   chdir&#40;$_&#41;;
   @ARGV = qw&#40;-t .&#41;;
   App::Cpan-&gt;run&#40;&#41;;
}


Well, that still doesn&#39;t work because it thinks the &#34;working directory&#34; is
the current directory at the time of the &#34;use&#34;. I had to reread the CPAN.pm
code to figure out that it sets a global variable $CPAN::iCwd to the
current working directory at BEGIN time. Really? Ok, I&#39;ll do the un-perly
thing to move forward.

Here&#39;s the code that finally works. But I haven&#39;t read ALL the code to know
if it will always work. That&#39;s what bothers me the most.

use App::Cpan;
use Cwd;
for &#40;@modules&#41; {
   chdir&#40;$_&#41;;
   @ARGV = qw&#40;-t .&#41;;
   $CPAN::iCwd = cwd;
   App::Cpan-&gt;run&#40;&#41;;
}


I have no idea why CPAN.pm and its indirect &#40;direct?&#41; caller App::Cpan do
it the way they do. But it doesn&#39;t smell very good. Sorry for the bluntness
but I don&#39;t think my comments are out of line given the workaround and the
hack that I&#39;ve had to employ.

If you believe that these two idiosyncrasies are legitimate bugs, let me
know and I&#39;ll spend an hour to estimate the work required to provide a fix.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;08:00:26&nbsp;2013</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 27 Jul 2013 13:58:04 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andreas Koenig &lt;andreas.koenig.7os6VVqR [...] franz.ak.mind.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [snip]
&gt; Here&#39;s the code that finally works. But I haven&#39;t read ALL the code to know
&gt; if it will always work. That&#39;s what bothers me the most.
&gt;
&gt; use App::Cpan;
&gt; use Cwd;
&gt; for &#40;@modules&#41; {
&gt;    chdir&#40;$_&#41;;
&gt;    @ARGV = qw&#40;-t .&#41;;
&gt;    $CPAN::iCwd = cwd;
&gt;    App::Cpan-&gt;run&#40;&#41;;
&gt; }
</div>
I can feel your pain. Before jumping to conclusions I offer a different
view on it. I believe that App::Cpan was invented to support &#34;cpan&#34;, the
small program that is to be called on the command line. I would expect
best results with it when used lime on the the commandline, as a forking
system call. So I would expect that it works nicely with something like:

my $cwd = cwd;
for &#40;@modules&#41; {
   0==system cpan =&gt; &#34;-t&#34;, &#34;$cwd/$_/.&#34; or die &#34;problem running $_&#34;;
}

Opinions anyone?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have no idea why CPAN.pm and its indirect &#40;direct?&#41; caller App::Cpan do
&gt; it the way they do. But it doesn&#39;t smell very good. Sorry for the bluntness
&gt; but I don&#39;t think my comments are out of line given the workaround and the
&gt; hack that I&#39;ve had to employ.
</div>
First guess is that the solution you found should be discouraged by some
documentation somewhere. Second guess is that there might be some fixes
possible to make your initial vision possible which was:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; use App::Cpan;
&gt; for &#40;@modules&#41; {
&gt;    chdir&#40;$_&#41;;
&gt;    App::Cpan-&gt;run&#40;&#34;-t&#34;, &#34;.&#34;&#41;;
&gt; }
</div>
I&#39;m not sure whether it is a desirable solution, there may be tradeoffs.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you believe that these two idiosyncrasies are legitimate bugs, let me
&gt; know and I&#39;ll spend an hour to estimate the work required to provide a
&gt; fix.
</div>
We probably should hear more voices before we decide which direction is
preferrable/preferred.

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;08:00:27&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;09:02:19&nbsp;2013</span>
    <span class="description">jeff.holt [...] method-r.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 27 Jul 2013 08:02:02 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeff Holt &lt;jeff.holt [...] method-r.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If there is a better module for what I am doing, then I have no problem
with someone removing the entire pod for App::Cpan. I didn&#39;t find any pod
for the other candidates and having found it only for App::Cpan, I assumed
it was the one to use.

Calling system&#40;qw&#40;cpan -t .&#41;&#41;, worked only on linux, solaris, and darwin. I
ran into all kinds of problems with windows and thought using App::Cpan
would be a big time saver.


On Sat, Jul 27, 2013 at 7:00 AM, &#40;Andreas J. Koenig&#41; via RT &lt;
bug-CPAN@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; &#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:
&gt;
<div class="message-stanza open">&gt; &gt; [snip]
&gt; &gt; Here&#39;s the code that finally works. But I haven&#39;t read ALL the code to
</div>&gt; know
<div class="message-stanza open">&gt; &gt; if it will always work. That&#39;s what bothers me the most.
&gt; &gt;
&gt; &gt; use App::Cpan;
&gt; &gt; use Cwd;
&gt; &gt; for &#40;@modules&#41; {
&gt; &gt;    chdir&#40;$_&#41;;
&gt; &gt;    @ARGV = qw&#40;-t .&#41;;
&gt; &gt;    $CPAN::iCwd = cwd;
&gt; &gt;    App::Cpan-&gt;run&#40;&#41;;
&gt; &gt; }
</div>&gt;
&gt; I can feel your pain. Before jumping to conclusions I offer a different
&gt; view on it. I believe that App::Cpan was invented to support &#34;cpan&#34;, the
&gt; small program that is to be called on the command line. I would expect
&gt; best results with it when used lime on the the commandline, as a forking
&gt; system call. So I would expect that it works nicely with something like:
&gt;
&gt; my $cwd = cwd;
&gt; for &#40;@modules&#41; {
&gt;    0==system cpan =&gt; &#34;-t&#34;, &#34;$cwd/$_/.&#34; or die &#34;problem running $_&#34;;
&gt; }
&gt;
&gt; Opinions anyone?
&gt;
<div class="message-stanza open">&gt; &gt; I have no idea why CPAN.pm and its indirect &#40;direct?&#41; caller App::Cpan do
&gt; &gt; it the way they do. But it doesn&#39;t smell very good. Sorry for the
</div>&gt; bluntness
<div class="message-stanza open">&gt; &gt; but I don&#39;t think my comments are out of line given the workaround and
</div>&gt; the
<div class="message-stanza open">&gt; &gt; hack that I&#39;ve had to employ.
</div>&gt;
&gt; First guess is that the solution you found should be discouraged by some
&gt; documentation somewhere. Second guess is that there might be some fixes
&gt; possible to make your initial vision possible which was:
&gt;
<div class="message-stanza open">&gt; &gt; use App::Cpan;
&gt; &gt; for &#40;@modules&#41; {
&gt; &gt;    chdir&#40;$_&#41;;
&gt; &gt;    App::Cpan-&gt;run&#40;&#34;-t&#34;, &#34;.&#34;&#41;;
&gt; &gt; }
</div>&gt;
&gt; I&#39;m not sure whether it is a desirable solution, there may be tradeoffs.
&gt;
<div class="message-stanza open">&gt; &gt; If you believe that these two idiosyncrasies are legitimate bugs, let me
&gt; &gt; know and I&#39;ll spend an hour to estimate the work required to provide a
&gt; &gt; fix.
</div>&gt;
&gt; We probably should hear more voices before we decide which direction is
&gt; preferrable/preferred.
&gt;
&gt; --
&gt; andreas
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;13:04:53&nbsp;2013</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 27 Jul 2013 19:04:31 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andreas Koenig &lt;andreas.koenig.7os6VVqR [...] franz.ak.mind.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CPAN
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; If there is a better module for what I am doing, then I have no problem
&gt; with someone removing the entire pod for App::Cpan. I didn&#39;t find any pod
&gt; for the other candidates and having found it only for App::Cpan, I assumed
&gt; it was the one to use.
</div>
I can&#39;t blame you for doing so:/

I&#39;m strongly in favor of adding documentation that leads you to the
right approach. I regret that CPAN.pm is underdocumented. How about:

  my @modules = qw&#40;devel-symdump javascript-v8&#41;;
  use Cwd;
  my $cwd = cwd;
  use File::Spec;
  my @targets = map { File::Spec-&gt;catdir&#40;$cwd, $_&#41; . &#34;/.&#34; } @modules;
  use CPAN;
  CPAN::Shell-&gt;test&#40;@targets&#41;;

Just tested it a little bit and I&#39;m not sure what you will be missing
&#40;e.g. rel2abs&#41;, but it&#39;s a start.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Calling system&#40;qw&#40;cpan -t .&#41;&#41;, worked only on linux, solaris, and darwin. I
&gt; ran into all kinds of problems with windows and thought using App::Cpan
&gt; would be a big time saver.
</div>
Maybe it is and I&#39;m just not the right person to judge that.

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;14:11:58&nbsp;2013</span>
    <span class="description">jeff.holt [...] method-r.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 27 Jul 2013 13:11:43 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeff Holt &lt;jeff.holt [...] method-r.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m afraid CPAN::Shell-&gt;test doesn&#39;t work either, probably because it
relies upon the same code that uses the global variable that App::Cpan-&gt;run
uses.

I believe App::Cpan-&gt;run, when @ARGV = qw&#40;-t .&#41;, eventually calls the same
code that CPAN::Shell-&gt;test calls.

According to the higher level methods, there&#39;s only one predicate that
triggers the processing of a directory that has been &#34;prepared&#34; from
source. That predicate compares the given argument to the string &#34;.&#34;. Seems
reasonable that the predicate could be enhanced to include not just &#34;.&#34; but
also any string that is an absolute pathname.

Expanding that predicate wouldn&#39;t fix the whole problem, though, since the
next call normalizes the string by incorporating $CPAN::iCwd.


On Sat, Jul 27, 2013 at 12:04 PM, &#40;Andreas J. Koenig&#41; via RT &lt;
bug-CPAN@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; &#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:
&gt;
<div class="message-stanza open">&gt; &gt;        Queue: CPAN
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt; &gt;
&gt; &gt; If there is a better module for what I am doing, then I have no problem
&gt; &gt; with someone removing the entire pod for App::Cpan. I didn&#39;t find any pod
&gt; &gt; for the other candidates and having found it only for App::Cpan, I
</div>&gt; assumed
<div class="message-stanza open">&gt; &gt; it was the one to use.
</div>&gt;
&gt; I can&#39;t blame you for doing so:/
&gt;
&gt; I&#39;m strongly in favor of adding documentation that leads you to the
&gt; right approach. I regret that CPAN.pm is underdocumented. How about:
&gt;
&gt;   my @modules = qw&#40;devel-symdump javascript-v8&#41;;
&gt;   use Cwd;
&gt;   my $cwd = cwd;
&gt;   use File::Spec;
&gt;   my @targets = map { File::Spec-&gt;catdir&#40;$cwd, $_&#41; . &#34;/.&#34; } @modules;
&gt;   use CPAN;
&gt;   CPAN::Shell-&gt;test&#40;@targets&#41;;
&gt;
&gt; Just tested it a little bit and I&#39;m not sure what you will be missing
&gt; &#40;e.g. rel2abs&#41;, but it&#39;s a start.
&gt;
<div class="message-stanza open">&gt; &gt; Calling system&#40;qw&#40;cpan -t .&#41;&#41;, worked only on linux, solaris, and
</div>&gt; darwin. I
<div class="message-stanza open">&gt; &gt; ran into all kinds of problems with windows and thought using App::Cpan
&gt; &gt; would be a big time saver.
</div>&gt;
&gt; Maybe it is and I&#39;m just not the right person to judge that.
&gt;
&gt; --
&gt; andreas
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;14:31:16&nbsp;2013</span>
    <span class="description">jeff.holt [...] method-r.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 27 Jul 2013 13:31:01 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeff Holt &lt;jeff.holt [...] method-r.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I should also expand what I meant in my original post when I mentioned
indeterminate modules. The repository management code I&#39;m working on must
handle modules hosted by cpan.org &#40;and dependencies&#41; that my code needs. I
have a list of 10 or so that my code depends upon.

It also needs to handle modules that we are not allowed to share with
anyone else. Those are stored in our svn repository. This latter set of
modules are the ones that are causing the problem because, at least to the
best of my knowledge, we don&#39;t know how to tell CPAN.pm that our source
repository is another source code repository just like cpan.org.

So that&#39;s why we are using the documented method for making cpan execute
&#34;make test&#34; in the current directory.

I wasn&#39;t sure if you were aware of the whole context that has brought me to
log the bug.


On Sat, Jul 27, 2013 at 1:11 PM, Jeff Holt &lt;jeff.holt@method-r.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m afraid CPAN::Shell-&gt;test doesn&#39;t work either, probably because it
&gt; relies upon the same code that uses the global variable that App::Cpan-&gt;run
&gt; uses.
&gt;
&gt; I believe App::Cpan-&gt;run, when @ARGV = qw&#40;-t .&#41;, eventually calls the same
&gt; code that CPAN::Shell-&gt;test calls.
&gt;
&gt; According to the higher level methods, there&#39;s only one predicate that
&gt; triggers the processing of a directory that has been &#34;prepared&#34; from
&gt; source. That predicate compares the given argument to the string &#34;.&#34;. Seems
&gt; reasonable that the predicate could be enhanced to include not just &#34;.&#34; but
&gt; also any string that is an absolute pathname.
&gt;
&gt; Expanding that predicate wouldn&#39;t fix the whole problem, though, since the
&gt; next call normalizes the string by incorporating $CPAN::iCwd.
&gt;
&gt;
&gt; On Sat, Jul 27, 2013 at 12:04 PM, &#40;Andreas J. Koenig&#41; via RT &lt;
&gt; bug-CPAN@rt.cpan.org&gt; wrote:
&gt;
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;&gt;
&gt;&gt; &#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt;        Queue: CPAN
&gt;&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; If there is a better module for what I am doing, then I have no problem
&gt;&gt; &gt; with someone removing the entire pod for App::Cpan. I didn&#39;t find any
</div>&gt;&gt; pod
<div class="message-stanza open">&gt;&gt; &gt; for the other candidates and having found it only for App::Cpan, I
</div>&gt;&gt; assumed
<div class="message-stanza open">&gt;&gt; &gt; it was the one to use.
</div>&gt;&gt;
&gt;&gt; I can&#39;t blame you for doing so:/
&gt;&gt;
&gt;&gt; I&#39;m strongly in favor of adding documentation that leads you to the
&gt;&gt; right approach. I regret that CPAN.pm is underdocumented. How about:
&gt;&gt;
&gt;&gt;   my @modules = qw&#40;devel-symdump javascript-v8&#41;;
&gt;&gt;   use Cwd;
&gt;&gt;   my $cwd = cwd;
&gt;&gt;   use File::Spec;
&gt;&gt;   my @targets = map { File::Spec-&gt;catdir&#40;$cwd, $_&#41; . &#34;/.&#34; } @modules;
&gt;&gt;   use CPAN;
&gt;&gt;   CPAN::Shell-&gt;test&#40;@targets&#41;;
&gt;&gt;
&gt;&gt; Just tested it a little bit and I&#39;m not sure what you will be missing
&gt;&gt; &#40;e.g. rel2abs&#41;, but it&#39;s a start.
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt; Calling system&#40;qw&#40;cpan -t .&#41;&#41;, worked only on linux, solaris, and
</div>&gt;&gt; darwin. I
<div class="message-stanza open">&gt;&gt; &gt; ran into all kinds of problems with windows and thought using App::Cpan
&gt;&gt; &gt; would be a big time saver.
</div>&gt;&gt;
&gt;&gt; Maybe it is and I&#39;m just not the right person to judge that.
&gt;&gt;
&gt;&gt; --
&gt;&gt; andreas
&gt;&gt;
&gt;&gt;
</div>&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;15:14:26&nbsp;2013</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 27 Jul 2013 21:14:04 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andreas Koenig &lt;andreas.koenig.7os6VVqR [...] franz.ak.mind.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CPAN
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; I&#39;m afraid CPAN::Shell-&gt;test doesn&#39;t work either, probably because it
&gt; relies upon the same code that uses the global variable that App::Cpan-&gt;run
&gt; uses.
</div>
You seem to have misread my postings.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I believe App::Cpan-&gt;run, when @ARGV = qw&#40;-t .&#41;, eventually calls the same
&gt; code that CPAN::Shell-&gt;test calls.
</div>
Note that I did not use qw&#40;-t .&#41; in my examples.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; According to the higher level methods, there&#39;s only one predicate that
&gt; triggers the processing of a directory that has been &#34;prepared&#34; from
&gt; source. That predicate compares the given argument to the string &#34;.&#34;. Seems
&gt; reasonable that the predicate could be enhanced to include not just &#34;.&#34; but
&gt; also any string that is an absolute pathname.
</div>
And this is what CPAN.pm does already.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Expanding that predicate wouldn&#39;t fix the whole problem, though, since the
&gt; next call normalizes the string by incorporating $CPAN::iCwd.
</div>
Maybe it would help to try my examples out, at least those where I say
that I tried them out:&#41;

&#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CPAN
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; I should also expand what I meant in my original post when I mentioned
&gt; indeterminate modules. The repository management code I&#39;m working on must
&gt; handle modules hosted by cpan.org &#40;and dependencies&#41; that my code needs. I
&gt; have a list of 10 or so that my code depends upon.
</div>
As this is a separate problem that reaches the realms of local::lib or
CPAN::Site or other modules that will help you with this problem, I
suggest you focus on the part that deals with published CPAN modules
first.

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;27&nbsp;15:20:20&nbsp;2013</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 27 Jul 2013 21:13:50 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andreas Koenig &lt;andreas.koenig.7os6VVqR [...] franz.ak.mind.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CPAN
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; I&#39;m afraid CPAN::Shell-&gt;test doesn&#39;t work either, probably because it
&gt; relies upon the same code that uses the global variable that App::Cpan-&gt;run
&gt; uses.
</div>
You seem to have misread my postings.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I believe App::Cpan-&gt;run, when @ARGV = qw&#40;-t .&#41;, eventually calls the same
&gt; code that CPAN::Shell-&gt;test calls.
</div>
Note that I did not use qw&#40;-t .&#41; in my examples.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; According to the higher level methods, there&#39;s only one predicate that
&gt; triggers the processing of a directory that has been &#34;prepared&#34; from
&gt; source. That predicate compares the given argument to the string &#34;.&#34;. Seems
&gt; reasonable that the predicate could be enhanced to include not just &#34;.&#34; but
&gt; also any string that is an absolute pathname.
</div>
And this is what CPAN.pm does already.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Expanding that predicate wouldn&#39;t fix the whole problem, though, since the
&gt; next call normalizes the string by incorporating $CPAN::iCwd.
</div>
Maybe it would help to try my examples out, at least those where I say
that I tried them out:&#41;

&#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CPAN
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; I should also expand what I meant in my original post when I mentioned
&gt; indeterminate modules. The repository management code I&#39;m working on must
&gt; handle modules hosted by cpan.org &#40;and dependencies&#41; that my code needs. I
&gt; have a list of 10 or so that my code depends upon.
</div>
As this is a separate problem that reaches the realms of local::lib or
CPAN::Site or other modules that will help you with this problem, I
suggest you focus on the part that deals with published CPAN modules
first.

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;29&nbsp;17:26:51&nbsp;2013</span>
    <span class="description">jeff.holt [...] method-r.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 29 Jul 2013 16:26:34 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeff Holt &lt;jeff.holt [...] method-r.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m sorry if I misread your postings but I thought I was pretty careful in
transposing what you wrote. I&#39;ll give you more detail regarding exactly
what I did and you can tell me where I went wrong. By way of overview, I
copied your code verbatim to a file called t.pl. Then I executed &#34;perl t.pl&#34;.
What I got is as follows. My shell prompt is &#34;$ &#34;.

$ perl t.pl
You are visiting the local directory
  &#39;/Users/jholt/devel-symdump/.&#39;
  without lock, take care that concurrent processes do not do likewise.
Reading &#39;/Users/jholt/.cpan/Metadata&#39;
  Database was generated on Sat, 27 Jul 2013 10:41:03 GMT
Fetching with LWP:
<span class="clickylink"><a target="new" rel="nofollow" href="http://ppm.activestate.com/CPAN/authors/01mailrc.txt.gz">http://ppm.activestate.com/CPAN/authors/01mailrc.txt.gz</a></span>
Reading &#39;/Users/jholt/.cpan/sources/authors/01mailrc.txt.gz&#39;
............................................................................DONE
Fetching with LWP:
<span class="clickylink"><a target="new" rel="nofollow" href="http://ppm.activestate.com/CPAN/modules/02packages.details.txt.gz">http://ppm.activestate.com/CPAN/modules/02packages.details.txt.gz</a></span>
Reading &#39;/Users/jholt/.cpan/sources/modules/02packages.details.txt.gz&#39;
  Database was generated on Mon, 29 Jul 2013 11:17:02 GMT
............................................................................DONE
Fetching with LWP:
<span class="clickylink"><a target="new" rel="nofollow" href="http://ppm.activestate.com/CPAN/modules/03modlist.data.gz">http://ppm.activestate.com/CPAN/modules/03modlist.data.gz</a></span>
Reading &#39;/Users/jholt/.cpan/sources/modules/03modlist.data.gz&#39;
............................................................................DONE
Writing /Users/jholt/.cpan/Metadata
You are visiting the local directory
  &#39;/Users/jholt/javascript-v8/.&#39;
  without lock, take care that concurrent processes do not do likewise.
Running make for /Users/jholt/devel-symdump/.
Couldn&#39;t opendir /Users/jholt/devel-symdump/.: No such file or directory at
/usr/local/ActivePerl-5.16/site/lib/CPAN/Shell.pm line 1797.
$ cat t.pl
my @modules = qw&#40;devel-symdump javascript-v8&#41;;
  use Cwd;
  my $cwd = cwd;
  use File::Spec;
  my @targets = map { File::Spec-&gt;catdir&#40;$cwd, $_&#41; . &#34;/.&#34; } @modules;
  use CPAN;
  CPAN::Shell-&gt;test&#40;@targets&#41;;
$


On Sat, Jul 27, 2013 at 2:14 PM, &#40;Andreas J. Koenig&#41; via RT &lt;
bug-CPAN@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; &#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:
&gt;
<div class="message-stanza open">&gt; &gt;        Queue: CPAN
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt; &gt;
&gt; &gt; I&#39;m afraid CPAN::Shell-&gt;test doesn&#39;t work either, probably because it
&gt; &gt; relies upon the same code that uses the global variable that
</div>&gt; App::Cpan-&gt;run
<div class="message-stanza open">&gt; &gt; uses.
</div>&gt;
&gt; You seem to have misread my postings.
&gt;
<div class="message-stanza open">&gt; &gt; I believe App::Cpan-&gt;run, when @ARGV = qw&#40;-t .&#41;, eventually calls the
</div>&gt; same
<div class="message-stanza open">&gt; &gt; code that CPAN::Shell-&gt;test calls.
</div>&gt;
&gt; Note that I did not use qw&#40;-t .&#41; in my examples.
&gt;
<div class="message-stanza open">&gt; &gt; According to the higher level methods, there&#39;s only one predicate that
&gt; &gt; triggers the processing of a directory that has been &#34;prepared&#34; from
&gt; &gt; source. That predicate compares the given argument to the string &#34;.&#34;.
</div>&gt; Seems
<div class="message-stanza open">&gt; &gt; reasonable that the predicate could be enhanced to include not just &#34;.&#34;
</div>&gt; but
<div class="message-stanza open">&gt; &gt; also any string that is an absolute pathname.
</div>&gt;
&gt; And this is what CPAN.pm does already.
&gt;
<div class="message-stanza open">&gt; &gt; Expanding that predicate wouldn&#39;t fix the whole problem, though, since
</div>&gt; the
<div class="message-stanza open">&gt; &gt; next call normalizes the string by incorporating $CPAN::iCwd.
</div>&gt;
&gt; Maybe it would help to try my examples out, at least those where I say
&gt; that I tried them out:&#41;
&gt;
&gt; &#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:
&gt;
<div class="message-stanza open">&gt; &gt;        Queue: CPAN
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt; &gt;
&gt; &gt; I should also expand what I meant in my original post when I mentioned
&gt; &gt; indeterminate modules. The repository management code I&#39;m working on must
&gt; &gt; handle modules hosted by cpan.org &#40;and dependencies&#41; that my code
</div>&gt; needs. I
<div class="message-stanza open">&gt; &gt; have a list of 10 or so that my code depends upon.
</div>&gt;
&gt; As this is a separate problem that reaches the realms of local::lib or
&gt; CPAN::Site or other modules that will help you with this problem, I
&gt; suggest you focus on the part that deals with published CPAN modules
&gt; first.
&gt;
&gt; --
&gt; andreas
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;29&nbsp;22:16:40&nbsp;2013</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 30 Jul 2013 04:16:18 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andreas Koenig &lt;andreas.koenig.7os6VVqR [...] franz.ak.mind.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CPAN
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; I&#39;m sorry if I misread your postings but I thought I was pretty careful in
&gt; transposing what you wrote. I&#39;ll give you more detail regarding exactly
&gt; what I did and you can tell me where I went wrong. By way of overview, I
&gt; copied your code verbatim to a file called t.pl. Then I executed &#34;perl t.pl&#34;.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [...]
&gt;
&gt; $ cat t.pl
&gt; my @modules = qw&#40;devel-symdump javascript-v8&#41;;
</div>
The two directories above exist on my machine, unsurprisingly, they do
not exist on yours. They are placeholders for two directories containing
perl modules, like I understood you were using the variable @modules in
your examples in this ticket so far.

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;29&nbsp;23:47:28&nbsp;2013</span>
    <span class="description">jeff.holt [...] method-r.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87356] App::Cpan-&gt;run&#40;&#41; fails if you chdir after the use</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 29 Jul 2013 22:47:13 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeff Holt &lt;jeff.holt [...] method-r.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I was quite certain that I tested the approach you used &#40;i.e.,
concatenating &#34;/.&#34; onto the module directory name. Apparently I didn&#39;t
because your method works.

I believe you should close this case, with my apologies.


On Mon, Jul 29, 2013 at 9:16 PM, &#40;Andreas J. Koenig&#41; via RT &lt;
bug-CPAN@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt;
&gt; &#34;Jeff Holt via RT&#34; &lt;bug-CPAN@rt.cpan.org&gt; writes:
&gt;
<div class="message-stanza open">&gt; &gt;        Queue: CPAN
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87356">https://rt.cpan.org/Ticket/Display.html?id=87356</a></span> &gt;
&gt; &gt;
&gt; &gt; I&#39;m sorry if I misread your postings but I thought I was pretty careful
</div>&gt; in
<div class="message-stanza open">&gt; &gt; transposing what you wrote. I&#39;ll give you more detail regarding exactly
&gt; &gt; what I did and you can tell me where I went wrong. By way of overview, I
&gt; &gt; copied your code verbatim to a file called t.pl. Then I executed &#34;perl
</div>&gt; t.pl&#34;.
&gt;
<div class="message-stanza open">&gt; &gt; [...]
&gt; &gt;
&gt; &gt; $ cat t.pl
&gt; &gt; my @modules = qw&#40;devel-symdump javascript-v8&#41;;
</div>&gt;
&gt; The two directories above exist on my machine, unsurprisingly, they do
&gt; not exist on yours. They are placeholders for two directories containing
&gt; perl modules, like I understood you were using the variable @modules in
&gt; your examples in this ticket so far.
&gt;
&gt; --
&gt; andreas
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;30&nbsp;15:44:04&nbsp;2013</span>
    <span class="description">ANDK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you, closing ticket. If you have an idea where we should tweak the documentation such that the next user has a better chance to survive, let us know.

Best wishes,
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;30&nbsp;15:44:04&nbsp;2013</span>
    <span class="description">ANDK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
