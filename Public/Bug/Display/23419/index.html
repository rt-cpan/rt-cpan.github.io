<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #23419 for IO-Socket-SSL: IO::Socket::SSL and Storable</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #23419 for IO-Socket-SSL: IO::Socket::SSL and Storable</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=IO-Socket-SSL">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=IO-Socket-SSL">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=IO-Socket-SSL">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=IO-Socket-SSL">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Socket-SSL">IO-Socket-SSL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">23419</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=IO-Socket-SSL">IO-Socket-SSL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jschulz.cpan [...] bloonix.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-17228-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.01    </td>
  </tr>
  <tr id="CF-17229-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=23419">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-265948" href="/Public/Bug/Display.html?id=23419#txn-265948">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;17&nbsp;05:15:29&nbsp;2006</span>
    <span class="description">jschulz.cpan [...] bloonix.de - Ticket #23418:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/265948/116444/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/116444">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, I tests IO::Socket::SSL with Storable and received the following 
error:

File is not a perl storable at ../../lib/Storable.pm &#40;autosplit into
 ../../lib/auto/Storable/fd_retrieve.al&#41; line 346, at ./storable-socket-
ssl line 61

my code:

use strict;
use warnings;

package Server;

use IO::Socket::SSL;
use Storable qw&#40;nstore_fd&#41;;
use Data::Dumper;

unless &#40;-d &#34;certs&#34;&#41; {
   if &#40;-d &#34;../certs&#34;&#41; {
       chdir &#34;..&#34;;
   } else {
       die &#34;Please run this example from the IO::Socket::SSL 
distribution directory!\n&#34;;
   }
}

sub run {
  my $socket = IO::Socket::SSL-&gt;new&#40;
     Listen =&gt; 5,
     LocalAddr =&gt; &#39;localhost&#39;,
     LocalPort =&gt; 9000,
     Proto     =&gt; &#39;tcp&#39;,
     Reuse     =&gt; 1,
     SSL_verify_mode =&gt; 0x01,
     SSL_passwd_cb =&gt; sub {return &#34;bluebell&#34;},
  &#41; or die &#34;server: can&#39;t open socket over port 9000&#34;;

  warn &#34;server initialized\n&#34;;

  while &#40;my $client = $socket-&gt;accept&#40;&#41;&#41; {
     chomp &#40;my $request = &lt;$client&gt;&#41;;
     next unless $request;
     warn &#34;client request: $request\n&#34;;
     my %hash = &#40;a=&gt;1,b=&gt;2,c=&gt;3&#41;;
     nstore_fd&#40;\%hash, $client&#41; or die $!;
     close&#40;$client&#41;;
     close&#40;$socket&#41;;
  }
}

package Client;

use IO::Socket::SSL;
use Storable qw&#40;fd_retrieve&#41;;
use Data::Dumper;

sub run {
  my $socket = IO::Socket::SSL-&gt;new&#40;
     PeerAddr =&gt; &#39;localhost&#39;,
     PeerPort =&gt; &#39;9000&#39;,
     Proto    =&gt; &#39;tcp&#39;,
     SSL_use_cert =&gt; 1,
     SSL_verify_mode =&gt; 0x01,
     SSL_passwd_cb =&gt; sub { return &#34;opossum&#34; }
  &#41; or die &#34;client: can&#39;t connect to 127.0.0.1:9000&#34;;

  warn &#34;client connected to server\n&#34;;
  print $socket &#34;hash\n&#34;;
  my $data = fd_retrieve&#40;$socket&#41; or die $!;
  warn Dumper&#40;$data&#41;;
  close&#40;$socket&#41;;
}

1;

if &#40;my $pid = fork&#41; {
  run Server;
  waitpid&#40;$pid,0&#41;;
} else {
  sleep 1;
  run Client;
}

end code

If I run the same example with IO::Socket::INET I receive no error.

#&gt; perl -V
Summary of my perl5 &#40;revision 5 version 8 subversion 7&#41; configuration:
  Platform:
    osname=linux, osvers=2.6.10, archname=i486-linux-gnu-thread-multi
    uname=&#39;linux rothera 2.6.10 #1 smp fri may 13 09:24:22 utc 2005 
i686 gnulinux &#39;
    config_args=&#39;-Dusethreads -Duselargefiles -Dccflags=-DDEBIAN -
Dcccdlflags=-fPIC -Darchname=i486-linux-gnu -Dprefix=/usr -Dprivlib=/
usr/share/perl/5.8 -Darchlib=/usr/lib/perl/5.8 -Dvendorprefix=/usr -
Dvendorlib=/usr/share/perl5 -Dvendorarch=/usr/lib/perl5 -Dsiteprefix=/
usr/local -Dsitelib=/usr/local/share/perl/5.8.7 -Dsitearch=/usr/local/
lib/perl/5.8.7 -Dman1dir=/usr/share/man/man1 -Dman3dir=/usr/share/man/
man3 -Dsiteman1dir=/usr/local/man/man1 -Dsiteman3dir=/usr/local/man/
man3 -Dman1ext=1 -Dman3ext=3perl -Dpager=/usr/bin/sensible-pager -Uafs -
Ud_csh -Uusesfio -Uusenm -Duseshrplib -Dlibperl=libperl.so.5.8.7 -
Dd_dosuid -des&#39;
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=define use5005threads=undef useithreads=define 
usemultiplicity=define
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=undef use64bitall=undef uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS -
DDEBIAN -fno-strict-aliasing -pipe -I/usr/local/include -
D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-O2&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS -DDEBIAN -
fno-strict-aliasing -pipe -I/usr/local/include&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.0.3 20051204 &#40;prerelease&#41; &#40;Ubuntu 4.0.2-
5ubuntu2&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, 
lseeksize=8
    alignbytes=4, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39; -L/usr/local/lib&#39;
    libpth=/usr/local/lib /lib /usr/lib
    libs=-lgdbm -lgdbm_compat -ldb -ldl -lm -lpthread -lc -lcrypt
    perllibs=-ldl -lm -lpthread -lc -lcrypt
    libc=/lib/libc-2.3.5.so, so=so, useshrplib=true, 
libperl=libperl.so.5.8.7
    gnulibc_version=&#39;2.3.5&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -L/usr/local/lib&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: MULTIPLICITY USE_ITHREADS USE_LARGE_FILES
                        PERL_IMPLICIT_CONTEXT
  Locally applied patches:
        SPRINTF0 - fixes for sprintf formatting issues - CVE-2005-3962
  Built under linux
  Compiled at Dec 16 2005 07:48:39
  @INC:
    /etc/perl
    /usr/local/lib/perl/5.8.7
    /usr/local/share/perl/5.8.7
    /usr/lib/perl5
    /usr/share/perl5
    /usr/lib/perl/5.8
    /usr/share/perl/5.8
    /usr/local/lib/site_perl

#&gt; uname -a
Linux acd-js 2.6.15-27-386 #1 PREEMPT Sat Sep 16 01:51:59 UTC 2006 i686 
GNU/Linux

Cheers,
Jonny
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-265955" href="/Public/Bug/Display.html?id=23419#txn-265955">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;17&nbsp;05:15:47&nbsp;2006</span>
    <span class="description">jschulz.cpan [...] bloonix.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> IO::Socket::SSL and Storable</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/265955/116447/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/116447">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, I tests IO::Socket::SSL with Storable and received the following 
error:

File is not a perl storable at ../../lib/Storable.pm &#40;autosplit into
 ../../lib/auto/Storable/fd_retrieve.al&#41; line 346, at ./storable-socket-
ssl line 61

my code:

use strict;
use warnings;

package Server;

use IO::Socket::SSL;
use Storable qw&#40;nstore_fd&#41;;
use Data::Dumper;

unless &#40;-d &#34;certs&#34;&#41; {
   if &#40;-d &#34;../certs&#34;&#41; {
       chdir &#34;..&#34;;
   } else {
       die &#34;Please run this example from the IO::Socket::SSL 
distribution directory!\n&#34;;
   }
}

sub run {
  my $socket = IO::Socket::SSL-&gt;new&#40;
     Listen =&gt; 5,
     LocalAddr =&gt; &#39;localhost&#39;,
     LocalPort =&gt; 9000,
     Proto     =&gt; &#39;tcp&#39;,
     Reuse     =&gt; 1,
     SSL_verify_mode =&gt; 0x01,
     SSL_passwd_cb =&gt; sub {return &#34;bluebell&#34;},
  &#41; or die &#34;server: can&#39;t open socket over port 9000&#34;;

  warn &#34;server initialized\n&#34;;

  while &#40;my $client = $socket-&gt;accept&#40;&#41;&#41; {
     chomp &#40;my $request = &lt;$client&gt;&#41;;
     next unless $request;
     warn &#34;client request: $request\n&#34;;
     my %hash = &#40;a=&gt;1,b=&gt;2,c=&gt;3&#41;;
     nstore_fd&#40;\%hash, $client&#41; or die $!;
     close&#40;$client&#41;;
     close&#40;$socket&#41;;
  }
}

package Client;

use IO::Socket::SSL;
use Storable qw&#40;fd_retrieve&#41;;
use Data::Dumper;

sub run {
  my $socket = IO::Socket::SSL-&gt;new&#40;
     PeerAddr =&gt; &#39;localhost&#39;,
     PeerPort =&gt; &#39;9000&#39;,
     Proto    =&gt; &#39;tcp&#39;,
     SSL_use_cert =&gt; 1,
     SSL_verify_mode =&gt; 0x01,
     SSL_passwd_cb =&gt; sub { return &#34;opossum&#34; }
  &#41; or die &#34;client: can&#39;t connect to 127.0.0.1:9000&#34;;

  warn &#34;client connected to server\n&#34;;
  print $socket &#34;hash\n&#34;;
  my $data = fd_retrieve&#40;$socket&#41; or die $!;
  warn Dumper&#40;$data&#41;;
  close&#40;$socket&#41;;
}

1;

if &#40;my $pid = fork&#41; {
  run Server;
  waitpid&#40;$pid,0&#41;;
} else {
  sleep 1;
  run Client;
}

end code

If I run the same example with IO::Socket::INET I receive no error.

#&gt; perl -V
Summary of my perl5 &#40;revision 5 version 8 subversion 7&#41; configuration:
  Platform:
    osname=linux, osvers=2.6.10, archname=i486-linux-gnu-thread-multi
    uname=&#39;linux rothera 2.6.10 #1 smp fri may 13 09:24:22 utc 2005 
i686 gnulinux &#39;
    config_args=&#39;-Dusethreads -Duselargefiles -Dccflags=-DDEBIAN -
Dcccdlflags=-fPIC -Darchname=i486-linux-gnu -Dprefix=/usr -Dprivlib=/
usr/share/perl/5.8 -Darchlib=/usr/lib/perl/5.8 -Dvendorprefix=/usr -
Dvendorlib=/usr/share/perl5 -Dvendorarch=/usr/lib/perl5 -Dsiteprefix=/
usr/local -Dsitelib=/usr/local/share/perl/5.8.7 -Dsitearch=/usr/local/
lib/perl/5.8.7 -Dman1dir=/usr/share/man/man1 -Dman3dir=/usr/share/man/
man3 -Dsiteman1dir=/usr/local/man/man1 -Dsiteman3dir=/usr/local/man/
man3 -Dman1ext=1 -Dman3ext=3perl -Dpager=/usr/bin/sensible-pager -Uafs -
Ud_csh -Uusesfio -Uusenm -Duseshrplib -Dlibperl=libperl.so.5.8.7 -
Dd_dosuid -des&#39;
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=define use5005threads=undef useithreads=define 
usemultiplicity=define
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=undef use64bitall=undef uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS -
DDEBIAN -fno-strict-aliasing -pipe -I/usr/local/include -
D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-O2&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS -DDEBIAN -
fno-strict-aliasing -pipe -I/usr/local/include&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.0.3 20051204 &#40;prerelease&#41; &#40;Ubuntu 4.0.2-
5ubuntu2&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;, 
lseeksize=8
    alignbytes=4, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39; -L/usr/local/lib&#39;
    libpth=/usr/local/lib /lib /usr/lib
    libs=-lgdbm -lgdbm_compat -ldb -ldl -lm -lpthread -lc -lcrypt
    perllibs=-ldl -lm -lpthread -lc -lcrypt
    libc=/lib/libc-2.3.5.so, so=so, useshrplib=true, 
libperl=libperl.so.5.8.7
    gnulibc_version=&#39;2.3.5&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -L/usr/local/lib&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: MULTIPLICITY USE_ITHREADS USE_LARGE_FILES
                        PERL_IMPLICIT_CONTEXT
  Locally applied patches:
        SPRINTF0 - fixes for sprintf formatting issues - CVE-2005-3962
  Built under linux
  Compiled at Dec 16 2005 07:48:39
  @INC:
    /etc/perl
    /usr/local/lib/perl/5.8.7
    /usr/local/share/perl/5.8.7
    /usr/lib/perl5
    /usr/share/perl5
    /usr/lib/perl/5.8
    /usr/share/perl/5.8
    /usr/local/lib/site_perl

#&gt; uname -a
Linux acd-js 2.6.15-27-386 #1 PREEMPT Sat Sep 16 01:51:59 UTC 2006 i686 
GNU/Linux

Cheers,
Jonny
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-265958" href="/Public/Bug/Display.html?id=23419#txn-265958">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;17&nbsp;05:17:32&nbsp;2006</span>
    <span class="description">jschulz.cpan [...] bloonix.de - Ticket #23418:  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/265958/116450/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/116450">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 47b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry, double post! You can delete this report!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-265961" href="/Public/Bug/Display.html?id=23419#txn-265961">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;17&nbsp;05:17:34&nbsp;2006</span>
    <span class="description">jschulz.cpan [...] bloonix.de - Ticket #23418:  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-266737" href="/Public/Bug/Display.html?id=23419#txn-266737">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;18&nbsp;18:31:45&nbsp;2006</span>
    <span class="description">jschulz.cpan [...] bloonix.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> BLOONIX [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/266737/116922/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/116922">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 934b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

I have further informations.

Send:
      my %hash1 = &#40; a =&gt; 1 &#41;;
      my %hash2 = &#40; 1, 2, 3, 4 &#41;;
      my %hash3 = &#40; a =&gt; &#39;1&#39; &#41;;
      my $dump1 = nfreeze \%hash1;
      my $dump2 = nfreeze \%hash2;
      my $dump3 = nfreeze \%hash3;
      print $client $dump1;
      print $client &#34;\n&#34;;
      print $client $dump2;
      print $client &#34;\n&#34;;
      print $client $dump3;

Receive:
   my $dump1 = &lt;$socket&gt;;
   my $dump2 = &lt;$socket&gt;;
   my $dump3 = &lt;$socket&gt;;
   my $data1 = thaw&#40;$dump1&#41;;
   my $data2 = thaw&#40;$dump2&#41;;
   my $data3 = thaw&#40;$dump3&#41;;
   warn Dumper&#40;$data1&#41;;
   warn Dumper&#40;$data2&#41;;
   warn Dumper&#40;$data3&#41;;

Output:
$VAR1 = {
         &#39;a&#39; =&gt; 1
       };
$VAR1 = {
         &#39;1&#39; =&gt; 2,
         &#39;3&#39; =&gt; 4
       };
$VAR1 = undef;


The problem doesn&#39;t exists with IO::Socket::INET but with 
IO::Socket::SSL. What can this be? Also I tried it with nfreeze&#40;&#41; and 
thaw&#40;&#41; and got the same output &#40;undef&#41;.

Regards,
Jonny
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-267173" href="/Public/Bug/Display.html?id=23419#txn-267173">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;21&nbsp;02:11:01&nbsp;2006</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen_Ullrich [...] genua.de</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/267173/117147/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/117147">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Storable uses the PerlIO layer to send and retrieve data, not the
sysread/syswrite function. With ssl a read might fail because it
needs to write and a write might fail because it needs to read &#40;because
the it needs to do SSL handshaking, e.g. transport data on the SSL
layer, not on the application layer&#41;.
I guess it needs one need to export the sysread/syswrite somehow to 
the PerlIO Layer, but I don&#39;t know yet how.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; The problem doesn&#39;t exists with IO::Socket::INET but with 
&gt; IO::Socket::SSL. What can this be? Also I tried it with nfreeze&#40;&#41; and 
&gt; thaw&#40;&#41; and got the same output &#40;undef&#41;.
</div>
The problem with the undef in your example is an error in the code.
You do &#39;print $client3&#39; w/o a newline afterwards, but you read with
&lt;$socket&gt;, e.g expecting a line, which you don&#39;t get.
With all the prints before you add a &#39;print &#34;\n&#34;&#39;.

But there is another flaw in your program. The output from nfreeze is
binary, so it might contain &#34;\n&#34; already. Thus reading with &lt;$socket&gt;
might give you only part of the packet.
Me preferred method:

  write:
  my $packet = nfreeze&#40; $data &#41;;      # freeze packet
  $packet = pack&#40; &#34;N/a*&#34;, $packet &#41;;  # add length of packet
  print $packet;

  read:
  die if 4 != read&#40; $socket, my $buf,4 &#41;;   # read length
  my $len = unpack&#40; &#34;N&#34;,$buf &#41;;             # extract length
  die if $len != read&#40; $socket, $buf,$len&#41;; # read data
  my $data = thaw&#40; $buf &#41;;                  # thaw packet

This is not much harder then fd_retrieve etc, but you have more
control about error handling and this is the only method which works
if you need multiple read/writes &#40;e.g if the socket is non-blocking&#41;

 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Regards,
&gt; Jonny
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-267174" href="/Public/Bug/Display.html?id=23419#txn-267174">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;21&nbsp;02:11:02&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-267682" href="/Public/Bug/Display.html?id=23419#txn-267682">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;22&nbsp;12:15:25&nbsp;2006</span>
    <span class="description">jschulz.cpan [...] bloonix.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> BLOONIX [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/267682/117434/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/117434">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 700b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hallo Steffen,

danke fuer deine zuegige Antwort.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The problem with the undef in your example is an error in the code.
&gt; You do &#39;print $client3&#39; w/o a newline afterwards, but you read with
&gt; &lt;$socket&gt;, e.g expecting a line, which you don&#39;t get.
&gt; With all the prints before you add a &#39;print &#34;\n&#34;&#39;.
</div>
Das Problem besteht auch mit einen print $client3 &#34;\n&#34;;

my %hash1 = &#40; a =&gt; 1 &#41;;
my %hash2 = &#40; 1, 2, 3, 4 &#41;;
my %hash3 = &#40; a =&gt; &#39;1&#39; &#41;;

Wenn ich %hash1 = &#40; a =&gt; &#39;1&#39; &#41;; zuweise, dann klappt es einfach nicht. 
Der einzige Unterschied hier sind die Hochkomma &#39;1&#39;. Strings werden 
also auch nicht Uebertragen, da sie ebenfalls gequotet werden muessen. 
Diese Phenomaen ist recht seltsam.

Gruss,
Jonny
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-267714" href="/Public/Bug/Display.html?id=23419#txn-267714">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;22&nbsp;13:25:22&nbsp;2006</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steffen_Ullrich [...] genua.de</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/267714/117448/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/117448">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">das Problem ist, das du mit &lt;$socket&gt; liest.
Damit liest du bis zum Zeilenende, genauer gesagt bis 0x0a &#40;&#34;\n&#34;&#41;.
Wenn du mal anschaust, wie { a =&gt; &#39;1&#39; } gefreezed wird im Gegensatz
zu  { a =&gt; 1 }:


perl -MStorable -e &#39; print Storable::nfreeze&#40;{ a =&gt; q[1] }&#41;&#39; | od -x
0000000 0705 0003 0000 0a01 3101 0000 0100 0061
0000017

vs. 
perl -MStorable -e &#39; print Storable::nfreeze&#40;{ a =&gt; q1 }&#41;&#39; | od -x
0000000 0705 0003 0000 0a01 7102 0031 0000 6101
0000020

dann fällt auf, das bei der ersten Variante ein 0x0a, d.h newline
im gefreezten auftaucht, bei der zweiten aber nicht. D.h. dein
&lt;$socket&gt; liest nur die ersten paar bytes, bis zum ersten 0x0a.

der Output von Storable::nfreeze ist binary, d.h. du kannst ihn nicht
sicher mit &lt;&gt; einlesen, sondern musst stattdessen die Länge vorab
wissen und dann mit read&#40; $fd,$buf,$len&#41; die Daten einlesen.
Siehe das Beispiel vom letzten Mal, wie man ein Paket erzeugt, was als
Prefix die Länge hat und wie man mit dem ersten read dann die Länge
und mit dem zweiten read dann die Daten einliest




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Das Problem besteht auch mit einen print $client3 &#34;\n&#34;;
&gt; 
&gt; my %hash1 = &#40; a =&gt; 1 &#41;;
&gt; my %hash2 = &#40; 1, 2, 3, 4 &#41;;
&gt; my %hash3 = &#40; a =&gt; &#39;1&#39; &#41;;
&gt; 
&gt; Wenn ich %hash1 = &#40; a =&gt; &#39;1&#39; &#41;; zuweise, dann klappt es einfach nicht. 
&gt; Der einzige Unterschied hier sind die Hochkomma &#39;1&#39;. Strings werden 
&gt; also auch nicht Uebertragen, da sie ebenfalls gequotet werden muessen. 
&gt; Diese Phenomaen ist recht seltsam.
&gt; 
&gt; Gruss,
&gt; Jonny
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-270153" href="/Public/Bug/Display.html?id=23419#txn-270153">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;01&nbsp;04:11:48&nbsp;2006</span>
    <span class="description">Steffen_Ullrich [...] genua.de - Ticket #23418:  Merged into ticket #23419</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-270154" href="/Public/Bug/Display.html?id=23419#txn-270154">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;01&nbsp;04:11:48&nbsp;2006</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Merged into ticket #23419</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-270163" href="/Public/Bug/Display.html?id=23419#txn-270163">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;01&nbsp;04:43:03&nbsp;2006</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/270163/118797/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/118797">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 143b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I don&#39;t expect me to fix this in the near future.
At least added info in manual page and BUGS file about the problem
and how to work around it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-930470" href="/Public/Bug/Display.html?id=23419#txn-930470">#</a>      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;02&nbsp;14:23:25&nbsp;2011</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/930470/482924/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/482924">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 60b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">will probably never work unless Storable behaves differently
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-930473" href="/Public/Bug/Display.html?id=23419#txn-930473">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;May&nbsp;02&nbsp;14:23:26&nbsp;2011</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.540292</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
