<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #26792 for XML-Comma: 1.991 breaks toolchain</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #26792 for XML-Comma: 1.991 breaks toolchain</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/XML-Comma/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/XML-Comma/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/XML-Comma/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/XML-Comma/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-Comma">XML-Comma CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">26792</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/XML-Comma/Active/">XML-Comma</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ANDK [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-36998-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-36999-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;29&nbsp;21:12:03&nbsp;2007</span>
    <span class="description">ANDK [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 1.991 breaks toolchain</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The following addition in 1.991 breaks automatic installs with the CPAN
toolchain:

+       if&#40;$@&#41; {
+               #die results in this output: &#34;# Looks like your test
died before it could output anything.&#34;
+               warn &#34;missing depends, stopping to let CPAN or user get
them\n&#34;;
+               exit&#40;1&#41;;
+       }


You should never die within a Makefile.PL &#40;unless you have to, of course&#41;.
As long as you *can* write a Makefile, do it and let the rest of the
toolchain care for the dirty bits like installing PREREQs.

This can only work smoothely if you write your Makefile.

Thing like the initalization of a database is better delayed and done
within a make target.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;29&nbsp;22:01:44&nbsp;2007</span>
    <span class="description">brianski [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> cpanski [...] allafrica.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for your continued comments, Andreas.

This &#40;the die&#39;ing&#41; is fixed in 1.992, which, if it isn&#39;t available
through CPAN yet, can be obtained here:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://xml-comma.org/dist/XML-Comma-1.992.tgz">http://xml-comma.org/dist/XML-Comma-1.992.tgz</a></span>

As for initialization of the database in a seperate make target, this
will have to wait a bit for the redesign of the install process &#40;which
has always been a bit of a kludgy afterthought, although I&#39;m tyring to
change that now&#41;.

Thanks again, and let me know how 1.992 does!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;29&nbsp;22:01:45&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;30&nbsp;03:12:30&nbsp;2007</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> ANDK [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #26792] 1.991 breaks toolchain</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Apr 2007 09:11:07 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-Comma [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andreas.koenig.7os6VVqR [...] franz.ak.mind.de &#40;Andreas J. Koenig&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; On Sun, 29 Apr 2007 22:01:46 -0400, &#34;Brian Szymanski via RT&#34; &lt;bug-XML-Comma@rt.cpan.org&gt; said:
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=26792">http://rt.cpan.org/Ticket/Display.html?id=26792</a></span> &gt;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Thank you for your continued comments, Andreas.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; This &#40;the die&#39;ing&#41; is fixed in 1.992, which, if it isn&#39;t available
  &gt; through CPAN yet, can be obtained here:
  &gt;   <span class="clickylink"><a target="new" rel="nofollow" href="http://xml-comma.org/dist/XML-Comma-1.992.tgz">http://xml-comma.org/dist/XML-Comma-1.992.tgz</a></span>
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; As for initialization of the database in a seperate make target, this
  &gt; will have to wait a bit for the redesign of the install process &#40;which
  &gt; has always been a bit of a kludgy afterthought, although I&#39;m tyring to
  &gt; change that now&#41;.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Thanks again, and let me know how 1.992 does!
</div>
It&#39;s not getting better. Now the Makefile.PL lets me know

  Checking if your kit is complete...
  Looks good
  Writing Makefile for XML::Comma
  missing one or more dependencies, not running comma-create-config.pl

After that it asks me no questions, so does not configure my database
and goes on to make and test and of course fails the database tests.

When I look into the Makefile I find there the prereqs:

    Compress::Zlib Crypt::Blowfish PAR Storable Lingua::Stem
    String::CRC Inline Test::More Crypt::CBC Class::ClassDecorator
    Digest::HMAC_MD5 Math::BaseCalc DBD::mysql DBI

All of them are installed on my system and at the current version.

Better you do not care if modules are installed or not. MakeMaker does
this for you and most of the time better. Just declare your
prerequisites and work along with what you have. And if you fail for
some reason, be as specific as possible so that the user has a chance
to correct his system before the next step.

Out of curiosity I stepped into the Makefile.PL with the debugger and found

main::&#40;Makefile.PL:103&#41;:                        warn &#34;missing one or more dependencies, not running comma-create-config.pl\n&#34;;
DB&lt;3&gt; x $pm
0  &#39;Compress::Zlib.pm&#39;

Outch. Did you ever run your Makefile.PL yourself?         

-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;30&nbsp;04:12:39&nbsp;2007</span>
    <span class="description">brianski [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Apr 30 03:12:30 2007, andreas.koenig.7os6VVqR@franz.ak.mind.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It&#39;s not getting better. Now the Makefile.PL lets me know
&gt; 
&gt;   Checking if your kit is complete...
&gt;   Looks good
&gt;   Writing Makefile for XML::Comma
&gt;   missing one or more dependencies, not running comma-create-config.pl
&gt; 
&gt; After that it asks me no questions, so does not configure my database
&gt; and goes on to make and test and of course fails the database tests.
&gt; 
&gt; When I look into the Makefile I find there the prereqs:
&gt; 
&gt;     Compress::Zlib Crypt::Blowfish PAR Storable Lingua::Stem
&gt;     String::CRC Inline Test::More Crypt::CBC Class::ClassDecorator
&gt;     Digest::HMAC_MD5 Math::BaseCalc DBD::mysql DBI
&gt; 
&gt; All of them are installed on my system and at the current version.
</div> 
My apologies - I committed and uploaded the wrong tarball, which had a
typo in it. I just verified that Makefile.PL as committed to CPAN and
svn *now* works properly on clean and existing mysql installs, as well
as existing Pg installs:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://xml-comma.org/dist/XML-Comma-1.993.tgz">http://xml-comma.org/dist/XML-Comma-1.993.tgz</a></span>

BTW, The reason for the double-checking of dependencies is so that we
can avoid asking the user all sorts of configuration questions if we
know they don&#39;t have a dependency they need. You&#39;re right that this
would be better handled in a makefile step, but it&#39;s too close to 2.0 to
rejigger our &#40;as you can see!&#41; fragile installation system.

Here&#39;s the patch:
<span class="clickylink"><a target="new" rel="nofollow" href="http://chronicle.allafrica.com/viewvc/viewcvs.cgi/trunk/XML-Comma/Makefile.PL?rev=1064&#38;r1=1063&#38;r2=1064">http://chronicle.allafrica.com/viewvc/viewcvs.cgi/trunk/XML-Comma/Makefile.PL?rev=1064&#38;r1=1063&#38;r2=1064</a></span>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Out of curiosity I stepped into the Makefile.PL with the debugger and
&gt; found
&gt; 
&gt; main::&#40;Makefile.PL:103&#41;:                        warn &#34;missing one or
&gt; more dependencies, not running comma-create-config.pl\n&#34;;
&gt; DB&lt;3&gt; x $pm
&gt; 0  &#39;Compress::Zlib.pm&#39;
&gt; 
&gt; Outch. Did you ever run your Makefile.PL yourself?
</div>
Yes, but the wrong version :&#41; Sorry for that.

Also, just FYI, I am still learning how CPAN works, but I see you
maintain it. Is there a way to simulate cpan installation of a tarball,
so it would attempt to auto-resolve, build, and fetch dependencies and
all that? It would help me avoid some of this testing-thru-CPAN stuff I
am doing at the moment &#40;to your chagrin!&#41; since I have the luxury of
knowing anyone who&#39;s likely to install comma, and comma never used to
install right out of CPAN anyway &#40;but of course I&#39;d like to change both
of those facts!&#41;

Thanks again!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;30&nbsp;13:18:33&nbsp;2007</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> ANDK [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #26792] 1.991 breaks toolchain</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Apr 2007 19:17:46 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-Comma [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andreas.koenig.7os6VVqR [...] franz.ak.mind.de &#40;Andreas J. Koenig&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; On Mon, 30 Apr 2007 04:12:40 -0400, &#34;Brian Szymanski via RT&#34; &lt;bug-XML-Comma@rt.cpan.org&gt; said:
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"> &gt;&gt; Outch. Did you ever run your Makefile.PL yourself?
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Yes, but the wrong version :&#41; Sorry for that.
</div>
What a cute mistake:&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Also, just FYI, I am still learning how CPAN works, but I see you
  &gt; maintain it. Is there a way to simulate cpan installation of a tarball,
  &gt; so it would attempt to auto-resolve, build, and fetch dependencies and
  &gt; all that?
</div>
Upgrade your CPAN.pm to 1.9101, chdir to the root directory of your
sources, run &#39;cpan .&#39;.

Or, to be even closer to real conditions: roll your tarball, unroll it
somewhere else, go to *its* root directory and do the &#39;cpan .&#39; there.

&#40;When I say &#39;root directory&#39; I mean the directory where your
Makefile.PL is&#41;

If your CPAN.pm is configured properly, it should work exactly as
later on the user&#39;s site.

In the meantime I have run your tests successfully to the end. When I
tried to &#39;make install&#39;, somebody tried to run &#39;perl
misc/install-extras.pl&#39; and failed miserably. Of course! It&#39;s never
&#39;perl&#39; it&#39;s always $^X. You cannot presume that the first perl in the
path is the one we are installing right now. My perl is NOT in the
path at all.

But at least we are through the &#39;make test&#39; stage now. Don&#39;t give up
now:&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; It would help me avoid some of this testing-thru-CPAN stuff I
  &gt; am doing at the moment &#40;to your chagrin!&#41; since I have the luxury of
  &gt; knowing anyone who&#39;s likely to install comma, and comma never used to
  &gt; install right out of CPAN anyway &#40;but of course I&#39;d like to change both
  &gt; of those facts!&#41;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Thanks again!
</div>
Thanks to you for going through all this humpty dumpty;&#41;
-- 
andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;30&nbsp;14:15:38&nbsp;2007</span>
    <span class="description">brianski [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What a cute mistake:&#41;
</div>
The Damerau-Levenshtein distance between the uploaded code and working
code was only 1!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Upgrade your CPAN.pm to 1.9101, chdir to the root directory of your
&gt; sources, run &#39;cpan .&#39;.
&gt;
&gt; Or, to be even closer to real conditions: roll your tarball, unroll it
&gt; somewhere else, go to *its* root directory and do the &#39;cpan .&#39; there.
&gt; 
&gt; &#40;When I say &#39;root directory&#39; I mean the directory where your
&gt; Makefile.PL is&#41;
&gt; 
&gt; If your CPAN.pm is configured properly, it should work exactly as
&gt; later on the user&#39;s site.
</div>
Yea, I found this in the meantime &#40;Imagine it, RTFM&#39;ing ! ;&#41;, thanks!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In the meantime I have run your tests successfully to the end. When I
&gt; tried to &#39;make install&#39;, somebody tried to run &#39;perl
&gt; misc/install-extras.pl&#39; and failed miserably. Of course! It&#39;s never
&gt; &#39;perl&#39; it&#39;s always $^X. You cannot presume that the first perl in the
&gt; path is the one we are installing right now. My perl is NOT in the
&gt; path at all.
</div>
Interesting. Never used that magic variable before. I applied this in 1.994:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://xml-comma.org/dist/XML-Comma-1.994.tgz">http://xml-comma.org/dist/XML-Comma-1.994.tgz</a></span>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks to you for going through all this humpty dumpty;&#41;
</div>
Thank you very much for your patience while I kludge together a slightly
more usable install process :&#41;

Let me know if you encounter any further issues...

BTW, if you want to see some more recent, cleaner example than what&#39;s
available on the website, drop a line my way and I&#39;ll see what I can dig
up for you.

Cheers,
Brian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;06&nbsp;08:37:29&nbsp;2007</span>
    <span class="description">ski [...] allafrica.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #26792] 1.991 breaks toolchain</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 06 May 2007 08:34:39 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-Comma [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Brian Szymanski &lt;ski [...] allafrica.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Andreas Koenig via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thing like the initalization of a database is better delayed and done
&gt; within a make target.
&gt;   
</div>I&#39;m going to take a look at this now... Andreas, do you know what make
target I should be pointing at? Alternatively, do you know of any cpan
modules that do db configuration the &#34;right way&#34;? I went searching and
only found some that did it ina similar way to the way comma does it
right now &#40;that is to say, the wrong way, all in Makefile.PL&#41;... Any
ideas or pointers would be appreciated.

Thanks,
Brian

-- 
Brian Szymanski
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;06&nbsp;15:32:55&nbsp;2007</span>
    <span class="description">andreas.koenig.7os6VVqR [...] franz.ak.mind.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> ANDK [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #26792] 1.991 breaks toolchain</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 06 May 2007 21:27:52 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-Comma [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andreas.koenig.7os6VVqR [...] franz.ak.mind.de &#40;Andreas J. Koenig&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; On Sun, 06 May 2007 08:38:07 -0400, &#34;Brian Szymanski via RT&#34; &lt;bug-XML-Comma@rt.cpan.org&gt; said:
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=26792">http://rt.cpan.org/Ticket/Display.html?id=26792</a></span> &gt;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt; Andreas Koenig via RT wrote:
<div class="message-stanza open"> &gt;&gt; Thing like the initalization of a database is better delayed and done
 &gt;&gt; within a make target.
 &gt;&gt; 
</div>  &gt; I&#39;m going to take a look at this now... Andreas, do you know what make
  &gt; target I should be pointing at? Alternatively, do you know of any cpan
  &gt; modules that do db configuration the &#34;right way&#34;? I went searching and
  &gt; only found some that did it ina similar way to the way comma does it
  &gt; right now &#40;that is to say, the wrong way, all in Makefile.PL&#41;... Any
  &gt; ideas or pointers would be appreciated.
</div>
I meant something like this, but I&#39;m writing this off the top of my
head, so maybe it&#39;s not perfectly valid:

    sub MY::postamble {
      my&#40;$self&#41; = @_;
      return qq{
    all :: initdb

    initdb:
    \t\$&#40;PERL&#41; bin/comma-create-config.pl
    };
    }

If you add this to your Makefile.PL, then the
bin/comma-create-config.pl script should be executed during the &#39;make&#39;
command. Besides you can tell the user that he may call &#39;make initdb&#39;
anytime later again in case it fails for some reason.

-- 
andreas
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
