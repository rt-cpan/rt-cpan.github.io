<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #46602 for MP3-Tag: Bug in Makefile.PL on non-Unix platforms</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #46602 for MP3-Tag: Bug in Makefile.PL on non-Unix platforms</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/MP3-Tag/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/MP3-Tag/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/MP3-Tag/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/MP3-Tag/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/MP3-Tag">MP3-Tag CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">46602</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/MP3-Tag/Active/">MP3-Tag</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
eric_a_benson [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-21896-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-21897-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;02:17:51&nbsp;2009</span>
    <span class="description">eric_a_benson [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 1 Jun 2009 23:17:24 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MP3-Tag [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eric Benson &lt;eric_a_benson [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
It appears that the creation of the ./lib subdirectory caused manifypods&#40;&#41; in Makefile.PL to fail on platforms where : is not a legal file name constituent. I discovered this bug while building on Cygwin. This code did not change, the bug was already there, but was not apparent until the source tree shifted. If this bug is not fixed, MP3::Tag cannot be built on Cygwin, and possibly not on Win32 as well, although I haven&#39;t tried that.

I have a fix for this bug which is a little ugly. It involves cutting and pasting some code from ExtUtils::MakeMaker. However, it does fix the bug. Basically I just copied the piece of code from init_MAN3PODS in MM_Unix that your local version of manifypods&#40;&#41; was skipping.

-------------------------------------------------------------------
package MY;

sub manifypods {
    my $self = shift;

    my $manpagename = &#39;lib/MP3/Tag/ID3v2-Data.pod&#39;;

    my $parentlibs_re = join &#39;|&#39;, @{$self-&gt;{PMLIBPARENTDIRS}};
    unless&#40;$manpagename =~ s!^\W*&#40;$parentlibs_re&#41;\W+!!s&#41; {
    $manpagename = $self-&gt;catfile&#40;
        split&#40;/::/,$self-&gt;{PARENT_NAME}&#41;,$manpagename
    &#41;;
    }
    $manpagename = $self-&gt;replace_manpage_separator&#40;$manpagename&#41;;
    $self-&gt;{MAN3PODS}-&gt;{&#39;lib/MP3/Tag/ID3v2-Data.pod&#39;} =
    $self-&gt;catfile&#40;&#34;\$&#40;INST_MAN3DIR&#41;&#34;, &#34;$manpagename.\$&#40;MAN3EXT&#41;&#34;&#41;;

    $self-&gt;SUPER::manifypods&#40;@_&#41;;
}
-------------------------------------------------------------------

A better solution would be to find a way to add this target to the list $self-&gt;{PM} prior to the processing done in init_MAN3PODS, but I have not pursued this approach.

I learned more than I ever wanted to know about ExtUtils::MakeMaker tonight.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;17:29:52&nbsp;2009</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 2 Jun 2009 14:29:28 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Benson via RT &lt;bug-MP3-Tag [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Jun 02, 2009 at 02:17:52AM -0400, Eric Benson via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It appears that the creation of the ./lib subdirectory caused manifypods&#40;&#41; in Makefile.PL to fail on platforms where : is not a legal file name constituent. I discovered this bug while building on Cygwin. This code did not change, the bug was already there, but was not apparent until the source tree shifted. If this bug is not fixed, MP3::Tag cannot be built on Cygwin, and possibly not on Win32 as well, although I haven&#39;t tried that.
</div>
The main development platform is non-Unix, so your description of the
bug is faulty.

I suspect a bug in MakeMaker on Cygwin.  Try to compare its
manifypods&#40;&#41; with it of other DOSISH platforms...

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;17:29:53&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;18:56:07&nbsp;2009</span>
    <span class="description">eric_a_benson [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 2 Jun 2009 15:55:49 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MP3-Tag [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eric Benson &lt;eric_a_benson [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
You put a file name with a colon into the MAN3PODS hash. Does a file get written on your dev. platform that contains colons? That&#39;s where the problem occurs. Cygwin can&#39;t handle colons in file names, while &#34;normal&#34; Unix can. I&#39;m guessing Win32 can&#39;t, but I don&#39;t have a Win32 Perl I can test against.



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----
From: Ilya Zakharevich via RT &lt;bug-MP3-Tag@rt.cpan.org&gt;
To: eric_a_benson@yahoo.com
Sent: Tuesday, June 2, 2009 2:29:53 PM
Subject: Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46602">https://rt.cpan.org/Ticket/Display.html?id=46602</a></span> &gt;

On Tue, Jun 02, 2009 at 02:17:52AM -0400, Eric Benson via RT wrote:
<div class="message-stanza open">&gt; It appears that the creation of the ./lib subdirectory caused manifypods&#40;&#41; in Makefile.PL to fail on platforms where : is not a legal file name constituent. I discovered this bug while building on Cygwin. This code did not change, the bug was already there, but was not apparent until the source tree shifted. If this bug is not fixed, MP3::Tag cannot be built on Cygwin, and possibly not on Win32 as well, although I haven&#39;t tried that.
</div>
The main development platform is non-Unix, so your description of the
bug is faulty.

I suspect a bug in MakeMaker on Cygwin.  Try to compare its
manifypods&#40;&#41; with it of other DOSISH platforms...

Yours,
Ilya
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;02&nbsp;21:47:18&nbsp;2009</span>
    <span class="description">eric_a_benson [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 2 Jun 2009 18:46:57 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MP3-Tag [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eric Benson &lt;eric_a_benson [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
OK, I just installed ActiveState Perl and did a CPAN install of MP3::Tag. It looks like the deal is that the manifypods rule in the generated Makefile never gets used in that environment. If I do a &#34;make manifypods&#34; in the ActiveState MP3::Tag build directory, I get a failure just like in Cygwin. If I use my patched Makefile.PL then &#34;make manifypods&#34; works in ActiveState as well as Cygwin.



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----
From: Ilya Zakharevich via RT &lt;bug-MP3-Tag@rt.cpan.org&gt;
To: eric_a_benson@yahoo.com
Sent: Tuesday, June 2, 2009 2:29:53 PM
Subject: Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46602">https://rt.cpan.org/Ticket/Display.html?id=46602</a></span> &gt;

On Tue, Jun 02, 2009 at 02:17:52AM -0400, Eric Benson via RT wrote:
<div class="message-stanza open">&gt; It appears that the creation of the ./lib subdirectory caused manifypods&#40;&#41; in Makefile.PL to fail on platforms where : is not a legal file name constituent. I discovered this bug while building on Cygwin. This code did not change, the bug was already there, but was not apparent until the source tree shifted. If this bug is not fixed, MP3::Tag cannot be built on Cygwin, and possibly not on Win32 as well, although I haven&#39;t tried that.
</div>
The main development platform is non-Unix, so your description of the
bug is faulty.

I suspect a bug in MakeMaker on Cygwin.  Try to compare its
manifypods&#40;&#41; with it of other DOSISH platforms...

Yours,
Ilya
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;01:50:00&nbsp;2009</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 2 Jun 2009 22:49:38 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Benson via RT &lt;bug-MP3-Tag [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Jun 02, 2009 at 02:17:52AM -0400, Eric Benson via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It appears that the creation of the ./lib subdirectory caused
</div>  manifypods&#40;&#41; in Makefile.PL to fail on platforms where : is not a
  legal file name constituent. I discovered this bug while building on
  Cygwin. This code did not change, the bug was already there, but was
  not apparent until the source tree shifted.

Do you know why this &#34;was not apparent&#34;?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If this bug is not
</div>  fixed, MP3::Tag cannot be built on Cygwin, and possibly not on Win32
  as well, although I haven&#39;t tried that.

???  Why failure of manifypod&#40;&#41; implies &#34;cannot be built&#34;?

Puzzled,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;04:30:08&nbsp;2009</span>
    <span class="description">eric_a_benson [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 3 Jun 2009 01:29:47 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MP3-Tag [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eric Benson &lt;eric_a_benson [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
MM_Win32 in ExtUtils is using all_target from MM_Any.pm, while MM_Cygwin is using all_target defined in MM_Unix.pm. The MM_Unix all :: target generated in the Makefile includes manifypods as a dependency, while the MM_Any does not include it. That&#39;s why the build fails on Cygwin. On &#34;real&#34; Unix manifypods creates files with colons in their names, but on Cygwin the colons are turned into dots, but it happens at an earlier stage in the process than the function manifypods, in the function init_MAN3PODS&#40;&#41;. The original double colons in the name get converted to directory separators, then converted back into :: on Unix or into dots on Cygwin by the function replace_manpage_separator&#40;&#41;. Your local version of manifypods only works for the Unix case by accident. The version I sent contains the code from init_MAN3PODS that does the right thing on all platforms.



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----
From: Ilya Zakharevich via RT &lt;bug-MP3-Tag@rt.cpan.org&gt;
To: eric_a_benson@yahoo.com
Sent: Tuesday, June 2, 2009 10:50:03 PM
Subject: Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=46602">http://rt.cpan.org/Ticket/Display.html?id=46602</a></span> &gt;

On Tue, Jun 02, 2009 at 02:17:52AM -0400, Eric Benson via RT wrote:

<div class="message-stanza open">&gt; It appears that the creation of the ./lib subdirectory caused
</div>  manifypods&#40;&#41; in Makefile.PL to fail on platforms where : is not a
  legal file name constituent. I discovered this bug while building on
  Cygwin. This code did not change, the bug was already there, but was
  not apparent until the source tree shifted.

Do you know why this &#34;was not apparent&#34;?

<div class="message-stanza open">&gt; If this bug is not
</div>  fixed, MP3::Tag cannot be built on Cygwin, and possibly not on Win32
  as well, although I haven&#39;t tried that.

???  Why failure of manifypod&#40;&#41; implies &#34;cannot be built&#34;?

Puzzled,
Ilya
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;05:39:12&nbsp;2009</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 3 Jun 2009 02:38:47 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Eric Benson via RT &lt;bug-MP3-Tag [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, Jun 03, 2009 at 04:30:09AM -0400, Eric Benson via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; MM_Win32 in ExtUtils is using all_target from MM_Any.pm, while
</div>  MM_Cygwin is using all_target defined in MM_Unix.pm. The MM_Unix all
  :: target generated in the Makefile includes manifypods as a
  dependency, while the MM_Any does not include it. That&#39;s why the
  build fails on Cygwin. On &#34;real&#34; Unix manifypods creates files with
  colons in their names, but on Cygwin the colons are turned into
  dots, but it happens at an earlier stage in the process than the
  function manifypods, in the function init_MAN3PODS&#40;&#41;. The original
  double colons in the name get converted to directory separators,
  then converted back into :: on Unix or into dots on Cygwin by the
  function replace_manpage_separator&#40;&#41;. Your local version of
  manifypods only works for the Unix case by accident. The version I
  sent contains the code from init_MAN3PODS that does the right thing
  on all platforms.

Something in this explanation is yet fishy, since MM_OS2 inherits from
MM_Unix &#40;and OS/2 does not allow : in filenames&#41;, and I do not see any
problem on OS/2...

Anyway, thank you a lot for unwinding this mess for me!  I marked this
in my TODO file, but do not yet know &#40;see above ;-&#41; what is the PROPER
way to fix this...

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;03&nbsp;11:38:50&nbsp;2009</span>
    <span class="description">eric_a_benson [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 3 Jun 2009 08:38:29 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-MP3-Tag [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eric Benson &lt;eric_a_benson [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
MM_OS2 inherits from MM_Any and then MM_Unix, the same as MM_Win32 does. So it uses the all_target&#40;&#41; in MM_Any not MM_Unix. Cygwin, Windows, OS/2 are all generating Makefiles for which &#34;make manifypods&#34; will always fail, but only Cygwin fails on &#34;make all&#34; because it inherits directly from MM_Unix.

This inheritance structure is a little odd, since MM_Unix inherits from MM_Any. So on these &#34;less Unixy&#34; platforms the grandparent shadows the definition from the parent, by also being a parent earlier in the precedence list! Browsing around the other platform MM implementations, I see that Darwin and AIX inherit only from MM_Unix, while BeOS inherits from MM_Any and then MM_Unix.

That&#39;s not really the issue anyway, since the definition of manifypods&#40;&#41; in MP3::Tag&#39;s Makefile.PL is broken in any case. The resulting Makefile has a rule that cannot work on any platform that does not allow colons in filenames. The patch I sent will fix it. It is a little suspect because it is cut-and-pasted from init_MAN3PODS. One way to fix it would be to shadow that function instead of manifypods. You would have to arrange to add the right name to the {PM} hash so that it got processed correctly.

By the way, isn&#39;t data_pod.PL being used to generate a file that is in the source tree anyway? That in itself seems a little suspect. SInce it only ever changes when a new ID3 version is supported, it seems like a bit of overkill to run this script every time you build anyway. You really only need to run it yourself when the ID3 tags change. That seems like the &#34;right&#34; fix to me.



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message ----
From: Ilya Zakharevich via RT &lt;bug-MP3-Tag@rt.cpan.org&gt;
To: eric_a_benson@yahoo.com
Sent: Wednesday, June 3, 2009 2:39:13 AM
Subject: Re: [rt.cpan.org #46602] Bug in Makefile.PL on non-Unix platforms

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=46602">http://rt.cpan.org/Ticket/Display.html?id=46602</a></span> &gt;

On Wed, Jun 03, 2009 at 04:30:09AM -0400, Eric Benson via RT wrote:

<div class="message-stanza open">&gt; MM_Win32 in ExtUtils is using all_target from MM_Any.pm, while
</div>  MM_Cygwin is using all_target defined in MM_Unix.pm. The MM_Unix all
  :: target generated in the Makefile includes manifypods as a
  dependency, while the MM_Any does not include it. That&#39;s why the
  build fails on Cygwin. On &#34;real&#34; Unix manifypods creates files with
  colons in their names, but on Cygwin the colons are turned into
  dots, but it happens at an earlier stage in the process than the
  function manifypods, in the function init_MAN3PODS&#40;&#41;. The original
  double colons in the name get converted to directory separators,
  then converted back into :: on Unix or into dots on Cygwin by the
  function replace_manpage_separator&#40;&#41;. Your local version of
  manifypods only works for the Unix case by accident. The version I
  sent contains the code from init_MAN3PODS that does the right thing
  on all platforms.

Something in this explanation is yet fishy, since MM_OS2 inherits from
MM_Unix &#40;and OS/2 does not allow : in filenames&#41;, and I do not see any
problem on OS/2...

Anyway, thank you a lot for unwinding this mess for me!  I marked this
in my TODO file, but do not yet know &#40;see above ;-&#41; what is the PROPER
way to fix this...

Yours,
Ilya
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
