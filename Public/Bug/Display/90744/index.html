<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #90744 for DBIx-Class: Be more clear about the UTF8 flag</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #90744 for DBIx-Class: Be more clear about the UTF8 flag</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBIx-Class">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBIx-Class">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBIx-Class">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBIx-Class">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBIx-Class">DBIx-Class CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">90744</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBIx-Class">DBIx-Class</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
andreas [...] andreasvoegele.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-10410-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.08250    </td>
  </tr>
  <tr id="CF-10411-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




mysql_unilatin_insert.t<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1305854/691976/mysql_unilatin_insert.t">
Fri Dec 27 12:33:23 2013 (975b) by ribasushi [...] leporine.io
</a>
</font></li>
</ul>


test-dbix-class-latin1.output<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1305797/691933/test-dbix-class-latin1.output">
Fri Dec 27 07:11:56 2013 (14.7k) by andreas [...] andreasvoegele.com
</a>
</font></li>
</ul>


test-dbix-class-latin1.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1305797/691932/test-dbix-class-latin1.pl">
Fri Dec 27 07:11:56 2013 (1.2k) by andreas [...] andreasvoegele.com
</a>
</font></li>
</ul>


test-dbix-class-utf8.output<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1305797/691930/test-dbix-class-utf8.output">
Fri Dec 27 07:11:56 2013 (9.2k) by andreas [...] andreasvoegele.com
</a>
</font></li>
</ul>


test-dbix-class-utf8.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1305797/691931/test-dbix-class-utf8.pl">
Fri Dec 27 07:11:56 2013 (1.2k) by andreas [...] andreasvoegele.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=90744">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1292739" href="/Public/Bug/Display.html?id=90744#txn-1292739">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;04:09:11&nbsp;2013</span>
    <span class="description">andreas [...] andreasvoegele.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Be more clear about the UTF8 flag</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1292739/684950/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/684950">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It took me a while to figure that the UTF8 flag always has to be set when writing to a database that supports unicode characters. The text in DBIx::Class::Manual::Cookbook says that &#34;it is better to avoid encoding/decoding data and to use your database&#39;s own unicode capabilities&#34; but I was mislead by that statement.

My program gets text from another source. The text is properly decoded to characters but internally not represented in UTF-8. If this text is written to a file or the console with proper encoding settings everything is fine. When writing to a properly configured MySQL database and mysql_enable_utf8 set, I get an error from find_or_create&#40;&#41;.

Only after reading DBIx::Class::UTF8Columns I realized that there&#39;s a long standing bug in DBIx::Class and that I have to force Perl to represent the text internally in UTF-8 as create&#40;&#41; will treat the text as a byte sequence. I now call decode_utf8&#40;encode_utf8&#40;$text&#41;&#41; in order to ensure that the UTF-8 flag is set.

The cookbook should make it more clear that the UTF8 flag needs to be set. At first I didn&#39;t read DBIx::Class::UTF8Columns as the cookbook says that it should not be &#34;used with a database that does correctly handle unicode&#34; but in order to understand the problem you have to know about this bug.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1305701" href="/Public/Bug/Display.html?id=90744#txn-1305701">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;27&nbsp;01:05:04&nbsp;2013</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305701/691881/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/691881">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, sorry for the delayed reply

On Sun Nov 24 04:09:11 2013, andreas@andreasvoegele.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It took me a while to figure that the UTF8 flag always has to be set
&gt; when writing to a database that supports unicode characters. The text
&gt; in DBIx::Class::Manual::Cookbook says that &#34;it is better to avoid
&gt; encoding/decoding data and to use your database&#39;s own unicode
&gt; capabilities&#34; but I was mislead by that statement.
&gt; 
&gt; My program gets text from another source. The text is properly decoded
&gt; to characters but internally not represented in UTF-8. If this text is
&gt; written to a file or the console with proper encoding settings
&gt; everything is fine. When writing to a properly configured MySQL
&gt; database and mysql_enable_utf8 set, I get an error from
&gt; find_or_create&#40;&#41;.
</div>
Can you elaborate what that error was?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Only after reading DBIx::Class::UTF8Columns 
</div>
This module is to never be used in new code, as per the stern warning in its documentation.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I realized that there&#39;s a
&gt; long standing bug in DBIx::Class and that I have to force Perl to
&gt; represent the text internally in UTF-8 as create&#40;&#41; will treat the text
&gt; as a byte sequence. I now call decode_utf8&#40;encode_utf8&#40;$text&#41;&#41; in
&gt; order to ensure that the UTF-8 flag is set.
</div>
This is most definitely very very wrong. Please do get back with more info about your original problem - you are papering over the issue with this erroneous decode_utf8&#40;&#41; call.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; The cookbook should make it more clear that the UTF8 flag needs to be
&gt; set. At first I didn&#39;t read DBIx::Class::UTF8Columns as the cookbook
&gt; says that it should not be &#34;used with a database that does correctly
&gt; handle unicode&#34; but in order to understand the problem you have to
&gt; know about this bug.
</div>
Again - I think you misdiagnosed the issue. More info is needed to act on this.

I will keep this ticket open for some time, pending a reply from you so we can diagnose the *real* issue you encountered.

Cheers
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1305702" href="/Public/Bug/Display.html?id=90744#txn-1305702">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;27&nbsp;01:05:06&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1305737" href="/Public/Bug/Display.html?id=90744#txn-1305737">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;27&nbsp;03:35:32&nbsp;2013</span>
    <span class="description">andreas [...] andreasvoegele.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andreas [...] andreasvoegele.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305737/691896/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/691896">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 27 01:05:04 2013, RIBASUSHI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi, sorry for the delayed reply
&gt; 
&gt; On Sun Nov 24 04:09:11 2013, andreas@andreasvoegele.com wrote:
<div class="message-stanza open">&gt; &gt; [...] When writing to a properly configured MySQL database and
&gt; &gt; mysql_enable_utf8 set, I get an error from find_or_create&#40;&#41;.
</div>&gt; 
&gt; Can you elaborate what that error was?
</div>
My program uses a web scraping module that retrieves text from the
web.  The web scraper decodes the text properly but Perl stores the
data internally in ISO-8859-1.  When writing text that contains
umlaut characters to the database I get the following error message:

DBIx::Class::Storage::DBI::_dbh_execute&#40;&#41;: DBI Exception:
DBD::mysql::st execute failed: Duplicate entry &#39;Der Hobbit 2 -
Smaugs Ein&#39; for key &#39;PRIMARY&#39; [for Statement &#34;INSERT INTO film &#40;
title&#41; VALUES &#40; ? &#41;&#34; with ParamValues: 0=&#39;Der Hobbit 2 - Smaugs Ein
de &#40;3D&#41;&#39;] at lib/MyApp/CinemaListings/Cinema.pm line 40

perlunifaq says that &#34;the internal format is either ISO-8859-1
&#40;latin-1&#41;, or utf8, depending on the history of the string&#34;.

Accordings to DBIx::Class::UTF8Column &#34;a bug was found deep in the
core of DBIx::Class which affects any component attempting to
perform encoding/decoding by overloading store_column and
get_columns. As a result of this problem create sends the original
column values to the database, while update sends the encoded
values.&#34;

It seems that DBIx::Class uses the utf8 encoded text to check 
whether the record exists but subsequently creates the record with
Perl&#39;s internal string representation, which might be ISO-8859-1.

BTW, I double checked that the web scraper decodes the text properly 
and doesn&#39;t return binary strings.  Actually, realizing that Perl
stores the text internally in ISO-8859-1 took most of the time when
debugging this problem.  My test suite reads its test data from 
files instead of the web.  When reading from files Perl stores the
text internally in utf8, i.e. everything is fine when the test suite
is run.  The error occurs only in production when the text is
retrieved from the web and internally stored in ISO-8859-1 by Perl.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Only after reading DBIx::Class::UTF8Columns
</div>&gt; 
&gt; This module is to never be used in new code, as per the stern
&gt; warning in its documentation.
</div>
I do not use DBIx::Class::UTF8Columns.  That&#39;s why I didn&#39;t read
DBIx::Class::UTF8Columns at first.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I realized that there&#39;s a long standing bug in DBIx::Class and
&gt; &gt; that I have to force Perl to represent the text internally in
&gt; &gt; UTF-8 as create&#40;&#41; will treat the text as a byte sequence. I now
&gt; &gt; call decode_utf8&#40;encode_utf8&#40;$text&#41;&#41; in order to ensure that the
&gt; &gt; UTF-8 flag is set.
</div>&gt; 
&gt; This is most definitely very very wrong. Please do get back with
&gt; more info about your original problem - you are papering over the
&gt; issue with this erroneous decode_utf8&#40;&#41; call.
</div>
This call is fine; it forces Perl to represent the given text in
utf8 internally.  encode_utf8&#40;&#41; converts the text, which might
internally be stored in ISO-8859-1, into a binary string.
decode_utf8&#40;&#41; converts the binary string back into text, which is
now internally stored in utf8.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [...] I will keep this ticket open for some time, pending a reply
&gt; from you so we can diagnose the *real* issue you encountered.
</div>
The real issue is that the bug described in DBIx::Class::UTF8Columns
not only affects programs that use DBIx::Class::UTF8Columns
or DBIx::Class::ForceUTF8 but any program unless all text that is
written to Unicode-aware databases is internally stored in utf8.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1305739" href="/Public/Bug/Display.html?id=90744#txn-1305739">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;27&nbsp;04:32:12&nbsp;2013</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305739/691898/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/691898">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 27 03:35:32 2013, andreas@andreasvoegele.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Dec 27 01:05:04 2013, RIBASUSHI wrote:
<div class="message-stanza open">&gt; &gt; Hi, sorry for the delayed reply
&gt; &gt; 
&gt; &gt; On Sun Nov 24 04:09:11 2013, andreas@andreasvoegele.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; [...] When writing to a properly configured MySQL database and
&gt; &gt; &gt; mysql_enable_utf8 set, I get an error from find_or_create&#40;&#41;.
</div>&gt; &gt; 
&gt; &gt; Can you elaborate what that error was?
</div>&gt; 
&gt; My program uses a web scraping module that retrieves text from the
&gt; web.  The web scraper decodes the text properly but Perl stores the
&gt; data internally in ISO-8859-1.  When writing text that contains
&gt; umlaut characters to the database I get the following error message:
&gt; 
&gt; DBIx::Class::Storage::DBI::_dbh_execute&#40;&#41;: DBI Exception:
&gt; DBD::mysql::st execute failed: Duplicate entry &#39;Der Hobbit 2 -
&gt; Smaugs Ein&#39; for key &#39;PRIMARY&#39; [for Statement &#34;INSERT INTO film &#40;
&gt; title&#41; VALUES &#40; ? &#41;&#34; with ParamValues: 0=&#39;Der Hobbit 2 - Smaugs Ein
&gt; de &#40;3D&#41;&#39;] at lib/MyApp/CinemaListings/Cinema.pm line 40
&gt; 
&gt; perlunifaq says that &#34;the internal format is either ISO-8859-1
&gt; &#40;latin-1&#41;, or utf8, depending on the history of the string&#34;.
</div>
Unfortunately this doc is misleading &#40;while technically correct&#41;. Read on for more info.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Accordings to DBIx::Class::UTF8Column &#34;a bug was found deep in the
&gt; core of DBIx::Class which affects any component attempting to
&gt; perform encoding/decoding by overloading store_column and
&gt; get_columns. As a result of this problem create sends the original
&gt; column values to the database, while update sends the encoded
&gt; values.&#34;
&gt; 
</div>
This is also technically correct, however note that overloading store_column is something no other module in the wild does &#40;for the very same reason the doc was written&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It seems that DBIx::Class uses the utf8 encoded text to check 
&gt; whether the record exists but subsequently creates the record with
&gt; Perl&#39;s internal string representation, which might be ISO-8859-1.
</div>
In the case of vanilla DBIC this is not possible. You can crank up DBI_TRACE=2 to see the exact values the DBIC-&gt;DBI-&gt;DBD::mysql chain sends to your RDBMS. In fact I would like to see the output of that myself so we can figure out what is happening.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; BTW, I double checked that the web scraper decodes the text properly 
&gt; and doesn&#39;t return binary strings.  Actually, realizing that Perl
&gt; stores the text internally in ISO-8859-1 took most of the time when
&gt; debugging this problem.  My test suite reads its test data from 
&gt; files instead of the web.  When reading from files Perl stores the
&gt; text internally in utf8, i.e. everything is fine when the test suite
&gt; is run.  The error occurs only in production when the text is
&gt; retrieved from the web and internally stored in ISO-8859-1 by Perl.
</div>
Again - how the text is stored is not very relevant. How DBD::mysql interacts with strings based on its &#34;describecolumn&#34; intenral interface is what the culprit is. Again - will need to see that DBI_TRACE.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; Only after reading DBIx::Class::UTF8Columns
</div>&gt; &gt; 
&gt; &gt; This module is to never be used in new code, as per the stern
&gt; &gt; warning in its documentation.
</div>&gt; 
&gt; I do not use DBIx::Class::UTF8Columns.  That&#39;s why I didn&#39;t read
&gt; DBIx::Class::UTF8Columns at first.
&gt; 
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; I realized that there&#39;s a long standing bug in DBIx::Class and
&gt; &gt; &gt; that I have to force Perl to represent the text internally in
&gt; &gt; &gt; UTF-8 as create&#40;&#41; will treat the text as a byte sequence. I now
&gt; &gt; &gt; call decode_utf8&#40;encode_utf8&#40;$text&#41;&#41; in order to ensure that the
&gt; &gt; &gt; UTF-8 flag is set.
</div>&gt; &gt; 
&gt; &gt; This is most definitely very very wrong. Please do get back with
&gt; &gt; more info about your original problem - you are papering over the
&gt; &gt; issue with this erroneous decode_utf8&#40;&#41; call.
</div>&gt; 
&gt; This call is fine; it forces Perl to represent the given text in
&gt; utf8 internally.  encode_utf8&#40;&#41; converts the text, which might
&gt; internally be stored in ISO-8859-1, into a binary string.
&gt; decode_utf8&#40;&#41; converts the binary string back into text, which is
&gt; now internally stored in utf8.
</div>
Once again the &#34;internal storage&#34; part is not something that can affect you. The way DBD::mysql behaves does. Consider the output of this oneliner:

perl -MDevel::Peek -MEncode=encode_utf8,decode_utf8 -e &#39;my $str = &#34;foo&#34;; warn &#34;\nPlain ascii string\n&#34;; Dump $str; $str = encode_utf8&#40;$str&#41;; warn &#34;\nString encoded\n&#34;; Dump $str; $str = decode_utf8&#40;$str&#41;; warn &#34;\nString decoded\n&#34;; Dump $str&#39;

 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; [...] I will keep this ticket open for some time, pending a reply
&gt; &gt; from you so we can diagnose the *real* issue you encountered.
</div>&gt; 
&gt; The real issue is that the bug described in DBIx::Class::UTF8Columns
&gt; not only affects programs that use DBIx::Class::UTF8Columns
&gt; or DBIx::Class::ForceUTF8 but any program unless all text that is
&gt; written to Unicode-aware databases is internally stored in utf8.
</div>
The bug described in UTF8Columns has *nothing* to do with unicode or anything of that sort. It has to do just and only with the case of a DBIC component overriding store_column, and expecting it to be called on both update and insert at equal points. *This* is what the text is about, nothing else &#40;I happen to be the person who wrote it ;&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1305797" href="/Public/Bug/Display.html?id=90744#txn-1305797">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;27&nbsp;07:11:56&nbsp;2013</span>
    <span class="description">andreas [...] andreasvoegele.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andreas [...] andreasvoegele.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305797/691929/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/691929">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 996b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 27 04:32:12 2013, RIBASUSHI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Dec 27 03:35:32 2013, andreas@andreasvoegele.com wrote:
<div class="message-stanza open">&gt; &gt; It seems that DBIx::Class uses the utf8 encoded text to check
&gt; &gt; whether the record exists but subsequently creates the record
&gt; &gt; with Perl&#39;s internal string representation, which might be
&gt; &gt; ISO-8859-1.
</div>&gt; 
&gt; In the case of vanilla DBIC this is not possible. You can crank up
&gt; DBI_TRACE=2 to see the exact values the DBIC-&gt;DBI-&gt;DBD::mysql
&gt; chain sends to your RDBMS. In fact I would like to see the output
&gt; of that myself so we can figure out what is happening.
</div>
I&#39;ve attached two example Perl scripts and their output.  One script
is encoded in UTF-8 and the other one in ISO-8859-1.  Both scripts
insert the text &#34;Grüß Gott&#34; into a table.  

MySQL and MariaDB cut strings that contain invalid characters.
Thus, the ISO-8859-1 version of the script only inserts the text 
&#34;Gr&#34;.

I see differences in the scripts&#39; output when I search for 
&#34;bind_param for DBD::mysql::st&#34;.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test-dbix-class-utf8.output</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305797/691930/test-dbix-class-utf8.output">Download test-dbix-class-utf8.output</a><br />
<span class="downloadcontenttype">application/octet-stream 9.2k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test-dbix-class-utf8.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305797/691931/test-dbix-class-utf8.pl">Download test-dbix-class-utf8.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl

# mysql -h localhost -u root -p
# CREATE DATABASE greetings CHARACTER SET utf8;
# CREATE USER &#39;greetings&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;Cahphah3&#39;;
# GRANT INSERT,SELECT,UPDATE,DELETE ON greetings.* to &#39;greetings&#39;@&#39;localhost&#39;;
# USE greetings;
# CREATE TABLE greetings &#40;text varchar&#40;255&#41; PRIMARY KEY&#41;;
#
# Settings in /etc/my.cnf:
#
# [client]
# default-character-set = utf8
#
# [server]
# collation-server = utf8_unicode_ci
# init-connect=&#39;SET NAMES utf8&#39;
# character-set-server = utf8

use strict;
use warnings;

use utf8;

my $greeting = &#39;GrÃ¼Ã Gott&#39;;

my $dsn      = &#39;DBI:mysql:database=greetings;host=localhost&#39;;
my $user     = &#39;greetings&#39;;
my $pw       = &#39;Cahphah3&#39;;
my $args     = { mysql_enable_utf8 =&gt; 1 };

package Greetings::Schema::Result::Greetings;

use parent qw&#40;DBIx::Class::Core&#41;;

__PACKAGE__-&gt;table&#40;&#39;greetings&#39;&#41;;

__PACKAGE__-&gt;add_columns&#40; &#39;text&#39; =&gt; { data_type =&gt; &#39;varchar&#39;, size =&gt; 255 },
&#41;;

__PACKAGE__-&gt;set_primary_key&#40;&#39;text&#39;&#41;;

package Greetings::Schema;

use parent qw&#40;DBIx::Class::Schema&#41;;

__PACKAGE__-&gt;register_class&#40; &#39;Greetings&#39;,
    &#39;Greetings::Schema::Result::Greetings&#39; &#41;;

package main;

my $schema = Greetings::Schema-&gt;connect&#40; $dsn, $user, $pw, $args &#41;;

for &#40; 1 .. 2 &#41; {
    $schema-&gt;resultset&#40;&#39;Greetings&#39;&#41;-&gt;find_or_create&#40; { text =&gt; $greeting } &#41;;
}
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test-dbix-class-latin1.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305797/691932/test-dbix-class-latin1.pl">Download test-dbix-class-latin1.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl

# mysql -h localhost -u root -p
# CREATE DATABASE greetings CHARACTER SET utf8;
# CREATE USER &#39;greetings&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;Cahphah3&#39;;
# GRANT INSERT,SELECT,UPDATE,DELETE ON greetings.* to &#39;greetings&#39;@&#39;localhost&#39;;
# USE greetings;
# CREATE TABLE greetings &#40;text varchar&#40;255&#41; PRIMARY KEY&#41;;
#
# Settings in /etc/my.cnf:
#
# [client]
# default-character-set = utf8
#
# [server]
# collation-server = utf8_unicode_ci
# init-connect=&#39;SET NAMES utf8&#39;
# character-set-server = utf8

use strict;
use warnings;

my $greeting = &#39;Grüß Gott&#39;;

my $dsn      = &#39;DBI:mysql:database=greetings;host=localhost&#39;;
my $user     = &#39;greetings&#39;;
my $pw       = &#39;Cahphah3&#39;;
my $args     = { mysql_enable_utf8 =&gt; 1 };

package Greetings::Schema::Result::Greetings;

use parent qw&#40;DBIx::Class::Core&#41;;

__PACKAGE__-&gt;table&#40;&#39;greetings&#39;&#41;;

__PACKAGE__-&gt;add_columns&#40; &#39;text&#39; =&gt; { data_type =&gt; &#39;varchar&#39;, size =&gt; 255 },
&#41;;

__PACKAGE__-&gt;set_primary_key&#40;&#39;text&#39;&#41;;

package Greetings::Schema;

use parent qw&#40;DBIx::Class::Schema&#41;;

__PACKAGE__-&gt;register_class&#40; &#39;Greetings&#39;,
    &#39;Greetings::Schema::Result::Greetings&#39; &#41;;

package main;

my $schema = Greetings::Schema-&gt;connect&#40; $dsn, $user, $pw, $args &#41;;

for &#40; 1 .. 2 &#41; {
    $schema-&gt;resultset&#40;&#39;Greetings&#39;&#41;-&gt;find_or_create&#40; { text =&gt; $greeting } &#41;;
}
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test-dbix-class-latin1.output</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305797/691933/test-dbix-class-latin1.output">Download test-dbix-class-latin1.output</a><br />
<span class="downloadcontenttype">application/octet-stream 14.7k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1305854" href="/Public/Bug/Display.html?id=90744#txn-1305854">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;27&nbsp;12:33:23&nbsp;2013</span>
    <span class="description">ribasushi [...] leporine.io -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #90744] Be more clear about the UTF8 flag</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 27 Dec 2013 17:33:07 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Andreas Voegele via RT &lt;bug-DBIx-Class [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Peter Rabbitson &lt;ribasushi [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305854/691975/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/691975">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Dec 27, 2013 at 07:11:59AM -0500, Andreas Voegele via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: DBIx-Class
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=90744">https://rt.cpan.org/Ticket/Display.html?id=90744</a></span> &gt;
&gt; 
&gt; On Fri Dec 27 04:32:12 2013, RIBASUSHI wrote:
<div class="message-stanza open">&gt; &gt; On Fri Dec 27 03:35:32 2013, andreas@andreasvoegele.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; It seems that DBIx::Class uses the utf8 encoded text to check
&gt; &gt; &gt; whether the record exists but subsequently creates the record
&gt; &gt; &gt; with Perl&#39;s internal string representation, which might be
&gt; &gt; &gt; ISO-8859-1.
</div>&gt; &gt; 
&gt; &gt; In the case of vanilla DBIC this is not possible. You can crank up
&gt; &gt; DBI_TRACE=2 to see the exact values the DBIC-&gt;DBI-&gt;DBD::mysql
&gt; &gt; chain sends to your RDBMS. In fact I would like to see the output
&gt; &gt; of that myself so we can figure out what is happening.
</div>&gt; 
&gt; I&#39;ve attached two example Perl scripts and their output.  One script
&gt; is encoded in UTF-8 and the other one in ISO-8859-1.  Both scripts
&gt; insert the text &#34;Grüß Gott&#34; into a table.  
&gt; 
&gt; MySQL and MariaDB cut strings that contain invalid characters.
&gt; Thus, the ISO-8859-1 version of the script only inserts the text 
&gt; &#34;Gr&#34;.
</div>
Aha, so I hope you see now that this is not a DBIC issue, and in fact 
this isn&#39;t a DBD issue either &#40;DBD::mysql behaves quite properly&#41;. 
Attached is a script which demonstrates your problem much more 
concisely, and shows how to prevent the problem from occuring silently.

Also note that DBIC could help you with that via the shortcut:
<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/DBIx::Class::Storage::DBI::mysql#set_strict_mode">https://metacpan.org/pod/DBIx::Class::Storage::DBI::mysql#set_strict_mode</a></span>

I am closing this ticket since the entire chain behaves just as 
expected, you simply didn&#39;t do the equivalent of perl&#39;s &#34;use strict&#34;.

Feel free to continue the discussion if you have remaining 
questions/concerns.

Cheers
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1305854/691976/mysql_unilatin_insert.t">Download mysql_unilatin_insert.t</a><br />
<span class="downloadcontenttype">text/x-perl 975b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1305857" href="/Public/Bug/Display.html?id=90744#txn-1305857">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;27&nbsp;12:34:54&nbsp;2013</span>
    <span class="description">ribasushi [...] leporine.io -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.557534</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
