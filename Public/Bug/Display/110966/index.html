<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #110966 for Email-Send-SMTP-Gmail: Strange behavior with multiple files attachment</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #110966 for Email-Send-SMTP-Gmail: Strange behavior with multiple files attachment</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Email-Send-SMTP-Gmail">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Email-Send-SMTP-Gmail">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Email-Send-SMTP-Gmail">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Email-Send-SMTP-Gmail">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Email-Send-SMTP-Gmail">Email-Send-SMTP-Gmail CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">110966</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Email-Send-SMTP-Gmail">Email-Send-SMTP-Gmail</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
email [...] gaetanlord.ca

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-236026-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-236027-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.01    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=110966">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1581121" href="/Public/Bug/Display.html?id=110966#txn-1581121">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;06&nbsp;22:06:31&nbsp;2016</span>
    <span class="description">email [...] gaetanlord.ca -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Strange behavior with multiple files attachment</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 6 Jan 2016 22:05:47 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gaetan Lord &lt;email [...] gaetanlord.ca&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1581121/844658/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/844658">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi

Not sure if this is part of the multipart email protocol but I experience
an issue that need at least some clarification.

I have a perl script producing pdf files &#40;4&#41;, and I
use Email::Send::SMTP::Gmail attachment to send them in a single email.

Perl version 5.20.2
Email::Send::SMTP::Gmail Version 0.99

When I send the files to a gmail account, everything looks good and I see
only 4 pdf files attachment
But some of the recipients are not using gmail or yahoo. They get their
email from providers, and thier email contain other attachement files.
Those are actually empty files, with a mime type of text/plain. Look like
gmail is striping empty file attachment.

I try both way to send attachement and they both behave the same

Is there any way to remove those plain text files, because some recipient
can&#39;t see the PDF files, the plain text file seem to interact with the pdf
output.

Thank for any help


This is the list of attachment the email get

     I     1 &lt;no description&gt;                                   [text/html,
7bit, utf-8, 3.5K]
     A     2 galmond_card_carte.pdf
[applica/pdf, base64, 631K]
     I     3 &lt;no description&gt;
[text/plain, 7bit, us-ascii, 0K]
     A     4 galmond_letter_lettre.pdf
 [applica/pdf, base64, 84K]
     I     5 &lt;no description&gt;
[text/plain, 7bit, us-ascii, 0K]
     A     6 galmond_business_card.pdf
 [applica/pdf, base64, 72K]
     I     7 &lt;no description&gt;
[text/plain, 7bit, us-ascii, 0K]
     A     8 galmond_carte_affaire.pdf
 [applica/pdf, base64, 72K]
     I     9 &lt;no description&gt;
[text/plain, 7bit, us-ascii, 0K]


This is the content of the email where you could see the text/plain section
of the multipart email

11613
NGVkYmJjNWVjYzRjNDNkPiA8ZGM2NTQ5NTExYmFlNGViYzY2YmM2YWY1NmQ4YmYyYjQ2MDYxYjAw
11614
NjcxN2U2N2UyYzRlZGJiYzVlY2M0YzQzZD5dCj4+CnN0YXJ0eHJlZgo1NDUzNQolJUVPRgo=
11615
11616 --This-is-a-mail-boundary-8217539
11617 Content-Type: text/plain
11618
11619
11620 --This-is-a-mail-boundary-8217539--
11621




-- 
Gaetan Lord-&gt;
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1581121/844659/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/844659">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1581242" href="/Public/Bug/Display.html?id=110966#txn-1581242">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;04:59:09&nbsp;2016</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1581242/844730/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/844730">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 06 22:06:31 2016, email@gaetanlord.ca wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi
&gt; 
&gt; Not sure if this is part of the multipart email protocol but I experience
&gt; an issue that need at least some clarification.
&gt; 
&gt; I have a perl script producing pdf files &#40;4&#41;, and I
&gt; use Email::Send::SMTP::Gmail attachment to send them in a single email.
&gt; 
&gt; Perl version 5.20.2
&gt; Email::Send::SMTP::Gmail Version 0.99
&gt; 
&gt; When I send the files to a gmail account, everything looks good and I see
&gt; only 4 pdf files attachment
&gt; But some of the recipients are not using gmail or yahoo. They get their
&gt; email from providers, and thier email contain other attachement files.
&gt; Those are actually empty files, with a mime type of text/plain. Look like
&gt; gmail is striping empty file attachment.
&gt; 
&gt; I try both way to send attachement and they both behave the same
&gt; 
&gt; Is there any way to remove those plain text files, because some recipient
&gt; can&#39;t see the PDF files, the plain text file seem to interact with the pdf
&gt; output.
&gt; 
&gt; Thank for any help
&gt; 
&gt; 
&gt; This is the list of attachment the email get
&gt; 
&gt;      I     1 &lt;no description&gt;                                   [text/html,
&gt; 7bit, utf-8, 3.5K]
&gt;      A     2 galmond_card_carte.pdf
&gt; [applica/pdf, base64, 631K]
&gt;      I     3 &lt;no description&gt;
&gt; [text/plain, 7bit, us-ascii, 0K]
&gt;      A     4 galmond_letter_lettre.pdf
&gt;  [applica/pdf, base64, 84K]
&gt;      I     5 &lt;no description&gt;
&gt; [text/plain, 7bit, us-ascii, 0K]
&gt;      A     6 galmond_business_card.pdf
&gt;  [applica/pdf, base64, 72K]
&gt;      I     7 &lt;no description&gt;
&gt; [text/plain, 7bit, us-ascii, 0K]
&gt;      A     8 galmond_carte_affaire.pdf
&gt;  [applica/pdf, base64, 72K]
&gt;      I     9 &lt;no description&gt;
&gt; [text/plain, 7bit, us-ascii, 0K]
&gt; 
&gt; 
&gt; This is the content of the email where you could see the text/plain section
&gt; of the multipart email
&gt; 
&gt; 11613
&gt; NGVkYmJjNWVjYzRjNDNkPiA8ZGM2NTQ5NTExYmFlNGViYzY2YmM2YWY1NmQ4YmYyYjQ2MDYxYjAw
&gt; 11614
&gt; NjcxN2U2N2UyYzRlZGJiYzVlY2M0YzQzZD5dCj4+CnN0YXJ0eHJlZgo1NDUzNQolJUVPRgo=
&gt; 11615
&gt; 11616 --This-is-a-mail-boundary-8217539
&gt; 11617 Content-Type: text/plain
&gt; 11618
&gt; 11619
&gt; 11620 --This-is-a-mail-boundary-8217539--
&gt; 11621
&gt; 
&gt; 
&gt; 
&gt; 
</div>
Hello,

Thank you for this bug-report.

Please, let me know how you&#39;re handling the attachment arguments? Hashref &#40;-attachmentlist&#41; or a list separated by commas &#40;-attachments&#41;?

If it&#39;s possible, try to use -attachmentlist to check if the error persists.

my $att;
$att-&gt;[0]-&gt;{file}=&#39;/full_path/file.pdf&#39;;
$att-&gt;[1]-&gt;{file}=&#39;/full_path/file1.pdf&#39;;

$mail-&gt;send&#40;-to=&gt;&#39;target@xxx.com&#39;, -subject=&gt;&#39;Hello!&#39;,
            -body=&gt;&#39;Just testing it&lt;br&gt;Bye!&#39;,
            -contenttype=&gt;&#39;text/html&#39;,
            -attachmentlist=&gt;$att&#41;;
$mail-&gt;bye;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1581243" href="/Public/Bug/Display.html?id=110966#txn-1581243">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;04:59:09&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1581316" href="/Public/Bug/Display.html?id=110966#txn-1581316">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;09:43:38&nbsp;2016</span>
    <span class="description">email [...] gaetanlord.ca -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #110966] Strange behavior with multiple files attachment</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 7 Jan 2016 09:42:53 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gaetan Lord &lt;email [...] gaetanlord.ca&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1581316/844762/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/844762">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Juan

Thank for the reply

As I mention I tried both possible way to do it.
I include the relevant piece of code

Commented line 512 and 538 are the initial way I did it,


 512     #my $attachment =
&#34;Card/$Data{&#39;username&#39;}_card_carte.pdf,Letter/$Data{&#39;username&#39;}_letter_lettre.pdf,BusinessCard/$Data{&#39;username&#39;}_business_card.pdf,BusinessCard/$Data{&#39;username&#39;}_carte_affaire.pdf&#34;;

 513     my $attachment;
 514     $attachment-&gt;[0]-&gt;{file} = &#34;Card/$Data{&#39;username&#39;}_card_carte.pdf&#34;;
 515     $attachment-&gt;[1]-&gt;{file} =
&#34;Letter/$Data{&#39;username&#39;}_letter_lettre.pdf&#34;;
 516     $attachment-&gt;[2]-&gt;{file} =
&#34;BusinessCard/$Data{&#39;username&#39;}_business_card.pdf&#34;;
 517     $attachment-&gt;[3]-&gt;{file} =
&#34;BusinessCard/$Data{&#39;username&#39;}_carte_affaire.pdf&#34;;
 518
 519
 520     my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
 521         -smtp  =&gt; &#39;smtp.gmail.com&#39;,
 522         -login =&gt; &#39;office@###&#39;,
 523         -debug =&gt; 0,
 524         -layer =&gt; &#39;ssl&#39;,
 525         -pass  =&gt; &#39;###&#39;
 526     &#41;;
 527
 528     my $RC = $mail-&gt;send&#40;
 529         -to          =&gt; &#34;$to&#34;,
 530         -subject     =&gt; &#34;$subject&#34;,
 531         -verbose     =&gt; &#39;0&#39;,
 532         -charset     =&gt; &#39;utf-8&#39;,
 533         -contenttype =&gt; &#39;text/html&#39;,
 534         -body        =&gt; $message,
 535         -attachmentlist=&gt; $attachment
 536     &#41; if !$DontSendEmail;
 537
 538         #-attachments =&gt; $attachment,
 539
 540
 541     $mail-&gt;bye;






On Thu, Jan 7, 2016 at 4:59 AM, Juan Jose San Martin via RT &lt;
bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=110966">https://rt.cpan.org/Ticket/Display.html?id=110966</a></span> &gt;
&gt;
&gt; On Wed Jan 06 22:06:31 2016, email@gaetanlord.ca wrote:
<div class="message-stanza open">&gt; &gt; Hi
&gt; &gt;
&gt; &gt; Not sure if this is part of the multipart email protocol but I experience
&gt; &gt; an issue that need at least some clarification.
&gt; &gt;
&gt; &gt; I have a perl script producing pdf files &#40;4&#41;, and I
&gt; &gt; use Email::Send::SMTP::Gmail attachment to send them in a single email.
&gt; &gt;
&gt; &gt; Perl version 5.20.2
&gt; &gt; Email::Send::SMTP::Gmail Version 0.99
&gt; &gt;
&gt; &gt; When I send the files to a gmail account, everything looks good and I see
&gt; &gt; only 4 pdf files attachment
&gt; &gt; But some of the recipients are not using gmail or yahoo. They get their
&gt; &gt; email from providers, and thier email contain other attachement files.
&gt; &gt; Those are actually empty files, with a mime type of text/plain. Look like
&gt; &gt; gmail is striping empty file attachment.
&gt; &gt;
&gt; &gt; I try both way to send attachement and they both behave the same
&gt; &gt;
&gt; &gt; Is there any way to remove those plain text files, because some recipient
&gt; &gt; can&#39;t see the PDF files, the plain text file seem to interact with the
</div>&gt; pdf
<div class="message-stanza open">&gt; &gt; output.
&gt; &gt;
&gt; &gt; Thank for any help
&gt; &gt;
&gt; &gt;
&gt; &gt; This is the list of attachment the email get
&gt; &gt;
&gt; &gt;      I     1 &lt;no description&gt;
</div>&gt;  [text/html,
<div class="message-stanza open">&gt; &gt; 7bit, utf-8, 3.5K]
&gt; &gt;      A     2 galmond_card_carte.pdf
&gt; &gt; [applica/pdf, base64, 631K]
&gt; &gt;      I     3 &lt;no description&gt;
&gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt;      A     4 galmond_letter_lettre.pdf
&gt; &gt;  [applica/pdf, base64, 84K]
&gt; &gt;      I     5 &lt;no description&gt;
&gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt;      A     6 galmond_business_card.pdf
&gt; &gt;  [applica/pdf, base64, 72K]
&gt; &gt;      I     7 &lt;no description&gt;
&gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt;      A     8 galmond_carte_affaire.pdf
&gt; &gt;  [applica/pdf, base64, 72K]
&gt; &gt;      I     9 &lt;no description&gt;
&gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt;
&gt; &gt;
&gt; &gt; This is the content of the email where you could see the text/plain
</div>&gt; section
<div class="message-stanza open">&gt; &gt; of the multipart email
&gt; &gt;
&gt; &gt; 11613
&gt; &gt;
</div>&gt; NGVkYmJjNWVjYzRjNDNkPiA8ZGM2NTQ5NTExYmFlNGViYzY2YmM2YWY1NmQ4YmYyYjQ2MDYxYjAw
<div class="message-stanza open">&gt; &gt; 11614
&gt; &gt; NjcxN2U2N2UyYzRlZGJiYzVlY2M0YzQzZD5dCj4+CnN0YXJ0eHJlZgo1NDUzNQolJUVPRgo=
&gt; &gt; 11615
&gt; &gt; 11616 --This-is-a-mail-boundary-8217539
&gt; &gt; 11617 Content-Type: text/plain
&gt; &gt; 11618
&gt; &gt; 11619
&gt; &gt; 11620 --This-is-a-mail-boundary-8217539--
&gt; &gt; 11621
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt; Hello,
&gt;
&gt; Thank you for this bug-report.
&gt;
&gt; Please, let me know how you&#39;re handling the attachment arguments? Hashref
&gt; &#40;-attachmentlist&#41; or a list separated by commas &#40;-attachments&#41;?
&gt;
&gt; If it&#39;s possible, try to use -attachmentlist to check if the error
&gt; persists.
&gt;
&gt; my $att;
&gt; $att-&gt;[0]-&gt;{file}=&#39;/full_path/file.pdf&#39;;
&gt; $att-&gt;[1]-&gt;{file}=&#39;/full_path/file1.pdf&#39;;
&gt;
&gt; $mail-&gt;send&#40;-to=&gt;&#39;target@xxx.com&#39;, -subject=&gt;&#39;Hello!&#39;,
&gt;             -body=&gt;&#39;Just testing it&lt;br&gt;Bye!&#39;,
&gt;             -contenttype=&gt;&#39;text/html&#39;,
&gt;             -attachmentlist=&gt;$att&#41;;
&gt; $mail-&gt;bye;
&gt;
&gt;
&gt;
&gt;
</div>

-- 
Gaetan Lord
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1581316/844763/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/844763">with headers</a>
<br />
<span class="downloadcontenttype">text/html 6.4k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1610874" href="/Public/Bug/Display.html?id=110966#txn-1610874">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;06:14:06&nbsp;2016</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1610874/861875/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/861875">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for your reporting

New release 1.01 should fix this issue.


On Thu Jan 07 09:43:38 2016, email@gaetanlord.ca wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Juan
&gt; 
&gt; Thank for the reply
&gt; 
&gt; As I mention I tried both possible way to do it.
&gt; I include the relevant piece of code
&gt; 
&gt; Commented line 512 and 538 are the initial way I did it,
&gt; 
&gt; 
&gt; 512     #my $attachment =
&gt; &#34;Card/$Data{&#39;username&#39;}_card_carte.pdf,Letter/$Data{&#39;username&#39;}_letter_lettre.pdf,BusinessCard/$Data{&#39;username&#39;}_business_card.pdf,BusinessCard/$Data{&#39;username&#39;}_carte_affaire.pdf&#34;;
&gt; 
&gt; 513     my $attachment;
&gt; 514     $attachment-&gt;[0]-&gt;{file} =
&gt; &#34;Card/$Data{&#39;username&#39;}_card_carte.pdf&#34;;
&gt; 515     $attachment-&gt;[1]-&gt;{file} =
&gt; &#34;Letter/$Data{&#39;username&#39;}_letter_lettre.pdf&#34;;
&gt; 516     $attachment-&gt;[2]-&gt;{file} =
&gt; &#34;BusinessCard/$Data{&#39;username&#39;}_business_card.pdf&#34;;
&gt; 517     $attachment-&gt;[3]-&gt;{file} =
&gt; &#34;BusinessCard/$Data{&#39;username&#39;}_carte_affaire.pdf&#34;;
&gt; 518
&gt; 519
&gt; 520     my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt; 521         -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt; 522         -login =&gt; &#39;office@###&#39;,
&gt; 523         -debug =&gt; 0,
&gt; 524         -layer =&gt; &#39;ssl&#39;,
&gt; 525         -pass  =&gt; &#39;###&#39;
&gt; 526     &#41;;
&gt; 527
&gt; 528     my $RC = $mail-&gt;send&#40;
&gt; 529         -to          =&gt; &#34;$to&#34;,
&gt; 530         -subject     =&gt; &#34;$subject&#34;,
&gt; 531         -verbose     =&gt; &#39;0&#39;,
&gt; 532         -charset     =&gt; &#39;utf-8&#39;,
&gt; 533         -contenttype =&gt; &#39;text/html&#39;,
&gt; 534         -body        =&gt; $message,
&gt; 535         -attachmentlist=&gt; $attachment
&gt; 536     &#41; if !$DontSendEmail;
&gt; 537
&gt; 538         #-attachments =&gt; $attachment,
&gt; 539
&gt; 540
&gt; 541     $mail-&gt;bye;
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; On Thu, Jan 7, 2016 at 4:59 AM, Juan Jose San Martin via RT &lt;
&gt; bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=110966">https://rt.cpan.org/Ticket/Display.html?id=110966</a></span> &gt;
&gt; &gt;
&gt; &gt; On Wed Jan 06 22:06:31 2016, email@gaetanlord.ca wrote:
<div class="message-stanza open">&gt; &gt; &gt; Hi
&gt; &gt; &gt;
&gt; &gt; &gt; Not sure if this is part of the multipart email protocol but I
&gt; &gt; &gt; experience
&gt; &gt; &gt; an issue that need at least some clarification.
&gt; &gt; &gt;
&gt; &gt; &gt; I have a perl script producing pdf files &#40;4&#41;, and I
&gt; &gt; &gt; use Email::Send::SMTP::Gmail attachment to send them in a single
&gt; &gt; &gt; email.
&gt; &gt; &gt;
&gt; &gt; &gt; Perl version 5.20.2
&gt; &gt; &gt; Email::Send::SMTP::Gmail Version 0.99
&gt; &gt; &gt;
&gt; &gt; &gt; When I send the files to a gmail account, everything looks good and
&gt; &gt; &gt; I see
&gt; &gt; &gt; only 4 pdf files attachment
&gt; &gt; &gt; But some of the recipients are not using gmail or yahoo. They get
&gt; &gt; &gt; their
&gt; &gt; &gt; email from providers, and thier email contain other attachement
&gt; &gt; &gt; files.
&gt; &gt; &gt; Those are actually empty files, with a mime type of text/plain.
&gt; &gt; &gt; Look like
&gt; &gt; &gt; gmail is striping empty file attachment.
&gt; &gt; &gt;
&gt; &gt; &gt; I try both way to send attachement and they both behave the same
&gt; &gt; &gt;
&gt; &gt; &gt; Is there any way to remove those plain text files, because some
&gt; &gt; &gt; recipient
&gt; &gt; &gt; can&#39;t see the PDF files, the plain text file seem to interact with
&gt; &gt; &gt; the
</div>&gt; &gt; pdf
<div class="message-stanza open">&gt; &gt; &gt; output.
&gt; &gt; &gt;
&gt; &gt; &gt; Thank for any help
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; This is the list of attachment the email get
&gt; &gt; &gt;
&gt; &gt; &gt; I     1 &lt;no description&gt;
</div>&gt; &gt; [text/html,
<div class="message-stanza open">&gt; &gt; &gt; 7bit, utf-8, 3.5K]
&gt; &gt; &gt;      A     2 galmond_card_carte.pdf
&gt; &gt; &gt; [applica/pdf, base64, 631K]
&gt; &gt; &gt;      I     3 &lt;no description&gt;
&gt; &gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt; &gt;      A     4 galmond_letter_lettre.pdf
&gt; &gt; &gt;  [applica/pdf, base64, 84K]
&gt; &gt; &gt;      I     5 &lt;no description&gt;
&gt; &gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt; &gt;      A     6 galmond_business_card.pdf
&gt; &gt; &gt;  [applica/pdf, base64, 72K]
&gt; &gt; &gt;      I     7 &lt;no description&gt;
&gt; &gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt; &gt;      A     8 galmond_carte_affaire.pdf
&gt; &gt; &gt;  [applica/pdf, base64, 72K]
&gt; &gt; &gt;      I     9 &lt;no description&gt;
&gt; &gt; &gt; [text/plain, 7bit, us-ascii, 0K]
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; This is the content of the email where you could see the text/plain
</div>&gt; &gt; section
<div class="message-stanza open">&gt; &gt; &gt; of the multipart email
&gt; &gt; &gt;
&gt; &gt; &gt; 11613
&gt; &gt; &gt;
</div>&gt; &gt; NGVkYmJjNWVjYzRjNDNkPiA8ZGM2NTQ5NTExYmFlNGViYzY2YmM2YWY1NmQ4YmYyYjQ2MDYxYjAw
<div class="message-stanza open">&gt; &gt; &gt; 11614
&gt; &gt; &gt; NjcxN2U2N2UyYzRlZGJiYzVlY2M0YzQzZD5dCj4+CnN0YXJ0eHJlZgo1NDUzNQolJUVPRgo=
&gt; &gt; &gt; 11615
&gt; &gt; &gt; 11616 --This-is-a-mail-boundary-8217539
&gt; &gt; &gt; 11617 Content-Type: text/plain
&gt; &gt; &gt; 11618
&gt; &gt; &gt; 11619
&gt; &gt; &gt; 11620 --This-is-a-mail-boundary-8217539--
&gt; &gt; &gt; 11621
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
</div>&gt; &gt;
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; Thank you for this bug-report.
&gt; &gt;
&gt; &gt; Please, let me know how you&#39;re handling the attachment arguments?
&gt; &gt; Hashref
&gt; &gt; &#40;-attachmentlist&#41; or a list separated by commas &#40;-attachments&#41;?
&gt; &gt;
&gt; &gt; If it&#39;s possible, try to use -attachmentlist to check if the error
&gt; &gt; persists.
&gt; &gt;
&gt; &gt; my $att;
&gt; &gt; $att-&gt;[0]-&gt;{file}=&#39;/full_path/file.pdf&#39;;
&gt; &gt; $att-&gt;[1]-&gt;{file}=&#39;/full_path/file1.pdf&#39;;
&gt; &gt;
&gt; &gt; $mail-&gt;send&#40;-to=&gt;&#39;target@xxx.com&#39;, -subject=&gt;&#39;Hello!&#39;,
&gt; &gt;             -body=&gt;&#39;Just testing it&lt;br&gt;Bye!&#39;,
&gt; &gt;             -contenttype=&gt;&#39;text/html&#39;,
&gt; &gt;             -attachmentlist=&gt;$att&#41;;
&gt; &gt; $mail-&gt;bye;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1610876" href="/Public/Bug/Display.html?id=110966#txn-1610876">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;06:14:15&nbsp;2016</span>
    <span class="description">PECO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1702325" href="/Public/Bug/Display.html?id=110966#txn-1702325">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;02&nbsp;05:13:08&nbsp;2017</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1702325/914314/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/914314">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 8b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Resolved
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1702327" href="/Public/Bug/Display.html?id=110966#txn-1702327">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;02&nbsp;05:13:08&nbsp;2017</span>
    <span class="description">PECO [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1702329" href="/Public/Bug/Display.html?id=110966#txn-1702329">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;02&nbsp;05:13:09&nbsp;2017</span>
    <span class="description">PECO [...] cpan.org -  Fixed in 1.01 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.423745</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
