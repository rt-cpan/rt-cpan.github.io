<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76260 for Net-SAML2: Problem with simpleSAMLphp and signed response</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76260 for Net-SAML2: Problem with simpleSAMLphp and signed response</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Net-SAML2">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Net-SAML2">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Net-SAML2">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Net-SAML2">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-SAML2">Net-SAML2 CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76260</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Net-SAML2">Net-SAML2</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">TIMLEGGE [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dmborque [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-236562-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.17    </td>
  </tr>
  <tr id="CF-236563-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.20    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Sig.pm<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1058156/553624/Sig.pm">
Tue Apr 03 04:46:56 2012 (27.3k) by dmborque [...] gmail.com
</a>
</font></li>
</ul>


XMLresponse.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1058156/553623/XMLresponse.txt">
Tue Apr 03 04:46:56 2012 (6k) by dmborque [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=76260">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1058156" href="/Public/Bug/Display.html?id=76260#txn-1058156">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;03&nbsp;04:46:56&nbsp;2012</span>
    <span class="description">dmborque [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Problem with simpleSAMLphp and signed response</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1058156/553622/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/553622">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
I&#39;m working with a simpleSAMLphp as an IdP, and Net::SAML2 to integrate
an application as SP.
After some work I finally got a response by the IdP. The problem appears
when processing this response, at:

my $ret = $post-&gt;handle_response&#40;
    $saml_response
    &#41;;

Specifically I detected the problem is in the verify method of Sig.pm.
I had to modify several things in order to make it work:
- signature prefix is &#39;&lt;ds:&#39; not &lt;dsig:&#39;
- there are several signatures in the response, but Sig.pm assumes there
is only one... I had to modify the module in order to take into account
only the first &#40;outermost&#41; signature.

Now it works, but as I am completely new to XML programming the changes
I&#39;ve introduced are rather &#34;simple&#34; and probably don&#39;t cover other cases.

I attach the modified Sig.pm and an example of the header &#40;I removed
with attribute list&#41;.

Some more data:
- I&#39;m using Net::SAML2 0.17
- on the server:
Linux clippervm 2.6.32-220.2.1.el6.x86_64 #1 SMP Tue Dec 13 16:21:34 EST
2011 x86_64 x86_64 x86_64 GNU/Linux

- on perl:
This is perl, v5.10.1 &#40;*&#41; built for x86_64-linux-thread-multi

Copyright 1987-2009, Larry Wall

Perl may be copied only under the terms of either the Artistic License
or the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using &#34;man perl&#34; or &#34;perldoc perl&#34;.  If you have access to the
Internet, point your browser at <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perl.org/">http://www.perl.org/</a></span>, the Perl Home Page.

Hope this helps!

Greetings,
David
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> XMLresponse.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1058156/553623/XMLresponse.txt">Download XMLresponse.txt</a><br />
<span class="downloadcontenttype">text/plain 6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;samlp:Response xmlns:samlp=&#34;urn:oasis:names:tc:SAML:2.0:protocol&#34; xmlns:saml=&#34;urn:oasis:names:tc:SAML:2.0:assertion&#34; ID=&#34;pfxe1b094bb-da11-e825-33af-4be7b4dd0cd8&#34; Version=&#34;2.0&#34; IssueInstant=&#34;2012-03-21T09:34:49Z&#34; Destination=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="https://sp1.ucm.es:8080/cgi-bin/testSAML2_bind.pl">https://sp1.ucm.es:8080/cgi-bin/testSAML2_bind.pl</a></span>&#34; InResponseTo=&#34;8e860823847102d55b9e2078037b79df&#34;&gt;
  &lt;saml:Issuer&gt;<span class="clickylink"><a target="new" rel="nofollow" href="https://sso.ucm.es:8080/simplesaml/saml2/idp/metadata.php">https://sso.ucm.es:8080/simplesaml/saml2/idp/metadata.php</a></span>&lt;/saml:Issuer&gt;
  &lt;ds:Signature xmlns:ds=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#&#34;&gt;">http://www.w3.org/2000/09/xmldsig#&#34;&gt;</a></span>
    &lt;ds:SignedInfo&gt;
      &lt;ds:CanonicalizationMethod Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;">http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;</a></span>
      &lt;ds:SignatureMethod Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#rsa-sha1&#34;/&gt;">http://www.w3.org/2000/09/xmldsig#rsa-sha1&#34;/&gt;</a></span>
      &lt;ds:Reference URI=&#34;#pfxe1b094bb-da11-e825-33af-4be7b4dd0cd8&#34;&gt;
	&lt;ds:Transforms&gt;
	  &lt;ds:Transform Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#enveloped-signature&#34;/&gt;">http://www.w3.org/2000/09/xmldsig#enveloped-signature&#34;/&gt;</a></span>
	  &lt;ds:Transform Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;">http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;</a></span>
	&lt;/ds:Transforms&gt;
	&lt;ds:DigestMethod Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#sha1&#34;/&gt;">http://www.w3.org/2000/09/xmldsig#sha1&#34;/&gt;</a></span>
	&lt;ds:DigestValue&gt;fQ2BDjWLb7i85kQ/7PEvrIr4G24=&lt;/ds:DigestValue&gt;
      &lt;/ds:Reference&gt;
    &lt;/ds:SignedInfo&gt;
    &lt;ds:SignatureValue&gt;1M6Uw88pAgYD5kUaWZ+WPDxM7ZUE+JhmCGlkgaAvxBK9MO/G+PXQLMMpV4jQPaXjChfxUJczVhP8LbBs8pYozAe3nYeXrs7mrIiwOSu78TnXbJy8+jSndZgzUdqfHZbfunMCwCn+EKULpT6GU7PB5e7N2s08neUNYCglKUSnArQ=&lt;/ds:SignatureValue&gt;
    &lt;ds:KeyInfo&gt;
      &lt;ds:X509Data&gt;
	&lt;ds:X509Certificate&gt;MIICkDCCAfmgAwIBAgIBATANBgkqhkiG9w0BAQUFADBPMQswCQYDVQQGEwJFUzEPMA0GA1UECAwGTWFkcmlkMQ8wDQYDVQQHDAZNYWRyaWQxDDAKBgNVBAoMA1VDTTEQMA4GA1UECwwHU1NJSS1DQTAeFw0xMjAzMjAxNTMxMzZaFw0xMzAzMjAxNTMxMzZaMFAxCzAJBgNVBAYTAkVTMQ8wDQYDVQQIDAZNYWRyaWQxDDAKBgNVBAoMA1VDTTENMAsGA1UECwwEU1NJSTETMBEGA1UEAwwKc3NvLnVjbS5lczCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA1+w8+98SLJIrA9e99rZ7q/9JTP9Nk2DDaM6m3F2kYBy6npPbI94RzdYUbn9FtATgztlTfe9yE12Uc7roCuY3EKcrxcwdta1ZulRyn7ihUREIz0m4DAMzlswPbdEuj6jBbr0pU/sHQEDB7Rdb4KEfk0I+RI5qb3DayFpNCL24bEsCAwEAAaN7MHkwCQYDVR0TBAIwADAsBglghkgBhvhCAQ0EHxYdT3BlblNTTCBHZW5lcmF0ZWQgQ2VydGlmaWNhdGUwHQYDVR0OBBYEFK5zL442UO23oBNdGEpxefiamVbbMB8GA1UdIwQYMBaAFJSe7JIFgXldZYO9qt+5gblEr4HbMA0GCSqGSIb3DQEBBQUAA4GBAFUuJvclKPJFfmPtQH3cMu1rfdbxSRhGryltif/nqun57YiaNl72juRF51FZFqYFE4FKZjzuSQUi+xLS0Gu/xod4Eatpnj4hXnQeawx7LSzbrHW3/yUp2+/yhswEfED8IPMt09Do2g/hOF6iR5ibD+SRzbIyOb1WzPAkO3T6xCUm&lt;/ds:X509Certificate&gt;
      &lt;/ds:X509Data&gt;
    &lt;/ds:KeyInfo&gt;
  &lt;/ds:Signature&gt;
  &lt;samlp:Status&gt;
    &lt;samlp:StatusCode Value=&#34;urn:oasis:names:tc:SAML:2.0:status:Success&#34;/&gt;
  &lt;/samlp:Status&gt;
  &lt;saml:Assertion xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34; xmlns:xs=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; ID=&#34;pfx5138f471-3cd4-58bf-3625-6b2df40ef216&#34; Version=&#34;2.0&#34; IssueInstant=&#34;2012-03-21T09:34:49Z&#34;&gt;
    &lt;saml:Issuer&gt;<span class="clickylink"><a target="new" rel="nofollow" href="https://sso.ucm.es:8080/simplesaml/saml2/idp/metadata.php">https://sso.ucm.es:8080/simplesaml/saml2/idp/metadata.php</a></span>&lt;/saml:Issuer&gt;
    &lt;ds:Signature xmlns:ds=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#&#34;&gt;">http://www.w3.org/2000/09/xmldsig#&#34;&gt;</a></span>
      &lt;ds:SignedInfo&gt;
	&lt;ds:CanonicalizationMethod Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;">http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;</a></span>
	&lt;ds:SignatureMethod Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#rsa-sha1&#34;/&gt;">http://www.w3.org/2000/09/xmldsig#rsa-sha1&#34;/&gt;</a></span>
	&lt;ds:Reference URI=&#34;#pfx5138f471-3cd4-58bf-3625-6b2df40ef216&#34;&gt;
	  &lt;ds:Transforms&gt;
	    &lt;ds:Transform Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#enveloped-signature&#34;/&gt;">http://www.w3.org/2000/09/xmldsig#enveloped-signature&#34;/&gt;</a></span>
	    &lt;ds:Transform Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;">http://www.w3.org/2001/10/xml-exc-c14n#&#34;/&gt;</a></span>
	  &lt;/ds:Transforms&gt;
	  &lt;ds:DigestMethod Algorithm=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2000/09/xmldsig#sha1&#34;/&gt;">http://www.w3.org/2000/09/xmldsig#sha1&#34;/&gt;</a></span>
	  &lt;ds:DigestValue&gt;uV8jdTuNLFWNv3PEiNI6ECY1JWA=&lt;/ds:DigestValue&gt;
	&lt;/ds:Reference&gt;
      &lt;/ds:SignedInfo&gt;
      &lt;ds:SignatureValue&gt;hmYVoTjrvJlOh3UWRJRFr5lhLeM4gdG8oBLOu970LYiDrNi3Hx8RhRPgvkmI4l0f9MmNXb6RO5CGOAL7zPdFD9uJ14YWAw4k3kMJ5mUM3ZKWHtLQ6gZJPxD0ZW4XphKXIOHaoxE93VVZEFxhjgB4y5gJ+w3LApIBh55/M4YgyJc=&lt;/ds:SignatureValue&gt;
      &lt;ds:KeyInfo&gt;
	&lt;ds:X509Data&gt;
	  &lt;ds:X509Certificate&gt;MIICkDCCAfmgAwIBAgIBATANBgkqhkiG9w0BAQUFADBPMQswCQYDVQQGEwJFUzEPMA0GA1UECAwGTWFkcmlkMQ8wDQYDVQQHDAZNYWRyaWQxDDAKBgNVBAoMA1VDTTEQMA4GA1UECwwHU1NJSS1DQTAeFw0xMjAzMjAxNTMxMzZaFw0xMzAzMjAxNTMxMzZaMFAxCzAJBgNVBAYTAkVTMQ8wDQYDVQQIDAZNYWRyaWQxDDAKBgNVBAoMA1VDTTENMAsGA1UECwwEU1NJSTETMBEGA1UEAwwKc3NvLnVjbS5lczCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA1+w8+98SLJIrA9e99rZ7q/9JTP9Nk2DDaM6m3F2kYBy6npPbI94RzdYUbn9FtATgztlTfe9yE12Uc7roCuY3EKcrxcwdta1ZulRyn7ihUREIz0m4DAMzlswPbdEuj6jBbr0pU/sHQEDB7Rdb4KEfk0I+RI5qb3DayFpNCL24bEsCAwEAAaN7MHkwCQYDVR0TBAIwADAsBglghkgBhvhCAQ0EHxYdT3BlblNTTCBHZW5lcmF0ZWQgQ2VydGlmaWNhdGUwHQYDVR0OBBYEFK5zL442UO23oBNdGEpxefiamVbbMB8GA1UdIwQYMBaAFJSe7JIFgXldZYO9qt+5gblEr4HbMA0GCSqGSIb3DQEBBQUAA4GBAFUuJvclKPJFfmPtQH3cMu1rfdbxSRhGryltif/nqun57YiaNl72juRF51FZFqYFE4FKZjzuSQUi+xLS0Gu/xod4Eatpnj4hXnQeawx7LSzbrHW3/yUp2+/yhswEfED8IPMt09Do2g/hOF6iR5ibD+SRzbIyOb1WzPAkO3T6xCUm&lt;/ds:X509Certificate&gt;
	&lt;/ds:X509Data&gt;
      &lt;/ds:KeyInfo&gt;
    &lt;/ds:Signature&gt;
    &lt;saml:Subject&gt;
      &lt;saml:NameID SPNameQualifier=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="https://sp1.ucm.es:8080/cgi-bin/testSAML2.pl">https://sp1.ucm.es:8080/cgi-bin/testSAML2.pl</a></span>&#34; Format=&#34;urn:oasis:names:tc:SAML:2.0:nameid-format:transient&#34;&gt;_d8d9ab645849d24aeb9144c0c2f1c2fee3ad7087ab&lt;/saml:NameID&gt;
      &lt;saml:SubjectConfirmation Method=&#34;urn:oasis:names:tc:SAML:2.0:cm:bearer&#34;&gt;
	&lt;saml:SubjectConfirmationData NotOnOrAfter=&#34;2012-03-21T09:39:49Z&#34; Recipient=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="https://sp1.ucm.es:8080/cgi-bin/testSAML2_bind.pl">https://sp1.ucm.es:8080/cgi-bin/testSAML2_bind.pl</a></span>&#34; InResponseTo=&#34;8e860823847102d55b9e2078037b79df&#34;/&gt;
      &lt;/saml:SubjectConfirmation&gt;
    &lt;/saml:Subject&gt;
    &lt;saml:Conditions NotBefore=&#34;2012-03-21T09:34:19Z&#34; NotOnOrAfter=&#34;2012-03-21T09:39:49Z&#34;&gt;
      &lt;saml:AudienceRestriction&gt;
	&lt;saml:Audience&gt;<span class="clickylink"><a target="new" rel="nofollow" href="https://sp1.ucm.es:8080/cgi-bin/testSAML2.pl">https://sp1.ucm.es:8080/cgi-bin/testSAML2.pl</a></span>&lt;/saml:Audience&gt;
      &lt;/saml:AudienceRestriction&gt;
    &lt;/saml:Conditions&gt;
    &lt;saml:AuthnStatement AuthnInstant=&#34;2012-03-21T09:34:49Z&#34; SessionNotOnOrAfter=&#34;2012-03-21T17:34:49Z&#34; SessionIndex=&#34;_77c6a2594f557fecb537a3ff1295f2ef292213be77&#34;&gt;
      &lt;saml:AuthnContext&gt;
	&lt;saml:AuthnContextClassRef&gt;urn:oasis:names:tc:SAML:2.0:ac:classes:Password&lt;/saml:AuthnContextClassRef&gt;
      &lt;/saml:AuthnContext&gt;
    &lt;/saml:AuthnStatement&gt;
    &lt;saml:AttributeStatement&gt;
      &lt;saml:Attribute Name=&#34;ucmSyslogHome&#34; NameFormat=&#34;urn:oasis:names:tc:SAML:2.0:attrname-format:uri&#34;&gt;
	&lt;saml:AttributeValue xsi:type=&#34;xs:string&#34;&gt;pasito&lt;/saml:AttributeValue&gt;
      &lt;/saml:Attribute&gt;




....




    &lt;/saml:AttributeStatement&gt;
  &lt;/saml:Assertion&gt;
&lt;/samlp:Response&gt;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Sig.pm</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1058156/553624/Sig.pm">Download Sig.pm</a><br />
<span class="downloadcontenttype">text/x-perl 27.3k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1058705" href="/Public/Bug/Display.html?id=76260#txn-1058705">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;04&nbsp;07:48:27&nbsp;2012</span>
    <span class="description">CHRISA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1058705/554192/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/554192">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 727b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for this! 

I&#39;d happily merge the change to cope with multiple signatures but only verifying one if it improves compatibility with typical IdPs, while keeping 
the existing support working. 

One thing that ought to have worked though, is the existing use of the &#34;dsig&#34; prefix - the namespace prefix should be local to a document, and 
as long as the namespace URI matches, things should work. Are you able to verify that the change in prefix is definitely required? 

Also are you able to turn the sample assertions you&#39;ve provided here into a test for the multiple signature handling feature? 

The code is maintained here, if you&#39;re already using github:

  <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/chrisa/perl-Net-SAML2">https://github.com/chrisa/perl-Net-SAML2</a></span>



Thanks!

Chris.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1058707" href="/Public/Bug/Display.html?id=76260#txn-1058707">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;04&nbsp;07:48:29&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1108325" href="/Public/Bug/Display.html?id=76260#txn-1108325">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;12&nbsp;12:01:04&nbsp;2012</span>
    <span class="description">MARSCHAP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Problem with simpleSAMLphp and signed response -&gt; patch on github</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> CHRISA [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1108325/582722/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/582722">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1108329" href="/Public/Bug/Display.html?id=76260#txn-1108329">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;12&nbsp;12:04:49&nbsp;2012</span>
    <span class="description">MARSCHAP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1108329/582726/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/582726">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 458b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#40;sorry for the last reply: it was cut off too early&#41;
Hi Chris,
the following comming on my for of your upstream should provide the minimal 
delta without namespace changes:
  <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/marschap/perl-Net-">https://github.com/marschap/perl-Net-</a></span>
SAML2/commit/48fc1cbb80710639e9dc115ee8eaf7ec32e078c5
This commit is part of the pull request against your upstrem repo:
  <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/chrisa/perl-Net-SAML2/pull/3">https://github.com/chrisa/perl-Net-SAML2/pull/3</a></span>
It would be great if these fixed made it into Net::SAML2&#39;s upstream.
Peter
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1892841" href="/Public/Bug/Display.html?id=76260#txn-1892841">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;07&nbsp;20:20:24&nbsp;2020</span>
    <span class="description">TIMLEGGE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1892841/1015017/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1015017">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 214b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This was merged into <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/xmikew/perl-Net-SAML2/">https://github.com/xmikew/perl-Net-SAML2/</a></span> and my repo is a fork based on a fork of that tree so these changes are in <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/timlegge/perl-Net-SAML2/">https://github.com/timlegge/perl-Net-SAML2/</a></span> which will form the next release
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1892844" href="/Public/Bug/Display.html?id=76260#txn-1892844">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;07&nbsp;20:20:26&nbsp;2020</span>
    <span class="description">TIMLEGGE [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1892845" href="/Public/Bug/Display.html?id=76260#txn-1892845">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;07&nbsp;20:24:52&nbsp;2020</span>
    <span class="description">TIMLEGGE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1892845/1015020/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1015020">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 366b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Apr 07 20:20:24 2020, TIMLEGGE wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This was merged into <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/xmikew/perl-Net-SAML2/">https://github.com/xmikew/perl-Net-SAML2/</a></span> and my
&gt; repo is a fork based on a fork of that tree so these changes are in
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/timlegge/perl-Net-SAML2/">https://github.com/timlegge/perl-Net-SAML2/</a></span> which will form the next
&gt; release
</div>
Logged as 
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/timlegge/perl-Net-SAML2/issues/8">https://github.com/timlegge/perl-Net-SAML2/issues/8</a></span>

It is/will be in the next release
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1893483" href="/Public/Bug/Display.html?id=76260#txn-1893483">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;13&nbsp;22:28:52&nbsp;2020</span>
    <span class="description">TIMLEGGE [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1893485" href="/Public/Bug/Display.html?id=76260#txn-1893485">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;13&nbsp;22:28:53&nbsp;2020</span>
    <span class="description">TIMLEGGE [...] cpan.org -  Fixed in 0.20 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.562321</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
