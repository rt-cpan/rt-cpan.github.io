<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #96663 for Math-Vector-Real-kdTree: Issue with find_in_ball Routine</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #96663 for Math-Vector-Real-kdTree: Issue with find_in_ball Routine</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Math-Vector-Real-kdTree/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Math-Vector-Real-kdTree/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Math-Vector-Real-kdTree/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Math-Vector-Real-kdTree/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Math-Vector-Real-kdTree">Math-Vector-Real-kdTree CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">96663</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Math-Vector-Real-kdTree/Active/">Math-Vector-Real-kdTree</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
chad.iverson [...] quest-global.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-239092-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-239093-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;23&nbsp;18:39:48&nbsp;2014</span>
    <span class="description">chad.iverson [...] quest-global.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Issue with find_in_ball Routine</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 23 Jun 2014 22:39:29 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Math-Vector-Real-kdTree [...] rt.cpan.org&#34; &lt;bug-Math-Vector-Real-kdTree [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chad Iverson &lt;chad.iverson [...] quest-global.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

I just recently installed the kdTree module and I am having some trouble getting find_in_ball&#40;&#41; to report correctly.  I created a simple test-case which hopefully repeats the problem.  It is currently returning the 4-6 cases with the largest distance instead of all the ones within the sphere.  It correctly filters them out if I bring the $d below the 4 or 6 values that it returns, but it is not properly reporting all vectors within the specified radius &#40;$d&#41;, unless I&#39;m fundamentally misunderstanding what this method is supposed to do.  Here is the code for my test case:

#! /usr/bin/perl

use strict;
use warnings;

use Math::Vector::Real::kdTree;
use Math::Vector::Real;

my $dist = 2000;
my $chkpt = V&#40;0.25, 0.25, 0.25&#41;;
my @v = &#40;&#41;;
my $line = &#34;&#34;;
foreach &#40;0..1000&#41; {
     push @v, V&#40;$_, $_, $_&#41;;
}
my $tree = Math::Vector::Real::kdTree-&gt;new&#40;@v&#41;;
my @indices = $tree-&gt;find_in_ball&#40;$chkpt, $dist&#41;;
foreach $line &#40;@indices&#41; {
     my $distpt = $v[$line]-&gt;dist&#40;$chkpt&#41;;
     print &#34;Found one in ball of radius [$dist]: $line, $v[$line], $distpt\n&#34;;
}

I also noticed that when I specified an argument for $but, I get an error stating:

&#34;Can&#39;t use string &#40;&#34;999&#34;&#41; as a HASH ref while &#34;strict refs&#34; in use at C:/installationlocation/lib/Math/Vector/Real/dkTree.pm line 441.&#34;

I modified line 441 as seen below and it fixed the issue and correctly omitted that index:

return &#40;$but ? grep $but != $_, @r : @r&#41;;

Environment:
Strawberry Perl 64-bit
  -&gt;Perl 5, version 18, subversion 2 &#40;v5.18.2&#41; built for MSWin32-x64-multi-thread
Win7 Pro 64-bit SP1
kdTree module version is 0.11

Please let me know if I can provide any additional information.

Thanks and regards,
Chad

Chad Iverson
Aero-Thermal Technical Lead - Cincinnati Engineering Center

QuEST Global
11499 Chester Rd. Suite 600
Cincinnati, OH  45246  USA
T: +1 &#40;513&#41; 648-4938 X: 4938 F: +1 &#40;513&#41; 563-8865
E: chad.iverson@quest-global.com&lt;mailto:chad.iverson@quest-global.com&gt;  Follow us on: [Description: cid:image001.png@01CD132D.32D2BC20] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.facebook.com/QuESTGlobal">http://www.facebook.com/QuESTGlobal</a></span>&gt;  [Description: cid:image002.png@01CD132D.32D2BC20] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.linkedin.com/company/quest_2">http://www.linkedin.com/company/quest_2</a></span>&gt;  [Description: cid:image003.png@01CD132D.32D2BC20] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://twitter.com/#!/QuEST_Global&gt;">http://twitter.com/#!/QuEST_Global&gt;</a></span>
W: <span class="clickylink"><a target="new" rel="nofollow" href="http://engineering.quest-global.com">http://engineering.quest-global.com</a></span>&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://engineering.quest-global.com/">http://engineering.quest-global.com/</a></span>&gt;

---Disclaimer------------------------------ This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended solely for the use of the addressee&#40;s&#41;. If you are not the intended recipient, please notify the sender by e-mail and delete the original message. Opinions, conclusions and other information in this transmission that do not relate to the official business of QuEST Global and/or its subsidiaries, shall be understood as neither given nor endorsed by it. Any statements made herein that are tantamount to contractual obligations, promises, claims or commitments shall not be binding on the Company unless followed by written confirmation by an authorized signatory of the Company. -----------------------------------------------------------------------------------
</div></div>

<div class="messagebody">
</div>
</div>

<div class="messagebody">
<img alt="image001.png" title="image001.png" src="/Ticket/Attachment/1378545/731909/" /></div>

<div class="messagebody">
<img alt="image002.png" title="image002.png" src="/Ticket/Attachment/1378545/731910/" /></div>

<div class="messagebody">
<img alt="image003.png" title="image003.png" src="/Ticket/Attachment/1378545/731911/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;24&nbsp;03:09:46&nbsp;2014</span>
    <span class="description">salva [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yes, I found the same bug myself a couple of days ago.

It is already fixed in the development version in GitHub:

  <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/salva/p5-Math-Vector-Real-kdTree">https://github.com/salva/p5-Math-Vector-Real-kdTree</a></span>

I will probably release a new version to CPAN soon.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;24&nbsp;03:09:47&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;24&nbsp;10:29:24&nbsp;2014</span>
    <span class="description">chad.iverson [...] quest-global.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #96663] Issue with find_in_ball Routine</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 24 Jun 2014 14:29:01 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Math-Vector-Real-kdTree [...] rt.cpan.org&#34; &lt;bug-Math-Vector-Real-kdTree [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chad Iverson &lt;chad.iverson [...] quest-global.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The updated code did the trick.   Thank you for the quick response and the link to the updated pre-release version.

Best regards,
Chad

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Salvador Fandino Garcia via RT [mailto:bug-Math-Vector-Real-kdTree@rt.cpan.org]
Sent: Tuesday, June 24, 2014 3:10 AM
To: Chad Iverson
Subject: [rt.cpan.org #96663] Issue with find_in_ball Routine

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=96663">https://rt.cpan.org/Ticket/Display.html?id=96663</a></span> &gt;

Yes, I found the same bug myself a couple of days ago.

It is already fixed in the development version in GitHub:

  <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/salva/p5-Math-Vector-Real-kdTree">https://github.com/salva/p5-Math-Vector-Real-kdTree</a></span>

I will probably release a new version to CPAN soon.
---Disclaimer------------------------------ This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended solely for the use of the addressee&#40;s&#41;. If you are not the intended recipient, please notify the sender by e-mail and delete the original message. Opinions, conclusions and other information in this transmission that do not relate to the official business of QuEST Global and/or its subsidiaries, shall be understood as neither given nor endorsed by it. Any statements made herein that are tantamount to contractual obligations, promises, claims or commitments shall not be binding on the Company unless followed by written confirmation by an authorized signatory of the Company. -----------------------------------------------------------------------------------
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;14&nbsp;10:56:53&nbsp;2015</span>
    <span class="description">salva [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
