<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #102709 for PAR-Packer: Unable to handle SIG interrupts</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #102709 for PAR-Packer: Unable to handle SIG interrupts</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/PAR-Packer/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/PAR-Packer/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/PAR-Packer/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/PAR-Packer/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/PAR-Packer">PAR-Packer CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">102709</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/PAR-Packer/Active/">PAR-Packer</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gabeak [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-41710-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-41711-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;11&nbsp;20:17:22&nbsp;2015</span>
    <span class="description">gabeak [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Unable to handle SIG interrupts</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Mar 2015 17:17:12 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PAR-Packer [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gabriel Khwaja &lt;gabeak [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Windows 7 64 Bit
Activestate Perl v5.18.4 built for MSWin32-x86-multi-thread-64int
PAR-Packer version 1.025

I just used pp to package my app to exe.  It&#39;s running well however in my
app I catch the $SIG{&#39;INT&#39;} event &#40;ctrl-c&#41; so that I can do some clean up
steps before ending.  However, since pp actually creates a parent exe and
this exe does not ignore ctrl-c events, the parent closes but my app keeps
running but it doesn&#39;t run properly without the parent app and does not
exit.

I was previously using perl2exe and everything was behaving as expected.  I
switched to pp since perl2exe support stopped at perl 5.16.

I think the pp &#34;parent&#34; exe should be catching signals and send them over
to the child app - and it should not close, otherwise, the app is not
behaving as intended.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;12&nbsp;03:56:58&nbsp;2015</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 2015-03-11 20:17:22, gabeak@gmail.com schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think the pp &#34;parent&#34; exe should be catching signals and send them over
&gt; to the child app - and it should not close, otherwise, the app is not
&gt; behaving as intended.
</div>
Your analyis is correct - on Windows, we us spawnvpe to start the custom 
perl interpreter that actually runs your original program, so the
boot process stays around until the spawned process exits &#40;on *nix we
use execvp which just &#34;replaces&#34; the boot process, so no problem there&#41;.

I don&#39;t have a Windows machine anymore, hence can&#39;t fix this. If you want
to try yourself, the code is in myldr/boot.c at the end &#40;inside the
#ifdef WIN32 block&#41;. This is in plain C &#40;but specific to Windows&#41; and has nothing to do with Perl.

Cheers, Roderich
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;12&nbsp;03:56:59&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;03&nbsp;23:12:58&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">We need to ignore SIGINT in main process under windows.

Here is the patch:

diff -r PAR-Packer-1.025/myldr/boot.c PAR-Packer-1.025-orig/myldr/boot.c
219,228d218
&lt;     #include &lt;signal.h&gt;
&lt; 
&lt;     void sigintHandler&#40;int sig_num&#41; {
&lt;         /* Reset handler to catch SIGINT next time. Refer <span class="clickylink"><a target="new" rel="nofollow" href="http://en.cppreference.com/w/c/program/signal">http://en.cppreference.com/w/c/program/signal</a></span> */
&lt;         signal&#40;SIGINT, sigintHandler&#41;;
&lt;       }
&lt; 
&lt;     /* Set the SIGINT &#40;Ctrl-C&#41; signal handler to sigintHandler Refer <span class="clickylink"><a target="new" rel="nofollow" href="http://en.cppreference.com/w/c/program/signal">http://en.cppreference.com/w/c/program/signal</a></span> */
&lt;     signal&#40;SIGINT, sigintHandler&#41;;
&lt; 

Tested under:

strawberry-perl-5.20.2-x64
strawberry-perl-5.22.0
strawberry-perl-5.22.0-x64
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> patch</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;04&nbsp;12:43:51&nbsp;2015</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-07-03 23:12:58, ZDM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We need to ignore SIGINT in main process under windows.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here is the patch:
</div>
First, this isn&#39;t Windows specific &#40;makes no sense when not on Windows.
Second, it isn&#39;t the correct solution to the original problem.

Cheers, Roderich
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;06&nbsp;01:18:54&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jul 04 12:43:51 2015, RSCHUPP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 2015-07-03 23:12:58, ZDM wrote:
<div class="message-stanza open">&gt; &gt; We need to ignore SIGINT in main process under windows.
</div>&gt; 
<div class="message-stanza open">&gt; &gt; Here is the patch:
</div>&gt; 
&gt; First, this isn&#39;t Windows specific &#40;makes no sense when not on Windows.
&gt; Second, it isn&#39;t the correct solution to the original problem.
&gt; 
&gt; Cheers, Roderich
&gt; 
</div>Do you see the patch code?

1. It is only for windows.

2. It solves the problem completely. It prevent parent process to exit by SIGINT. When CTRL+C pressed - windows send SIGINT to process group. Parent process ignore this signal, but child process catch and process and can exit or do something else. Parent process exit only after child has finished.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;06&nbsp;02:30:57&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jul 04 12:43:51 2015, RSCHUPP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 2015-07-03 23:12:58, ZDM wrote:
<div class="message-stanza open">&gt; &gt; We need to ignore SIGINT in main process under windows.
</div>&gt; 
<div class="message-stanza open">&gt; &gt; Here is the patch:
</div>&gt; 
&gt; First, this isn&#39;t Windows specific &#40;makes no sense when not on Windows.
&gt; Second, it isn&#39;t the correct solution to the original problem.
&gt; 
&gt; Cheers, Roderich
&gt; 
</div>
Why you say, that this is not correct solution?

The problem is, that under windows the parent process exited on CTRL+C &#40;and, also, do not perform temp dir cleanup, if PAR was created with --clean option&#41; immediately, without waiting until child process exit. 

Parent process under windows should exit only after child has been finished. The proper solution - is to ignore SIGINT in parent process.

This patch solves this and do not affect linux code.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;06&nbsp;05:35:18&nbsp;2015</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-07-06 01:18:54, ZDM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Do you see the patch code?
</div>
Yes. Please use a unified diff next time.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 1. It is only for windows.
</div>
This restriction isn&#39;t in your patch &#40;or I can&#39;t tell from your patch because of
missing context, see above&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2. It solves the problem completely. It prevent parent process to exit
&gt; by SIGINT. When CTRL+C pressed - windows send SIGINT to process group.
</div>
Can you cite some reference for this, preferably from MSDN.

Also, why do you re-arm the signal handler - no modern system should need that,
you should use sigaction anyway.

Cheers, Roderich
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;08&nbsp;00:57:23&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jul 06 05:35:18 2015, RSCHUPP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 2015-07-06 01:18:54, ZDM wrote:
<div class="message-stanza open">&gt; &gt; Do you see the patch code?
</div>&gt; 
&gt; Yes. Please use a unified diff next time.
&gt; 
<div class="message-stanza open">&gt; &gt; 1. It is only for windows.
</div>&gt; 
&gt; This restriction isn&#39;t in your patch &#40;or I can&#39;t tell from your patch
&gt; because of
&gt; missing context, see above&#41;.
&gt; 
<div class="message-stanza open">&gt; &gt; 2. It solves the problem completely. It prevent parent process to
&gt; &gt; exit
&gt; &gt; by SIGINT. When CTRL+C pressed - windows send SIGINT to process
&gt; &gt; group.
</div>&gt; 
&gt; Can you cite some reference for this, preferably from MSDN.
&gt; 
&gt; Also, why do you re-arm the signal handler - no modern system should
&gt; need that,
&gt; you should use sigaction anyway.
&gt; 
&gt; Cheers, Roderich
</div>
Here is the more correct solution and simple:

    # include &lt;signal.h&gt;
    signal&#40;SIGINT, SIG_IGN&#41;;

1. Previously signal was re-armed in handler, because signal call drop handler to the default. This is not needed if we use SIG_IGN;

2. sigaction is too complex and not needed if we just want to ignore signal;

3. About CTRL+C under windows:
<span class="clickylink"><a target="new" rel="nofollow" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms682541%28v=vs.85%29.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/ms682541%28v=vs.85%29.aspx</a></span>

By default, these signals are passed to all console processes that are attached to the console. &#40;Detached processes are not affected.&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;08&nbsp;09:41:49&nbsp;2015</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

sorry for the late response, I&#39;m trying to catch up on open bugs:

On 2015-03-11 20:17:22, gabeak@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I just used pp to package my app to exe.  It&#39;s running well however in my
&gt; app I catch the $SIG{&#39;INT&#39;} event &#40;ctrl-c&#41; so that I can do some clean up
&gt; steps before ending.  However, since pp actually creates a parent exe and
&gt; this exe does not ignore ctrl-c events, the parent closes but my app keeps
&gt; running but it doesn&#39;t run properly without the parent app and does not
&gt; exit.
</div>
What do you mean when you say &#34;my app ... doesn&#39;t run properly and does not exit&#34;? Also, is this a &#34;command line&#34; program or does it have a GUI &#40;i.e. you packed it using &#34;pp --gui ...&#34;&#41;?
Can you cook up a minimal example that shows the problem?

Cheers, Roderich
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;08&nbsp;13:24:01&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jul 08 09:41:49 2015, RSCHUPP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; sorry for the late response, I&#39;m trying to catch up on open bugs:
&gt; 
&gt; On 2015-03-11 20:17:22, gabeak@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; I just used pp to package my app to exe.  It&#39;s running well however
&gt; &gt; in my
&gt; &gt; app I catch the $SIG{&#39;INT&#39;} event &#40;ctrl-c&#41; so that I can do some
&gt; &gt; clean up
&gt; &gt; steps before ending.  However, since pp actually creates a parent exe
&gt; &gt; and
&gt; &gt; this exe does not ignore ctrl-c events, the parent closes but my app
&gt; &gt; keeps
&gt; &gt; running but it doesn&#39;t run properly without the parent app and does
&gt; &gt; not
&gt; &gt; exit.
</div>&gt; 
&gt; What do you mean when you say &#34;my app ... doesn&#39;t run properly and
&gt; does not exit&#34;? Also, is this a &#34;command line&#34; program or does it have
&gt; a GUI &#40;i.e. you packed it using &#34;pp --gui ...&#34;&#41;?
&gt; Can you cook up a minimal example that shows the problem?
&gt; 
&gt; Cheers, Roderich
</div>
Under windows parent process is only spawn child, waiting until child exited and perform cleanup &#40;if was packed with --clean&#41;.

This is obvious, that parent should not exit on CTRL+C. No matter, has child process GUI or this is just command line app.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;09&nbsp;04:51:00&nbsp;2015</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am 2015-07-08 13:24:01, ZDM schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is obvious, that parent should not exit on CTRL+C. No matter, has
&gt; child process GUI or this is just command line app.
</div>
No, it&#39;s not obvious at all. 
BTW, thanks for the MSDN reference. If his &#34;app&#34; is a command line app &#40;&#34;console application&#34; in Windows lingo&#41;, then - according to
this article - SIGINT should be deliverd to both parent and child.
But then what is his actual problem &#40;aside from the missing
cleanup of extracted files if packed with --clean? Is the SIGINT
handler in the child not called? And what does &#34;it doesn&#39;t run properly without the parent app and does not exit&#34; mean? 
OTOH if his &#34;app&#34; is a GUI application, there&#39;s no console window, 
so what does Ctrl-C mean here?
I think this is a typical case of an &#34;XY problem&#34;, so I need
a minimal example to see what&#39;s actually going on, otherwise
I&#39;ll close this bug report.

Cheers, Roderich
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;09&nbsp;11:10:58&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">1. According to MSDN - CTRL+C have a special behavior only for console applications. For GUI - developer should manually catch and process corresponded windows message &#40;CTRL+C is not generates SIGINT for the gui apps&#41;.

2. About &#34;it doesn&#39;t run properly without the parent app and does not exit&#34;, etc...

Child still run properly, can receive signals, print something to console, but parent has been exited - so console become free for user input. I can type and execute another console command. But child process still attached to this console instance and his output become mixed with new commands, etc...

Another thing - if I use something like this:

print &#39;Press ENTER to continue...&#39;;
&lt;STDIN&gt;;

this not works. I think - this is because console catch &lt;ENTER&gt; key press and process it without sending to the child process. Or maybe STDIN for child process become closed.

All this problems are not observed if parent process is attached to the console.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;13&nbsp;17:16:15&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, Roderich.

Topic starter, seems, will never answer.

Do you plan to include this changes and close the issue?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;17&nbsp;04:57:08&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Roderich, 

We can go other way.

Can you give an example, when parent process under windows should exit on CTRL+C without waiting for a child and do not perform standard cleanup operations and makes zombie from the child process?

I don&#39;t see any such cases.

This is a typical software bug, and I watched him since using parl under windows. This bug is not critical, but makes software behavior unexpected.

Really, I don&#39;t understand, why you do not want to fix this? What are you waiting for?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;17&nbsp;05:25:23&nbsp;2015</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-07-17 04:57:08, ZDM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Really, I don&#39;t understand, why you do not want to fix this? What are
&gt; you waiting for?
</div>
Time to think this thru. You have not convinced me yet, see below.
And it&#39;s my time and my disgression how I spend it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you give an example, when parent process under windows should exit
&gt; on CTRL+C without waiting for a child and do not perform standard
&gt; cleanup operations and makes zombie from the child process?
</div>
What are you talking about, there are no zombies here.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Another thing - if I use something like this: 
&gt;   print &#39;Press ENTER to continue...&#39;; 
&gt;   &lt;STDIN&gt;; 
</div>
I managed to get hold of an old laptop running Windows XP and I can&#39;t reproduce
this here: If I Ctrl-C the above example at the prompt, both the parent 
and the child get killed, so I don&#39;t see the point. 
If the script has set up a SIGINT handler, it is executed. Yeah, the cleanup
in the parent isn&#39;t run in this case, but it isn&#39;t on *nix either.
Also, there&#39;s no harm in leaving some temp files around.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is a typical software bug, and I watched him since using parl
&gt; under windows. This bug is not critical, but makes software behavior
&gt; unexpected.
</div>
Nope, _ignoring_ SIGINT is unexpected behaviour. 

Cheers, Roderich
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;17&nbsp;07:09:38&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jul 17 05:25:23 2015, RSCHUPP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 2015-07-17 04:57:08, ZDM wrote:
<div class="message-stanza open">&gt; &gt; Really, I don&#39;t understand, why you do not want to fix this? What are
&gt; &gt; you waiting for?
</div>&gt; 
&gt; Time to think this thru. You have not convinced me yet, see below.
&gt; And it&#39;s my time and my disgression how I spend it.
&gt; 
<div class="message-stanza open">&gt; &gt; Can you give an example, when parent process under windows should
&gt; &gt; exit
&gt; &gt; on CTRL+C without waiting for a child and do not perform standard
&gt; &gt; cleanup operations and makes zombie from the child process?
</div>&gt; 
&gt; What are you talking about, there are no zombies here.
&gt; 
<div class="message-stanza open">&gt; &gt; Another thing - if I use something like this:
&gt; &gt;   print &#39;Press ENTER to continue...&#39;;
&gt; &gt;   &lt;STDIN&gt;;
</div>&gt; 
&gt; I managed to get hold of an old laptop running Windows XP and I can&#39;t
&gt; reproduce
&gt;  this here: If I Ctrl-C the above example at the prompt, both the
&gt; parent
&gt;  and the child get killed, so I don&#39;t see the point.
&gt; If the script has set up a SIGINT handler, it is executed. Yeah, the
&gt; cleanup
&gt; in the parent isn&#39;t run in this case, but it isn&#39;t on *nix either.
</div>
- Why you speak about unix? This bug is on windows only. And patch only for windows and do not affect unix code.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, there&#39;s no harm in leaving some temp files around.
</div>
- What is the option &#34;--clean&#34; for, if it does not work? Ok, this is not really serious disadvantage, except, if user will run the program frequently. In anyway, clearing garbage - is a good style.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; This is a typical software bug, and I watched him since using parl
&gt; &gt; under windows. This bug is not critical, but makes software behavior
&gt; &gt; unexpected.
</div>&gt; 
&gt; Nope, _ignoring_ SIGINT is unexpected behaviour.
</div>
- Ignoring SIGINT in parent is unexpected? Why? This is the main question.

All significant code is executed in child process. Including signals processing. Parent should only wait, until child has been exited and perform cleanup, if needed. I do not see any other functionality in myldr/boot.c.

This is unexpected, if user press CTRL+C and parent process will be finished, but child process will keep running in background. 

Any user will think, that process finished completely, but this is not true.

Or you think, that, some users are expect this?

Why you are disagree with this obvious thing? Look into your code, what proofs you are looking for?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Cheers, Roderich
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;17&nbsp;07:46:57&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Also, this is not the &#34;XY problem&#34;. This is a real fully-qualified bug. That leads to the invalid behavior, when program should not exit on SIGINT immediately, but, for example, finish currently running transactions &#40;what can take a lot of time&#41;.

Proposed solution resolves this bug completely and do not affect other parts of code.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;17&nbsp;08:04:17&nbsp;2015</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-07-17 07:09:38, ZDM wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - What is the option &#34;--clean&#34; for, if it does not work? Ok, this is
&gt; not really serious disadvantage, except, if user will run the program
&gt; frequently. 
</div>
I don&#39;t know what you mean by this.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is unexpected, if user press CTRL+C and parent process will be
&gt; finished, but child process will keep running in background.
</div>
You keep repeating this, but this _not_ what I see.
Please present an example that I can reproduce.
Otherwise this discussion ends here and I&#39;ll close this bug without action.

Cheers, Roderich
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;18&nbsp;02:04:58&nbsp;2015</span>
    <span class="description">ZDM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please, look at examples in attachments.

1.pl - source script.

1.exe - packed with current PAR::Packer version.

1-patched.exe - packed with patched PAR::Packer version.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 1-patched.exe</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 1.exe</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 1.pl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/env perl

package main v0.1.0;

my $i;

$SIG{INT} = sub {
    print &#34;--- SIGINT\n&#34;;

    exit if ++$i &gt; 2;

    return;
};

while &#40;1&#41; {
    print &#34;ALIVE\n&#34;;

    sleep 1;
}

1;
__END__
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
