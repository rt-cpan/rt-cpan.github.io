<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #50574 for Archive-Zip: Archive::Zip Module - addDirectory does not work in Windows XP</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #50574 for Archive-Zip: Archive::Zip Module - addDirectory does not work in Windows XP</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Archive-Zip/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Archive-Zip/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Archive-Zip/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Archive-Zip/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Archive-Zip">Archive-Zip CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">50574</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Archive-Zip/Active/">Archive-Zip</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
karthigan [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
CHORNY [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-2540-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-2541-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;16&nbsp;16:59:16&nbsp;2009</span>
    <span class="description">karthigan [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Archive::Zip Module - addDirectory does not work in Windows XP</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
I am using Perl v5.10.1 from ActiveState on Windows XP Professional. The
addDirectory method does not work. If I use it, I get a blank zip file
with nothing inside it. 

Currently I have to add one file at time to get it to work using the
addFile method. Please let me know if there is anything wrong in the
snippet below or if there is a known compatibility issue with WinXP.

Best Regards,
Karthigan.



Here is the code snippet: 

===========================================================
use Archive::Zip;

$zipme = Archive::Zip-&gt;new;
$zipme-&gt;addDirectory&#40;&#39;C:/KDATA/Personal/Perl/&#39;&#41;;
$err = $zipme-&gt;writeToFileNamed&#40;&#34;perlsource.zip&#34;&#41;;

if &#40;$err = AZ_OK&#41; {

print &#34;Everything is cool..files zipped\n&#34;;

}

============================================================
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;17&nbsp;07:47:07&nbsp;2009</span>
    <span class="description">SHLOMIF [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi karthigan12!

Thanks for your report. See below for my commentary.

On Fri Oct 16 16:59:16 2009, karthigan12 wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I am using Perl v5.10.1 from ActiveState on Windows XP Professional. The
&gt; addDirectory method does not work. If I use it, I get a blank zip file
&gt; with nothing inside it. 
&gt; 
&gt; Currently I have to add one file at time to get it to work using the
&gt; addFile method. Please let me know if there is anything wrong in the
&gt; snippet below or if there is a known compatibility issue with WinXP.
&gt; 
&gt; Best Regards,
&gt; Karthigan.
&gt; 
&gt; 
&gt; 
&gt; Here is the code snippet: 
&gt; 
&gt; ===========================================================
&gt; use Archive::Zip;
&gt; 
&gt; $zipme = Archive::Zip-&gt;new;
&gt; $zipme-&gt;addDirectory&#40;&#39;C:/KDATA/Personal/Perl/&#39;&#41;;
&gt; $err = $zipme-&gt;writeToFileNamed&#40;&#34;perlsource.zip&#34;&#41;;
&gt; 
&gt; if &#40;$err = AZ_OK&#41; {
&gt; 
&gt; print &#34;Everything is cool..files zipped\n&#34;;
&gt; 
&gt; }
&gt; 
&gt; ============================================================
</div>
This code has several issues:

1. It doesn&#39;t use &#34;strict&#34; and &#34;warnings&#34;. Please add them.

2. if &#40;$err = AZ_OK&#41; does an assignment inside the conditional - not a
comparison. As such it will always succeed or fail based on whether
AZ_OK is true or false.

Please fix this problem and see if the same thing happen. You may also
wish to run it under a different OS in a Virtual Machine for &#40;such as
the costless and open-source VirtualBox&#41;. 

Regards,

-- Shlomi Fish
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;17&nbsp;07:47:08&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;19&nbsp;15:33:12&nbsp;2009</span>
    <span class="description">karthigan [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50574] Archive::Zip Module - addDirectory does not work in Windows XP</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 19 Oct 2009 12:32:20 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Archive-Zip [...] rt.cpan.org, SMPETERS [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karthigan Srinivasan &lt;karthigan [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I applied the changes that you recommended and I still see the same problem in Windows XP. 

Best Regards,
Karthigan.

==================================================
use strict;
use warnings;

use Archive::Zip;
use File::Next;

my $zipme = Archive::Zip-&gt;new;

$zipme-&gt;addDirectory&#40;&#39;C:/KDATA/Personal/Perl/&#39;&#41;;
my $err = $zipme-&gt;writeToFileNamed&#40;&#34;perlsource.zip&#34;&#41;;

if &#40;$err == $zipme-&gt;AZ_OK&#41; {
    print &#34;Everything is cool..files zipped\n&#34;;
}


================================================
--- On Sat, 10/17/09, Shlomi Fish via RT &lt;bug-Archive-Zip@rt.cpan.org&gt; wrote:

From: Shlomi Fish via RT &lt;bug-Archive-Zip@rt.cpan.org&gt;
Subject: [rt.cpan.org #50574] Archive::Zip Module - addDirectory does not work in Windows XP
To: karthigan@yahoo.com
Cc: SMPETERS@cpan.org
Date: Saturday, October 17, 2009, 6:47 AM

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=50574">https://rt.cpan.org/Ticket/Display.html?id=50574</a></span> &gt;

Hi karthigan12!

Thanks for your report. See below for my commentary.

On Fri Oct 16 16:59:16 2009, karthigan12 wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I am using Perl v5.10.1 from ActiveState on Windows XP Professional. The
&gt; addDirectory method does not work. If I use it, I get a blank zip file
&gt; with nothing inside it. 
&gt; 
&gt; Currently I have to add one file at time to get it to work using the
&gt; addFile method. Please let me know if there is anything wrong in the
&gt; snippet below or if there is a known compatibility issue with WinXP.
&gt; 
&gt; Best Regards,
&gt; Karthigan.
&gt; 
&gt; 
&gt; 
&gt; Here is the code snippet: 
&gt; 
&gt; ===========================================================
&gt; use Archive::Zip;
&gt; 
&gt; $zipme = Archive::Zip-&gt;new;
&gt; $zipme-&gt;addDirectory&#40;&#39;C:/KDATA/Personal/Perl/&#39;&#41;;
&gt; $err = $zipme-&gt;writeToFileNamed&#40;&#34;perlsource.zip&#34;&#41;;
&gt; 
&gt; if &#40;$err = AZ_OK&#41; {
&gt; 
&gt; print &#34;Everything is cool..files zipped\n&#34;;
&gt; 
&gt; }
&gt; 
&gt; ============================================================
</div>
This code has several issues:

1. It doesn&#39;t use &#34;strict&#34; and &#34;warnings&#34;. Please add them.

2. if &#40;$err = AZ_OK&#41; does an assignment inside the conditional - not a
comparison. As such it will always succeed or fail based on whether
AZ_OK is true or false.

Please fix this problem and see if the same thing happen. You may also
wish to run it under a different OS in a Virtual Machine for &#40;such as
the costless and open-source VirtualBox&#41;. 

Regards,

-- Shlomi Fish



      
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;21&nbsp;17:41:56&nbsp;2009</span>
    <span class="description">CHORNY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Птн. Окт. 16 16:59:16 2009, karthigan12 писал:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The addDirectory method does not work. If I use it, I get a blank zip
</div>file with nothing inside it. 

Which version of Archive::Zip do you use? Try upgrading to 1.30, if you
don&#39;t use it.

-- 
Alexandr Ciornii, <span class="clickylink"><a target="new" rel="nofollow" href="http://chorny.net">http://chorny.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;21&nbsp;18:52:49&nbsp;2009</span>
    <span class="description">CHORNY [...] cpan.org -  Cc CHORNY added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;30&nbsp;15:03:13&nbsp;2009</span>
    <span class="description">karthigan [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> SMPETERS [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50574] Archive::Zip Module - addDirectory does not work in Windows XP</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Nov 2009 12:02:07 -0800 &#40;PST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Archive-Zip [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karthigan Srinivasan &lt;karthigan [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have verified. I am currently using Archive::Zip version 1.30. The issue exists in version 1.30.

Best Regards,
Karthigan.




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________
From: Alexandr Ciornii via RT &lt;bug-Archive-Zip@rt.cpan.org&gt;
To: karthigan@yahoo.com
Cc: SMPETERS@cpan.org
Sent: Sat, November 21, 2009 4:41:57 PM
Subject: [rt.cpan.org #50574] Archive::Zip Module - addDirectory does not work in Windows XP 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=50574">https://rt.cpan.org/Ticket/Display.html?id=50574</a></span> &gt;

Птн. Окт. 16 16:59:16 2009, karthigan12 писал:

<div class="message-stanza open">&gt; The addDirectory method does not work. If I use it, I get a blank zip
</div>file with nothing inside it. 

Which version of Archive::Zip do you use? Try upgrading to 1.30, if you
don&#39;t use it.

-- 
Alexandr Ciornii, <span class="clickylink"><a target="new" rel="nofollow" href="http://chorny.net">http://chorny.net</a></span>


      
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;07&nbsp;16:45:15&nbsp;2009</span>
    <span class="description">alan [...] insley.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">$zipme-&gt;addDirectory&#40;&#39;dirName&#39;&#41;;

Worked OK when I tried it. Windows XP with 5.10 ActiveState
I think you may have wanted the addTree&#40;&#41; function to add a tree of files.

addDirectory&#40;&#41; added only the new empty directory to the archive.
This seems to be correct behavior for the library.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
