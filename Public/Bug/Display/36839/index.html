<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #36839 for Text-CSV_XS: getline_hr produces a warning if any column_name is undef</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #36839 for Text-CSV_XS: getline_hr produces a warning if any column_name is undef</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Text-CSV_XS/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Text-CSV_XS/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Text-CSV_XS/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Text-CSV_XS/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Text-CSV_XS">Text-CSV_XS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">36839</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Text-CSV_XS/Active/">Text-CSV_XS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">HMBRAND [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
melazyboy [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-31868-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.51    </td>
  </tr>
  <tr id="CF-31869-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.52    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;18&nbsp;17:41:05&nbsp;2008</span>
    <span class="description">melazyboy [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> getline_hr produces a warning if any column_name is undef</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">One of the .xls feeds I have openoffice exports with a header row of 
,&#34;ST&#34;,,&#34;SERIAL #&#34;,&#34;YR&#34;,&#34;MAKE&#34;,&#34;Model&#34;,&#34;WB&#34;,&#34;GVW&#34;,&#34;BRAKE&#34;

It turns out the that if any column header is undef, the first one
included you will get the following error:

Use of uninitialized value in hash slice at
/usr/local/lib/perl5/site_perl/5.10.0/x86_64-linux/Text/CSV_XS.pm line
445, &lt;GEN0&gt; line 287.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;02:20:19&nbsp;2008</span>
    <span class="description">HMBRAND [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, 19 Jun 2008 23:19:41 +0200, Gintas Grigelionis 
&lt;g.grigelionis@computer.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; H.Merijn Brand wrote:  
<div class="message-stanza open">&gt; &gt; On Tue, 17 Jun 2008 23:43:03 +0200, g.grigelionis@computer.org 
</div></div>wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; 
&gt; &gt; Thanks for the report, but I cannot reproduce this. I&#39;ve tried with
&gt; &gt; 5.8.0 with and without UTF-8 locales, but I cannot make it fail.
&gt; &gt; I do not have a threaded 5.8.0 version at hand, but would like to 
</div></div>see
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; what failed why.  
</div>&gt; 
&gt; This has to do with broken UTF-8, setting LANG=C makes tests pass.
&gt; Unfortunately, I cannot make tests more verbose.  
</div>
5.8.0 is not the most UTF-8 safe version of perl. Try to upgrade to
5.8.4 or up. 5.8.8 is current, and 5.8.9 is about to be released in
not too long from now.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;02:20:20&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;02:20:21&nbsp;2008</span>
    <span class="description">HMBRAND [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;02:20:22&nbsp;2008</span>
    <span class="description">HMBRAND [...] cpan.org -  Given to HMBRAND</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;14:05:38&nbsp;2008</span>
    <span class="description">h.m.brand [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #36839] getline_hr produces a warning if any column_name is undef</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 19 Jun 2008 08:18:49 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Text-CSV_XS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, 18 Jun 2008 17:41:06 -0400, &#34;Evan Carroll via RT&#34;
&lt;bug-Text-CSV_XS@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; One of the .xls feeds I have openoffice exports with a header row of 
&gt; ,&#34;ST&#34;,,&#34;SERIAL #&#34;,&#34;YR&#34;,&#34;MAKE&#34;,&#34;Model&#34;,&#34;WB&#34;,&#34;GVW&#34;,&#34;BRAKE&#34;
&gt; 
&gt; It turns out the that if any column header is undef, the first one
&gt; included you will get the following error:
</div>
This very much depends on the way you called the constructor.
Is it possible to get the script and the file&gt;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Use of uninitialized value in hash slice at
&gt; /usr/local/lib/perl5/site_perl/5.10.0/x86_64-linux/Text/CSV_XS.pm line
&gt; 445, &lt;GEN0&gt; line 287.
</div>
-- 
H.Merijn Brand         Amsterdam Perl Mongers &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://amsterdam.pm.org/&#41;">http://amsterdam.pm.org/&#41;</a></span>
using &#38; porting perl 5.6.2, 5.8.x, 5.10.x  on HP-UX 10.20, 11.00, 11.11,
&#38; 11.23, SuSE 10.1 &#38; 10.2, AIX 5.2, and Cygwin.       <span class="clickylink"><a target="new" rel="nofollow" href="http://qa.perl.org">http://qa.perl.org</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://mirrors.develooper.com/hpux/">http://mirrors.develooper.com/hpux/</a></span>            <span class="clickylink"><a target="new" rel="nofollow" href="http://www.test-smoke.org">http://www.test-smoke.org</a></span>
                        <span class="clickylink"><a target="new" rel="nofollow" href="http://www.goldmark.org/jeff/stupid-disclaimers/">http://www.goldmark.org/jeff/stupid-disclaimers/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;20&nbsp;14:05:40&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;27&nbsp;17:48:03&nbsp;2008</span>
    <span class="description">melazyboy [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> melazyboy [...] gmail.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m still not sure exactly what the bug is but this report I did was way
deceiving. I was remiss in debugging this. The bug is related to
blank_is_undef. I have attached a test.

Shout if you need anything else for me
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use Text::CSV_XS;
use IO::Handle;

use Test::More tests =&gt; 1;

our $failed = 0;
$SIG{ &#39;__WARN__&#39; } = sub { print @_; $failed++ };

eval {
	my $csv = Text::CSV_XS-&gt;new&#40;{ blank_is_undef =&gt; 1 }&#41;;

	my $header_row = $csv-&gt;getline&#40;\*DATA&#41;;
	$csv-&gt;column_names&#40; $header_row &#41;;

	1 while &#40; my $tuple = $csv-&gt;getline_hr&#40;\*DATA&#41; &#41;;
};

ok &#40; !$failed, &#39;We did not fail the blank_is_undef test&#39; &#41;;

1;

__DATA__
,&#34;ST&#34;,&#34;UNIT #&#34;,&#34;SERIAL #&#34;,&#34;YR&#34;,&#34;MAKE&#34;,&#34;Model&#34;,&#34;WB&#34;,&#34;GVW&#34;,&#34;BRAKE&#34;,&#34;ENGINE&#34;,&#34;JAKE&#34;,&#34;EXH&#34;,&#34;Air Cl&#34;,&#34;TRANSMISSION&#34;,&#34;Axle&#39;s&#34;,&#34;Tanks&#34;,&#34;SUSP&#34;,&#34;TIRES &#38; WHEELS&#34;,&#34;COLOR&#34;,&#34;BODY&#34;,&#34;Doors&#34;,&#34;LIFT G&#34;,&#34;Reefer Make&#34;,&#34;Reefer/HRS&#34;,&#34;Miles&#34;,&#34;PRICE&#34;,
&#34;Atlanta&#34;,&#34;GA&#34;,40409,&#34;1FDXE45P56DB40409&#34;,2006,&#34;FORD&#34;,&#34;E-450&#34;,176,14050,&#34;Hyd&#34;,&#34;6.0L Diesel&#34;,&#34;NO&#34;,,,&#34;Elec 5- spd Auto&#34;,,,&#34;Spr&#34;,&#34;LT225/75R16&#34;,&#34;White&#34;,&#34;16&#39; service body&#34;,,,,,16000,28000,
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;27&nbsp;18:47:33&nbsp;2008</span>
    <span class="description">h.m.brand [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #36839] getline_hr produces a warning if any column_name is undef</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 28 Jun 2008 00:47:07 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Text-CSV_XS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 27 Jun 2008 17:48:05 -0400, &#34;Evan Carroll via RT&#34;
&lt;bug-Text-CSV_XS@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Text-CSV_XS
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=36839">http://rt.cpan.org/Ticket/Display.html?id=36839</a></span> &gt;
&gt; 
&gt; I&#39;m still not sure exactly what the bug is but this report I did was way
&gt; deceiving. I was remiss in debugging this. The bug is related to
&gt; blank_is_undef. I have attached a test.
&gt; 
&gt; Shout if you need anything else for me
</div>
Several things here. The hashref is bound to fail here for multiple
reasons. It was set up because it was requested, but it actually is
quite accident prone.  What if there is more than one single fields
with the same `name&#39; in the header?  Or if there are more fields in
the header line that result to the same &#40;empty&#41; name? It was not my
intention to make that work. But I agree that the current way isn&#39;t
to most user friendly.

Try this.
--8&lt;---
diff --git a/CSV_XS.pm b/CSV_XS.pm
index b622344..1af85ba 100644
--- a/CSV_XS.pm
+++ b/CSV_XS.pm
@@ -30,7 +30,7 @@ use DynaLoader &#40;&#41;;
 use Carp;

 use vars   qw&#40; $VERSION @ISA &#41;;
-$VERSION = &#34;0.51&#34;;
+$VERSION = &#34;0.52&#34;;
 @ISA     = qw&#40; DynaLoader &#41;;

 sub PV { 0 }
@@ -423,7 +423,7 @@ sub column_names
     $self-&gt;{_is_bound} &#38;&#38; @keys != $self-&gt;{_is_bound} and
        croak &#40;$self-&gt;SetDiag &#40;3003&#41;&#41;;

-    $self-&gt;{_COLUMN_NAMES} = [ @keys ];
+    $self-&gt;{_COLUMN_NAMES} = [ map { defined $_ ? $_ : &#34;UNDEF&#34; } @keys ];
     @keys;
     } # column_names

@@ -445,7 +445,7 @@ sub bind_columns
     $self-&gt;_set_attr_N &#40;&#34;_is_bound&#34;, scalar @refs&#41;;
     $self-&gt;{_BOUND_COLUMNS} = [ @refs ];
     @refs;
-    } # column_names
+    } # bind_columns

 sub getline_hr
 {
@@ -1250,14 +1250,12 @@ internal failure, like failing to store a hash value.

 =item More Errors &#38; Warnings

-At current, it is hard to tell where or why an error occured &#40;if
-at all&#41;. New extensions ought to be clear and concise in reporting
-what error occurred where and why, and possibly also tell a remedy
-to the problem. error_diag is a &#40;very&#41; good start, but there is more
-work to be done here.
+New extensions ought to be clear and concise in reporting what error
+occurred where and why, and possibly also tell a remedy to the problem.
+error_diag is a &#40;very&#41; good start, but there is more work to be done here.

-Basic calls should croak or warn on illegal parameters. Errors
-should be documented.
+Basic calls should croak or warn on illegal parameters. Errors should be
+documented.

 =item eol

diff --git a/ChangeLog b/ChangeLog
index 3a65deb..f874bea 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,7 @@
+2008-06-28  0.52 - H.Merijn Brand   &lt;h.m.brand@xs4all.nl&gt;
+
+       * Using undef for hash keys is a bad plan
+
 2008-06-17  0.51 - H.Merijn Brand   &lt;h.m.brand@xs4all.nl&gt;

        * Allow UTF8 even without binary =&gt; 1
--&gt;8---

-- 
H.Merijn Brand          Amsterdam Perl Mongers  <span class="clickylink"><a target="new" rel="nofollow" href="http://amsterdam.pm.org/">http://amsterdam.pm.org/</a></span>
using &#38; porting perl 5.6.2, 5.8.x, 5.10.x, 5.11.x on HP-UX 10.20, 11.00,
11.11, 11.23, and 11.31, SuSE 10.1, 10.2, and 10.3, AIX 5.2, and Cygwin.
<span class="clickylink"><a target="new" rel="nofollow" href="http://mirrors.develooper.com/hpux/">http://mirrors.develooper.com/hpux/</a></span>           <span class="clickylink"><a target="new" rel="nofollow" href="http://www.test-smoke.org/">http://www.test-smoke.org/</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://qa.perl.org">http://qa.perl.org</a></span>      <span class="clickylink"><a target="new" rel="nofollow" href="http://www.goldmark.org/jeff/stupid-disclaimers/">http://www.goldmark.org/jeff/stupid-disclaimers/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;28&nbsp;09:56:33&nbsp;2008</span>
    <span class="description">h.m.brand [...] xs4all.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #36839] getline_hr produces a warning if any column_name is undef</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 28 Jun 2008 15:56:15 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Text-CSV_XS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;H.Merijn Brand&#34; &lt;h.m.brand [...] xs4all.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 27 Jun 2008 17:48:05 -0400, &#34;Evan Carroll via RT&#34;
&lt;bug-Text-CSV_XS@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Text-CSV_XS
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=36839">http://rt.cpan.org/Ticket/Display.html?id=36839</a></span> &gt;
&gt; 
&gt; I&#39;m still not sure exactly what the bug is but this report I did was way
&gt; deceiving. I was remiss in debugging this. The bug is related to
&gt; blank_is_undef. I have attached a test.
&gt; 
&gt; Shout if you need anything else for me
</div>
Just uploaded 0.52, which should have fixed this. Documentation has
been updated to reflect the changes.

-- 
H.Merijn Brand          Amsterdam Perl Mongers  <span class="clickylink"><a target="new" rel="nofollow" href="http://amsterdam.pm.org/">http://amsterdam.pm.org/</a></span>
using &#38; porting perl 5.6.2, 5.8.x, 5.10.x, 5.11.x on HP-UX 10.20, 11.00,
11.11, 11.23, and 11.31, SuSE 10.1, 10.2, and 10.3, AIX 5.2, and Cygwin.
<span class="clickylink"><a target="new" rel="nofollow" href="http://mirrors.develooper.com/hpux/">http://mirrors.develooper.com/hpux/</a></span>           <span class="clickylink"><a target="new" rel="nofollow" href="http://www.test-smoke.org/">http://www.test-smoke.org/</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="http://qa.perl.org">http://qa.perl.org</a></span>      <span class="clickylink"><a target="new" rel="nofollow" href="http://www.goldmark.org/jeff/stupid-disclaimers/">http://www.goldmark.org/jeff/stupid-disclaimers/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;02&nbsp;13:19:41&nbsp;2008</span>
    <span class="description">HMBRAND [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;02&nbsp;13:20:19&nbsp;2008</span>
    <span class="description">HMBRAND [...] cpan.org -  Fixed in 0.52 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
