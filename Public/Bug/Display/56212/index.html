<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #56212 for DBIx-Class-Schema-Loader: Skip test count wrong without DBICTEST_MYSQL_INNODB set</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #56212 for DBIx-Class-Schema-Loader: Skip test count wrong without DBICTEST_MYSQL_INNODB set</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBIx-Class-Schema-Loader">DBIx-Class-Schema-Loader CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">56212</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBIx-Class-Schema-Loader/Active/">DBIx-Class-Schema-Loader</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mschwern [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-38270-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.05003    </td>
  </tr>
  <tr id="CF-38271-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;01&nbsp;21:29:19&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Skip test count wrong without DBICTEST_MYSQL_INNODB set</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If DBICTEST_MYSQL_INNODB is not set t/11mysql_common.t will skip a large
number of tests.  The count appears to be wrong, coming up 150 instead
of the expected 161.  Its not obvious where that count is being set.

Test output is attached.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dbic.out</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;02&nbsp;03:12:37&nbsp;2010</span>
    <span class="description">rkitover@cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #56212] Skip test count wrong without DBICTEST_MYSQL_INNODB set</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 2 Apr 2010 03:11:52 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael G Schwern via RT &lt;bug-DBIx-Class-Schema-Loader [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rafael Kitover &lt;rkitover [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Michael,

this is fixed in git:

git://git.shadowcat.co.uk/dbsrgits/DBIx-Class-Schema-Loader.git

On Thu, Apr 01, 2010 at 09:29:20PM -0400, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thu Apr 01 21:29:19 2010: Request 56212 was acted upon.
&gt; Transaction: Ticket created by MSCHWERN
&gt;        Queue: DBIx-Class-Schema-Loader
&gt;      Subject: Skip test count wrong without DBICTEST_MYSQL_INNODB set
&gt;    Broken in: 0.05003
&gt;     Severity: Important
&gt;        Owner: Nobody
&gt;   Requestors: mschwern@cpan.org
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=56212">https://rt.cpan.org/Ticket/Display.html?id=56212</a></span> &gt;
&gt; 
&gt; 
&gt; If DBICTEST_MYSQL_INNODB is not set t/11mysql_common.t will skip a large
&gt; number of tests.  The count appears to be wrong, coming up 150 instead
&gt; of the expected 161.  Its not obvious where that count is being set.
&gt; 
&gt; Test output is attached.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;02&nbsp;03:12:39&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;02&nbsp;15:51:08&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Confirmed, except now the skip reason is &#34;1&#34;.

ok 46 # skip 1

Also the test will not run twice.

t/11mysql_common.t ...................... # You need to set the
DBICTEST_MYSQL_INNODB environment variable to test relationships.
DBD::mysql::db do failed: Table &#39;loader_test23&#39; already exists [for
Statement &#34;
            CREATE TABLE LOADER_TEST23 &#40;
                ID INTEGER NOT NULL PRIMARY KEY,
                DAT VARCHAR&#40;32&#41; NOT NULL UNIQUE
            &#41; 
        &#34;] at t/lib/dbixcsl_common_tests.pm line 1428.
# Looks like your test exited with 255 before it could output anything.
t/11mysql_common.t ...................... Dubious, test returned 255
&#40;wstat 65280, 0xff00&#41;
Failed 236/236 subtests 

There were some other failures, I&#39;ve attached the output.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test.out.gz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;02&nbsp;15:51:31&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">PS  This was at 00805149785ad04c1cf3c08f4b26ac0436466ed1
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;03&nbsp;13:47:53&nbsp;2010</span>
    <span class="description">rkitover@cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #56212] Skip test count wrong without DBICTEST_MYSQL_INNODB set</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 3 Apr 2010 13:47:07 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael G Schwern via RT &lt;bug-DBIx-Class-Schema-Loader [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rafael Kitover &lt;rkitover [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, Apr 02, 2010 at 03:51:09PM -0400, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: DBIx-Class-Schema-Loader
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=56212">https://rt.cpan.org/Ticket/Display.html?id=56212</a></span> &gt;
&gt; 
&gt; Confirmed, except now the skip reason is &#34;1&#34;.
&gt; 
&gt; ok 46 # skip 1
&gt; 
&gt; Also the test will not run twice.
&gt; 
&gt; t/11mysql_common.t ...................... # You need to set the
&gt; DBICTEST_MYSQL_INNODB environment variable to test relationships.
&gt; DBD::mysql::db do failed: Table &#39;loader_test23&#39; already exists [for
&gt; Statement &#34;
&gt;             CREATE TABLE LOADER_TEST23 &#40;
&gt;                 ID INTEGER NOT NULL PRIMARY KEY,
&gt;                 DAT VARCHAR&#40;32&#41; NOT NULL UNIQUE
&gt;             &#41; 
&gt;         &#34;] at t/lib/dbixcsl_common_tests.pm line 1428.
&gt; # Looks like your test exited with 255 before it could output anything.
&gt; t/11mysql_common.t ...................... Dubious, test returned 255
&gt; &#40;wstat 65280, 0xff00&#41;
&gt; Failed 236/236 subtests 
&gt; 
&gt; There were some other failures, I&#39;ve attached the output.
&gt; 
</div>
Hi Michael, thanks for running the tests!

I&#39;ve fixed the other fails in your log.

I&#39;m not sure why the table is not getting dropped, as it is supposed to
get dropped on finish, on DESTROY and on create during the next run in
t/lib/dbixcsl_common_tests.pm.

In your mysql shell, can you do:

    CREATE TABLE LOADER_TEST23 &#40;ID INTEGER&#41;;
    DROP TABLE LOADER_TEST23;

in uppercase?

It&#39;s the only uppercase table, maybe that&#39;s the issue, I have no idea.

I&#39;m using MySQL 5.0 on this machine &#40;though should upgrade to 5.5...&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;03&nbsp;22:59:57&nbsp;2010</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #56212] Skip test count wrong without DBICTEST_MYSQL_INNODB set</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 03 Apr 2010 19:59:30 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class-Schema-Loader [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">rkitover@cpan.org via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not sure why the table is not getting dropped, as it is supposed to
&gt; get dropped on finish, on DESTROY and on create during the next run in
&gt; t/lib/dbixcsl_common_tests.pm.
&gt; 
&gt; In your mysql shell, can you do:
&gt; 
&gt;     CREATE TABLE LOADER_TEST23 &#40;ID INTEGER&#41;;
&gt;     DROP TABLE LOADER_TEST23;
&gt; 
&gt; in uppercase?
&gt; 
&gt; It&#39;s the only uppercase table, maybe that&#39;s the issue, I have no idea.
&gt; 
&gt; I&#39;m using MySQL 5.0 on this machine &#40;though should upgrade to 5.5...&#41;
</div>
This is 5.1.42 from MacPorts on OS X.  I believe what&#39;s being run into here is 
MySQL&#39;s schizoid approach to table case sensitivity tied to the filesystem. 
In my case, a case insensitive filesystem means case insensitive table 
names... sort of.

$ mysql5 test
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 91
Server version: 5.1.42 Source distribution

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; describe loader_test23;
</div>ERROR 1146 &#40;42S02&#41;: Table &#39;test.loader_test23&#39; doesn&#39;t exist

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; describe LOADER_TEST23;
</div>ERROR 1146 &#40;42S02&#41;: Table &#39;test.loader_test23&#39; doesn&#39;t exist

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; CREATE TABLE LOADER_TEST23 &#40;ID INTEGER&#41;;
</div>ERROR 1050 &#40;42S01&#41;: Table &#39;loader_test23&#39; already exists

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; DROP TABLE LOADER_TEST23;
</div>ERROR 1051 &#40;42S02&#41;: Unknown table &#39;loader_test23&#39;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; show tables;
</div>+----------------------------+
| Tables_in_test             |
+----------------------------+
| TestVersion                |
| books                      |
| cd                         |
| cd_to_producer             |
| dbix_class_schema_versions |
| foo                        |
| newstuff                   |
| oldstuff                   |
| owners                     |
| producer                   |
+----------------------------+
10 rows in set &#40;0.00 sec&#41;

But it works fine if its not all in upper case.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; CREATE TABLE loader_test23 &#40;ID INTEGER&#41;;
</div>Query OK, 0 rows affected &#40;0.05 sec&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; drop TABLE loader_test23;
</div>Query OK, 0 rows affected &#40;0.00 sec&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; CREATE TABLE LOADER_test23 &#40;ID INTEGER&#41;;
</div>Query OK, 0 rows affected &#40;0.68 sec&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; DROP TABLE LOADER_test23;
</div>Query OK, 0 rows affected &#40;0.00 sec&#41;


It may well be this bug.
<span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.mysql.com/bug.php?id=37402">http://bugs.mysql.com/bug.php?id=37402</a></span>


-- 
Whip me, beat me, make my code compatible with VMS!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;04&nbsp;01:44:02&nbsp;2010</span>
    <span class="description">rkitover@cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #56212] Skip test count wrong without DBICTEST_MYSQL_INNODB set</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 4 Apr 2010 01:43:33 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael G Schwern via RT &lt;bug-DBIx-Class-Schema-Loader [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rafael Kitover &lt;rkitover [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">So you now have a table that doesn&#39;t show up in &#39;show tables&#39; and that
you can&#39;t drop? Awesome.

What would be the solution here, to lowercase table names on OSX?

On Sat, Apr 03, 2010 at 10:59:58PM -0400, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: DBIx-Class-Schema-Loader
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=56212">https://rt.cpan.org/Ticket/Display.html?id=56212</a></span> &gt;
&gt; 
&gt; This is 5.1.42 from MacPorts on OS X.  I believe what&#39;s being run into here is 
&gt; MySQL&#39;s schizoid approach to table case sensitivity tied to the filesystem. 
&gt; In my case, a case insensitive filesystem means case insensitive table 
&gt; names... sort of.
&gt; 
&gt; $ mysql5 test
&gt; Reading table information for completion of table and column names
&gt; You can turn off this feature to get a quicker startup with -A
&gt; 
&gt; Welcome to the MySQL monitor.  Commands end with ; or \g.
&gt; Your MySQL connection id is 91
&gt; Server version: 5.1.42 Source distribution
&gt; 
&gt; Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.
&gt; 
<div class="message-stanza open">&gt; mysql&gt; describe loader_test23;
</div>&gt; ERROR 1146 &#40;42S02&#41;: Table &#39;test.loader_test23&#39; doesn&#39;t exist
&gt; 
<div class="message-stanza open">&gt; mysql&gt; describe LOADER_TEST23;
</div>&gt; ERROR 1146 &#40;42S02&#41;: Table &#39;test.loader_test23&#39; doesn&#39;t exist
&gt; 
<div class="message-stanza open">&gt; mysql&gt; CREATE TABLE LOADER_TEST23 &#40;ID INTEGER&#41;;
</div>&gt; ERROR 1050 &#40;42S01&#41;: Table &#39;loader_test23&#39; already exists
&gt; 
<div class="message-stanza open">&gt; mysql&gt; DROP TABLE LOADER_TEST23;
</div>&gt; ERROR 1051 &#40;42S02&#41;: Unknown table &#39;loader_test23&#39;
&gt; 
<div class="message-stanza open">&gt; mysql&gt; show tables;
</div>&gt; +----------------------------+
&gt; | Tables_in_test             |
&gt; +----------------------------+
&gt; | TestVersion                |
&gt; | books                      |
&gt; | cd                         |
&gt; | cd_to_producer             |
&gt; | dbix_class_schema_versions |
&gt; | foo                        |
&gt; | newstuff                   |
&gt; | oldstuff                   |
&gt; | owners                     |
&gt; | producer                   |
&gt; +----------------------------+
&gt; 10 rows in set &#40;0.00 sec&#41;
&gt; 
&gt; But it works fine if its not all in upper case.
&gt; 
<div class="message-stanza open">&gt; mysql&gt; CREATE TABLE loader_test23 &#40;ID INTEGER&#41;;
</div>&gt; Query OK, 0 rows affected &#40;0.05 sec&#41;
&gt; 
<div class="message-stanza open">&gt; mysql&gt; drop TABLE loader_test23;
</div>&gt; Query OK, 0 rows affected &#40;0.00 sec&#41;
&gt; 
<div class="message-stanza open">&gt; mysql&gt; CREATE TABLE LOADER_test23 &#40;ID INTEGER&#41;;
</div>&gt; Query OK, 0 rows affected &#40;0.68 sec&#41;
&gt; 
<div class="message-stanza open">&gt; mysql&gt; DROP TABLE LOADER_test23;
</div>&gt; Query OK, 0 rows affected &#40;0.00 sec&#41;
&gt; 
&gt; 
&gt; It may well be this bug.
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.mysql.com/bug.php?id=37402">http://bugs.mysql.com/bug.php?id=37402</a></span>
&gt; 
&gt; 
&gt; -- 
&gt; Whip me, beat me, make my code compatible with VMS!
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;04&nbsp;08:28:01&nbsp;2010</span>
    <span class="description">rkitover@cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #56212] Skip test count wrong without DBICTEST_MYSQL_INNODB set</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 4 Apr 2010 08:27:28 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;rkitover [...] cpan.org via RT&#34; &lt;bug-DBIx-Class-Schema-Loader [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rafael Kitover &lt;rkitover [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I just renamed that table to &#39;LOADER_test23&#39;, seems like the easiest
solution and still makes the case-sensitive db tests happy.

On Sun, Apr 04, 2010 at 01:44:03AM -0400, rkitover@cpan.org via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: DBIx-Class-Schema-Loader
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=56212">https://rt.cpan.org/Ticket/Display.html?id=56212</a></span> &gt;
&gt; 
&gt; So you now have a table that doesn&#39;t show up in &#39;show tables&#39; and that
&gt; you can&#39;t drop? Awesome.
&gt; 
&gt; What would be the solution here, to lowercase table names on OSX?
&gt; 
&gt; On Sat, Apr 03, 2010 at 10:59:58PM -0400, Michael G Schwern via RT wrote:
<div class="message-stanza open">&gt; &gt;        Queue: DBIx-Class-Schema-Loader
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=56212">https://rt.cpan.org/Ticket/Display.html?id=56212</a></span> &gt;
&gt; &gt; 
&gt; &gt; This is 5.1.42 from MacPorts on OS X.  I believe what&#39;s being run into here is 
&gt; &gt; MySQL&#39;s schizoid approach to table case sensitivity tied to the filesystem. 
&gt; &gt; In my case, a case insensitive filesystem means case insensitive table 
&gt; &gt; names... sort of.
&gt; &gt; 
&gt; &gt; $ mysql5 test
&gt; &gt; Reading table information for completion of table and column names
&gt; &gt; You can turn off this feature to get a quicker startup with -A
&gt; &gt; 
&gt; &gt; Welcome to the MySQL monitor.  Commands end with ; or \g.
&gt; &gt; Your MySQL connection id is 91
&gt; &gt; Server version: 5.1.42 Source distribution
&gt; &gt; 
&gt; &gt; Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; describe loader_test23;
</div>&gt; &gt; ERROR 1146 &#40;42S02&#41;: Table &#39;test.loader_test23&#39; doesn&#39;t exist
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; describe LOADER_TEST23;
</div>&gt; &gt; ERROR 1146 &#40;42S02&#41;: Table &#39;test.loader_test23&#39; doesn&#39;t exist
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; CREATE TABLE LOADER_TEST23 &#40;ID INTEGER&#41;;
</div>&gt; &gt; ERROR 1050 &#40;42S01&#41;: Table &#39;loader_test23&#39; already exists
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; DROP TABLE LOADER_TEST23;
</div>&gt; &gt; ERROR 1051 &#40;42S02&#41;: Unknown table &#39;loader_test23&#39;
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; show tables;
</div>&gt; &gt; +----------------------------+
&gt; &gt; | Tables_in_test             |
&gt; &gt; +----------------------------+
&gt; &gt; | TestVersion                |
&gt; &gt; | books                      |
&gt; &gt; | cd                         |
&gt; &gt; | cd_to_producer             |
&gt; &gt; | dbix_class_schema_versions |
&gt; &gt; | foo                        |
&gt; &gt; | newstuff                   |
&gt; &gt; | oldstuff                   |
&gt; &gt; | owners                     |
&gt; &gt; | producer                   |
&gt; &gt; +----------------------------+
&gt; &gt; 10 rows in set &#40;0.00 sec&#41;
&gt; &gt; 
&gt; &gt; But it works fine if its not all in upper case.
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; CREATE TABLE loader_test23 &#40;ID INTEGER&#41;;
</div>&gt; &gt; Query OK, 0 rows affected &#40;0.05 sec&#41;
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; drop TABLE loader_test23;
</div>&gt; &gt; Query OK, 0 rows affected &#40;0.00 sec&#41;
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; CREATE TABLE LOADER_test23 &#40;ID INTEGER&#41;;
</div>&gt; &gt; Query OK, 0 rows affected &#40;0.68 sec&#41;
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; mysql&gt; DROP TABLE LOADER_test23;
</div>&gt; &gt; Query OK, 0 rows affected &#40;0.00 sec&#41;
&gt; &gt; 
&gt; &gt; 
&gt; &gt; It may well be this bug.
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.mysql.com/bug.php?id=37402">http://bugs.mysql.com/bug.php?id=37402</a></span>
&gt; &gt; 
&gt; &gt; 
&gt; &gt; -- 
&gt; &gt; Whip me, beat me, make my code compatible with VMS!
&gt; &gt; 
</div>&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;04&nbsp;17:05:21&nbsp;2010</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #56212] Skip test count wrong without DBICTEST_MYSQL_INNODB set</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 04 Apr 2010 14:05:02 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class-Schema-Loader [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">rkitover@cpan.org via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=56212">https://rt.cpan.org/Ticket/Display.html?id=56212</a></span> &gt;
&gt; 
&gt; I just renamed that table to &#39;LOADER_test23&#39;, seems like the easiest
&gt; solution and still makes the case-sensitive db tests happy.
</div>
I pulled the new version of code.  Alas:

$ perl -Ilib t/11mysql_common.t
# You need to set the DBICTEST_MYSQL_INNODB environment variable to test 
relationships.
1..236
DBD::mysql::db do failed: Table &#39;loader_test24&#39; already exists [for Statement &#34;
             CREATE TABLE LoAdEr_test24 &#40;
                 iD INTEGER NOT NULL PRIMARY KEY,
                 DaT VARCHAR&#40;32&#41; NOT NULL UNIQUE
             &#41;
         &#34;] at t/lib/dbixcsl_common_tests.pm line 1459.
# Looks like your test exited with 255 before it could output anything.

So I upgraded MySQL to 5.1.45 and rebuilt all the tables.  Now it works.
Hopefully its a transient bug that messed up my tables.


-- 
I do have a cause though. It&#39;s obscenity. I&#39;m for it.
     - Tom Lehrer
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;10&nbsp;08:31:05&nbsp;2010</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in 0.06000
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;10&nbsp;08:31:08&nbsp;2010</span>
    <span class="description">rkitover [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
