<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #33839 for Perl-Critic: Always unpack @_ first reported wrong for simple sub</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #33839 for Perl-Critic: Always unpack @_ first reported wrong for simple sub</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Perl-Critic/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Perl-Critic/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/Perl-Critic/Perl-Critic/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Critic">Perl-Critic CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">33839</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Perl-Critic/Active/">Perl-Critic</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
lammel [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-25198-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.080    </td>
  </tr>
  <tr id="CF-25199-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;17:49:26&nbsp;2008</span>
    <span class="description">lammel [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Always unpack @_ first reported wrong for simple sub</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When running perlcritic &#40;theme: core, severity: 3&#41; against the attached
file &#40;Catalyst::Plugin::Session::State::QpAPI.pm&#41; always the always
unpack @_ error is reported.

Here is the cli output:
&lt;code&gt;
sh$ perlcritic --profile t/perlcriticrc
lib/Catalyst/Plugin/Session/State/QpAPI.pm -v 9
[Subroutines::RequireArgUnpacking] Always unpack @_ first at line 11,
near &#39;sub get_session_id {&#39;.  &#40;Severity: 4&#41;
&lt;/code&gt;

Also tested with Perl::Critic 1.081_006 with the same result.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> QpAPI.pm</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">package Catalyst::Plugin::Session::State::QpAPI;
use base qw/Catalyst::Plugin::Session::State/;

use strict;
use warnings;

use NEXT;

our $VERSION = &#34;0.1&#34;;

sub get_session_id {
	my &#40;$c&#41; = @_;

	if &#40;$c-&gt;request-&gt;path =~ /^qpapi\//x&#41; {
		my $sid = $c-&gt;request-&gt;param&#40;&#34;sessionid&#34;&#41; || &#34;&#34;;
	    if &#40;$sid&#41; {
	    	$c-&gt;log-&gt;debug&#40;qq/Found sessionid &#34;$sid&#34; in qpapi request/&#41; if $c-&gt;debug;
	        return $sid if $sid;
	    }
	}

    return $c-&gt;NEXT::get_session_id&#40;@_&#41;;
}

1;

__END__

=pod

=head1 NAME

Catalyst::Plugin::Session::State::QpAPI - Maintain session IDs using post params for qpapi path.

=head1 SYNOPSIS

    use Catalyst qw/Session Session::State::QpAPI/;

=head1 DESCRIPTION

In order for L&lt;Catalyst::Plugin::Session&gt; to work the session ID needs to be
stored on the client, and the session data needs to be stored on the server.

This plugin allows retrieval of the sessionid in the post param sessionid.

=head1 METHODS

=over 4

=item get_session_id

=back

=head1 SEE ALSO

L&lt;Catalyst&gt;, L&lt;Catalyst::Plugin::Session&gt;. L&lt;Catalyst::Plugin::Session::State::Cookie&gt;

=head1 AUTHORS

Roland Lammel &lt;lt&gt;rl@brabbel.net&lt;gt&gt;

=head1 COPYRIGHT

This program is free software, you can redistribute it and/or modify it
under the same terms as Perl itself.

=cut

1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;18:00:49&nbsp;2008</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33839] Always unpack @_ first reported wrong for simple sub</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 05 Mar 2008 17:00:04 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Roland Lammel via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When running perlcritic &#40;theme: core, severity: 3&#41; against the attached
&gt; file &#40;Catalyst::Plugin::Session::State::QpAPI.pm&#41; always the always
&gt; unpack @_ error is reported.
</div>
Thanks for this.  I get the same result.  The PPI DOM for the code looks fine, so it appears to be our problem.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;18:00:51&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;18:11:00&nbsp;2008</span>
    <span class="description">lammel [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 05 18:00:49 2008, clonezone wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Roland Lammel via RT wrote:
<div class="message-stanza open">&gt; &gt; When running perlcritic &#40;theme: core, severity: 3&#41; against the
</div>&gt; attached
<div class="message-stanza open">&gt; &gt; file &#40;Catalyst::Plugin::Session::State::QpAPI.pm&#41; always the always
&gt; &gt; unpack @_ error is reported.
</div>&gt; 
&gt; Thanks for this.  I get the same result.  The PPI DOM for the code
&gt; looks fine, so it appears to be our problem.
</div>

After a little further testing with perlcritic I found that the critic
is triggered by passing @_ in the sub &#40;at the end of the get_session_id
sub&#41;.

So the following code actually triggers the critic: 
    return $c-&gt;NEXT::get_session_id&#40;@_&#41;;

After removing it, or replacing it with I tested it, and removing the @_
now shows the file to be ok, no critic is raised anymore.

That probably does not make sense, as passing to SUPER or NEXT is
usually done with the same sub params.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;18:25:53&nbsp;2008</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33839] Always unpack @_ first reported wrong for simple sub</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 05 Mar 2008 17:25:35 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Roland Lammel via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; After a little further testing with perlcritic I found that the critic
&gt; is triggered by passing @_ in the sub &#40;at the end of the get_session_id
&gt; sub&#41;.
&gt; 
&gt; So the following code actually triggers the critic: 
&gt;     return $c-&gt;NEXT::get_session_id&#40;@_&#41;;
&gt; 
&gt; After removing it, or replacing it with I tested it, and removing the @_
&gt; now shows the file to be ok, no critic is raised anymore.
&gt; 
&gt; That probably does not make sense, as passing to SUPER or NEXT is
&gt; usually done with the same sub params.
</div>
Ah.  Hadn&#39;t noticed the other usage of @_.  Yeah, this Policy doesn&#39;t make any exceptions.

So, here&#39;s a question: should we support EVERY&#40;&#41;?

I think we should do this as an exceptions parameter to the Policy.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;18:34:19&nbsp;2008</span>
    <span class="description">lammel [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33839] Always unpack @_ first reported wrong for simple sub</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 6 Mar 2008 00:34:06 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Roland Lammel&#34; &lt;lammel [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Mar 6, 2008 at 12:25 AM, Elliot Shank via RT &lt;
bug-Perl-Critic@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33839">http://rt.cpan.org/Ticket/Display.html?id=33839</a></span> &gt;
&gt;
&gt; Roland Lammel via RT wrote:
<div class="message-stanza open">&gt; &gt; After a little further testing with perlcritic I found that the critic
&gt; &gt; is triggered by passing @_ in the sub &#40;at the end of the get_session_id
&gt; &gt; sub&#41;.
&gt; &gt;
&gt; &gt; So the following code actually triggers the critic:
&gt; &gt;     return $c-&gt;NEXT::get_session_id&#40;@_&#41;;
&gt; &gt;
&gt; &gt; After removing it, or replacing it with I tested it, and removing the @_
&gt; &gt; now shows the file to be ok, no critic is raised anymore.
&gt; &gt;
&gt; &gt; That probably does not make sense, as passing to SUPER or NEXT is
&gt; &gt; usually done with the same sub params.
</div>&gt;
&gt; Ah.  Hadn&#39;t noticed the other usage of @_.  Yeah, this Policy doesn&#39;t make
&gt; any exceptions.
&gt;
&gt; So, here&#39;s a question: should we support EVERY&#40;&#41;?
&gt;
&gt; I think we should do this as an exceptions parameter to the Policy.
&gt;
</div>
Guess that would make sense, as this kind of code &#40;repassing all params to
SUPER&#41; is quite common and it&#39;s a lot of work to add ## no critic
Subroutines;;RequireArgUnpacking to every sub that does that ;-&#41;

Although I don&#39;t really understand what you mean by EVERY&#40;&#41; it is probably
the right thing, if it allows to pass the complete @_ array to another sub
&#40;so delegation and passing up in inheritance would be allowed&#41;.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;19:02:20&nbsp;2008</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33839] Always unpack @_ first reported wrong for simple sub</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 05 Mar 2008 18:01:45 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Roland Lammel via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Guess that would make sense, as this kind of code &#40;repassing all
&gt; params to SUPER&#41; is quite common and it&#39;s a lot of work to add ## no
&gt; critic Subroutines;;RequireArgUnpacking to every sub that does that
&gt; ;-&#41;
&gt; 
&gt; Although I don&#39;t really understand what you mean by EVERY&#40;&#41; it is
&gt; probably the right thing, if it allows to pass the complete @_ array
&gt; to another sub &#40;so delegation and passing up in inheritance would be
&gt; allowed&#41;.
</div>
I just said it because it&#39;s part of the NEXT module.

I think we should just add an exceptions parameter to the Policy with a default value of SUPER. Then you can just add NEXT to that list.  And if anyone comes up with any other fun flow control modules, they can add it to the list.

So, here&#39;s what I think we should have it work:

$self-&gt;SUPER::foo&#40;@_&#41;           # ok
$self-&gt;SUPER::foo&#40;@_, &#39;blah&#39;&#41;   # not ok
$self-&gt;SUPER::foo&#40;bar&#40;@_&#41;&#41;      # not ok

Basically, if there&#39;s anything other than just @_ in the parameters, then it&#39;s still a violation.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;20:33:27&nbsp;2008</span>
    <span class="description">lammel [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33839] Always unpack @_ first reported wrong for simple sub</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 6 Mar 2008 02:33:09 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Roland Lammel&#34; &lt;lammel [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Mar 6, 2008 at 1:02 AM, Elliot Shank via RT &lt;
bug-Perl-Critic@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33839">http://rt.cpan.org/Ticket/Display.html?id=33839</a></span> &gt;
&gt;
&gt; Roland Lammel via RT wrote:
<div class="message-stanza open">&gt; &gt; Guess that would make sense, as this kind of code &#40;repassing all
&gt; &gt; params to SUPER&#41; is quite common and it&#39;s a lot of work to add ## no
&gt; &gt; critic Subroutines;;RequireArgUnpacking to every sub that does that
&gt; &gt; ;-&#41;
&gt; &gt;
&gt; &gt; Although I don&#39;t really understand what you mean by EVERY&#40;&#41; it is
&gt; &gt; probably the right thing, if it allows to pass the complete @_ array
&gt; &gt; to another sub &#40;so delegation and passing up in inheritance would be
&gt; &gt; allowed&#41;.
</div>&gt;
&gt; I just said it because it&#39;s part of the NEXT module.
&gt;
&gt; I think we should just add an exceptions parameter to the Policy with a
&gt; default value of SUPER. Then you can just add NEXT to that list.  And if
&gt; anyone comes up with any other fun flow control modules, they can add it to
&gt; the list.
</div>

I think it would be better to include the known inheritance modules &#40;NEXT,
Class::C3, SUPER&#41;, but that still would not solve the problem in case of
delegation. I have some modules, that simply delegate the complete call to
another module&#39;s class or object method. That would still be not possible.
Is there anything wrong with using just @_ once in the sub with no other
parameters &#40;as proposed below&#41; and not limiting it to SUPER or similar?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; So, here&#39;s what I think we should have it work:
&gt;
&gt; $self-&gt;SUPER::foo&#40;@_&#41;           # ok
&gt; $self-&gt;SUPER::foo&#40;@_, &#39;blah&#39;&#41;   # not ok
&gt; $self-&gt;SUPER::foo&#40;bar&#40;@_&#41;&#41;      # not ok
&gt;
&gt; Basically, if there&#39;s anything other than just @_ in the parameters, then
&gt; it&#39;s still a violation.
</div>

Sound great.
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;21:30:34&nbsp;2008</span>
    <span class="description">perl [...] galumph.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33839] Always unpack @_ first reported wrong for simple sub</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 05 Mar 2008 20:30:16 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Elliot Shank &lt;perl [...] galumph.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Roland Lammel via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think it would be better to include the known inheritance modules 
&gt; &#40;NEXT, Class::C3, SUPER&#41;
</div>
I&#39;ll go along with NEXT because it&#39;s in core, but nothing else.  I&#39;m not going to predict what else out there.  And, again, you can always configure it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; but that still would not solve the problem in case of delegation. I 
&gt; have some modules, that simply delegate the complete call to another 
&gt; module&#39;s class or object method. That would still be not possible. Is
&gt; there anything wrong with using just @_ once in the sub with no
&gt; other parameters &#40;as proposed below&#41; and not limiting it to SUPER or 
&gt; similar?
</div>
There&#39;s already the short_subroutine_statements parameter to the Policy.  I think that&#39;s good enough.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;05&nbsp;21:36:24&nbsp;2008</span>
    <span class="description">chris [...] chrisdolan.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #33839] Always unpack @_ first reported wrong for simple sub </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 5 Mar 2008 20:36:04 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Critic [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chris Dolan &lt;chris [...] chrisdolan.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I recommend that you change the code to this:

sub get_session_id {  ## no critic &#40;Unpack&#41;

Chris

On Mar 5, 2008, at 5:11 PM, Roland Lammel via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;        Queue: Perl-Critic
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=33839">http://rt.cpan.org/Ticket/Display.html?id=33839</a></span> &gt;
&gt;
&gt; On Wed Mar 05 18:00:49 2008, clonezone wrote:
<div class="message-stanza open">&gt;&gt; Roland Lammel via RT wrote:
<div class="message-stanza open">&gt;&gt;&gt; When running perlcritic &#40;theme: core, severity: 3&#41; against the
</div>&gt;&gt; attached
<div class="message-stanza open">&gt;&gt;&gt; file &#40;Catalyst::Plugin::Session::State::QpAPI.pm&#41; always the always
&gt;&gt;&gt; unpack @_ error is reported.
</div>&gt;&gt;
&gt;&gt; Thanks for this.  I get the same result.  The PPI DOM for the code
&gt;&gt; looks fine, so it appears to be our problem.
</div>&gt;
&gt;
&gt; After a little further testing with perlcritic I found that the critic
&gt; is triggered by passing @_ in the sub &#40;at the end of the  
&gt; get_session_id
&gt; sub&#41;.
&gt;
&gt; So the following code actually triggers the critic:
&gt;     return $c-&gt;NEXT::get_session_id&#40;@_&#41;;
&gt;
&gt; After removing it, or replacing it with I tested it, and removing  
&gt; the @_
&gt; now shows the file to be ok, no critic is raised anymore.
&gt;
&gt; That probably does not make sense, as passing to SUPER or NEXT is
&gt; usually done with the same sub params.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;15&nbsp;16:19:39&nbsp;2009</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">In progress

Tom Wyant
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;15&nbsp;19:13:33&nbsp;2009</span>
    <span class="description">wyant [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Proposed fix committed as svn revision 3145. The revised
RequireArgUnpacking allows &#34;$object-&gt;SUPER::foo&#40;@_&#41;&#34; and
&#34;$object-&gt;NEXT::foo&#40;@_&#41;&#34;. Configuration option &#39;allow_delegation_to&#39; has
been added to allow delegation to other places.

Tom Wyant
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;06&nbsp;01:04:08&nbsp;2009</span>
    <span class="description">thaljef [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This has been completed and released in Perl-Critic-1.097_002.

<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~elliotjs/Perl-Critic-1.097_002">http://search.cpan.org/~elliotjs/Perl-Critic-1.097_002</a></span>

Thank you for submitting this ticket.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;06&nbsp;01:04:09&nbsp;2009</span>
    <span class="description">thaljef [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
