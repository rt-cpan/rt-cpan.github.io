<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #52095 for Moose: Native Traits and Coercion</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #52095 for Moose: Native Traits and Coercion</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Moose">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Moose">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Moose">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Moose">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Moose">Moose CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">52095</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Moose">Moose</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">stevan.little [...] gmail.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
perl [...] david-raab.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-38786-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.93    </td>
  </tr>
  <tr id="CF-38787-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




coerce.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/697777/359827/coerce.pl">
Thu Nov 26 11:32:03 2009 (914b) by perl [...] david-raab.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=52095">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-697777" href="/Public/Bug/Display.html?id=52095#txn-697777">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;11:32:03&nbsp;2009</span>
    <span class="description">perl [...] david-raab.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Native Traits and Coercion</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/697777/359824/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/359824">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">In the attachment you see a simple &#34;Person&#34; class that i build with
primary 2 attributes and a self build subtype. The subtype &#34;MyURI&#34; that
needs to be a &#34;URI&#34; class with Coercion from a string.

When i set it to the &#34;url&#34; attribute then everything works like expected.

But when i try to add it with &#34;add_bookmark&#34; then the type failed with
the error message.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Method &#39;url&#39; returned a URI object
&gt; Value <span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span> did not pass container type constraint
&gt; &#39;MyURI&#39; at /home/sidburn/perl510/lib/site_perl/5.10.1/Moose
&gt; /Meta/Attribute/Native/MethodProvider/Array.pm line 129
&gt;
</div>Moose::Meta::Attribute::Native::MethodProvider::Array::__ANON__&#40;&#39;Person=HASH&#40;0x9b7a8c8&#41;&#39;,
&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span>&#39;&#41; called at /home/sidburn/perl510/lib/site_perl
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; /5.10.1/Moose/Meta/Attribute/Native/Trait.pm line 127
&gt;       Person::add_bookmark&#40;&#39;Person=HASH&#40;0x9b7a8c8&#41;&#39;, 
&gt; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span>&#39;&#41; called at ./coerce.pl line 49
</div>
It seems that when i do &#34;add_bookmark&#34; the type &#34;ArrayRef[MyURI]&#34; works
that it only accepts the &#34;MyURI&#34; type, but the coercion from Str does
not get applied.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> coerce.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/697777/359827/coerce.pl">Download coerce.pl</a><br />
<span class="downloadcontenttype">text/x-perl 914b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/env perl
# Core Modules
use strict;
use warnings;
use utf8;

{
    package Person;
    use Moose;
    use Moose::Util::TypeConstraints;
    use URI;
    
    subtype &#39;MyURI&#39;,
        as    &#39;Object&#39;,
        where { $_-&gt;isa&#40;&#39;URI&#39;&#41; };

    coerce &#39;MyURI&#39;,
        from &#39;Str&#39;,
        via  { URI-&gt;new&#40;$_&#41; };
    
    has &#39;url&#39; =&gt; &#40;
        is     =&gt; &#39;rw&#39;,
        isa    =&gt; &#39;MyURI&#39;,
        coerce =&gt; 1,
    &#41;;

    has &#39;bookmarks&#39; =&gt; &#40;
        traits  =&gt; [&#39;Array&#39;],
        is      =&gt; &#39;ro&#39;,
        isa     =&gt; &#39;ArrayRef[MyURI]&#39;,
        default =&gt; sub { [] },
        coerce  =&gt; 1,
        handles =&gt; {
            add_bookmark =&gt; &#39;push&#39;,
        },
    &#41;;
}

my $you = Person-&gt;new;
$you-&gt;url&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span>&#39;&#41;;

if &#40; $you-&gt;url-&gt;isa&#40;&#39;URI&#39;&#41; &#41; { 
    print &#34;Method &#39;url&#39; returned a URI object\n&#34; 
}
else { 
    print &#34;Method &#39;url&#39; is not an URI Object\n&#34; 
}

$you-&gt;add_bookmark&#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span>&#39;&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-697794" href="/Public/Bug/Display.html?id=52095#txn-697794">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;12:07:55&nbsp;2009</span>
    <span class="description">stevan.little [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/697794/359836/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/359836">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is a tricky one actually.

Let me first say that we do not and will never &#40;in the core&#41; support what I call &#34;deep-coercions&#34;. This means that your MyURI type coercion will 
never get applied to an attribute with a ArrayRef[MyURI] type. It is just too much &#34;action at a distance&#34; with the potential for subtly hidden 
bugs and very hard to follow issues. A lot of this has to do with the fact that types are global in Moose and therefore so are coercions. 

It could be argued that the delegated Native trait methods should handle coercions like you are asking for, but personally I think this still has 
the same issues as the deep coercions i mention above and even adds some more. For instance, what if I don&#39;t want all the delegated 
methods to coerce? Exactly what coercions do I want applied? &#40;remember types are global so there can be a coercion defined somewhere you 
don&#39;t know about&#41; So the simple &#40;coerce =&gt; 1&#41; is not sufficient notation to handle the complexity of these options, which means a new feature 
and we have a policy on those &#40;see Moose::Manual::Contributing&#41; where new features need to be vetted through MooseX:: modules first &#40;as 
the native traits feature was via MooseX::AttributeHelpers&#41;. 

So in the end I have to reject this bug and suggest you either write up a MooseX:: to experiment with this feature &#40;come join us on IRC or the 
mailing list and we will be happy to help guide you through the various Moose guts you will need to extend and override&#41;, or you can use the 
&#39;around&#39; method modifier to install your own coercion facility, which would look something like this:

around &#39;add_bookmark&#39; =&gt; sub {
    my $next = shift;
    my $self = shift;
    my $type = find_type_constraint&#40;&#39;MyURI&#39;&#41;;
    $self-&gt;$next&#40; $type-&gt;coerce&#40;shift&#41; &#41;;
};

And remember that the &#39;around&#39; method modifier can take multiple method names too, so you can do:

around &#39;add_bookmark&#39;, &#39;insert_bookmark&#39;, &#39;consume_bookmark&#39; =&gt; sub {
    my $next = shift;
    my $self = shift;
    my $type = find_type_constraint&#40;&#39;MyURI&#39;&#41;;
    $self-&gt;$next&#40; $type-&gt;coerce&#40;shift&#41; &#41;;
};

to stack up a set of methods to apply the coercions for.

- Stevan

On Thu Nov 26 11:32:03 2009, SidBurn wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In the attachment you see a simple &#34;Person&#34; class that i build with
&gt; primary 2 attributes and a self build subtype. The subtype &#34;MyURI&#34;
&gt; that
&gt; needs to be a &#34;URI&#34; class with Coercion from a string.
&gt; 
&gt; When i set it to the &#34;url&#34; attribute then everything works like
&gt; expected.
&gt; 
&gt; But when i try to add it with &#34;add_bookmark&#34; then the type failed with
&gt; the error message.
&gt; 
<div class="message-stanza open">&gt; &gt; Method &#39;url&#39; returned a URI object
&gt; &gt; Value <span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span> did not pass container type constraint
&gt; &gt; &#39;MyURI&#39; at /home/sidburn/perl510/lib/site_perl/5.10.1/Moose
&gt; &gt; /Meta/Attribute/Native/MethodProvider/Array.pm line 129
&gt; &gt;
</div>&gt; Moose::Meta::Attribute::Native::MethodProvider::Array::__ANON__&#40;&#39;Person=HASH&#40;0x9b7a8c8&#41;&#39;,
&gt; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span>&#39;&#41; called at /home/sidburn/perl510/lib/site_perl
<div class="message-stanza open">&gt; &gt; /5.10.1/Moose/Meta/Attribute/Native/Trait.pm line 127
&gt; &gt;     Person::add_bookmark&#40;&#39;Person=HASH&#40;0x9b7a8c8&#41;&#39;,
&gt; &gt; &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.heise.de">http://www.heise.de</a></span>&#39;&#41; called at ./coerce.pl line 49
</div>&gt; 
&gt; It seems that when i do &#34;add_bookmark&#34; the type &#34;ArrayRef[MyURI]&#34;
&gt; works
&gt; that it only accepts the &#34;MyURI&#34; type, but the coercion from Str does
&gt; not get applied.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-697795" href="/Public/Bug/Display.html?id=52095#txn-697795">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;12:07:55&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-697798" href="/Public/Bug/Display.html?id=52095#txn-697798">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;12:07:57&nbsp;2009</span>
    <span class="description">stevan.little [...] gmail.com -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-697799" href="/Public/Bug/Display.html?id=52095#txn-697799">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;26&nbsp;12:07:57&nbsp;2009</span>
    <span class="description">stevan.little [...] gmail.com -  Given to STEVAN</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-698184" href="/Public/Bug/Display.html?id=52095#txn-698184">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;27&nbsp;08:12:06&nbsp;2009</span>
    <span class="description">perl [...] david-raab.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> perl [...] david-raab.de</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/698184/360051/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/360051">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 452b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
thanks for the fast and good Reply.

At the moment i implemented it in my application like you posted it with
the around modifier.

But i think it is good when this statement gets added to the
documentation that deep-coercion is not supported and when you need it
how you can solve it &#40;probably adding a new reciepe?&#41;.

From Christmas to New Year i have Holidays. Maybe i have time to look
how to write a MooseX::* module to archive deep-coercion.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-698185" href="/Public/Bug/Display.html?id=52095#txn-698185">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;27&nbsp;08:12:07&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-736166" href="/Public/Bug/Display.html?id=52095#txn-736166">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;18&nbsp;22:03:37&nbsp;2010</span>
    <span class="description">david.tulloh [...] AirservicesAustralia.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> david.tulloh [...] AirservicesAustralia.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/736166/380315/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/380315">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Nov 26 12:07:55 2009, STEVAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is a tricky one actually.
&gt; 
&gt; Let me first say that we do not and will never &#40;in the core&#41; support
&gt; what I call &#34;deep-coercions&#34;. This means that your MyURI type coercion
&gt; will
&gt; never get applied to an attribute with a ArrayRef[MyURI] type. It is
&gt; just too much &#34;action at a distance&#34; with the potential for subtly
&gt; hidden
&gt; bugs and very hard to follow issues. A lot of this has to do with the
&gt; fact that types are global in Moose and therefore so are coercions.
</div>
I understand the concerns about deep-coercions.

Would you consider implementing a straightforward conversion on an array
subtype &#40;ArrayRefOfMyURI using the prior example&#41;?

The push function actually takes an array, it seems &#40;to me&#41; to be a
relatively safe move to convert the array to an array ref.  So the
coercion could be against the full ArrayRefOfMyURI array.  In the most
common single element use it would simply be a one element array.

This could be applied for the push and shift functions.  Unfortunately
it leaves the insert and set functions with the original problem.  I&#39;m
not sure if you view half support as better than none.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-736446" href="/Public/Bug/Display.html?id=52095#txn-736446">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;19&nbsp;09:39:35&nbsp;2010</span>
    <span class="description">stevan.little [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/736446/380445/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/380445">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry, no I would not consider that, for exactly the reason you state at the end, that this is a half solution and 
leaves the insert and set functions to not work.

Deep Coercions are simply too much &#34;action at a distance&#34;/DWIMery to put in core. This doesn&#39;t mean they are 
not useful, they are just too powerful to be &#34;always on&#34;. 

- Stevan

On Thu Feb 18 22:03:37 2010, david.tulloh@AirservicesAustralia.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Nov 26 12:07:55 2009, STEVAN wrote:
<div class="message-stanza open">&gt; &gt; This is a tricky one actually.
&gt; &gt; 
&gt; &gt; Let me first say that we do not and will never &#40;in the core&#41; support
&gt; &gt; what I call &#34;deep-coercions&#34;. This means that your MyURI type coercion
&gt; &gt; will
&gt; &gt; never get applied to an attribute with a ArrayRef[MyURI] type. It is
&gt; &gt; just too much &#34;action at a distance&#34; with the potential for subtly
&gt; &gt; hidden
&gt; &gt; bugs and very hard to follow issues. A lot of this has to do with the
&gt; &gt; fact that types are global in Moose and therefore so are coercions.
</div>&gt; 
&gt; I understand the concerns about deep-coercions.
&gt; 
&gt; Would you consider implementing a straightforward conversion on an array
&gt; subtype &#40;ArrayRefOfMyURI using the prior example&#41;?
&gt; 
&gt; The push function actually takes an array, it seems &#40;to me&#41; to be a
&gt; relatively safe move to convert the array to an array ref.  So the
&gt; coercion could be against the full ArrayRefOfMyURI array.  In the most
&gt; common single element use it would simply be a one element array.
&gt; 
&gt; This could be applied for the push and shift functions.  Unfortunately
&gt; it leaves the insert and set functions with the original problem.  I&#39;m
&gt; not sure if you view half support as better than none.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-736449" href="/Public/Bug/Display.html?id=52095#txn-736449">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;19&nbsp;09:39:43&nbsp;2010</span>
    <span class="description">stevan.little [...] gmail.com -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.498291</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
