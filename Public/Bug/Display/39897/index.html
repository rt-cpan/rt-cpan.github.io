<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #39897 for DBD-ODBC: String data, right truncation &#40;SQL-01004&#41; in DBD-ODBC 1.17, not in .16</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #39897 for DBD-ODBC: String data, right truncation &#40;SQL-01004&#41; in DBD-ODBC 1.17, not in .16</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBD-ODBC/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBD-ODBC/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBD-ODBC/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBD-ODBC/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-ODBC">DBD-ODBC CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">39897</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBD-ODBC/Active/">DBD-ODBC</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Scott.Stricker [...] NGC.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-10188-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10189-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.16    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Agents.zip<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/517524/258225/Agents.zip">
Wed Oct 08 15:40:15 2008 (3181.3k) by Scott.Stricker [...] NGC.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;08&nbsp;15:40:14&nbsp;2008</span>
    <span class="description">Scott.Stricker [...] NGC.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> String data, right truncation &#40;SQL-01004&#41; in DBD-ODBC 1.17, not
 in .16</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">My environment is 
 - windows xp w/ SP2
 - SQL Server 2005 Developers edition
 - ActiveState perl installed from
ActivePerl-5.10.0.1004-MSWin32-x86-287188.msi
 - DBD-ODBC 1.17

The attached file contains a sql file used to create the table, a text
file used to populate it with
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; bcp perltest..agents in agents.txt -c -U username -P password
</div>and a perl script ag.pl that fetches the id and name from the table.

Running the script using DBD-ODBC 1.17, I get an error
DBD::ODBC::st fetchrow_array failed: [Microsoft][SQL Native
Client]String data, right truncation &#40;SQL-01004&#41; at C:\ag.pl line 16.
after a number of lines are fetched.
 
If I add the line
        $dbh-&gt;{LongReadLen} = 20000;
to ag.pl, I don&#39;t get the error.

I also don&#39;t get the error with the 1.16 version of the odbc module or
if I talk to the database with, for example, the DBD-ADO module.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Agents.zip</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/517524/258225/Agents.zip">Download Agents.zip</a><br />
<span class="downloadcontenttype">application/zip 3.1m</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;03:45:39&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for nor responding earlier but I&#39;ve been away. I&#39;ll take a look at
this today.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;03:45:40&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;06:00:41&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 08 15:40:14 2008, stricsc wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; My environment is 
&gt;  - windows xp w/ SP2
&gt;  - SQL Server 2005 Developers edition
&gt;  - ActiveState perl installed from
&gt; ActivePerl-5.10.0.1004-MSWin32-x86-287188.msi
&gt;  - DBD-ODBC 1.17
&gt; 
&gt; The attached file contains a sql file used to create the table, a text
&gt; file used to populate it with
<div class="message-stanza open">&gt; &gt; bcp perltest..agents in agents.txt -c -U username -P password
</div>&gt; and a perl script ag.pl that fetches the id and name from the table.
&gt; 
&gt; Running the script using DBD-ODBC 1.17, I get an error
&gt; DBD::ODBC::st fetchrow_array failed: [Microsoft][SQL Native
&gt; Client]String data, right truncation &#40;SQL-01004&#41; at C:\ag.pl line 16.
&gt; after a number of lines are fetched.
&gt;  
&gt; If I add the line
&gt;       $dbh-&gt;{LongReadLen} = 20000;
&gt; to ag.pl, I don&#39;t get the error.
&gt; 
&gt; I also don&#39;t get the error with the 1.16 version of the odbc module or
&gt; if I talk to the database with, for example, the DBD-ADO module.
</div>
Thanks for all the data to reproduce this issue. The problem is due to a
change since 1.16 and a border-line case. Your column is a varchar&#40;200&#41;.
1.16 only applied LongReadLen/LongTruncOk to LONG columns &#40;e.g.
long_varchar&#41;. 1.17 applies LongReadLen/LongTruncOk to SQL_VARCHAR
columns too and the column in your data that fails is 81 characters in
size &#40;default LongReadLen is 80&#41;. Previously in 1.16 all of your
varchar&#40;200&#41; would have been retrieved.

I have reverted the accidental change to varchars and it should work as
in 1.16 now. If you&#39;d like a copy of DBD::ODBC 1.17_1 to try let me know.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;08:30:59&nbsp;2008</span>
    <span class="description">Scott.Stricker [...] NGC.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #39897] String data, right truncation &#40;SQL-01004&#41; in DBD-ODBC 1.17, not in .16 </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 10 Oct 2008 07:28:35 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-DBD-ODBC [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Stricker, Scott &#40;C2MS&#41;&#34; &lt;scott.stricker [...] ngc.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Martin:

Thanks for looking into this.  I&#39;d be happy to test the 17_1 version if
I can relatively easily build it into my ActiveState environment. 


E. Scott Stricker
Senior Software Engineer
Northrop Grumman DMS
MailStop 3S02
2340 Dulles Corner Blvd.
Herndon, VA 20171
703-561-3671

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Martin J Evans via RT [mailto:bug-DBD-ODBC@rt.cpan.org] 
Sent: Friday, October 10, 2008 6:01 AM
To: Stricker, Scott &#40;C2MS&#41;
Subject: [rt.cpan.org #39897] String data, right truncation &#40;SQL-01004&#41;
in DBD-ODBC 1.17, not in .16 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=39897">http://rt.cpan.org/Ticket/Display.html?id=39897</a></span> &gt;

On Wed Oct 08 15:40:14 2008, stricsc wrote:
<div class="message-stanza open">&gt; My environment is
&gt;  - windows xp w/ SP2
&gt;  - SQL Server 2005 Developers edition
&gt;  - ActiveState perl installed from
&gt; ActivePerl-5.10.0.1004-MSWin32-x86-287188.msi
&gt;  - DBD-ODBC 1.17
&gt; 
&gt; The attached file contains a sql file used to create the table, a text
</div>
<div class="message-stanza open">&gt; file used to populate it with
<div class="message-stanza open">&gt; &gt; bcp perltest..agents in agents.txt -c -U username -P password
</div>&gt; and a perl script ag.pl that fetches the id and name from the table.
&gt; 
&gt; Running the script using DBD-ODBC 1.17, I get an error DBD::ODBC::st 
&gt; fetchrow_array failed: [Microsoft][SQL Native Client]String data, 
&gt; right truncation &#40;SQL-01004&#41; at C:\ag.pl line 16.
&gt; after a number of lines are fetched.
&gt;  
&gt; If I add the line
&gt;       $dbh-&gt;{LongReadLen} = 20000;
&gt; to ag.pl, I don&#39;t get the error.
&gt; 
&gt; I also don&#39;t get the error with the 1.16 version of the odbc module or
</div>
<div class="message-stanza open">&gt; if I talk to the database with, for example, the DBD-ADO module.
</div>
Thanks for all the data to reproduce this issue. The problem is due to a
change since 1.16 and a border-line case. Your column is a varchar&#40;200&#41;.
1.16 only applied LongReadLen/LongTruncOk to LONG columns &#40;e.g.
long_varchar&#41;. 1.17 applies LongReadLen/LongTruncOk to SQL_VARCHAR
columns too and the column in your data that fails is 81 characters in
size &#40;default LongReadLen is 80&#41;. Previously in 1.16 all of your
varchar&#40;200&#41; would have been retrieved.

I have reverted the accidental change to varchars and it should work as
in 1.16 now. If you&#39;d like a copy of DBD::ODBC 1.17_1 to try let me
know.

Martin
--
Martin J. Evans
Wetherby, UK
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;09:28:16&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Oct 10 08:30:59 2008, stricsc wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Martin:
&gt; 
&gt; Thanks for looking into this.  I&#39;d be happy to test the 17_1 version if
&gt; I can relatively easily build it into my ActiveState environment. 
</div>
ftp://ftp.easysoft.com/pub/DBD-ODBC-1.17_1.tar.gz

I cannot say it will be &#34;relatively easily&#34; - depends. If you are lucky
&#40;and it risks no change to you existing modules&#41;:

o download
o untar
o open command prompt in the MS visual C environment or run vcvars32.bat
o perl Makefile.PL
o nmake
o nmake test

The test now contains an rt_39897.t test for the problem you reported.

If you are unlucky, you won&#39;t have a C compiler or it won&#39;t be the MS
one that is compatible with activate state builds but you should know
that now or pretty soon.

If I don&#39;t hear back to the contrary I&#39;ll mark this bug fixed in 1.17_1
which I intend to release to cpan soon.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;10:10:19&nbsp;2008</span>
    <span class="description">Scott.Stricker [...] NGC.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #39897] String data, right truncation &#40;SQL-01004&#41; in DBD-ODBC 1.17, not in .16 </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 10 Oct 2008 09:07:54 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-DBD-ODBC [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Stricker, Scott &#40;C2MS&#41;&#34; &lt;scott.stricker [...] ngc.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Martin:

You do good work!  Thanks for the fix and the notes on how to build for
the ActiveState environment.  

Test cases ran fine except for the following...

t/20SqlServer...........ok 20/53# DBD::ODBC::st execute failed:
[Microsoft][ODBC SQL Server Driver]Connection is busy with results for
another hstmt &#40;SQL-HY000&#41; at t/20SqlServer.t line 101.
# DSN=dbi:ODBC:DSN=CPM_DB;MARS_Connection=yes;
#
# NOTE: You failed this test because your SQL Server driver
# is too old to handle the MARS_Connection attribute. This test cannot
# easily skip this test for old drivers as there is no definite SQL
Server
# driver version it can check.
# 

And testing with my software indicates no problems.

For me, hard part was finding vcvars32.bat &#40;was in C:\Program
Files\Microsoft Visual Studio 9.0\VC\bin&#41; and
Setting up DBI_DSN &#40;=dbi:ODBC:CPM_DB in my environment&#41;, DBI_USER and
DBI_PASS.  Never had occasion to use any of that before.

Thanks again for the quick turnaround.

Any idea when it will be available in the ActiveState repositories, and
do you forsee it being versioned as 1.17.1?

E. Scott Stricker
Senior Software Engineer
Northrop Grumman DMS
MailStop 3S02
2340 Dulles Corner Blvd.
Herndon, VA 20171
703-561-3671

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Martin J Evans via RT [mailto:bug-DBD-ODBC@rt.cpan.org] 
Sent: Friday, October 10, 2008 9:28 AM
To: Stricker, Scott &#40;C2MS&#41;
Subject: [rt.cpan.org #39897] String data, right truncation &#40;SQL-01004&#41;
in DBD-ODBC 1.17, not in .16 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=39897">http://rt.cpan.org/Ticket/Display.html?id=39897</a></span> &gt;

On Fri Oct 10 08:30:59 2008, stricsc wrote:
<div class="message-stanza open">&gt; Martin:
&gt; 
&gt; Thanks for looking into this.  I&#39;d be happy to test the 17_1 version 
&gt; if I can relatively easily build it into my ActiveState environment.
</div>
ftp://ftp.easysoft.com/pub/DBD-ODBC-1.17_1.tar.gz

I cannot say it will be &#34;relatively easily&#34; - depends. If you are lucky
&#40;and it risks no change to you existing modules&#41;:

o download
o untar
o open command prompt in the MS visual C environment or run vcvars32.bat
o perl Makefile.PL o nmake o nmake test

The test now contains an rt_39897.t test for the problem you reported.

If you are unlucky, you won&#39;t have a C compiler or it won&#39;t be the MS
one that is compatible with activate state builds but you should know
that now or pretty soon.

If I don&#39;t hear back to the contrary I&#39;ll mark this bug fixed in 1.17_1
which I intend to release to cpan soon.

Martin
--
Martin J. Evans
Wetherby, UK
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;10:31:43&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Oct 10 10:10:19 2008, stricsc wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Martin:
&gt; 
&gt; You do good work!  Thanks for the fix and the notes on how to build for
&gt; the ActiveState environment.  
&gt; 
&gt; Test cases ran fine except for the following...
&gt; 
&gt; t/20SqlServer...........ok 20/53# DBD::ODBC::st execute failed:
&gt; [Microsoft][ODBC SQL Server Driver]Connection is busy with results for
&gt; another hstmt &#40;SQL-HY000&#41; at t/20SqlServer.t line 101.
&gt; # DSN=dbi:ODBC:DSN=CPM_DB;MARS_Connection=yes;
&gt; #
&gt; # NOTE: You failed this test because your SQL Server driver
&gt; # is too old to handle the MARS_Connection attribute. This test cannot
&gt; # easily skip this test for old drivers as there is no definite SQL
&gt; Server
&gt; # driver version it can check.
</div>
I would presume because your SQL server ODBC driver does not support
MARS_Connection attribute - although I&#39;m a little surprised since I
thought the code you sent me suggested you were using the native client.
Anyway, it only means you cannot use multiple active statements by
defining the MARS_Connection attribute.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; And testing with my software indicates no problems.
&gt; 
&gt; For me, hard part was finding vcvars32.bat &#40;was in C:\Program
&gt; Files\Microsoft Visual Studio 9.0\VC\bin&#41; and
&gt; Setting up DBI_DSN &#40;=dbi:ODBC:CPM_DB in my environment&#41;, DBI_USER and
&gt; DBI_PASS.  Never had occasion to use any of that before.
</div>
Quite surprised you got that far. I&#39;ve had loads of problems making perl
XS modules work with activestate perl when I&#39;ve had to build them. They
compile and dlls are produced but they won&#39;t run. In the end I gave up
and built my own perl for windows.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks again for the quick turnaround.
</div>
no problem. 1.17 was a massive change from 1.16 so I expected some
issues which is why I woke up when I saw this issue.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Any idea when it will be available in the ActiveState repositories, and
&gt; do you forsee it being versioned as 1.17.1?
</div>
I&#39;m afraid not as I don&#39;t control activestate and in any case I&#39;m not
sure they build development &#40;ones ending in _N&#41; releases. If I could
persuade more people to test development releases in real conditions
then I&#39;d release a full &#40;non-development&#41; release more regularly. This
time around I&#39;m likely to go to 1.18 pretty quickly as this rt and the
other one you posted in could be quite annoying for some people.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;11:07:55&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;10&nbsp;11:07:56&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Broken in 1.17 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
