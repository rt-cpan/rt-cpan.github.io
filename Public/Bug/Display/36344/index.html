<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #36344 for NetAddr-IP: Comparisons Don&#39;t take CIDR Notations into account</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #36344 for NetAddr-IP: Comparisons Don&#39;t take CIDR Notations into account</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/NetAddr-IP/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/NetAddr-IP/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/NetAddr-IP/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/NetAddr-IP/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/NetAddr-IP">NetAddr-IP CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">36344</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">2 hours (120 min)

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/NetAddr-IP/Active/">NetAddr-IP</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
peter [...] devries.tv

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23470-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23471-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;01&nbsp;23:22:44&nbsp;2008</span>
    <span class="description">peter [...] devries.tv -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Comparisons Don&#39;t take CIDR Notations into account</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 1 Jun 2008 23:22:20 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-NetAddr-IP [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Peter DeVries&#34; &lt;peter [...] devries.tv&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When doing comparisons on two networks the CIDR notation is not taken into
consideration as documented:

&#34;Internally, all network objects are represented in 128 bit format. The
numeric representation of the network is compared through the corresponding
operation. Comparisons are tried first on the address portion of the object
and if that is equal then the cidr portion of the masks are compared.&#39;

For example 10.10.10.0/24 and 10.10.10.0/16 are considered equal.  Using &lt; &gt;
also fail to work.

Here is the small test I&#39;ve written.

##### Code #######
#!/usr/bin/perl

use NetAddr::IP;

$IP1 = &#39;10.10.10.0&#39;;   # Can also be defined in CIDR notation -
10.10.10.0/24
$IP2 = &#39;10.10.10.0&#39;;

$NETADDRIP1 = new NetAddr::IP &#34;$IP1&#34;, &#39;255.255.255.0&#39;;
$NETADDRIP2 = new NetAddr::IP &#34;$IP2&#34;, &#39;255.255.0.0&#39;;

if &#40;$NETADDRIP1 = $NETADDRIP2&#41; { print &#34;equal\n&#34;;};
if &#40;$NETADDRIP1 &lt; $NETADDRIP2&#41; { print &#34;Less Than\n&#34;;};
if &#40;$NETADDRIP1 &gt; $NETADDRIP2&#41; { print &#34;Greater Than\n&#34;;};
#################

I would expect the answer to be &#34;Less Than&#34; but it is in fact &#34;equal&#34; &#40;BTW
I&#39;ve tested with the variables defined as CIDR notation as well ie. $IP1 = &#39;
10.10.10.0/24&#39;;&#41;

NetAddr::IP version is 4.007
Perl Version 5.8.4
OS - Solaris 10

Thanks for any help,
Peter
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;02&nbsp;00:05:28&nbsp;2008</span>
    <span class="description">peter [...] devries.tv -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #36344] AutoReply: Comparisons Don&#39;t take CIDR Notations into account</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Jun 2008 00:04:25 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-NetAddr-IP [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Peter DeVries&#34; &lt;peter [...] devries.tv&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Quick Followup.  it looks like the documentation on:
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~luismunoz/NetAddr-IP-4.007/IP.pm">http://search.cpan.org/~luismunoz/NetAddr-IP-4.007/IP.pm</a></span>
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;02&nbsp;00:10:34&nbsp;2008</span>
    <span class="description">peter [...] devries.tv -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #36344] AutoReply: Comparisons Don&#39;t take CIDR Notations into account</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Jun 2008 00:09:17 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-NetAddr-IP [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Peter DeVries&#34; &lt;peter [...] devries.tv&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry for the multiple messages.  I fat fingered the last one.

My first issue of &gt; &lt; not working seems to be a documentation issue.
On this page:
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~luismunoz/NetAddr-IP-4.007/IP.pm">http://search.cpan.org/~luismunoz/NetAddr-IP-4.007/IP.pm</a></span> it says:

&#34;Comparison via &gt;, &lt;, &gt;=, &lt;=, &lt;=&gt; and cmp

Internally, all network objects are represented in 128 bit format. The
numeric representation of the network is compared through the
corresponding operation. Comparisons are tried first on the address
portion of the object and if that is equal then the cidr portion of
the masks are compared.&#34;

However in the module it says:

&#34;Comparison via E&lt;gt&gt;, E&lt;lt&gt;, E&lt;gt&gt;=, E&lt;lt&gt;=, E&lt;lt&gt;=E&lt;gt&gt; and C&lt;cmp&gt;&gt;

Internally, all network objects are represented in 128 bit format.
The numeric representation of the network is compared through the
corresponding operation. Comparisons are tried first on the address portion
of the object and if that is equal then the cidr portion of the masks are
compared.&#34;

The documentation in the module is correct.

However that is only half the issue.  When comparing 10.10.0.0/16 to
10.10.0.0/24, 10.10.0.0/24 is considered the greater value.  The logic
in the module should change to account for the fact that the smaller
the CIDR notation the larger the network.

Thanks again.
Peter
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;21&nbsp;19:06:24&nbsp;2008</span>
    <span class="description">michael [...] bizsystems.com -  Correspondence added</span>
    <span class="time-taken">120 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jun 01 23:22:44 2008, peter@devries.tv wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When doing comparisons on two networks the CIDR notation is not taken into
&gt; consideration as documented:
&gt; 
&gt; &#34;Internally, all network objects are represented in 128 bit format. The
&gt; numeric representation of the network is compared through the
</div>corresponding
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; operation. Comparisons are tried first on the address portion of the
</div>object
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; and if that is equal then the cidr portion of the masks are compared.&#39;
&gt; 
&gt; For example 10.10.10.0/24 and 10.10.10.0/16 are considered equal. 
</div>Using &lt; &gt;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; also fail to work.
&gt; 
&gt; Here is the small test I&#39;ve written.
&gt; 
&gt; ##### Code #######
&gt; #!/usr/bin/perl
&gt; 
&gt; use NetAddr::IP;
&gt; 
&gt; $IP1 = &#39;10.10.10.0&#39;;   # Can also be defined in CIDR notation -
&gt; 10.10.10.0/24
&gt; $IP2 = &#39;10.10.10.0&#39;;
&gt; 
&gt; $NETADDRIP1 = new NetAddr::IP &#34;$IP1&#34;, &#39;255.255.255.0&#39;;
&gt; $NETADDRIP2 = new NetAddr::IP &#34;$IP2&#34;, &#39;255.255.0.0&#39;;
&gt; 
&gt; if &#40;$NETADDRIP1 = $NETADDRIP2&#41; { print &#34;equal\n&#34;;};
&gt; if &#40;$NETADDRIP1 &lt; $NETADDRIP2&#41; { print &#34;Less Than\n&#34;;};
&gt; if &#40;$NETADDRIP1 &gt; $NETADDRIP2&#41; { print &#34;Greater Than\n&#34;;};
&gt; #################
&gt; 
&gt; I would expect the answer to be &#34;Less Than&#34; but it is in fact &#34;equal&#34; &#40;BTW
&gt; I&#39;ve tested with the variables defined as CIDR notation as well ie.
</div>$IP1 = &#39;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 10.10.10.0/24&#39;;&#41;
&gt; 
&gt; NetAddr::IP version is 4.007
&gt; Perl Version 5.8.4
&gt; OS - Solaris 10
&gt; 
&gt; Thanks for any help,
&gt; Peter
</div>

Version 4.008 now takes CIDR comparisons into account. The result is
probably not what you expect.    

i.e. CIDR /24 &gt; /16

This may seem counterintuitive, however it is consistent with the intent
of sorting network ranges from less specific to more specific. It is
also necessary for the proper operation of Coalesce and Compact.

In general, network comparisons should be done using &#39;masklen&#39; since the
comparison of netaddr objects with differing CIDR&#39;s will result in
inconsistent results dependent on the IP portion of the object. Those
results are not logical in any sense of the word when IP&#39;s of differing
&#40;with some &#39;equal&#39;&#41; are compared as a group in a &#39;sort&#39;;

The NetAddr documentation has been updated to clarify both of these points.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;21&nbsp;19:06:25&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;21&nbsp;19:06:26&nbsp;2008</span>
    <span class="description">michael [...] bizsystems.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
