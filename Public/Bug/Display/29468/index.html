<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #29468 for libwww-perl: IPv6 support?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #29468 for libwww-perl: IPv6 support?</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/libwww-perl/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/libwww-perl">libwww-perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">29468</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/libwww-perl/Active/">libwww-perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jtk [...] us.ibm.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
dom [...] cpan.org

<br />
MXEY [...] cpan.org

<br />
ONEGRAY [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-18330-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-18331-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;18&nbsp;09:53:16&nbsp;2007</span>
    <span class="description">jtk [...] us.ibm.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> IPv6 support?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> 18 Sep 2007 09:52:31 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libwww-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jtk [...] us.ibm.com &#40;John T. Kohl&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">libwww-perl-5.808 doesn&#39;t support IPv6 connections.
I believe the following would do it:

* use IO::Socket::INET6 in place of IO::Socket::INET  &#40;note, INET6
  depends on Socket6&#41;
  Are you willing to make this a dependency?
  &#40;I&#39;m not a perl expert&#41; Is there a way to make it use INET6 if
  present, but INET if not?

* update URL host-name parsing to tolerate IPv6 literal addresss in the
  URLs. &#40;See RFC2732&#41;

-- 
John Kohl
Senior Software Engineer - Rational Software - IBM Software Group
Lexington, Massachusetts, USA
jtk@us.ibm.com
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.ibm.com/software/rational/">http://www.ibm.com/software/rational/</a></span>&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;20&nbsp;22:06:41&nbsp;2008</span>
    <span class="description">andrejohn.mas [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andrejohn.mas [...] gmail.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Sep 18 09:53:16 2007, jtk@us.ibm.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; libwww-perl-5.808 doesn&#39;t support IPv6 connections.
&gt; I believe the following would do it:
&gt; 
&gt; * use IO::Socket::INET6 in place of IO::Socket::INET  &#40;note, INET6
&gt;   depends on Socket6&#41;
&gt;   Are you willing to make this a dependency?
&gt;   &#40;I&#39;m not a perl expert&#41; Is there a way to make it use INET6 if
&gt;   present, but INET if not?
&gt; 
&gt; * update URL host-name parsing to tolerate IPv6 literal addresss in the
&gt;   URLs. &#40;See RFC2732&#41;
&gt; 
</div>
I have made some changes for this, but not being an expert Perl programmer there are still 
some issues, like minor failing of the tests. At the same time the changes allow me to use 
the w3c validator with both IPv4 and IPv6 sites:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.geocities.com/ajmas/software/libwww-perl-5.808-ipv6.tgz">http://www.geocities.com/ajmas/software/libwww-perl-5.808-ipv6.tgz</a></span>

I have also added diffs relative to 5.808.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;20&nbsp;22:06:45&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;03&nbsp;13:11:59&nbsp;2008</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If IO::Socket::INET6 was that compatible, why would we not just replace
IO::Socket::INET in the perl core?  There must be some drawback to this
that prevent that approach.  Need to analyze what breaks before
something like this is tried.

A possibility could be to rework Net::HTTP so that it&#39;s not a subclass
of IO::Socket, but that certainly has it&#39;s own issues.

We also have other protocol modules &#40;eg for the handling of ftp:&#41; that
need treatment.

One possibility is to just introduce a separate experimental protocol
driver that runs http over IP6 as a start.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;07&nbsp;21:39:30&nbsp;2008</span>
    <span class="description">andrejohn.mas [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andrejohn.mas [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Could this be done in a two stage process? Basically at this point in
time we would use IO::Socket::INET6 and then if IO::Socket::INET was
ever modified to make INET6 an integral part then we would migrate there.

One obvious breakage point would if anyone assumes that they are getting
an IPv4 address and end up getting IPv6. Then again in this context it
is probably an indication that the developer needs to be updating their
program, since even with a non-IPv6 enabled version their program would
break.

Anything that at this point in time can allow people to play around with
IPv6 is a good thing. There certainly seems to be a few people in the
w3c-validator team who would be interested in this, for starters.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;24&nbsp;09:03:25&nbsp;2011</span>
    <span class="description">dom [...] cpan.org -  Cc DOM added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;24&nbsp;09:24:04&nbsp;2011</span>
    <span class="description">MXEY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This bug has also been filed in Debian at
<span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=614948">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=614948</a></span>. Unfortunately,
I cannot add 614948@bugs.debian.org as Cc to this bug.

There has been no activity in over two years, but IPv6 support is
becoming more important every day. Are there plans to tackle this bug at
all?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;24&nbsp;09:25:57&nbsp;2011</span>
    <span class="description">MXEY [...] cpan.org -  Cc MXEY added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;29&nbsp;11:51:34&nbsp;2012</span>
    <span class="description">ONEGRAY [...] cpan.org -  Cc ONEGRAY added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;29&nbsp;11:52:13&nbsp;2012</span>
    <span class="description">oneingray [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Ivan Shmakov &lt;oneingray [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #29468] IPv6 support? &#40;patch&#41; </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 29 Mar 2012 22:51:58 +0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libwww-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ivan Shmakov &lt;oneingray [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">        [I know, I&#39;ve messed it up.  Sorry.  This one was previously
        added to #76044 by mistake.  Also to note that this bug is
        discussed at <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/306914">http://bugs.debian.org/306914</a></span>.]

        The way I&#39;ve dealt with the problem [1] is by requiring
        IO::Socket::INET6 first, while still allowing the code to fall
        back to IO::Socket::INET.  &#40;Just like Net::HTTP already falls
        back to IO::Socket if IO::Socket::INET is itself unavailable.&#41;

        The patch I&#39;m using is MIME&#39;d.

[1] <span class="clickylink"><a target="new" rel="nofollow" href="http://permalink.gmane.org/gmane.comp.lang.perl.modules.lwp/2556">http://permalink.gmane.org/gmane.comp.lang.perl.modules.lwp/2556</a></span>

-- 
FSF associate member #7257
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- HTTP.pm.~1~ 2012-02-17 03:17:26.000000000 +0700
+++ HTTP.pm     2012-03-27 17:05:37.000000000 +0700
@@ -5,8 +5,13 @@
 
 $VERSION = &#34;6.03&#34;;
 unless &#40;$SOCKET_CLASS&#41; {
-    eval { require IO::Socket::INET } || require IO::Socket;
-    $SOCKET_CLASS = &#34;IO::Socket::INET&#34;;
+    if &#40;eval { require IO::Socket::INET6 }&#41; {
+        $SOCKET_CLASS = &#34;IO::Socket::INET6&#34;;
+    } else {
+        eval { require IO::Socket::INET }
+            || require IO::Socket;
+        $SOCKET_CLASS = &#34;IO::Socket::INET&#34;;
+    }
 }
 require Net::HTTP::Methods;
 require Carp;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;16&nbsp;12:44:58&nbsp;2012</span>
    <span class="description">andrejohn.mas [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andrejohn.mas [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Given 6 June 12 is being treated as the global IPv6 launch day &#40;
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.worldipv6launch.org/">http://www.worldipv6launch.org/</a></span> &#41;, I am curious as to where libwww
stands with official IPv6 support. This ticket has been open since 2007.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;20&nbsp;07:57:56&nbsp;2012</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> andrejohn.mas [...] gmail.com, oneingray [...] gmail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">You may want to know about IO::Socket::IP, rather than ::INET6.

IO::Socket::IP is a drop-in replacement of IO::Socket::INET that also 
supports IPv6. There have been long discussions on why it is unsuitable 
to simply update ::INET to do IPv6 as well - they are elsewhere.

To support IPv6 in LWP should be a simple matter of changing the &#39;use&#39; 
and constructor lines simply with

 s/IO::Socket::INET/IO::Socket::IP/g

IO::Socket::IP is not /yet/ core, but has no non-core dependencies. I 
have submitted it for inclusion in core, so it may end up being core 
sometime in 5.17, for release in 5.18.

Additionally, you may wish to note the class method

  my &#40; $host, $port &#41; = IO::Socket::IP-&gt;split_addr&#40; &#34;[::1]:80&#34; &#41;;

Will correctly split hostname or address-literal and port combinations 
for both IPv4 and IPv6.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;12&nbsp;14:37:26&nbsp;2013</span>
    <span class="description">ONEGRAY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">2012-06-20 07:57:56, PEVANS писал:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; You may want to know about IO::Socket::IP, rather than ::INET6.
</div>
FTR, the logic of the patch I’ve suggested above could &#40;obviously&#41; be extended to select either of the available IPv6-capable modules, or to fall back to IO::Socket::INET should no neither module be found.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; IO::Socket::IP is a drop-in replacement of IO::Socket::INET that also supports IPv6.
</div>
AIUI, IO::Socket::INET6 also supports both IPv6 and IPv4.

But for the time being &#40;and it’s already quite a while&#41;, I’m just using a trivial workaround in my published code; check, for instance, <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/ONEGRAY/head-r-0.1/head-r">https://metacpan.org/source/ONEGRAY/head-r-0.1/head-r</a></span>.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;18&nbsp;16:46:37&nbsp;2014</span>
    <span class="description">Mark.Martinec [...] ijs.si -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark.Martinec [...] ijs.si</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Don&#39;t bother with oldish IO::Socket::INET6, just use IO::Socket::IP for both protocol families if the module is available, otherwise fall back to IO::Socket::INET.

The IO::Socket::IP is a Perl core module since Perl version 5.19.8, is compatible with IO::Socket::INET, works very well and is being actively maintained, and is easily installable for older versions of Perl.

The IO::Socket::IP &#40;in place of IO::Socket::INET&#41; is now used in modules like HTTP::Tiny and Mail::SpamAssassin.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;18&nbsp;17:17:13&nbsp;2014</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #29468] IPv6 support?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 18 Mar 2014 14:16:58 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Mark.Martinec [...] ijs.si via RT&#34; &lt;bug-libwww-perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karen Etheridge &lt;ether [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Mar 18, 2014 at 04:46:38PM -0400, Mark.Martinec@ijs.si via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Don&#39;t bother with oldish IO::Socket::INET6
</div>
We really ought to get a deprecation notice on IO::Socket::INET6 so others
aren&#39;t confused down the road.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;16&nbsp;06:22:33&nbsp;2014</span>
    <span class="description">http://kubrat.myopenid.com/ -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> val [...] bogda.co.uk</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Here&#39;s what I had to do to make LWP work with IPv6 addresses. It&#39;s not much but the change to LWP::Protocol::http is worrying me a bit because I don&#39;t understand why it would not work without it.

Regards,
kubrat
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> LWP-Protocol-http_patch.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/LWP/Protocol/http.pm
+++ lib/LWP/Protocol/http.pm
@@ -21,20 +21,21 @@
 	if &#40;my $sock = $conn_cache-&gt;withdraw&#40;$self-&gt;socket_type, &#34;$host:$port&#34;&#41;&#41; {
 	    return $sock if $sock &#38;&#38; !$sock-&gt;can_read&#40;0&#41;;
 	    # if the socket is readable, then either the peer has closed the
 	    # connection or there are some garbage bytes on it.  In either
 	    # case we abandon it.
 	    $sock-&gt;close;
 	}
     }
 
     local&#40;$^W&#41; = 0;  # IO::Socket::INET can be noisy
+    $host = &#34;[$host]&#34; if $host =~ m/:/;
     my $sock = $self-&gt;socket_class-&gt;new&#40;PeerAddr =&gt; $host,
 					PeerPort =&gt; $port,
 					LocalAddr =&gt; $self-&gt;{ua}{local_address},
 					Proto    =&gt; &#39;tcp&#39;,
 					Timeout  =&gt; $timeout,
 					KeepAlive =&gt; !!$conn_cache,
 					SendTE    =&gt; 1,
 					$self-&gt;_extra_sock_opts&#40;$host, $port&#41;,
 				       &#41;;
 
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net-HTTP_patch.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/Net/HTTP.pm
+++ lib/Net/HTTP.pm
@@ -1,19 +1,19 @@
 package Net::HTTP;
 
 use strict;
 use vars qw&#40;$VERSION @ISA $SOCKET_CLASS&#41;;
 
 $VERSION = &#34;6.01&#34;;
 unless &#40;$SOCKET_CLASS&#41; {
-    eval { require IO::Socket::INET } || require IO::Socket;
-    $SOCKET_CLASS = &#34;IO::Socket::INET&#34;;
+    eval { require IO::Socket::IP } || require IO::Socket;
+    $SOCKET_CLASS = &#34;IO::Socket::IP&#34;;
 }
 require Net::HTTP::Methods;
 require Carp;
 
 @ISA = &#40;$SOCKET_CLASS, &#39;Net::HTTP::Methods&#39;&#41;;
 
 sub new {
     my $class = shift;
     Carp::croak&#40;&#34;No Host option provided&#34;&#41; unless @_;
     $class-&gt;SUPER::new&#40;@_&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;22&nbsp;17:40:13&nbsp;2014</span>
    <span class="description">jfesler [...] gigo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jfesler [...] gigo.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I humbly offer:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/libwww-perl/net-http/pull/10">https://github.com/libwww-perl/net-http/pull/10</a></span>
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/libwww-perl/libwww-perl/pull/58">https://github.com/libwww-perl/libwww-perl/pull/58</a></span>

The combination will use IO::Socket::IP or IO::Socket::INET6 &#40;if found&#41;; and uses URI to do host address parsing &#40;in order to correctly parse [2001:db8::1]:80&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;25&nbsp;18:39:35&nbsp;2014</span>
    <span class="description">jfesler [...] gigo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jfesler [...] gigo.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">My patches appear to be accepted, and a new release produced.

Please consider updating to these packages:

Net::HTTP &#40;6.07&#41;
LWP &#40;6.080
URI &#40;1.64&#41;
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
