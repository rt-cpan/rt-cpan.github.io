<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #6672 for MusicBrainz-Client: Client not parsing RDF properly?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #6672 for MusicBrainz-Client: Client not parsing RDF properly?</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/MusicBrainz-Client/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/MusicBrainz-Client/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/MusicBrainz-Client/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/MusicBrainz-Client/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/MusicBrainz-Client">MusicBrainz-Client CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">6672</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">2 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/MusicBrainz-Client/Active/">MusicBrainz-Client</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">svanzoest [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
andy [...] hybridized.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-22100-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.08    </td>
  </tr>
  <tr id="CF-22101-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;15:30:29&nbsp;2004</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Client not parsing RDF properly?</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks, the module now runs without any errors.  However, now I am trying to use the following code which is returning no results.  It gets the RDF data from MB just fine, but doesn&#39;t appear to be parsing it properly.

my $mb = MusicBrainz::Client-&gt;new; 
$mb-&gt;set_debug&#40;1&#41;;
if &#40; !$mb-&gt;query_with_args&#40; MBQ_GetAlbumById, [ &#39;cb36140d-2202-4170-8649-c2e1c20d9d96&#39; ] &#41; &#41; {
        die&#40;&#34;Query failed: &#34;, $mb-&gt;get_query_error&#40;&#41;, &#34;\n&#34;&#41;;
}
print &#34;Amazon Cover URL: &#34; . $mb-&gt;get_result_data&#40;MBE_AlbumGetAmazonCoverartURL&#41; . &#34;\n&#34;;

Output:

  url: <span class="clickylink"><a target="new" rel="nofollow" href="http://mm.musicbrainz.org:80/mm-2.1/album/cb36140d-2202-4170-8649-c2e1c20d9d96/2">http://mm.musicbrainz.org:80/mm-2.1/album/cb36140d-2202-4170-8649-c2e1c20d9d96/2</a></span>
query: 

result: &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;rdf:RDF xmlns:rdf = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;">http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;</a></span>
         xmlns:dc  = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></span>&#34;
         xmlns:mq  = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/mm/mq-1.1#&#34;">http://musicbrainz.org/mm/mq-1.1#&#34;</a></span>
         xmlns:mm  = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/mm/mm-2.1#&#34;">http://musicbrainz.org/mm/mm-2.1#&#34;</a></span>
         xmlns:az  = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.amazon.com/gp/aws/landing.html#&#34;&gt;">http://www.amazon.com/gp/aws/landing.html#&#34;&gt;</a></span>
  &lt;mq:Result&gt;
    &lt;mq:status&gt;OK&lt;/mq:status&gt;
    &lt;mm:albumList&gt;
      &lt;rdf:Bag&gt;
        &lt;rdf:li rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/album/cb36140d-2202-4170-8649-c2e1c20d9d96">http://musicbrainz.org/album/cb36140d-2202-4170-8649-c2e1c20d9d96</a></span>&#34;/&gt;
      &lt;/rdf:Bag&gt;
    &lt;/mm:albumList&gt;

  &lt;/mq:Result&gt;
  &lt;mm:Album rdf:about=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/album/cb36140d-2202-4170-8649-c2e1c20d9d96">http://musicbrainz.org/album/cb36140d-2202-4170-8649-c2e1c20d9d96</a></span>&#34;&gt;
    &lt;dc:title&gt;Mind Fruit&lt;/dc:title&gt;
    &lt;dc:creator rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/artist/89240fa8-7e01-490f-8b4c-59f3f488eec6">http://musicbrainz.org/artist/89240fa8-7e01-490f-8b4c-59f3f488eec6</a></span>&#34;/&gt;
    &lt;mm:cdindexidList&gt;
      &lt;rdf:Bag&gt;
        &lt;rdf:li rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/cdindex/b3Wz.nJkbWNBfE6FyAFvRyE6M2c-">http://musicbrainz.org/cdindex/b3Wz.nJkbWNBfE6FyAFvRyE6M2c-</a></span>&#34;/&gt;
      &lt;/rdf:Bag&gt;
    &lt;/mm:cdindexidList&gt;
    &lt;mm:releaseType rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/mm/mm-2.1#TypeAlbum&#34;/&gt;">http://musicbrainz.org/mm/mm-2.1#TypeAlbum&#34;/&gt;</a></span>
    &lt;mm:releaseStatus rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://musicbrainz.org/mm/mm-2.1#StatusOfficial&#34;/&gt;">http://musicbrainz.org/mm/mm-2.1#StatusOfficial&#34;/&gt;</a></span>
    &lt;mm:releaseDateList&gt;
      &lt;rdf:Seq&gt;
        &lt;rdf:li&gt;
          &lt;mm:ReleaseDate&gt;
            &lt;dc:date&gt;1992-08-18&lt;/dc:date&gt;
            &lt;mm:country&gt;US&lt;/mm:country&gt;
          &lt;/mm:ReleaseDate&gt;
        &lt;/rdf:li&gt;
      &lt;/rdf:Seq&gt;
    &lt;/mm:releaseDateList&gt;
    &lt;az:Asin&gt;B000002JPG&lt;/az:Asin&gt;
    &lt;mm:coverart rdf:resource=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://images.amazon.com/images/P/B000002JPG.01.MZZZZZZZ.jpg">http://images.amazon.com/images/P/B000002JPG.01.MZZZZZZZ.jpg</a></span>&#34;/&gt;
  &lt;/mm:Album&gt;

&lt;/rdf:RDF&gt;


Amazon Cover URL: 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;18&nbsp;18:28:06&nbsp;2004</span>
    <span class="description">svanzoest [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;20&nbsp;01:29:52&nbsp;2004</span>
    <span class="description">svanzoest [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">2 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[AGRUNDMA - Fri Jun 18 15:30:29 2004]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks, the module now runs without any errors.  However, now I am
&gt;    trying to use the following code which is returning no results.  It
&gt;    gets the RDF data from MB just fine, but doesn&#39;t appear to be
&gt;    parsing it properly.
</div>
Hmm.. did you add MBE_AlbumGetAmazonCoverartURL to your export list for
MusicBrainz::Queries?

I made a quick change to the getalbum.t test &#40;attached&#41; and ran in it on
a FreeBSD 4.6-STABLE box with perl 5.8.4 with the following results.


-- getalbum.out --
1..1
MusicBrainz::Client  version: 0.08
MusicBrainz::Queries version: 0.07
libmusicbrainz       version: 2.1.1

  AlbumId: cb36140d-2202-4170-8649-c2e1c20d9d96
  Name: Mind Fruit
  Cover URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://images.amazon.com/images/P/B000002JPG.01.MZZZZZZZ.jpg">http://images.amazon.com/images/P/B000002JPG.01.MZZZZZZZ.jpg</a></span>
  NumTracks: 10

Track: It&#39;s A Fine Day
TrackId    : bc47584e-9f79-4851-bdac-b6d5224c07f8
TrackNum   : 1
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: I Talk To The Wind
TrackId    : 53f0c7be-50f1-42fa-aaff-f200544b66c1
TrackNum   : 2
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Flow
TrackId    : d088d101-21ff-4701-bfa6-aa845890990c
TrackNum   : 3
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Stars In My Pocket
TrackId    : a28dd509-bee0-4e6b-a942-63c07ae6e970
TrackNum   : 4
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Sea People
TrackId    : ae25fb46-5366-4d7c-9ee0-57d3d77282d7
TrackNum   : 5
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Evolution
TrackId    : 7aabbee0-a4c0-417d-9533-2a62af29ae94
TrackNum   : 6
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Into This Universe
TrackId    : 61cde77a-b00f-4263-b0da-1786f2c61f81
TrackNum   : 7
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Up
TrackId    : 02d311b8-0dd6-4a15-9416-62174a17cc67
TrackNum   : 8
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Alzir
TrackId    : 20c62fa0-2f35-4a73-8779-ebd610a9400c
TrackNum   : 9
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

Track: Outro
TrackId    : c49f1c13-3587-4389-81a0-470a179571a2
TrackNum   : 10
TrackArtist   : Opus III
ArtistId   : 89240fa8-7e01-490f-8b4c-59f3f488eec6

ok 1
-- end --
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">BEGIN { $| =1;  print &#34;1..1\n&#34;; }
END { print &#34;not ok 1\n&#34; unless $loaded; }
#
# $Id$
#
use strict;
use MusicBrainz::Client qw&#40;MB_CDINDEX_ID_LEN&#41;;
use MusicBrainz::Queries qw&#40;MBQ_GetAlbumById
                            MBQ_GetCDInfoFromCDIndexId
                            MBS_SelectAlbum
                            MBE_AlbumGetAlbumId
                            MBE_AlbumGetAlbumName
			    MBE_AlbumGetAmazonCoverartURL
                            MBE_AlbumGetNumTracks
                            MBE_AlbumGetArtistId
                            MBE_AlbumGetArtistName
                            MBE_AlbumGetTrackName
                            MBE_AlbumGetTrackId
                            MBE_AlbumGetTrackList&#41;;

#use constant ID =&gt; &#34;dd4ff740-2a73-444d-8b55-d16fde79f429&#34;;
use constant ID =&gt; &#34;cb36140d-2202-4170-8649-c2e1c20d9d96&#34;;

use constant MB_SERVER =&gt; &#34;mm.musicbrainz.org&#34;;
use constant MB_PORT   =&gt; 80;
use constant MB_DEBUG  =&gt;  0;
use constant MB_DEPTH  =&gt;  4;

my $mb = new MusicBrainz::Client&#40;&#41;;

if&#40; $^O eq &#34;MSWin32&#34; &#41;
{
    $mb-&gt;WSAInit&#40;&#41;;
}

# Tell the client library to return data in ISO8859-1 and not UTF-8
$mb-&gt;use_utf8&#40;0&#41;;
# Tell the server to return 10 items.
$mb-&gt;set_max_items&#40;10&#41;;
# Set the proper server to use. Defaults to mm.musicbrainz.org:80
$mb-&gt;set_server&#40;MB_SERVER, MB_PORT&#41;;
# Check to see if the debug env var has been set
$mb-&gt;set_debug&#40;MB_DEBUG&#41;;
# Tell the server to only return 2 levels of data, unless the MB_DEPTH var
# is set
$mb-&gt;set_depth&#40;MB_DEPTH&#41;;

printf&#40;&#34;MusicBrainz::Client  version: %s\n&#34;, $MusicBrainz::Client::VERSION&#41;;
printf&#40;&#34;MusicBrainz::Queries version: %s\n&#34;, $MusicBrainz::Queries::VERSION&#41;;
printf&#40;&#34;libmusicbrainz       version: %d.%d.%d\n&#34;, $mb-&gt;get_version&#40;&#41;&#41;;
print &#34;\n&#34;;

# Execute the MB_GetALbumById or a GetCDInfoFromCDIndexId query
my $ret;
if&#40; length&#40;ID&#41; != MB_CDINDEX_ID_LEN &#41; {
  $ret = $mb-&gt;query_with_args&#40; MBQ_GetAlbumById, [ ID ]&#41;;
} else {
  $ret = $mb-&gt;query_with_args&#40; MBQ_GetCDInfoFromCDIndexId, [ ID ]&#41;;
}

if&#40; !$ret&#41; {
   print &#34;Query failed: &#34;, $mb-&gt;get_query_error&#40;&#41;, &#34;\n&#34;;
   exit&#40;0&#41;;
}

# Select the first album
$mb-&gt;select1&#40;MBS_SelectAlbum, 1&#41;;

my $data;
# Pull back the album id to see if we got the album
unless&#40; $data = $mb-&gt;get_result_data&#40; MBE_AlbumGetAlbumId &#41; &#41; {
  print &#34;Album not found.\n&#34;;
  exit&#40;0&#41;;
}
print &#34;  AlbumId: &#34;, $mb-&gt;get_id_from_url&#40; $data &#41; || &#34;&#34;, &#34;\n&#34;;

# Extract the album name
if&#40; $data = $mb-&gt;get_result_data&#40; MBE_AlbumGetAlbumName &#41; &#41; {
  print &#34;  Name: &#34;, $data, &#34;\n&#34;;
}

if&#40; $data = $mb-&gt;get_result_data&#40; MBE_AlbumGetAmazonCoverartURL &#41; &#41; {
  print &#34;  Cover URL: &#34;, $data, &#34;\n&#34;;
}

# Extract the number of tracks
my $num_tracks = $mb-&gt;get_result_int&#40; MBE_AlbumGetNumTracks &#41;;
if&#40; $num_tracks &gt; 0 &#38;&#38; $num_tracks &lt; 100 &#41; {
  print &#34;  NumTracks: &#34;, $num_tracks, &#34;\n&#34;;
}

# Check to see if there is more than one artist for this album
my $is_multiple_artist = 0;
for&#40;my $i = 1; $i &lt;= $num_tracks; $i++&#41; {
  unless&#40; $data = $mb-&gt;get_result_data1&#40; MBE_AlbumGetArtistId, $i &#41; &#41; {
    next;
  }
  my $temp = $data  if&#40; $i == 1 &#41;;
  if&#40; $temp eq $data &#41; {
    $is_multiple_artist = 1;
    last;
  }
}
unless&#40; $is_multiple_artist &#41; {
  # Extract the artist name from the album
  if&#40; $data = $mb-&gt;get_result_data1&#40; MBE_AlbumGetArtistName, 1 &#41; &#41;{
    print &#34;AlbumArtist: &#34;, $data, &#34;\n&#34;;
  }
  if&#40; $data = $mb-&gt;get_result_data1&#40; MBE_AlbumGetArtistId, 1 &#41; &#41; {
    print &#34;AlbumId    : &#34;, $data, &#34;\n&#34;;
  }
}
print &#34;\n&#34;;

for&#40; my $i = 1; $i &lt;= $num_tracks; $i++ &#41; {
  # Extract the track name from the album.
  if&#40; $data = $mb-&gt;get_result_data1&#40; MBE_AlbumGetTrackName, $i &#41; &#41; {
    print &#34;Track: &#34;, $data, &#34;\n&#34;;
  } else { 
    next;
  }
  # Extract the album id from the track. Just use the first album that
  # this track appreas on
  if&#40; $data = $mb-&gt;get_result_data1&#40; MBE_AlbumGetTrackId, $i &#41; &#41; {
    print &#34;TrackId    : &#34;, $mb-&gt;get_id_from_url&#40;$data&#41; || &#34;&#34;, &#34;\n&#34;;
    # Extract the track number
    my $track_num = $mb-&gt;get_ordinal_from_list&#40;MBE_AlbumGetTrackList, $data&#41;;
    if&#40; $track_num &gt; 0 &#38;&#38; $track_num &lt; 100 &#41; {
      print &#34;TrackNum   : &#34;, $track_num, &#34;\n&#34;;
    }
  }
  
  # If its a multiple artist album, print out the artist for each track
  if&#40; $is_multiple_artist &#41; {
    # Extract the artist name from this track
    if&#40; $data = $mb-&gt;get_result_data1&#40; MBE_AlbumGetArtistName, $i &#41; &#41; {
      print &#34;TrackArtist   : &#34;, $data, &#34;\n&#34;;
    }
    if&#40; $data = $mb-&gt;get_result_data1&#40; MBE_AlbumGetArtistId, $i &#41; &#41; {
      print &#34;ArtistId   : &#34;, $mb-&gt;get_id_from_url&#40;$data&#41; || &#34;&#34;, &#34;\n&#34;;
    }
  }
  print &#34;\n&#34;;
}
  
if&#40; $^O eq &#34;MSWin32&#34; &#41;
{
    $mb-&gt;WSAStop&#40;&#41;;
}

our $loaded = 1;
print &#34;ok 1\n&#34;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;20&nbsp;01:29:52&nbsp;2004</span>
    <span class="description">svanzoest [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;20&nbsp;01:41:57&nbsp;2004</span>
    <span class="description">svanzoest [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[AGRUNDMA - Fri Jun 18 15:30:29 2004]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks, the module now runs without any errors.  However, now I am
&gt;    trying to use the following code which is returning no results.  It
&gt;    gets the RDF data from MB just fine, but doesn&#39;t appear to be
&gt;    parsing it properly.
&gt; 
&gt; my $mb = MusicBrainz::Client-&gt;new;
&gt; $mb-&gt;set_debug&#40;1&#41;;
&gt; if &#40; !$mb-&gt;query_with_args&#40; MBQ_GetAlbumById, [ &#39;cb36140d-2202-4170-
&gt;    8649-c2e1c20d9d96&#39; ] &#41; &#41; {
&gt;       die&#40;&#34;Query failed: &#34;, $mb-&gt;get_query_error&#40;&#41;, &#34;\n&#34;&#41;;
&gt; }
&gt; print &#34;Amazon Cover URL: &#34; . $mb-
<div class="message-stanza open">&gt;    &gt;get_result_data&#40;MBE_AlbumGetAmazonCoverartURL&#41; . &#34;\n&#34;;
</div></div>
Ahh.. I looked at your above code in more detail.

You are missing the call to select the album.

If you add the following line after the query, you should see the URL
being printed:
       $mb-&gt;select1&#40;MBS_SelectAlbum, 1&#41;;

Alternatively, you could look at MusicBrainz::Client::Simple in the same
package to get a more intuitive perl-ish interface to the library.

hmm.. that reminds me. we need to add the new Queries to the
MusicBrainz::Client::Simple::Album module.

HTH,

-- Sander
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;21&nbsp;13:07:00&nbsp;2004</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[SVANZOEST - Sun Jun 20 01:41:57 2004]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [AGRUNDMA - Fri Jun 18 15:30:29 2004]:
&gt; 
<div class="message-stanza open">&gt; &gt; Thanks, the module now runs without any errors.  However, now I am
&gt; &gt;    trying to use the following code which is returning no results.  It
&gt; &gt;    gets the RDF data from MB just fine, but doesn&#39;t appear to be
&gt; &gt;    parsing it properly.
&gt; &gt; 
&gt; &gt; my $mb = MusicBrainz::Client-&gt;new;
&gt; &gt; $mb-&gt;set_debug&#40;1&#41;;
&gt; &gt; if &#40; !$mb-&gt;query_with_args&#40; MBQ_GetAlbumById, [ &#39;cb36140d-2202-4170-
&gt; &gt;    8649-c2e1c20d9d96&#39; ] &#41; &#41; {
&gt; &gt;     die&#40;&#34;Query failed: &#34;, $mb-&gt;get_query_error&#40;&#41;, &#34;\n&#34;&#41;;
&gt; &gt; }
&gt; &gt; print &#34;Amazon Cover URL: &#34; . $mb-
<div class="message-stanza open">&gt; &gt;    &gt;get_result_data&#40;MBE_AlbumGetAmazonCoverartURL&#41; . &#34;\n&#34;;
</div></div>&gt; 
&gt; Ahh.. I looked at your above code in more detail.
&gt; 
&gt; You are missing the call to select the album.
&gt; 
&gt; If you add the following line after the query, you should see the URL
&gt; being printed:
&gt;        $mb-&gt;select1&#40;MBS_SelectAlbum, 1&#41;;
&gt; 
&gt; Alternatively, you could look at MusicBrainz::Client::Simple in the same
&gt; package to get a more intuitive perl-ish interface to the library.
&gt; 
&gt; hmm.. that reminds me. we need to add the new Queries to the
&gt; MusicBrainz::Client::Simple::Album module.
&gt; 
&gt; HTH,
&gt; 
&gt; -- Sander
</div>
Thanks!  That did the trick.  It&#39;s a bit strange that the API requires
you to call select1 even though you will always get only 1 album back
when doing an AlbumId query.  I will definitely check out the Simple API.

-Andy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;25&nbsp;16:15:17&nbsp;2005</span>
    <span class="description">svanzoest [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I released 0.09 today. This version no longer supports the Amazon Cover
Art URL because of potential legal liability.

Sorry for the inconvenience.

-- Sander
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;25&nbsp;16:15:17&nbsp;2005</span>
    <span class="description">svanzoest [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
