<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #110420 for OpenOffice-OODoc: suspect OpenOffice::OOdoc bug, please help</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #110420 for OpenOffice-OODoc: suspect OpenOffice::OOdoc bug, please help</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/OpenOffice-OODoc/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/OpenOffice-OODoc">OpenOffice-OODoc CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">110420</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/OpenOffice-OODoc/Active/">OpenOffice-OODoc</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">jmgdoc [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
dchu [...] ambarella.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24242-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24243-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




image001.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1574182/840547/image001.png">
Thu Dec 17 22:55:26 2015 (19.2k) by dchu [...] ambarella.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;17&nbsp;22:55:26&nbsp;2015</span>
    <span class="description">dchu [...] ambarella.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> FW: report a OpenOffice::OODoc      suspect OpenOffice::OOdoc bug, please help</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 18 Dec 2015 03:54:58 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-OpenOffice-OODoc [...] rt.cpan.org&#34; &lt;bug-OpenOffice-OODoc [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dino Chu &lt;dchu [...] ambarella.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear Webmaster

I want to report a bug, please help.

* perl version
  v5.10.1

* OpenOffice::OODoc version
  v2.125

* OpenOffice vesion
  v3.3

* Distribution
  Red Hat Enterprise Linux Server release 6.3 &#40;Santiago&#41;

* Bug Description:
  While I use OpenOffice::OODoc v2.125, I encounter one problem.
  would you kindly help me.

  My intention is to modify existing odt file with OpenOffice::OODoc,  here is my code.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">  &gt;&gt;&gt; use OpenOffice::OODoc;
  &gt;&gt;&gt;
  &gt;&gt;&gt; my $archive = ooFile&#40;&#34;aaa.odt&#34;&#41;;
  &gt;&gt;&gt; my $doc = ooDocument&#40;archive =&gt; $archive,
  &gt;&gt;&gt;                      member =&gt; &#39;content&#39;&#41;;
  &gt;&gt;&gt;
  &gt;&gt;&gt; my $table = $doc-&gt;getTable&#40;0&#41;;
  &gt;&gt;&gt; my &#40;$h, $l&#41; = $doc-&gt;getTableSize&#40;0&#41;;
  &gt;&gt;&gt; my $row = $i &lt; $h ? $doc-&gt;getRow&#40;0, $i&#41; :
  &gt;&gt;&gt;                     $doc-&gt;appendRow&#40;0&#41;;
  &gt;&gt;&gt; for &#40;my $j = 0; $j &lt; $l; $j++&#41;
  &gt;&gt;&gt; {
  &gt;&gt;&gt;   $doc-&gt;cellValue&#40;$row, $j, 123&#41;;
  &gt;&gt;&gt; }
  &gt;&gt;&gt; $archive-&gt;save;
</div>
  but I can&#39;t open with OpenOffice, it complain
[cid:image001.png@01D1398A.5C546580]

  after investigate the content.xml of modified odt file, I found that
  the red mark content &#39;Times New Roman&#39; should be &#38;apos;Times new Roman&#38;apos;

  would you kindly help me to resolve this problem.

best regards
Dino Chu




content of context.xml of modified odt file
&lt;office:document-content grddl:transformation=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://docs.oasis-open.org/office/1.2/xslt/odf2rdf.xsl">http://docs.oasis-open.org/office/1.2/xslt/odf2rdf.xsl</a></span>&#34; office:version=&#34;1.2&#34; xmlns:chart=&#34;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&#34; xmlns:dc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/dc/elements/1.1/">http://purl.org/dc/elements/1.1/</a></span>&#34; xmlns:dom=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/xml-events">http://www.w3.org/2001/xml-events</a></span>&#34; xmlns:dr3d=&#34;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&#34; xmlns:draw=&#34;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&#34; xmlns:field=&#34;urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0&#34; xmlns:fo=&#34;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&#34; xmlns:form=&#34;urn:oasis:names:tc:opendocument:xmlns:form:1.0&#34; xmlns:grddl=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2003/g/data-view">http://www.w3.org/2003/g/data-view</a></span>#&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2003/g/data-view">http://www.w3.org/2003/g/data-view</a></span>&gt;&#34; xmlns:math=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1998/Math/MathML">http://www.w3.org/1998/Math/MathML</a></span>&#34; xmlns:meta=&#34;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&#34; xmlns:number=&#34;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&#34; xmlns:of=&#34;urn:oasis:names:tc:opendocument:xmlns:of:1.2&#34; xmlns:office=&#34;urn:oasis:names:tc:opendocument:xmlns:office:1.0&#34; xmlns:ooo=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2004/office">http://openoffice.org/2004/office</a></span>&#34; xmlns:oooc=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2004/calc">http://openoffice.org/2004/calc</a></span>&#34; xmlns:ooow=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2004/writer">http://openoffice.org/2004/writer</a></span>&#34; xmlns:rpt=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2005/report">http://openoffice.org/2005/report</a></span>&#34; xmlns:script=&#34;urn:oasis:names:tc:opendocument:xmlns:script:1.0&#34; xmlns:style=&#34;urn:oasis:names:tc:opendocument:xmlns:style:1.0&#34; xmlns:svg=&#34;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&#34; xmlns:table=&#34;urn:oasis:names:tc:opendocument:xmlns:table:1.0&#34; xmlns:tableooo=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2009/table">http://openoffice.org/2009/table</a></span>&#34; xmlns:text=&#34;urn:oasis:names:tc:opendocument:xmlns:text:1.0&#34; xmlns:xforms=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2002/xforms">http://www.w3.org/2002/xforms</a></span>&#34; xmlns:xhtml=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</a></span>&#34; xmlns:xlink=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xlink">http://www.w3.org/1999/xlink</a></span>&#34; xmlns:xsd=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a></span>&#34; xmlns:xsi=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span>&#34;&gt;&lt;office:scripts/&gt;&lt;office:font-face-decls&gt;&lt;style:font-face style:name=&#34;StarSymbol&#34; svg:font-family=&#34;StarSymbol&#34;/&gt;&lt;style:font-face style:name=&#34;Tahoma1&#34; svg:font-family=&#34;Tahoma&#34;/&gt;&lt;style:font-face style:font-family-generic=&#34;roman&#34; style:font-pitch=&#34;variable&#34; style:name=&#34;Times New Roman&#34; svg:font-family=&#34;&#39;Times New Roman&#39;&#34;/&gt;&lt;style:font-face style:font-family-generic=&#34;swiss&#34; style:font-pitch=&#34;variable&#34; style:name=&#34;Arial&#34; svg:font-family=&#34;Arial&#34;/&gt;&lt;style:font-face style:font-family-generic=&#34;system&#34; style:font-pitch=&#34;variable&#34; style:name=&#34;DejaVu Sans&#34; svg:font-family=&#34;&#39;DejaVu Sans&#39;&#34;/&gt;&lt;style:font-face style:font-family-generic=&#34;system&#34; style:font-pitch=&#34;variable&#34; style:name=&#34;Tahoma&#34; svg:font-family=&#34;Tahoma&#34;/&gt;&lt;/office:font-face-decls&gt;&lt;office:automatic-styles&gt;&lt;style:style style:display-name=&#34;Test Table 1&#34; style:family=&#34;table&#34; style:name=&#34;Test_20_Table_20_1&#34;&gt;&lt;style:table-properties fo:margin-left=&#34;0.5903in&#34; fo:margin-right=&#34;2.4368in&#34; style:width=&#34;3.6653in&#34; table:align=&#34;margins&#34;/&gt;&lt;/style:style&gt;&lt;style:style style:display-name=&#34;Test Table 1.A&#34; style:family=&#34;table-column&#34; style:name=&#34;Test_20_Table_20_1.A&#34;&gt;&lt;style:table-column-properties style:column-width=&#34;0.7493in&#34; style:rel-column-width=&#34;13397*&#34;/&gt;&lt;/style:style&gt;&lt;style:style style:display-name=&#34;Test Table 1.B&#34; style
NOTE: This email &#40;including attachments&#41; contain Ambarella Proprietary and/or Confidential Information and is intended solely for the use of the individual&#40;s&#41; to whom it is addressed. Any unauthorized review, use, disclosure, distribute, copy, or print is prohibited. If you are not an intended recipient, please contact the sender by reply email and destroy all copies of the original message. Thank you.
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1574182/840547/image001.png">Download image001.png</a><br />
<span class="downloadcontenttype">image/png 19.2k</span>
</div>
<div class="messagebody">
<img alt="image001.png" title="image001.png" src="/Ticket/Attachment/1574182/840547/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;01:41:37&nbsp;2015</span>
    <span class="description">ether [...] cpan.org -  Subject changed from &#39;FW: report a OpenOffice::OODoc      suspect OpenOffice::OOdoc bug, please help&#39; to &#39;suspect OpenOffice::OOdoc bug, please help&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;03:58:35&nbsp;2015</span>
    <span class="description">jmgdoc [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza">Le 2015-12-17 22:55:26, dchu@ambarella.com a &eacute;crit&nbsp;:<br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Dear Webmaster<br>

&gt;<br>

&gt; I want to report a bug, please help.<br>

&gt;<br>

&gt; * perl version<br>

&gt; v5.10.1<br>

&gt;<br>

&gt; * OpenOffice::OODoc version<br>

&gt; v2.125<br>

&gt;<br>

&gt; * OpenOffice vesion<br>

&gt; v3.3<br>

&gt;<br>

&gt; * Distribution<br>

&gt; Red Hat Enterprise Linux Server release 6.3 (Santiago)<br>

&gt;<br>

&gt; * Bug Description:<br>

&gt; While I use OpenOffice::OODoc v2.125, I encounter one problem.<br>

&gt; would you kindly help me.<br>

&gt;<br>

&gt; My intention is to modify existing odt file with OpenOffice::OODoc,<br>

&gt; here is my code.<br>
<div class="message-stanza open">&gt; &gt;&gt;&gt; use OpenOffice::OODoc;<br>

&gt; &gt;&gt;&gt;<br>

&gt; &gt;&gt;&gt; my $archive = ooFile(&quot;aaa.odt&quot;);<br>

&gt; &gt;&gt;&gt; my $doc = ooDocument(archive =&gt; $archive,<br>

&gt; &gt;&gt;&gt; member =&gt; &#39;content&#39;);<br>

&gt; &gt;&gt;&gt;<br>

&gt; &gt;&gt;&gt; my $table = $doc-&gt;getTable(0);<br>

&gt; &gt;&gt;&gt; my ($h, $l) = $doc-&gt;getTableSize(0);<br>

&gt; &gt;&gt;&gt; my $row = $i &lt; $h ? $doc-&gt;getRow(0, $i) :<br>

&gt; &gt;&gt;&gt; $doc-&gt;appendRow(0);<br>

&gt; &gt;&gt;&gt; for (my $j = 0; $j &lt; $l; $j++)<br>

&gt; &gt;&gt;&gt; {<br>

&gt; &gt;&gt;&gt; $doc-&gt;cellValue($row, $j, 123);<br>

&gt; &gt;&gt;&gt; }<br>

&gt; &gt;&gt;&gt; $archive-&gt;save;<br>
</div>&gt;<br>

&gt; but I can&#39;t open with OpenOffice, it complain<br>

&gt; [cid:image001.png@01D1398A.5C546580]<br>

&gt;<br>

&gt; after investigate the content.xml of modified odt file, I found that<br>

&gt; the red mark content &#39;Times New Roman&#39; should be &amp;apos;Times new<br>

&gt; Roman&amp;apos;<br>

&gt;<br>

&gt; would you kindly help me to resolve this problem.<br>

&gt;<br>

&gt; best regards<br>

&gt; Dino Chu<br>

&gt;<br>

&gt;<br>

&gt;<br>

&gt;<br>

&gt; content of context.xml of modified odt file<br>

&gt; &lt;office:document-content grddl:transformation=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://docs.oasis">http://docs.oasis</a></span>-<br>

&gt; open.org/office/1.2/xslt/odf2rdf.xsl&quot; office:version=&quot;1.2&quot;<br>

&gt; xmlns:chart=&quot;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&quot;<br>

&gt; xmlns:dc=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://purl.org/dc/elements/1.1/&#38;quot">http://purl.org/dc/elements/1.1/&#38;quot</a></span>;<br>

&gt; xmlns:dom=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/xml-events&#38;quot">http://www.w3.org/2001/xml-events&#38;quot</a></span>;<br>

&gt; xmlns:dr3d=&quot;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&quot;<br>

&gt; xmlns:draw=&quot;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&quot;<br>

&gt; xmlns:field=&quot;urn:openoffice:names:experimental:ooo-ms-<br>

&gt; interop:xmlns:field:1.0&quot;<br>

&gt; xmlns:fo=&quot;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&quot;<br>

&gt; xmlns:form=&quot;urn:oasis:names:tc:opendocument:xmlns:form:1.0&quot;<br>

&gt; xmlns:grddl=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2003/g/data-">http://www.w3.org/2003/g/data-</a></span><br>

&gt; view#&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2003/g/data-view&#38;gt;&#38;quot">http://www.w3.org/2003/g/data-view&#38;gt;&#38;quot</a></span>;<br>

&gt; xmlns:math=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1998/Math/MathML&#38;quot">http://www.w3.org/1998/Math/MathML&#38;quot</a></span>;<br>

&gt; xmlns:meta=&quot;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&quot;<br>

&gt; xmlns:number=&quot;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&quot;<br>

&gt; xmlns:of=&quot;urn:oasis:names:tc:opendocument:xmlns:of:1.2&quot;<br>

&gt; xmlns:office=&quot;urn:oasis:names:tc:opendocument:xmlns:office:1.0&quot;<br>

&gt; xmlns:ooo=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2004/office&#38;quot">http://openoffice.org/2004/office&#38;quot</a></span>;<br>

&gt; xmlns:oooc=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2004/calc&#38;quot">http://openoffice.org/2004/calc&#38;quot</a></span>;<br>

&gt; xmlns:ooow=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2004/writer&#38;quot">http://openoffice.org/2004/writer&#38;quot</a></span>;<br>

&gt; xmlns:rpt=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2005/report&#38;quot">http://openoffice.org/2005/report&#38;quot</a></span>;<br>

&gt; xmlns:script=&quot;urn:oasis:names:tc:opendocument:xmlns:script:1.0&quot;<br>

&gt; xmlns:style=&quot;urn:oasis:names:tc:opendocument:xmlns:style:1.0&quot;<br>

&gt; xmlns:svg=&quot;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&quot;<br>

&gt; xmlns:table=&quot;urn:oasis:names:tc:opendocument:xmlns:table:1.0&quot;<br>

&gt; xmlns:tableooo=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://openoffice.org/2009/table&#38;quot">http://openoffice.org/2009/table&#38;quot</a></span>;<br>

&gt; xmlns:text=&quot;urn:oasis:names:tc:opendocument:xmlns:text:1.0&quot;<br>

&gt; xmlns:xforms=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2002/xforms&#38;quot">http://www.w3.org/2002/xforms&#38;quot</a></span>;<br>

&gt; xmlns:xhtml=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xhtml&#38;quot">http://www.w3.org/1999/xhtml&#38;quot</a></span>;<br>

&gt; xmlns:xlink=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/1999/xlink&#38;quot">http://www.w3.org/1999/xlink&#38;quot</a></span>;<br>

&gt; xmlns:xsd=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema&#38;quot">http://www.w3.org/2001/XMLSchema&#38;quot</a></span>;<br>

&gt; xmlns:xsi=&quot;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.w3.org/2001/XMLSchema-">http://www.w3.org/2001/XMLSchema-</a></span><br>

&gt; instance&quot;&gt;&lt;office:scripts/&gt;&lt;office:font-face-decls&gt;&lt;style:font-face<br>

&gt; style:name=&quot;StarSymbol&quot; svg:font-family=&quot;StarSymbol&quot;/&gt;&lt;style:font-face<br>

&gt; style:name=&quot;Tahoma1&quot; svg:font-family=&quot;Tahoma&quot;/&gt;&lt;style:font-face<br>

&gt; style:font-family-generic=&quot;roman&quot; style:font-pitch=&quot;variable&quot;<br>

&gt; style:name=&quot;Times New Roman&quot; svg:font-family=&quot;&#39;Times New<br>

&gt; Roman&#39;&quot;/&gt;&lt;style:font-face style:font-family-generic=&quot;swiss&quot;<br>

&gt; style:font-pitch=&quot;variable&quot; style:name=&quot;Arial&quot; svg:font-<br>

&gt; family=&quot;Arial&quot;/&gt;&lt;style:font-face style:font-family-generic=&quot;system&quot;<br>

&gt; style:font-pitch=&quot;variable&quot; style:name=&quot;DejaVu Sans&quot; svg:font-<br>

&gt; family=&quot;&#39;DejaVu Sans&#39;&quot;/&gt;&lt;style:font-face style:font-family-<br>

&gt; generic=&quot;system&quot; style:font-pitch=&quot;variable&quot; style:name=&quot;Tahoma&quot;<br>

&gt; svg:font-family=&quot;Tahoma&quot;/&gt;&lt;/office:font-face-decls&gt;&lt;office:automatic-<br>
<div class="message-stanza open">&gt; styles&gt;&lt;style:style style:display-name=&quot;Test Table 1&quot;<br>
</div>&gt; style:family=&quot;table&quot; style:name=&quot;Test_20_Table_20_1&quot;&gt;&lt;style:table-<br>

&gt; properties fo:margin-left=&quot;0.5903in&quot; fo:margin-right=&quot;2.4368in&quot;<br>

&gt; style:width=&quot;3.6653in&quot;<br>

&gt; table:align=&quot;margins&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:display-<br>

&gt; name=&quot;Test Table 1.A&quot; style:family=&quot;table-column&quot;<br>

&gt; style:name=&quot;Test_20_Table_20_1.A&quot;&gt;&lt;style:table-column-properties<br>

&gt; style:column-width=&quot;0.7493in&quot; style:rel-column-<br>

&gt; width=&quot;13397*&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:display-name=&quot;Test<br>

&gt; Table 1.B&quot; style<br>

&gt; NOTE: This email (including attachments) contain Ambarella Proprietary<br>

&gt; and/or Confidential Information and is intended solely for the use of<br>

&gt; the individual(s) to whom it is addressed. Any unauthorized review,<br>

&gt; use, disclosure, distribute, copy, or print is prohibited. If you are<br>

&gt; not an intended recipient, please contact the sender by reply email<br>

&gt; and destroy all copies of the original message. Thank you.<br>
</div><br>

<br>


</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;03:58:36&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;03:58:41&nbsp;2015</span>
    <span class="description">jmgdoc [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;04:10:34&nbsp;2015</span>
    <span class="description">jmgdoc [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza">Your application apparently runs an insert/update operation against a un-normalized spreadsheet.<br>

<br>

OpenOffice::OOdoc allows read-only requests against un-normalized tables, but any updates of such tables can produce inconsistencies.<br>

<br>

In order to avoid such inconsistencies with Calc spreadsheets, the application must do a normalizeSheet() before any update.<br>

<br>

Could you have a look at <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/OpenOffice-OODoc/OODoc/Text.pod">http://search.cpan.org/dist/OpenOffice-OODoc/OODoc/Text.pod</a></span><br>

then try to fix the issue accordingly and report the result here.<br>

<br>

Thx<br>

<br>

Note: for applications that make intensive spreadsheet processing, a switch to ODF::lpOD (that&#39;s more efficient and user-friendly than OpenOffice::OODoc) should be considered.<br>


</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
