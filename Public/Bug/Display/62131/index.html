<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #62131 for Parse-Dia-SQL: Add support for uml mode</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #62131 for Parse-Dia-SQL: Add support for uml mode</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Parse-Dia-SQL/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Parse-Dia-SQL/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Parse-Dia-SQL/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Parse-Dia-SQL/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Parse-Dia-SQL">Parse-Dia-SQL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">62131</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Parse-Dia-SQL/Active/">Parse-Dia-SQL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">aff [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
felix.ostmann [...] thewar.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-226170-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.16_01    </td>
  </tr>
  <tr id="CF-226171-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<ul>
<li>
0.16_02</li>
<li>
0.17</li>
</ul>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;14&nbsp;11:37:37&nbsp;2010</span>
    <span class="description">felix.ostmann [...] thewar.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have patched 4 things:

- add the flag --uml to the parsediasql
- first exec small packages, then do all inserts &#40;wrong order&#41;
- type bigserial is also int8
- in UML-Mode the naming for n:m tables was wrong.


With this change we get correnct n:m tables:

create table admins2admin_roles &#40;
   admin_role_id serial not null,
   admin_id      serial not null,
   constraint pk_admins2admin_roles primary key &#40;admin_role_id,admin_id&#41;
&#41;   ;
alter table admins2admin_roles add constraint
admins2admin_roles_fk_Admin_rolesAdmin_role_id
    foreign key &#40;admin_role_id&#41;
    references admin_roles &#40;admin_role_id&#41; on delete cascade;
alter table admins2admin_roles add constraint
admins2admin_roles_fk_AdminsAdmin_id
    foreign key &#40;admin_id&#41;
    references admins &#40;admin_id&#41; on delete cascade;


befor there was the wrong naming for the foreign key:
admins2admin_roles_fk_AdminsAdmin_id
    foreign key &#40;admin_role_id&#41;
    references admins &#40;admin_id&#41; on delete cascade;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> n:m-table.png</td>
  </tr>
</table>

<div class="messagebody">
<img alt="n:m-table.png" title="n:m-table.png" src="/Ticket/Attachment/842936/436440/" /></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> parse-dia-sql-0.17.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ru Parse-Dia-SQL-0.16/bin/parsediasql Parse-Dia-SQL-0.17/bin/parsediasql
--- Parse-Dia-SQL-0.16/bin/parsediasql	2010-01-18 21:39:17.000000000 +0100
+++ Parse-Dia-SQL-0.17/bin/parsediasql	2010-10-14 14:48:20.000000000 +0200
@@ -1,4 +1,7 @@
-#!/usr/bin/perl
+#!/home/ostmann/perl5lib/bin/perl
+
+eval &#39;exec /home/ostmann/perl5lib/bin/perl  -S $0 ${1+&#34;$@&#34;}&#39;
+    if 0; # not running under some shell
 
 # $Id: parsediasql,v 1.8 2009/11/17 12:21:25 aff Exp $
 
@@ -15,18 +18,20 @@
 my $file = undef;
 my $ignore_type_mismatch = undef;
 my $db   = undef;
+my $uml  = 0;
 
 GetOptions&#40;
   &#34;help|?&#34; =&gt; \$help,
   &#34;file=s&#34; =&gt; \$file,
   &#34;db=s&#34;   =&gt; \$db,
+  &#34;uml&#34;    =&gt; \$uml,
 	&#34;ignore_type_mismatch&#34; =&gt; \$ignore_type_mismatch, 
 &#41; or pod2usage&#40;2&#41;;
 pod2usage&#40;1&#41; if $help;
 pod2usage&#40;qq{Missing argument &#39;file&#39;}&#41; if !$file;
 pod2usage&#40;qq{Missing argument &#39;db&#39;}&#41; if !$db;
 
-my $dia = Parse::Dia::SQL-&gt;new&#40;file =&gt; $file, db =&gt; $db, ignore_type_mismatch =&gt; $ignore_type_mismatch&#41;;
+my $dia = Parse::Dia::SQL-&gt;new&#40;file =&gt; $file, db =&gt; $db, ignore_type_mismatch =&gt; $ignore_type_mismatch, uml =&gt; $uml&#41;;
 print $dia-&gt;get_sql&#40;&#41;;
 
 __END__
diff -ru Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Output.pm Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Output.pm
--- Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Output.pm	2010-05-21 07:19:36.000000000 +0200
+++ Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Output.pm	2010-10-14 14:48:01.000000000 +0200
@@ -219,14 +219,14 @@
     . $self-&gt;{newline}
     . $self-&gt;get_permissions_create&#40;&#41;
     . $self-&gt;{newline}
-    .  &#34;-- get_inserts&#34;
-    . $self-&gt;{newline}
-    . $self-&gt;get_inserts&#40;&#41;
-    . $self-&gt;{newline}
     .  &#34;-- get_smallpackage_post_sql&#34;
     . $self-&gt;{newline}
     . $self-&gt;get_smallpackage_post_sql&#40;&#41;
     . $self-&gt;{newline}
+    .  &#34;-- get_inserts&#34;
+    . $self-&gt;{newline}
+    . $self-&gt;get_inserts&#40;&#41;
+    . $self-&gt;{newline}
     .  &#34;-- get_associations_create&#34;
     . $self-&gt;{newline}
     . $self-&gt;get_associations_create&#40;&#41;;
diff -ru Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Utils.pm Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Utils.pm
--- Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Utils.pm	2010-02-02 08:30:36.000000000 +0100
+++ Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Utils.pm	2010-10-14 14:47:50.000000000 +0200
@@ -546,7 +546,7 @@
 			$self-&gt;{log}-&gt;info&#40;qq{Replaced $typeName with smallint}&#41; if $self-&gt;{log}-&gt;is_info&#40;&#41;;
       return &#39;smallint&#39;;
     }
-    if &#40; lc&#40;$typeName&#41; eq &#39;int8&#39; &#41; {
+    if &#40; lc&#40;$typeName&#41; eq &#39;bigserial&#39; or lc&#40;$typeName&#41; eq &#39;int8&#39; &#41; {
 			$self-&gt;{log}-&gt;info&#40;qq{Replaced $typeName with bigint}&#41; if $self-&gt;{log}-&gt;is_info&#40;&#41;;
       return &#39;bigint&#39;;
     }
diff -ru Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL.pm Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL.pm
--- Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL.pm	2010-05-21 07:25:11.000000000 +0200
+++ Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL.pm	2010-10-14 15:05:37.000000000 +0200
@@ -1370,13 +1370,16 @@
     &#38;&#38; $leftMult  =~ /^z?many$/
     &#38;&#38; $rightMult =~ /^z?many$/ &#41;
   {
+    # while in uml-mode the names switch
+    my $leftEndRole  = $self-&gt;{uml} ? $rightEnd{&#39;role&#39;} : $leftEnd{&#39;role&#39;};
+    my $rightEndRole = $self-&gt;{uml} ? $leftEnd{&#39;role&#39;}  : $rightEnd{&#39;role&#39;};
 
     # If the classification above failed, and the association is
     # many-to-many; generate the centre &#40;join&#41; table, its constraints
     # and the classes&#39; primary keys &#40;if needed&#41;
     $ok = $self-&gt;generate_many_to_many_association&#40;
-      $assocName,  $leftClass, $leftEnd{&#39;role&#39;},
-      $rightClass, $rightEnd{&#39;role&#39;}
+      $assocName,  $leftClass, $leftEndRole,
+      $rightClass, $rightEndRole
     &#41;;
   }
   else {
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;15&nbsp;13:42:49&nbsp;2010</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Parse-Dia-SQL ticket #62131</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Oct 14 11:37:37 2010, Sadrak wrote:

Hi Sadrak.  Thank you for your interest in Parse-Dia-SQL.  

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have patched 4 things:
</div>
Great!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - add the flag --uml to the parsediasql
&gt; - in UML-Mode the naming for n:m tables was wrong.
</div>
What do you mean by &#34;uml mode&#34; exactly?  Can you explain please ?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - first exec small packages, then do all inserts &#40;wrong order&#41;
</div>
I don&#39;t understand why that would be better, please explain.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - type bigserial is also int8
</div>
Ok.

Again, thank you for your time and effort.

Best regards,
Andreas
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;15&nbsp;13:42:49&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;16&nbsp;06:22:07&nbsp;2010</span>
    <span class="description">felix.ostmann [...] thewar.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> felix.ostmann [...] thewar.de</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Fr 15. Okt 2010, 13:42:49, AFF schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Oct 14 11:37:37 2010, Sadrak wrote:
&gt; 
&gt; Hi Sadrak.  Thank you for your interest in Parse-Dia-SQL.  
&gt; 
<div class="message-stanza open">&gt; &gt; I have patched 4 things:
</div>&gt; 
&gt; Great!
&gt; 
<div class="message-stanza open">&gt; &gt; - add the flag --uml to the parsediasql
&gt; &gt; - in UML-Mode the naming for n:m tables was wrong.
</div>&gt; 
&gt; What do you mean by &#34;uml mode&#34; exactly?  Can you explain please ?
</div>
look at <span class="clickylink"><a target="new" rel="nofollow" href="http://tedia2sql.tigris.org/usingtedia2sql.html">http://tedia2sql.tigris.org/usingtedia2sql.html</a></span> and search for
&#34;uml mode&#34;. Some sections are explain for ERD mode and for UML mode. 

I forgot to explain the --uml flag in parsediasql &#40;--help dont say
anything about that flag&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; - first exec small packages, then do all inserts &#40;wrong order&#41;
</div>&gt; 
&gt; I don&#39;t understand why that would be better, please explain.
</div>
I have to check that again, currently i cannot access the .dia :-/
without that change, our dia did not work, more at monday :&#41; Perhaps a
flag for ordering will help there more, i will check &#40;and write a patch&#41;.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; - type bigserial is also int8
</div>&gt; 
&gt; Ok.
&gt; 
&gt; Again, thank you for your time and effort.
&gt; 
&gt; Best regards,
&gt; Andreas
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;19&nbsp;13:07:41&nbsp;2010</span>
    <span class="description">felix.ostmann [...] thewar.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> felix.ostmann [...] thewar.de</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Now the patch looks good.


I removed the positionswap for smallpackages. Our Dia make some triggers
and inserts and the insert have to executed after the triggers ... but
it is better to hold the inserts in a seperate file and execute after
the deploy of the schema.


i added a short help for the --uml flag in parsediasql




Am Sa 16. Okt 2010, 06:22:07, Sadrak schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Am Fr 15. Okt 2010, 13:42:49, AFF schrieb:
<div class="message-stanza open">&gt; &gt; On Thu Oct 14 11:37:37 2010, Sadrak wrote:
&gt; &gt; 
&gt; &gt; Hi Sadrak.  Thank you for your interest in Parse-Dia-SQL.  
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; &gt; I have patched 4 things:
</div>&gt; &gt; 
&gt; &gt; Great!
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; &gt; - add the flag --uml to the parsediasql
&gt; &gt; &gt; - in UML-Mode the naming for n:m tables was wrong.
</div>&gt; &gt; 
&gt; &gt; What do you mean by &#34;uml mode&#34; exactly?  Can you explain please ?
</div>&gt; 
&gt; look at <span class="clickylink"><a target="new" rel="nofollow" href="http://tedia2sql.tigris.org/usingtedia2sql.html">http://tedia2sql.tigris.org/usingtedia2sql.html</a></span> and search for
&gt; &#34;uml mode&#34;. Some sections are explain for ERD mode and for UML mode. 
&gt; 
&gt; I forgot to explain the --uml flag in parsediasql &#40;--help dont say
&gt; anything about that flag&#41;
&gt; 
&gt; 
<div class="message-stanza open">&gt; &gt; 
<div class="message-stanza open">&gt; &gt; &gt; - first exec small packages, then do all inserts &#40;wrong order&#41;
</div>&gt; &gt; 
&gt; &gt; I don&#39;t understand why that would be better, please explain.
</div>&gt; 
&gt; I have to check that again, currently i cannot access the .dia :-/
&gt; without that change, our dia did not work, more at monday :&#41; Perhaps a
&gt; flag for ordering will help there more, i will check &#40;and write a patch&#41;.
&gt; 
&gt; 
<div class="message-stanza open">&gt; &gt; 
<div class="message-stanza open">&gt; &gt; &gt; - type bigserial is also int8
</div>&gt; &gt; 
&gt; &gt; Ok.
&gt; &gt; 
&gt; &gt; Again, thank you for your time and effort.
&gt; &gt; 
&gt; &gt; Best regards,
&gt; &gt; Andreas
</div>&gt; 
</div></div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> parse-dia-sql-0.17.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ru Parse-Dia-SQL-0.16/bin/parsediasql Parse-Dia-SQL-0.17/bin/parsediasql
--- Parse-Dia-SQL-0.16/bin/parsediasql	2010-01-18 21:39:17.000000000 +0100
+++ Parse-Dia-SQL-0.17/bin/parsediasql	2010-10-19 19:03:55.000000000 +0200
@@ -15,18 +15,20 @@
 my $file = undef;
 my $ignore_type_mismatch = undef;
 my $db   = undef;
+my $uml  = 0;
 
 GetOptions&#40;
   &#34;help|?&#34; =&gt; \$help,
   &#34;file=s&#34; =&gt; \$file,
   &#34;db=s&#34;   =&gt; \$db,
+  &#34;uml&#34;    =&gt; \$uml,
 	&#34;ignore_type_mismatch&#34; =&gt; \$ignore_type_mismatch, 
 &#41; or pod2usage&#40;2&#41;;
 pod2usage&#40;1&#41; if $help;
 pod2usage&#40;qq{Missing argument &#39;file&#39;}&#41; if !$file;
 pod2usage&#40;qq{Missing argument &#39;db&#39;}&#41; if !$db;
 
-my $dia = Parse::Dia::SQL-&gt;new&#40;file =&gt; $file, db =&gt; $db, ignore_type_mismatch =&gt; $ignore_type_mismatch&#41;;
+my $dia = Parse::Dia::SQL-&gt;new&#40;file =&gt; $file, db =&gt; $db, ignore_type_mismatch =&gt; $ignore_type_mismatch, uml =&gt; $uml&#41;;
 print $dia-&gt;get_sql&#40;&#41;;
 
 __END__
@@ -45,6 +47,7 @@
 
   file -  filename of Dia file
   db   -  Database type &#40;e.g. &#39;db2&#39;&#41;
+  uml  -  Using uml mode &#40;default is erd mode&#41;
   ignore_type_mismatch - Allows foreign keys to have a different 
           type than the primary key it references, if true.
 
diff -ru Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Utils.pm Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Utils.pm
--- Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Utils.pm	2010-02-02 08:30:36.000000000 +0100
+++ Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Utils.pm	2010-10-19 18:46:50.000000000 +0200
@@ -546,7 +546,7 @@
 			$self-&gt;{log}-&gt;info&#40;qq{Replaced $typeName with smallint}&#41; if $self-&gt;{log}-&gt;is_info&#40;&#41;;
       return &#39;smallint&#39;;
     }
-    if &#40; lc&#40;$typeName&#41; eq &#39;int8&#39; &#41; {
+    if &#40; lc&#40;$typeName&#41; eq &#39;bigserial&#39; or lc&#40;$typeName&#41; eq &#39;int8&#39; &#41; {
 			$self-&gt;{log}-&gt;info&#40;qq{Replaced $typeName with bigint}&#41; if $self-&gt;{log}-&gt;is_info&#40;&#41;;
       return &#39;bigint&#39;;
     }
diff -ru Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL.pm Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL.pm
--- Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL.pm	2010-05-21 07:25:11.000000000 +0200
+++ Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL.pm	2010-10-19 18:46:50.000000000 +0200
@@ -1370,13 +1370,16 @@
     &#38;&#38; $leftMult  =~ /^z?many$/
     &#38;&#38; $rightMult =~ /^z?many$/ &#41;
   {
+    # while in uml-mode the names switch
+    my $leftEndRole  = $self-&gt;{uml} ? $rightEnd{&#39;role&#39;} : $leftEnd{&#39;role&#39;};
+    my $rightEndRole = $self-&gt;{uml} ? $leftEnd{&#39;role&#39;}  : $rightEnd{&#39;role&#39;};
 
     # If the classification above failed, and the association is
     # many-to-many; generate the centre &#40;join&#41; table, its constraints
     # and the classes&#39; primary keys &#40;if needed&#41;
     $ok = $self-&gt;generate_many_to_many_association&#40;
-      $assocName,  $leftClass, $leftEnd{&#39;role&#39;},
-      $rightClass, $rightEnd{&#39;role&#39;}
+      $assocName,  $leftClass, $leftEndRole,
+      $rightClass, $rightEndRole
     &#41;;
   }
   else {
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;20&nbsp;16:29:50&nbsp;2010</span>
    <span class="description">aff [...] cpan.org -  Subject changed from &#40;no value&#41; to &#39;Add support for uml mode&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;20&nbsp;16:29:51&nbsp;2010</span>
    <span class="description">aff [...] cpan.org -  Given to AFF</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;20&nbsp;16:55:28&nbsp;2010</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 19 13:07:41 2010, Sadrak wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Now the patch looks good.
</div>
Thank you for your clarification.  The changes you suggest appear
reasonable.  I would really like to see a .dia model that takes
advantage of the &#34;uml mode&#34;, as well as what output you would expect. 
Do you think you could provide that please?

Best regards,
Andreas
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;21&nbsp;12:53:37&nbsp;2010</span>
    <span class="description">felix.ostmann [...] thewar.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62131] Add support for uml mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 21 Oct 2010 18:53:24 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Parse-Dia-SQL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Felix Ostmann &lt;felix.ostmann [...] thewar.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I added a small part of our dia as img to the bugreport, is this enough? 
Or should i make a greater .dia with more komponents?

Am 20.10.2010 22:55, schrieb Andreas Faafeng via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=62131">https://rt.cpan.org/Ticket/Display.html?id=62131</a></span>&gt;
&gt;
&gt; On Tue Oct 19 13:07:41 2010, Sadrak wrote:
&gt;    
<div class="message-stanza open">&gt;&gt; Now the patch looks good.
&gt;&gt;      
</div>&gt; Thank you for your clarification.  The changes you suggest appear
&gt; reasonable.  I would really like to see a .dia model that takes
&gt; advantage of the &#34;uml mode&#34;, as well as what output you would expect.
&gt; Do you think you could provide that please?
&gt;
&gt; Best regards,
&gt; Andreas
&gt;    
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;22&nbsp;01:18:44&nbsp;2010</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Oct 21 12:53:37 2010, Sadrak wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I added a small part of our dia as img to the bugreport, is this enough? 
&gt; Or should i make a greater .dia with more komponents?
</div>
If you could supply a .dia file that represents the image you already
have submitted, that would be ok. Optimally I would like 2 files: One
.dia file, and one test &#40;.t&#41; file that checks its content. E.g. like this

<span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/AFF/Parse-Dia-SQL-0.16_01/t/950-rt51433.t">http://cpansearch.perl.org/src/AFF/Parse-Dia-SQL-0.16_01/t/950-rt51433.t</a></span>

Regards,
Andreas
-- 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;22&nbsp;13:07:50&nbsp;2010</span>
    <span class="description">felix.ostmann [...] thewar.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #62131] Add support for uml mode</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 22 Oct 2010 19:07:36 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Parse-Dia-SQL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Felix Ostmann &lt;felix.ostmann [...] thewar.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">ah, i understand! OK, hopefully i can write this at this weekend! Have a 
nice day!

Am 22.10.2010 07:18, schrieb Andreas Faafeng via RT:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=62131">https://rt.cpan.org/Ticket/Display.html?id=62131</a></span>&gt;
&gt;
&gt; On Thu Oct 21 12:53:37 2010, Sadrak wrote:
&gt;    
<div class="message-stanza open">&gt;&gt; I added a small part of our dia as img to the bugreport, is this enough?
&gt;&gt; Or should i make a greater .dia with more komponents?
&gt;&gt;      
</div>&gt; If you could supply a .dia file that represents the image you already
&gt; have submitted, that would be ok. Optimally I would like 2 files: One
&gt; .dia file, and one test &#40;.t&#41; file that checks its content. E.g. like this
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/AFF/Parse-Dia-SQL-0.16_01/t/950-rt51433.t">http://cpansearch.perl.org/src/AFF/Parse-Dia-SQL-0.16_01/t/950-rt51433.t</a></span>
&gt;
&gt; Regards,
&gt; Andreas
&gt;    
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;15&nbsp;03:58:19&nbsp;2010</span>
    <span class="description">aff [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;26&nbsp;11:20:30&nbsp;2011</span>
    <span class="description">felix.ostmann [...] thewar.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> felix.ostmann [...] thewar.de</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have found another problem! I think the generated relations are always
wrong!

I tested with your test:

620-output-get-schema-create-many-to-many.t

And simple print out the 
print $subclass-&gt;get_associations_create&#40;&#41;;

That locks wrong!

It produce the following:

alter table student_course add constraint stdn_crs_fk_StntSn 
    foreign key &#40;course_id&#41;
    references student &#40;ssn&#41; on delete cascade;
alter table student_course add constraint lTeT8iBKfXObJYiSrq 
    foreign key &#40;ssn&#41;
    references course &#40;course_id&#41; on delete cascade;


So the ssn is referenced to the course_id and the course_id to the ssn!

It should be:

alter table student_course add constraint stdn_crs_fk_StntSn
    foreign key &#40;ssn&#41;
    references student &#40;ssn&#41; on delete cascade;
alter table student_course add constraint lTeT8iBKfXObJYiSrq
    foreign key &#40;course_id&#41;
    references course &#40;course_id&#41; on delete cascade;



And the constraint names are bad!



Perhaps i patched the wrong place:

the generate_many_to_many_association use the wrong roles, but i am not
sure if the arguments are wrong or internal the call to save_foreign_key
use the wrong role.


So the patch modify following:
- the test for many-to-many
- swaps $leftEnd{&#39;role&#39;} and $rightEnd{&#39;role&#39;} in
generate_many_to_many_association
- add -uml to the parsedia executable
- bigserial is equal to int8
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> parsediasql.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ru Parse-Dia-SQL-0.16/bin/parsediasql Parse-Dia-SQL-0.17/bin/parsediasql
--- Parse-Dia-SQL-0.16/bin/parsediasql	2010-01-18 21:39:17.000000000 +0100
+++ Parse-Dia-SQL-0.17/bin/parsediasql	2011-01-26 16:42:52.000000000 +0100
@@ -15,18 +15,20 @@
 my $file = undef;
 my $ignore_type_mismatch = undef;
 my $db   = undef;
+my $uml  = 0;
 
 GetOptions&#40;
   &#34;help|?&#34; =&gt; \$help,
   &#34;file=s&#34; =&gt; \$file,
   &#34;db=s&#34;   =&gt; \$db,
+  &#34;uml&#34;    =&gt; \$uml,
 	&#34;ignore_type_mismatch&#34; =&gt; \$ignore_type_mismatch, 
 &#41; or pod2usage&#40;2&#41;;
 pod2usage&#40;1&#41; if $help;
 pod2usage&#40;qq{Missing argument &#39;file&#39;}&#41; if !$file;
 pod2usage&#40;qq{Missing argument &#39;db&#39;}&#41; if !$db;
 
-my $dia = Parse::Dia::SQL-&gt;new&#40;file =&gt; $file, db =&gt; $db, ignore_type_mismatch =&gt; $ignore_type_mismatch&#41;;
+my $dia = Parse::Dia::SQL-&gt;new&#40;file =&gt; $file, db =&gt; $db, ignore_type_mismatch =&gt; $ignore_type_mismatch, uml =&gt; $uml&#41;;
 print $dia-&gt;get_sql&#40;&#41;;
 
 __END__
@@ -45,6 +47,7 @@
 
   file -  filename of Dia file
   db   -  Database type &#40;e.g. &#39;db2&#39;&#41;
+  uml  -  Using uml mode &#40;default is erd mode&#41;
   ignore_type_mismatch - Allows foreign keys to have a different 
           type than the primary key it references, if true.
 
diff -ru Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Utils.pm Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Utils.pm
--- Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL/Utils.pm	2010-02-02 08:30:36.000000000 +0100
+++ Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL/Utils.pm	2011-01-26 16:42:52.000000000 +0100
@@ -546,7 +546,7 @@
 			$self-&gt;{log}-&gt;info&#40;qq{Replaced $typeName with smallint}&#41; if $self-&gt;{log}-&gt;is_info&#40;&#41;;
       return &#39;smallint&#39;;
     }
-    if &#40; lc&#40;$typeName&#41; eq &#39;int8&#39; &#41; {
+    if &#40; lc&#40;$typeName&#41; eq &#39;bigserial&#39; or lc&#40;$typeName&#41; eq &#39;int8&#39; &#41; {
 			$self-&gt;{log}-&gt;info&#40;qq{Replaced $typeName with bigint}&#41; if $self-&gt;{log}-&gt;is_info&#40;&#41;;
       return &#39;bigint&#39;;
     }
diff -ru Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL.pm Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL.pm
--- Parse-Dia-SQL-0.16/lib/Parse/Dia/SQL.pm	2010-05-21 07:25:11.000000000 +0200
+++ Parse-Dia-SQL-0.17/lib/Parse/Dia/SQL.pm	2011-01-26 17:10:57.000000000 +0100
@@ -1370,13 +1370,13 @@
     &#38;&#38; $leftMult  =~ /^z?many$/
     &#38;&#38; $rightMult =~ /^z?many$/ &#41;
   {
-
     # If the classification above failed, and the association is
     # many-to-many; generate the centre &#40;join&#41; table, its constraints
     # and the classes&#39; primary keys &#40;if needed&#41;
     $ok = $self-&gt;generate_many_to_many_association&#40;
-      $assocName,  $leftClass, $leftEnd{&#39;role&#39;},
-      $rightClass, $rightEnd{&#39;role&#39;}
+      $assocName,
+      $leftClass,  $rightEnd{&#39;role&#39;},
+      $rightClass, $leftEnd{&#39;role&#39;},
     &#41;;
   }
   else {
diff -ru Parse-Dia-SQL-0.16/t/620-output-get-schema-create-many-to-many.t Parse-Dia-SQL-0.17/t/620-output-get-schema-create-many-to-many.t
--- Parse-Dia-SQL-0.16/t/620-output-get-schema-create-many-to-many.t	2009-11-13 09:28:23.000000000 +0100
+++ Parse-Dia-SQL-0.17/t/620-output-get-schema-create-many-to-many.t	2011-01-26 17:11:01.000000000 +0100
@@ -9,7 +9,7 @@
 use File::Spec::Functions;
 use lib catdir qw &#40; blib lib &#41;;
 
-plan tests =&gt; 14;
+plan tests =&gt; 16;
 
 use lib q{lib};
 use_ok &#40;&#39;Parse::Dia::SQL&#39;&#41;;
@@ -17,7 +17,7 @@
 use_ok &#40;&#39;Parse::Dia::SQL::Output::DB2&#39;&#41;;
 
 # 1. parse input
-my $diasql =  Parse::Dia::SQL-&gt;new&#40; file =&gt; catfile&#40;qw&#40;t data many_to_many.dia&#41;&#41;, db =&gt; &#39;db2&#39; &#41;;
+my $diasql =  Parse::Dia::SQL-&gt;new&#40; file =&gt; catfile&#40;qw&#40;t data many_to_many.dia&#41;&#41;, db =&gt; &#39;db2&#39;, uml =&gt; 1 &#41;;
 isa_ok&#40;$diasql, q{Parse::Dia::SQL}, q{Expect a Parse::Dia::SQL object}&#41;;
 is&#40;$diasql-&gt;convert&#40;&#41;, 1, q{Expect convert to return 1}&#41;;
 
@@ -53,6 +53,18 @@
   create \s+ table \s+ student_course \s*
 .*|six, q{Check syntax for sql create table student_course}&#41;;
 
-# Note: Associations are tested in 650-output-get-create-associations.t
+# 4. associations
+my $assoc  = $subclass-&gt;get_associations_create&#40;&#41;;
+
+like&#40;$assoc, qr|.*
+alter \s+ table \s+ student_course \s+ add \s+ constraint \s+ \w+ \s+
+foreign \s+ key \s+ \&#40;ssn\&#41; \s+
+references \s+ student \s+ \&#40;ssn\&#41; \s+ on \s+ delete \s+ cascade; \s*
+.*|six, q{Check syntax for sql alter table add constraint rel1}&#41;;
+like&#40;$assoc, qr|.*
+alter \s+ table \s+ student_course \s+ add \s+ constraint \s+ \w+ \s+
+foreign \s+ key \s+ \&#40;course_id\&#41; \s+
+references \s+ course \s+ \&#40;course_id\&#41; \s+ on \s+ delete \s+ cascade; \s*
+.*|six, q{Check syntax for sql alter table add constraint rel2}&#41;;
 
 __END__
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;26&nbsp;11:20:31&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;27&nbsp;04:38:53&nbsp;2011</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jan 26 11:20:30 2011, Sadrak wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have found another problem! I think the generated relations are always
&gt; wrong!
</div>
Thanks Felix, I will have a look at it.

-- 
Andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;15&nbsp;11:18:27&nbsp;2011</span>
    <span class="description">aff [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Felix 

Please check if 0.16_02 solves the issues.

Regards,
Andreas
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;15&nbsp;11:18:28&nbsp;2011</span>
    <span class="description">aff [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;16&nbsp;03:14:00&nbsp;2011</span>
    <span class="description">aff [...] cpan.org -  Fixed in 0.16_02 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;17&nbsp;02:03:33&nbsp;2011</span>
    <span class="description">aff [...] cpan.org -  Fixed in 0.17 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
