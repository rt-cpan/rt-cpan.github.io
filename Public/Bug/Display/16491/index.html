<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #16491 for Data-JavaScript-Anon: Use single quotes for strings</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #16491 for Data-JavaScript-Anon: Use single quotes for strings</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Data-JavaScript-Anon/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Data-JavaScript-Anon/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Data-JavaScript-Anon/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Data-JavaScript-Anon/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Data-JavaScript-Anon">Data-JavaScript-Anon CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">16491</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Data-JavaScript-Anon/Active/">Data-JavaScript-Anon</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
alexmv [...] bestpractical.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-9132-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-9133-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;14&nbsp;17:06:17&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Use single quotes for strings</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Data::JavaScript::Anon uses double quotes for constructing strings.  This makes it very hard to embed into onclick attributes and the like.  Luckily, double quotes and single quotes do the exact same thing in javascript.  As I see no advantage to using double quotes, I&#39;ve attached is a patch which switches to using single quotes when strings are needed.
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Only in Data-JavaScript-Anon-singlequote/: Makefile
Only in Data-JavaScript-Anon-singlequote/: blib
diff -ru Data-JavaScript-Anon-0.6/lib/Data/JavaScript/Anon.pm Data-JavaScript-Anon-singlequote/lib/Data/JavaScript/Anon.pm
--- Data-JavaScript-Anon-0.6/lib/Data/JavaScript/Anon.pm	2005-07-26 04:48:34.000000000 -0400
+++ Data-JavaScript-Anon-singlequote/lib/Data/JavaScript/Anon.pm	2005-12-14 16:49:45.000000000 -0500
@@ -170,7 +170,7 @@
 	return $value if $value =~ /$RE_NUMERIC/;
 
 	# Escape and quote
-	&#39;&#34;&#39; . _escape&#40;$value&#41; . &#39;&#34;&#39;;
+	&#34;&#39;&#34; . _escape&#40;$value&#41; . &#34;&#39;&#34;;
 }
 
 # Turn a single perl value into a javascript hash key
@@ -186,7 +186,7 @@
 	return $value if $value =~ /$RE_NUMERIC_HASHKEY/;
 
 	# Escape and quote
-	&#39;&#34;&#39; . _escape&#40;$value&#41; . &#39;&#34;&#39;;
+	&#34;&#39;&#34; . _escape&#40;$value&#41; . &#34;&#39;&#34;;
 }
 
 # Create a Javascript array given the javascript array name
@@ -222,7 +222,7 @@
 
 sub _escape {
 	my $text = shift;
-	$text =~ s/&#40;\&#34;|\\&#41;/\\$1/g;                              # Escape quotes and backslashes
+	$text =~ s/&#40;\&#39;|\\&#41;/\\$1/g;                              # Escape quotes and backslashes
 	$text =~ s/\n/\\n/g;                                    # Escape newlines in a readable way
 	$text =~ s/\r/\\r/g;                                    # Escape CRs in a readable way
 	$text =~ s/\t/\\t/g;                                    # Escape tabs in a readable way
Only in Data-JavaScript-Anon-singlequote/: pm_to_blib
diff -ru Data-JavaScript-Anon-0.6/t/02_results.t Data-JavaScript-Anon-singlequote/t/02_results.t
--- Data-JavaScript-Anon-0.6/t/02_results.t	2005-07-26 04:48:34.000000000 -0400
+++ Data-JavaScript-Anon-singlequote/t/02_results.t	2005-12-14 16:55:35.000000000 -0500
@@ -32,16 +32,16 @@
 	3com 2131.231fd2132 +0x21x
 };
 
-my @keywords = qw{
-        abstract boolean break byte case catch char class const continue
-        debugger default delete do double else enum export extends false final
-        finally float for function goto if implements import in instanceof int
-        interface long native new null package private protected public return
-        short static super switch synchronized this throw throws transient true
-        try typeof var void volatile while with
-};
-
-plan tests =&gt; &#40;@numbers + @not_numbers + @keywords + 5&#41;;
+my @keywords = qw{
+        abstract boolean break byte case catch char class const continue
+        debugger default delete do double else enum export extends false final
+        finally float for function goto if implements import in instanceof int
+        interface long native new null package private protected public return
+        short static super switch synchronized this throw throws transient true
+        try typeof var void volatile while with
+};
+
+plan tests =&gt; &#40;@numbers + @not_numbers + @keywords + 6&#41;;
 
 foreach &#40; @numbers &#41; {
 	ok&#40; Data::JavaScript::Anon-&gt;is_a_number&#40; $_ &#41;, &#34;$_ is a number&#34; &#41;;
@@ -50,34 +50,38 @@
 	ok&#40; ! Data::JavaScript::Anon-&gt;is_a_number&#40; $_ &#41;, &#34;$_ is not a number&#34; &#41;;
 }
 
-# Test that keywords come out quoted
-foreach &#40; @keywords &#41; {
-        is&#40; Data::JavaScript::Anon-&gt;anon_hash_key&#40;$_&#41;, &#39;&#34;&#39; . $_ . &#39;&#34;&#39;,
-            &#34;anon_hash_key correctly quotes keyword $_ used as hash key&#34; &#41;;
+# Test that keywords come out quoted
+foreach &#40; @keywords &#41; {
+        is&#40; Data::JavaScript::Anon-&gt;anon_hash_key&#40;$_&#41;, &#39;&#34;&#39; . $_ . &#39;&#34;&#39;,
+            &#34;anon_hash_key correctly quotes keyword $_ used as hash key&#34; &#41;;
 }
 
 
 
 # Do a simple test of most of the code in a single go
 my $rv = Data::JavaScript::Anon-&gt;anon_dump&#40; [ &#39;a&#39;, 1, { a =&gt; { a =&gt; 1, } }, \&#34;foo&#34; ] &#41;;
-is&#40; $rv, &#39;[ &#34;a&#34;, 1, { a: { a: 1 } }, &#34;foo&#34; ]&#39;,
+is&#40; $rv, q|[ &#39;a&#39;, 1, { a: { a: 1 } }, &#39;foo&#39; ]|,
 	&#39;Generates expected output for simple combination struct&#39; &#41;;
 
 # Test for CPAN bug #7183
-is&#40; Data::JavaScript::Anon-&gt;anon_hash_key&#40; &#34;0596000278&#34; &#41;, &#39;&#34;0596000278&#34;&#39;,
+is&#40; Data::JavaScript::Anon-&gt;anon_hash_key&#40; &#34;0596000278&#34; &#41;, q|&#39;0596000278&#39;|,
 	&#39;anon_hash_key correctly escapes 0-leading non-octal&#39; &#41;;
 
 # Test for CPAN bug #11882 &#40;forward slash not being escaped&#41;
-is&#40; Data::JavaScript::Anon-&gt;anon_scalar&#40; &#39;C:\\devel&#39; &#41;, &#39;&#34;C:\\\\devel&#34;&#39;,
+is&#40; Data::JavaScript::Anon-&gt;anon_scalar&#40; &#39;C:\\devel&#39; &#41;, q|&#39;C:\\\\devel&#39;|,
 	&#39;anon_scalar correctly escapes forward slashes&#39; &#41;;
 
-# Also make sure double quotes are escaped
-is&#40; Data::JavaScript::Anon-&gt;anon_scalar&#40; &#39;foo&#34;bar&#39; &#41;, &#39;&#34;foo\\&#34;bar&#34;&#39;,
-	&#39;anon_scalar correctly escapes double quotes&#39; &#41;;
+# Make sure double quotes are not escaped
+is&#40; Data::JavaScript::Anon-&gt;anon_scalar&#40; &#39;foo&#34;bar&#39; &#41;, q|&#39;foo&#34;bar&#39;|,
+	&#34;anon_scalar correctly doesn&#39;t escape double quotes&#34; &#41;;
+
+# Also make sure single quotes are escaped
+is&#40; Data::JavaScript::Anon-&gt;anon_scalar&#40; &#34;foo&#39;bar&#34; &#41;, q|&#39;foo\\&#39;bar&#39;|,
+	&#39;anon_scalar correctly escapes single quotes&#39; &#41;;
 
 # Test for generalised case of CPAN bug # &#40;newline not being escaped&#41;
-$rv = Data::JavaScript::Anon-&gt;anon_dump&#40; [ &#34;a\nb&#34;, &#34;a\rb&#34;, &#34;a	b&#34;, &#34;a\&#34;b&#34;, &#34;a\bb&#34; ] &#41;;
-is&#40; $rv, &#39;[ &#34;a\nb&#34;, &#34;a\rb&#34;, &#34;a\tb&#34;, &#34;a\\&#34;b&#34;, &#34;a\010b&#34; ]&#39;, &#39;escape tabs, newlines, CRs and control chars&#39;&#41;;
+$rv = Data::JavaScript::Anon-&gt;anon_dump&#40; [ &#34;a\nb&#34;, &#34;a\rb&#34;, &#34;a	b&#34;, &#34;a&#39;b&#34;, &#34;a\bb&#34; ] &#41;;
+is&#40; $rv, q|[ &#39;a\nb&#39;, &#39;a\rb&#39;, &#39;a\tb&#39;, &#39;a\\&#39;b&#39;, &#39;a\010b&#39; ]|, &#39;escape tabs, newlines, CRs and control chars&#39;&#41;;
 
 
 1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;15&nbsp;00:24:09&nbsp;2005</span>
    <span class="description">adam [...] phase-n.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 15 Dec 2005 16:21:27 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adam [...] phase-n.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Data-JavaScript-Anon [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [cpan #16491] Use single quotes for strings</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-Cc:</td>
    <td class="message-header-value"> </td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Internet explorer does not treat single quotes the same as double quotes.

The general rule is to use double quotes as often as possible.

That said, I&#39;m not entirely sure what the specifics of this problem is 
as I only have it second hand from the JSAN project people.

Until someone can clear up what the issue is for me, I won&#39;t be applying 
this patch.

Adam K

Guest via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This message about Data-JavaScript-Anon was sent to you by guest &lt;&gt; via rt.cpan.org
&gt; 
&gt; Full context and any attached attachments can be found at:
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=16491">https://rt.cpan.org/Ticket/Display.html?id=16491</a></span> &gt;
&gt; 
&gt; Data::JavaScript::Anon uses double quotes for constructing strings.  This makes it very hard to embed into onclick attributes and the like.  Luckily, double quotes and single quotes do the exact same thing in javascript.  As I see no advantage to using double quotes, I&#39;ve attached is a patch which switches to using single quotes when strings are needed.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;19&nbsp;09:17:27&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Dorward &lt;david [...] dorward.me.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Dec 14 17:06:17 2005, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Data::JavaScript::Anon uses double quotes for constructing strings.
&gt;    This makes it very hard to embed into onclick attributes and the
&gt;    like.  
</div>
The return value can be pushed through HTML::Entities, or you can quote 
your attribute values with single quotes.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;19&nbsp;09:17:28&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
