<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #49820 for Net-SSH-Perl: Win32 support for Net::SSH::Perl</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #49820 for Net-SSH-Perl: Win32 support for Net::SSH::Perl</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Net-SSH-Perl">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Net-SSH-Perl">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Net-SSH-Perl">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Net-SSH-Perl">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-SSH-Perl">Net-SSH-Perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">49820</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Net-SSH-Perl">Net-SSH-Perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">greg [...] turnstep.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
perl [...] csjewell.fastmail.us

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
CHORNY [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23272-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23273-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




perldiff.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/666049/341968/perldiff.txt">
Sat Sep 19 12:36:37 2009 (1017b) by r.douglas.reed [...] gmail.com
</a>
</font></li>
</ul>


PerlSSHHack.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/666049/341969/PerlSSHHack.tar.gz">
Sat Sep 19 12:36:37 2009 (16.3k) by r.douglas.reed [...] gmail.com
</a>
</font></li>
</ul>


ssh2diff.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/666049/341970/ssh2diff.txt">
Sat Sep 19 12:36:37 2009 (302b) by r.douglas.reed [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=49820">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-665706" href="/Public/Bug/Display.html?id=49820#txn-665706">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;18&nbsp;15:46:09&nbsp;2009</span>
    <span class="description">perl [...] csjewell.fastmail.us -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Adam Kennedy&#34; &lt;adamkennedybackup [...] gmail.com&gt;, &#34;kmx&#34; &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 18 Sep 2009 13:45:41 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Doug Reed&#34; &lt;r.douglas.reed [...] gmail.com&gt;, bug-Net-SSH-Perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Curtis Jewell&#34; &lt;perl [...] csjewell.fastmail.us&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/665706/341777/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/341777">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">

On Thu, 17 Sep 2009 10:27 -0400, &#34;Doug Reed&#34; &lt;r.douglas.reed@gmail.com&gt;
wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Curtis,
&gt; I see you opened a ticket on Net::SSH::Perl recently and stated that you
&gt; intend to include this module in Strawberry in the October release.
&gt; 
&gt; I wonder if you have had any success in getting this module to work.  I
&gt; can
&gt; compile and install it, and with a bit of hacking got it to ALMOST work.
</div>
I&#39;ve gotten it to install &#40;I just say local $ENV{HOME} =
$ENV{USERPROFILE} during the build&#41;, but haven&#39;t actually tried it or
looked at it much, as of yet.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have a need for SSH1 and SSH2 to support Router and Switch maintenance,
&gt; and this support needs to be cross platform.
&gt; 
&gt; I have not opened a ticket on CPAN, because from what I can see, this
&gt; module
&gt; is no longer supported, which is a shame because there is nothing to
&gt; fully
&gt; replace it.  Net::SSH2 can do SSH2 protocol, but not SSH1.  Anyway, with
&gt; this in mind, I have tried to look at it myself to see if I could get it
&gt; to
&gt; work in Strawberry, because it meets my needs on every other platform.
</div>
If I have to, I&#39;ll ask about taking it up - but I have to admit that I
don&#39;t think I have access to an ssh-using server to test it against at
the moment... 
but maybe I do.  I&#39;ll check.

Would you mind sending me a patch against the current version to start
with?

It may have to get pulled out of October if the situation is as bad as
you say it is.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The module out of the box only supports Unix.  i.e. It makes assumptions
&gt; about $HOME and such.  I have played with it, and fixed all of that stuff
</div>
That can be changed to File::Homedir::my_home&#40;&#41; easily enough. The other
things may be tougher.  I&#39;m cc&#39;ing a few other people for advice, and
also cc&#39;ing the bug address so that this gets logged as a ticket.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; and have it almost working in Windows, but it seems that it gets no data
&gt; from the socket once it gets to &#39;client_loop&#39;, which is odd since it does
&gt; logon and do authentication, so data is flowing until it gets to
&gt; &#39;client_loop&#39;, and then it seems to loop between &#39;prepare_channels&#39; and
&gt; &#39;prepare_for_select&#39; because it seems that $rb and $wb &#40;which are
&gt; pointers
&gt; to anonomous arrays&#41; are always empty.  ..  Or to put it another way... 
&gt; It
&gt; gets as far as &#39;close_read&#39; &#40;if you run it with debug on&#41; and then loops
&gt; presumably because it never empties the buffer.  In an effort to debug
&gt; the
&gt; code I found that &#39;prepare_for_select&#39; is entered once with &#40;&#40;!$rfd&#41; &#38;&#38;
&gt; CHAN_INPUT_OPEN&#41;, then on the next loop &#40;&#40;$rfd&#41; &#38;&#38; CHAN_INPUT_CLOSED&#41;,
&gt; but
&gt; since it only calls add&#40;&#41; when &#40;&#40;$rfd&#41; &#38;&#38; CHAN_INPUT_OPEN&#41;, add&#40;&#41; never
&gt; gets
&gt; called.
&gt; 
&gt; There is also Net::SSH::Win32Perl, but that code seems to change nothing
&gt; at
&gt; all.  I guess it gets past the blocking&#40;&#41; problem which I solved In the
&gt; native code by simply testing &#39;$^O&#39;  It still loops at &#39;close_read&#39;
&gt; trying
&gt; to read the data.  Maybe this used to work with some ancient version and
&gt; some change has broken it in the loop above so that it no longer works.
&gt;  Anyway, I decided to ignore it completely and see if I could hack the
&gt; native module into submission, but I am not good enough at debugging PERL
&gt; to
&gt; get farther than I have, so I thought I would pass my findings onto you
&gt; to
&gt; see if my findings would help.
&gt; 
&gt; I think it would work OK if the looping problem were fixed.  &#40;Maybe it
&gt; should use IO::Socket::INET instead of the native socket interface to
&gt; easily
&gt; get past the non-blocking problem since I think IO::Socket::INET
&gt; &#39;normalizes&#39; the blocking interface.  The Native interface requires
&gt; different handling for Windows...  Which is how I fixed it, but then it
&gt; is
&gt; harder to make it platform independent.&#41;
&gt; 
&gt; In the end, the simple question is has anyone ever figured out how to get
&gt; Net::SSH::Perl to work in Windows?
</div>
I don&#39;t know.
--
Curtis Jewell
swordsman@csjewell.fastmail.us

%DCL-E-MEM-BAD, bad memory
-VMS-F-PDGERS, pudding between the ears

[I use PC-Alpine, which deliberately does not display colors and pictures in HTML mail]
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-665721" href="/Public/Bug/Display.html?id=49820#txn-665721">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;18&nbsp;17:33:11&nbsp;2009</span>
    <span class="description">perl [...] csjewell.fastmail.us -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Doug Reed&#34; &lt;r.douglas.reed [...] gmail.com&gt;, &#34;Adam Kennedy&#34; &lt;adamkennedybackup [...] gmail.com&gt;, &#34;kmx&#34; &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 18 Sep 2009 15:32:52 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;Bugs in Net-SSH-Perl via RT&#34; &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Curtis Jewell&#34; &lt;perl [...] csjewell.fastmail.us&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/665721/341786/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/341786">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I have not opened a ticket on CPAN, because from what I can see, this
&gt; &gt; module
&gt; &gt; is no longer supported, which is a shame because there is nothing to
&gt; &gt; fully
&gt; &gt; replace it.  Net::SSH2 can do SSH2 protocol, but not SSH1.  Anyway, with
&gt; &gt; this in mind, I have tried to look at it myself to see if I could get it
&gt; &gt; to
&gt; &gt; work in Strawberry, because it meets my needs on every other platform.
</div>&gt; 
&gt; If I have to, I&#39;ll ask about taking it up - but I have to admit that I
&gt; don&#39;t think I have access to an ssh-using server to test it against at
&gt; the moment... 
&gt; but maybe I do.  I&#39;ll check.
</div>
&#34;not actively supported&#34; may be too strong - the maintainer just
released a new version of another module that Strawberry uses yesterday
&#40;should have checked who the maintainer was first.&#41;
 
Greg? Any help here? Any help I or Doug can offer? Would you need a
&#34;pre-beta&#34; build of Strawberry to test that includes all the
prerequisites?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Would you mind sending me a patch against the current version to start
&gt; with?
</div>
Attach it to the bug, too.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It may have to get pulled out of October if the situation is as bad as
&gt; you say it is.
</div> 
And right now Convert::PEM has suddenly &#40;as in since 30 hours ago&#41;
started failing tests - I&#39;m going to have to find whatever other module
is breaking it and get it to build again before I attack this bug - but
that won&#39;t be long!

--Curtis
--
Curtis Jewell
swordsman@csjewell.fastmail.us

%DCL-E-MEM-BAD, bad memory
-VMS-F-PDGERS, pudding between the ears

[I use PC-Alpine, which deliberately does not display colors and pictures in HTML mail]
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666049" href="/Public/Bug/Display.html?id=49820#txn-666049">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;19&nbsp;12:36:37&nbsp;2009</span>
    <span class="description">r.douglas.reed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;,  Adam Kennedy &lt;adamkennedybackup [...] gmail.com&gt;, kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 19 Sep 2009 12:35:54 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666049/341968/perldiff.txt">Download perldiff.txt</a><br />
<span class="downloadcontenttype">text/plain 1017b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666049/341969/PerlSSHHack.tar.gz">Download PerlSSHHack.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gzip 16.3k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666049/341970/ssh2diff.txt">Download ssh2diff.txt</a><br />
<span class="downloadcontenttype">text/plain 302b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666049/341966/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/341966">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Curtis, &#40;and listeners&#41;,
Attached, please find the &#39;patches&#39; I made to handle Windows.  I don&#39;t have
an account on CPAN, so I don&#39;t really know how to attach them to the problem
you opened.  I am sure I could figure it out, but, my wife has something she
needs me to do. :-&#41;

I cannot really call them patches because they cannot be deployed as is.  I
need to be able to do:

if &#40;$^O =~ /MSWin32/&#41; {
   use Win32;
}

But that will not work because &#39;use&#39; is done at script load and not at
execute.  There MUST be some way do do this, but I don&#39;t know it.  I changed
it to &#39;require&#39;, but then the load failed with unresolved symbols down in
the code, so this is something PERLish I don&#39;t know how to do.  In the end,
there is nothing wrong with the code except that we don&#39;t want to &#39;use
Win32;&#39; on Unix systems.

Thanque for looking into this.  I will help if I can as I need this to work,
and we are REALLY close!


On Fri, Sep 18, 2009 at 5:32 PM, Curtis Jewell &lt;perl@csjewell.fastmail.us&gt;wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; I have not opened a ticket on CPAN, because from what I can see, this
&gt; &gt; &gt; module
&gt; &gt; &gt; is no longer supported, which is a shame because there is nothing to
&gt; &gt; &gt; fully
&gt; &gt; &gt; replace it.  Net::SSH2 can do SSH2 protocol, but not SSH1.  Anyway,
</div></div>&gt; with
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; this in mind, I have tried to look at it myself to see if I could get
</div></div>&gt; it
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; to
&gt; &gt; &gt; work in Strawberry, because it meets my needs on every other platform.
</div>&gt; &gt;
&gt; &gt; If I have to, I&#39;ll ask about taking it up - but I have to admit that I
&gt; &gt; don&#39;t think I have access to an ssh-using server to test it against at
&gt; &gt; the moment...
&gt; &gt; but maybe I do.  I&#39;ll check.
</div>&gt;
&gt; &#34;not actively supported&#34; may be too strong - the maintainer just
&gt; released a new version of another module that Strawberry uses yesterday
&gt; &#40;should have checked who the maintainer was first.&#41;
&gt;
&gt; Greg? Any help here? Any help I or Doug can offer? Would you need a
&gt; &#34;pre-beta&#34; build of Strawberry to test that includes all the
&gt; prerequisites?
&gt;
<div class="message-stanza open">&gt; &gt; Would you mind sending me a patch against the current version to start
&gt; &gt; with?
</div>&gt;
&gt; Attach it to the bug, too.
&gt;
<div class="message-stanza open">&gt; &gt; It may have to get pulled out of October if the situation is as bad as
&gt; &gt; you say it is.
</div>&gt;
&gt; And right now Convert::PEM has suddenly &#40;as in since 30 hours ago&#41;
&gt; started failing tests - I&#39;m going to have to find whatever other module
&gt; is breaking it and get it to build again before I attack this bug - but
&gt; that won&#39;t be long!
&gt;
&gt; --Curtis
&gt; --
&gt; Curtis Jewell
&gt; swordsman@csjewell.fastmail.us
&gt;
&gt; %DCL-E-MEM-BAD, bad memory
&gt; -VMS-F-PDGERS, pudding between the ears
&gt;
&gt; [I use PC-Alpine, which deliberately does not display colors and pictures
&gt; in HTML mail]
&gt;
&gt;
</div>

-- 
Regards,

Doug
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666049/341967/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/341967">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.3k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666050" href="/Public/Bug/Display.html?id=49820#txn-666050">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;19&nbsp;12:36:39&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666245" href="/Public/Bug/Display.html?id=49820#txn-666245">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;20&nbsp;01:47:15&nbsp;2009</span>
    <span class="description">adam [...] ali.as -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;, kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 20 Sep 2009 15:46:54 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Adam Kennedy &lt;adamkennedybackup [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666245/342084/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342084">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">One option is to have the functions called directly in
Win32::whatever&#40;&#41; and to NOT export them.

The other is to make the whole thing happen at compile time with...

BEGIN {
    if &#40; $^O eq &#39;MSWin32&#39; &#41; {
        require Win32;
        Win32-&gt;import;
    }
}

2009/9/20 Doug Reed &lt;r.douglas.reed@gmail.com&gt;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Curtis, &#40;and listeners&#41;,
&gt; Attached, please find the &#39;patches&#39; I made to handle Windows. Â I don&#39;t have
&gt; an account on CPAN, so I don&#39;t really know how to attach them to the problem
&gt; you opened. Â I am sure I could figure it out, but, my wife has something she
&gt; needs me to do. :-&#41;
&gt; I cannot really call them patches because they cannot be deployed as is. Â I
&gt; need to be able to do:
&gt; if &#40;$^O =~ /MSWin32/&#41; {
&gt; Â Â  use Win32;
&gt; }
&gt; But that will not work because &#39;use&#39; is done at script load and not at
&gt; execute. Â There MUST be some way do do this, but I don&#39;t know it. Â I changed
&gt; it to &#39;require&#39;, but then the load failed with unresolved symbols down in
&gt; the code, so this is something PERLish I don&#39;t know how to do. Â In the end,
&gt; there is nothing wrong with the code except that we don&#39;t want to &#39;use
&gt; Win32;&#39; on Unix systems.
&gt; Thanque for looking into this. Â I will help if I can as I need this to work,
&gt; and we are REALLY close!
&gt;
&gt; On Fri, Sep 18, 2009 at 5:32 PM, Curtis Jewell &lt;perl@csjewell.fastmail.us&gt;
&gt; wrote:
<div class="message-stanza open">&gt;&gt;
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt; &gt; I have not opened a ticket on CPAN, because from what I can see, this
&gt;&gt; &gt; &gt; module
&gt;&gt; &gt; &gt; is no longer supported, which is a shame because there is nothing to
&gt;&gt; &gt; &gt; fully
&gt;&gt; &gt; &gt; replace it. Â Net::SSH2 can do SSH2 protocol, but not SSH1. Â Anyway,
&gt;&gt; &gt; &gt; with
&gt;&gt; &gt; &gt; this in mind, I have tried to look at it myself to see if I could get
&gt;&gt; &gt; &gt; it
&gt;&gt; &gt; &gt; to
&gt;&gt; &gt; &gt; work in Strawberry, because it meets my needs on every other platform.
</div>&gt;&gt; &gt;
&gt;&gt; &gt; If I have to, I&#39;ll ask about taking it up - but I have to admit that I
&gt;&gt; &gt; don&#39;t think I have access to an ssh-using server to test it against at
&gt;&gt; &gt; the moment...
&gt;&gt; &gt; but maybe I do. Â I&#39;ll check.
</div>&gt;&gt;
&gt;&gt; &#34;not actively supported&#34; may be too strong - the maintainer just
&gt;&gt; released a new version of another module that Strawberry uses yesterday
&gt;&gt; &#40;should have checked who the maintainer was first.&#41;
&gt;&gt;
&gt;&gt; Greg? Any help here? Any help I or Doug can offer? Would you need a
&gt;&gt; &#34;pre-beta&#34; build of Strawberry to test that includes all the
&gt;&gt; prerequisites?
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt; Would you mind sending me a patch against the current version to start
&gt;&gt; &gt; with?
</div>&gt;&gt;
&gt;&gt; Attach it to the bug, too.
&gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt; It may have to get pulled out of October if the situation is as bad as
&gt;&gt; &gt; you say it is.
</div>&gt;&gt;
&gt;&gt; And right now Convert::PEM has suddenly &#40;as in since 30 hours ago&#41;
&gt;&gt; started failing tests - I&#39;m going to have to find whatever other module
&gt;&gt; is breaking it and get it to build again before I attack this bug - but
&gt;&gt; that won&#39;t be long!
&gt;&gt;
&gt;&gt; --Curtis
&gt;&gt; --
&gt;&gt; Curtis Jewell
&gt;&gt; swordsman@csjewell.fastmail.us
&gt;&gt;
&gt;&gt; %DCL-E-MEM-BAD, bad memory
&gt;&gt; -VMS-F-PDGERS, pudding between the ears
&gt;&gt;
&gt;&gt; [I use PC-Alpine, which deliberately does not display colors and pictures
&gt;&gt; in HTML mail]
&gt;&gt;
</div>&gt;
&gt;
&gt;
&gt; --
&gt; Regards,
&gt;
&gt; Doug
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666258" href="/Public/Bug/Display.html?id=49820#txn-666258">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;20&nbsp;06:04:28&nbsp;2009</span>
    <span class="description">r.douglas.reed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;, kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 20 Sep 2009 06:04:07 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> adam [...] ali.as</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666258/342092/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342092">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Adam,
I tried doing both, but when the code referenced the win32 functions in the
code, it complained about &#39;barewords&#39; under strict mode where the functions
were used at compile time.  I hate &#39;strict&#39; and never use it, but I don&#39;t
write stuff for CPAN.


On Sun, Sep 20, 2009 at 1:46 AM, Adam Kennedy
&lt;adamkennedybackup@gmail.com&gt;wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; One option is to have the functions called directly in
&gt; Win32::whatever&#40;&#41; and to NOT export them.
&gt;
&gt; The other is to make the whole thing happen at compile time with...
&gt;
&gt; BEGIN {
&gt;    if &#40; $^O eq &#39;MSWin32&#39; &#41; {
&gt;        require Win32;
&gt;        Win32-&gt;import;
&gt;    }
&gt; }
</div>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2009/9/20 Doug Reed &lt;r.douglas.reed@gmail.com&gt;:
<div class="message-stanza open">&gt; &gt; Curtis, &#40;and listeners&#41;,
&gt; &gt; Attached, please find the &#39;patches&#39; I made to handle Windows.  I don&#39;t
</div>&gt; have
<div class="message-stanza open">&gt; &gt; an account on CPAN, so I don&#39;t really know how to attach them to the
</div>&gt; problem
<div class="message-stanza open">&gt; &gt; you opened.  I am sure I could figure it out, but, my wife has something
</div>&gt; she
<div class="message-stanza open">&gt; &gt; needs me to do. :-&#41;
&gt; &gt; I cannot really call them patches because they cannot be deployed as is.
</div>&gt;  I
<div class="message-stanza open">&gt; &gt; need to be able to do:
&gt; &gt; if &#40;$^O =~ /MSWin32/&#41; {
&gt; &gt;    use Win32;
&gt; &gt; }
&gt; &gt; But that will not work because &#39;use&#39; is done at script load and not at
&gt; &gt; execute.  There MUST be some way do do this, but I don&#39;t know it.  I
</div>&gt; changed
<div class="message-stanza open">&gt; &gt; it to &#39;require&#39;, but then the load failed with unresolved symbols down in
&gt; &gt; the code, so this is something PERLish I don&#39;t know how to do.  In the
</div>&gt; end,
<div class="message-stanza open">&gt; &gt; there is nothing wrong with the code except that we don&#39;t want to &#39;use
&gt; &gt; Win32;&#39; on Unix systems.
&gt; &gt; Thanque for looking into this.  I will help if I can as I need this to
</div>&gt; work,
<div class="message-stanza open">&gt; &gt; and we are REALLY close!
&gt; &gt;
&gt; &gt; On Fri, Sep 18, 2009 at 5:32 PM, Curtis Jewell &lt;
</div>&gt; perl@csjewell.fastmail.us&gt;
<div class="message-stanza open">&gt; &gt; wrote:
<div class="message-stanza open">&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt; &gt; &gt; I have not opened a ticket on CPAN, because from what I can see,
</div></div></div>&gt; this
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; &gt; &gt; module
&gt; &gt;&gt; &gt; &gt; is no longer supported, which is a shame because there is nothing to
&gt; &gt;&gt; &gt; &gt; fully
&gt; &gt;&gt; &gt; &gt; replace it.  Net::SSH2 can do SSH2 protocol, but not SSH1.  Anyway,
&gt; &gt;&gt; &gt; &gt; with
&gt; &gt;&gt; &gt; &gt; this in mind, I have tried to look at it myself to see if I could
</div></div>&gt; get
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; &gt; &gt; it
&gt; &gt;&gt; &gt; &gt; to
&gt; &gt;&gt; &gt; &gt; work in Strawberry, because it meets my needs on every other
</div></div>&gt; platform.
<div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; &gt;
&gt; &gt;&gt; &gt; If I have to, I&#39;ll ask about taking it up - but I have to admit that I
&gt; &gt;&gt; &gt; don&#39;t think I have access to an ssh-using server to test it against at
&gt; &gt;&gt; &gt; the moment...
&gt; &gt;&gt; &gt; but maybe I do.  I&#39;ll check.
</div>&gt; &gt;&gt;
&gt; &gt;&gt; &#34;not actively supported&#34; may be too strong - the maintainer just
&gt; &gt;&gt; released a new version of another module that Strawberry uses yesterday
&gt; &gt;&gt; &#40;should have checked who the maintainer was first.&#41;
&gt; &gt;&gt;
&gt; &gt;&gt; Greg? Any help here? Any help I or Doug can offer? Would you need a
&gt; &gt;&gt; &#34;pre-beta&#34; build of Strawberry to test that includes all the
&gt; &gt;&gt; prerequisites?
&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt; &gt; Would you mind sending me a patch against the current version to start
&gt; &gt;&gt; &gt; with?
</div>&gt; &gt;&gt;
&gt; &gt;&gt; Attach it to the bug, too.
&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt; &gt; It may have to get pulled out of October if the situation is as bad as
&gt; &gt;&gt; &gt; you say it is.
</div>&gt; &gt;&gt;
&gt; &gt;&gt; And right now Convert::PEM has suddenly &#40;as in since 30 hours ago&#41;
&gt; &gt;&gt; started failing tests - I&#39;m going to have to find whatever other module
&gt; &gt;&gt; is breaking it and get it to build again before I attack this bug - but
&gt; &gt;&gt; that won&#39;t be long!
&gt; &gt;&gt;
&gt; &gt;&gt; --Curtis
&gt; &gt;&gt; --
&gt; &gt;&gt; Curtis Jewell
&gt; &gt;&gt; swordsman@csjewell.fastmail.us
&gt; &gt;&gt;
&gt; &gt;&gt; %DCL-E-MEM-BAD, bad memory
&gt; &gt;&gt; -VMS-F-PDGERS, pudding between the ears
&gt; &gt;&gt;
&gt; &gt;&gt; [I use PC-Alpine, which deliberately does not display colors and
</div></div>&gt; pictures
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; in HTML mail]
&gt; &gt;&gt;
</div>&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Regards,
&gt; &gt;
&gt; &gt; Doug
&gt; &gt;
</div>&gt;
</div>


-- 
Regards,

Doug
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666258/342093/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342093">with headers</a>
<br />
<span class="downloadcontenttype">text/html 4.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666322" href="/Public/Bug/Display.html?id=49820#txn-666322">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;20&nbsp;11:31:42&nbsp;2009</span>
    <span class="description">r.douglas.reed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;, kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 20 Sep 2009 11:31:20 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> adam [...] ali.as</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666322/342145/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342145">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 8.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">All,
I realized my e-mail was going into the ticket!  So I thought I would show
the symptoms.  Below are two examples from the same Win32 host to the same
Linux host.  The first example is running through Cygwin &#40;which works&#41;, and
the second is through Strawberry &#40;which loops&#41;.

Here is the test script:
use Net::SSH::Perl;
my $ssh = Net::SSH::Perl-&gt;new&#40;&#34;laura&#34;, debug=&gt;1, protocol=&gt;2&#41;;
$ssh-&gt;login&#40;&#34;dreed&#34;, &#34;*******&#34;&#41;;
@Out = $ssh-&gt;cmd&#40;&#34;ls&#34;&#41;;
foreach $File &#40;@Out&#41; {
   print $File
}


Cygwin:
HP_Administrator@Vanessa:~$ perl /c/Downloads/testssh.pl
Vanessa: Reading configuration data /home/HP_Administrator/.ssh/config
Vanessa: Reading configuration data /etc/ssh_config
Vanessa: Connecting to laura, port 22.
Vanessa: Remote protocol version 2.0, remote software version OpenSSH_5.1p1
Debian-5ubuntu1
Vanessa: Net::SSH::Perl Version 1.34, protocol version 2.0.
.anessa: No compat match: OpenSSH_5.1p1 Debian-5ubuntu1
Vanessa: Connection established.
Vanessa: Sent key-exchange init &#40;KEXINIT&#41;, wait response.
Vanessa: Algorithms, c-&gt;s: 3des-cbc hmac-sha1 none
Vanessa: Algorithms, s-&gt;c: 3des-cbc hmac-sha1 none
Vanessa: Entering Diffie-Hellman Group 1 key exchange.
Vanessa: Sent DH public key, waiting for reply.
Vanessa: Received host key, type &#39;ssh-dss&#39;.
Vanessa: Host &#39;laura&#39; is known and matches the host key.
Vanessa: Computing shared secret key.
Vanessa: Verifying server signature.
Vanessa: Waiting for NEWKEYS message.
Vanessa: Send NEWKEYS.
Vanessa: Enabling encryption/MAC/compression.
Vanessa: Sending request for user-authentication service.
Vanessa: Service accepted: ssh-userauth.
Vanessa: Trying empty user-authentication request.
Vanessa: Authentication methods that can continue: publickey,password.
Vanessa: Next method to try is publickey.
Vanessa: Next method to try is password.
Vanessa: Trying password authentication.
Vanessa: Login completed, opening dummy shell channel.
Vanessa: channel 0: new [client-session]
Vanessa: Requesting channel_open for channel 0.
Vanessa: channel 0: open confirm rwindow 0 rmax 32768
Vanessa: Got channel open confirmation, requesting shell.
Vanessa: Requesting service shell on channel 0.
Vanessa: channel 1: new [client-session]
Vanessa: Requesting channel_open for channel 1.
Vanessa: Entering interactive session.
Vanessa: Sending command: ls
Vanessa: Sending command: ls
Vanessa: Requesting service exec on channel 1.
Vanessa: channel 1: open confirm rwindow 0 rmax 32768
Vanessa: input_channel_request: rtype exit-status reply 0
Vanessa: channel 1: rcvd eof
Vanessa: channel 1: output open -&gt; drain
Vanessa: channel 1: rcvd close
Vanessa: channel 1: input open -&gt; closed
Vanessa: channel 1: close_read
Vanessa: channel 1: obuf empty
Vanessa: channel 1: output drain -&gt; closed
Vanessa: channel 1: close_write
Vanessa: channel 1: send close
Vanessa: channel 1: full closed
Desktop
Documents
Music
Pictures
Public
screen-configurations.xml
Templates
testssh.pl
Videos
HP_Administrator@Vanessa:~$


Strawberry:
C:\strawberry\perl\bin&gt;perl \Downloads\testssh.pl
Vanessa: Reading configuration data C:\Documents and
Settings\HP_Administrator/.ssh/config
Vanessa: Reading configuration data /etc/ssh_config
Vanessa: Connecting to laura, port 22.
Vanessa: Remote protocol version 2.0, remote software version OpenSSH_5.1p1
Debian-5ubuntu1
Vanessa: Net::SSH::Perl Version 1.34, protocol version 2.0.
.anessa: No compat match: OpenSSH_5.1p1 Debian-5ubuntu1
Vanessa: Connection established.
Vanessa: Sent key-exchange init &#40;KEXINIT&#41;, wait response.
Vanessa: Algorithms, c-&gt;s: 3des-cbc hmac-sha1 none
Vanessa: Algorithms, s-&gt;c: 3des-cbc hmac-sha1 none
Vanessa: Entering Diffie-Hellman Group 1 key exchange.
Vanessa: Sent DH public key, waiting for reply.
Vanessa: Received host key, type &#39;ssh-dss&#39;.
Vanessa: Host &#39;laura&#39; is known and matches the host key.
Vanessa: Computing shared secret key.
Vanessa: Verifying server signature.
Vanessa: Waiting for NEWKEYS message.
Vanessa: Send NEWKEYS.
Vanessa: Enabling encryption/MAC/compression.
Vanessa: Sending request for user-authentication service.
Vanessa: Service accepted: ssh-userauth.
Vanessa: Trying empty user-authentication request.
Vanessa: Authentication methods that can continue: publickey,password.
Vanessa: Next method to try is publickey.
Vanessa: Next method to try is password.
Vanessa: Trying password authentication.
Vanessa: Login completed, opening dummy shell channel.
Vanessa: channel 0: new [client-session]
Vanessa: Requesting channel_open for channel 0.
Vanessa: channel 0: open confirm rwindow 0 rmax 32768
Vanessa: Requesting service shell on channel 0.
Vanessa: channel 1: new [client-session]
Vanessa: Requesting channel_open for channel 1.
Vanessa: Entering interactive session.
Vanessa: Sending command: ls
Vanessa: Sending command: ls
Vanessa: Requesting service exec on channel 1.
Vanessa: channel 1: open confirm rwindow 0 rmax 32768
Vanessa: input_channel_request: rtype exit-status reply 0
Vanessa: channel 1: rcvd eof
Vanessa: channel 1: output open -&gt; drain
Vanessa: channel 1: rcvd close
Vanessa: channel 1: input open -&gt; closed
Vanessa: channel 1: close_read
Terminating on signal SIGINT&#40;2&#41;
C:\strawberry\perl\bin&gt;

On Sun, Sep 20, 2009 at 6:04 AM, Doug Reed &lt;r.douglas.reed@gmail.com&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Adam,
&gt; I tried doing both, but when the code referenced the win32 functions in the
&gt; code, it complained about &#39;barewords&#39; under strict mode where the functions
&gt; were used at compile time.  I hate &#39;strict&#39; and never use it, but I don&#39;t
&gt; write stuff for CPAN.
&gt;
&gt;
&gt; On Sun, Sep 20, 2009 at 1:46 AM, Adam Kennedy &lt;adamkennedybackup@gmail.com
<div class="message-stanza open">&gt; &gt; wrote:
</div>&gt;
<div class="message-stanza open">&gt;&gt; One option is to have the functions called directly in
&gt;&gt; Win32::whatever&#40;&#41; and to NOT export them.
&gt;&gt;
&gt;&gt; The other is to make the whole thing happen at compile time with...
&gt;&gt;
&gt;&gt; BEGIN {
&gt;&gt;    if &#40; $^O eq &#39;MSWin32&#39; &#41; {
&gt;&gt;        require Win32;
&gt;&gt;        Win32-&gt;import;
&gt;&gt;    }
&gt;&gt; }
</div>&gt;
&gt;
<div class="message-stanza open">&gt;&gt; 2009/9/20 Doug Reed &lt;r.douglas.reed@gmail.com&gt;:
<div class="message-stanza open">&gt;&gt; &gt; Curtis, &#40;and listeners&#41;,
&gt;&gt; &gt; Attached, please find the &#39;patches&#39; I made to handle Windows.  I don&#39;t
</div>&gt;&gt; have
<div class="message-stanza open">&gt;&gt; &gt; an account on CPAN, so I don&#39;t really know how to attach them to the
</div>&gt;&gt; problem
<div class="message-stanza open">&gt;&gt; &gt; you opened.  I am sure I could figure it out, but, my wife has something
</div>&gt;&gt; she
<div class="message-stanza open">&gt;&gt; &gt; needs me to do. :-&#41;
&gt;&gt; &gt; I cannot really call them patches because they cannot be deployed as is.
</div>&gt;&gt;  I
<div class="message-stanza open">&gt;&gt; &gt; need to be able to do:
&gt;&gt; &gt; if &#40;$^O =~ /MSWin32/&#41; {
&gt;&gt; &gt;    use Win32;
&gt;&gt; &gt; }
&gt;&gt; &gt; But that will not work because &#39;use&#39; is done at script load and not at
&gt;&gt; &gt; execute.  There MUST be some way do do this, but I don&#39;t know it.  I
</div>&gt;&gt; changed
<div class="message-stanza open">&gt;&gt; &gt; it to &#39;require&#39;, but then the load failed with unresolved symbols down
</div>&gt;&gt; in
<div class="message-stanza open">&gt;&gt; &gt; the code, so this is something PERLish I don&#39;t know how to do.  In the
</div>&gt;&gt; end,
<div class="message-stanza open">&gt;&gt; &gt; there is nothing wrong with the code except that we don&#39;t want to &#39;use
&gt;&gt; &gt; Win32;&#39; on Unix systems.
&gt;&gt; &gt; Thanque for looking into this.  I will help if I can as I need this to
</div>&gt;&gt; work,
<div class="message-stanza open">&gt;&gt; &gt; and we are REALLY close!
&gt;&gt; &gt;
&gt;&gt; &gt; On Fri, Sep 18, 2009 at 5:32 PM, Curtis Jewell &lt;
</div>&gt;&gt; perl@csjewell.fastmail.us&gt;
<div class="message-stanza open">&gt;&gt; &gt; wrote:
<div class="message-stanza open">&gt;&gt; &gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; &gt; I have not opened a ticket on CPAN, because from what I can see,
</div></div></div>&gt;&gt; this
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; &gt; module
&gt;&gt; &gt;&gt; &gt; &gt; is no longer supported, which is a shame because there is nothing
</div></div>&gt;&gt; to
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; &gt; fully
&gt;&gt; &gt;&gt; &gt; &gt; replace it.  Net::SSH2 can do SSH2 protocol, but not SSH1.  Anyway,
&gt;&gt; &gt;&gt; &gt; &gt; with
&gt;&gt; &gt;&gt; &gt; &gt; this in mind, I have tried to look at it myself to see if I could
</div></div>&gt;&gt; get
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; &gt; it
&gt;&gt; &gt;&gt; &gt; &gt; to
&gt;&gt; &gt;&gt; &gt; &gt; work in Strawberry, because it meets my needs on every other
</div></div>&gt;&gt; platform.
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt;
&gt;&gt; &gt;&gt; &gt; If I have to, I&#39;ll ask about taking it up - but I have to admit that
</div></div>&gt;&gt; I
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; don&#39;t think I have access to an ssh-using server to test it against
</div></div>&gt;&gt; at
<div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; the moment...
&gt;&gt; &gt;&gt; &gt; but maybe I do.  I&#39;ll check.
</div>&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; &#34;not actively supported&#34; may be too strong - the maintainer just
&gt;&gt; &gt;&gt; released a new version of another module that Strawberry uses yesterday
&gt;&gt; &gt;&gt; &#40;should have checked who the maintainer was first.&#41;
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Greg? Any help here? Any help I or Doug can offer? Would you need a
&gt;&gt; &gt;&gt; &#34;pre-beta&#34; build of Strawberry to test that includes all the
&gt;&gt; &gt;&gt; prerequisites?
&gt;&gt; &gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; Would you mind sending me a patch against the current version to
</div></div></div>&gt;&gt; start
<div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; with?
</div>&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; Attach it to the bug, too.
&gt;&gt; &gt;&gt;
<div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; It may have to get pulled out of October if the situation is as bad
</div></div></div>&gt;&gt; as
<div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; &gt; you say it is.
</div>&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; And right now Convert::PEM has suddenly &#40;as in since 30 hours ago&#41;
&gt;&gt; &gt;&gt; started failing tests - I&#39;m going to have to find whatever other module
&gt;&gt; &gt;&gt; is breaking it and get it to build again before I attack this bug - but
&gt;&gt; &gt;&gt; that won&#39;t be long!
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; --Curtis
&gt;&gt; &gt;&gt; --
&gt;&gt; &gt;&gt; Curtis Jewell
&gt;&gt; &gt;&gt; swordsman@csjewell.fastmail.us
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; %DCL-E-MEM-BAD, bad memory
&gt;&gt; &gt;&gt; -VMS-F-PDGERS, pudding between the ears
&gt;&gt; &gt;&gt;
&gt;&gt; &gt;&gt; [I use PC-Alpine, which deliberately does not display colors and
</div></div>&gt;&gt; pictures
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt;&gt; in HTML mail]
&gt;&gt; &gt;&gt;
</div>&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt;
&gt;&gt; &gt; --
&gt;&gt; &gt; Regards,
&gt;&gt; &gt;
&gt;&gt; &gt; Doug
&gt;&gt; &gt;
</div>&gt;&gt;
</div>&gt;
&gt;
&gt;
&gt; --
&gt; Regards,
&gt;
&gt; Doug
&gt;
</div>


-- 
Regards,

Doug
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666322/342146/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342146">with headers</a>
<br />
<span class="downloadcontenttype">text/html 11.8k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666538" href="/Public/Bug/Display.html?id=49820#txn-666538">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;03:34:38&nbsp;2009</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 09:34:14 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666538/342260/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342260">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Doug &#40;and others&#41;,

I am sending my opinion to Net::SSH::Perl issues discussed here:

1&#41; I would definitely split the problem into two parts
- &#34;$ENV{HOME}&#34; issue
- &#34;looping&#34; issue

2&#41; With &#34;$ENV{HOME}&#34; I recommend to use File::HomeDir module &#40;as
proposed by CSJEWELL&#41; and replace $ENV{HOME} with File::HomeDir::home&#40;&#41;
- in that case no &#34;if &#40;$^O eq &#39;MSWin32&#39;&#41; ...&#34; needed

3&#41; I have looked at you patch and I want to point out that it is not
necessary to do a special ioctl on Windows to set nonblocking behaviour
as it was already implemented in IO::Socket - see source
<span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/GBARR/IO-1.25/lib/IO/Socket.pm">http://cpansearch.perl.org/src/GBARR/IO-1.25/lib/IO/Socket.pm</a></span>

So it should be enough to call $sock-&gt;blocking&#40;0&#41; - HOWEVER BEWARE:
proper setting of nonblocking mode on Windows was implemented in IO
version approx. 1.24 &#40;not so long time ago&#41;.

So again no need for any &#34;if &#40;$^O eq &#39;MSWin32&#39;&#41; ...

4&#41; I have done a test with the following script:

use Net::SSH::Perl;
my $ssh = Net::SSH::Perl-&gt;new&#40;&#34;srv&#34;, debug =&gt; 1, protocol =&gt; &#39;1&#39; &#41;;
$ssh-&gt;login&#40;&#34;usr&#34;, &#34;passwd&#34;&#41;;
my &#40;$output,$errors,$exit&#41; = $ssh-&gt;cmd&#40;&#34;ls -l&#34;, 1&#41;;
print &#34;###OUTPUT=\n&#34; . $output;

and it works - however: a&#41; it uses protocol SSH1; b&#41; I have to pass 2nd
param &#40;=$stdin&#41; to cmd&#40;&#41; call - do not ask me why, but without it it
hangs up &#40;loops&#41;. When I look at SSH1.pm - sub _start_interactive - I
was in doubts whether the condition:

$s-&gt;add&#40;\*STDIN&#41; unless $sent_stdin;

is not reverted, but I do not know absolutely nothing about
Net::SSH::Perl guts.

5&#41; When trying SSH2 - the script hangs up exactly as you have described
and short analysis led me to the select&#40;&#41; call in SSH2.pm &#40;sub
client_loop&#41; that seems not to work as expected - but again the module
Net::SSH::Perl is quite complex and I saw its source code for the first time

6&#41; What makes things slightly unclear is mixing non-OO functions and
OO-functions when handling sockets - I know it should work but
consistent use of OO &#40;or non-OO&#41; approach would be healthier. I have
dealt with non-blocking sockets couple of months ago and it works -
perhaps Windows is only not so &#34;tolerant&#34; and not everything from UNIX
world works the same. I recommend consistently use OO socket interface.

That is all from my short analysis. Unfortunately I am have not seen
Net::SSH::Perl sources before so it is quite hard for me to prepare a
sane patch &#40;but I can try later if you find it useful&#41;.


--
kmx
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666538/342261/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342261">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.1k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666562" href="/Public/Bug/Display.html?id=49820#txn-666562">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;04:09:14&nbsp;2009</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 10:08:50 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666562/342277/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342277">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 387b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">.. and one more point where I am not sure about Windows compatibility in
SSH2.pm - sub _session_channel:

I do not know if calling:

rfd =&gt; _dup&#40;&#39;STDIN&#39;, &#39;&lt;&#39;&#41;, wfd =&gt; _dup&#40;&#39;STDOUT&#39;, &#39;&gt;&#39;&#41;, ...

works on Windows as expected, I have not tested it in more details. I
have only experienced some &#34;dup&#40;&#41; issue&#34; in past - so just pointing your
attention to potential &#34;point of failure&#34;.

--
kmx
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666602" href="/Public/Bug/Display.html?id=49820#txn-666602">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;08:08:34&nbsp;2009</span>
    <span class="description">r.douglas.reed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 08:08:15 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666602/342317/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342317">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Kmx,
With regard to the non-blocking sockets, yes this is supposed to work, and I
think it was fixed in IO::Socket, but as you point out there is a mixture of
OO and non OO code in the module, and using 1.34 on my die is triggered on:

    defined&#40;$sock-&gt;blocking&#40;0&#41;&#41;
        or die &#34;Can&#39;t set socket non-blocking: $!&#34;;

.. which I also wondered if it might be because the socket was opened using
the Non OO call.   I did the patch to get past this.  You will notice my
patch also calls die on failure, and yet mine does not die.  So it seems
that something is not working unless my IO Socket is old, but I just
installed Strawberry from scratch about two weeks ago.



On Mon, Sep 21, 2009 at 3:34 AM, kmx &lt;kmx@volny.cz&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Hi Doug &#40;and others&#41;,
&gt;
&gt; I am sending my opinion to Net::SSH::Perl issues discussed here:
&gt;
&gt; 1&#41; I would definitely split the problem into two parts
&gt; - &#34;$ENV{HOME}&#34; issue
&gt; - &#34;looping&#34; issue
&gt;
&gt; 2&#41; With &#34;$ENV{HOME}&#34; I recommend to use File::HomeDir module &#40;as proposed
&gt; by CSJEWELL&#41; and replace $ENV{HOME} with File::HomeDir::home&#40;&#41; - in that
&gt; case no &#34;if &#40;$^O eq &#39;MSWin32&#39;&#41; ...&#34; needed
&gt;
&gt; 3&#41; I have looked at you patch and I want to point out that it is not
&gt; necessary to do a special ioctl on Windows to set nonblocking behaviour as
&gt; it was already implemented in IO::Socket - see source
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://cpansearch.perl.org/src/GBARR/IO-1.25/lib/IO/Socket.pm">http://cpansearch.perl.org/src/GBARR/IO-1.25/lib/IO/Socket.pm</a></span>
&gt;
&gt; So it should be enough to call $sock-&gt;blocking&#40;0&#41; - HOWEVER BEWARE: proper
&gt; setting of nonblocking mode on Windows was implemented in IO version approx.
&gt; 1.24 &#40;not so long time ago&#41;.
&gt;
&gt; So again no need for any &#34;if &#40;$^O eq &#39;MSWin32&#39;&#41; ...
&gt;
&gt; 4&#41; I have done a test with the following script:
&gt;
&gt; use Net::SSH::Perl;
&gt; my $ssh = Net::SSH::Perl-&gt;new&#40;&#34;srv&#34;, debug =&gt; 1, protocol =&gt; &#39;1&#39; &#41;;
&gt; $ssh-&gt;login&#40;&#34;usr&#34;, &#34;passwd&#34;&#41;;
&gt; my &#40;$output,$errors,$exit&#41; = $ssh-&gt;cmd&#40;&#34;ls -l&#34;, 1&#41;;
&gt; print &#34;###OUTPUT=\n&#34; . $output;
&gt;
&gt; and it works - however: a&#41; it uses protocol SSH1; b&#41; I have to pass 2nd
&gt; param &#40;=$stdin&#41; to cmd&#40;&#41; call - do not ask me why, but without it it hangs
&gt; up &#40;loops&#41;. When I look at SSH1.pm - sub _start_interactive - I was in
&gt; doubts whether the condition:
&gt;
&gt; $s-&gt;add&#40;\*STDIN&#41; unless $sent_stdin;
&gt;
&gt; is not reverted, but I do not know absolutely nothing about Net::SSH::Perl
&gt; guts.
&gt;
&gt; 5&#41; When trying SSH2 - the script hangs up exactly as you have described and
&gt; short analysis led me to the select&#40;&#41; call in SSH2.pm &#40;sub client_loop&#41; that
&gt; seems not to work as expected - but again the module Net::SSH::Perl is
&gt; quite complex and I saw its source code for the first time
&gt;
&gt; 6&#41; What makes things slightly unclear is mixing non-OO functions and
&gt; OO-functions when handling sockets - I know it should work but consistent
&gt; use of OO &#40;or non-OO&#41; approach would be healthier. I have dealt with
&gt; non-blocking sockets couple of months ago and it works - perhaps Windows is
&gt; only not so &#34;tolerant&#34; and not everything from UNIX world works the same. I
&gt; recommend consistently use OO socket interface.
&gt;
&gt; That is all from my short analysis. Unfortunately I am have not seen
&gt; Net::SSH::Perl sources before so it is quite hard for me to prepare a sane
&gt; patch &#40;but I can try later if you find it useful&#41;.
&gt;
&gt;
&gt; --
&gt; kmx
&gt;
</div>


-- 
Regards,

Doug
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666602/342318/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342318">with headers</a>
<br />
<span class="downloadcontenttype">text/html 4.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666630" href="/Public/Bug/Display.html?id=49820#txn-666630">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;09:12:58&nbsp;2009</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 15:12:36 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666630/342335/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342335">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 827b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Doug,

try to upgrade IO package:
c:\&gt; cpan -fi IO

I have experienced &#34;Can&#39;t set socket non-blocking&#34; only with old IO
module &#40;e.g. IO-1.23 module included in strawberry 5.8.9 April-2009
release&#41;.

The other thing is that Net::SSH::Perl is setting non-blocking mode only
on the actual socket &#40;I am nearly sure this should work&#41;, however in the
code there is also some dark magic with STDIN, STDOUT, STDERR handles
and I am not sure about [non]blocking issues with STD* on Win32. Calling
$x-&gt;blocking&#40;0&#41; on a non-socket handle will fail on Win32.

Anyway when tracing the never-ending loop I have ended up in
IO::Select-&gt;select&#40;&#41; that fails &#40;unfortunately with Unknown Error&#41; when
calling raw &#40;non-OO&#41; select&#40;&#41; function with handle-vectors containing
bits for the network socket as well as some &#34;dup-ed&#34; STD* handles.

--
kmx
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666706" href="/Public/Bug/Display.html?id=49820#txn-666706">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;12:20:28&nbsp;2009</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 18:19:59 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666706/342381/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342381">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi all,

I have distilled the core problem of looping issue - it is improperly
working IO::Select / select&#40;&#41; when called on STDIN &#40;or other STD*&#41; handle.

*** sample1.pl - using OO interface via IO::Select ***

use strict;
use warnings;
use IO::Select;
use Data::Dumper;

my $s = IO::Select-&gt;new&#40;&#41;;
$s-&gt;add&#40;\*STDIN&#41;;
print STDERR &#34;calling select&#40;&#41; - hit any key or wait 5sec for timeout\n&#34;;
my @ready = IO::Select-&gt;select&#40;$s,undef,undef,5&#41;;
print STDERR Dumper&#40;\@ready&#41;;
print STDERR &#34;error=$!\n&#34;;

*** end of sample1.pl ***


*** sample2.pl - using raw select&#40;&#41; call ***

use strict;
use warnings;

my $v=&#39;&#39;;
vec&#40;$v,fileno&#40;STDIN&#41;,1&#41;=1;
print STDERR &#34;calling select&#40;&#41; - hit any key or wait 5sec for timeout\n&#34;;
my $rv=select&#40;$v,undef,undef,5&#41;;
print STDERR &#34;rv=$rv\n&#34;;
print STDERR &#34;error=$!\n&#34;;

*** end of sample2.pl ***

Both scripts above work on perl@Linux and perl@Cygwin however fails on
Win32/strawberry perl.

Unfortunately Net::SSH::Perl uses STD&#40;IN|OUT|ERR&#41; handles in select&#40;&#41;
call - therefore currently no chance to work on Win32.

To sum up:

1&#41; We should probably post an RT to IO module?  or perhaps somewhere else?

2&#41; Making a workaround in Net::SSH::Perl just for Win32 platform - not
easy + I do not believe the Net::SSH::Perl maintainers would agree with
this approach

3&#41; For CSJEWELL - I guess Win32/strawberry Oct2009 release will be
without Net::SSH::Perl

--
kmx
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666706/342382/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342382">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2.5k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-666713" href="/Public/Bug/Display.html?id=49820#txn-666713">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;21&nbsp;12:51:38&nbsp;2009</span>
    <span class="description">r.douglas.reed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 21 Sep 2009 12:41:59 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/666713/342388/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342388">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Kmx,
So in order to follow up, can someone &#40;you?&#41; open an RT to the maintainers
of the IO module.  I don&#39;t feel I comfortable doing so because I don&#39;t have
the same level of understanding as you.

..  and thanque for following up on this.

On Mon, Sep 21, 2009 at 12:19 PM, kmx &lt;kmx@volny.cz&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Hi all,
&gt;
&gt; I have distilled the core problem of looping issue - it is improperly
&gt; working IO::Select / select&#40;&#41; when called on STDIN &#40;or other STD*&#41; handle.
&gt;
&gt; *** sample1.pl - using OO interface via IO::Select ***
&gt;
&gt; use strict;
&gt; use warnings;
&gt; use IO::Select;
&gt; use Data::Dumper;
&gt;
&gt; my $s = IO::Select-&gt;new&#40;&#41;;
&gt; $s-&gt;add&#40;\*STDIN&#41;;
&gt; print STDERR &#34;calling select&#40;&#41; - hit any key or wait 5sec for timeout\n&#34;;
&gt; my @ready = IO::Select-&gt;select&#40;$s,undef,undef,5&#41;;
&gt; print STDERR Dumper&#40;\@ready&#41;;
&gt; print STDERR &#34;error=$!\n&#34;;
&gt;
&gt; *** end of sample1.pl ***
&gt;
&gt;
&gt; *** sample2.pl - using raw select&#40;&#41; call ***
&gt;
&gt; use strict;
&gt; use warnings;
&gt;
&gt; my $v=&#39;&#39;;
&gt; vec&#40;$v,fileno&#40;STDIN&#41;,1&#41;=1;
&gt; print STDERR &#34;calling select&#40;&#41; - hit any key or wait 5sec for timeout\n&#34;;
&gt; my $rv=select&#40;$v,undef,undef,5&#41;;
&gt; print STDERR &#34;rv=$rv\n&#34;;
&gt; print STDERR &#34;error=$!\n&#34;;
&gt;
&gt; *** end of sample2.pl ***
&gt;
&gt; Both scripts above work on perl@Linux and perl@Cygwin however fails on
&gt; Win32/strawberry perl.
&gt;
&gt; Unfortunately Net::SSH::Perl uses STD&#40;IN|OUT|ERR&#41; handles in select&#40;&#41; call
&gt; - therefore currently no chance to work on Win32.
&gt;
&gt; To sum up:
&gt;
&gt; 1&#41; We should probably post an RT to IO module?  or perhaps somewhere else?
&gt;
&gt; 2&#41; Making a workaround in Net::SSH::Perl just for Win32 platform - not
&gt; easy + I do not believe the Net::SSH::Perl maintainers would agree with
&gt; this approach
&gt;
&gt; 3&#41; For CSJEWELL - I guess Win32/strawberry Oct2009 release will be without
&gt; Net::SSH::Perl
&gt;
&gt; --
&gt; kmx
&gt;
</div>


-- 
Regards,

Doug
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/666713/342389/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342389">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-667482" href="/Public/Bug/Display.html?id=49820#txn-667482">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;23&nbsp;04:09:55&nbsp;2009</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 23 Sep 2009 10:09:32 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/667482/342841/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342841">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 259b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Doug &#40;and others&#41;,

bad news: <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/perl-5.10.1/pod/perlport.pod">http://search.cpan.org/dist/perl-5.10.1/pod/perlport.pod</a></span> says
&#34;select - Only implemented on sockets. &#40;Win32, VMS&#41;&#34;

So chances to get Net::SSH::Perl work on Win32 &#40;without quite
significant design changes&#41; are quite low.

--
kmx
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/667482/342842/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342842">with headers</a>
<br />
<span class="downloadcontenttype">text/html 724b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-667587" href="/Public/Bug/Display.html?id=49820#txn-667587">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;23&nbsp;09:41:56&nbsp;2009</span>
    <span class="description">r.douglas.reed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 23 Sep 2009 09:41:33 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/667587/342897/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342897">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 874b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Kmx,
Well, thanque for following up on this.  This is a bummer.  I might think
about working on this if I knew where to start, but I fear that my
understanding of Perl&#39;s socket implementation is not sophisticated enough.
 Indeed I am not quite sure I even understand the problem.  Why are we not
using sockets?  I mean the code creates sockets, and selects them, and the
docs say it only works on sockets, so I don&#39;t really understand when a
socket is not a socket.  ...  or better yet, how it works on Cygwin.


On Wed, Sep 23, 2009 at 4:09 AM, kmx &lt;kmx@volny.cz&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Doug &#40;and others&#41;,
&gt;
&gt; bad news: <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/dist/perl-5.10.1/pod/perlport.pod">http://search.cpan.org/dist/perl-5.10.1/pod/perlport.pod</a></span> says
&gt; &#34;select - Only implemented on sockets. &#40;Win32, VMS&#41;&#34;
&gt;
&gt; So chances to get Net::SSH::Perl work on Win32 &#40;without quite significant
&gt; design changes&#41; are quite low.
&gt;
&gt; --
&gt; kmx
&gt;
</div>


-- 
Regards,

Doug
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/667587/342898/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342898">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.4k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-667631" href="/Public/Bug/Display.html?id=49820#txn-667631">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;23&nbsp;11:07:50&nbsp;2009</span>
    <span class="description">kmx [...] volny.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 23 Sep 2009 17:07:29 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/667631/342926/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342926">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Doug,

to get it work on Win32 you need to fix basically 2 issues:

[1] in SSH1.pm avoid using this:
- my $s = IO::Select-&gt;new;
- ...
- $s-&gt;add&#40;\*STDIN&#41;  &lt;&lt;&lt; THIS IS NOT WIN32 COMPATIBLE

[2] in SSH2.pm &#40;in sub _session_channel&#41; - redesign _dup&#40;STD*&#41; magic:
-    my $channel = $cmgr-&gt;new_channel&#40;
-        ctype =&gt; &#39;session&#39;, local_window =&gt; 32*1024,
-        local_maxpacket =&gt; 16*1024, remote_name =&gt; &#39;client-session&#39;,
-        rfd =&gt; _dup&#40;&#39;STDIN&#39;, &#39;&lt;&#39;&#41;, wfd =&gt; _dup&#40;&#39;STDOUT&#39;, &#39;&gt;&#39;&#41;,
-        efd =&gt; _dup&#40;&#39;STDERR&#39;, &#39;&gt;&#39;&#41;&#41;;
as later in SSH2.pm we use rfd/wfd/efd in select&#40;&#41; call - again WIN32
INCOMPATIBLE

Sorry, I cannot help you more as I am not Net::SSH::Perl user - I was
involved in this RT just &#34;by accident&#34; while trying to fix some issues
concerning various crypto libraries we are gonna include in
Win32/strawberry perl &#40;Oct2009 release&#41;. Crypto is not a problem on
Win32-perl anymore. This is sort of an IO &#40;socket/handle/select&#41; issue.

But agree, it is not a good news that Net::SSH::Perl is not supported on
Win32.

--
kmx
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/667631/342927/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342927">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-667725" href="/Public/Bug/Display.html?id=49820#txn-667725">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;23&nbsp;15:26:34&nbsp;2009</span>
    <span class="description">sdetweil [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/667725/342971/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342971">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 23 11:07:50 2009, kmx@volny.cz wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Doug,
&gt; 
&gt; to get it work on Win32 you need to fix basically 2 issues:
&gt; 
&gt; [1] in SSH1.pm avoid using this:
&gt; - my $s = IO::Select-&gt;new;
&gt; - ...
&gt; - $s-&gt;add&#40;\*STDIN&#41;  &lt;&lt;&lt; THIS IS NOT WIN32 COMPATIBLE
&gt; 
&gt; [2] in SSH2.pm &#40;in sub _session_channel&#41; - redesign _dup&#40;STD*&#41; magic:
&gt; -    my $channel = $cmgr-&gt;new_channel&#40;
&gt; -        ctype =&gt; &#39;session&#39;, local_window =&gt; 32*1024,
&gt; -        local_maxpacket =&gt; 16*1024, remote_name =&gt; &#39;client-session&#39;,
&gt; -        rfd =&gt; _dup&#40;&#39;STDIN&#39;, &#39;&lt;&#39;&#41;, wfd =&gt; _dup&#40;&#39;STDOUT&#39;, &#39;&gt;&#39;&#41;,
&gt; -        efd =&gt; _dup&#40;&#39;STDERR&#39;, &#39;&gt;&#39;&#41;&#41;;
&gt; as later in SSH2.pm we use rfd/wfd/efd in select&#40;&#41; call - again WIN32
&gt; INCOMPATIBLE
&gt; 
&gt; Sorry, I cannot help you more as I am not Net::SSH::Perl user - I was
&gt; involved in this RT just &#34;by accident&#34; while trying to fix some issues
&gt; concerning various crypto libraries we are gonna include in
&gt; Win32/strawberry perl &#40;Oct2009 release&#41;. Crypto is not a problem on
&gt; Win32-perl anymore. This is sort of an IO &#40;socket/handle/select&#41; issue.
&gt; 
&gt; But agree, it is not a good news that Net::SSH::Perl is not supported on
&gt; Win32.
&gt; 
&gt; --
&gt; kmx
</div>
even if you remove the stdin/out/err handles from the select there is a
remaining issue of some sort. The select fires once, then never again.
Did someone post that they have a partial patch ? was it posted to the
ticket?  

I HAVE to make this work quickly, so I may be able to develop something.
this also fails on ActiveState perl 5.10 &#40;which is my Windows target
platform&#41;.

Sam
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-667728" href="/Public/Bug/Display.html?id=49820#txn-667728">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;23&nbsp;15:30:39&nbsp;2009</span>
    <span class="description">sdetweil [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/667728/342974/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/342974">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 611b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 23 15:26:34 2009, sam-d wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; even if you remove the stdin/out/err handles from the select there is a
&gt; remaining issue of some sort. The select fires once, then never again.
&gt; Did someone post that they have a partial patch ? was it posted to the
&gt; ticket?  
&gt; 
&gt; I HAVE to make this work quickly, so I may be able to develop something.
&gt; this also fails on ActiveState perl 5.10 &#40;which is my Windows target
&gt; platform&#41;.
&gt; 
&gt; Sam
&gt; 
</div>
I see the patch above &#40;to the right&#41;.. it was only for the homedir
problem.. we can use eval&#40;&#41; for that.  the bigger problem is the
select&#40;&#41; difficulty. 

Sam
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-668884" href="/Public/Bug/Display.html?id=49820#txn-668884">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;25&nbsp;11:50:03&nbsp;2009</span>
    <span class="description">r.douglas.reed [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> adam [...] ali.as, Curtis Jewell &lt;perl [...] csjewell.fastmail.us&gt;,  Bugs in Net-SSH-Perl via RT &lt;bug-Net-SSH-Perl [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #49820] AutoReply: Win32 support for Net::SSH::Perl</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 25 Sep 2009 11:49:44 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] volny.cz&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Reed &lt;r.douglas.reed [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/668884/343651/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/343651">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">All,
I found an easy solution!

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=758068">http://www.perlmonks.org/?node_id=758068</a></span>

Says that Net::SSH::w32Perl stopped working because they changed:

my $proto_class = $ssh-&gt;protocol_class&#40;$proto&#41;;

To:

my $proto_class = join &#39;::&#39;, __PACKAGE__, &#40;$proto == PROTOCOL_SSH2 ? &#34;SSH2&#34;
: &#34;SSH1&#34;&#41;;

in &#39;Perl.pm&#39; which prevents the module from overloading the select
statements.  The comment says that if you put it back, it works properly. I
did, and it does. Now I just need to get SSH1 working. Maybe better still
someone like &#39;Knx&#39; could have a look at the code and tell us if the fix
might be able to be put in Net::SSH::Perl and we could throw W32Perl away. I
think it looks pretty generic to me... It just overrides select with Object
methods. .. but them I am a bit green at this Perl internals stuff.



On Wed, Sep 23, 2009 at 11:07 AM, kmx &lt;kmx@volny.cz&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  Doug,
&gt;
&gt; to get it work on Win32 you need to fix basically 2 issues:
&gt;
&gt; [1] in SSH1.pm avoid using this:
&gt; - my $s = IO::Select-&gt;new;
&gt; - ...
&gt; - $s-&gt;add&#40;\*STDIN&#41;  &lt;&lt;&lt; THIS IS NOT WIN32 COMPATIBLE
&gt;
&gt; [2] in SSH2.pm &#40;in sub _session_channel&#41; - redesign _dup&#40;STD*&#41; magic:
&gt; -    my $channel = $cmgr-&gt;new_channel&#40;
&gt; -        ctype =&gt; &#39;session&#39;, local_window =&gt; 32*1024,
&gt; -        local_maxpacket =&gt; 16*1024, remote_name =&gt; &#39;client-session&#39;,
&gt; -        rfd =&gt; _dup&#40;&#39;STDIN&#39;, &#39;&lt;&#39;&#41;, wfd =&gt; _dup&#40;&#39;STDOUT&#39;, &#39;&gt;&#39;&#41;,
&gt; -        efd =&gt; _dup&#40;&#39;STDERR&#39;, &#39;&gt;&#39;&#41;&#41;;
&gt; as later in SSH2.pm we use rfd/wfd/efd in select&#40;&#41; call - again WIN32
&gt; INCOMPATIBLE
&gt;
&gt; Sorry, I cannot help you more as I am not Net::SSH::Perl user - I was
&gt; involved in this RT just &#34;by accident&#34; while trying to fix some issues
&gt; concerning various crypto libraries we are gonna include in Win32/strawberry
&gt; perl &#40;Oct2009 release&#41;. Crypto is not a problem on Win32-perl anymore. This
&gt; is sort of an IO &#40;socket/handle/select&#41; issue.
&gt;
&gt; But agree, it is not a good news that Net::SSH::Perl is not supported on
&gt; Win32.
&gt;
&gt; --
&gt; kmx
&gt;
</div>


-- 
Regards,

Doug
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/668884/343652/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/343652">with headers</a>
<br />
<span class="downloadcontenttype">text/html 6k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-668906" href="/Public/Bug/Display.html?id=49820#txn-668906">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;25&nbsp;13:23:26&nbsp;2009</span>
    <span class="description">sdetweil [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> sdetweil [...] gmail.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/668906/343679/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/343679">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 25 11:50:03 2009, r.douglas.reed@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; All,
&gt; I found an easy solution!
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=758068">http://www.perlmonks.org/?node_id=758068</a></span>
&gt; 
&gt; Says that Net::SSH::w32Perl stopped working because they changed:
&gt; 
&gt; my $proto_class = $ssh-&gt;protocol_class&#40;$proto&#41;;
&gt; 
&gt; To:
&gt; 
&gt; my $proto_class = join &#39;::&#39;, __PACKAGE__, &#40;$proto == PROTOCOL_SSH2 ?
&gt; &#34;SSH2&#34;
&gt; : &#34;SSH1&#34;&#41;;
&gt; 
&gt; in &#39;Perl.pm&#39; which prevents the module from overloading the select
&gt; statements.  The comment says that if you put it back, it works
&gt; properly. I
&gt; did, and it does. Now I just need to get SSH1 working. Maybe better
&gt; still
&gt; someone like &#39;Knx&#39; could have a look at the code and tell us if the
&gt; fix
&gt; might be able to be put in Net::SSH::Perl and we could throw W32Perl
&gt; away. I
&gt; think it looks pretty generic to me... It just overrides select with
&gt; Object
&gt; methods. .. but them I am a bit green at this Perl internals stuff.
&gt; 
&gt; 
&gt; 
</div>well, it takes more than that.. that fails.. you need to change
SSH::Perl to SSH:W32Perl to load the right library. 
this hooks in IO::Select::Trap..   

    my $proto_class = join &#39;::&#39;, __PACKAGE__,
        &#40;$proto == PROTOCOL_SSH2 ? &#34;SSH2&#34; : &#34;SSH1&#34;&#41;;

so the change it to add 

    if &#40;$^O =~ /Win32/i&#41; {
      $proto_class =~ s/Perl/W32Perl/;
    }

to hook the W32/SSH2.pm

the $home problem fix is in two places..
SSH:Perl.pm, init&#40;&#41;
    my $home;
    if &#40;$^O =~ /Win32/i&#41; {
        $home = $ENV{HOMEDRIVE}.$ENV{HOMEPATH} ||
eval&#40;Win32::GetFolderPath&#40; &#34;Win32::CSIDL_PERSONAL&#34; &#41; || &#34;.&#34;&#41;;
        $home=~ s/\\/\//g;

     } else {
         $home = $ENV{HOME} || &#40;getpwuid&#40;$&gt;&#41;&#41;[7];
     }

still searching for the other one I change &#40;for %home&#41;

thank YOU.. 

Sam
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-668909" href="/Public/Bug/Display.html?id=49820#txn-668909">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;25&nbsp;14:10:42&nbsp;2009</span>
    <span class="description">sdetweil [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/668909/343682/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/343682">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 25 13:23:26 2009, sam-d wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Sep 25 11:50:03 2009, r.douglas.reed@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; All,
&gt; &gt; I found an easy solution!
&gt; &gt; 
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=758068">http://www.perlmonks.org/?node_id=758068</a></span>
&gt; &gt; 
&gt; &gt; Says that Net::SSH::w32Perl stopped working because they changed:
&gt; &gt; 
&gt; &gt; my $proto_class = $ssh-&gt;protocol_class&#40;$proto&#41;;
&gt; &gt; 
&gt; &gt; To:
&gt; &gt; 
&gt; &gt; my $proto_class = join &#39;::&#39;, __PACKAGE__, &#40;$proto == PROTOCOL_SSH2 ?
&gt; &gt; &#34;SSH2&#34;
&gt; &gt; : &#34;SSH1&#34;&#41;;
&gt; &gt; 
&gt; &gt; in &#39;Perl.pm&#39; which prevents the module from overloading the select
&gt; &gt; statements.  The comment says that if you put it back, it works
&gt; &gt; properly. I
&gt; &gt; did, and it does. Now I just need to get SSH1 working. Maybe better
&gt; &gt; still
&gt; &gt; someone like &#39;Knx&#39; could have a look at the code and tell us if the
&gt; &gt; fix
&gt; &gt; might be able to be put in Net::SSH::Perl and we could throw W32Perl
&gt; &gt; away. I
&gt; &gt; think it looks pretty generic to me... It just overrides select with
&gt; &gt; Object
&gt; &gt; methods. .. but them I am a bit green at this Perl internals stuff.
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
</div>&gt; well, it takes more than that.. that fails.. you need to change
&gt; SSH::Perl to SSH:W32Perl to load the right library. 
&gt; this hooks in IO::Select::Trap..   
&gt; 
&gt;     my $proto_class = join &#39;::&#39;, __PACKAGE__,
&gt;         &#40;$proto == PROTOCOL_SSH2 ? &#34;SSH2&#34; : &#34;SSH1&#34;&#41;;
&gt; 
&gt; so the change it to add 
&gt; 
&gt;     if &#40;$^O =~ /Win32/i&#41; {
&gt;       $proto_class =~ s/Perl/W32Perl/;
&gt;     }
&gt; 
&gt; to hook the W32/SSH2.pm
&gt; 
&gt; the $home problem fix is in two places..
&gt; SSH:Perl.pm, init&#40;&#41;
&gt;     my $home;
&gt;     if &#40;$^O =~ /Win32/i&#41; {
&gt;         $home = $ENV{HOMEDRIVE}.$ENV{HOMEPATH} ||
&gt; eval&#40;Win32::GetFolderPath&#40; &#34;Win32::CSIDL_PERSONAL&#34; &#41; || &#34;.&#34;&#41;;
&gt;         $home=~ s/\\/\//g;
&gt; 
&gt;      } else {
&gt;          $home = $ENV{HOME} || &#40;getpwuid&#40;$&gt;&#41;&#41;[7];
&gt;      }
&gt; 
&gt; still searching for the other one I change &#40;for %home&#41;
&gt; 
&gt; thank YOU.. 
&gt; 
&gt; Sam
&gt; 
&gt; 
</div>also in Perl::SSH2.pm
init&#40;&#41;

    if &#40;$^O =~ /Win32/i&#41; {
       $home = $ENV{HOMEDRIVE}.$ENV{HOMEPATH} ||
eval&#40;Win32::GetFolderPath&#40; &#34;Win32::CSIDL_PERSONAL&#34; &#41; || &#34;.&#34;&#41;;
       $home=~ s/\\/\//g;
   
    } else {
        $home = $ENV{HOME} || &#40;getpwuid&#40;$&gt;&#41;&#41;[7];
    }


and the blocking change in SSH::Perl

_connect&#40;&#41;

    if &#40;$^O =~ /Win32/i&#41; {
        my $nonblocking = &#34;\x00\x00\x00\x01&#34;; # pack&#40;&#34;L&#34;,1&#41; works too
        my $PtrToLong = unpack&#40;&#34;I&#34;,pack&#40;&#39;P&#39;,$nonblocking&#41;&#41;; # get
address to the variable contents, not it&#39;s reference structure
        ioctl&#40;$sock, FIONBIO,$PtrToLong &#41; or die &#34;Can&#39;t set socket
non-blocking: $!&#34;;
     } else {
            defined&#40;$sock-&gt;blocking&#40;0&#41;&#41; or die &#34;Can&#39;t set socket
non-blocking: $!&#34;;
     }

don&#39;t know how to get that perldiff..

Sam
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-668943" href="/Public/Bug/Display.html?id=49820#txn-668943">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;25&nbsp;14:47:48&nbsp;2009</span>
    <span class="description">sdetweil [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/668943/343706/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/343706">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 25 14:10:42 2009, sam-d wrote:
now I am seeing this

SAMS: channel 1: open confirm rwindow 131071 rmax 16384
GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
SAMS: sftp: in sftp connection failure sub
SAMS: sftp: sftp server responded
SAMS: sftp: Sending SSH2_FXP_INIT
SAMS: sftp: in sftp get_msg
SAMS: sftp: calling client loop
GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 121
SAMS: sftp: in sftp incoming data sub
SAMS: sftp: returned from client loop
SAMS: sftp: Remote version: 3
SAMS: sftp: Sent message T:17 I:0
SAMS: sftp: in sftp get_msg
SAMS: sftp: calling client loop
GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 121


Sam
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-668961" href="/Public/Bug/Display.html?id=49820#txn-668961">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;25&nbsp;15:35:43&nbsp;2009</span>
    <span class="description">sdetweil [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/668961/343723/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/343723">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 25 14:47:48 2009, sam-d wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Sep 25 14:10:42 2009, sam-d wrote:
&gt; now I am seeing this
&gt; 
&gt; SAMS: channel 1: open confirm rwindow 131071 rmax 16384
&gt; GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
&gt; IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
&gt; SAMS: sftp: in sftp connection failure sub
&gt; SAMS: sftp: sftp server responded
&gt; SAMS: sftp: Sending SSH2_FXP_INIT
&gt; SAMS: sftp: in sftp get_msg
&gt; SAMS: sftp: calling client loop
&gt; GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
&gt; IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
&gt; GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
&gt; IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
&gt; IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 121
&gt; SAMS: sftp: in sftp incoming data sub
&gt; SAMS: sftp: returned from client loop
&gt; SAMS: sftp: Remote version: 3
&gt; SAMS: sftp: Sent message T:17 I:0
&gt; SAMS: sftp: in sftp get_msg
&gt; SAMS: sftp: calling client loop
&gt; GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
&gt; IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
&gt; GLOB at i:/Perl/site/lib/Net/SSH/Perl/SSH2.pm line 350
&gt; IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 113
&gt; IO::String at i:/Perl/site/lib/Net/SSH/Perl/Channel.pm line 121
&gt; 
&gt; 
&gt; Sam
&gt; 
</div>
ok, in IO::Select::Trap, Trap.pm,
the two calls to carp&#40;&#41; in trapped&#40;&#41; need to be removed. 

Sam
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-681804" href="/Public/Bug/Display.html?id=49820#txn-681804">#</a>      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;25&nbsp;16:52:36&nbsp;2009</span>
    <span class="description">greg [...] turnstep.com -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-681812" href="/Public/Bug/Display.html?id=49820#txn-681812">#</a>      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;25&nbsp;16:52:59&nbsp;2009</span>
    <span class="description">greg [...] turnstep.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/681812/351061/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351061">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 75b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Applied some changes in cvs, please let me know what else needs to be done.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-682067" href="/Public/Bug/Display.html?id=49820#txn-682067">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;26&nbsp;07:20:51&nbsp;2009</span>
    <span class="description">greg [...] turnstep.com -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-748207" href="/Public/Bug/Display.html?id=49820#txn-748207">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;15&nbsp;11:09:34&nbsp;2010</span>
    <span class="description">csjewell [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/748207/386911/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/386911">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 316b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Oct 25 16:52:59 2009, greg@turnstep.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Applied some changes in cvs, please let me know what else needs to be
</div>done.

I just got reminded of this, and have one question - where would this
CVS be?!? There&#39;s NO mention of it in the docs.

I think I have an ssh-using server to try against now.

--Curtis
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-748210" href="/Public/Bug/Display.html?id=49820#txn-748210">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;15&nbsp;11:09:38&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-806445" href="/Public/Bug/Display.html?id=49820#txn-806445">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;19&nbsp;18:16:11&nbsp;2010</span>
    <span class="description">CHORNY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/806445/418116/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/418116">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 117b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Curtis, CVS is here: <span class="clickylink"><a target="new" rel="nofollow" href="https://sourceforge.net/projects/ssh-sftp-perl/develop">https://sourceforge.net/projects/ssh-sftp-perl/develop</a></span>

-- 
Alexandr Ciornii, <span class="clickylink"><a target="new" rel="nofollow" href="http://chorny.net">http://chorny.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-806448" href="/Public/Bug/Display.html?id=49820#txn-806448">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;19&nbsp;18:16:49&nbsp;2010</span>
    <span class="description">CHORNY [...] cpan.org -  Cc CHORNY added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-806456" href="/Public/Bug/Display.html?id=49820#txn-806456">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;19&nbsp;19:04:01&nbsp;2010</span>
    <span class="description">CHORNY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/806456/418126/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/418126">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 819b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Oct 25 16:52:59 2009, greg@turnstep.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Applied some changes in cvs, please let me know what else needs to be
</div>done.

Net::SSH::Perl uses FIONBIO, which is undefined &#40;at least of Windows&#41;.

I added following constant:

use constant FIONBIO =&gt; 0x8004667e;

All tests pass except 03-packet.t:

Can&#39;t locate Net/SSH/W32Perl/SSH1.pm in @INC &#40;@INC contains:
D:\14\net-ssh-perl\blib\lib D:\14\net-ssh-perl\blib\arch
C:/strawberry/perl/lib C:/strawberry/perl/site/lib
C:\strawberry\perl\vendor\lib .&#41; at
D:\14\net-ssh-perl\blib\lib/Net/SSH/Perl.pm line 55.
# Looks like your test exited with 2 before it could output anything.
t/03-packet.t .. 
1..10
Dubious, test returned 2 &#40;wstat 512, 0x200&#41;

There is Net::SSH::W32Perl::SSH2 on CPAN, but no Net::SSH::W32Perl::SSH1.

-- 
Alexandr Ciornii, <span class="clickylink"><a target="new" rel="nofollow" href="http://chorny.net">http://chorny.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1151184" href="/Public/Bug/Display.html?id=49820#txn-1151184">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;05&nbsp;08:49:41&nbsp;2012</span>
    <span class="description">schwigon [...] cpan.org -  Dependency by ticket #49885 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1151198" href="/Public/Bug/Display.html?id=49820#txn-1151198">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;05&nbsp;09:08:30&nbsp;2012</span>
    <span class="description">schwigon [...] cpan.org -  Dependency by ticket #44452 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1151371" href="/Public/Bug/Display.html?id=49820#txn-1151371">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;05&nbsp;15:14:04&nbsp;2012</span>
    <span class="description">schwigon [...] cpan.org -  Dependency by ticket #72953 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.593351</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
