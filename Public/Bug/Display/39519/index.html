<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #39519 for CGI-Session: Store method fails in CGI::Session::Driver::mysql for MySQL 4.0.16</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #39519 for CGI-Session: Store method fails in CGI::Session::Driver::mysql for MySQL 4.0.16</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CGI-Session">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CGI-Session">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CGI-Session">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CGI-Session">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI-Session">CGI-Session CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">39519</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CGI-Session">CGI-Session</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MARKSTOS [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
olaf [...] wundersolutions.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-5872-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-5873-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




.<br />
<ul>

</ul>


mysql4.pm<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/511648/254715/mysql4.pm">
Mon Sep 22 14:54:37 2008 (651b) by olaf [...] wundersolutions.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=39519">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511648" href="/Public/Bug/Display.html?id=39519#txn-511648">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;22&nbsp;14:54:36&nbsp;2008</span>
    <span class="description">olaf [...] wundersolutions.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Store method fails in CGI::Session::Driver::mysql for MySQL 4.0.16</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/511648/254712/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/254712">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 778b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">According to these docs:

<span class="clickylink"><a target="new" rel="nofollow" href="http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html">http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html</a></span>

&#34;If you specify ON DUPLICATE KEY UPDATE &#40;added in MySQL 4.1.0&#41;, and a
row is inserted that would cause a duplicate value in a UNIQUE index or
PRIMARY KEY, an UPDATE of the old row is performed&#34;

So, I was unable to store session data using MySQL 4.0.16  It&#39;s not a
situation where I can easily upgrade MySQL, so I had to write a custom
driver with a store method which uses the &#34;REPLACE INTO &#34; syntax.  I&#39;ve
attached it in case anyone finds it helpful.

It might be helpful to have some kind of MySQL version parameter that
could be passed to the driver in order to support older versions of
MySQL.  I can supply a patch if that&#39;s something that you might consider.

All the best,


Olaf
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> mysql4.pm</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/511648/254715/mysql4.pm">Download mysql4.pm</a><br />
<span class="downloadcontenttype">text/x-perl 651b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">package CGI::Session::Driver::mysql4;

use strict;
use warnings;

use base &#39;CGI::Session::Driver::mysql&#39;;

use Carp qw&#40; croak &#41;;

sub store {

    my $self = shift;
    my &#40;$sid, $datastr&#41; = @_;

    croak &#34;store&#40;&#41;: usage error&#34; unless $sid &#38;&#38; $datastr;

    my $dbh     = $self-&gt;{Handle};
    my $table   = $self-&gt;table_name;

    my $replace_query = qq[
        REPLACE INTO
        $table
        &#40; $self-&gt;{IdColName}, $self-&gt;{DataColName} &#41;
        VALUES
        &#40;?, ?&#41;
    ];

    $dbh-&gt;do&#40; $replace_query, undef, $sid, $datastr, $datastr &#41;
        or return $self-&gt;set_error&#40; &#34;store&#40;&#41;: \$dbh-&gt;do failed &#34; . $dbh-&gt;errstr &#41;;

    return 1;
}

1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-527342" href="/Public/Bug/Display.html?id=39519#txn-527342">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;23:26:57&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-527343" href="/Public/Bug/Display.html?id=39519#txn-527343">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;23:30:21&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/527343/263916/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/263916">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Olaf,

I would accept a patch that works like follows:

The first time that &#34;store&#34; is called, select the database version and
store in the CGI::Session object. On future calls, look up the version
we&#39;ve already stored. Using the version returned, decide which SQL to use. 

   Mark

On Mon Sep 22 14:54:36 2008, OALDERS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; According to these docs:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html">http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html</a></span>
&gt; 
&gt; &#34;If you specify ON DUPLICATE KEY UPDATE &#40;added in MySQL 4.1.0&#41;, and a
&gt; row is inserted that would cause a duplicate value in a UNIQUE index or
&gt; PRIMARY KEY, an UPDATE of the old row is performed&#34;
&gt; 
&gt; So, I was unable to store session data using MySQL 4.0.16  It&#39;s not a
&gt; situation where I can easily upgrade MySQL, so I had to write a custom
&gt; driver with a store method which uses the &#34;REPLACE INTO &#34; syntax.  I&#39;ve
&gt; attached it in case anyone finds it helpful.
&gt; 
&gt; It might be helpful to have some kind of MySQL version parameter that
&gt; could be passed to the driver in order to support older versions of
&gt; MySQL.  I can supply a patch if that&#39;s something that you might consider.
&gt; 
&gt; All the best,
&gt; 
&gt; 
&gt; Olaf
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-527344" href="/Public/Bug/Display.html?id=39519#txn-527344">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;23:30:22&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-527347" href="/Public/Bug/Display.html?id=39519#txn-527347">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;23:30:23&nbsp;2008</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction dates Told even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-583845" href="/Public/Bug/Display.html?id=39519#txn-583845">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;27&nbsp;21:17:23&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Told changed from Fri Oct 31 23:30:23 2008 to Fri Mar 27 21:17:23 2009</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-583846" href="/Public/Bug/Display.html?id=39519#txn-583846">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;27&nbsp;21:19:05&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/583846/295171/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/295171">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Olaf, 

Any progress on a patch for this? I may close this bug report soon if no one else is 
interested in maintaining CGI::Session for MySQL 4.0.x in the near future.

    Mark


On Fri Oct 31 23:30:21 2008, MARKSTOS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Olaf,
&gt; 
&gt; I would accept a patch that works like follows:
&gt; 
&gt; The first time that &#34;store&#34; is called, select the database version and
&gt; store in the CGI::Session object. On future calls, look up the version
&gt; we&#39;ve already stored. Using the version returned, decide which SQL to use. 
&gt; 
&gt;    Mark
&gt; 
&gt; On Mon Sep 22 14:54:36 2008, OALDERS wrote:
<div class="message-stanza open">&gt; &gt; According to these docs:
&gt; &gt; 
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html">http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html</a></span>
&gt; &gt; 
&gt; &gt; &#34;If you specify ON DUPLICATE KEY UPDATE &#40;added in MySQL 4.1.0&#41;, and a
&gt; &gt; row is inserted that would cause a duplicate value in a UNIQUE index or
&gt; &gt; PRIMARY KEY, an UPDATE of the old row is performed&#34;
&gt; &gt; 
&gt; &gt; So, I was unable to store session data using MySQL 4.0.16  It&#39;s not a
&gt; &gt; situation where I can easily upgrade MySQL, so I had to write a custom
&gt; &gt; driver with a store method which uses the &#34;REPLACE INTO &#34; syntax.  I&#39;ve
&gt; &gt; attached it in case anyone finds it helpful.
&gt; &gt; 
&gt; &gt; It might be helpful to have some kind of MySQL version parameter that
&gt; &gt; could be passed to the driver in order to support older versions of
&gt; &gt; MySQL.  I can supply a patch if that&#39;s something that you might consider.
&gt; &gt; 
&gt; &gt; All the best,
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Olaf
</div>&gt; 
</div></div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-583847" href="/Public/Bug/Display.html?id=39519#txn-583847">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;27&nbsp;21:19:06&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-583861" href="/Public/Bug/Display.html?id=39519#txn-583861">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;27&nbsp;23:11:36&nbsp;2009</span>
    <span class="description">olaf [...] wundersolutions.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/583861/295188/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/295188">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark,

Thanks for following up on this.  I *think* that if nobody else has
raised this issue, it&#39;s probably not worth the time to patch this.  I
had hoped to do so, but I haven&#39;t really had all that much spare time
lately.  

For me, subclassing CGI::Session::Driver::mysql and overriding the
store&#40;&#41; method fixed it.  I would say, though, that it probably merits a
note under &#34;Known Issues&#34; or something like that, since I seem to recall
that it originally took me a while to track down the issue.   

I suppose it&#39;s possible that someone with an older version of MySQL
could upgrade CGI::Session::Driver::mysql and find themselves dealing
with this bug, so a note in the docs would probably be helpful in that
case.  Maybe a link to this ticket would point those folks at a quick
workaround to the problem if you think that&#39;s helpful.

Best,

Olaf

On Fri Mar 27 21:19:05 2009, MARKSTOS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Olaf,
&gt; 
&gt; Any progress on a patch for this? I may close this bug report soon if
&gt; no one else is
&gt; interested in maintaining CGI::Session for MySQL 4.0.x in the near
&gt; future.
&gt; 
&gt;     Mark
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-583879" href="/Public/Bug/Display.html?id=39519#txn-583879">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;28&nbsp;00:38:39&nbsp;2009</span>
    <span class="description">ron [...] savage.net.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #39519] Store method fails in CGI::Session::Driver::mysql for MySQL 4.0.16</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 28 Mar 2009 15:38:35 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ron Savage &lt;ron [...] savage.net.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/583879/295200/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/295200">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Olaf

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html">http://dev.mysql.com/doc/refman/4.1/en/insert-on-duplicate.html</a></span>
&gt; &gt; &gt; 
&gt; &gt; &gt; &#34;If you specify ON DUPLICATE KEY UPDATE &#40;added in MySQL 4.1.0&#41;, and a
&gt; &gt; &gt; row is inserted that would cause a duplicate value in a UNIQUE index or
&gt; &gt; &gt; PRIMARY KEY, an UPDATE of the old row is performed&#34;
&gt; &gt; &gt; 
&gt; &gt; &gt; So, I was unable to store session data using MySQL 4.0.16  It&#39;s not a
&gt; &gt; &gt; situation where I can easily upgrade MySQL, so I had to write a custom
&gt; &gt; &gt; driver with a store method which uses the &#34;REPLACE INTO &#34; syntax.  I&#39;ve
&gt; &gt; &gt; attached it in case anyone finds it helpful.
&gt; &gt; &gt; 
&gt; &gt; &gt; It might be helpful to have some kind of MySQL version parameter that
&gt; &gt; &gt; could be passed to the driver in order to support older versions of
&gt; &gt; &gt; MySQL.  I can supply a patch if that&#39;s something that you might consider.
</div>
I have mixed feelings on this.

Of course your position is difficult if you are stuck on an old version
of MySQL.

And yet, is that version available for download, and hence for testing?

Also is the latest version of DB::mysql still compatible with that
version?

It might be possible to downgrade to develop this code, but frankly, I
don&#39;t want to :-&#41;!

I suspect that so few people would be still using that version, that I&#39;d
say your approach of subclassing what needs to be overridden is in fact
the best approach.

And then there&#39;d sill be the problem: Do we support 4.0.16 /and/ even
older versions? I&#39;d say: Sorry, but no.

-- 
Ron Savage
ron@savage.net.au
<span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/index.html">http://savage.net.au/index.html</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-583908" href="/Public/Bug/Display.html?id=39519#txn-583908">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;28&nbsp;05:11:31&nbsp;2009</span>
    <span class="description">olaf [...] wundersolutions.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/583908/295215/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/295215">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 585b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Mar 28 00:38:39 2009, ron@savage.net.au wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I suspect that so few people would be still using that version, that
&gt; I&#39;d
&gt; say your approach of subclassing what needs to be overridden is in
&gt; fact
&gt; the best approach.
&gt; 
&gt; And then there&#39;d sill be the problem: Do we support 4.0.16 /and/ even
&gt; older versions? I&#39;d say: Sorry, but no.
&gt; 
</div>
I think we&#39;re on the same page here -- no need to create work for this
sort of backwards compatibility.  Most of all, I just wanted to point
out that the syntax had changed and that there is, in fact, an available
workaround.  :&#41;  
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-584506" href="/Public/Bug/Display.html?id=39519#txn-584506">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;30&nbsp;09:57:41&nbsp;2009</span>
    <span class="description">mark [...] summersault.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #39519] Store method fails in CGI::Session::Driver::mysql for MySQL 4.0.16</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Mar 2009 09:30:44 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI-Session [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Stosberg &lt;mark [...] summersault.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/584506/295523/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/295523">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 375b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think we&#39;re on the same page here -- no need to create work for this
&gt; sort of backwards compatibility.  Most of all, I just wanted to point
&gt; out that the syntax had changed and that there is, in fact, an available
&gt; workaround.  :&#41;  
</div>
That&#39;s still helpful to do. Someone may still find these pages in the bug
tracker ever after the bug is marked &#39;resolved&#39;.

    Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-589398" href="/Public/Bug/Display.html?id=39519#txn-589398">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;09&nbsp;20:36:00&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.644398</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
