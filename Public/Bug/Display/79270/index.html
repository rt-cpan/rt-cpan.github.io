<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #79270 for XML-Compile-SOAP: Request: handle complexType/simple content nicer</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #79270 for XML-Compile-SOAP: Request: handle complexType/simple content nicer</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/XML-Compile-SOAP/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/XML-Compile-SOAP/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/XML-Compile-SOAP/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/XML-Compile-SOAP/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-Compile-SOAP">XML-Compile-SOAP CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">79270</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/XML-Compile-SOAP/Active/">XML-Compile-SOAP</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ether [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-45614-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-45615-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;17:38:51&nbsp;2012</span>
    <span class="description">ether [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Request: handle complexType/simple content nicer</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The docs say:

    complexType/simpleContent

    In this case, the single value container may have attributes. The
number of attributes can be endless, and the value is only one. This
value has no name, and therefore gets a predefined name _.

    Â» Example: typical simpleContent example

        In XML, this looks like this:

         &lt;test2 question=&#34;everything&#34;&gt;42&lt;/test2&gt;

        As a HASH, this looks like

         test2 =&gt; { _ =&gt; 42
                  , question =&gt; &#39;everything&#39;
                  }

Therefore, I cannot simply do  $write-&gt;&#40;$doc, { foo =&gt; &#39;bar&#39; }&#41;; if the
foo type has been declared as a complexType in the XSD - I need to pass
{ foo =&gt; { _ =&gt; &#39;bar }} instead.

What would be really nice is if this translation happened automatically
- i.e. in XML::Compile::Translate::Writer::makeComplexElement, instead
of erroring with &#34;complex {tag} requires a HASH of input data...&#34; if
!ref&#40;$data&#41;, instead it made the transformation to { $tag =&gt; { _ =&gt;
$data }} itself.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;17:45:34&nbsp;2012</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79270] Request: handle complexType/simple content nicer</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Aug 2012 23:45:18 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Karen Etheridge via RT &lt;bug-XML-Compile-SOAP [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Karen Etheridge via RT &#40;bug-XML-Compile-SOAP@rt.cpan.org&#41; [120828 21:39]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue Aug 28 17:38:51 2012: Request 79270 was acted upon.
&gt; Transaction: Ticket created by ETHER
&gt;        Queue: XML-Compile-SOAP
&gt;      Subject: Request: handle complexType/simple content nicer
&gt; 
&gt; The docs say:
&gt;     complexType/simpleContent
&gt; 
&gt; Therefore, I cannot simply do  $write-&gt;&#40;$doc, { foo =&gt; &#39;bar&#39; }&#41;; if the
&gt; foo type has been declared as a complexType in the XSD - I need to pass
&gt; { foo =&gt; { _ =&gt; &#39;bar }} instead.
</div>
It may not in the docs, but it should work.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What would be really nice is if this translation happened automatically
&gt; - i.e. in XML::Compile::Translate::Writer::makeComplexElement, instead
&gt; of erroring with &#34;complex {tag} requires a HASH of input data...&#34; if
&gt; !ref&#40;$data&#41;, instead it made the transformation to { $tag =&gt; { _ =&gt;
&gt; $data }} itself.
</div>
complexType/simpleContent is handled in makeTaggedElement, not
makeComplexElement.  It contains

  my $copy    = UNIVERSAL::isa&#40;$data, &#39;HASH&#39;&#41; ? {%$data} : {_ =&gt; $data};

So, something else may not be working as expected.  Example code?
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;17:45:35&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;30&nbsp;11:57:00&nbsp;2012</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Aug 28 14:45:34 2012, solutions@overmeer.net wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; complexType/simpleContent is handled in makeTaggedElement, not
&gt; makeComplexElement.  It contains
&gt; 
&gt;   my $copy    = UNIVERSAL::isa&#40;$data, &#39;HASH&#39;&#41; ? {%$data} : {_ =&gt; $data};
&gt; 
&gt; So, something else may not be working as expected.  Example code?
</div>
Attached is a sample XSD and demonstration code.  When I run it, I get:

    error: complex `transaction_id&#39; requires a HASH of input data, not
`unique_id_here&#39; at interface_name/transaction_id
     at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/Log/Report/Dispatcher/Perl.pm
line 29.
           
Log::Report::Dispatcher::Perl::log&#40;&#39;Log::Report::Dispatcher::Perl=HASH&#40;0x32c63a0&#41;&#39;,
&#39;HASH&#40;0x2f8d588&#41;&#39;, &#39;ERROR&#39;, &#39;Log::Report::Message=HASH&#40;0x32c6568&#41;&#39;&#41;
called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/Log/Report.pm
line 140
            Log::Report::report&#40;&#39;ERROR&#39;,
&#39;Log::Report::Message=HASH&#40;0x32c6568&#41;&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/Log/Report.pm
line 277
            Log::Report::error&#40;&#39;Log::Report::Message=HASH&#40;0x32c6568&#41;&#39;&#41;
called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 529
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;unique_id_here&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 418
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;unique_id_here&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 402
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;unique_id_here&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 167
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;HASH&#40;0x1d71a70&#41;&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 373
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;HASH&#40;0x1d71a70&#41;&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 534
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;HASH&#40;0x1adeaf8&#41;&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 418
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;HASH&#40;0x1adeaf8&#41;&#39;&#41; called at
/home/ad/karene/perl5/perlbrew/perls/perl-5.16.0/lib/site_perl/5.16.0/XML/Compile/Translate/Writer.pm
line 114
           
XML::Compile::Translate::Writer::__ANON__&#40;&#39;XML::LibXML::Document=SCALAR&#40;0x1adebe8&#41;&#39;,
&#39;HASH&#40;0x1adeaf8&#41;&#39;&#41; called at rt79270.pl line 51
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> rt79270.pl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use warnings;

use Carp::Always;
use DateTime;
use XML::Compile::Schema;
use XML::Compile::Util &#39;pack_type&#39;;
use XML::LibXML;

my $now = DateTime-&gt;now&#40;time_zone =&gt; &#39;UTC&#39;&#41;;

my $data = {
    interface_name =&gt; {
        transaction_id =&gt; &#39;unique_id_here&#39;,
        Userid =&gt; &#39;1234&#39;,
        UtcDateAndTime =&gt; {
            DayOfWeek =&gt; $now-&gt;day_name,
            DayOfMonth =&gt; sprintf&#40;&#39;%02d&#39;, $now-&gt;day_of_month&#41;,
            Month =&gt; $now-&gt;month_abbr,
            Year =&gt; $now-&gt;year,
            Hour =&gt; sprintf&#40;&#39;%02d&#39;, $now-&gt;hour&#41;,
            Minute =&gt; sprintf&#40;&#39;%02d&#39;, $now-&gt;minute&#41;,
            Second =&gt; sprintf&#40;&#39;%02d&#39;, $now-&gt;second&#41;,
        },
    },
};

# this should be moved to the module_share dir
my $schema = XML::Compile::Schema-&gt;new&#40;&#39;complextype.xsd&#39;&#41;;

my $doc = XML::LibXML::Document-&gt;new&#40;&#39;1.0&#39;, &#39;UTF-8&#39;&#41;;

my $write = $schema-&gt;compile&#40;
    WRITER =&gt; pack_type&#40;&#39;&#39;, &#39;interface_name&#39;&#41;,
&#41;;

my $xml = $write-&gt;&#40;$doc,
# this only works if our XSD isn&#39;t insane:
# - no mixed=true for simple types
# - no complex types for the simple types
    $data-&gt;{interface_name},
&#41;;

$doc-&gt;setDocumentElement&#40;$xml&#41;;

print &#34;XML GENERATED:\n&#34;;
print $doc-&gt;toString&#40;1&#41;;

</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> complextype.xsd</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;30&nbsp;13:21:05&nbsp;2012</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79270] Request: handle complexType/simple content nicer</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Aug 2012 19:20:52 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Karen Etheridge via RT &lt;bug-XML-Compile-SOAP [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Karen Etheridge via RT &#40;bug-XML-Compile-SOAP@rt.cpan.org&#41; [120830 15:57]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-Compile-SOAP
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79270">https://rt.cpan.org/Ticket/Display.html?id=79270</a></span> &gt;
&gt; 
&gt; On Tue Aug 28 14:45:34 2012, solutions@overmeer.net wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; complexType/simpleContent is handled in makeTaggedElement, not
&gt; &gt; makeComplexElement.  It contains
&gt; &gt; 
&gt; &gt;   my $copy    = UNIVERSAL::isa&#40;$data, &#39;HASH&#39;&#41; ? {%$data} : {_ =&gt; $data};
&gt; &gt; 
&gt; &gt; So, something else may not be working as expected.  Example code?
</div>&gt; 
&gt; Attached is a sample XSD and demonstration code.  When I run it, I get:
&gt; 
&gt;     error: complex `transaction_id&#39; requires a HASH of input data, not
&gt; `unique_id_here&#39; at interface_name/transaction_id
</div>
The reported error is correct.

There is only a valid case for complexType/simpleContent structures
to translate  &lt;xyz abc=&#34;42&#34;&gt;13&lt;/xyz&gt;   into   xyz =&gt; {abc =&gt; 42, _ =&gt; 13}
and to allow   xyz =&gt; 17  as alternative for  xyz =&gt; { _ =&gt; 17 }

For other complexType structures &#40;simple complexType and complexType/-
complexContent&#41; this is impossible to implement.  Why do you expect that
to work in the first place?  I even do not see a use-case.

An empty complex can be specified as:
                   transaction_id =&gt; {}
which differs from transaction_id =&gt; undef
The latter will not produce anything, the former  &lt;transaction_id/&gt;

Also weird to see a complex UtcDateAndTime structure, where we have
such a nice iso standard dataTime type in schema&#39;s.  Although I have
encountered such before.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;30&nbsp;14:28:06&nbsp;2012</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79270] Request: handle complexType/simple content nicer</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Aug 2012 11:27:55 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Mark Overmeer via RT &lt;bug-XML-Compile-SOAP [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karen Etheridge &lt;ether [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; There is only a valid case for complexType/simpleContent structures
&gt; to translate  &lt;xyz abc=&#34;42&#34;&gt;13&lt;/xyz&gt;   into   xyz =&gt; {abc =&gt; 42, _ =&gt; 13}
&gt; and to allow   xyz =&gt; 17  as alternative for  xyz =&gt; { _ =&gt; 17 }
</div>
Isn&#39;t the latter - translating xyz =&gt; 17 into xyz =&gt; { _ =&gt; 17 }
exactly the transformation I described at the beginning of this ticket?

I&#39;ll pop on #xml-compile...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also weird to see a complex UtcDateAndTime structure, where we have
&gt; such a nice iso standard dataTime type in schema&#39;s.  Although I have
&gt; encountered such before.
</div>
I&#39;ve given up trying to understand the insanity I see in schemas... so much
fail... :/  For example, is it even correct for the schema to specify these
fields as complex types, when they are only ever going to be passed
strings?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;30&nbsp;14:37:24&nbsp;2012</span>
    <span class="description">website [...] craneveer.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79270] Request: handle complexType/simple content nicer</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Aug 2012 20:37:11 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Karen Etheridge via RT &lt;bug-XML-Compile-SOAP [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;website [...] craneveer.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Karen Etheridge via RT &#40;bug-XML-Compile-SOAP@rt.cpan.org&#41; [120830 18:28]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-Compile-SOAP
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79270">https://rt.cpan.org/Ticket/Display.html?id=79270</a></span> &gt;
&gt; 
<div class="message-stanza open">&gt; &gt; There is only a valid case for complexType/simpleContent structures
&gt; &gt; to translate  &lt;xyz abc=&#34;42&#34;&gt;13&lt;/xyz&gt;   into   xyz =&gt; {abc =&gt; 42, _ =&gt; 13}
&gt; &gt; and to allow   xyz =&gt; 17  as alternative for  xyz =&gt; { _ =&gt; 17 }
</div>&gt; 
&gt; Isn&#39;t the latter - translating xyz =&gt; 17 into xyz =&gt; { _ =&gt; 17 }
&gt; exactly the transformation I described at the beginning of this ticket?
</div>
Yes, you found that in the man-page.  You want to use that transformation
on something where it cannot be used for, as I have explained twice by
now.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ll pop on #xml-compile...
</div>
You you think that will change my answer?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ve given up trying to understand the insanity I see in schemas...
</div>
Most schema&#39;s contain some bugs.  Like most programmers, many schema
developers also do not understand/know all options.  Some tools do help
them making the right decissions, usually not.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; For example, is it even correct for the schema to specify these
&gt; fields as complex types, when they are only ever going to be passed
&gt; strings?
</div>
Only if they are &#34;mixed&#34;, which means &#34;free format&#34;.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;30&nbsp;15:02:59&nbsp;2012</span>
    <span class="description">ether [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79270] Request: handle complexType/simple content nicer</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Aug 2012 12:02:51 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Mark Overmeer via RT &lt;bug-XML-Compile-SOAP [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Karen Etheridge &lt;ether [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Aug 30, 2012 at 02:37:25PM -0400, Mark Overmeer via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Isn&#39;t the latter - translating xyz =&gt; 17 into xyz =&gt; { _ =&gt; 17 }
&gt; &gt; exactly the transformation I described at the beginning of this ticket?
</div>&gt; 
&gt; Yes, you found that in the man-page.  You want to use that transformation
&gt; on something where it cannot be used for, as I have explained twice by
&gt; now.
&gt;
<div class="message-stanza open">&gt; &gt; I&#39;ll pop on #xml-compile...
</div>&gt; 
&gt; You you think that will change my answer?
</div>
I&#39;m not trying to argue with you, I&#39;m trying to understand what you&#39;re
saying.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; For example, is it even correct for the schema to specify these
&gt; &gt; fields as complex types, when they are only ever going to be passed
&gt; &gt; strings?
</div>&gt; 
&gt; Only if they are &#34;mixed&#34;, which means &#34;free format&#34;.
</div>
What about the UtcDateAndTime field? it&#39;s complex &#40;a nested hash&#41;, but it
cannot be free-format - it must have the specified fields nested in it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;30&nbsp;15:50:00&nbsp;2012</span>
    <span class="description">website [...] craneveer.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79270] Request: handle complexType/simple content nicer</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 30 Aug 2012 21:49:22 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Karen Etheridge via RT &lt;bug-XML-Compile-SOAP [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;website [...] craneveer.nl&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Karen Etheridge via RT &#40;bug-XML-Compile-SOAP@rt.cpan.org&#41; [120830 19:03]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; You you think that will change my answer?
</div>&gt; I&#39;m not trying to argue with you, I&#39;m trying to understand what you&#39;re
&gt; saying.
</div>
Second part of the attached slides may help you understanding it better.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What about the UtcDateAndTime field? it&#39;s complex &#40;a nested hash&#41;, but it
&gt; cannot be free-format - it must have the specified fields nested in it.
</div>
It is not a field but a container &#40;complexType&#41;.  Containers are either
complexContent &#40;with nested elements&#41;, simpleContent &#40;single value&#41;, or
mixed.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;16&nbsp;13:58:32&nbsp;2012</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">cannot be implemented
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;16&nbsp;13:58:32&nbsp;2012</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
