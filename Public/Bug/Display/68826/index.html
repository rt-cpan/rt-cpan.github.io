<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #68826 for POE-Component-Server-REST: POE::Component::Server::REST 1.03: Extracted key is always empty</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #68826 for POE-Component-Server-REST: POE::Component::Server::REST 1.03: Extracted key is always empty</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/POE-Component-Server-REST/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/POE-Component-Server-REST/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/POE-Component-Server-REST/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/POE-Component-Server-REST/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/POE-Component-Server-REST">POE-Component-Server-REST CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">68826</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/POE-Component-Server-REST/Active/">POE-Component-Server-REST</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">cpan.helba [...] recursor.net
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
markus.jansen [...] ericsson.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-237740-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.06    </td>
  </tr>
  <tr id="CF-237741-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.07    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Picture &#40;Metafile&#41; 1.jpg<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/945566/491668/Picture%20(Metafile)%201.jpg">
Wed Jun 15 05:16:13 2011 (1011b) by markus.jansen [...] ericsson.com
</a>
</font></li>
</ul>


Picture &#40;Metafile&#41; 2.jpg<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/945566/491669/Picture%20(Metafile)%202.jpg">
Wed Jun 15 05:16:13 2011 (2.5k) by markus.jansen [...] ericsson.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;15&nbsp;05:16:13&nbsp;2011</span>
    <span class="description">markus.jansen [...] ericsson.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> POE::Component::Server::REST 1.03: Extracted key is always empty</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 15 Jun 2011 11:15:56 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-POE-Component-Server-REST [...] rt.cpan.org&#34; &lt;bug-POE-Component-Server-REST [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Jean,

I think I have found a defect in POE::Component::Server::REST 1.03; I simply cannot get a key argument extracted from a URL.
The attached patch works &#40;main change in the &#34;unless&#34; line, the others are just a sort of hardening ...&#41;.
It would be great if you could consider the patch with Component::Server::REST 1.04 &#40;or tell me what I am doing wrong&#41;.

Best regards,
        Markus Jansen


diff -c /vobs/cc/CCA-perl01/perl5____________________sixtyfive_char_path/prod/lib/site_perl/5.10.1/POE/Component/Server/REST.pm perl5/POE/Component/Server
*** /vobs/cc/CCA-perl01/perl5____________________sixtyfive_char_path/prod/lib/site_perl/5.10.1/POE/Component/Server/REST.pm     Sat Jun 11 15:52:40 2011
--- perl5/POE/Component/Server/REST.pm  Wed Jun 15 11:11:21 2011
***************
*** 547,553 ****
      # Get the method name
      my $uri = $request-&gt;uri;
      debug&#40;&#34; requested uri: $uri&#34;&#41;;
!     unless &#40; $uri =~ /&#40;\/\D+&#41;&#40;\/\w+&#41;?&#40;\/&#41;?&#40;\?session=&#40;.+&#41;&#41;?$/ &#41; {
          $kernel-&gt;yield&#40; &#39;FAULT&#39;, $response, CLIENT_BADREQUEST, &#39;Bad Request&#39;, &#34;Unrecognized REST url structure: $uri&#34;, &#41;;
          return;
      }
--- 547,553 ----
      # Get the method name
      my $uri = $request-&gt;uri;
      debug&#40;&#34; requested uri: $uri&#34;&#41;;
!     unless &#40; $uri =~ /&#40;\/\D+?&#41;&#40;\/\w+&#41;?&#40;\/&#41;?&#40;\?w+=&#40;.+&#41;&#41;?$/ &#41; {
          $kernel-&gt;yield&#40; &#39;FAULT&#39;, $response, CLIENT_BADREQUEST, &#39;Bad Request&#39;, &#34;Unrecognized REST url structure: $uri&#34;, &#41;;
          return;
      }
***************
*** 557,564 ****
      my $restkey = $2 || &#39;&#39;;

      # Remove trailing slash
!     $method  =~ s/\/$//;
!     $restkey =~ s/^\///;

      # Add prefx with given HTTP request method eg. PUT/foo/baz/bar
      $method = &#34;$type$method&#34;;
--- 557,564 ----
      my $restkey = $2 || &#39;&#39;;

      # Remove trailing slash
!     $method  =~ s,/+$,,;
!     $restkey =~ s,^/+,,;

      # Add prefx with given HTTP request method eg. PUT/foo/baz/bar
      $method = &#34;$type$method&#34;;




Markus Jansen

Ericsson GmbH
Eurolab R&#38;D
Ericsson Allee 1
52134 Herzogenrath, Germany
Phone +49 2407 575 5157
Fax +49 22407 575 150
Mobile +49 172 2742003
markus.jansen@ericsson.com
www.ericsson.com



Ericsson GmbH. Sitz: Düsseldorf. Registergericht: Amtsgericht Düsseldorf, HRB 33012. Geschäftsführer: Stefan Koetz &#40;Vors.&#41;, Nils de Baar, Bernd Schmidt. Aufsichtsratsvorsitzender: Anders Runevad.

This Communication is confidential. We only send and receive email on the basis of the terms set out at www.ericsson.com/email_disclaimer&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.ericsson.com/email_disclaimer">http://www.ericsson.com/email_disclaimer</a></span>&gt;.
</div></div>

<div class="messagebody">
</div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/945566/491668/Picture%20%26%2340%3BMetafile%26%2341%3B%201.jpg">Download Picture &#40;Metafile&#41; 1.jpg</a><br />
<span class="downloadcontenttype">image/jpeg 1011b</span>
</div>
<div class="messagebody">
<img alt="Picture &#40;Metafile&#41; 1.jpg" title="Picture &#40;Metafile&#41; 1.jpg" src="/Ticket/Attachment/945566/491668/" /></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/945566/491669/Picture%20%26%2340%3BMetafile%26%2341%3B%202.jpg">Download Picture &#40;Metafile&#41; 2.jpg</a><br />
<span class="downloadcontenttype">image/jpeg 2.5k</span>
</div>
<div class="messagebody">
<img alt="Picture &#40;Metafile&#41; 2.jpg" title="Picture &#40;Metafile&#41; 2.jpg" src="/Ticket/Attachment/945566/491669/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;15&nbsp;13:09:04&nbsp;2011</span>
    <span class="description">markus.jansen [...] ericsson.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #68826] AutoReply: POE::Component::Server::REST 1.03: Extracted key is always empty </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 15 Jun 2011 19:08:52 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-POE-Component-Server-REST [...] rt.cpan.org&#34; &lt;bug-POE-Component-Server-REST [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi again,

below is an improved path, which works especially when extending the query via parameters to the URL.

Best regards,
        Markus


diff -c /vobs/cc/CCA-perl01/perl5____________________sixtyfive_char_path/prod/lib/site_perl/5.10.1/POE/Component/Server/REST.pm perl5/POE/Component/Server
*** /vobs/cc/CCA-perl01/perl5____________________sixtyfive_char_path/prod/lib/site_perl/5.10.1/POE/Component/Server/REST.pm     Sat Jun 11 15:52:40 2011
--- perl5/POE/Component/Server/REST.pm  Wed Jun 15 19:06:23 2011
***************
*** 547,553 ****
      # Get the method name
      my $uri = $request-&gt;uri;
      debug&#40;&#34; requested uri: $uri&#34;&#41;;
!     unless &#40; $uri =~ /&#40;\/\D+&#41;&#40;\/\w+&#41;?&#40;\/&#41;?&#40;\?session=&#40;.+&#41;&#41;?$/ &#41; {
          $kernel-&gt;yield&#40; &#39;FAULT&#39;, $response, CLIENT_BADREQUEST, &#39;Bad Request&#39;, &#34;Unrecognized REST url structure: $uri&#34;, &#41;;
          return;
      } 
--- 547,555 ----
      # Get the method name
      my $uri = $request-&gt;uri;
      debug&#40;&#34; requested uri: $uri&#34;&#41;;
!     my $uri_params = &#39;&#39;;
!     &#40; $uri, $uri_params &#41; = &#40; $1, $2 &#41; if &#40; $uri =~ m,^&#40;.+?&#41;\?&#40;.*&#41;$,s &#41;;
!     unless &#40; $uri =~ m,&#40;/\D+?&#41;&#40;/\w+&#41;?&#40;/&#41;?$,s &#41; {
          $kernel-&gt;yield&#40; &#39;FAULT&#39;, $response, CLIENT_BADREQUEST, &#39;Bad Request&#39;, &#34;Unrecognized REST url structure: $uri&#34;, &#41;;
          return;
      } 
***************
*** 557,564 ****
      my $restkey = $2 || &#39;&#39;;
  
      # Remove trailing slash
!     $method  =~ s/\/$//;
!     $restkey =~ s/^\///;
  
      # Add prefx with given HTTP request method eg. PUT/foo/baz/bar
      $method = &#34;$type$method&#34;;
--- 559,566 ----
      my $restkey = $2 || &#39;&#39;;
  
      # Remove trailing slash
!     $method  =~ s,/+$,,;
!     $restkey =~ s,^/+,,;
  
      # Add prefx with given HTTP request method eg. PUT/foo/baz/bar
      $method = &#34;$type$method&#34;; 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Bugs in POE-Component-Server-REST via RT [mailto:bug-POE-Component-Server-REST@rt.cpan.org] 
Sent: Wednesday, June 15, 2011 11:16 AM
To: Markus Jansen
Subject: [rt.cpan.org #68826] AutoReply: POE::Component::Server::REST 1.03: Extracted key is always empty 


Greetings,

This message has been automatically generated in response to the creation of a trouble ticket regarding:
        &#34;POE::Component::Server::REST 1.03: Extracted key is always empty&#34;, a summary of which appears below.

There is no need to reply to this message right now.  Your ticket has been assigned an ID of [rt.cpan.org #68826].  Your ticket is accessible on the web at:

    <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=68826">https://rt.cpan.org/Ticket/Display.html?id=68826</a></span>

Please include the string:

         [rt.cpan.org #68826]

in the subject line of all future correspondence about this issue. To do so, you may reply to this message.

                        Thank you,
                        bug-POE-Component-Server-REST@rt.cpan.org

-------------------------------------------------------------------------
Hello Jean,

I think I have found a defect in POE::Component::Server::REST 1.03; I simply cannot get a key argument extracted from a URL.
The attached patch works &#40;main change in the &#34;unless&#34; line, the others are just a sort of hardening ...&#41;.
It would be great if you could consider the patch with Component::Server::REST 1.04 &#40;or tell me what I am doing wrong&#41;.

Best regards,
        Markus Jansen


diff -c /vobs/cc/CCA-perl01/perl5____________________sixtyfive_char_path/prod/lib/site_perl/5.10.1/POE/Component/Server/REST.pm perl5/POE/Component/Server
*** /vobs/cc/CCA-perl01/perl5____________________sixtyfive_char_path/prod/lib/site_perl/5.10.1/POE/Component/Server/REST.pm     Sat Jun 11 15:52:40 2011
--- perl5/POE/Component/Server/REST.pm  Wed Jun 15 11:11:21 2011
***************
*** 547,553 ****
      # Get the method name
      my $uri = $request-&gt;uri;
      debug&#40;&#34; requested uri: $uri&#34;&#41;;
!     unless &#40; $uri =~ /&#40;\/\D+&#41;&#40;\/\w+&#41;?&#40;\/&#41;?&#40;\?session=&#40;.+&#41;&#41;?$/ &#41; {
          $kernel-&gt;yield&#40; &#39;FAULT&#39;, $response, CLIENT_BADREQUEST, &#39;Bad Request&#39;, &#34;Unrecognized REST url structure: $uri&#34;, &#41;;
          return;
      }
--- 547,553 ----
      # Get the method name
      my $uri = $request-&gt;uri;
      debug&#40;&#34; requested uri: $uri&#34;&#41;;
!     unless &#40; $uri =~ /&#40;\/\D+?&#41;&#40;\/\w+&#41;?&#40;\/&#41;?&#40;\?w+=&#40;.+&#41;&#41;?$/ &#41; {
          $kernel-&gt;yield&#40; &#39;FAULT&#39;, $response, CLIENT_BADREQUEST, &#39;Bad Request&#39;, &#34;Unrecognized REST url structure: $uri&#34;, &#41;;
          return;
      }
***************
*** 557,564 ****
      my $restkey = $2 || &#39;&#39;;

      # Remove trailing slash
!     $method  =~ s/\/$//;
!     $restkey =~ s/^\///;

      # Add prefx with given HTTP request method eg. PUT/foo/baz/bar
      $method = &#34;$type$method&#34;;
--- 557,564 ----
      my $restkey = $2 || &#39;&#39;;

      # Remove trailing slash
!     $method  =~ s,/+$,,;
!     $restkey =~ s,^/+,,;

      # Add prefx with given HTTP request method eg. PUT/foo/baz/bar
      $method = &#34;$type$method&#34;;




Markus Jansen

Ericsson GmbH
Eurolab R&#38;D
Ericsson Allee 1
52134 Herzogenrath, Germany
Phone +49 2407 575 5157
Fax +49 22407 575 150
Mobile +49 172 2742003
markus.jansen@ericsson.com
www.ericsson.com



Ericsson GmbH. Sitz: Düsseldorf. Registergericht: Amtsgericht Düsseldorf, HRB 33012. Geschäftsführer: Stefan Koetz &#40;Vors.&#41;, Nils de Baar, Bernd Schmidt. Aufsichtsratsvorsitzender: Anders Runevad.

This Communication is confidential. We only send and receive email on the basis of the terms set out at www.ericsson.com/email_disclaimer&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.ericsson.com/email_disclaimer">http://www.ericsson.com/email_disclaimer</a></span>&gt;.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;18&nbsp;08:31:10&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;18&nbsp;08:45:00&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Markus,

Thanks for the report and patches. I&#39;ll have a look at it. The URL
extraction regex is currently not so smart. In order to get rid of the
?session parameter and the mess resulting from it. 

I&#39;ll rework the url to be in form of /&lt;session&gt;/&lt;resources&gt;/&lt;key&gt; which
would look like the following for a session called &#39;infoservice&#39; with
registered method GET/country/town triggered with a key &#39;123&#39;: GET
/infoservice/country/town/123 - that should simplify extracting the key
alot. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;18&nbsp;08:45:01&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;19&nbsp;13:48:24&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Markus,

I&#39;ve implemented a far more sane service/resources/key extraction
version in 1.06 which is currently beeing deployed on CPAN directories. 

Feel free to test it and tell me if it solved your problem.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;19&nbsp;13:48:25&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;19&nbsp;13:49:48&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Jun 19 13:48:24 2011, JSTEBENS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Markus,
&gt; 
&gt; I&#39;ve implemented a far more sane service/resources/key extraction
&gt; version in 1.06 which is currently beeing deployed on CPAN directories. 
&gt; 
&gt; Feel free to test it and tell me if it solved your problem.
</div>
For a concrete example, please see the examples/server.pl file - worked
perfectly for me :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;19&nbsp;13:49:49&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;20&nbsp;09:34:28&nbsp;2011</span>
    <span class="description">markus.jansen [...] ericsson.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #68826] POE::Component::Server::REST 1.03: Extracted key is always empty </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 20 Jun 2011 15:34:14 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-POE-Component-Server-REST [...] rt.cpan.org&#34; &lt;bug-POE-Component-Server-REST [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jean,

version 1.06 has some great improvements.
Unfortunately, I still fail to get non-numeric arguments sorted out:

The following pattern applies &#40;registered myservice/mymethod&#41;:

        URL                                             method                  argument

        .../myservice/mymethod/123              mymethod                        123
        .../myservice/mymethod/ABC              mymethod/ABC            &lt;empty&gt;
        .../myservice/mymethod/ABC/123  mymethod/ABC            123
        .../myservice/mymethod/2011/06  mymethod/2011           06

whereas I would expect:

        URL                                             method                  argument

        .../myservice/mymethod/123              mymethod                        123
        .../myservice/mymethod/ABC              mymethod                        ABC
        .../myservice/mymethod/ABC/123  mymethod                        ABC/123
        .../myservice/mymethod/2011/06  mymethod                        2011/06

It basically boils down whether IDs are strictly numerical, and whether to place hierarcies
on the method side of life, or support them in the argument &#40;2011/06 should be valid arguments&#41;.

The most elegent and general way would be to adapt the extraction according to the methods registered.

Best regards,
        Markus

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Jean Stebens via RT [mailto:bug-POE-Component-Server-REST@rt.cpan.org] 
Sent: Sunday, June 19, 2011 7:50 PM
To: Markus Jansen
Subject: [rt.cpan.org #68826] POE::Component::Server::REST 1.03: Extracted key is always empty 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=68826">https://rt.cpan.org/Ticket/Display.html?id=68826</a></span> &gt;

On Sun Jun 19 13:48:24 2011, JSTEBENS wrote:
<div class="message-stanza open">&gt; Hi Markus,
&gt; 
&gt; I&#39;ve implemented a far more sane service/resources/key extraction 
&gt; version in 1.06 which is currently beeing deployed on CPAN directories.
&gt; 
&gt; Feel free to test it and tell me if it solved your problem.
</div>
For a concrete example, please see the examples/server.pl file - worked perfectly for me :&#41;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;20&nbsp;10:40:04&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jun 20 15:34:28 2011, markus.jansen@ericsson.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; whereas I would expect:
&gt; 
&gt; URL method argument:
&gt;.../myservice/mymethod/123 mymethod 123
&gt;.../myservice/mymethod/ABC mymethod ABC
&gt;.../myservice/mymethod/ABC/123 mymethod ABC/123
&gt;.../myservice/mymethod/2011/06 mymethod 2011/06
</div>


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; It basically boils down whether IDs are strictly numerical, and
&gt; whether to place hierarcies
&gt; on the method side of life, or support them in the argument &#40;2011/06
&gt; should be valid arguments&#41;.
</div>Correct - in my understanding KEYs should always be numerical, or at
heaviest some hexadecimal representation. Thats why the service only
sets the key when they are numerical.

The design of 1.06 actually implies that for each hierarchical resource
you need a method. This simplifies the binding of methods for resources
- else the service would need to hold some kind of hierarchical method
information, which would be a bit heavier - I&#39;ve love to keep it simple.
But nevertheless I can understand the way it should be - I&#39;ll try to
come up with a decent solution in the next weeks, which allows paths to
be part of keys.

Thanks for the hint,
Jean
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;10:55:03&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Markus,

There is a first implementation available at: 
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/jstebens/POE-Component-Server-REST">https://github.com/jstebens/POE-Component-Server-REST</a></span>
Feel free to test it - worked for the example server. 

The drawbacks: 

1&#41; Obligatory to delete the published paths/method relations in a
hierarchical correct order. ie. the server wont allow deletion of a
path/method relation if other path/method relations are still below it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; delete /foo/baz/bar [ok]
&gt; delete /foo/baz [ok]
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; delete /foo/baz [FAIL - cause bar is still active]
&gt; delete /foo/baz/bar [ok]
</div>
2&#41; Reduced speed because of tree parsing. Methods arent only verified
accourding to their tree entry, but also against a simply list called
INTERFACES.

Cheers,
Jean
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;10:55:23&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;10:55:44&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Severity Wishlist added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;10:55:44&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Broken in 1.06 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;15:28:52&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed some last bugs and cleaned up code with method hierarchy in commit
b9d75dc9a1fcdb13b750d11ff50e463e45a6592e - feel free to check it out and
play with.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;21&nbsp;15:28:53&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;22&nbsp;14:14:18&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Fixed in 1.07 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;25&nbsp;08:59:14&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">All fixed in 1.08 - please have a look and do a review based on the 
latest version - thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;25&nbsp;08:59:16&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;28&nbsp;13:52:48&nbsp;2011</span>
    <span class="description">markus.jansen [...] ericsson.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #68826] POE::Component::Server::REST 1.03: Extracted key is always empty </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Jun 2011 16:14:29 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-POE-Component-Server-REST [...] rt.cpan.org&#34; &lt;bug-POE-Component-Server-REST [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Markus Jansen &lt;markus.jansen [...] ericsson.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Jean,

sorry for the late reply, and thanks for the great work on your side! Everything seems to work pretty well.
I already started testing the github code, but then got hit by a reliability problem
which fortunately had nothing to do with POE and your code &#40;far too old Solaris 10 tcp/kernel patch&#41;,
and after that I got fully occupied by another task ...

Best regards,
        Markus

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Jean via RT [mailto:bug-POE-Component-Server-REST@rt.cpan.org] 
Sent: Saturday, June 25, 2011 2:59 PM
To: Markus Jansen
Subject: [rt.cpan.org #68826] POE::Component::Server::REST 1.03: Extracted key is always empty 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=68826">https://rt.cpan.org/Ticket/Display.html?id=68826</a></span> &gt;

All fixed in 1.08 - please have a look and do a review based on the latest version - thanks.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;28&nbsp;13:52:50&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;28&nbsp;17:47:52&nbsp;2011</span>
    <span class="description">cpan.helba [...] recursor.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jun 28 19:52:48 2011, markus.jansen@ericsson.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello Jean,
&gt; 
&gt; sorry for the late reply, and thanks for the great work on your side!
&gt; Everything seems to work pretty well.
&gt; I already started testing the github code, but then got hit by a
&gt; reliability problem
&gt; which fortunately had nothing to do with POE and your code &#40;far too
&gt; old Solaris 10 tcp/kernel patch&#41;,
&gt; and after that I got fully occupied by another task ...
</div>
I&#39;d appreciate a realistic rating from you on the current version and
overfall approach &#40;you know the little 0 to 5 stars on cpan module
overview&#41; - thanks!
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
