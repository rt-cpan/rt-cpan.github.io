<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #41713 for DBD-ODBC: ODBC driver does not support SQL_COLUMN_DISPLAY_SIZE on SQLTables&#40;&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #41713 for DBD-ODBC: ODBC driver does not support SQL_COLUMN_DISPLAY_SIZE on SQLTables&#40;&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-ODBC">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-ODBC">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-ODBC">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-ODBC">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-ODBC">DBD-ODBC CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">41713</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-ODBC">DBD-ODBC</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
eremmel [...] zonnet.nl

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-10188-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10189-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.17_3    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




dbdimp_c_fix_diffC3.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/543878/273420/dbdimp_c_fix_diffC3.txt">
Mon Dec 15 06:33:48 2008 (2.2k) by eremmel [...] zonnet.nl
</a>
</font></li>
</ul>


dbdimp_c_fix_trace.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/543878/273423/dbdimp_c_fix_trace.txt">
Mon Dec 15 06:33:48 2008 (43.6k) by eremmel [...] zonnet.nl
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=41713">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-543878" href="/Public/Bug/Display.html?id=41713#txn-543878">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;15&nbsp;06:33:48&nbsp;2008</span>
    <span class="description">eremmel [...] zonnet.nl -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ODBC driver does not support SQL_COLUMN_DISPLAY_SIZE on SQLTables&#40;&#41;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/543878/273417/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273417">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">DBD-ODBC-1.17 : &#40;ODBC.pm 11768 2008-09-12 13:00:28Z mjevans&#41;
perl : v5.10.0 built for MSWin32-x86-multi-thread, Binary build 1004
[287188] provided by ActiveState, Built Sep  3 2008 13:16:37

I use a propriety ODBC driver that does not support
SQL_COLUMN_DISPLAY_SIZE and SQL_COLUMN_LENGTH on statement handles that
come from a call to SQLTables&#40;&#41; and SQLColumns&#40;&#41;.

I did some debugging to find out and made a &#39;fix&#39; in
dbdimp.c,dbd_descibe&#40;&#41;. The function dbd_descibe&#40;&#41; contains via an
#ifdef a fallback when in the interface does not support
SQL_COLUMN_DISPLAY_SIZE and SQL_COLUMN_LENGTH, I extended this. Now the
interface accepts when the implementation does not support those column
attributes and falls back to a default value.

The point that I address it here rather at the implementator of the
ODBC-driver is that this driver works fine with MS office, cognos etc.
Also in respect to retrieving meta data like table and column info.

I hope that you will except this change so I&#39;ve not to stick to my
private build and it gives me the possibility to utilize Perl in
combination with this driver to a broader audience that myself.

Please find attached a fix in diff-C3 format and a trace file based on
this fix. In this trace I perform a list of some tables, get the columns
of a table and perform a query on that table. The first two actions show
the problem of the not supported attributes the later not.

Regards,

JHF  
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dbdimp_c_fix_diffC3.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/543878/273420/dbdimp_c_fix_diffC3.txt">Download dbdimp_c_fix_diffC3.txt</a><br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">*** DBD-ODBC-1.17\dbdimp.c	Fri Sep 12 15:01:28 2008
--- DBD-ODBC-1.17-new\dbdimp.c	Mon Dec 15 12:25:36 2008
***************
*** 2067,2075 ****
                                NULL, 0, NULL ,
                                &#38;fbh-&gt;ColDisplaySize&#41;;/* TBD: 3.0 update */
          if &#40;!SQL_SUCCEEDED&#40;rc&#41;&#41; {
!             dbd_error&#40;
!                 h, rc, &#34;describe/SQLColAttributes/SQL_COLUMN_DISPLAY_SIZE&#34;&#41;;
!             break;
          } else if &#40;DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41;&#41; {
              TRACE1&#40;imp_sth, &#34;     display size = %ld\n&#34;, fbh-&gt;ColDisplaySize&#41;;
          }
--- 2067,2078 ----
                                NULL, 0, NULL ,
                                &#38;fbh-&gt;ColDisplaySize&#41;;/* TBD: 3.0 update */
          if &#40;!SQL_SUCCEEDED&#40;rc&#41;&#41; {
!             if&#40; DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41; &#41; {
!                     TRACE1&#40;imp_sth, &#34;     describe/SQLColAttributes/SQL_COLUMN_DISPLAY_SIZE not supported, will be equal to SQL_COLUMN_LENGTH\n&#34;,0&#41;;
!             }
!             /* ColDisplaySize will be made equal to ColLength */
!             fbh-&gt;ColDisplaySize = 0;
!             rc = SQL_SUCCESS;
          } else if &#40;DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41;&#41; {
              TRACE1&#40;imp_sth, &#34;     display size = %ld\n&#34;, fbh-&gt;ColDisplaySize&#41;;
          }
***************
*** 2086,2093 ****
                                SQL_COLUMN_LENGTH,
                                NULL, 0, NULL ,&#38;fbh-&gt;ColLength&#41;;
          if &#40;!SQL_SUCCEEDED&#40;rc&#41;&#41; {
!             dbd_error&#40;h, rc, &#34;describe/SQLColAttributes/SQL_COLUMN_LENGTH&#34;&#41;;
!             break;
          } else if &#40;DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41;&#41; {
              TRACE1&#40;imp_sth, &#34;     column length = %ld\n&#34;, fbh-&gt;ColLength&#41;;
          }
--- 2089,2099 ----
                                SQL_COLUMN_LENGTH,
                                NULL, 0, NULL ,&#38;fbh-&gt;ColLength&#41;;
          if &#40;!SQL_SUCCEEDED&#40;rc&#41;&#41; {
!             fbh-&gt;ColLength = 2001;	/* XXX! */
!             if&#40; DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41; &#41; {
!                 TRACE1&#40;imp_sth, &#34;     describe/SQLColAttributes/SQL_COLUMN_LENGT not supported, fallback on %d\n&#34;,fbh-&gt;ColLength&#41;;
!             }
!             rc = SQL_SUCCESS;
          } else if &#40;DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41;&#41; {
              TRACE1&#40;imp_sth, &#34;     column length = %ld\n&#34;, fbh-&gt;ColLength&#41;;
          }
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dbdimp_c_fix_trace.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/543878/273423/dbdimp_c_fix_trace.txt">Download dbdimp_c_fix_trace.txt</a><br />
<span class="downloadcontenttype">text/plain 43.6k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-543897" href="/Public/Bug/Display.html?id=41713#txn-543897">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;15&nbsp;07:56:59&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/543897/273429/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273429">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 360b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for this submission. I will start taking a look at it this
evening and try and get back to you in a day or so. Unless it adversely
affects functionality with other ODBC drivers I cannot see why it should
not be included in the next release of DBD::ODBC but I&#39;ll know more when
I&#39;ve had a chance to look at it.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-543898" href="/Public/Bug/Display.html?id=41713#txn-543898">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;15&nbsp;07:57:00&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544092" href="/Public/Bug/Display.html?id=41713#txn-544092">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;15&nbsp;15:22:16&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/544092/273525/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273525">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 922b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I made some changes to your patch. TRACE1 calls with no substitution
args for the printf format can be TRACE0. The second think is that the
2001 default should really be configurable so I&#39;ll work on making it so
&#40;not your problem but your patch highlighted it&#41;. The final thing is
that it seems a waste of time to keep calling SQLColAttributes once you
know it fails for SQL_COLUMN_DISPLAY_SIZE and SQL_COLUMN_LENGTH.
However, on the last point, if I understand your posting, these values
are only not returned for SQLTables and SQLColumns calls. If you can
confirm that these attributes work at other times then there is nothing
else to do. If on the other hand you are saying you driver never
succeeds on these attributes then after the first call fails we can
record that fact and always just default.

Get back to me and I can send you a version to test then I will release it.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544095" href="/Public/Bug/Display.html?id=41713#txn-544095">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;15&nbsp;15:23:22&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/544095/273528/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273528">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 166b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Just forgot. It would be useful to know what the ODBC driver is so I can
at least document why we do this in the source code.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544127" href="/Public/Bug/Display.html?id=41713#txn-544127">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;15&nbsp;16:30:28&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/544127/273568/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273568">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 306b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Your patch is now applied with minor modification and I&#39;ve made default
column display size a $dbh and $sth attribute. Just need to write tests
for it. If you want a 1.17_3 development release to test please let me
know. I&#39;d rather you try it before it is released.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544299" href="/Public/Bug/Display.html?id=41713#txn-544299">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;03:38:20&nbsp;2008</span>
    <span class="description">eremmel [...] zonnet.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> eremmel [...] zonnet.nl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/544299/273665/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273665">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 229b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Ma. Dec. 15 16:30:28 2008, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you want a 1.17_3 development release to test please let me
&gt; know. I&#39;d rather you try it before it is released.
</div>

Please send me a patch I will test it against the drivers I use.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544301" href="/Public/Bug/Display.html?id=41713#txn-544301">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;03:44:01&nbsp;2008</span>
    <span class="description">eremmel [...] zonnet.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> eremmel [...] zonnet.nl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/544301/273667/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273667">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 758b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Ma. Dec. 15 15:22:16 2008, MJEVANS wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, on the last point, if I understand your posting, these values
&gt; are only not returned for SQLTables and SQLColumns calls. If you can
&gt; confirm that these attributes work at other times then there is nothing
&gt; else to do. If on the other hand you are saying you driver never
&gt; succeeds on these attributes then after the first call fails we can
&gt; record that fact and always just default.
&gt; 
&gt; Martin
</div>
I glad that you understood my posting &#40;only SQLTables and SQLColumns do
not support those attributes&#41;. BTW disabling those attributes &#39;forever&#39;
when they fail once might limit the functionality for other drivers as
well to much. Skipping those calls per request after first failure makes
sense to me.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544310" href="/Public/Bug/Display.html?id=41713#txn-544310">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;03:58:23&nbsp;2008</span>
    <span class="description">eremmel [...] zonnet.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> eremmel [...] zonnet.nl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/544310/273672/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273672">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 420b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Ma. Dec. 15 15:23:22 2008, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Just forgot. It would be useful to know what the ODBC driver is so I can
&gt; at least document why we do this in the source code.
&gt; 
&gt; Martin
</div>The driver name is:
DSN name: Infor Integration ODBC driver
This driver is developed to access &#40;read-only&#41; Infor ERP LN, Infor Baan
IV, etc and gives uniform access to data irrespective of implementation
database of the ERP software.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544312" href="/Public/Bug/Display.html?id=41713#txn-544312">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;04:00:38&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/544312/273674/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273674">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 189b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for all the information. I am adding a few tests and will then
put a distrib together for you to try. Expect to be done by lunch, uk time.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544330" href="/Public/Bug/Display.html?id=41713#txn-544330">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;04:41:31&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/544330/273683/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273683">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 260b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Try this:

ftp://ftp.easysoft.com/pub/DBD-ODBC-1.17_3.tar.gz

You&#39;ll note a new odbc_column_display_size attribute which defaults to
what was hard-coded before. There are new tests in 03bind to check you
can get/set it.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544460" href="/Public/Bug/Display.html?id=41713#txn-544460">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;09:38:59&nbsp;2008</span>
    <span class="description">eremmel [...] zonnet.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> eremmel [...] zonnet.nl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/544460/273760/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273760">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Di. Dec. 16 04:41:31 2008, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Try this:
&gt; Martin
</div>
Hi Martin, great work and nice to make it configurable. I got it working
after some debugging. The property odbc_column_display_size is copied
from dbh to sth during odbc_st_prepare_sv, but calling
SQLTables/SQLColumns is not going via prepare. I doubt whether one
should break after failing on SQL_COLUMN_LENGTH in dbd_describe.

I saw you added some new tests. A few are failing against MS access db.
Is that know to you, or need you more details?

Find details:
*** dbdimp-1173.c       Tue Dec 16 10:22:08 2008
--- dbdimp.c    Tue Dec 16 15:17:15 2008
***************
*** 1487,1492 ****
--- 1487,1493 ----
        imp_sth-&gt;hstmt = SQL_NULL_HSTMT;
        return 0;
     }
+    imp_sth-&gt;odbc_column_display_size = imp_dbh-&gt;odbc_column_display_size;

     return build_results&#40;sth,rc&#41;;
  }
***************
*** 2108,2114 ****
                     &#34;supported, fallback on %d\n&#34;, fbh-&gt;ColLength&#41;;
            }
            rc = SQL_SUCCESS;
-           break;
          } else if &#40;DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41;&#41; {
              TRACE1&#40;imp_sth, &#34;     column length = %ld\n&#34;, fbh-&gt;ColLength&#41;;
          }
--- 2109,2114 ----
***************
*** 4961,4966 ****
--- 4961,4967 ----
          return 0;
      }

+     imp_sth-&gt;odbc_column_display_size = imp_dbh-&gt;odbc_column_display_size;
      return build_results&#40;sth,rc&#41;;
  }
***************
t/rt_39841..............ok 1/28# Looks like you planned 28 tests but
only ran 14.
t/rt_39841..............dubious
        Test returned status 255 &#40;wstat 65280, 0xff00&#41;
DIED. FAILED tests 15-28
        Failed 14/28 tests, 50.00% okay &#40;less 11 skipped tests: 3 okay,
10.71%&#41;
t/rt_39897..............ok
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544496" href="/Public/Bug/Display.html?id=41713#txn-544496">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;16&nbsp;10:44:59&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/544496/273787/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273787">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Dec 16 09:38:59 2008, eremmel wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Martin, great work and nice to make it configurable. I got it working
&gt; after some debugging. The property odbc_column_display_size is copied
&gt; from dbh to sth during odbc_st_prepare_sv, but calling
&gt; SQLTables/SQLColumns is not going via prepare. I doubt whether one
&gt; should break after failing on SQL_COLUMN_LENGTH in dbd_describe.
</div>
Good point. I didn&#39;t have a driver to test this on or I&#39;d have spotted
that and it seemed like a lot of effort to deliberately break one of our
drivers to test it when you had one already.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I saw you added some new tests. A few are failing against MS access db.
&gt; Is that know to you, or need you more details?
</div>
I&#39;ll get someone here to run against Access and see how we get on. If we
don&#39;t reproduce I may get back to you.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Find details:
&gt; *** dbdimp-1173.c       Tue Dec 16 10:22:08 2008
&gt; --- dbdimp.c    Tue Dec 16 15:17:15 2008
&gt; ***************
&gt; *** 1487,1492 ****
&gt; --- 1487,1493 ----
&gt;         imp_sth-&gt;hstmt = SQL_NULL_HSTMT;
&gt;         return 0;
&gt;      }
&gt; +    imp_sth-&gt;odbc_column_display_size =
</div>imp_dbh-&gt;odbc_column_display_size;

see notes below

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;      return build_results&#40;sth,rc&#41;;
&gt;   }
&gt; ***************
&gt; *** 2108,2114 ****
&gt;                      &#34;supported, fallback on %d\n&#34;, fbh-&gt;ColLength&#41;;
&gt;             }
&gt;             rc = SQL_SUCCESS;
&gt; -           break;
</div>fixed - I&#39;m afraid I manually applied your patch late last night and
forgot to delete the break.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;           } else if &#40;DBIc_TRACE&#40;imp_sth, 0, 0, 8&#41;&#41; {
&gt;               TRACE1&#40;imp_sth, &#34;     column length = %ld\n&#34;,
</div>fbh-&gt;ColLength&#41;;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;           }
&gt; --- 2109,2114 ----
&gt; ***************
&gt; *** 4961,4966 ****
&gt; --- 4961,4967 ----
&gt;           return 0;
&gt;       }
&gt; 
&gt; +     imp_sth-&gt;odbc_column_display_size =
</div>imp_dbh-&gt;odbc_column_display_size;

see notes below

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       return build_results&#40;sth,rc&#41;;
&gt;   }
&gt; ***************
&gt; t/rt_39841..............ok 1/28# Looks like you planned 28 tests but
&gt; only ran 14.
&gt; t/rt_39841..............dubious
&gt;         Test returned status 255 &#40;wstat 65280, 0xff00&#41;
&gt; DIED. FAILED tests 15-28
&gt;         Failed 14/28 tests, 50.00% okay &#40;less 11 skipped tests: 3 okay,
&gt; 10.71%&#41;
&gt; t/rt_39897..............ok
</div>
Will look into this.

Although your driver only does this on SQLTables and SQLColumns and
hence the fix you supplied would work the problem you found is for
anything calling build_results so I&#39;ve moved the:

imp_sth-&gt;odbc_column_display_size = imp_dbh-&gt;odbc_column_display_size;

into build_results.

In the mean time a new 1.17_3 is in the same place as before with the
fixes you outlined just done slightly differently.

Thanks again for you input.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544881" href="/Public/Bug/Display.html?id=41713#txn-544881">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;05:03:12&nbsp;2008</span>
    <span class="description">eremmel [...] zonnet.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> eremmel [...] zonnet.nl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/544881/273994/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/273994">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Di. Dec. 16 10:44:59 2008, MJEVANS wrote: 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Although your driver only does this on SQLTables and SQLColumns and
&gt; hence the fix you supplied would work the problem you found is for
&gt; anything calling build_results so I&#39;ve moved the:
&gt; 
&gt; imp_sth-&gt;odbc_column_display_size = imp_dbh-&gt;odbc_column_display_size;
&gt; 
&gt; into build_results.
&gt; 
&gt; Martin
</div>
Hi Martin,

I tested  this new version and it works great, thank you for being so
supportive.

This might not be the right place, but I like to make a few minor
remark, please just consider those as as things that you might consider
and nothing more.
1:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;Good point. I didn&#39;t have a driver to test this on
</div>My practice is in these cases, to add in the debug build e.g. an
environment var that indicates which and how the function should fail,
to test recovery code.
2:
I also noticed that you set a number of properties in odbc_st_prepare_sv
like odbc_query_timeout etc. Those might be applicable &#40;I do not know
the ODBC interface so well&#41; to the sth returned by SQLTables and
SQLColumns as well.
3:
I build the ODBC.dll with Visual Studio 6.0 and SDK Feb 2003. I needed
to add the library MSVCRT.lib or MSVCRTD.lib to the Makefile for ODBC.dll.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-544906" href="/Public/Bug/Display.html?id=41713#txn-544906">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;06:11:56&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/544906/274007/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/274007">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Dec 17 05:03:12 2008, eremmel wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Di. Dec. 16 10:44:59 2008, MJEVANS wrote: 
<div class="message-stanza open">&gt; &gt; Although your driver only does this on SQLTables and SQLColumns and
&gt; &gt; hence the fix you supplied would work the problem you found is for
&gt; &gt; anything calling build_results so I&#39;ve moved the:
&gt; &gt; 
&gt; &gt; imp_sth-&gt;odbc_column_display_size = imp_dbh-&gt;odbc_column_display_size;
&gt; &gt; 
&gt; &gt; into build_results.
&gt; &gt; 
&gt; &gt; Martin
</div>&gt; 
&gt; Hi Martin,
&gt; 
&gt; I tested  this new version and it works great, thank you for being so
&gt; supportive.
</div>
No problem. I will mark this rt as fixed when I release 1.17_3.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This might not be the right place, but I like to make a few minor
&gt; remark, please just consider those as as things that you might consider
&gt; and nothing more.
</div>
I&#39;ll reply here now but if you want to follow this up can you email
directly at martin dot evans at easysoft dot com.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 1:
<div class="message-stanza open">&gt; &gt;Good point. I didn&#39;t have a driver to test this on
</div>&gt; My practice is in these cases, to add in the debug build e.g. an
&gt; environment var that indicates which and how the function should fail,
&gt; to test recovery code.
</div>
Yes, I could have done that but in the end I&#39;d be testing the change as
I expected it to work and your driver may not have worked like I
understood from you. In this case I was pushed for time and felt it was
easiest for you to verify the change but I&#39;m sorry I got it wrong first
time and obviously caused you to waste some time.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 2:
&gt; I also noticed that you set a number of properties in odbc_st_prepare_sv
&gt; like odbc_query_timeout etc. Those might be applicable &#40;I do not know
&gt; the ODBC interface so well&#41; to the sth returned by SQLTables and
&gt; SQLColumns as well.
</div>
Yes, you are correct and I noticed that and made a note of it but in
this case I decided to leave alone the bits which are not definitely
broken but in any case I don&#39;t really think any apply.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 3:
&gt; I build the ODBC.dll with Visual Studio 6.0 and SDK Feb 2003. I needed
&gt; to add the library MSVCRT.lib or MSVCRTD.lib to the Makefile for ODBC.dll.
</div>
Could you send me privately the details of what error you got and how
you fixed it so I can add a note about it in the windows readme?

BTW, I referred to you as eremmel in the Changes file as I do not know
your name. If you would prefer something else let me know.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-546064" href="/Public/Bug/Display.html?id=41713#txn-546064">#</a>      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;21&nbsp;11:38:12&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-546066" href="/Public/Bug/Display.html?id=41713#txn-546066">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;21&nbsp;11:38:13&nbsp;2008</span>
    <span class="description">bohica [...] ntlworld.com -  Fixed in 1.17_3 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.82655</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
