<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #30033 for DBD-mysql: Quote marks in comments can break bind parameters</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #30033 for DBD-mysql: Quote marks in comments can break bind parameters</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-mysql">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-mysql">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-mysql">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-mysql">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-mysql">DBD-mysql CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">30033</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-mysql">DBD-mysql</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">CAPTTOFU [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ovid [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10170-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
4.013    </td>
  </tr>
  <tr id="CF-10171-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=30033">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-371898" href="/Public/Bug/Display.html?id=30033#txn-371898">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;16&nbsp;11:23:02&nbsp;2007</span>
    <span class="description">ovid [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Quote marks in comments can break bind parameters</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/371898/169138/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/169138">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 943b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The following program produces the error:

DBD::mysql::db selectrow_arrayref failed: called with 1 bind variables
when 0 are needed at mysqlbug.pl line 15.
DBD::mysql::db selectrow_arrayref failed: called with 1 bind variables
when 0 are needed at mysqlbug.pl line 15

The SQL is legal in MySQL &#40;tested on both 5.0.38 and 4.0.18&#41;, but fails
in DBD::mysql 3.008 and 4.005.  Removing the single quote mark in the
SQL comment or having an even number of quote marks fixes the problem.

Cheers,
Ovid

#!/usr/bin/perl

use strict;
use warnings;

use DBI;

my $dsn = &#34;DBI:mysql:database=mydatabase;host=localhost&#34;;
my $dbh = DBI-&gt;connect&#40; $dsn, qw/user pass/, { RaiseError =&gt; 1 } &#41;
  or die $DBI::errstr;

$dbh-&gt;do&#40;&#39;DROP TABLE IF EXISTS buggy&#39;&#41;;
$dbh-&gt;do&#40;&#39;CREATE TABLE buggy &#40; id int&#40;3&#41; &#41;&#39;&#41;;
$dbh-&gt;do&#40;&#39;INSERT INTO buggy &#40;id&#41; VALUES &#40;1&#41;&#39;&#41;;
$dbh-&gt;selectrow_arrayref&#40;&lt;&lt;&#39;END&#39;, {}, 1&#41;;
    SELECT id
    FROM buggy
    -- it&#39;s a bug!
    WHERE id = ?
END
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-378846" href="/Public/Bug/Display.html?id=30033#txn-378846">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;04&nbsp;07:07:11&nbsp;2007</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-392519" href="/Public/Bug/Display.html?id=30033#txn-392519">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;11&nbsp;13:25:54&nbsp;2007</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/392519/180582/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/180582">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 828b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The problem is the single quote in your statement in &#34;It&#39;s&#34;. 

The driver parses the statement, it sees the single quote in &#34;It&#39;s&#34;,
which it skips when parsing the statement - tring parse out the
place-holders &#40;the &#39;?&#39; char&#41;. I could fix this, but it would add more
statement parsing overhead for something that&#39;s taken 12 years to
stumble upon ;&#41;.

If you really must have a comment in your statement that includes a
single quote, have the server parse the statement, using server-side
prepare. You can do this by doing:

$dbh-&gt;{mysql_server_prepare} = 1;
query.... 
$dbh-&gt;{mysql_server_prepare} = 0;

or 

$dbh =
DBI-&gt;connect&#40;&#34;DBI:mysql:database=mydb;host=host;mysql_server_prepare=1&#34;...

Server side prepare is turned off in the driver by default because of
some issues with libmysql, but works just fine by turning it on.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-392520" href="/Public/Bug/Display.html?id=30033#txn-392520">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;11&nbsp;13:25:57&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-392523" href="/Public/Bug/Display.html?id=30033#txn-392523">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;11&nbsp;13:26:00&nbsp;2007</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-392524" href="/Public/Bug/Display.html?id=30033#txn-392524">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;11&nbsp;13:31:05&nbsp;2007</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/392524/180585/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/180585">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Dec 11 13:25:54 2007, CAPTTOFU wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The problem is the single quote in your statement in &#34;It&#39;s&#34;. 
&gt; 
&gt; The driver parses the statement, it sees the single quote in &#34;It&#39;s&#34;,
&gt; which it skips when parsing the statement - tring parse out the
&gt; place-holders &#40;the &#39;?&#39; char&#41;. I could fix this, but it would add more
&gt; statement parsing overhead for something that&#39;s taken 12 years to
&gt; stumble upon ;&#41;.
&gt; 
&gt; If you really must have a comment in your statement that includes a
&gt; single quote, have the server parse the statement, using server-side
&gt; prepare. You can do this by doing:
&gt; 
&gt; $dbh-&gt;{mysql_server_prepare} = 1;
&gt; query.... 
&gt; $dbh-&gt;{mysql_server_prepare} = 0;
&gt; 
&gt; or 
&gt; 
&gt; $dbh =
&gt; DBI-&gt;connect&#40;&#34;DBI:mysql:database=mydb;host=host;mysql_server_prepare=1&#34;...
&gt; 
&gt; Server side prepare is turned off in the driver by default because of
&gt; some issues with libmysql, but works just fine by turning it on.
&gt; 
&gt; 
</div>
BTW:

use strict;
use warnings;
use Data::Dumper;
use Getopt::Long;
use DBI;

our $opt_prepared;

GetOptions &#40;
    &#34;p|prepared&#34;  =&gt; \$opt_prepared
    &#41;;


my $dsn = &#34;DBI:mysql:database=test;host=localhost&#34;;
$dsn .= &#34;;mysql_server_prepare=1&#34; if $opt_prepared;

my $dbh = DBI-&gt;connect&#40; $dsn, &#39;foo&#39;, &#39;fee&#39;, { RaiseError =&gt; 1 } &#41;
or die $DBI::errstr;

unlink&#40;&#39;./bug3033.trace.log&#39;&#41;;
$dbh-&gt;trace&#40;4, &#39;./bug3033_trace.log&#39;&#41;;

$dbh-&gt;do&#40;&#39;DROP TABLE IF EXISTS buggy&#39;&#41;;
$dbh-&gt;do&#40;&#39;CREATE TABLE buggy &#40; id int&#40;3&#41; &#41;&#39;&#41;;
$dbh-&gt;do&#40;&#39;INSERT INTO buggy &#40;id&#41; VALUES &#40;1&#41;&#39;&#41;;
my $query= &#34;SELECT id FROM
-- It&#39;s a bug
buggy WHERE id = ?&#34;;
print &#34;with var:\n&#34;;
my $ref= $dbh-&gt;selectall_arrayref&#40;$query, {}, 1&#41;;
print Dumper $ref;
print &#34;with string terminator:\n&#34;;
$ref= $dbh-&gt;selectall_arrayref&#40;&lt;&lt;END, {}, 1&#41;;
SELECT id
FROM buggy
-- It&#39;s a bug!
WHERE id = 
 ?
END
print Dumper $ref;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-392525" href="/Public/Bug/Display.html?id=30033#txn-392525">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;11&nbsp;13:31:09&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-408349" href="/Public/Bug/Display.html?id=30033#txn-408349">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;13&nbsp;20:44:28&nbsp;2008</span>
    <span class="description">hiratara [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/408349/199153/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/199153">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 673b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I found that it happens when I use a following SQL, too. Is it same problem??
I am embarrassed due to this problem. 


#!/usr/bin/perl

use strict;
use warnings;

use DBI;

my $dsn = &#34;DBI:mysql:database=test;host=localhost&#34;;
my $dbh = DBI-&gt;connect&#40; $dsn, qw/test test/, { RaiseError =&gt; 1 } &#41;
or die $DBI::errstr;

$dbh-&gt;do&#40;&#39;DROP TABLE IF EXISTS buggy&#39;&#41;;
$dbh-&gt;do&#40;&#39;CREATE TABLE buggy &#40; id int&#40;3&#41; &#41;&#39;&#41;;
$dbh-&gt;do&#40;&#39;INSERT INTO buggy &#40;id&#41; VALUES &#40;1&#41;&#39;&#41;;
$dbh-&gt;selectrow_arrayref&#40;sprintf&#40;&lt;&lt;&#39;END&#39;, $dbh-&gt;quote&#40;q/It&#39;s a bug!/&#41;&#41;, {}, 1&#41;;
SELECT id
FROM buggy
WHERE id = %s or id = ?
END




In short, the created SQL is this:
SELECT id
FROM buggy
WHERE id = &#39;It\&#39;s a bug!&#39; or id = ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-408616" href="/Public/Bug/Display.html?id=30033#txn-408616">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;14&nbsp;15:19:11&nbsp;2008</span>
    <span class="description">curtis_ovid_poe [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30033] Quote marks in comments can break bind parameters </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 14 Jan 2008 20:17:54 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-mysql [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ovid &lt;curtis_ovid_poe [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/408616/199295/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/199295">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It does indeed look like it might be the same problem.  Now there are  
two ways of getting to it.  The author&#39;s not inclined to fix the  
problem, but if you file this in that bug report, it might be more  
incentive for him to do something about this.

In your case, you can probably get around this problem with a bind  
param, but it would be nice for the underlying problem to be fixed.

Cheers,
Ovid

On 14 Jan 2008, at 01:44, Masahiro Honma via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30033">http://rt.cpan.org/Ticket/Display.html?id=30033</a></span> &gt;
&gt;
&gt; I found that it happens when I use a following SQL, too. Is it same  
&gt; problem??
&gt; I am embarrassed due to this problem.
&gt;
&gt;
&gt; #!/usr/bin/perl
&gt;
&gt; use strict;
&gt; use warnings;
&gt;
&gt; use DBI;
&gt;
&gt; my $dsn = &#34;DBI:mysql:database=test;host=localhost&#34;;
&gt; my $dbh = DBI-&gt;connect&#40; $dsn, qw/test test/, { RaiseError =&gt; 1 } &#41;
&gt; or die $DBI::errstr;
&gt;
&gt; $dbh-&gt;do&#40;&#39;DROP TABLE IF EXISTS buggy&#39;&#41;;
&gt; $dbh-&gt;do&#40;&#39;CREATE TABLE buggy &#40; id int&#40;3&#41; &#41;&#39;&#41;;
&gt; $dbh-&gt;do&#40;&#39;INSERT INTO buggy &#40;id&#41; VALUES &#40;1&#41;&#39;&#41;;
&gt; $dbh-&gt;selectrow_arrayref&#40;sprintf&#40;&lt;&lt;&#39;END&#39;, $dbh-&gt;quote&#40;q/It&#39;s a  
&gt; bug!/&#41;&#41;, {}, 1&#41;;
&gt; SELECT id
&gt; FROM buggy
&gt; WHERE id = %s or id = ?
&gt; END
&gt;
&gt;
&gt;
&gt;
&gt; In short, the created SQL is this:
&gt; SELECT id
&gt; FROM buggy
&gt; WHERE id = &#39;It\&#39;s a bug!&#39; or id = ?
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-761279" href="/Public/Bug/Display.html?id=30033#txn-761279">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;10&nbsp;13:11:58&nbsp;2010</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/761279/393788/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/393788">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 78b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in latest SVN commit. Added logic for both -- and /* */ style
comments. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-761282" href="/Public/Bug/Display.html?id=30033#txn-761282">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;10&nbsp;13:11:59&nbsp;2010</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-763289" href="/Public/Bug/Display.html?id=30033#txn-763289">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;14&nbsp;15:36:19&nbsp;2010</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Broken in 4.013 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-763290" href="/Public/Bug/Display.html?id=30033#txn-763290">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;14&nbsp;15:36:20&nbsp;2010</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Broken in 3.0008 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-763291" href="/Public/Bug/Display.html?id=30033#txn-763291">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;14&nbsp;15:36:20&nbsp;2010</span>
    <span class="description">CAPTTOFU [...] cpan.org -  Broken in 4.005 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.523172</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
