<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76298 for Archive-Zip: Bug with perl module Archive::zip</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76298 for Archive-Zip: Bug with perl module Archive::zip</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Archive-Zip/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Archive-Zip/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Archive-Zip/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Archive-Zip/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Archive-Zip">Archive-Zip CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76298</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Archive-Zip/Active/">Archive-Zip</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Vikas.Agrawal [...] rbccm.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-2540-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-2541-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




ole0.bmp<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1069015/562152/ole0.bmp">
Wed Apr 18 10:58:44 2012 (647.8k) by Vikas.Agrawal [...] rbccm.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;04&nbsp;05:02:31&nbsp;2012</span>
    <span class="description">Vikas.Agrawal [...] rbccm.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug with perl module Archive::zip</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 4 Apr 2012 10:02:18 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Zip [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agrawal, Vikas&#34; &lt;Vikas.Agrawal [...] rbccm.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Archive::zip is unable to compress total number of 84715 files in to
single zip file. Resultant zip file is having only around about 19000
files.

Thanks &#38; Regards
Vikas Agrawal

Archive::zip version = 1.30
perl 5, version 12, subversion 3 &#40;v5.12.3&#41; built for
MSWin32-x86-multi-thread
osname=MSWin32, osvers=5.2, archname=MSWin32-x86-multi-thread
ActivePerl Build 1204 [294330]
Compiled at Feb  9 2011 14:38:22
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">_______________________________________________________________________

This email is intended only for the use of the individual&#40;s&#41; to whom
it is addressed and may be privileged and confidential.

Unauthorised use or disclosure is prohibited. If you receive this
e-mail in error, please advise immediately and delete the original
message without copying, using, or telling anyone about its contents.

This message may have been altered without your or our knowledge and
the sender does not accept any liability for any errors or omissions
in the message.

This message does not create or change any contract.  Royal Bank of
Canada and its subsidiaries accept no responsibility for damage caused
by any viruses contained in this email or its attachments.  Emails may
be monitored.

RBC Capital Markets is a business name used by branches and
subsidiaries of Royal Bank of Canada, including Royal Bank of Canada,
London branch and RBC Europe Limited. In accordance
with English law requirements, details regarding RBC Europe Limited
are set out below:

RBC EUROPE LIMITED
Registered in England and Wales 995939
Registered Address: Riverbank House, 2 Swan Lane, London, EC4R 3BF.
Authorised and regulated by the Financial Services Authority.
Member of the London Stock Exchange.
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;05&nbsp;07:28:58&nbsp;2012</span>
    <span class="description">Vikas.Agrawal [...] rbccm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #76298] AutoReply: Bug with perl module Archive::zip </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 5 Apr 2012 12:28:46 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Zip [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agrawal, Vikas&#34; &lt;Vikas.Agrawal [...] rbccm.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Seems member counter is able to handle just 2^16 elements and starts again after reaching the element hence try to compress 84715 files in to single zip file results in zip file with only 19179 &#40;84715-65536&#41; compressed files in it. 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Bugs in Archive-Zip via RT [mailto:bug-Archive-Zip@rt.cpan.org] 
Sent: 04 April 2012 10:03
To: Agrawal, Vikas
Subject: [rt.cpan.org #76298] AutoReply: Bug with perl module Archive::zip 


Greetings,

This message has been automatically generated in response to the creation of a trouble ticket regarding:
        &#34;Bug with perl module Archive::zip&#34;,
a summary of which appears below.

There is no need to reply to this message right now.  Your ticket has been assigned an ID of [rt.cpan.org #76298].  Your ticket is accessible on the web at:

    <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76298">https://rt.cpan.org/Ticket/Display.html?id=76298</a></span>

Please include the string:

         [rt.cpan.org #76298]

in the subject line of all future correspondence about this issue. To do so, you may reply to this message.

                        Thank you,
                        bug-Archive-Zip@rt.cpan.org

-------------------------------------------------------------------------
Hi,

Archive::zip is unable to compress total number of 84715 files in to single zip file. Resultant zip file is having only around about 19000 files.

Thanks &#38; Regards
Vikas Agrawal

Archive::zip version = 1.30
perl 5, version 12, subversion 3 &#40;v5.12.3&#41; built for MSWin32-x86-multi-thread osname=MSWin32, osvers=5.2, archname=MSWin32-x86-multi-thread ActivePerl Build 1204 [294330] Compiled at Feb  9 2011 14:38:22 _______________________________________________________________________



This email is intended only for the use of the individual&#40;s&#41; to whom

it is addressed and may be privileged and confidential.



Unauthorised use or disclosure is prohibited. If you receive this

e-mail in error, please advise immediately and delete the original

message without copying, using, or telling anyone about its contents.



This message may have been altered without your or our knowledge and

the sender does not accept any liability for any errors or omissions

in the message.



This message does not create or change any contract.  Royal Bank of

Canada and its subsidiaries accept no responsibility for damage caused

by any viruses contained in this email or its attachments.  Emails may

be monitored.



RBC Capital Markets is a business name used by branches and

subsidiaries of Royal Bank of Canada, including Royal Bank of Canada,

London branch and RBC Europe Limited. In accordance

with English law requirements, details regarding RBC Europe Limited

are set out below:



RBC EUROPE LIMITED

Registered in England and Wales 995939

Registered Address: Riverbank House, 2 Swan Lane, London, EC4R 3BF.

Authorised and regulated by the Financial Services Authority.

Member of the London Stock Exchange.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;05:10:33&nbsp;2012</span>
    <span class="description">Vikas.Agrawal [...] rbccm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #76298] AutoReply: Bug with perl module Archive::zip </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Apr 2012 10:10:15 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Zip [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agrawal, Vikas&#34; &lt;Vikas.Agrawal [...] rbccm.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Actually all 84715 files have been added into the zip created but name
of members are not visible when opened using winzip. Though member names
can be seen if Open zipped file using Winrar. It seems adding content is
fine but adding member names is going wrong somewhere and counter rolls
over when handling more than 2^16 names.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">_______________________________________________________________________

This email is intended only for the use of the individual&#40;s&#41; to whom
it is addressed and may be privileged and confidential.

Unauthorised use or disclosure is prohibited. If you receive this
e-mail in error, please advise immediately and delete the original
message without copying, using, or telling anyone about its contents.

This message may have been altered without your or our knowledge and
the sender does not accept any liability for any errors or omissions
in the message.

This message does not create or change any contract.  Royal Bank of
Canada and its subsidiaries accept no responsibility for damage caused
by any viruses contained in this email or its attachments.  Emails may
be monitored.

RBC Capital Markets is a business name used by branches and
subsidiaries of Royal Bank of Canada, including Royal Bank of Canada,
London branch and RBC Europe Limited. In accordance
with English law requirements, details regarding RBC Europe Limited
are set out below:

RBC EUROPE LIMITED
Registered in England and Wales 995939
Registered Address: Riverbank House, 2 Swan Lane, London, EC4R 3BF.
Authorised and regulated by the Financial Services Authority.
Member of the London Stock Exchange.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;10:43:53&nbsp;2012</span>
    <span class="description">nedkonz [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Apr 18 05:10:33 2012, Vikas.Agrawal@rbccm.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Actually all 84715 files have been added into the zip created but name
&gt; of members are not visible when opened using winzip. Though member names
&gt; can be seen if Open zipped file using Winrar. It seems adding content is
&gt; fine but adding member names is going wrong somewhere and counter rolls
&gt; over when handling more than 2^16 names.
</div>
There is no counter rollover in Archive::Zip, because there is no counter. And if there were, it 
would be much larger than 16 bits.

Most likely is a bug in WinZip. Especially since WinRAR is able to see all the members.

If you see all the member names when you use another program, or when using the 
command line tool &#34;unzip -v&#34; &#40;I have found these tools to be the best way to diagnose zip 
problems&#41;, then it is unlikely that Archive::Zip is at fault.

You should contact Corel and ask about this WinZip problem.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;10:43:54&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;10:43:55&nbsp;2012</span>
    <span class="description">nedkonz [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;10:48:20&nbsp;2012</span>
    <span class="description">Vikas.Agrawal [...] rbccm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #76298] Resolved: Bug with perl module Archive::zip </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Apr 2012 15:48:00 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Zip [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agrawal, Vikas&#34; &lt;Vikas.Agrawal [...] rbccm.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think it is not a problem with Winzip since I opened the created zip
file using Winrar and extracted contents in a directory and zipped again
directly using Winzip GUI tool. This new zip file does show all 84715
files. Clearly, there is some problem with Archive::Zip
storing/attaching member names to it&#39;s contents.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Ned Konz via RT [mailto:bug-Archive-Zip@rt.cpan.org] 
Sent: 18 April 2012 15:44
To: Agrawal, Vikas
Subject: [rt.cpan.org #76298] Resolved: Bug with perl module
Archive::zip 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76298">https://rt.cpan.org/Ticket/Display.html?id=76298</a></span> &gt;

According to our records, your request has been resolved. If you have
any further questions or concerns, please respond to this message.
<div class="message-stanza open">_______________________________________________________________________

This email is intended only for the use of the individual&#40;s&#41; to whom
it is addressed and may be privileged and confidential.

Unauthorised use or disclosure is prohibited. If you receive this
e-mail in error, please advise immediately and delete the original
message without copying, using, or telling anyone about its contents.

This message may have been altered without your or our knowledge and
the sender does not accept any liability for any errors or omissions
in the message.

This message does not create or change any contract.  Royal Bank of
Canada and its subsidiaries accept no responsibility for damage caused
by any viruses contained in this email or its attachments.  Emails may
be monitored.

RBC Capital Markets is a business name used by branches and
subsidiaries of Royal Bank of Canada, including Royal Bank of Canada,
London branch and RBC Europe Limited. In accordance
with English law requirements, details regarding RBC Europe Limited
are set out below:

RBC EUROPE LIMITED
Registered in England and Wales 995939
Registered Address: Riverbank House, 2 Swan Lane, London, EC4R 3BF.
Authorised and regulated by the Financial Services Authority.
Member of the London Stock Exchange.
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;10:48:21&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;10:58:44&nbsp;2012</span>
    <span class="description">Vikas.Agrawal [...] rbccm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #76298] Resolved: Bug with perl module Archive::zip </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 18 Apr 2012 15:58:20 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Zip [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agrawal, Vikas&#34; &lt;Vikas.Agrawal [...] rbccm.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I used unzip -v as suggested and that also reported only 19179 files but
with an error

H:\prod\FOG\messages\tradePublishingServer\to_gat&gt;&#34;c:\Program
Files\WinZip\WZUNZ
IP.EXE&#34; -v newarchive2010.zip

   7212  DeflatN   2034  72%  07/04/2010  13:05  290ac185
559206_PENDING_T
RANSACTION_COMMITTED_1_0_0_130542.xml
 note: didn&#39;t find end-of-central-dir signature at end of central dir.
Possible cause: file transfer error
 ------          ------  ---                                    -------
161184170          42636634  74%
19179



 &lt;&lt;Picture &#40;Device Independent Bitmap&#41;&gt;&gt; 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Ned Konz via RT [mailto:bug-Archive-Zip@rt.cpan.org]
Sent: 18 April 2012 15:44
To: Agrawal, Vikas
Subject: [rt.cpan.org #76298] Resolved: Bug with perl module
Archive::zip

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76298">https://rt.cpan.org/Ticket/Display.html?id=76298</a></span> &gt;

According to our records, your request has been resolved. If you have
any further questions or concerns, please respond to this message.


<div class="message-stanza open">_______________________________________________________________________

This email is intended only for the use of the individual&#40;s&#41; to whom
it is addressed and may be privileged and confidential.

Unauthorised use or disclosure is prohibited. If you receive this
e-mail in error, please advise immediately and delete the original
message without copying, using, or telling anyone about its contents.

This message may have been altered without your or our knowledge and
the sender does not accept any liability for any errors or omissions
in the message.

This message does not create or change any contract.  Royal Bank of
Canada and its subsidiaries accept no responsibility for damage caused
by any viruses contained in this email or its attachments.  Emails may
be monitored.

RBC Capital Markets is a business name used by branches and
subsidiaries of Royal Bank of Canada, including Royal Bank of Canada,
London branch and RBC Europe Limited. In accordance
with English law requirements, details regarding RBC Europe Limited
are set out below:

RBC EUROPE LIMITED
Registered in England and Wales 995939
Registered Address: Riverbank House, 2 Swan Lane, London, EC4R 3BF.
Authorised and regulated by the Financial Services Authority.
Member of the London Stock Exchange.
</div></div></div></div>

<div class="messagebody">
</div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1069015/562152/ole0.bmp">Download ole0.bmp</a><br />
<span class="downloadcontenttype">image/bmp 647.8k</span>
</div>
<div class="messagebody">
<img alt="ole0.bmp" title="ole0.bmp" src="/Ticket/Attachment/1069015/562152/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;23&nbsp;19:14:50&nbsp;2012</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">What size is newarchive2010.zip ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;24&nbsp;04:05:53&nbsp;2012</span>
    <span class="description">Vikas.Agrawal [...] rbccm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &lt;SMPETERS [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #76298] Bug with perl module Archive::zip </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 24 Apr 2012 09:05:30 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Zip [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agrawal, Vikas&#34; &lt;Vikas.Agrawal [...] rbccm.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">218, 352, 932 Bytes 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Paul Marquess via RT [mailto:bug-Archive-Zip@rt.cpan.org] 
Sent: 24 April 2012 00:15
To: Agrawal, Vikas
Cc: SMPETERS@cpan.org
Subject: [rt.cpan.org #76298] Bug with perl module Archive::zip 

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76298">https://rt.cpan.org/Ticket/Display.html?id=76298</a></span> &gt;

What size is newarchive2010.zip ?

<div class="message-stanza open">_______________________________________________________________________

This email is intended only for the use of the individual&#40;s&#41; to whom
it is addressed and may be privileged and confidential.

Unauthorised use or disclosure is prohibited. If you receive this
e-mail in error, please advise immediately and delete the original
message without copying, using, or telling anyone about its contents.

This message may have been altered without your or our knowledge and
the sender does not accept any liability for any errors or omissions
in the message.

This message does not create or change any contract.  Royal Bank of
Canada and its subsidiaries accept no responsibility for damage caused
by any viruses contained in this email or its attachments.  Emails may
be monitored.

RBC Capital Markets is a business name used by branches and
subsidiaries of Royal Bank of Canada, including Royal Bank of Canada,
London branch and RBC Europe Limited. In accordance
with English law requirements, details regarding RBC Europe Limited
are set out below:

RBC EUROPE LIMITED
Registered in England and Wales 995939
Registered Address: Riverbank House, 2 Swan Lane, London, EC4R 3BF.
Authorised and regulated by the Financial Services Authority.
Member of the London Stock Exchange.
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;24&nbsp;11:19:52&nbsp;2012</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If your archive is only 218352932 bytes long, it isn&#39;t blowing the 32-
bit limit because of the overall size of the archive.

Your problem then is down to a 16-bit counter stored in the end-of-
central-directory record at the very end of the zip file. The field in 
question stores the number of members in the zip file. A Zip file with 
84715 entries is larger than the max 16-bit value, so A::Zip stores 
19179 in this field.

To prove that I created a zip file with 84715 members using the code at 
the end of this message. Below is a dump of the End-of-central-directory 
record. Note the size reported for the number of entries in the zip file 
is 19179.


End-of-central-directory record:
-------------------------------

  Zip archive file size:                   8449310 &#40;000000000080ED1Eh&#41;
  Actual end-cent-dir record offset:       8449288 &#40;000000000080ED08h&#41;
  Expected end-cent-dir record offset:     8449288 &#40;000000000080ED08h&#41;
  &#40;based on the length of the central directory and its expected offset&#41;

  This zipfile constitutes the sole disk of a single-part archive; its
  central directory contains 19179 entries.
  The central directory is 4309359 &#40;000000000041C16Fh&#41; bytes long,
  and its &#40;expected&#41; offset in bytes from the beginning of the zipfile
  is 4139929 &#40;00000000003F2B99h&#41;.


No trouble with accessing the zip file with Info-Zip, but the version of 
WinZip I have does indeed have a problem. It thinks there are only 19179 
members. Looks like WinZip assumes the field in the central directory 
record is accurate.

There is an extension to the zip specification, called Zip64, that 
increases the size of that counter to a 32-bit value. It also allows 
much larger archives, but that isn&#39;t relevant to this discussion. I 
don&#39;t think A::Zip supports Zip64 yet. If you can&#39;t work around the 
number of elemnts in the zip file, Info-Zip supports Zip64 as does 
IO::Compress::Zip 

The next problem you will be faced with is whether the program you want 
to use to uncompress your zip file supports Zip64. Not all do. The 
version of WinZip I have doesn&#39;t, but I believe more recent versions do 
support it. Newer version of Info-Zip do support it.



use Archive::Zip qw&#40; :ERROR_CODES :CONSTANTS &#41;;
my $zip = Archive::Zip-&gt;new&#40;&#41;;


for my $i &#40;1 .. 84715&#41;
{
    my $string_member = $zip-&gt;addString&#40; &#39;This is a test&#39;, $i &#41;;
    $string_member-&gt;desiredCompressionMethod&#40; COMPRESSION_DEFLATED &#41;;
}
   
# Save the Zip file
unless &#40; $zip-&gt;writeToFileNamed&#40;&#39;someZip.zip&#39;&#41; == AZ_OK &#41; {
   die &#39;write error&#39;;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other SystemError odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;24&nbsp;11:19:52&nbsp;2012</span>
    <span class="description">The RT System itself -  System error</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sending the previous mail has failed.  Please contact your admin, they can find more details in the logs.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other SystemError even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;24&nbsp;11:19:53&nbsp;2012</span>
    <span class="description">The RT System itself -  System error</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sending the previous mail has failed.  Please contact your admin, they can find more details in the logs.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;25&nbsp;11:50:42&nbsp;2012</span>
    <span class="description">Vikas.Agrawal [...] rbccm.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> &#34;Paul Marquess&#34; &lt;Paul.Marquess [...] btinternet.com&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #76298] AutoReply: Bug with perl module Archive::zip </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 25 Apr 2012 16:49:39 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Archive-Zip [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Agrawal, Vikas&#34; &lt;Vikas.Agrawal [...] rbccm.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for your so detailed explanation Paul.
 
I was trying to convey this problem to Archive::zip perl module
moderator. Sending your message to cpan.org so that it becomes clear to
moderator that problem is in Archive::zip since my WinZip &#40;9.0 SR-1
6224&#41; can create/read 32bit end-of-central-directory record?
 
Also, is there any work around to fix end-of-central-directory record
for now until Archive::Zip fix is available?
 
Regards
Vikas
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________

From: Paul Marquess [mailto:Paul.Marquess@btinternet.com] 
Sent: 25 April 2012 16:38
To: Agrawal, Vikas
Subject: RE: #76298: Bug with perl module Archive::zip



Hi Vikas,

 

See inline.

 

Paul

 

From: Agrawal, Vikas [mailto:Vikas.Agrawal@rbccm.com] 
Sent: 25 April 2012 15:25
To: Paul Marquess
Subject: RE: #76298: Bug with perl module Archive::zip

 

Thanks Paul. I had not received your e-mail but have seen it online now.
Why A::zip storing it wrong &#40;only 16bit&#41; for end-of-central-directory
record? 

 

[Paul] The specification for zip files has been around for a long time.
There are a huge number of programs that can create zip files. Some
conform strictly to the specification, some do not. It looks like Winzip
is strict in its implementation. The Linux unzip program recognises the
variability of zip implementations and ignores the 16-bit file counter
field. I assume Archive::Zip have just forgotten about the issue where
the 16-bit counter can overflow.

 

If I zip all these 84715 files manually using WinZip then
end-of-central-directory record does not have any 16bit problem.

 

[Paul] That depends on whether the version of WinZIp you have supports
the ZIP64 extensions. The table below is from
<span class="clickylink"><a target="new" rel="nofollow" href="http://kb.winzip.com/kb/entry/294/">http://kb.winzip.com/kb/entry/294/</a></span> - it looks like all versions since
9.0 support ZIP64.  If you have a newish version you should be ok.

 

The only issue is what you intend to do with the zip file you create -
obviously it will only be usable by something that can read zip files
with ZIP64 enabled.

 

Additional Features

WinZip Versions

16.5

16.0

15.5

15.0

14.5

14.0

12.1

12.0

11.2

11.0

10.0

9.0

8.1

FTP upload**

*

*

*

*

*

*

*

*

*

*

                        
Burn to
CD/DVD**

*

*

*

*

*

*

*

*

*

*

                        
Photo
Thumbnails

*

*

*

*

*

*

*

*

*

*

                        
Alternate
extension

*

*

*

*

*

*

*

*

*

*

                        
Extended
time stamps

*

*

*

*

*

*

*

*

*

*

                        
Image viewer
&#40;internal&#41;**

*

*

*

*

*

*

*

*

*

*

                        
WinZip Pro

*

*

*

*

*

*

*

*

*

*

*

                
New Zip
on CD/DVD**

*

*

*

*

*

*

*

*

*

*

*

                
Select files

*

*

*

*

*

*

*

*

*

*

*

                
WinZip Jobs**

*

*

*

*

*

*

*

*

*

*

*

                
Create split
Zip files

*

*

*

*

*

*

*

*

*

*

*

                
Folder view

*

*

*

*

*

*

*

*

*

*

*

                
Check for
Updates

*

*

*

*

*

*

*

*

*

*

*

                
64-bit
context menu

*

*

*

*

*

*

*

*

*

*

*

                
Zip64 large
file support

*

*

*

*

*

*

*

*

*

*

*

*

        
WinZip
Quick Pick

*

*

*

*

*

*

*

*

*

*

*

*

*

Split Zip files
&#40;existing&#41;

*

*

*

*

*

*

*

*

*

*

*

*

*

HTML Help
files

                                *

*

*

*

*

*

*

*

*

WinZip Wizard

                                *

*

*

*

*

*

*

*

*

External ARJ,
ARC, LHA

        
*

*

*

*

Virus scanner
configuration

        
*

*

*

Note: For Wi

 

 

Regards

Vikas

<div class="message-stanza open">________________________________

From: Paul Marquess [mailto:Paul.Marquess@btinternet.com] 
Sent: 25 April 2012 15:16
To: Agrawal, Vikas
Subject: #76298: Bug with perl module Archive::zip

Hi

 

I posted a reply yesterday to your response about the size of your zip
file &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76298&#41;">https://rt.cpan.org/Ticket/Display.html?id=76298&#41;</a></span>, but you may not
have received notification. The administrator tells me that the system
was under heavy load and a lot of email notifications didn&#39;t get out.

 

Anyway - take a look at my response if you haven&#39;t already.

 

Email me or continue the dialog on RT if you want to discuss options for
working around it.

 

Paul

<div class="message-stanza open">_______________________________________________________________________

This email is intended only for the use of the individual&#40;s&#41; to whom
it is addressed and may be privileged and confidential.

Unauthorised use or disclosure is prohibited. If you receive this
e-mail in error, please advise immediately and delete the original
message without copying, using, or telling anyone about its contents.

This message may have been altered without your or our knowledge and
the sender does not accept any liability for any errors or omissions
in the message.

This message does not create or change any contract.  Royal Bank of
Canada and its subsidiaries accept no responsibility for damage caused
by any viruses contained in this email or its attachments.  Emails may
be monitored.

RBC Capital Markets is a business name used by branches and
subsidiaries of Royal Bank of Canada, including Royal Bank of Canada,
London branch and RBC Europe Limited. In accordance
with English law requirements, details regarding RBC Europe Limited
are set out below:

RBC EUROPE LIMITED
Registered in England and Wales 995939
Registered Address: Riverbank House, 2 Swan Lane, London, EC4R 3BF.
Authorised and regulated by the Financial Services Authority.
Member of the London Stock Exchange.
</div></div></div></div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
