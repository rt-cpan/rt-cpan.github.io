<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #122977 for Parse-Yapp: Sort hash keys for deterministic output - Parse-Yapp-1.21</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #122977 for Parse-Yapp: Sort hash keys for deterministic output - Parse-Yapp-1.21</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Parse-Yapp/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Parse-Yapp/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Parse-Yapp/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Parse-Yapp/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Parse-Yapp">Parse-Yapp CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">122977</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Parse-Yapp/Active/">Parse-Yapp</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
tmp11590 [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24838-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24839-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;06&nbsp;20:11:41&nbsp;2017</span>
    <span class="description">tmp11590 [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Sort hash keys for deterministic output - Parse-Yapp-1.21</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 6 Sep 2017 17:11:25 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Parse-Yapp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tom Pollard &lt;tmp11590 [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I noticed the output of yapp is not deterministic because hash keys are not
sorted. This makes it difficult &#40;and in most cases impossible&#41; to compare
the output of yapp after making minor changes to the input file. This issue
is easily fixed by adding &#34;sort&#40;&#41;&#34; around all calls to &#34;keys&#40;&#41;&#34; that affect
yapp&#39;s output. I&#39;ve made this change to my local install of Parse::Yapp and
haven&#39;t noticed any significant slowdown due to the sorting.

Thanks,
Tom
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;07&nbsp;11:00:58&nbsp;2017</span>
    <span class="description">FDESAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Which output ?
Why not sorting hash keys would make generated parser not deterministic ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;07&nbsp;11:00:58&nbsp;2017</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;07&nbsp;12:43:08&nbsp;2017</span>
    <span class="description">tmp11590 [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #122977] Sort hash keys for deterministic output - Parse-Yapp-1.21</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 7 Sep 2017 09:42:45 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Parse-Yapp [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tom Pollard &lt;tmp11590 [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt; Which output ?
</div></div>The output .pm file

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;&gt; Why not sorting hash keys would make generated parser not deterministic
</div></div>?
Starting with Perl 5.18 &#40;I think&#41;, hash key ordering is completely random.



You can try this to reproduce the issue that I see. I&#39;m using the file
XSP.yp from this release of ExtUtils-XSpp as a test.
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/ExtUtils-XSpp-0.18.tar.gz">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/ExtUtils-XSpp-0.18.tar.gz</a></span>

Again, Perl &gt;= 5.18 is required to reproduce the error:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl -v
</div>This is perl 5, version 24, subversion 2 &#40;v5.24.2&#41; built for x86_64-linux
...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; yapp -V
</div>This is Parse::Yapp version 1.2.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; yapp -o first.pm XSP.yp
&gt; yapp -o second.pm XSP.yp
&gt; diff first.pm second.pm | wc -l
</div>3245

Now, if I add sort&#40;&#41; around these instances of keys&#40;&#41; in these 3 files, and
run the experiment again:
Parse/Yapp/Driver.pm:162:    return
sort&#40;keys&#40;%{$self-&gt;{STATES}[$self-&gt;{STACK}[-1][0]]{ACTIONS}}&#41;&#41;;
Parse/Yapp/Grammar.pm:343:    for my $sym &#40;sort&#40;keys&#40;%$term&#41;&#41;&#41; {
Parse/Yapp/Grammar.pm:355:    for my $sym &#40;sort&#40;keys&#40;%$nterm&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:135:        for
&#40;sort&#40;keys&#40;%{$$states[$stateno]{ACTIONS}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:223:                for
&#40;sort&#40;keys&#40;%{$$states[$stateno]{GOTOS}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:339:                                } grep { $_ }
sort&#40;keys&#40;%{$$state{ACTIONS}}&#41;&#41;&#41;;
Parse/Yapp/Lalr.pm:362:                                }
sort&#40;keys&#40;%{$$state{GOTOS}}&#41;&#41;&#41;;
Parse/Yapp/Lalr.pm:415:            for $y &#40;sort&#40;keys&#40;%{$$rel{$x}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:438:    for &#40;sort&#40;keys&#40;%$rel&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:462:    for my $symbol &#40;sort&#40;keys&#40;%{$$grammar{NTERM}}&#41;&#41;&#41;
{
Parse/Yapp/Lalr.pm:514:    for &#40;sort&#40;keys&#40;%transitions&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:576:    for my $symbol &#40;sort&#40;keys&#40;%{$$grammar{NTERM}}&#41;&#41;&#41;
{
Parse/Yapp/Lalr.pm:624:    [ sort&#40; keys&#40; %{ +{ map { &#40;$_,1&#41; } @$preds } } &#41;
&#41; ];
Parse/Yapp/Lalr.pm:697:        for my $symbol
&#40;sort&#40;keys&#40;%{$$state{GOTOS}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:734: my&#40;$termlst&#41;= [ &#39;&#39;,sort&#40;keys&#40;%{$$grammar{TERM}}&#41;&#41; ];
Parse/Yapp/Lalr.pm:738:    for my $stateno &#40; sort&#40;keys&#40;%$inconsistent&#41;&#41; &#41; {
Parse/Yapp/Lalr.pm:797:    for my $stateno &#40;sort&#40;keys&#40;%$inconsistent&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:802:        for my $term &#40; sort&#40;keys&#40;%$actions&#41;&#41; &#41; {
Parse/Yapp/Lalr.pm:902:        for my $term &#40;sort&#40;keys&#40;%$actions&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:920:                   sort&#40;keys&#40;%reduces&#41;&#41;&#41;[0];

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; yapp -o first.pm XSP.yp
&gt; yapp -o second.pm XSP.yp
&gt; diff first.pm second.pm | wc -l
</div>0

I don&#39;t know if all the sort&#40;&#41;&#39;s are necessary, but adding all of them was
the quickest/easiest way for me to get deterministic output.


On Thu, Sep 7, 2017 at 8:00 AM, Francois Desarmenien via RT &lt;
bug-Parse-Yapp@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=122977">https://rt.cpan.org/Ticket/Display.html?id=122977</a></span> &gt;
&gt;
&gt; Which output ?
&gt; Why not sorting hash keys would make generated parser not deterministic ?
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;07&nbsp;13:58:14&nbsp;2017</span>
    <span class="description">FDESAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry, but your message is unreadable, so I cannot get your example &#40;files content mixup with text with no &#39;\n&#39;&#41;.
But the order in which the keys of a hash array are stored internally is irrelevant, so is the order in which appear key/value pairs while feeding an hash array...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;07&nbsp;14:52:21&nbsp;2017</span>
    <span class="description">tmp11590 [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tmp11590 [...] gmail.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Let me try reformatting my original response.

--- Which output ?
The output .pm file

--- Why not sorting hash keys would make generated parser not deterministic ?
Starting with Perl 5.18 &#40;I think&#41;, hash key ordering is completely random.

You can try this to reproduce the issue that I see. I&#39;m using the file XSP.yp from this release of ExtUtils-XSpp as a test. You can download the whole package from here and extract XSP.yp, or I also attached the file to this reply.
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/ExtUtils-XSpp-0.18.tar.gz">http://search.cpan.org/CPAN/authors/id/S/SM/SMUELLER/ExtUtils-XSpp-0.18.tar.gz</a></span>

Again, Perl &gt;= 5.18 is required to reproduce the error:
:&gt; perl -v
This is perl 5, version 24, subversion 2 &#40;v5.24.2&#41; built for x86_64-linux
...
:&gt; yapp -V
This is Parse::Yapp version 1.2.
:&gt; yapp -o first.pm XSP.yp
:&gt; yapp -o second.pm XSP.yp
:&gt; diff first.pm second.pm | wc -l
3245

Now, if I add sort&#40;&#41; around these instances of keys&#40;&#41; in these 3 files, and run the experiment again:
Parse/Yapp/Driver.pm:162:    return sort&#40;keys&#40;%{$self-&gt;{STATES}[$self-&gt;{STACK}[-1][0]]{ACTIONS}}&#41;&#41;;
Parse/Yapp/Grammar.pm:343:    for my $sym &#40;sort&#40;keys&#40;%$term&#41;&#41;&#41; {
Parse/Yapp/Grammar.pm:355:    for my $sym &#40;sort&#40;keys&#40;%$nterm&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:135:        for &#40;sort&#40;keys&#40;%{$$states[$stateno]{ACTIONS}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:223:                for &#40;sort&#40;keys&#40;%{$$states[$stateno]{GOTOS}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:339:                                } grep { $_ } sort&#40;keys&#40;%{$$state{ACTIONS}}&#41;&#41;&#41;;
Parse/Yapp/Lalr.pm:362:                                } sort&#40;keys&#40;%{$$state{GOTOS}}&#41;&#41;&#41;;
Parse/Yapp/Lalr.pm:415:            for $y &#40;sort&#40;keys&#40;%{$$rel{$x}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:438:    for &#40;sort&#40;keys&#40;%$rel&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:462:    for my $symbol &#40;sort&#40;keys&#40;%{$$grammar{NTERM}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:514:    for &#40;sort&#40;keys&#40;%transitions&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:576:    for my $symbol &#40;sort&#40;keys&#40;%{$$grammar{NTERM}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:624:    [ sort&#40; keys&#40; %{ +{ map { &#40;$_,1&#41; } @$preds } } &#41; &#41; ];
Parse/Yapp/Lalr.pm:697:        for my $symbol &#40;sort&#40;keys&#40;%{$$state{GOTOS}}&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:734: my&#40;$termlst&#41;= [ &#39;&#39;,sort&#40;keys&#40;%{$$grammar{TERM}}&#41;&#41; ];
Parse/Yapp/Lalr.pm:738:    for my $stateno &#40; sort&#40;keys&#40;%$inconsistent&#41;&#41; &#41; {
Parse/Yapp/Lalr.pm:797:    for my $stateno &#40;sort&#40;keys&#40;%$inconsistent&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:802:        for my $term &#40; sort&#40;keys&#40;%$actions&#41;&#41; &#41; {
Parse/Yapp/Lalr.pm:902:        for my $term &#40;sort&#40;keys&#40;%$actions&#41;&#41;&#41; {
Parse/Yapp/Lalr.pm:920:                   sort&#40;keys&#40;%reduces&#41;&#41;&#41;[0];

:&gt; yapp -o first.pm XSP.yp
:&gt; yapp -o second.pm XSP.yp
:&gt; diff first.pm second.pm | wc -l
0

I don&#39;t know if all the sort&#40;&#41;&#39;s are necessary, but adding all of them was the quickest/easiest way for me to get deterministic output.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> XSP.yp</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;07&nbsp;18:28:09&nbsp;2017</span>
    <span class="description">FDESAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The sorting you added is useless : the generated source files are maybe slightly different but their compiled form will run exactly the same way.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;31&nbsp;11:30:11&nbsp;2018</span>
    <span class="description">GUIDO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Do 07. Sep 2017, 18:28:09, FDESAR schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The sorting you added is useless : the generated source files are
&gt; maybe slightly different but their compiled form will run exactly the
&gt; same way.
</div>
And that is exactly what Tom initially wrote.

Yapp&#39;s output slightly differs, whenever you recompile the grammar, even when the grammar has not changed.  The generated code always behaves the same but that is not the problem.

The problem is:

Humans want to make diffs.  And the diffs should show relevant changes and not variations that have no impact on the behavior of the software.

Likewise, authors may decide to put the output of yapp under version control although it is generated.  But that causes headaches because your local repository gets dirty whenever you re-compile your .y file&#40;s&#41;.

Yacc and Bison always create exactly the same output if the grammar is unchanged, and that avoids this sort of problems.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;31&nbsp;11:53:41&nbsp;2018</span>
    <span class="description">GUIDO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I forgot the most important argument:

The .output file is also non-deterministic.  Rule and state numbers change in arbitrary ways, whenever you recompile the grammar.  Even after tiny changes to the grammar, you always have to start debugging from scratch because you know that state 275 that you have just fixed is almost certainly no longer state 275 after the next try.

When you developed yapp, Perl&#39;s behavior was different and you probably never experienced that problem.  But since Perl 5.18, it has become a little bit of a nuisance.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;19&nbsp;05:35:49&nbsp;2018</span>
    <span class="description">MERKYS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Sep 07 18:28:09 2017, FDESAR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The sorting you added is useless : the generated source files are
&gt; maybe slightly different but their compiled form will run exactly the
&gt; same way.
</div>
Parse::Yapp is used in parser generation in a bunch of packages for Debian OS. Debian requires each package be able to build reproducibly bit-by-bit, therefore, deterministic output of Parse::Yapp is essential. For this reason I have made a patch resolving the issue, please find it attached. In addition, please find a test case &#40;in a form of a patch&#41; ensuring bit-by-bit reproducibility of Parse::Yapp-generated parser &#40;depends on Text::Diff&#41;.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> reproducibility.t.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- /dev/null
+++ b/t/reproducibility.t
@@ -0,0 +1,412 @@
+#!/usr/bin/perl
+
+use strict;
+use warnings;
+use Parse::Yapp;
+use Text::Diff;
+
+BEGIN { $| = 1; print &#34;1..1\n&#34;; }
+
+open&#40; my $inp, &#39;Calc.yp&#39; &#41;;
+my $grammar = join &#39;&#39;, &lt;$inp&gt;;
+close $inp;
+
+my $parser = new Parse::Yapp&#40; input =&gt; $grammar &#41;;
+
+my $output_new = $parser-&gt;Output&#40; classname =&gt; &#39;Calc&#39; &#41;;
+$output_new =~ s/&#40;Parse::Yapp version &#41;\d+\.\d+/$1&lt;version&gt;/;
+$output_new =~ s/&#40;yyversion =&gt; &#39;&#41;[^&#39;]+&#39;/$1&lt;version&gt;&#39;/;
+
+my $output_old = join &#39;&#39;, &lt;DATA&gt;;
+close DATA;
+
+my $diff = diff \$output_old, \$output_new;
+if&#40; $diff &#41; {
+    print &#34;not ok 1\n&#34;;
+    print &#34;Non-zero diff:\n&#34; . $diff;
+    exit&#40;1&#41;;
+} else {
+    print &#34;ok 1\n&#34;;
+}
+
+__DATA__
+####################################################################
+#
+#    This file was generated using Parse::Yapp version &lt;version&gt;.
+#
+#        Don&#39;t edit this file, use source file instead.
+#
+#             ANY CHANGE MADE HERE WILL BE LOST !
+#
+####################################################################
+package Calc;
+use vars qw &#40; @ISA &#41;;
+use strict;
+
+@ISA= qw &#40; Parse::Yapp::Driver &#41;;
+use Parse::Yapp::Driver;
+
+
+
+sub new {
+        my&#40;$class&#41;=shift;
+        ref&#40;$class&#41;
+    and $class=ref&#40;$class&#41;;
+
+    my&#40;$self&#41;=$class-&gt;SUPER::new&#40; yyversion =&gt; &#39;&lt;version&gt;&#39;,
+                                  yystates =&gt;
+[
+	{#State 0
+		DEFAULT =&gt; -1,
+		GOTOS =&gt; {
+			&#39;input&#39; =&gt; 1
+		}
+	},
+	{#State 1
+		ACTIONS =&gt; {
+			&#39;&#39; =&gt; 2,
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#34;\n&#34; =&gt; 5,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7,
+			&#39;error&#39; =&gt; 8
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 9,
+			&#39;line&#39; =&gt; 10
+		}
+	},
+	{#State 2
+		DEFAULT =&gt; 0
+	},
+	{#State 3
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 11
+		}
+	},
+	{#State 4
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 12
+		}
+	},
+	{#State 5
+		DEFAULT =&gt; -3
+	},
+	{#State 6
+		DEFAULT =&gt; -6
+	},
+	{#State 7
+		ACTIONS =&gt; {
+			&#34;=&#34; =&gt; 13
+		},
+		DEFAULT =&gt; -7
+	},
+	{#State 8
+		ACTIONS =&gt; {
+			&#34;\n&#34; =&gt; 14
+		}
+	},
+	{#State 9
+		ACTIONS =&gt; {
+			&#34;*&#34; =&gt; 15,
+			&#34;+&#34; =&gt; 16,
+			&#34;-&#34; =&gt; 17,
+			&#34;/&#34; =&gt; 18,
+			&#34;\n&#34; =&gt; 19,
+			&#34;^&#34; =&gt; 20
+		}
+	},
+	{#State 10
+		DEFAULT =&gt; -2
+	},
+	{#State 11
+		ACTIONS =&gt; {
+			&#34;&#41;&#34; =&gt; 21,
+			&#34;*&#34; =&gt; 15,
+			&#34;+&#34; =&gt; 16,
+			&#34;-&#34; =&gt; 17,
+			&#34;/&#34; =&gt; 18,
+			&#34;^&#34; =&gt; 20
+		}
+	},
+	{#State 12
+		ACTIONS =&gt; {
+			&#34;^&#34; =&gt; 20
+		},
+		DEFAULT =&gt; -13
+	},
+	{#State 13
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 22
+		}
+	},
+	{#State 14
+		DEFAULT =&gt; -5
+	},
+	{#State 15
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 23
+		}
+	},
+	{#State 16
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 24
+		}
+	},
+	{#State 17
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 25
+		}
+	},
+	{#State 18
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 26
+		}
+	},
+	{#State 19
+		DEFAULT =&gt; -4
+	},
+	{#State 20
+		ACTIONS =&gt; {
+			&#34;&#40;&#34; =&gt; 3,
+			&#34;-&#34; =&gt; 4,
+			&#39;NUM&#39; =&gt; 6,
+			&#39;VAR&#39; =&gt; 7
+		},
+		GOTOS =&gt; {
+			&#39;exp&#39; =&gt; 27
+		}
+	},
+	{#State 21
+		DEFAULT =&gt; -15
+	},
+	{#State 22
+		ACTIONS =&gt; {
+			&#34;*&#34; =&gt; 15,
+			&#34;+&#34; =&gt; 16,
+			&#34;-&#34; =&gt; 17,
+			&#34;/&#34; =&gt; 18,
+			&#34;^&#34; =&gt; 20
+		},
+		DEFAULT =&gt; -8
+	},
+	{#State 23
+		ACTIONS =&gt; {
+			&#34;^&#34; =&gt; 20
+		},
+		DEFAULT =&gt; -11
+	},
+	{#State 24
+		ACTIONS =&gt; {
+			&#34;*&#34; =&gt; 15,
+			&#34;/&#34; =&gt; 18,
+			&#34;^&#34; =&gt; 20
+		},
+		DEFAULT =&gt; -9
+	},
+	{#State 25
+		ACTIONS =&gt; {
+			&#34;*&#34; =&gt; 15,
+			&#34;/&#34; =&gt; 18,
+			&#34;^&#34; =&gt; 20
+		},
+		DEFAULT =&gt; -10
+	},
+	{#State 26
+		ACTIONS =&gt; {
+			&#34;^&#34; =&gt; 20
+		},
+		DEFAULT =&gt; -12
+	},
+	{#State 27
+		ACTIONS =&gt; {
+			&#34;^&#34; =&gt; 20
+		},
+		DEFAULT =&gt; -14
+	}
+],
+                                  yyrules  =&gt;
+[
+	[#Rule 0
+		 &#39;$start&#39;, 2, undef
+	],
+	[#Rule 1
+		 &#39;input&#39;, 0, undef
+	],
+	[#Rule 2
+		 &#39;input&#39;, 2,
+sub
+#line 17 &#34;unkown&#34;
+{ push&#40;@{$_[1]},$_[2]&#41;; $_[1] }
+	],
+	[#Rule 3
+		 &#39;line&#39;, 1,
+sub
+#line 20 &#34;unkown&#34;
+{ $_[1] }
+	],
+	[#Rule 4
+		 &#39;line&#39;, 2,
+sub
+#line 21 &#34;unkown&#34;
+{ print &#34;$_[1]\n&#34; }
+	],
+	[#Rule 5
+		 &#39;line&#39;, 2,
+sub
+#line 22 &#34;unkown&#34;
+{ $_[0]-&gt;YYErrok }
+	],
+	[#Rule 6
+		 &#39;exp&#39;, 1, undef
+	],
+	[#Rule 7
+		 &#39;exp&#39;, 1,
+sub
+#line 26 &#34;unkown&#34;
+{ $_[0]-&gt;YYData-&gt;{VARS}{$_[1]} }
+	],
+	[#Rule 8
+		 &#39;exp&#39;, 3,
+sub
+#line 27 &#34;unkown&#34;
+{ $_[0]-&gt;YYData-&gt;{VARS}{$_[1]}=$_[3] }
+	],
+	[#Rule 9
+		 &#39;exp&#39;, 3,
+sub
+#line 28 &#34;unkown&#34;
+{ $_[1] + $_[3] }
+	],
+	[#Rule 10
+		 &#39;exp&#39;, 3,
+sub
+#line 29 &#34;unkown&#34;
+{ $_[1] - $_[3] }
+	],
+	[#Rule 11
+		 &#39;exp&#39;, 3,
+sub
+#line 30 &#34;unkown&#34;
+{ $_[1] * $_[3] }
+	],
+	[#Rule 12
+		 &#39;exp&#39;, 3,
+sub
+#line 31 &#34;unkown&#34;
+{
+                                      $_[3]
+                                  and return&#40;$_[1] / $_[3]&#41;;
+                                  $_[0]-&gt;YYData-&gt;{ERRMSG}
+                                    =   &#34;Illegal division by zero.\n&#34;;
+                                  $_[0]-&gt;YYError;
+                                  undef
+                                }
+	],
+	[#Rule 13
+		 &#39;exp&#39;, 2,
+sub
+#line 39 &#34;unkown&#34;
+{ -$_[2] }
+	],
+	[#Rule 14
+		 &#39;exp&#39;, 3,
+sub
+#line 40 &#34;unkown&#34;
+{ $_[1] ** $_[3] }
+	],
+	[#Rule 15
+		 &#39;exp&#39;, 3,
+sub
+#line 41 &#34;unkown&#34;
+{ $_[2] }
+	]
+],
+                                  @_&#41;;
+    bless&#40;$self,$class&#41;;
+}
+
+#line 44 &#34;unkown&#34;
+
+
+sub _Error {
+        exists $_[0]-&gt;YYData-&gt;{ERRMSG}
+    and do {
+        print $_[0]-&gt;YYData-&gt;{ERRMSG};
+        delete $_[0]-&gt;YYData-&gt;{ERRMSG};
+        return;
+    };
+    print &#34;Syntax error.\n&#34;;
+}
+
+sub _Lexer {
+    my&#40;$parser&#41;=shift;
+
+        $parser-&gt;YYData-&gt;{INPUT}
+    or  $parser-&gt;YYData-&gt;{INPUT} = &lt;STDIN&gt;
+    or  return&#40;&#39;&#39;,undef&#41;;
+
+    $parser-&gt;YYData-&gt;{INPUT}=~s/^[ \t]//;
+
+    for &#40;$parser-&gt;YYData-&gt;{INPUT}&#41; {
+        s/^&#40;[0-9]+&#40;?:\.[0-9]+&#41;?&#41;//
+                and return&#40;&#39;NUM&#39;,$1&#41;;
+        s/^&#40;[A-Za-z][A-Za-z0-9_]*&#41;//
+                and return&#40;&#39;VAR&#39;,$1&#41;;
+        s/^&#40;.&#41;//s
+                and return&#40;$1,$1&#41;;
+    }
+}
+
+sub Run {
+    my&#40;$self&#41;=shift;
+    $self-&gt;YYParse&#40; yylex =&gt; \&#38;_Lexer, yyerror =&gt; \&#38;_Error &#41;;
+}
+
+my&#40;$calc&#41;=new Calc;
+$calc-&gt;Run;
+
+1;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> sort-hash-keys.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Description: sorting hash keys to remove non-determinism from the generated
 parsers.
Bug: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=122977">https://rt.cpan.org/Public/Bug/Display.html?id=122977</a></span>
Bug-Debian: <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/903979">http://bugs.debian.org/903979</a></span>
Forwarded: no
Author: Andrius Merkys &lt;andrius.merkys@gmail.com&gt;
Last-Update: 2018-07-19

--- a/lib/Parse/Yapp/Driver.pm
+++ b/lib/Parse/Yapp/Driver.pm
@@ -159,7 +159,7 @@
 sub YYExpect {
     my&#40;$self&#41;=shift;
 
-    keys %{$self-&gt;{STATES}[$self-&gt;{STACK}[-1][0]]{ACTIONS}}
+    sort keys %{$self-&gt;{STATES}[$self-&gt;{STACK}[-1][0]]{ACTIONS}}
 }
 
 sub YYLexer {
--- a/lib/Parse/Yapp/Grammar.pm
+++ b/lib/Parse/Yapp/Grammar.pm
@@ -340,7 +340,7 @@
     $reachable = _Reachable&#40;$rules,$nterm,$term,$ufrules,$ufnterm&#41;;
 
     $$grammar{TERM}{chr&#40;0&#41;}=undef;
-    for my $sym &#40;keys %$term&#41; {
+    for my $sym &#40;sort keys %$term&#41; {
             &#40;   exists&#40;$$reachable{$sym}&#41;
              or exists&#40;$values-&gt;{PREC}{$sym}&#41; &#41;
         and do {
@@ -352,7 +352,7 @@
     }
 
     $$grammar{NTERM}{&#39;$start&#39;}=[];
-    for my $sym &#40;keys %$nterm&#41; {
+    for my $sym &#40;sort keys %$nterm&#41; {
             exists&#40;$$reachable{$sym}&#41;
         and do {
                 exists&#40;$values-&gt;{NULL}{$sym}&#41;
--- a/lib/Parse/Yapp/Lalr.pm
+++ b/lib/Parse/Yapp/Lalr.pm
@@ -132,7 +132,7 @@
         }
 
         #Prepare Actions
-        for &#40;keys&#40;%{$$states[$stateno]{ACTIONS}}&#41;&#41; {
+        for &#40;sort keys&#40;%{$$states[$stateno]{ACTIONS}}&#41;&#41; {
             my&#40;$term,$action&#41;=&#40;$_,$$states[$stateno]{ACTIONS}{$_}&#41;;
 
                 $term eq chr&#40;0&#41;
@@ -220,7 +220,7 @@
             exists&#40;$$states[$stateno]{GOTOS}&#41;
         and    do {
                 $text.= &#34;\n&#34;;
-                for &#40;keys&#40;%{$$states[$stateno]{GOTOS}}&#41;&#41; {
+                for &#40;sort keys&#40;%{$$states[$stateno]{GOTOS}}&#41;&#41; {
                     $text.= &#34;\t$_\tgo to state $$states[$stateno]{GOTOS}{$_}\n&#34;;
                 }
             };
@@ -336,7 +336,7 @@
 
                                     &#34;$term =&gt; $action&#34;;
                                 
-                                } grep { $_ } keys&#40;%{$$state{ACTIONS}}&#41;&#41;;
+                                } grep { $_ } sort keys&#40;%{$$state{ACTIONS}}&#41;&#41;;
 
                         $text.=&#34;\n\t\t}&#34;;
                     };
@@ -359,7 +359,7 @@
 
                                     &#34;&#39;$nterm&#39; =&gt; $stateno&#34;;
                                 
-                                } keys&#40;%{$$state{GOTOS}}&#41;&#41;;
+                                } sort keys&#40;%{$$state{GOTOS}}&#41;&#41;;
                         $text.=&#34;\n\t\t}&#34;;
                     };
 
@@ -412,7 +412,7 @@
 
             exists&#40;$$rel{$x}&#41;
         and do {
-            for $y &#40;keys&#40;%{$$rel{$x}}&#41;&#41; {
+            for $y &#40;sort keys&#40;%{$$rel{$x}}&#41;&#41; {
                     exists&#40;$N{$y}&#41;
                 or  &#38;$Traverse&#40;$y,$d+1&#41;;
 
@@ -435,7 +435,7 @@
         };
     };
 
-    for &#40;keys&#40;%$rel&#41;&#41; {
+    for &#40;sort keys&#40;%$rel&#41;&#41; {
             exists&#40;$N{$_}&#41;
         or  &#38;$Traverse&#40;$_,1&#41;;
     }
@@ -459,7 +459,7 @@
 	my&#40;$grammar&#41;=@_;
     my&#40;$rel,$closures&#41;;
 
-    for my $symbol &#40;keys&#40;%{$$grammar{NTERM}}&#41;&#41; {
+    for my $symbol &#40;sort keys&#40;%{$$grammar{NTERM}}&#41;&#41; {
         $closures-&gt;{$symbol}=pack&#40;&#39;b&#39;.@{$$grammar{RULES}}&#41;;
 
         for my $ruleno &#40;@{$$grammar{NTERM}{$symbol}}&#41; {
@@ -511,7 +511,7 @@
         push&#40;@{$transitions{$$rhs[$pos]}},[ $ruleno, $pos+1 ]&#41;;
     }
 
-    for &#40;keys&#40;%transitions&#41;&#41; {
+    for &#40;sort keys&#40;%transitions&#41;&#41; {
         my&#40;$symbol,$core&#41;=&#40;$_,$transitions{$_}&#41;;
         my&#40;$corekey&#41;=join&#40;&#39;,&#39;,map  { join&#40;&#39;.&#39;,@$_&#41; }
                               sort {    $$a[0] &lt;=&gt; $$b[0]
@@ -573,7 +573,7 @@
 	my&#40;$grammar,$termlst,$terminx&#41;=@_;
     my&#40;$rel,$first&#41;=&#40; {}, {} &#41;;
 
-    for my $symbol &#40;keys&#40;%{$$grammar{NTERM}}&#41;&#41; {
+    for my $symbol &#40;sort keys&#40;%{$$grammar{NTERM}}&#41;&#41; {
         $first-&gt;{$symbol}=pack&#40;&#39;b&#39;.@$termlst&#41;;
 
         RULE:
@@ -621,7 +621,7 @@
     }
 
     # Pass @$preds through a hash to ensure unicity
-    [ keys&#40; %{ +{ map { &#40;$_,1&#41; } @$preds } } &#41; ];
+    [ sort keys&#40; %{ +{ map { &#40;$_,1&#41; } @$preds } } &#41; ];
 }
 
 sub _FirstSfx {
@@ -694,7 +694,7 @@
     		exists&#40;$$state{GOTOS}&#41;
 		or	next;
 
-        for my $symbol &#40;keys&#40;%{$$state{GOTOS}}&#41;&#41; {
+        for my $symbol &#40;sort keys&#40;%{$$state{GOTOS}}&#41;&#41; {
             my&#40;$tostate&#41;=$$states[$$state{GOTOS}{$symbol}];
             my&#40;$goto&#41;=&#34;$stateno.$symbol&#34;;
 
@@ -731,11 +731,11 @@
 
 sub _ComputeLA {
 	my&#40;$grammar,$states&#41;=@_;
-	my&#40;$termlst&#41;= [ &#39;&#39;,keys&#40;%{$$grammar{TERM}}&#41; ];
+	my&#40;$termlst&#41;= [ &#39;&#39;,sort keys&#40;%{$$grammar{TERM}}&#41; ];
 
     my&#40;$follows,$inconsistent&#41; = _ComputeFollows&#40;$grammar,$states,$termlst&#41;;
 
-    for my $stateno &#40; keys&#40;%$inconsistent &#41; &#41; {
+    for my $stateno &#40; sort keys&#40;%$inconsistent &#41; &#41; {
         my&#40;$state&#41;=$$states[$stateno];
         my&#40;$conflict&#41;;
 
@@ -794,12 +794,12 @@
         undef;
     };
 
-    for my $stateno &#40;keys&#40;%$inconsistent&#41;&#41; {
+    for my $stateno &#40;sort keys&#40;%$inconsistent&#41;&#41; {
         my&#40;$state&#41;=$$states[$stateno];
         my&#40;$actions&#41;=$$state{ACTIONS};
         my&#40;$nbsr,$nbrr&#41;;
 
-        for my $term &#40; keys&#40;%$actions&#41; &#41; {
+        for my $term &#40; sort keys&#40;%$actions&#41; &#41; {
             my&#40;$act&#41;=$$actions{$term};
 
                 @$act &gt; 1
@@ -899,7 +899,7 @@
         and $$actions{error}[0] &gt; 0
         and ++$nodefault;
 
-        for my $term &#40;keys&#40;%$actions&#41;&#41; {
+        for my $term &#40;sort keys&#40;%$actions&#41;&#41; {
 
 			$$actions{$term}=$$actions{$term}[0];
 
@@ -917,7 +917,7 @@
         $default=&#40; map { $$_[0] }
                    sort { $$b[1] &lt;=&gt; $$a[1] or $$b[0] &lt;=&gt; $$a[0] }
                    map { [ $_, scalar&#40;@{$reduces{$_}}&#41; ] }
-                   keys&#40;%reduces&#41;&#41;[0];
+                   sort&#40;keys&#40;%reduces&#41;&#41;&#41;[0];
 
         delete&#40;@$actions{ @{$reduces{$default}} }&#41;;
         $$state{ACTIONS}{&#39;&#39;}=$default;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;23&nbsp;14:06:15&nbsp;2019</span>
    <span class="description">nicolas [...] atoomic.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">patch submitted upstream via 
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/wbraswell/parse-yapp/pull/2">https://github.com/wbraswell/parse-yapp/pull/2</a></span>
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
