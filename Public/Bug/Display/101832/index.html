<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #101832 for Email-Send-SMTP-Gmail: I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #101832 for Email-Send-SMTP-Gmail: I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Email-Send-SMTP-Gmail/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Email-Send-SMTP-Gmail/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Email-Send-SMTP-Gmail/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Email-Send-SMTP-Gmail/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Email-Send-SMTP-Gmail">Email-Send-SMTP-Gmail CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">101832</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Email-Send-SMTP-Gmail/Active/">Email-Send-SMTP-Gmail</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
giles [...] godartbrown.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-236026-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-236027-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Screen Shot 2015-01-30 at 15.53.03.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1458558/776093/Screen%20Shot%202015-01-30%20at%2015.53.03.png">
Fri Jan 30 10:54:45 2015 (265.5k) by giles [...] godartbrown.co.uk
</a>
</font></li>
</ul>


test-aftergmail.pdf<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1458558/776097/test-aftergmail.pdf">
Fri Jan 30 10:54:45 2015 (17.7k) by giles [...] godartbrown.co.uk
</a>
</font></li>
</ul>


test.pdf<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1458558/776095/test.pdf">
Fri Jan 30 10:54:45 2015 (17.7k) by giles [...] godartbrown.co.uk
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;29&nbsp;18:06:06&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 29 Jan 2015 23:05:51 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have a min repro case that works fine on windows but throws an error when run on Linux and Mac.  I believe it is linked to bare line endings.

This is the sample code;
&lt;code&gt;
use strict;
use warnings;
use Email::Send::SMTP::Gmail;
my $username = ‘user@gmail.com&#39;;
my $password = ‘password&#39;;
my $to         = ‘recipient@somewher.com&#39;;
my $from       = &#39;user@gmail.com&#39;;
my $subject    = &#39;Test&#39;;
my $attachment = “/pathtoapdffile/indata.pdf&#34;;
my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;

my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
        -smtp  =&gt; &#39;smtp.gmail.com&#39;,
        -login =&gt; ‘user@gmail.com&#39;,
        -pass  =&gt; ‘password&#39;,
        -layer =&gt; &#39;ssl&#39;,
        -port  =&gt; 465,
#       -debug =&gt; 1,
&#41;;

$mail-&gt;send&#40;
        -to          =&gt; $to,
        -subject     =&gt; $subject,
#       -verbose     =&gt; &#39;1&#39;,
        -contenttype=&gt;&#39;text/html&#39;,
        -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
        -attachments =&gt; $attachment
&#41;;

$mail-&gt;bye;
&lt;/code&gt;

gives the following error on linux and Mac;
…
Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command channel:  at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.

at the end of the pdf file.
I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to date &#40;0.88&#41;.
Have I missed anything?

Thanks
Giles
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;08:38:36&nbsp;2015</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

Thanks for this bug-report.

I see that for some reason Google decided to change/adjust its SMTP server.
Your sample code works on my Linux machine connecting to servers other than Gmail, but as you said, fails with it.

The issue seems to be related on how the attachment is processed.
I&#39;ve changed the code so instead of sending the whole attachment file to the server, it sends it in several chunks.

Based on my tests, now it works!, so please:

Could you download the latest version from CPAN &#40;I&#39;m uploading 0.94&#41; to give it a try?

I really don&#39;t know why it works or not in Windows. Could you try the new release also in Windows?

Hope this helps.


On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I have a min repro case that works fine on windows but throws an error
&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt; endings.
&gt; 
&gt; This is the sample code;
&gt; &lt;code&gt;
&gt; use strict;
&gt; use warnings;
&gt; use Email::Send::SMTP::Gmail;
&gt; my $username = ‘user@gmail.com&#39;;
&gt; my $password = ‘password&#39;;
&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt; my $from       = &#39;user@gmail.com&#39;;
&gt; my $subject    = &#39;Test&#39;;
&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt; 
&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;         -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;         -login =&gt; ‘user@gmail.com&#39;,
&gt;         -pass  =&gt; ‘password&#39;,
&gt;         -layer =&gt; &#39;ssl&#39;,
&gt;         -port  =&gt; 465,
&gt; #       -debug =&gt; 1,
&gt; &#41;;
&gt; 
&gt; $mail-&gt;send&#40;
&gt;         -to          =&gt; $to,
&gt;         -subject     =&gt; $subject,
&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;         -contenttype=&gt;&#39;text/html&#39;,
&gt;         -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;         -attachments =&gt; $attachment
&gt; &#41;;
&gt; 
&gt; $mail-&gt;bye;
&gt; &lt;/code&gt;
&gt; 
&gt; gives the following error on linux and Mac;
&gt; …
&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command channel:
&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt; 
&gt; at the end of the pdf file.
&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to date
&gt; &#40;0.88&#41;.
&gt; Have I missed anything?
&gt; 
&gt; Thanks
&gt; Giles
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;08:38:36&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;10:38:45&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101832] I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Jan 2015 15:38:30 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It certainly works on Mac, but the technique you used to segment the pdf file appears to corrupt it and it cannot be read by the recipient :-&#40;

Giles

On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; 
&gt; Hello,
&gt; 
&gt; Thanks for this bug-report.
&gt; 
&gt; I see that for some reason Google decided to change/adjust its SMTP server.
&gt; Your sample code works on my Linux machine connecting to servers other than Gmail, but as you said, fails with it.
&gt; 
&gt; The issue seems to be related on how the attachment is processed.
&gt; I&#39;ve changed the code so instead of sending the whole attachment file to the server, it sends it in several chunks.
&gt; 
&gt; Based on my tests, now it works!, so please:
&gt; 
&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading 0.94&#41; to give it a try?
&gt; 
&gt; I really don&#39;t know why it works or not in Windows. Could you try the new release also in Windows?
&gt; 
&gt; Hope this helps.
&gt; 
&gt; 
&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt; I have a min repro case that works fine on windows but throws an error
&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt;&gt; endings.
&gt;&gt; 
&gt;&gt; This is the sample code;
&gt;&gt; &lt;code&gt;
&gt;&gt; use strict;
&gt;&gt; use warnings;
&gt;&gt; use Email::Send::SMTP::Gmail;
&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt;&gt; my $password = ‘password&#39;;
&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt;&gt; my $subject    = &#39;Test&#39;;
&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt;&gt; 
&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;&gt;        -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;&gt;        -login =&gt; ‘user@gmail.com&#39;,
&gt;&gt;        -pass  =&gt; ‘password&#39;,
&gt;&gt;        -layer =&gt; &#39;ssl&#39;,
&gt;&gt;        -port  =&gt; 465,
&gt;&gt; #       -debug =&gt; 1,
&gt;&gt; &#41;;
&gt;&gt; 
&gt;&gt; $mail-&gt;send&#40;
&gt;&gt;        -to          =&gt; $to,
&gt;&gt;        -subject     =&gt; $subject,
&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;&gt;        -contenttype=&gt;&#39;text/html&#39;,
&gt;&gt;        -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;&gt;        -attachments =&gt; $attachment
&gt;&gt; &#41;;
&gt;&gt; 
&gt;&gt; $mail-&gt;bye;
&gt;&gt; &lt;/code&gt;
&gt;&gt; 
&gt;&gt; gives the following error on linux and Mac;
&gt;&gt; …
&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command channel:
&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt;&gt; 
&gt;&gt; at the end of the pdf file.
&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to date
&gt;&gt; &#40;0.88&#41;.
&gt;&gt; Have I missed anything?
&gt;&gt; 
&gt;&gt; Thanks
&gt;&gt; Giles
</div>&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;10:52:23&nbsp;2015</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I&#39;ve tested with pdfs of different sizes without issues :-?

Could you attach a pdf to reproduce the error?

Thanks,
Peco

On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It certainly works on Mac, but the technique you used to segment the
&gt; pdf file appears to corrupt it and it cannot be read by the recipient
&gt; :-&#40;
&gt; 
&gt; Giles
&gt; 
&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;
&gt; &gt; Hello,
&gt; &gt;
&gt; &gt; Thanks for this bug-report.
&gt; &gt;
&gt; &gt; I see that for some reason Google decided to change/adjust its SMTP
&gt; &gt; server.
&gt; &gt; Your sample code works on my Linux machine connecting to servers
&gt; &gt; other than Gmail, but as you said, fails with it.
&gt; &gt;
&gt; &gt; The issue seems to be related on how the attachment is processed.
&gt; &gt; I&#39;ve changed the code so instead of sending the whole attachment file
&gt; &gt; to the server, it sends it in several chunks.
&gt; &gt;
&gt; &gt; Based on my tests, now it works!, so please:
&gt; &gt;
&gt; &gt; Could you download the latest version from CPAN &#40;I&#39;m uploading 0.94&#41;
&gt; &gt; to give it a try?
&gt; &gt;
&gt; &gt; I really don&#39;t know why it works or not in Windows. Could you try the
&gt; &gt; new release also in Windows?
&gt; &gt;
&gt; &gt; Hope this helps.
&gt; &gt;
&gt; &gt;
&gt; &gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt; I have a min repro case that works fine on windows but throws an
&gt; &gt;&gt; error
&gt; &gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt; &gt;&gt; endings.
&gt; &gt;&gt;
&gt; &gt;&gt; This is the sample code;
&gt; &gt;&gt; &lt;code&gt;
&gt; &gt;&gt; use strict;
&gt; &gt;&gt; use warnings;
&gt; &gt;&gt; use Email::Send::SMTP::Gmail;
&gt; &gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt; &gt;&gt; my $password = ‘password&#39;;
&gt; &gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt; &gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt; &gt;&gt; my $subject    = &#39;Test&#39;;
&gt; &gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt; &gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt; &gt;&gt;
&gt; &gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt; &gt;&gt;        -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt; &gt;&gt;        -login =&gt; ‘user@gmail.com&#39;,
&gt; &gt;&gt;        -pass  =&gt; ‘password&#39;,
&gt; &gt;&gt;        -layer =&gt; &#39;ssl&#39;,
&gt; &gt;&gt;        -port  =&gt; 465,
&gt; &gt;&gt; #       -debug =&gt; 1,
&gt; &gt;&gt; &#41;;
&gt; &gt;&gt;
&gt; &gt;&gt; $mail-&gt;send&#40;
&gt; &gt;&gt;        -to          =&gt; $to,
&gt; &gt;&gt;        -subject     =&gt; $subject,
&gt; &gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt; &gt;&gt;        -contenttype=&gt;&#39;text/html&#39;,
&gt; &gt;&gt;        -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt; &gt;&gt;        -attachments =&gt; $attachment
&gt; &gt;&gt; &#41;;
&gt; &gt;&gt;
&gt; &gt;&gt; $mail-&gt;bye;
&gt; &gt;&gt; &lt;/code&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; gives the following error on linux and Mac;
&gt; &gt;&gt; …
&gt; &gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt; &gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command channel:
&gt; &gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt; &gt;&gt;
&gt; &gt;&gt; at the end of the pdf file.
&gt; &gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to date
&gt; &gt;&gt; &#40;0.88&#41;.
&gt; &gt;&gt; Have I missed anything?
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks
&gt; &gt;&gt; Giles
</div>&gt; &gt;
&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;10:54:45&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101832] I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Jan 2015 15:54:25 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry I could have been more helpful, attached is a sample pdf and how it appears after going through gmail as well as a diff &#40;using hex fiend&#41;


Giles
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1458558/776093/Screen%20Shot%202015-01-30%20at%2015.53.03.png">Download Screen Shot 2015-01-30 at 15.53.03.png</a><br />
<span class="downloadcontenttype">image/png 265.5k</span>
</div>
<div class="messagebody">
<img alt="Screen Shot 2015-01-30 at 15.53.03.png" title="Screen Shot 2015-01-30 at 15.53.03.png" src="/Ticket/Attachment/1458558/776093/" /></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1458558/776095/test.pdf">Download test.pdf</a><br />
<span class="downloadcontenttype">application/pdf 17.7k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1458558/776097/test-aftergmail.pdf">Download test-aftergmail.pdf</a><br />
<span class="downloadcontenttype">application/pdf 17.7k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 30 Jan 2015, at 15:38, Godart-Brown, Giles &lt;giles@godartbrown.co.uk&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It certainly works on Mac, but the technique you used to segment the pdf file appears to corrupt it and it cannot be read by the recipient :-&#40;
&gt; 
&gt; Giles
&gt; 
&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt; 
&gt;&gt; Hello,
&gt;&gt; 
&gt;&gt; Thanks for this bug-report.
&gt;&gt; 
&gt;&gt; I see that for some reason Google decided to change/adjust its SMTP server.
&gt;&gt; Your sample code works on my Linux machine connecting to servers other than Gmail, but as you said, fails with it.
&gt;&gt; 
&gt;&gt; The issue seems to be related on how the attachment is processed.
&gt;&gt; I&#39;ve changed the code so instead of sending the whole attachment file to the server, it sends it in several chunks.
&gt;&gt; 
&gt;&gt; Based on my tests, now it works!, so please:
&gt;&gt; 
&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading 0.94&#41; to give it a try?
&gt;&gt; 
&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you try the new release also in Windows?
&gt;&gt; 
&gt;&gt; Hope this helps.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt; I have a min repro case that works fine on windows but throws an error
&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt;&gt;&gt; endings.
&gt;&gt;&gt; 
&gt;&gt;&gt; This is the sample code;
&gt;&gt;&gt; &lt;code&gt;
&gt;&gt;&gt; use strict;
&gt;&gt;&gt; use warnings;
&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt;&gt;&gt; my $password = ‘password&#39;;
&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt;&gt;&gt; 
&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;&gt;&gt;       -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;&gt;&gt;       -login =&gt; ‘user@gmail.com&#39;,
&gt;&gt;&gt;       -pass  =&gt; ‘password&#39;,
&gt;&gt;&gt;       -layer =&gt; &#39;ssl&#39;,
&gt;&gt;&gt;       -port  =&gt; 465,
&gt;&gt;&gt; #       -debug =&gt; 1,
&gt;&gt;&gt; &#41;;
&gt;&gt;&gt; 
&gt;&gt;&gt; $mail-&gt;send&#40;
&gt;&gt;&gt;       -to          =&gt; $to,
&gt;&gt;&gt;       -subject     =&gt; $subject,
&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;&gt;&gt;       -contenttype=&gt;&#39;text/html&#39;,
&gt;&gt;&gt;       -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;&gt;&gt;       -attachments =&gt; $attachment
&gt;&gt;&gt; &#41;;
&gt;&gt;&gt; 
&gt;&gt;&gt; $mail-&gt;bye;
&gt;&gt;&gt; &lt;/code&gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; gives the following error on linux and Mac;
&gt;&gt;&gt; …
&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command channel:
&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt;&gt;&gt; 
&gt;&gt;&gt; at the end of the pdf file.
&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to date
&gt;&gt;&gt; &#40;0.88&#41;.
&gt;&gt;&gt; Have I missed anything?
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks
&gt;&gt;&gt; Giles
</div>&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
</div>&gt; 
</div></div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;10:55:14&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101832] I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Jan 2015 15:55:01 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">our emails crossed

Giles

On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; 
&gt; Hi,
&gt; 
&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt; 
&gt; Could you attach a pdf to reproduce the error?
&gt; 
&gt; Thanks,
&gt; Peco
&gt; 
&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt; It certainly works on Mac, but the technique you used to segment the
&gt;&gt; pdf file appears to corrupt it and it cannot be read by the recipient
&gt;&gt; :-&#40;
&gt;&gt; 
&gt;&gt; Giles
&gt;&gt; 
&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; Hello,
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks for this bug-report.
&gt;&gt;&gt; 
&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its SMTP
&gt;&gt;&gt; server.
&gt;&gt;&gt; Your sample code works on my Linux machine connecting to servers
&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt;&gt;&gt; 
&gt;&gt;&gt; The issue seems to be related on how the attachment is processed.
&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole attachment file
&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt;&gt;&gt; 
&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt;&gt;&gt; 
&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading 0.94&#41;
&gt;&gt;&gt; to give it a try?
&gt;&gt;&gt; 
&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you try the
&gt;&gt;&gt; new release also in Windows?
&gt;&gt;&gt; 
&gt;&gt;&gt; Hope this helps.
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws an
&gt;&gt;&gt;&gt; error
&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt;&gt;&gt;&gt; endings.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; This is the sample code;
&gt;&gt;&gt;&gt; &lt;code&gt;
&gt;&gt;&gt;&gt; use strict;
&gt;&gt;&gt;&gt; use warnings;
&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;&gt;&gt;&gt;       -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;&gt;&gt;&gt;       -login =&gt; ‘user@gmail.com&#39;,
&gt;&gt;&gt;&gt;       -pass  =&gt; ‘password&#39;,
&gt;&gt;&gt;&gt;       -layer =&gt; &#39;ssl&#39;,
&gt;&gt;&gt;&gt;       -port  =&gt; 465,
&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt;&gt;&gt;&gt;       -to          =&gt; $to,
&gt;&gt;&gt;&gt;       -subject     =&gt; $subject,
&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;&gt;&gt;&gt;       -contenttype=&gt;&#39;text/html&#39;,
&gt;&gt;&gt;&gt;       -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;&gt;&gt;&gt;       -attachments =&gt; $attachment
&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt;&gt;&gt;&gt; …
&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command channel:
&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to date
&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt;&gt;&gt;&gt; Have I missed anything?
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Thanks
&gt;&gt;&gt;&gt; Giles
</div>&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
</div></div>&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;14:16:35&nbsp;2015</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Got it. v 0.96 uploaded.

Summary:

1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of attachments

2&#41; Chunking the attachment works but the solution may depend on the email client. For example, v0.94 works well with Thunderbird but not with Google&#39;s web interface.
The reason is that some email clients are smart to reconstruct fragmented attachments eliminating divisions, others ... not.

3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based on an empirical work I release v0.96 that handle the situation. Creating the chunks taking care with the divisions of each segment.

4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.

5&#41; What I really don&#39;t like is that we are partitioning the attachments when in some cases is not needed &#40;any other SMTP than the Gmail&#41;

Peco

On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; our emails crossed
&gt; 
&gt; Giles
&gt; 
&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt; &gt;
&gt; &gt; Could you attach a pdf to reproduce the error?
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Peco
&gt; &gt;
&gt; &gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt; It certainly works on Mac, but the technique you used to segment the
&gt; &gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt; &gt;&gt; recipient
&gt; &gt;&gt; :-&#40;
&gt; &gt;&gt;
&gt; &gt;&gt; Giles
&gt; &gt;&gt;
&gt; &gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-
&gt; &gt;&gt; Send-
&gt; &gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Hello,
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Thanks for this bug-report.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; I see that for some reason Google decided to change/adjust its SMTP
&gt; &gt;&gt;&gt; server.
&gt; &gt;&gt;&gt; Your sample code works on my Linux machine connecting to servers
&gt; &gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; The issue seems to be related on how the attachment is processed.
&gt; &gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole attachment
&gt; &gt;&gt;&gt; file
&gt; &gt;&gt;&gt; to the server, it sends it in several chunks.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt; &gt;&gt;&gt; 0.94&#41;
&gt; &gt;&gt;&gt; to give it a try?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you try
&gt; &gt;&gt;&gt; the
&gt; &gt;&gt;&gt; new release also in Windows?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Hope this helps.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws an
&gt; &gt;&gt;&gt;&gt; error
&gt; &gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt; &gt;&gt;&gt;&gt; endings.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; This is the sample code;
&gt; &gt;&gt;&gt;&gt; &lt;code&gt;
&gt; &gt;&gt;&gt;&gt; use strict;
&gt; &gt;&gt;&gt;&gt; use warnings;
&gt; &gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt; &gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt; &gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt; &gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt; &gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt; &gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt; &gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt; &gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt; &gt;&gt;&gt;&gt;       -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt; &gt;&gt;&gt;&gt;       -login =&gt; ‘user@gmail.com&#39;,
&gt; &gt;&gt;&gt;&gt;       -pass  =&gt; ‘password&#39;,
&gt; &gt;&gt;&gt;&gt;       -layer =&gt; &#39;ssl&#39;,
&gt; &gt;&gt;&gt;&gt;       -port  =&gt; 465,
&gt; &gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt; &gt;&gt;&gt;&gt; &#41;;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt; &gt;&gt;&gt;&gt;       -to          =&gt; $to,
&gt; &gt;&gt;&gt;&gt;       -subject     =&gt; $subject,
&gt; &gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt; &gt;&gt;&gt;&gt;       -contenttype=&gt;&#39;text/html&#39;,
&gt; &gt;&gt;&gt;&gt;       -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt; &gt;&gt;&gt;&gt;       -attachments =&gt; $attachment
&gt; &gt;&gt;&gt;&gt; &#41;;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt; &gt;&gt;&gt;&gt; &lt;/code&gt;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt; &gt;&gt;&gt;&gt; …
&gt; &gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt; &gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt; &gt;&gt;&gt;&gt; channel:
&gt; &gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; at the end of the pdf file.
&gt; &gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt; &gt;&gt;&gt;&gt; date
&gt; &gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt; &gt;&gt;&gt;&gt; Have I missed anything?
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; Thanks
&gt; &gt;&gt;&gt;&gt; Giles
</div>&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
</div></div>&gt; &gt;
&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;16:19:31&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101832] I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Jan 2015 21:18:49 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">this stuff is never easy - thanks anyway for your quick response

Giles

On 30 Jan 2015, at 19:16, Juan Jose San Martin via RT &lt;bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; 
&gt; Got it. v 0.96 uploaded.
&gt; 
&gt; Summary:
&gt; 
&gt; 1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of attachments
&gt; 
&gt; 2&#41; Chunking the attachment works but the solution may depend on the email client. For example, v0.94 works well with Thunderbird but not with Google&#39;s web interface.
&gt; The reason is that some email clients are smart to reconstruct fragmented attachments eliminating divisions, others ... not.
&gt; 
&gt; 3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based on an empirical work I release v0.96 that handle the situation. Creating the chunks taking care with the divisions of each segment.
&gt; 
&gt; 4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.
&gt; 
&gt; 5&#41; What I really don&#39;t like is that we are partitioning the attachments when in some cases is not needed &#40;any other SMTP than the Gmail&#41;
&gt; 
&gt; Peco
&gt; 
&gt; On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt; our emails crossed
&gt;&gt; 
&gt;&gt; Giles
&gt;&gt; 
&gt;&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; Hi,
&gt;&gt;&gt; 
&gt;&gt;&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt;&gt;&gt; 
&gt;&gt;&gt; Could you attach a pdf to reproduce the error?
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; Peco
&gt;&gt;&gt; 
&gt;&gt;&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt; It certainly works on Mac, but the technique you used to segment the
&gt;&gt;&gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt;&gt;&gt;&gt; recipient
&gt;&gt;&gt;&gt; :-&#40;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-
&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Thanks for this bug-report.
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its SMTP
&gt;&gt;&gt;&gt;&gt; server.
&gt;&gt;&gt;&gt;&gt; Your sample code works on my Linux machine connecting to servers
&gt;&gt;&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; The issue seems to be related on how the attachment is processed.
&gt;&gt;&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole attachment
&gt;&gt;&gt;&gt;&gt; file
&gt;&gt;&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt;&gt;&gt;&gt;&gt; 0.94&#41;
&gt;&gt;&gt;&gt;&gt; to give it a try?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you try
&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt; new release also in Windows?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Hope this helps.
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws an
&gt;&gt;&gt;&gt;&gt;&gt; error
&gt;&gt;&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt;&gt;&gt;&gt;&gt;&gt; endings.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; This is the sample code;
&gt;&gt;&gt;&gt;&gt;&gt; &lt;code&gt;
&gt;&gt;&gt;&gt;&gt;&gt; use strict;
&gt;&gt;&gt;&gt;&gt;&gt; use warnings;
&gt;&gt;&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt;&gt;&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt;&gt;&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt;&gt;&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt;&gt;&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;&gt;&gt;&gt;&gt;&gt;      -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;      -login =&gt; ‘user@gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;      -pass  =&gt; ‘password&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;      -layer =&gt; &#39;ssl&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;      -port  =&gt; 465,
&gt;&gt;&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt;&gt;&gt;&gt;&gt;&gt;      -to          =&gt; $to,
&gt;&gt;&gt;&gt;&gt;&gt;      -subject     =&gt; $subject,
&gt;&gt;&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;      -contenttype=&gt;&#39;text/html&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;      -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;      -attachments =&gt; $attachment
&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt;&gt;&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt;&gt;&gt;&gt;&gt;&gt; …
&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt;&gt;&gt;&gt;&gt;&gt; channel:
&gt;&gt;&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt;&gt;&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt;&gt;&gt;&gt;&gt;&gt; date
&gt;&gt;&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt;&gt;&gt;&gt;&gt;&gt; Have I missed anything?
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Thanks
&gt;&gt;&gt;&gt;&gt;&gt; Giles
</div>&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
</div></div>&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;30&nbsp;16:42:55&nbsp;2015</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Give a try to v0.96 during the next days and I will close the bug-report as resolved.

Thanks
Peco

On Fri Jan 30 16:19:31 2015, giles@godartbrown.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; this stuff is never easy - thanks anyway for your quick response
&gt; 
&gt; Giles
&gt; 
&gt; On 30 Jan 2015, at 19:16, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;
&gt; &gt; Got it. v 0.96 uploaded.
&gt; &gt;
&gt; &gt; Summary:
&gt; &gt;
&gt; &gt; 1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of
&gt; &gt; attachments
&gt; &gt;
&gt; &gt; 2&#41; Chunking the attachment works but the solution may depend on the
&gt; &gt; email client. For example, v0.94 works well with Thunderbird but not
&gt; &gt; with Google&#39;s web interface.
&gt; &gt; The reason is that some email clients are smart to reconstruct
&gt; &gt; fragmented attachments eliminating divisions, others ... not.
&gt; &gt;
&gt; &gt; 3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based on
&gt; &gt; an empirical work I release v0.96 that handle the situation. Creating
&gt; &gt; the chunks taking care with the divisions of each segment.
&gt; &gt;
&gt; &gt; 4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.
&gt; &gt;
&gt; &gt; 5&#41; What I really don&#39;t like is that we are partitioning the
&gt; &gt; attachments when in some cases is not needed &#40;any other SMTP than the
&gt; &gt; Gmail&#41;
&gt; &gt;
&gt; &gt; Peco
&gt; &gt;
&gt; &gt; On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt; our emails crossed
&gt; &gt;&gt;
&gt; &gt;&gt; Giles
&gt; &gt;&gt;
&gt; &gt;&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-
&gt; &gt;&gt; Send-
&gt; &gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Could you attach a pdf to reproduce the error?
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Thanks,
&gt; &gt;&gt;&gt; Peco
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt; It certainly works on Mac, but the technique you used to segment
&gt; &gt;&gt;&gt;&gt; the
&gt; &gt;&gt;&gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt; &gt;&gt;&gt;&gt; recipient
&gt; &gt;&gt;&gt;&gt; :-&#40;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; Giles
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-
&gt; &gt;&gt;&gt;&gt; Send-
&gt; &gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Hello,
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Thanks for this bug-report.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its
&gt; &gt;&gt;&gt;&gt;&gt; SMTP
&gt; &gt;&gt;&gt;&gt;&gt; server.
&gt; &gt;&gt;&gt;&gt;&gt; Your sample code works on my Linux machine connecting to servers
&gt; &gt;&gt;&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; The issue seems to be related on how the attachment is processed.
&gt; &gt;&gt;&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole attachment
&gt; &gt;&gt;&gt;&gt;&gt; file
&gt; &gt;&gt;&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt; &gt;&gt;&gt;&gt;&gt; 0.94&#41;
&gt; &gt;&gt;&gt;&gt;&gt; to give it a try?
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you try
&gt; &gt;&gt;&gt;&gt;&gt; the
&gt; &gt;&gt;&gt;&gt;&gt; new release also in Windows?
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Hope this helps.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws an
&gt; &gt;&gt;&gt;&gt;&gt;&gt; error
&gt; &gt;&gt;&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt; &gt;&gt;&gt;&gt;&gt;&gt; endings.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; This is the sample code;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; &lt;code&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; use strict;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; use warnings;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -login =&gt; ‘user@gmail.com&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -pass  =&gt; ‘password&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -layer =&gt; &#39;ssl&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -port  =&gt; 465,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -to          =&gt; $to,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -subject     =&gt; $subject,
&gt; &gt;&gt;&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -contenttype=&gt;&#39;text/html&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;      -attachments =&gt; $attachment
&gt; &gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; …
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt; &gt;&gt;&gt;&gt;&gt;&gt; channel:
&gt; &gt;&gt;&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt; &gt;&gt;&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt; &gt;&gt;&gt;&gt;&gt;&gt; date
&gt; &gt;&gt;&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Have I missed anything?
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Thanks
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Giles
</div>&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
</div></div>&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
</div></div>&gt; &gt;
&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;31&nbsp;03:38:56&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101832] I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 31 Jan 2015 08:38:42 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I did a MCPAN reload index but it still says my 0.94 version is up to date :-&#40;
will try again later

Giles

On 30 Jan 2015, at 21:42, Juan Jose San Martin via RT &lt;bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; 
&gt; Give a try to v0.96 during the next days and I will close the bug-report as resolved.
&gt; 
&gt; Thanks
&gt; Peco
&gt; 
&gt; On Fri Jan 30 16:19:31 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt; this stuff is never easy - thanks anyway for your quick response
&gt;&gt; 
&gt;&gt; Giles
&gt;&gt; 
&gt;&gt; On 30 Jan 2015, at 19:16, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; Got it. v 0.96 uploaded.
&gt;&gt;&gt; 
&gt;&gt;&gt; Summary:
&gt;&gt;&gt; 
&gt;&gt;&gt; 1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of
&gt;&gt;&gt; attachments
&gt;&gt;&gt; 
&gt;&gt;&gt; 2&#41; Chunking the attachment works but the solution may depend on the
&gt;&gt;&gt; email client. For example, v0.94 works well with Thunderbird but not
&gt;&gt;&gt; with Google&#39;s web interface.
&gt;&gt;&gt; The reason is that some email clients are smart to reconstruct
&gt;&gt;&gt; fragmented attachments eliminating divisions, others ... not.
&gt;&gt;&gt; 
&gt;&gt;&gt; 3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based on
&gt;&gt;&gt; an empirical work I release v0.96 that handle the situation. Creating
&gt;&gt;&gt; the chunks taking care with the divisions of each segment.
&gt;&gt;&gt; 
&gt;&gt;&gt; 4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.
&gt;&gt;&gt; 
&gt;&gt;&gt; 5&#41; What I really don&#39;t like is that we are partitioning the
&gt;&gt;&gt; attachments when in some cases is not needed &#40;any other SMTP than the
&gt;&gt;&gt; Gmail&#41;
&gt;&gt;&gt; 
&gt;&gt;&gt; Peco
&gt;&gt;&gt; 
&gt;&gt;&gt; On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt; our emails crossed
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-
&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Could you attach a pdf to reproduce the error?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt; Peco
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt; It certainly works on Mac, but the technique you used to segment
&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt;&gt;&gt;&gt;&gt;&gt; recipient
&gt;&gt;&gt;&gt;&gt;&gt; :-&#40;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-
&gt;&gt;&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks for this bug-report.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its
&gt;&gt;&gt;&gt;&gt;&gt;&gt; SMTP
&gt;&gt;&gt;&gt;&gt;&gt;&gt; server.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Your sample code works on my Linux machine connecting to servers
&gt;&gt;&gt;&gt;&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The issue seems to be related on how the attachment is processed.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole attachment
&gt;&gt;&gt;&gt;&gt;&gt;&gt; file
&gt;&gt;&gt;&gt;&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 0.94&#41;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; to give it a try?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you try
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; new release also in Windows?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hope this helps.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws an
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; endings.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; This is the sample code;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;code&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use strict;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use warnings;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -login =&gt; ‘user@gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -pass  =&gt; ‘password&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -layer =&gt; &#39;ssl&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -port  =&gt; 465,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -to          =&gt; $to,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -subject     =&gt; $subject,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -contenttype=&gt;&#39;text/html&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -attachments =&gt; $attachment
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; …
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; channel:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; date
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Have I missed anything?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Giles
</div>&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
</div></div>&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;31&nbsp;03:46:56&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101832] I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 31 Jan 2015 08:46:44 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I manually downloaded 0.96 and it ran fine with a couple of binary files I tested on Mac, will do a Windows run in the week.

Many thanks

Giles

On 30 Jan 2015, at 21:42, Juan Jose San Martin via RT &lt;bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; 
&gt; Give a try to v0.96 during the next days and I will close the bug-report as resolved.
&gt; 
&gt; Thanks
&gt; Peco
&gt; 
&gt; On Fri Jan 30 16:19:31 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt; this stuff is never easy - thanks anyway for your quick response
&gt;&gt; 
&gt;&gt; Giles
&gt;&gt; 
&gt;&gt; On 30 Jan 2015, at 19:16, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; Got it. v 0.96 uploaded.
&gt;&gt;&gt; 
&gt;&gt;&gt; Summary:
&gt;&gt;&gt; 
&gt;&gt;&gt; 1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of
&gt;&gt;&gt; attachments
&gt;&gt;&gt; 
&gt;&gt;&gt; 2&#41; Chunking the attachment works but the solution may depend on the
&gt;&gt;&gt; email client. For example, v0.94 works well with Thunderbird but not
&gt;&gt;&gt; with Google&#39;s web interface.
&gt;&gt;&gt; The reason is that some email clients are smart to reconstruct
&gt;&gt;&gt; fragmented attachments eliminating divisions, others ... not.
&gt;&gt;&gt; 
&gt;&gt;&gt; 3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based on
&gt;&gt;&gt; an empirical work I release v0.96 that handle the situation. Creating
&gt;&gt;&gt; the chunks taking care with the divisions of each segment.
&gt;&gt;&gt; 
&gt;&gt;&gt; 4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.
&gt;&gt;&gt; 
&gt;&gt;&gt; 5&#41; What I really don&#39;t like is that we are partitioning the
&gt;&gt;&gt; attachments when in some cases is not needed &#40;any other SMTP than the
&gt;&gt;&gt; Gmail&#41;
&gt;&gt;&gt; 
&gt;&gt;&gt; Peco
&gt;&gt;&gt; 
&gt;&gt;&gt; On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt; our emails crossed
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-
&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Could you attach a pdf to reproduce the error?
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt; Peco
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt; It certainly works on Mac, but the technique you used to segment
&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt;&gt;&gt;&gt;&gt;&gt; recipient
&gt;&gt;&gt;&gt;&gt;&gt; :-&#40;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-Email-
&gt;&gt;&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks for this bug-report.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its
&gt;&gt;&gt;&gt;&gt;&gt;&gt; SMTP
&gt;&gt;&gt;&gt;&gt;&gt;&gt; server.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Your sample code works on my Linux machine connecting to servers
&gt;&gt;&gt;&gt;&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; The issue seems to be related on how the attachment is processed.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole attachment
&gt;&gt;&gt;&gt;&gt;&gt;&gt; file
&gt;&gt;&gt;&gt;&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 0.94&#41;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; to give it a try?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you try
&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt; new release also in Windows?
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hope this helps.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws an
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare line
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; endings.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; This is the sample code;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;code&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use strict;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use warnings;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -login =&gt; ‘user@gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -pass  =&gt; ‘password&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -layer =&gt; &#39;ssl&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -port  =&gt; 465,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -to          =&gt; $to,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -subject     =&gt; $subject,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -contenttype=&gt;&#39;text/html&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -attachments =&gt; $attachment
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; …
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; channel:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; date
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Have I missed anything?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Giles
</div>&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; 
</div></div>&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jan&nbsp;31&nbsp;04:28:01&nbsp;2015</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for do this manually!

Hope it be indexed by CPAN soon.

Peco

On Sat Jan 31 03:46:56 2015, giles@godartbrown.co.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I manually downloaded 0.96 and it ran fine with a couple of binary
&gt; files I tested on Mac, will do a Windows run in the week.
&gt; 
&gt; Many thanks
&gt; 
&gt; Giles
&gt; 
&gt; On 30 Jan 2015, at 21:42, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;
&gt; &gt; Give a try to v0.96 during the next days and I will close the bug-
&gt; &gt; report as resolved.
&gt; &gt;
&gt; &gt; Thanks
&gt; &gt; Peco
&gt; &gt;
&gt; &gt; On Fri Jan 30 16:19:31 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt; this stuff is never easy - thanks anyway for your quick response
&gt; &gt;&gt;
&gt; &gt;&gt; Giles
&gt; &gt;&gt;
&gt; &gt;&gt; On 30 Jan 2015, at 19:16, Juan Jose San Martin via RT &lt;bug-Email-
&gt; &gt;&gt; Send-
&gt; &gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Got it. v 0.96 uploaded.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Summary:
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; 1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of
&gt; &gt;&gt;&gt; attachments
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; 2&#41; Chunking the attachment works but the solution may depend on the
&gt; &gt;&gt;&gt; email client. For example, v0.94 works well with Thunderbird but
&gt; &gt;&gt;&gt; not
&gt; &gt;&gt;&gt; with Google&#39;s web interface.
&gt; &gt;&gt;&gt; The reason is that some email clients are smart to reconstruct
&gt; &gt;&gt;&gt; fragmented attachments eliminating divisions, others ... not.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; 3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based
&gt; &gt;&gt;&gt; on
&gt; &gt;&gt;&gt; an empirical work I release v0.96 that handle the situation.
&gt; &gt;&gt;&gt; Creating
&gt; &gt;&gt;&gt; the chunks taking care with the divisions of each segment.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; 4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; 5&#41; What I really don&#39;t like is that we are partitioning the
&gt; &gt;&gt;&gt; attachments when in some cases is not needed &#40;any other SMTP than
&gt; &gt;&gt;&gt; the
&gt; &gt;&gt;&gt; Gmail&#41;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; Peco
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt; our emails crossed
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; Giles
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-
&gt; &gt;&gt;&gt;&gt; Send-
&gt; &gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Hi,
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Could you attach a pdf to reproduce the error?
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Thanks,
&gt; &gt;&gt;&gt;&gt;&gt; Peco
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt;&gt; It certainly works on Mac, but the technique you used to segment
&gt; &gt;&gt;&gt;&gt;&gt;&gt; the
&gt; &gt;&gt;&gt;&gt;&gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt; &gt;&gt;&gt;&gt;&gt;&gt; recipient
&gt; &gt;&gt;&gt;&gt;&gt;&gt; :-&#40;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Giles
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Email-
&gt; &gt;&gt;&gt;&gt;&gt;&gt; Send-
&gt; &gt;&gt;&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt;&gt;&gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Hello,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks for this bug-report.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; SMTP
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; server.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Your sample code works on my Linux machine connecting to
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; servers
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; The issue seems to be related on how the attachment is
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; processed.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; attachment
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; file
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 0.94&#41;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; to give it a try?
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; try
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; new release also in Windows?
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Hope this helps.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; an
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; line
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; endings.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; This is the sample code;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;code&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use strict;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use warnings;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -login =&gt; ‘user@gmail.com&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -pass  =&gt; ‘password&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -layer =&gt; &#39;ssl&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -port  =&gt; 465,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -to          =&gt; $to,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -subject     =&gt; $subject,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -contenttype=&gt;&#39;text/html&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -attachments =&gt; $attachment
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; …
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; channel:
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; date
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Have I missed anything?
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Giles
</div>&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
</div></div>&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
</div></div>&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;
</div></div>&gt; &gt;
&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;05:06:29&nbsp;2015</span>
    <span class="description">PECO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jan 31 04:28:01 2015, PECO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for do this manually!
&gt; 
&gt; Hope it be indexed by CPAN soon.
&gt; 
&gt; Peco
&gt; 
&gt; On Sat Jan 31 03:46:56 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt; I manually downloaded 0.96 and it ran fine with a couple of binary
&gt; &gt; files I tested on Mac, will do a Windows run in the week.
&gt; &gt; 
&gt; &gt; Many thanks
&gt; &gt; 
&gt; &gt; Giles
&gt; &gt; 
&gt; &gt; On 30 Jan 2015, at 21:42, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt; &gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Give a try to v0.96 during the next days and I will close the bug-
&gt; &gt; &gt; report as resolved.
&gt; &gt; &gt;
&gt; &gt; &gt; Thanks
&gt; &gt; &gt; Peco
&gt; &gt; &gt;
&gt; &gt; &gt; On Fri Jan 30 16:19:31 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt; &gt;&gt; this stuff is never easy - thanks anyway for your quick response
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; Giles
&gt; &gt; &gt;&gt;
&gt; &gt; &gt;&gt; On 30 Jan 2015, at 19:16, Juan Jose San Martin via RT &lt;bug-Email-
&gt; &gt; &gt;&gt; Send-
&gt; &gt; &gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt; &gt;&gt;
<div class="message-stanza open">&gt; &gt; &gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; Got it. v 0.96 uploaded.
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; Summary:
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; 1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of
&gt; &gt; &gt;&gt;&gt; attachments
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; 2&#41; Chunking the attachment works but the solution may depend on the
&gt; &gt; &gt;&gt;&gt; email client. For example, v0.94 works well with Thunderbird but
&gt; &gt; &gt;&gt;&gt; not
&gt; &gt; &gt;&gt;&gt; with Google&#39;s web interface.
&gt; &gt; &gt;&gt;&gt; The reason is that some email clients are smart to reconstruct
&gt; &gt; &gt;&gt;&gt; fragmented attachments eliminating divisions, others ... not.
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; 3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based
&gt; &gt; &gt;&gt;&gt; on
&gt; &gt; &gt;&gt;&gt; an empirical work I release v0.96 that handle the situation.
&gt; &gt; &gt;&gt;&gt; Creating
&gt; &gt; &gt;&gt;&gt; the chunks taking care with the divisions of each segment.
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; 4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; 5&#41; What I really don&#39;t like is that we are partitioning the
&gt; &gt; &gt;&gt;&gt; attachments when in some cases is not needed &#40;any other SMTP than
&gt; &gt; &gt;&gt;&gt; the
&gt; &gt; &gt;&gt;&gt; Gmail&#41;
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; Peco
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt; On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt; &gt;&gt;&gt;&gt; our emails crossed
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt; Giles
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-
&gt; &gt; &gt;&gt;&gt;&gt; Send-
&gt; &gt; &gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt; &gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt; &gt; &gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt; Hi,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt; &gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt; Could you attach a pdf to reproduce the error?
&gt; &gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt; Thanks,
&gt; &gt; &gt;&gt;&gt;&gt;&gt; Peco
&gt; &gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; It certainly works on Mac, but the technique you used to segment
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; the
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; recipient
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; :-&#40;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; Giles
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; Email-
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; Send-
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Hello,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks for this bug-report.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; SMTP
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; server.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Your sample code works on my Linux machine connecting to
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; servers
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; The issue seems to be related on how the attachment is
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; processed.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; attachment
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; file
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; 0.94&#41;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; to give it a try?
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; try
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; new release also in Windows?
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; Hope this helps.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; an
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; line
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; endings.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; This is the sample code;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;code&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use strict;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use warnings;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -login =&gt; ‘user@gmail.com&#39;,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -pass  =&gt; ‘password&#39;,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -layer =&gt; &#39;ssl&#39;,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -port  =&gt; 465,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -to          =&gt; $to,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -subject     =&gt; $subject,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -contenttype=&gt;&#39;text/html&#39;,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;     -attachments =&gt; $attachment
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; …
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; channel:
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; date
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Have I missed anything?
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Giles
</div>&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;&gt;&gt;
</div></div>&gt; &gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;&gt;&gt;
</div></div>&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;
&gt; &gt; &gt;&gt;&gt;
</div></div>&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
</div></div>&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;05:06:34&nbsp;2015</span>
    <span class="description">PECO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;01&nbsp;05:12:18&nbsp;2015</span>
    <span class="description">giles [...] godartbrown.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101832] I believe there is a problem with Email:Send:SMTP:Gmail and attachments on linux machines</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 1 May 2015 10:12:22 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Email-Send-SMTP-Gmail [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Godart-Brown, Giles&#34; &lt;giles [...] godartbrown.co.uk&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks - all is good

Giles

On 1 May 2015, at 10:06, Juan Jose San Martin via RT &lt;bug-Email-Send-SMTP-Gmail@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt; 
&gt; On Sat Jan 31 04:28:01 2015, PECO wrote:
<div class="message-stanza open">&gt;&gt; Thanks for do this manually!
&gt;&gt; 
&gt;&gt; Hope it be indexed by CPAN soon.
&gt;&gt; 
&gt;&gt; Peco
&gt;&gt; 
&gt;&gt; On Sat Jan 31 03:46:56 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt; I manually downloaded 0.96 and it ran fine with a couple of binary
&gt;&gt;&gt; files I tested on Mac, will do a Windows run in the week.
&gt;&gt;&gt; 
&gt;&gt;&gt; Many thanks
&gt;&gt;&gt; 
&gt;&gt;&gt; Giles
&gt;&gt;&gt; 
&gt;&gt;&gt; On 30 Jan 2015, at 21:42, Juan Jose San Martin via RT &lt;bug-Email-Send-
&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Give a try to v0.96 during the next days and I will close the bug-
&gt;&gt;&gt;&gt; report as resolved.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Thanks
&gt;&gt;&gt;&gt; Peco
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; On Fri Jan 30 16:19:31 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt; this stuff is never easy - thanks anyway for your quick response
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt; On 30 Jan 2015, at 19:16, Juan Jose San Martin via RT &lt;bug-Email-
&gt;&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Got it. v 0.96 uploaded.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Summary:
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; 1&#41; &#40;It seems that&#41; Google has added a limit for the transaction of
&gt;&gt;&gt;&gt;&gt;&gt; attachments
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; 2&#41; Chunking the attachment works but the solution may depend on the
&gt;&gt;&gt;&gt;&gt;&gt; email client. For example, v0.94 works well with Thunderbird but
&gt;&gt;&gt;&gt;&gt;&gt; not
&gt;&gt;&gt;&gt;&gt;&gt; with Google&#39;s web interface.
&gt;&gt;&gt;&gt;&gt;&gt; The reason is that some email clients are smart to reconstruct
&gt;&gt;&gt;&gt;&gt;&gt; fragmented attachments eliminating divisions, others ... not.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; 3&#41; I didn&#39;t find documentation from Google&#39;s restriction, so based
&gt;&gt;&gt;&gt;&gt;&gt; on
&gt;&gt;&gt;&gt;&gt;&gt; an empirical work I release v0.96 that handle the situation.
&gt;&gt;&gt;&gt;&gt;&gt; Creating
&gt;&gt;&gt;&gt;&gt;&gt; the chunks taking care with the divisions of each segment.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; 4&#41; Tested &#40;only&#41; on Linux using Thunderbird and Google&#39;s web.
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; 5&#41; What I really don&#39;t like is that we are partitioning the
&gt;&gt;&gt;&gt;&gt;&gt; attachments when in some cases is not needed &#40;any other SMTP than
&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt; Gmail&#41;
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; Peco
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; On Fri Jan 30 10:55:14 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt; our emails crossed
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt; On 30 Jan 2015, at 15:52, Juan Jose San Martin via RT &lt;bug-Email-
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I&#39;ve tested with pdfs of different sizes without issues :-?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Could you attach a pdf to reproduce the error?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Peco
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Fri Jan 30 10:38:45 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; It certainly works on Mac, but the technique you used to segment
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; pdf file appears to corrupt it and it cannot be read by the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; recipient
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; :-&#40;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Giles
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On 30 Jan 2015, at 13:38, Juan Jose San Martin via RT &lt;bug-
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Email-
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Send-
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SMTP-Gmail@rt.cpan.org&gt; wrote:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101832">https://rt.cpan.org/Ticket/Display.html?id=101832</a></span> &gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hello,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks for this bug-report.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I see that for some reason Google decided to change/adjust its
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SMTP
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; server.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Your sample code works on my Linux machine connecting to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; servers
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; other than Gmail, but as you said, fails with it.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; The issue seems to be related on how the attachment is
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; processed.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I&#39;ve changed the code so instead of sending the whole
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; attachment
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; file
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; to the server, it sends it in several chunks.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Based on my tests, now it works!, so please:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Could you download the latest version from CPAN &#40;I&#39;m uploading
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 0.94&#41;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; to give it a try?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I really don&#39;t know why it works or not in Windows. Could you
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; try
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; the
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; new release also in Windows?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Hope this helps.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; On Thu Jan 29 18:06:06 2015, giles@godartbrown.co.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I have a min repro case that works fine on windows but throws
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; an
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; error
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; when run on Linux and Mac.  I believe it is linked to bare
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; line
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; endings.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; This is the sample code;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;code&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use strict;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use warnings;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; use Email::Send::SMTP::Gmail;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $username = ‘user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $password = ‘password&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $to         = ‘recipient@somewher.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $from       = &#39;user@gmail.com&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $subject    = &#39;Test&#39;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $attachment = “/pathtoapdffile/indata.pdf&#34;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $thisLetter = &#34;hello world &lt;br&gt; line 2&#34;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; my $mail = Email::Send::SMTP::Gmail-&gt;new&#40;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -smtp  =&gt; &#39;smtp.gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -login =&gt; ‘user@gmail.com&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -pass  =&gt; ‘password&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -layer =&gt; &#39;ssl&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -port  =&gt; 465,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -debug =&gt; 1,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;send&#40;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -to          =&gt; $to,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -subject     =&gt; $subject,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; #       -verbose     =&gt; &#39;1&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -contenttype=&gt;&#39;text/html&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -body        =&gt; $thisLetter . &#39;&lt;br&gt;&lt;br&gt;&#39;,
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;    -attachments =&gt; $attachment
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; $mail-&gt;bye;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;/code&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; gives the following error on linux and Mac;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; …
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS=GLOB&#40;0x7fa89c0007c8&#41;&gt;&gt;&gt; CjI0NDI5CiUlRU9GCg==
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Net::SMTPS: Net::Cmd::datasend&#40;&#41;: unexpected EOF on command
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; channel:
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at /Library/Perl/5.16/Email/Send/SMTP/Gmail.pm line 328.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; at the end of the pdf file.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; I’m using Perl 5.16 and have Email::Send::SMTP::Gmail is up to
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; date
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &#40;0.88&#41;.
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Have I missed anything?
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Thanks
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Giles
</div>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; 
</div></div>&gt;&gt; 
&gt;&gt; 
</div>&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
