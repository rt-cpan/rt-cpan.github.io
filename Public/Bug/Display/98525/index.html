<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #98525 for Variable-Magic: Fails tests on blead</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #98525 for Variable-Magic: Fails tests on blead</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Variable-Magic">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Variable-Magic">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Variable-Magic">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Variable-Magic">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Variable-Magic">Variable-Magic CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">98525</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Variable-Magic">Variable-Magic</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ether [...] cpan.org

<br />
KENTNL [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-44686-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.53    </td>
  </tr>
  <tr id="CF-44687-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.54    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




open_BUc83oif.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1407023/746879/open_BUc83oif.txt">
Wed Sep 03 22:17:41 2014 (828b) by $_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=98525">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406148" href="/Public/Bug/Display.html?id=98525#txn-1406148">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;02&nbsp;05:37:10&nbsp;2014</span>
    <span class="description">KENTNL [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fails tests on blead</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1406148/746417/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746417">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza"><p>
	# Using Capture::Tiny 0.25<br>

	<br>

	#&nbsp;&nbsp; Failed test &#39;die in free callback at compile time and not in eval string&#39;<br>

	#&nbsp;&nbsp; at t/17-ctl.t line 407.<br>

	#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;raddish at -e line 1.<br>

	# raddish at -e line 1.<br>

	# Execution of -e aborted due to compilation errors.<br>

	# &#39;<br>

	#&nbsp;&nbsp;&nbsp;&nbsp; doesn&#39;t match &#39;(?^:^raddish at \-e line \d+\.<br>

	# Execution(?s:.*)$)&#39;<br>

	# Looks like you failed 1 test of 96.<br>

	t/17-ctl.t ........<br>

	Dubious, test returned 1 (wstat 256, 0x100)<br>

	Failed 1/96 subtests<br>

	<br>

	<br>

	<br>

	# Using Symbol 1.07<br>

	t/34-glob.t ....... ok<br>

	<br>

	#&nbsp;&nbsp; Failed test &#39;stash: function calls&#39;<br>

	#&nbsp;&nbsp; at t/35-stash.t line 99.<br>

	#&nbsp;&nbsp;&nbsp;&nbsp; Structures begin differing at:<br>

	#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $got-&gt;{fetch}[1] = &#39;eat&#39;<br>

	#&nbsp;&nbsp;&nbsp;&nbsp; $expected-&gt;{fetch}[1] = &#39;shoot&#39;<br>

	# Looks like you failed 1 test of 43.<br>

	t/35-stash.t ......<br>

	Dubious, test returned 1 (wstat 256, 0x100)<br>

	Failed 1/43 subtests<br>

	t/40-threads.t .... skipped: This Variable::Magic isn&#39;t thread safe<br>

	t/41-clone.t ...... skipped: This Variable::Magic isn&#39;t thread safe<br>

	t/80-leaks.t ...... ok</p>

<p>
	Looking at report metadata looks like it started failing between</p>

<p>
	v5.21.3-121-g35c2140 and v5.21.3-204-gef0f35a</p>


</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1406151" href="/Public/Bug/Display.html?id=98525#txn-1406151">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;02&nbsp;06:06:53&nbsp;2014</span>
    <span class="description">KENTNL [...] cpan.org -  Reference to perl ticket #122673 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1407023" href="/Public/Bug/Display.html?id=98525#txn-1407023">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;22:17:41&nbsp;2014</span>
    <span class="description">$_ = &#39;spro^^*%*^6ut# [...] &#38;$%*c&gt;#!^!#&#38;!pan.org&#39;; y/a-z.@//cd; print -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1407023/746878/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/746878">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Sep 02 05:37:10 2014, KENTNL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; # Using Capture::Tiny 0.25
&gt; 
&gt; # Failed test &#39;die in free callback at compile time and not in eval string&#39;
&gt; # at t/17-ctl.t line 407.
&gt; # &#39;raddish at -e line 1.
&gt; # raddish at -e line 1.
&gt; # Execution of -e aborted due to compilation errors.
&gt; # &#39;
&gt; # doesn&#39;t match &#39;&#40;?^:^raddish at \-e line \d+\.
&gt; # Execution&#40;?s:.*&#41;$&#41;&#39;
&gt; # Looks like you failed 1 test of 96.
&gt; t/17-ctl.t ........
&gt; Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
&gt; Failed 1/96 subtests
&gt; 
&gt; 
&gt; 
&gt; # Using Symbol 1.07
&gt; t/34-glob.t ....... ok
&gt; 
&gt; # Failed test &#39;stash: function calls&#39;
&gt; # at t/35-stash.t line 99.
&gt; # Structures begin differing at:
&gt; # $got-&gt;{fetch}[1] = &#39;eat&#39;
&gt; # $expected-&gt;{fetch}[1] = &#39;shoot&#39;
&gt; # Looks like you failed 1 test of 43.
&gt; t/35-stash.t ......
&gt; Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
&gt; Failed 1/43 subtests
&gt; t/40-threads.t .... skipped: This Variable::Magic isn&#39;t thread safe
&gt; t/41-clone.t ...... skipped: This Variable::Magic isn&#39;t thread safe
&gt; t/80-leaks.t ...... ok
&gt; 
&gt; Looking at report metadata looks like it started failing between
&gt; 
&gt; v5.21.3-121-g35c2140 and v5.21.3-204-gef0f35a
</div>
The attached patch should get Variable::Magic passing it’s tests again as of blead commit 10c25cd94 which I just made.

Now the number of magic calls is back to what it was back in perl 5.10.

Basically, 5.12 introduced an extra call, so that barewords would do ‘fetch store store’ on the stash.  &#40;‘Store’ sounds strange; it’s actually a vivifying fetch.&#41;

Commit 211a4342c changed the second store &#40;added in 5.12&#41; to a fetch.  So the test started failing.

The commit I made today eliminates the first fetch, which has actually been redundant most of the time.

While I still plan to make more changes in this area, I don’t think they will affect the number of magic calls.  So if you want to make a new release now, go ahead.  &#40;And then Andreas can get his smokes back.&#41;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> open_BUc83oif.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1407023/746879/open_BUc83oif.txt">Download open_BUc83oif.txt</a><br />
<span class="downloadcontenttype">text/plain 828b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -Nurp Variable-Magic-0.53/t/35-stash.t Variable-Magic-0.53-kzLVI9/t/35-stash.t
--- Variable-Magic-0.53/t/35-stash.t	2013-06-03 06:19:02.000000000 -0700
+++ Variable-Magic-0.53-kzLVI9/t/35-stash.t	2014-09-03 19:07:32.000000000 -0700
@@ -96,7 +96,9 @@ cast %Hlagh::, $wiz;
  is $@, &#34;ok\n&#34;, &#39;stash: function calls compiled fine&#39;;
  is_deeply \%mg, {
   fetch =&gt; \@calls,
-  store =&gt; &#40;&#34;$]&#34; &lt; 5.011_002 ? \@calls : [ map { &#40;$_&#41; x 2 } @calls ]&#41;,
+  store =&gt; &#40;&#34;$]&#34; &lt; 5.011_002 || &#34;$]&#34; &gt;= 5.021_004
+              ? \@calls
+              : [ map { &#40;$_&#41; x 2 } @calls ]&#41;,
  }, &#39;stash: function calls&#39;;
 }
 
@@ -296,7 +298,7 @@ $_ =&gt; sub {
 CB
 } qw&lt;fetch store exists delete&gt;&#41;;
 
-my $uo_exp = &#34;$]&#34; &lt; 5.011_002 ? 2 : 3;
+my $uo_exp = &#34;$]&#34; &lt; 5.011_002 || &#34;$]&#34; &gt;= 5.021_004 ? 2 : 3;
 
 $code .= &#39;, data =&gt; sub { +{ guard =&gt; 0 } }&#39;;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1407024" href="/Public/Bug/Display.html?id=98525#txn-1407024">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;03&nbsp;22:17:42&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1413244" href="/Public/Bug/Display.html?id=98525#txn-1413244">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;20&nbsp;17:35:29&nbsp;2014</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1413244/750229/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/750229">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2014-09-03 22:17:41, SPROUT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Sep 02 05:37:10 2014, KENTNL wrote:
<div class="message-stanza open">&gt; &gt; # Using Capture::Tiny 0.25
&gt; &gt;
&gt; &gt; # Failed test &#39;die in free callback at compile time and not in eval
&gt; &gt; string&#39;
&gt; &gt; # at t/17-ctl.t line 407.
&gt; &gt; # &#39;raddish at -e line 1.
&gt; &gt; # raddish at -e line 1.
&gt; &gt; # Execution of -e aborted due to compilation errors.
&gt; &gt; # &#39;
&gt; &gt; # doesn&#39;t match &#39;&#40;?^:^raddish at \-e line \d+\.
&gt; &gt; # Execution&#40;?s:.*&#41;$&#41;&#39;
&gt; &gt; # Looks like you failed 1 test of 96.
&gt; &gt; t/17-ctl.t ........
&gt; &gt; Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
&gt; &gt; Failed 1/96 subtests
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; # Using Symbol 1.07
&gt; &gt; t/34-glob.t ....... ok
&gt; &gt;
&gt; &gt; # Failed test &#39;stash: function calls&#39;
&gt; &gt; # at t/35-stash.t line 99.
&gt; &gt; # Structures begin differing at:
&gt; &gt; # $got-&gt;{fetch}[1] = &#39;eat&#39;
&gt; &gt; # $expected-&gt;{fetch}[1] = &#39;shoot&#39;
&gt; &gt; # Looks like you failed 1 test of 43.
&gt; &gt; t/35-stash.t ......
&gt; &gt; Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
&gt; &gt; Failed 1/43 subtests
&gt; &gt; t/40-threads.t .... skipped: This Variable::Magic isn&#39;t thread safe
&gt; &gt; t/41-clone.t ...... skipped: This Variable::Magic isn&#39;t thread safe
&gt; &gt; t/80-leaks.t ...... ok
&gt; &gt;
&gt; &gt; Looking at report metadata looks like it started failing between
&gt; &gt;
&gt; &gt; v5.21.3-121-g35c2140 and v5.21.3-204-gef0f35a
</div>&gt; 
&gt; The attached patch should get Variable::Magic passing it’s tests again
&gt; as of blead commit 10c25cd94 which I just made.
&gt; 
&gt; Now the number of magic calls is back to what it was back in perl
&gt; 5.10.
&gt; 
&gt; Basically, 5.12 introduced an extra call, so that barewords would do
&gt; ‘fetch store store’ on the stash.  &#40;‘Store’ sounds strange; it’s
&gt; actually a vivifying fetch.&#41;
&gt; 
&gt; Commit 211a4342c changed the second store &#40;added in 5.12&#41; to a fetch.
&gt; So the test started failing.
&gt; 
&gt; The commit I made today eliminates the first fetch, which has actually
&gt; been redundant most of the time.
&gt; 
&gt; While I still plan to make more changes in this area, I don’t think
&gt; they will affect the number of magic calls.  So if you want to make a
&gt; new release now, go ahead.  &#40;And then Andreas can get his smokes
&gt; back.&#41;
</div>
Smoking CPAN without Variable-Magic is quite senseless nowadays, so for everybody&#39;s convenience here&#39;s a CPAN.pm distroprefs file with this patch: <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/eserte/srezic-cpan-distroprefs/blob/master/Variable-Magic.yml">https://github.com/eserte/srezic-cpan-distroprefs/blob/master/Variable-Magic.yml</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1413291" href="/Public/Bug/Display.html?id=98525#txn-1413291">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;20&nbsp;20:18:27&nbsp;2014</span>
    <span class="description">ether [...] cpan.org -  Requestor ETHER added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1414189" href="/Public/Bug/Display.html?id=98525#txn-1414189">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;23&nbsp;06:41:53&nbsp;2014</span>
    <span class="description">vpit [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1414189/750755/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/750755">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 46b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This has been fixed in version 0.54.


Vincent
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1414191" href="/Public/Bug/Display.html?id=98525#txn-1414191">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;23&nbsp;06:41:55&nbsp;2014</span>
    <span class="description">vpit [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1414193" href="/Public/Bug/Display.html?id=98525#txn-1414193">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;23&nbsp;06:41:56&nbsp;2014</span>
    <span class="description">vpit [...] cpan.org -  Fixed in 0.54 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.416629</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
