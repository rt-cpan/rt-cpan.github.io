<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #74036 for Tk: Tk.pm fails to build on ActivePerl 5.12 and 5.14</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #74036 for Tk: Tk.pm fails to build on ActivePerl 5.12 and 5.14</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Tk/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Tk/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Tk/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Tk/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Tk">Tk CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">74036</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Tk/Active/">Tk</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
johannes.madel [...] gmx.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-33610-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
804.030    </td>
  </tr>
  <tr id="CF-33611-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
804.031    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;07:18:06&nbsp;2012</span>
    <span class="description">johannes.madel [...] gmx.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Tk.pm fails to build on ActivePerl 5.12 and 5.14</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hey Folks,

when trying to install Tk.pm using cpan on ActivePerl Version 5.12 or 
5.14, build fails. The errormessage is the folloing:
------------
C:/Perl/site/bin/gcc.exe -c  -I.. -I.. -I../pTk/mTk/xlib -I. -Ibitmaps -
I.. -I../pTk/mTk/xlib   -DNDEBUG -DWIN32 -D_CONSOLE -DNO_STRICT -DHA
VE_DES_FCRYPT -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -
DPERL_IMPLICIT_SYS -DUSE_PERLIO -D_USE_32BIT_TIME_T -
DPERL_MSVCRT_READFIX -DHASAT
TRIBUTE -fno-strict-aliasing -mms-bitfields -DPERLDLL -O2         -
DVERSION=\&#34;804.03\&#34;  -DXS_VERSION=\&#34;804.03\&#34;  &#34;-IC:\Perl\lib\CORE&#34;   -
Wal
l -Wno-implicit-int -Wno-comment -Wno-unused -D__USE_FIXED_PROTOTYPES__ 
ximage.c
C:/Perl/site/bin/gcc.exe -c  -I.. -I.. -I../pTk/mTk/xlib -I. -Ibitmaps -
I.. -I../pTk/mTk/xlib   -DNDEBUG -DWIN32 -D_CONSOLE -DNO_STRICT -DHA
VE_DES_FCRYPT -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -
DPERL_IMPLICIT_SYS -DUSE_PERLIO -D_USE_32BIT_TIME_T -
DPERL_MSVCRT_READFIX -DHASAT
TRIBUTE -fno-strict-aliasing -mms-bitfields -DPERLDLL -O2         -
DVERSION=\&#34;804.03\&#34;  -DXS_VERSION=\&#34;804.03\&#34;  &#34;-IC:\Perl\lib\CORE&#34;   -
Wal
l -Wno-implicit-int -Wno-comment -Wno-unused -D__USE_FIXED_PROTOTYPES__ 
xutil.c
rc -fo tk.res -r -i . -i mTk\win\rc mTk\win\rc\tk.rc
dmake.exe:  Error code 197, while making &#39;tk.res&#39;
dmake.exe:  Error code 255, while making &#39;pTk\libpTk.a&#39;
  SREZIC/Tk-804.030.tar.gz
  C:\Perl\site\bin\dmake.exe -- NOT OK
CPAN: YAML::XS loaded ok &#40;v0.35&#41;
------------

When no compiler is present, ActivePerl downloads a version of MinGW 
and installs it. I assume failing command tries to call to be the 
windows resource compiler rc.exe. Maybe it could instead call the 
command windres.exe, which is the resource compiler which is downloaded 
with mingw.

Best regards,
Efewig
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;17:22:27&nbsp;2012</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2012-01-16 07:18:06, Efewig wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hey Folks,
&gt; 
&gt; when trying to install Tk.pm using cpan on ActivePerl Version 5.12 or 
&gt; 5.14, build fails. The errormessage is the folloing:
&gt; ------------
&gt; C:/Perl/site/bin/gcc.exe -c  -I.. -I.. -I../pTk/mTk/xlib -I. -Ibitmaps -
&gt; I.. -I../pTk/mTk/xlib   -DNDEBUG -DWIN32 -D_CONSOLE -DNO_STRICT -DHA
&gt; VE_DES_FCRYPT -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -
&gt; DPERL_IMPLICIT_SYS -DUSE_PERLIO -D_USE_32BIT_TIME_T -
&gt; DPERL_MSVCRT_READFIX -DHASAT
&gt; TRIBUTE -fno-strict-aliasing -mms-bitfields -DPERLDLL -O2         -
&gt; DVERSION=\&#34;804.03\&#34;  -DXS_VERSION=\&#34;804.03\&#34;  &#34;-IC:\Perl\lib\CORE&#34;   -
&gt; Wal
&gt; l -Wno-implicit-int -Wno-comment -Wno-unused -D__USE_FIXED_PROTOTYPES__ 
&gt; ximage.c
&gt; C:/Perl/site/bin/gcc.exe -c  -I.. -I.. -I../pTk/mTk/xlib -I. -Ibitmaps -
&gt; I.. -I../pTk/mTk/xlib   -DNDEBUG -DWIN32 -D_CONSOLE -DNO_STRICT -DHA
&gt; VE_DES_FCRYPT -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -
&gt; DPERL_IMPLICIT_SYS -DUSE_PERLIO -D_USE_32BIT_TIME_T -
&gt; DPERL_MSVCRT_READFIX -DHASAT
&gt; TRIBUTE -fno-strict-aliasing -mms-bitfields -DPERLDLL -O2         -
&gt; DVERSION=\&#34;804.03\&#34;  -DXS_VERSION=\&#34;804.03\&#34;  &#34;-IC:\Perl\lib\CORE&#34;   -
&gt; Wal
&gt; l -Wno-implicit-int -Wno-comment -Wno-unused -D__USE_FIXED_PROTOTYPES__ 
&gt; xutil.c
&gt; rc -fo tk.res -r -i . -i mTk\win\rc mTk\win\rc\tk.rc
&gt; dmake.exe:  Error code 197, while making &#39;tk.res&#39;
&gt; dmake.exe:  Error code 255, while making &#39;pTk\libpTk.a&#39;
&gt;   SREZIC/Tk-804.030.tar.gz
&gt;   C:\Perl\site\bin\dmake.exe -- NOT OK
&gt; CPAN: YAML::XS loaded ok &#40;v0.35&#41;
&gt; ------------
&gt; 
&gt; When no compiler is present, ActivePerl downloads a version of MinGW 
&gt; and installs it. I assume failing command tries to call to be the 
&gt; windows resource compiler rc.exe. Maybe it could instead call the 
&gt; command windres.exe, which is the resource compiler which is downloaded 
&gt; with mingw.
</div>
Hello,

can you try again with the attached patch &#40;it&#39;s just removing an anchor
from the gcc regexp in pTk/Makefile.PL&#41;?

Regards,
    Slaven
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> gcc.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff --git i/pTk/Makefile.PL w/pTk/Makefile.PL
index 2f4788c..5b08abe 100644
--- i/pTk/Makefile.PL
+++ w/pTk/Makefile.PL
@@ -243,7 +243,7 @@ if &#40;$Tk::MMutil::IsWin32 or &#40;$win_arch eq &#39;MSWin32&#39; and $^O eq &#39;cygwin&#39;&#41;&#41;
  {
   my $cc = $Config{&#39;cc&#39;};
   my $file = &#39;tk.res&#39;;
-  if &#40;$cc =~ /^gcc/i&#41;
+  if &#40;$cc =~ /gcc/i&#41;
    {
     $file = &#39;tkres$&#40;OBJ_EXT&#41;&#39;;
     $dep .= &#34;$file : mTk/win/rc/tk.rc\n\t&#34;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;17:22:28&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;17:49:30&nbsp;2012</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2012-01-16 17:22:27, SREZIC wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 2012-01-16 07:18:06, Efewig wrote:
</div>[...]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Hello,
&gt; 
&gt; can you try again with the attached patch &#40;it&#39;s just removing an anchor
&gt; from the gcc regexp in pTk/Makefile.PL&#41;?
&gt; 
</div>
That said, I just realized that there are more places using /^gcc/
instead of /gcc/. So can you use this patch &#40;gcc2.diff&#41; instead of the
previous one and tell me whether it works?

Regards,
    Slaven
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> gcc2.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff --git c/Makefile.PL w/Makefile.PL
index 38e9c77..c4e545f 100755
--- c/Makefile.PL
+++ w/Makefile.PL
@@ -142,7 +142,7 @@ sub MY::post_initialize
    }
    else {
      push&#40;@{$self-&gt;{&#39;O_FILES&#39;}},
-          &#40;$Config{&#39;cc&#39;} =~ /^gcc/i&#41; ?
+          &#40;$Config{&#39;cc&#39;} =~ /gcc/i&#41; ?
                &#39;pTk\\tkres$&#40;OBJ_EXT&#41;&#39; : &#39;pTk\\tk.res&#39;&#41;;
    }
   }
diff --git c/Tk/MMutil.pm w/Tk/MMutil.pm
index 1a69e56..59a64e0 100644
--- c/Tk/MMutil.pm
+++ w/Tk/MMutil.pm
@@ -551,7 +551,7 @@ sub TkExtMakefile
      $i = &#34;-I$tk $i&#34;;
      $i = &#34;-I$ptk $i&#34;;
     }
-   if &#40;$IsWin32 &#38;&#38; $Config{&#39;cc&#39;} =~ /^gcc/i&#41;
+   if &#40;$IsWin32 &#38;&#38; $Config{&#39;cc&#39;} =~ /gcc/i&#41;
     {
      my $base  = $Config{&#39;libpth&#39;};
      #$base =~ s#lib$#i386-mingw32/lib#;
diff --git c/pTk/Makefile.PL w/pTk/Makefile.PL
index 2f4788c..5b08abe 100644
--- c/pTk/Makefile.PL
+++ w/pTk/Makefile.PL
@@ -243,7 +243,7 @@ if &#40;$Tk::MMutil::IsWin32 or &#40;$win_arch eq &#39;MSWin32&#39; and $^O eq &#39;cygwin&#39;&#41;&#41;
  {
   my $cc = $Config{&#39;cc&#39;};
   my $file = &#39;tk.res&#39;;
-  if &#40;$cc =~ /^gcc/i&#41;
+  if &#40;$cc =~ /gcc/i&#41;
    {
     $file = &#39;tkres$&#40;OBJ_EXT&#41;&#39;;
     $dep .= &#34;$file : mTk/win/rc/tk.rc\n\t&#34;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;20&nbsp;13:18:07&nbsp;2013</span>
    <span class="description">SREZIC [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;26&nbsp;05:05:51&nbsp;2013</span>
    <span class="description">SREZIC [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sun&nbsp;May&nbsp;26&nbsp;05:05:51&nbsp;2013</span>
    <span class="description">SREZIC [...] cpan.org -  Fixed in 804.031 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
