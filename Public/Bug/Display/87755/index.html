<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #87755 for Term-ANSIColor: Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #87755 for Term-ANSIColor: Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Term-ANSIColor/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Term-ANSIColor/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Term-ANSIColor/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Term-ANSIColor/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Term-ANSIColor">Term-ANSIColor CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">87755</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Term-ANSIColor/Active/">Term-ANSIColor</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
nooneofconsequence [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-239548-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-239549-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;09&nbsp;19:02:13&nbsp;2013</span>
    <span class="description">nooneofconsequence [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 9 Aug 2013 16:01:55 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Log-Log4perl [...] rt.cpan.org, bug-Term-ANSIColor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Hicks &lt;nooneofconsequence [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think this is possibly due to a bug in Term::ANSIColor but I&#39;m not sure.


I&#39;ve noticed that if I&#39;m using Log::Log4perl::Appender::ScreenColoredLevels as my appended and have normal perl print statements following a log4perl logger invocation, whatever color setting was used for the last log4perl print gets used for my standard print statement as well.


I see that in the patch from issue 30899 which replaced the prior way of using Term::ANSIColor qw&#40;:constants&#41; and actually specifying the RESET in the formatting like:
return GREEN . $message . RESET;

with the new way of using the Term::ANSIColor colored function like:
$msg = Term::ANSIColor::colored&#40; $msg, $color &#41;;

from the documentation on Term::ANSIColor here:    <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm">http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm</a></span>
it seems colored&#40;&#41; is supposed to add the reset for you.
&#34;As an aid in resetting colors, colored&#40;&#41; takes a scalar as the first argument and any number of attribute strings as the second argument and returns the scalar wrapped in escape codes so that the attributes will be set as requested before the string and reset to normal after the string.&#34;



I am currently working around this problem by importing the constants interface to my script 
use Term::ANSIColor qw&#40;:constants&#41;;


and then adding
print RESET;
between any log4perl lines and plain ol print statements I want to use which restores the behavior I think I&#39;m used to.

I&#39;m seeing this on Debian 7 with  liblog-log4perl-perl   1.29-1 which has the version string
our $VERSION = &#39;1.29&#39;;
in the /usr/share/perl5/Log/Log4perl.pm   file

and Term::ANSIColor;
$VERSION = &#39;3.00&#39;;


Michael Hicks
nooneofconsequence@gmail.com


Sometimes being wrong in interesting ways about interesting things is quite good for starting discussions.
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;09&nbsp;19:25:50&nbsp;2013</span>
    <span class="description">rra [...] stanford.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87755] Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 09 Aug 2013 16:25:35 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Term-ANSIColor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Russ Allbery &lt;rra [...] stanford.edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Michael Hicks via RT&#34; &lt;bug-Term-ANSIColor@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I see that in the patch from issue 30899 which replaced the prior way of
&gt; using Term::ANSIColor qw&#40;:constants&#41; and actually specifying the RESET
&gt; in the formatting like:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; return GREEN . $message . RESET;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; with the new way of using the Term::ANSIColor colored function like:
&gt; $msg = Term::ANSIColor::colored&#40; $msg, $color &#41;;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; from the documentation on Term::ANSIColor here:    <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm">http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm</a></span>
&gt; it seems colored&#40;&#41; is supposed to add the reset for you.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#34;As an aid in resetting colors, colored&#40;&#41; takes a scalar as the first
&gt; argument and any number of attribute strings as the second argument and
&gt; returns the scalar wrapped in escape codes so that the attributes will
&gt; be set as requested before the string and reset to normal after the
&gt; string.&#34;
</div>
What does $msg contain after that line?  Does it end with the reset
sequence?  &#40;\e[0m&#41;

-- 
Russ Allbery &#40;rra@stanford.edu&#41;             &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.eyrie.org/~eagle/">http://www.eyrie.org/~eagle/</a></span>&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;09&nbsp;19:25:50&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;09&nbsp;20:24:06&nbsp;2013</span>
    <span class="description">nooneofconsequence [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87755] Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 9 Aug 2013 17:23:54 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Term-ANSIColor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Hicks &lt;nooneofconsequence [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I added code to my log4perl installation to print $msg to a file and on inspecting that file with vim It looks to me like each lineends with:
^[[0m


The lines start with:
^[[92m
  OR 
^[[92m

for different colors per my logging color settings, and 

In case it is relevant, my $TERM is set to xterm-256color

I&#39;m not sure if this is the same thing, but If I use tput to get the reset characters I normally use in my profile for coloring my prompt:
red=$&#40;tput setaf 1&#41;
green=$&#40;tput setaf 2&#41;
blue=$&#40;tput setaf 4&#41;
reset=$&#40;tput sgr0&#41;
PS1=&#34;\[$red\]\u\[$reset\]@\[$green\]\h\[$reset\]:\[$blue\]\w\[$reset\]\$ &#34;


and put them in a file like so:
reset=$&#40;tput sgr0&#41;  &#38;&#38; echo $reset | sudo tee -a reset.txt

the file contains:
^[&#40;B^[[m


according to terminfo that sgr0 code is &#34; exit_attribute_mode     turn off all attributes&#34;.  I&#39;m not sure if this is the same reset that Term-ANSIColor uses.


Michael Hicks
nooneofconsequence@gmail.com


Sometimes being wrong in interesting ways about interesting things is quite good for starting discussions.

On Aug 9, 2013, at 4:25 PM, &#34;rra@stanford.edu via RT&#34; &lt;bug-Term-ANSIColor@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87755">https://rt.cpan.org/Ticket/Display.html?id=87755</a></span> &gt;
&gt; 
&gt; &#34;Michael Hicks via RT&#34; &lt;bug-Term-ANSIColor@rt.cpan.org&gt; writes:
&gt; 
<div class="message-stanza open">&gt;&gt; I see that in the patch from issue 30899 which replaced the prior way of
&gt;&gt; using Term::ANSIColor qw&#40;:constants&#41; and actually specifying the RESET
&gt;&gt; in the formatting like:
</div>&gt; 
<div class="message-stanza open">&gt;&gt; return GREEN . $message . RESET;
</div>&gt; 
<div class="message-stanza open">&gt;&gt; with the new way of using the Term::ANSIColor colored function like:
&gt;&gt; $msg = Term::ANSIColor::colored&#40; $msg, $color &#41;;
</div>&gt; 
<div class="message-stanza open">&gt;&gt; from the documentation on Term::ANSIColor here:    <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm">http://search.cpan.org/~rra/Term-ANSIColor-4.02/ANSIColor.pm</a></span>
&gt;&gt; it seems colored&#40;&#41; is supposed to add the reset for you.
</div>&gt; 
<div class="message-stanza open">&gt;&gt; &#34;As an aid in resetting colors, colored&#40;&#41; takes a scalar as the first
&gt;&gt; argument and any number of attribute strings as the second argument and
&gt;&gt; returns the scalar wrapped in escape codes so that the attributes will
&gt;&gt; be set as requested before the string and reset to normal after the
&gt;&gt; string.&#34;
</div>&gt; 
&gt; What does $msg contain after that line?  Does it end with the reset
&gt; sequence?  &#40;\e[0m&#41;
&gt; 
&gt; -- 
&gt; Russ Allbery &#40;rra@stanford.edu&#41;             &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.eyrie.org/~eagle/">http://www.eyrie.org/~eagle/</a></span>&gt;
&gt; 
</div></div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;09&nbsp;20:47:31&nbsp;2013</span>
    <span class="description">rra [...] stanford.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87755] Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 09 Aug 2013 17:47:18 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Term-ANSIColor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Russ Allbery &lt;rra [...] stanford.edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Michael Hicks via RT&#34; &lt;bug-Term-ANSIColor@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Term-ANSIColor
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87755">https://rt.cpan.org/Ticket/Display.html?id=87755</a></span> &gt;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I added code to my log4perl installation to print $msg to a file and on
&gt; inspecting that file with vim It looks to me like each lineends with:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ^[[0m
</div>
Given that, it seems like Term::ANSIColor is correct here.  That&#39;s the
reset sequence that clears all colors.  &#40;The 0 is optional.&#41;  So it seems
like something else is going on here other than that line or the
Term::ANSIColor behavior.  Maybe some other part of the code isn&#39;t using
colored correctly?

-- 
Russ Allbery &#40;rra@stanford.edu&#41;             &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.eyrie.org/~eagle/">http://www.eyrie.org/~eagle/</a></span>&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;10&nbsp;01:55:15&nbsp;2013</span>
    <span class="description">nooneofconsequence [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #87755] Log::Log4perl::Appender::ScreenColoredLevels no longer issues RESET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 9 Aug 2013 22:55:02 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Term-ANSIColor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Hicks &lt;nooneofconsequence [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I dug into this a bit more and hypothesized that it could be my using Data::Dumper with objects in the output colored by Term-ANSIColor inside log4perl that was causing the problem due to the objects being strings that have newline chars in them.

When I ran my program with log4perl set to a logging level that didn&#39;t dump any objects, the phenomenon didn&#39;t occur.  so I tried setting 

$Term::ANSIColor::EACHLINE = &#34;\n&#34;;

In the parent program and the problem went away even at the logging level dumping objects.  I&#39;ll submit this as a documentation addendum to the log4perl folks.  Thanks for your time,

Michael Hicks
nooneofconsequence@gmail.com


Sometimes being wrong in interesting ways about interesting things is quite good for starting discussions.

On Aug 9, 2013, at 5:47 PM, rra@stanford.edu via RT &lt;bug-Term-ANSIColor@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87755">https://rt.cpan.org/Ticket/Display.html?id=87755</a></span> &gt;
&gt; 
&gt; &#34;Michael Hicks via RT&#34; &lt;bug-Term-ANSIColor@rt.cpan.org&gt; writes:
&gt; 
<div class="message-stanza open">&gt;&gt;       Queue: Term-ANSIColor
&gt;&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=87755">https://rt.cpan.org/Ticket/Display.html?id=87755</a></span> &gt;
</div>&gt; 
<div class="message-stanza open">&gt;&gt; I added code to my log4perl installation to print $msg to a file and on
&gt;&gt; inspecting that file with vim It looks to me like each lineends with:
</div>&gt; 
<div class="message-stanza open">&gt;&gt; ^[[0m
</div>&gt; 
&gt; Given that, it seems like Term::ANSIColor is correct here.  That&#39;s the
&gt; reset sequence that clears all colors.  &#40;The 0 is optional.&#41;  So it seems
&gt; like something else is going on here other than that line or the
&gt; Term::ANSIColor behavior.  Maybe some other part of the code isn&#39;t using
&gt; colored correctly?
&gt; 
&gt; -- 
&gt; Russ Allbery &#40;rra@stanford.edu&#41;             &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.eyrie.org/~eagle/">http://www.eyrie.org/~eagle/</a></span>&gt;
&gt; 
</div></div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;22&nbsp;02:10:16&nbsp;2013</span>
    <span class="description">RRA [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
