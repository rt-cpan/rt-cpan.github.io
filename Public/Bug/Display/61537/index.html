<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #61537 for DBD-ODBC: Empty values with long column names??</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #61537 for DBD-ODBC: Empty values with long column names??</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-ODBC">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-ODBC">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-ODBC">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-ODBC">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-ODBC">DBD-ODBC CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">61537</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-ODBC">DBD-ODBC</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cpanbugs [...] dseven.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-10188-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
1.23</li>
<li>
1.24_6</li>
</ul>
    </td>
  </tr>
  <tr id="CF-10189-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




61537.zip<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/834928/432505/61537.zip">
Wed Sep 22 12:38:10 2010 (35.6k) by bitcard [...] dseven.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=61537">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834490" href="/Public/Bug/Display.html?id=61537#txn-834490">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;21&nbsp;18:10:14&nbsp;2010</span>
    <span class="description">bitcard [...] dseven.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Empty values with long column names??</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/834490/432265/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432265">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
I seem to have several problems accessing an MDB through unixODBC -&gt;
mdbtools on Ubuntu 10.4. Everything looks OK using unixODBC&#39;s &#34;isql&#34;
utility, but various problems occur through DBD::ODBC.

Picking one I can&#39;t find a workaround for as a starting point....

This query looks fine in isql:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">SQL&gt; select
</div>Call,STATION_CALLSIGN,APP_DXKEEPER_LOTW_QSL_Rcvd,APP_DXKEEPER_EQSL_QSLSDATE,QSO_End
from QSOs where DXCCID = &#39;324&#39;
+---------------------------+---------------------------+---------------------------+---------------------------+---------------------+
| Call                      | STATION_CALLSIGN          |
APP_DXKEEPER_LOTW_QSL_Rcvd| APP_DXKEEPER_EQSL_QSLSDATE| QSO_End        
    |
+---------------------------+---------------------------+---------------------------+---------------------------+---------------------+
| VU2RAK                    | N6ML                      | R            
            | 2009-09-01 00:00:00       | 2009-09-01 15:29:23 |
| VU2PAI                    | N6ML                      | R            
            | 2010-03-10 00:00:00       | 2010-03-09 16:50:52 |
| VU2NKS                    | N6ML                      | Y            
            | 2010-08-22 00:00:00       | 2010-08-21 20:38:22 |
+---------------------------+---------------------------+---------------------------+---------------------------+---------------------+
SQLRowCount returns 3
3 rows fetched
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">SQL&gt;
</div>

Using DBD::ODBC 1.23 that comes with Ubuntu and the same query
statement, it seems that the columns that have long names return empty
results...

mini-ubuntu ~ % perl -I/usr/lib/perl5 ./getlog.pl
DBD::ODBC::VERSION = 1.23
VU2RAK, N6ML, , , 2009-09-01 15:29:23
VU2PAI, N6ML, , , 2010-03-09 16:50:52
VU2NKS, N6ML, , , 2010-08-21 20:38:22
mini-ubuntu ~ % 


Using the latest SVN version is even worse - all fields are empty after
the first row...

mini-ubuntu ~ % ./getlog.pl                      
DBD::ODBC::VERSION = 1.24_6
VU2RAK, N6ML, , , 2009-09-01 15:29:23
, , , , 
, , , , 
mini-ubuntu ~ % 



Here&#39;s the perl code....


mini-ubuntu ~ % cat getlog.pl
#!/usr/bin/perl

use DBI;
use DBD::ODBC;

printf &#34;DBD::ODBC::VERSION = %s\n&#34;, $DBD::ODBC::VERSION;

my $dbh = DBI-&gt;connect&#40;&#34;dbi:ODBC:dxkmega&#34;&#41; or die &#34;$DBI::errstr\n&#34;;

my $sql = qq/select
Call,STATION_CALLSIGN,APP_DXKEEPER_LOTW_QSL_Rcvd,APP_DXKEEPER_EQSL_QSLSDATE,QSO_End
from QSOs where DXCCID = &#39;324&#39;/;

my $sth = $dbh-&gt;prepare&#40;$sql&#41;;
$sth-&gt;execute&#40;&#41;;

$sth-&gt;{RaiseError} = 1;
my $rows = [];
while&#40;my $row = &#40;shift&#40;@$rows&#41; ||
shift&#40;@{$rows=$sth-&gt;fetchall_arrayref&#40;undef,1&#41;||[]}&#41;&#41;&#41; {
    print join&#40;&#34;, &#34;, @{$row}&#41;, &#34;\n&#34;;
}

mini-ubuntu ~ % 


Perl is v5.10.1 that comes with Ubuntu 10.4.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834773" href="/Public/Bug/Display.html?id=61537#txn-834773">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;03:55:55&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/834773/432420/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432420">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Sep 21 18:10:14 2010, dseven wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I seem to have several problems accessing an MDB through unixODBC -&gt;
&gt; mdbtools on Ubuntu 10.4. Everything looks OK using unixODBC&#39;s &#34;isql&#34;
&gt; utility, but various problems occur through DBD::ODBC.
&gt; 
&gt; Picking one I can&#39;t find a workaround for as a starting point....
&gt; 
&gt; This query looks fine in isql:
&gt; 
<div class="message-stanza open">&gt; SQL&gt; select
</div>&gt;
</div>Call,STATION_CALLSIGN,APP_DXKEEPER_LOTW_QSL_Rcvd,APP_DXKEEPER_EQSL_QSLSDATE,QSO_End
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; from QSOs where DXCCID = &#39;324&#39;
&gt; +---------------------------+---------------------------
&gt; +---------------------------+---------------------------
&gt; +---------------------+
&gt; | Call                      | STATION_CALLSIGN          |
&gt; APP_DXKEEPER_LOTW_QSL_Rcvd| APP_DXKEEPER_EQSL_QSLSDATE| QSO_End
&gt;     |
&gt; +---------------------------+---------------------------
&gt; +---------------------------+---------------------------
&gt; +---------------------+
&gt; | VU2RAK                    | N6ML                      | R
&gt;             | 2009-09-01 00:00:00       | 2009-09-01 15:29:23 |
&gt; | VU2PAI                    | N6ML                      | R
&gt;             | 2010-03-10 00:00:00       | 2010-03-09 16:50:52 |
&gt; | VU2NKS                    | N6ML                      | Y
&gt;             | 2010-08-22 00:00:00       | 2010-08-21 20:38:22 |
&gt; +---------------------------+---------------------------
&gt; +---------------------------+---------------------------
&gt; +---------------------+
&gt; SQLRowCount returns 3
&gt; 3 rows fetched
<div class="message-stanza open">&gt; SQL&gt;
</div>&gt; 
&gt; 
&gt; Using DBD::ODBC 1.23 that comes with Ubuntu and the same query
&gt; statement, it seems that the columns that have long names return empty
&gt; results...
&gt; 
&gt; mini-ubuntu ~ % perl -I/usr/lib/perl5 ./getlog.pl
&gt; DBD::ODBC::VERSION = 1.23
&gt; VU2RAK, N6ML, , , 2009-09-01 15:29:23
&gt; VU2PAI, N6ML, , , 2010-03-09 16:50:52
&gt; VU2NKS, N6ML, , , 2010-08-21 20:38:22
&gt; mini-ubuntu ~ %
&gt; 
&gt; 
&gt; Using the latest SVN version is even worse - all fields are empty
&gt; after
&gt; the first row...
&gt; 
&gt; mini-ubuntu ~ % ./getlog.pl
&gt; DBD::ODBC::VERSION = 1.24_6
&gt; VU2RAK, N6ML, , , 2009-09-01 15:29:23
&gt; , , , ,
&gt; , , , ,
&gt; mini-ubuntu ~ %
&gt; 
&gt; 
&gt; 
&gt; Here&#39;s the perl code....
&gt; 
&gt; 
&gt; mini-ubuntu ~ % cat getlog.pl
&gt; #!/usr/bin/perl
&gt; 
&gt; use DBI;
&gt; use DBD::ODBC;
&gt; 
&gt; printf &#34;DBD::ODBC::VERSION = %s\n&#34;, $DBD::ODBC::VERSION;
&gt; 
&gt; my $dbh = DBI-&gt;connect&#40;&#34;dbi:ODBC:dxkmega&#34;&#41; or die &#34;$DBI::errstr\n&#34;;
&gt; 
&gt; my $sql = qq/select
&gt;
</div>Call,STATION_CALLSIGN,APP_DXKEEPER_LOTW_QSL_Rcvd,APP_DXKEEPER_EQSL_QSLSDATE,QSO_End
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; from QSOs where DXCCID = &#39;324&#39;/;
&gt; 
&gt; my $sth = $dbh-&gt;prepare&#40;$sql&#41;;
&gt; $sth-&gt;execute&#40;&#41;;
&gt; 
&gt; $sth-&gt;{RaiseError} = 1;
&gt; my $rows = [];
&gt; while&#40;my $row = &#40;shift&#40;@$rows&#41; ||
&gt; shift&#40;@{$rows=$sth-&gt;fetchall_arrayref&#40;undef,1&#41;||[]}&#41;&#41;&#41; {
&gt;     print join&#40;&#34;, &#34;, @{$row}&#41;, &#34;\n&#34;;
&gt; }
&gt; 
&gt; mini-ubuntu ~ %
&gt; 
&gt; 
&gt; Perl is v5.10.1 that comes with Ubuntu 10.4.
&gt; 
&gt; 
</div>
mdbtools is notoriously bad as an ODBC driver and I believe has not been
updated since 2004. All the same I&#39;ll look into it if you can provide
some further information. Please run your test script again but make the
following changes first:

1. add the following to your odbcinst.ini file &#40;run odbcinst -j to
locate it&#41;:

[ODBC]
Trace           = Yes
TraceFile               = /tmp/unixodbc.log

2. set DBI_TRACE=15=x.log environment variable.

This should produce /tmp/unixodbc.log and an x.log file in the current
working directory. Can you send those to me.

I suspect this is a unicode issue. Is you DBD::ODBC built with unicode
support &#40;i.e., did you put -u on the command line when building it and
does
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~mjevans/DBD-ODBC-1.24/ODBC.pm#odbc_has_unicode">http://search.cpan.org/~mjevans/DBD-ODBC-1.24/ODBC.pm#odbc_has_unicode</a></span>
odbc_has_unicode return 1?

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834776" href="/Public/Bug/Display.html?id=61537#txn-834776">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;03:55:56&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834928" href="/Public/Bug/Display.html?id=61537#txn-834928">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;12:38:09&nbsp;2010</span>
    <span class="description">bitcard [...] dseven.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] dseven.org</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/834928/432504/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432504">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 03:55:55 2010, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Sep 21 18:10:14 2010, dseven wrote:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; mdbtools is notoriously bad as an ODBC driver and I believe has not
&gt; been updated since 2004.
</div>
If you have a recommendation for an alternative that&#39;s not expensive and
will work in a cygwin environment as well as on Linux &#40;ultimate goal is
to be able to run this on the Windows box with the application that
generates the MDB&#41;, I&#39;ll take a look. I have other issues with
DBI/DBD::ODBC in the cygwin environment, but will explore those later,
if I can get something working on Linux.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; All the same I&#39;ll look into it if you can provide
&gt; some further information. Please run your test script again but make
&gt; the
&gt; following changes first:
&gt; 
&gt; 1. add the following to your odbcinst.ini file &#40;run odbcinst -j to
&gt; locate it&#41;:
&gt; 
&gt; [ODBC]
&gt; Trace           = Yes
&gt; TraceFile               = /tmp/unixodbc.log
&gt; 
&gt; 2. set DBI_TRACE=15=x.log environment variable.
&gt; 
&gt; This should produce /tmp/unixodbc.log and an x.log file in the current
&gt; working directory. Can you send those to me.
</div>
OK, produced two pairs - one with Ubuntu&#39;s 1.23 and one with 1.24_6 that
I built from source. Also included a mini-version of the MDB, if you
want to try to reproduce, in the attached ZIP.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I suspect this is a unicode issue. Is you DBD::ODBC built with unicode
&gt; support &#40;i.e., did you put -u on the command line when building it and
&gt; does odbc_has_unicode return 1?
</div>
It returns 0 with both versions. I rebuilt 1.24_6 with unicode, but it
doesn&#39;t appear to make any difference, other than the additional warning
about max column name length being pegged...

DBD::ODBC::VERSION = 1.24_6
DBD::ODBC::dr connect warning: Max column name length pegged at 512 at
/usr/lib/perl5/DBI.pm line 653.
odbc_has_unicode = 1
VU2NKS, N6ML, , , 2010-08-21 20:38:22
, , , , 
, , , , 


BTW, I also noticed that in the 1.24_6 case, the second and third rows
are not completely empty, but are producing unprintable characters
matching the length of the data... as seen through &#39;less&#39;...

VU2NKS, N6ML, , , 2010-08-21 20:38:22
^@^@^@^@^@^@, ^@^@^@^@, , , ^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@
^@^@^@^@^@^@, ^@^@^@^@, , , ^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@

The columns with the long names are still empty, though.

Thanks for taking a look....
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 61537.zip</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/834928/432505/61537.zip">Download 61537.zip</a><br />
<span class="downloadcontenttype">application/zip 35.6k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834943" href="/Public/Bug/Display.html?id=61537#txn-834943">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;12:47:59&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/834943/432513/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432513">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 12:38:09 2010, dseven wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Sep 22 03:55:55 2010, MJEVANS wrote:
<div class="message-stanza open">&gt; &gt; On Tue Sep 21 18:10:14 2010, dseven wrote:
</div>&gt; 
<div class="message-stanza open">&gt; &gt; mdbtools is notoriously bad as an ODBC driver and I believe has not
&gt; &gt; been updated since 2004.
</div>&gt; 
&gt; If you have a recommendation for an alternative that&#39;s not expensive and
&gt; will work in a cygwin environment as well as on Linux &#40;ultimate goal is
&gt; to be able to run this on the Windows box with the application that
&gt; generates the MDB&#41;, I&#39;ll take a look. I have other issues with
&gt; DBI/DBD::ODBC in the cygwin environment, but will explore those later,
&gt; if I can get something working on Linux.
</div>
I would recommend either the Easysoft MS Access ODBC driver &#40;works on
Linux and other Unix platforms&#41;
&#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.easysoft.com/products/data_access/odbc-access-driver/index.html">http://www.easysoft.com/products/data_access/odbc-access-driver/index.html</a></span>
£475&#41; or the Easysoft ODBC-ODBC Bridge &#40;a generic solution not just for
Access&#41;
&#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.easysoft.com/products/data_access/odbc_odbc_bridge/index.html">http://www.easysoft.com/products/data_access/odbc_odbc_bridge/index.html</a></span> more
expensive&#41;. However, I should tell you I work for Easysoft.

If you used the Easysoft MS Access ODBC driver you can move the MDB to
Linux and use that driver to access it from Linux and the MS ODBC Driver
to access it from Windows/Cygwin.

If you used the ODBC-ODBC Bridge you could use the same product on Linux
and Windows.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; All the same I&#39;ll look into it if you can provide
&gt; &gt; some further information. Please run your test script again but make
&gt; &gt; the
&gt; &gt; following changes first:
&gt; &gt; 
&gt; &gt; 1. add the following to your odbcinst.ini file &#40;run odbcinst -j to
&gt; &gt; locate it&#41;:
&gt; &gt; 
&gt; &gt; [ODBC]
&gt; &gt; Trace           = Yes
&gt; &gt; TraceFile               = /tmp/unixodbc.log
&gt; &gt; 
&gt; &gt; 2. set DBI_TRACE=15=x.log environment variable.
&gt; &gt; 
&gt; &gt; This should produce /tmp/unixodbc.log and an x.log file in the current
&gt; &gt; working directory. Can you send those to me.
</div>&gt; 
&gt; OK, produced two pairs - one with Ubuntu&#39;s 1.23 and one with 1.24_6 that
&gt; I built from source. Also included a mini-version of the MDB, if you
&gt; want to try to reproduce, in the attached ZIP.
</div>
I will try and look at them tonight.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; I suspect this is a unicode issue. Is you DBD::ODBC built with unicode
&gt; &gt; support &#40;i.e., did you put -u on the command line when building it and
&gt; &gt; does odbc_has_unicode return 1?
</div>&gt; 
&gt; It returns 0 with both versions. I rebuilt 1.24_6 with unicode, but it
&gt; doesn&#39;t appear to make any difference, other than the additional warning
&gt; about max column name length being pegged...
</div>
ok, that rules one set of things out. 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; DBD::ODBC::VERSION = 1.24_6
&gt; DBD::ODBC::dr connect warning: Max column name length pegged at 512 at
&gt; /usr/lib/perl5/DBI.pm line 653.
&gt; odbc_has_unicode = 1
&gt; VU2NKS, N6ML, , , 2010-08-21 20:38:22
&gt; , , , , 
&gt; , , , , 
&gt; 
&gt; 
&gt; BTW, I also noticed that in the 1.24_6 case, the second and third rows
&gt; are not completely empty, but are producing unprintable characters
&gt; matching the length of the data... as seen through &#39;less&#39;...
&gt; 
&gt; VU2NKS, N6ML, , , 2010-08-21 20:38:22
&gt; ^@^@^@^@^@^@, ^@^@^@^@, , , ^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@
&gt; ^@^@^@^@^@^@, ^@^@^@^@, , , ^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@
&gt; 
&gt; The columns with the long names are still empty, though.
&gt; 
&gt; Thanks for taking a look....
&gt; 
&gt; 
</div>
I&#39;m not promising anything as I know from experience that the MDB tools
ODBC driver is poor &#40;at best&#41; and I think this will just be the start of
your problems.

Martin 
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-834953" href="/Public/Bug/Display.html?id=61537#txn-834953">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;13:00:03&nbsp;2010</span>
    <span class="description">bitcard [...] dseven.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] dseven.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/834953/432519/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432519">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 12:47:59 2010, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Sep 22 12:38:09 2010, dseven wrote:
<div class="message-stanza open">&gt; &gt; On Wed Sep 22 03:55:55 2010, MJEVANS wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Tue Sep 21 18:10:14 2010, dseven wrote:
</div>&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; mdbtools is notoriously bad as an ODBC driver and I believe has
</div></div>&gt; not
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; been updated since 2004.
</div>&gt; &gt;
&gt; &gt; If you have a recommendation for an alternative that&#39;s not expensive
</div>&gt; and
<div class="message-stanza open">&gt; &gt; will work in a cygwin environment as well as on Linux &#40;ultimate goal
</div>&gt; is
<div class="message-stanza open">&gt; &gt; to be able to run this on the Windows box with the application that
&gt; &gt; generates the MDB&#41;, I&#39;ll take a look. I have other issues with
&gt; &gt; DBI/DBD::ODBC in the cygwin environment, but will explore those
</div>&gt; later,
<div class="message-stanza open">&gt; &gt; if I can get something working on Linux.
</div>&gt; 
&gt; I would recommend either the Easysoft MS Access ODBC driver &#40;works on
&gt; Linux and other Unix platforms&#41;
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.easysoft.com/products/data_access/odbc-access-">http://www.easysoft.com/products/data_access/odbc-access-</a></span>
&gt; driver/index.html
&gt; £475&#41; or the Easysoft ODBC-ODBC Bridge &#40;a generic solution not just
&gt; for
&gt; Access&#41;
&gt; &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://www.easysoft.com/products/data_access/odbc_odbc_bridge/index.html">http://www.easysoft.com/products/data_access/odbc_odbc_bridge/index.html</a></span>
&gt; more
&gt; expensive&#41;. However, I should tell you I work for Easysoft.
</div>
Heh. OK. £475 is at least an order of magnitude more than I&#39;d be willing
to pay, as this is for a hobby application. My current solution involves
exporting the database to a flat file, and then parsing that file with
the perl code. It&#39;d be nice to not have to go through the export step
every time, but not worth that much! :&#41;

It would be interesting to at least know if my script produces good
output against the database I included, if you use your driver instead
of mdbtools. If so, we can blame mdbtools, and I&#39;ll have to live with it.

Cheers,

    ~Iain
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-835003" href="/Public/Bug/Display.html?id=61537#txn-835003">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;13:45:50&nbsp;2010</span>
    <span class="description">bitcard [...] dseven.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> cpan [...] dseven.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/835003/432544/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432544">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 872b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
I found this github repo where they&#39;ve been applying patches to mdbtools
recently... <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/brianb/mdbtools">http://github.com/brianb/mdbtools</a></span>

This version seems to fix the long-column-name problem!

But the problem with the second and third rows bring unprintable with
1.24_6 persists. I think that&#39;s a new bug in 1.24_x.... 

mini-ubuntu ~ % perl -I/usr/lib/perl5 ./getlog.pl
DBD::ODBC::VERSION = 1.23
odbc_has_unicode = 0
VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52
mini-ubuntu ~ % ./getlog.pl                      
DBD::ODBC::VERSION = 1.24_6
DBD::ODBC::dr connect warning: Max column name length pegged at 512 at
/usr/lib/perl5/DBI.pm line 653.
odbc_has_unicode = 1
VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
, , , , 
, , , , 
mini-ubuntu ~ % 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-835006" href="/Public/Bug/Display.html?id=61537#txn-835006">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;13:46:15&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/835006/432547/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432547">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 781b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 13:00:03 2010, dseven wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It would be interesting to at least know if my script produces good
&gt; output against the database I included, if you use your driver instead
&gt; of mdbtools. If so, we can blame mdbtools, and I&#39;ll have to live with it.
</div>

martin@bragi:~/svn/dbd-odbc/trunk/rt_data/rt61537$ perl script.pl
DBD::ODBC::VERSION = 1.26_1
VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52

Worked ok with our driver.

I know it looks like I&#39;ve got a newer DBD::ODBC but it is actually 1.25
&#40;released this morning&#41; but the version changed to 1.26_1 for work I&#39;m
about to do &#40;so it is 1.25 really&#41;.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-835012" href="/Public/Bug/Display.html?id=61537#txn-835012">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;13:57:02&nbsp;2010</span>
    <span class="description">bitcard [...] dseven.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] dseven.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/835012/432552/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432552">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 13:46:15 2010, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Sep 22 13:00:03 2010, dseven wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; It would be interesting to at least know if my script produces good
&gt; &gt; output against the database I included, if you use your driver instead
&gt; &gt; of mdbtools. If so, we can blame mdbtools, and I&#39;ll have to live
</div></div>with it.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 
&gt; martin@bragi:~/svn/dbd-odbc/trunk/rt_data/rt61537$ perl script.pl
&gt; DBD::ODBC::VERSION = 1.26_1
&gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
&gt; VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52
&gt; 
&gt; Worked ok with our driver.
&gt; 
&gt; I know it looks like I&#39;ve got a newer DBD::ODBC but it is actually 1.25
&gt; &#40;released this morning&#41; but the version changed to 1.26_1 for work I&#39;m
&gt; about to do &#40;so it is 1.25 really&#41;.
</div>
Hmm, curious... I still have the unprintable problem with 1.26_1, but
not with 1.23...

mini-ubuntu ~ % perl -I/usr/lib/perl5 ./getlog.pl 
DBD::ODBC::VERSION = 1.23
odbc_has_unicode = 0
VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52
mini-ubuntu ~ % perl ./getlog.pl 
DBD::ODBC::VERSION = 1.26_1
DBD::ODBC::dr connect warning: Max column name length pegged at 512 at
/usr/lib/perl5/DBI.pm line 653.
odbc_has_unicode = 1
VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
, , , , 
, , , , 
mini-ubuntu ~ % 


BTW, is there a way to make that &#34;max column name length&#34; warning go away ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-835015" href="/Public/Bug/Display.html?id=61537#txn-835015">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;14:16:23&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/835015/432555/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432555">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 13:57:02 2010, dseven wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Sep 22 13:46:15 2010, MJEVANS wrote:
<div class="message-stanza open">&gt; &gt; On Wed Sep 22 13:00:03 2010, dseven wrote:
&gt; &gt; 
<div class="message-stanza open">&gt; &gt; &gt; It would be interesting to at least know if my script produces good
&gt; &gt; &gt; output against the database I included, if you use your driver instead
&gt; &gt; &gt; of mdbtools. If so, we can blame mdbtools, and I&#39;ll have to live
</div></div>&gt; with it.
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; 
&gt; &gt; martin@bragi:~/svn/dbd-odbc/trunk/rt_data/rt61537$ perl script.pl
&gt; &gt; DBD::ODBC::VERSION = 1.26_1
&gt; &gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; &gt; VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
&gt; &gt; VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52
&gt; &gt; 
&gt; &gt; Worked ok with our driver.
&gt; &gt; 
&gt; &gt; I know it looks like I&#39;ve got a newer DBD::ODBC but it is actually 1.25
&gt; &gt; &#40;released this morning&#41; but the version changed to 1.26_1 for work I&#39;m
&gt; &gt; about to do &#40;so it is 1.25 really&#41;.
</div>&gt; 
&gt; Hmm, curious... I still have the unprintable problem with 1.26_1, but
&gt; not with 1.23...
&gt; 
&gt; mini-ubuntu ~ % perl -I/usr/lib/perl5 ./getlog.pl 
&gt; DBD::ODBC::VERSION = 1.23
&gt; odbc_has_unicode = 0
&gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
&gt; VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52
&gt; mini-ubuntu ~ % perl ./getlog.pl 
&gt; DBD::ODBC::VERSION = 1.26_1
&gt; DBD::ODBC::dr connect warning: Max column name length pegged at 512 at
&gt; /usr/lib/perl5/DBI.pm line 653.
&gt; odbc_has_unicode = 1
&gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; , , , , 
&gt; , , , , 
&gt; mini-ubuntu ~ % 
&gt; 
&gt; 
&gt; BTW, is there a way to make that &#34;max column name length&#34; warning go
</div>away ?
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 
</div>
You are comparing apples with pears as one is built with unicode and one
is not. I doubt mdbtools will do unicode.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-835018" href="/Public/Bug/Display.html?id=61537#txn-835018">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;14:27:33&nbsp;2010</span>
    <span class="description">bitcard [...] dseven.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] dseven.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/835018/432558/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432558">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 14:16:23 2010, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Sep 22 13:57:02 2010, dseven wrote:
<div class="message-stanza open">&gt; &gt; On Wed Sep 22 13:46:15 2010, MJEVANS wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Wed Sep 22 13:00:03 2010, dseven wrote:
&gt; &gt; &gt; 
<div class="message-stanza open">&gt; &gt; &gt; &gt; It would be interesting to at least know if my script produces good
&gt; &gt; &gt; &gt; output against the database I included, if you use your driver
</div></div></div></div>instead
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; of mdbtools. If so, we can blame mdbtools, and I&#39;ll have to live
</div></div>&gt; &gt; with it.
<div class="message-stanza open">&gt; &gt; &gt; 
&gt; &gt; &gt; 
&gt; &gt; &gt; martin@bragi:~/svn/dbd-odbc/trunk/rt_data/rt61537$ perl script.pl
&gt; &gt; &gt; DBD::ODBC::VERSION = 1.26_1
&gt; &gt; &gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; &gt; &gt; VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
&gt; &gt; &gt; VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52
&gt; &gt; &gt; 
&gt; &gt; &gt; Worked ok with our driver.
&gt; &gt; &gt; 
&gt; &gt; &gt; I know it looks like I&#39;ve got a newer DBD::ODBC but it is actually
</div></div></div>1.25
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &#40;released this morning&#41; but the version changed to 1.26_1 for work I&#39;m
&gt; &gt; &gt; about to do &#40;so it is 1.25 really&#41;.
</div>&gt; &gt; 
&gt; &gt; Hmm, curious... I still have the unprintable problem with 1.26_1, but
&gt; &gt; not with 1.23...
&gt; &gt; 
&gt; &gt; mini-ubuntu ~ % perl -I/usr/lib/perl5 ./getlog.pl 
&gt; &gt; DBD::ODBC::VERSION = 1.23
&gt; &gt; odbc_has_unicode = 0
&gt; &gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; &gt; VU2RAK, N6ML, R, 2009-09-01 00:00:00, 2009-09-01 15:29:23
&gt; &gt; VU2PAI, N6ML, R, 2010-03-10 00:00:00, 2010-03-09 16:50:52
&gt; &gt; mini-ubuntu ~ % perl ./getlog.pl 
&gt; &gt; DBD::ODBC::VERSION = 1.26_1
&gt; &gt; DBD::ODBC::dr connect warning: Max column name length pegged at 512 at
&gt; &gt; /usr/lib/perl5/DBI.pm line 653.
&gt; &gt; odbc_has_unicode = 1
&gt; &gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; &gt; , , , , 
&gt; &gt; , , , , 
&gt; &gt; mini-ubuntu ~ % 
&gt; &gt; 
&gt; &gt; 
&gt; &gt; BTW, is there a way to make that &#34;max column name length&#34; warning go
</div>&gt; away ?
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; 
</div>&gt; 
&gt; You are comparing apples with pears as one is built with unicode and one
&gt; is not. I doubt mdbtools will do unicode.
</div>
Yeah but I had this problem before I went down the unicode path, and
still do...

mini-ubuntu ~ % ./getlog.pl
DBD::ODBC::VERSION = 1.26_1
odbc_has_unicode = 0
VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
, , , , 
, , , , 
mini-ubuntu ~ % 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-835593" href="/Public/Bug/Display.html?id=61537#txn-835593">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;24&nbsp;03:59:43&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/835593/432854/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432854">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 474b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 22 14:27:33 2010, dseven wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yeah but I had this problem before I went down the unicode path, and
&gt; still do...
&gt; 
&gt; mini-ubuntu ~ % ./getlog.pl
&gt; DBD::ODBC::VERSION = 1.26_1
&gt; odbc_has_unicode = 0
&gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; , , , , 
&gt; , , , , 
&gt; mini-ubuntu ~ % 
&gt; 
&gt; 
</div>
Just to let you know I&#39;ve reproduced your situation now and will look
into it as soon as I can find some time.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-835601" href="/Public/Bug/Display.html?id=61537#txn-835601">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;24&nbsp;05:33:40&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/835601/432860/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/432860">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 24 03:59:43 2010, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Sep 22 14:27:33 2010, dseven wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; Yeah but I had this problem before I went down the unicode path, and
&gt; &gt; still do...
&gt; &gt; 
&gt; &gt; mini-ubuntu ~ % ./getlog.pl
&gt; &gt; DBD::ODBC::VERSION = 1.26_1
&gt; &gt; odbc_has_unicode = 0
&gt; &gt; VU2NKS, N6ML, Y, 2010-08-22 00:00:00, 2010-08-21 20:38:22
&gt; &gt; , , , , 
&gt; &gt; , , , , 
&gt; &gt; mini-ubuntu ~ % 
&gt; &gt; 
&gt; &gt; 
</div>&gt; 
&gt; Just to let you know I&#39;ve reproduced your situation now and will look
&gt; into it as soon as I can find some time.
&gt; 
&gt; Martin
</div>
I&#39;ve had a quick look at this and there are a number of things wrong
with mdbtools:

1. When you call SQLDriverConnect it fails to set the out connection
string and out connection string length - this is a bug and can lead in
DBD::ODBC to:

panic: sv_setpvn called with negative strlen at blib/lib/DBD/ODBC.pm
line 107.

I have worked around it for now.

2. When you call SQLDescribeCol to return the column information it
always returns 0 for the length of the column name and then the first
chr only of the column name. This does not happen in isql because isql
uses SQLColAttribute SQL_DESC_LABEL. This is another bug in mdbtools
which should support SQLDescribeCol properly and I&#39;m not going to change
DBD::ODBC because calling SQLDescribeCol instead of multiple
SQLColAttribute calls save a lot of time.

3. The data is returned in isql because it uses SQLGetData but DBD::ODBC
binds the column data with SQLBindCol. It would seem mdbtools does not
support rebinding columns after a row is fetched. The fact it works in
1.23 is a fluke.

Sorry, but as I said, mdbtools is rather buggy and I&#39;m not going to
spoil DBD::ODBC by adding a load of workarounds for a basically broken
driver.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-847895" href="/Public/Bug/Display.html?id=61537#txn-847895">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;27&nbsp;05:21:50&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.66551</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
