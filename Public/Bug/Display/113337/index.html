<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #113337 for Win32-SerialPort: Does not work on 64-bit Windows</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #113337 for Win32-SerialPort: Does not work on 64-bit Windows</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Win32-SerialPort/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Win32-SerialPort/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Win32-SerialPort/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Win32-SerialPort/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-SerialPort">Win32-SerialPort CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">113337</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Win32-SerialPort/Active/">Win32-SerialPort</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
SACAVILIA [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35762-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35763-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;11:35:01&nbsp;2016</span>
    <span class="description">SACAVILIA [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Does not work on 64-bit Windows</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This module does not seem to work on 64-bit Windows at all. Some tests fail during install, and reading or writing data does not work &#40;ports seem to open fine though&#41;. Looking at CPAN testers, all 64-bit targets are currently failing and most 32-bit targets pass.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;12:59:56&nbsp;2016</span>
    <span class="description">Bbirthisel [...] aol.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113337] Does not work on 64-bit Windows</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 25 Mar 2016 12:59:45 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-win32-serialport [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Bbirthisel &lt;bbirthisel [...] aol.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
This module was designed to work with the 32-bit serial driver in the OS. The 64-bit driver is much different and would require a total rewrite. Also, most 64-bit Windows machines do not have serial ports - so there is very little demand.


Those needing this functionality have installed a 32-bit perl &#40;with something like the Strawberry portable distribution, both 32 and 64 bit perls can be installed in parallel&#41;.

-bill


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Stephen A Cavilia via RT &lt;bug-Win32-SerialPort@rt.cpan.org&gt;
To: undisclosed-recipients:;
Sent: Fri, Mar 25, 2016 11:35 am
Subject: [rt.cpan.org #113337] Does not work on 64-bit Windows

Fri Mar 25 11:35:01 2016: Request 113337 was acted upon.
Transaction: Ticket created by SACAVILIA
       Queue: Win32-SerialPort
     Subject: Does not work on 64-bit Windows
   Broken in: &#40;no value&#41;
    Severity: &#40;no value&#41;
     Owner: Nobody
  Requestors: SACAVILIA@cpan.org
      Status: new
 Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113337">https://rt.cpan.org/Ticket/Display.html?id=113337</a></span> &gt;


This module does not seem to work on 64-bit Windows at all. Some tests fail during install, and reading or writing data does not work &#40;ports seem to open fine though&#41;. Looking at CPAN testers, all 64-bit targets are currently failing and most 32-bit targets pass.
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;12:59:57&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;25&nbsp;14:53:44&nbsp;2016</span>
    <span class="description">SACAVILIA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Virtually all machines being sold are 64-bit now, and OEMs have finally started putting 64-bit OS installs on them &#40;even with EFI! now&#41; &#40;legacy software from silly Windows-based developers who haven&#39;t caught up is the only reason modern processors spend any time in 32-bit mode&#41;, and serial-port-based equipment still exists, so of course there are plenty of Windows systems with serial ports. I can run a 32-bit Perl when I&#39;m stuck on Windows platforms but am looking for a more long term solution to eventually be able to move out of the dark ages.

But anyway, what&#39;s different about the 64-bit serial port API? I&#39;ve worked with C/C++-based software in Windows using serial ports before and have never needed to rewrite any code when switching between 32- and 64-bit compilers. Do you know if the changes have to be made in Win32::SerialPort/Win32API::CommPort or inside Win32::API?

On Fri Mar 25 12:59:56 2016, Bbirthisel@aol.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; This module was designed to work with the 32-bit serial driver in the
&gt; OS. The 64-bit driver is much different and would require a total
&gt; rewrite. Also, most 64-bit Windows machines do not have serial ports -
&gt; so there is very little demand.
&gt; 
&gt; 
&gt; Those needing this functionality have installed a 32-bit perl &#40;with
&gt; something like the Strawberry portable distribution, both 32 and 64
&gt; bit perls can be installed in parallel&#41;.
&gt; 
&gt; -bill
&gt; 
&gt; 
&gt; -----Original Message-----
&gt; From: Stephen A Cavilia via RT &lt;bug-Win32-SerialPort@rt.cpan.org&gt;
&gt; To: undisclosed-recipients:;
&gt; Sent: Fri, Mar 25, 2016 11:35 am
&gt; Subject: [rt.cpan.org #113337] Does not work on 64-bit Windows
&gt; 
&gt; Fri Mar 25 11:35:01 2016: Request 113337 was acted upon.
&gt; Transaction: Ticket created by SACAVILIA
&gt;        Queue: Win32-SerialPort
&gt;      Subject: Does not work on 64-bit Windows
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: &#40;no value&#41;
&gt;      Owner: Nobody
&gt;   Requestors: SACAVILIA@cpan.org
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113337">https://rt.cpan.org/Ticket/Display.html?id=113337</a></span> &gt;
&gt; 
&gt; 
&gt; This module does not seem to work on 64-bit Windows at all. Some tests
&gt; fail during install, and reading or writing data does not work &#40;ports
&gt; seem to open fine though&#41;. Looking at CPAN testers, all 64-bit targets
&gt; are currently failing and most 32-bit targets pass.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;26&nbsp;13:42:41&nbsp;2016</span>
    <span class="description">Bbirthisel [...] aol.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113337] Does not work on 64-bit Windows</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 26 Mar 2016 13:42:16 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-SerialPort [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Bill Birthisel &lt;bbirthisel [...] aol.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Stephen,

Almost all the work involved would be inside Win32::CommPort. Win32::API 
was updated to handle 64-bit stack frames &#40;for driver-specific calls&#41; a 
while back. I have not determined whether the easiest approach is to add 
changes to Win32::CommPort or to create a separate Win64::CommPort. If 
everything goes into Win32::Commport, then Win32::SerialPort, the test 
suite, and the example code would probably need no changes. There are 
two good reasons it hasn&#39;t been done:

1. I don&#39;t have time. I&#39;m already overbooked through most of the rest of 
this year.

2. I don&#39;t have a 64-bit Windows machine at home. I have access to one 
at work - but I doubt my boss would like me to do a lot of unrelated 
development work on it.

You are welcome to investigate porting it to 64-bit on your own. You 
might even find others interested in helping. And I could try to answer 
questions. It would be nice to maintain script compatibility with 
Device::SerialPort &#40;the un*x and MAC equivalent&#41;  at the top level though.

-bill

On 03/25/2016 02:53 PM, Stephen A Cavilia via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         Queue: Win32-SerialPort
&gt;   Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113337">https://rt.cpan.org/Ticket/Display.html?id=113337</a></span> &gt;
&gt;
&gt; Virtually all machines being sold are 64-bit now, and OEMs have finally started putting 64-bit OS installs on them &#40;even with EFI! now&#41; &#40;legacy software from silly Windows-based developers who haven&#39;t caught up is the only reason modern processors spend any time in 32-bit mode&#41;, and serial-port-based equipment still exists, so of course there are plenty of Windows systems with serial ports. I can run a 32-bit Perl when I&#39;m stuck on Windows platforms but am looking for a more long term solution to eventually be able to move out of the dark ages.
&gt;
&gt; But anyway, what&#39;s different about the 64-bit serial port API? I&#39;ve worked with C/C++-based software in Windows using serial ports before and have never needed to rewrite any code when switching between 32- and 64-bit compilers. Do you know if the changes have to be made in Win32::SerialPort/Win32API::CommPort or inside Win32::API?
&gt;
&gt; On Fri Mar 25 12:59:56 2016, Bbirthisel@aol.com wrote:
<div class="message-stanza open">&gt;&gt; This module was designed to work with the 32-bit serial driver in the
&gt;&gt; OS. The 64-bit driver is much different and would require a total
&gt;&gt; rewrite. Also, most 64-bit Windows machines do not have serial ports -
&gt;&gt; so there is very little demand.
&gt;&gt;
&gt;&gt;
&gt;&gt; Those needing this functionality have installed a 32-bit perl &#40;with
&gt;&gt; something like the Strawberry portable distribution, both 32 and 64
&gt;&gt; bit perls can be installed in parallel&#41;.
&gt;&gt;
&gt;&gt; -bill
&gt;&gt;
&gt;&gt;
&gt;&gt; -----Original Message-----
&gt;&gt; From: Stephen A Cavilia via RT &lt;bug-Win32-SerialPort@rt.cpan.org&gt;
&gt;&gt; To: undisclosed-recipients:;
&gt;&gt; Sent: Fri, Mar 25, 2016 11:35 am
&gt;&gt; Subject: [rt.cpan.org #113337] Does not work on 64-bit Windows
&gt;&gt;
&gt;&gt; Fri Mar 25 11:35:01 2016: Request 113337 was acted upon.
&gt;&gt; Transaction: Ticket created by SACAVILIA
&gt;&gt;         Queue: Win32-SerialPort
&gt;&gt;       Subject: Does not work on 64-bit Windows
&gt;&gt;     Broken in: &#40;no value&#41;
&gt;&gt;      Severity: &#40;no value&#41;
&gt;&gt;       Owner: Nobody
&gt;&gt;    Requestors: SACAVILIA@cpan.org
&gt;&gt;        Status: new
&gt;&gt;   Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113337">https://rt.cpan.org/Ticket/Display.html?id=113337</a></span> &gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; This module does not seem to work on 64-bit Windows at all. Some tests
&gt;&gt; fail during install, and reading or writing data does not work &#40;ports
&gt;&gt; seem to open fine though&#41;. Looking at CPAN testers, all 64-bit targets
&gt;&gt; are currently failing and most 32-bit targets pass.
</div>&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;19&nbsp;19:31:25&nbsp;2016</span>
    <span class="description">Christopher.Oicles [...] amd.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113337] Does not work on 64-bit Windows</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 20 Dec 2016 00:31:03 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-SerialPort [...] rt.cpan.org&#34; &lt;bug-Win32-SerialPort [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Oicles, Christopher&#34; &lt;Christopher.Oicles [...] amd.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The only problem with this module on 64-bit windows is the layout of the OVERLAPPED struct.  The 32-bit version of this struct has a size of 20 bytes, but the 64-bit version is 32 bytes, because the fields &#34;Internal&#34;, &#34;InternalHigh&#34; and &#34;hEvent&#34; are all quadwords instead of doublewords &#40;&#34;Pointer&#34; also becomes a quadword, but it is part of a union which is quadword-sized in both 32- and 64-bit versions, and it is not used in Win32API::CommPort&#41;.

The fix is trivial, and allows both bitnesses to share the same Perl Module.  Here are the edits I made to CommPort.pm which got it working:

Line 467
Original:
    my $OVERLAPPEDformat=&#34;LLLLL&#34;;
Edited:
    my $OVERLAPPEDformat = &#40;length pack &#39;P&#39;&#41; * 8 == 32 ? &#34;LLLLL&#34; : &#34;QQLLQ&#34;;
    # &#34;length pack &#39;P&#39;&#34; gives you the size of a null pointer, then I multiply by 8 to get a bit count, just for clarity.

Lines 768 and 769
Original:
    $self-&gt;{&#34;_R_OVERLAP&#34;}            = &#34; &#34;x24;
    $self-&gt;{&#34;_W_OVERLAP&#34;}          = &#34; &#34;x24;
Edited:
    $self-&gt;{&#34;_R_OVERLAP&#34;}            = &#34; &#34;x32;
    $self-&gt;{&#34;_W_OVERLAP&#34;}          = &#34; &#34;x32;

# These lines populate the fields with some default &#40;and invalid&#41; bytes.  It really doesn&#39;t look like over-allocating these by a few bytes can cause problems, so I just unconditionally set these to the 64-bit version of the stuct&#39;s length &#40;but I didn&#39;t test under 32-bit after this change, so someone should verify the exposure&#41;.

And that&#39;s all there is to the 64-bit &#34;port&#34;.  Thank you for providing this module, COM port communication is still relevant in Windows and I could not find any alternatives for use with Perl.

Christopher Oicles
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;19&nbsp;21:34:16&nbsp;2016</span>
    <span class="description">Bbirthisel [...] aol.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113337] Does not work on 64-bit Windows</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 19 Dec 2016 21:33:58 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-SerialPort [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Bbirthisel &lt;bbirthisel [...] aol.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
 I still have some 32-bit Perl installs available &#40;and even a 32-bit Windows or two&#41;. So I&#39;ll try it out. Thanks.

-bill

 

 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Oicles, Christopher via RT &lt;bug-Win32-SerialPort@rt.cpan.org&gt;
To: undisclosed-recipients:;
Sent: Mon, Dec 19, 2016 7:52 pm
Subject: Re: [rt.cpan.org #113337] Does not work on 64-bit Windows

Queue: Win32-SerialPort
 Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113337">https://rt.cpan.org/Ticket/Display.html?id=113337</a></span> &gt;

The only problem with this module on 64-bit windows is the layout of the OVERLAPPED struct.  The 32-bit version of this struct has a size of 20 bytes, but the 64-bit version is 32 bytes, because the fields &#34;Internal&#34;, &#34;InternalHigh&#34; and &#34;hEvent&#34; are all quadwords instead of doublewords &#40;&#34;Pointer&#34; also becomes a quadword, but it is part of a union which is quadword-sized in both 32- and 64-bit versions, and it is not used in Win32API::CommPort&#41;.

The fix is trivial, and allows both bitnesses to share the same Perl Module.  Here are the edits I made to CommPort.pm which got it working:

Line 467
Original:
    my $OVERLAPPEDformat=&#34;LLLLL&#34;;
Edited:
    my $OVERLAPPEDformat = &#40;length pack &#39;P&#39;&#41; * 8 == 32 ? &#34;LLLLL&#34; : &#34;QQLLQ&#34;;
    # &#34;length pack &#39;P&#39;&#34; gives you the size of a null pointer, then I multiply by 8 to get a bit count, just for clarity.

Lines 768 and 769
Original:
    $self-&gt;{&#34;_R_OVERLAP&#34;}            = &#34; &#34;x24;
    $self-&gt;{&#34;_W_OVERLAP&#34;}          = &#34; &#34;x24;
Edited:
    $self-&gt;{&#34;_R_OVERLAP&#34;}            = &#34; &#34;x32;
    $self-&gt;{&#34;_W_OVERLAP&#34;}          = &#34; &#34;x32;

# These lines populate the fields with some default &#40;and invalid&#41; bytes.  It really doesn&#39;t look like over-allocating these by a few bytes can cause problems, so I just unconditionally set these to the 64-bit version of the stuct&#39;s length &#40;but I didn&#39;t test under 32-bit after this change, so someone should verify the exposure&#41;.

And that&#39;s all there is to the 64-bit &#34;port&#34;.  Thank you for providing this module, COM port communication is still relevant in Windows and I could not find any alternatives for use with Perl.

Christopher Oicles
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
