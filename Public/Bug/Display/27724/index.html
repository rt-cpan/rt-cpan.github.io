<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #27724 for Gtk2: File chooser tests hang</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #27724 for Gtk2: File chooser tests hang</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Gtk2">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Gtk2">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Gtk2">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Gtk2">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Gtk2">Gtk2 CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">27724</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Gtk2">Gtk2</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
djh [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-15134-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.144    </td>
  </tr>
  <tr id="CF-15135-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




dialog.c<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/341109/152938/dialog.c">
Thu Jul 05 16:38:39 2007 (414b) by kaffeetisch [...] gmx.de
</a>
</font></li>
</ul>


env-root<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/340368/152550/env-root">
Tue Jul 03 08:05:42 2007 (4.5k) by dave [...] howorth.org.uk
</a>
</font></li>
</ul>


env-user<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/340368/152551/env-user">
Tue Jul 03 08:05:42 2007 (4.4k) by dave [...] howorth.org.uk
</a>
</font></li>
</ul>


strace.log<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/329202/151225/strace.log">
Mon Jun 25 17:38:40 2007 (101k) by dave [...] howorth.org.uk
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=27724">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-328979" href="/Public/Bug/Display.html?id=27724#txn-328979">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;05:05:49&nbsp;2007</span>
    <span class="description">djh [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Gtk2 fails install tests</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/328979/151117/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/151117">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I just installed Gtk2 1.144 on a Suse 10.2 AMD64 system and had problems
with the FileChooser* tests:

t/GtkEventBox......................ok                                  
     
t/GtkExpander......................ok                                  
     
t/GtkFileChooser...................skipped
        all skipped: unreliable GtkFileChooser test
t/GtkFileChooserButton.............
make: *** wait: No child processes.  Stop.
make: *** Waiting for unfinished jobs....
make: *** wait: No child processes.  Stop.
  TSCH/Gtk2-1.144.tar.gz
  /usr/bin/make test -- NOT OK

GtkFileChooserButton.t just hung. The log shows the result of CTRL-C.
After removing that test, the following two tests also hung:

t/FileChooserDialog.t
t/GtkFileChooserWidget.t

After removing all three, I got another ordinary failure:

t/GtkIconTheme.....................ok
1/16                                   
#   Failed test at t/GtkIconTheme.t line 80.
#          got: &#39;exec&#39;
#     expected: undef
# Looks like you failed 1 test of 16.
t/GtkIconTheme.....................dubious                             
     
        Test returned status 1 &#40;wstat 256, 0x100&#41;
DIED. FAILED test 15

I force-installed the module and it seems to work, though I didn&#39;t try
to use FileChoosers or icons. My test program says versions are as follows:

Module version 1.144
Built for gtk+ 2.10.6
Running with gtk+ 2.10.6

and perl -V says:

Summary of my perl5 &#40;revision 5 version 8 subversion 8&#41; configuration:
  Platform:
    osname=linux, osvers=2.6.18, archname=x86_64-linux-thread-multi
    uname=&#39;linux eisler 2.6.18 #1 smp tue nov 21 12:59:21 utc 2006
x86_64 x86_64 x86_64 gnulinux &#39;
    config_args=&#39;-ds -e -Dprefix=/usr -Dvendorprefix=/usr
-Dinstallusrbinperl -Dusethreads -Di_db -Di_dbm -Di_ndbm -Di_gdbm
-Duseshrplib=true -Doptimize=-O2 -fmessage-length=0 -Wall
-D_FORTIFY_SOURCE=2 -g -Wall -pipe&#39;
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=define use5005threads=undef useithreads=define
usemultiplicity=define
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=define use64bitall=define uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS
-DDEBUGGING -fno-strict-aliasing -pipe -Wdeclaration-after-statement
-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-O2 -fmessage-length=0 -Wall -D_FORTIFY_SOURCE=2 -g -Wall
-pipe&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -DTHREADS_HAVE_PIDS -DDEBUGGING
-fno-strict-aliasing -pipe -Wdeclaration-after-statement&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.1.2 20061115 &#40;prerelease&#41; &#40;SUSE Linux&#41;&#39;,
gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;,
lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39; -L/usr/local/lib64&#39;
    libpth=/lib64 /usr/lib64 /usr/local/lib64
    libs=-lm -ldl -lcrypt -lpthread
    perllibs=-lm -ldl -lcrypt -lpthread
    libc=/lib64/libc-2.5.so, so=so, useshrplib=true, libperl=libperl.so
    gnulibc_version=&#39;2.5&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E
-Wl,-rpath,/usr/lib/perl5/5.8.8/x86_64-linux-thread-multi/CORE&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -L/usr/local/lib64&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: DEBUGGING MULTIPLICITY PERL_IMPLICIT_CONTEXT
                        PERL_MALLOC_WRAP THREADS_HAVE_PIDS
USE_64_BIT_ALL
                        USE_64_BIT_INT USE_ITHREADS USE_LARGE_FILES
                        USE_PERLIO USE_REENTRANT_API
  Built under linux
  Compiled at Nov 25 2006 11:02:03
  %ENV:
    PERL5LIB=&#34;/home/dhoworth/progs/modules&#34;
    PERLDOC_PAGER=&#34;vi&#34;
  @INC:
    /home/dhoworth/progs/modules
    /usr/lib/perl5/5.8.8/x86_64-linux-thread-multi
    /usr/lib/perl5/5.8.8
    /usr/lib/perl5/site_perl/5.8.8/x86_64-linux-thread-multi
    /usr/lib/perl5/site_perl/5.8.8
    /usr/lib/perl5/site_perl
    /usr/lib/perl5/vendor_perl/5.8.8/x86_64-linux-thread-multi
    /usr/lib/perl5/vendor_perl/5.8.8
    /usr/lib/perl5/vendor_perl
    .
Let me know if there&#39;s any other information that would be useful.

BTW, one other annoyance with the install process is that when it finds
missing dependencies, it just stops instead of getting cpan to prepend
them to the list. So I have to type every package name by hand.

Cheers, Dave
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-329191" href="/Public/Bug/Display.html?id=27724#txn-329191">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;16:27:13&nbsp;2007</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> File chooser tests hang</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/329191/151217/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/151217">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 812b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; GtkFileChooserButton.t just hung. The log shows the result of CTRL-C.
&gt; After removing that test, the following two tests also hung:
&gt; 
&gt; t/FileChooserDialog.t
&gt; t/GtkFileChooserWidget.t
</div>
Yeah, the file choose tests are known to be pretty unstable.  I haven&#39;t
seen hangs with the button, dialog, and widget tests though.  Can you
find out where they hang?  You can run the tests manually, after you
installed Gtk2, by simply executing them with perl:

  $ perl t/GtkFileChooserButton.t.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; After removing all three, I got another ordinary failure:
&gt; 
&gt; t/GtkIconTheme.....................ok
&gt; 1/16                                   
&gt; #   Failed test at t/GtkIconTheme.t line 80.
&gt; #          got: &#39;exec&#39;
&gt; #     expected: undef
&gt; # Looks like you failed 1 test of 16.
</div>
This was fixed recently in CVS, I think.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-329192" href="/Public/Bug/Display.html?id=27724#txn-329192">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;16:27:15&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-329195" href="/Public/Bug/Display.html?id=27724#txn-329195">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;16:27:49&nbsp;2007</span>
    <span class="description">kaffeetisch [...] gmx.de -  Subject changed from &#39;Gtk2 fails install tests&#39; to &#39;File chooser tests hang&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-329202" href="/Public/Bug/Display.html?id=27724#txn-329202">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;17:38:40&nbsp;2007</span>
    <span class="description">dave [...] howorth.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #27724] File chooser tests hang</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 25 Jun 2007 22:38:12 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Gtk2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Howorth &lt;dave [...] howorth.org.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/329202/151224/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/151224">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 2007-06-25 at 16:27 -0400, Torsten SchÃ¶nfeld via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=27724">http://rt.cpan.org/Ticket/Display.html?id=27724</a></span> &gt;
&gt; 
<div class="message-stanza open">&gt; &gt; GtkFileChooserButton.t just hung. The log shows the result of CTRL-C.
&gt; &gt; After removing that test, the following two tests also hung:
&gt; &gt; 
&gt; &gt; t/FileChooserDialog.t
&gt; &gt; t/GtkFileChooserWidget.t
</div>&gt; 
&gt; Yeah, the file choose tests are known to be pretty unstable.  I haven&#39;t
&gt; seen hangs with the button, dialog, and widget tests though.  Can you
&gt; find out where they hang?  You can run the tests manually, after you
&gt; installed Gtk2, by simply executing them with perl:
&gt; 
&gt;   $ perl t/GtkFileChooserButton.t.
</div>
There&#39;s not much to go on. I tried perl -d but it hangs after the first
c/n/s command without any output, even with trace on. Looks like the
new&#40;&#41; hangs:

# perl -d GtkFileChooserButton.t

Loading DB routines from perl5db.pl version 1.28
Editor support available.

Enter h or `h h&#39; for help, or `man perldebug&#39; for more help.

1..9
main::&#40;GtkFileChooserButton.t:9&#41;:       my $dialog =
Gtk2::FileChooserDialog -&gt; new&#40;&#34;Urgs&#34;, undef, &#34;open&#34;,
main::&#40;GtkFileChooserButton.t:10&#41;:
&#34;gtk-cancel&#34; =&gt; &#34;cancel&#34;,
main::&#40;GtkFileChooserButton.t:11&#41;:
&#34;gtk-ok&#34; =&gt; &#34;ok&#34;&#41;;

DB&lt;1&gt; s
[kill process]
Terminated


So I did an strace; HTH. Let me know if something else would be helpful.

# strace perl GtkFileChooserButton.t 2&gt; strace.log
1..9

[CTRL-C]

strace.log attached

Cheers, Dave
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/329202/151225/strace.log">Download strace.log</a><br />
<span class="downloadcontenttype">application/x-perl 101k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-340008" href="/Public/Bug/Display.html?id=27724#txn-340008">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;02&nbsp;14:23:05&nbsp;2007</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #27724] File chooser tests hang</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 02 Jul 2007 20:22:39 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Gtk2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Torsten Schoenfeld &lt;kaffeetisch [...] gmx.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/340008/152366/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/152366">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 390b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 2007-06-25 at 17:38 -0400, Dave Howorth via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; strace.log attached
</div>
Hmm, looks like the file chooser is hung in a futex&#40;&#41; call, waiting for
the lock to be released, which apparently never happens in your case.

Can you use any of the file chooser widgets normally in an application?

Can you try to come up with a small program that exhibits this bug?

-- 
Bye,
-Torsten
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-340368" href="/Public/Bug/Display.html?id=27724#txn-340368">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;03&nbsp;08:05:41&nbsp;2007</span>
    <span class="description">dave [...] howorth.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #27724] File chooser tests hang</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 03 Jul 2007 12:30:39 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Gtk2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Howorth &lt;dave [...] howorth.org.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/340368/152549/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/152549">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 2007-07-02 at 14:23 -0400, Torsten SchÃ¶nfeld via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=27724">http://rt.cpan.org/Ticket/Display.html?id=27724</a></span> &gt;
&gt; 
&gt; On Mon, 2007-06-25 at 17:38 -0400, Dave Howorth via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; strace.log attached
</div>&gt; 
&gt; Hmm, looks like the file chooser is hung in a futex&#40;&#41; call, waiting for
&gt; the lock to be released, which apparently never happens in your case.
&gt; 
&gt; Can you use any of the file chooser widgets normally in an application?
&gt; 
&gt; Can you try to come up with a small program that exhibits this bug?
</div>
Well GtkFileChooserButton.t is fairly small! But I can reduce it to
this:

#!/usr/bin/perl -w
use strict;

use Gtk2 &#39;-init&#39;;
my $dialog = Gtk2::FileChooserDialog -&gt; new&#40;&#34;Urgs&#34;, undef, &#34;open&#34;,
                                            &#34;gtk-cancel&#34; =&gt; &#34;cancel&#34;,
                                            &#34;gtk-ok&#34; =&gt; &#34;ok&#34;&#41;;

Is that small enough? :&#41;

What&#39;s probably more interesting is that in writing this program I
discovered that it works for me as a normal user but not as root &#40;it
hangs&#41;.

I&#39;m not sure what differences might be important. The perl -V printout
is identical for root and myself. I&#39;ve attached the output of env for
both users; I can&#39;t see anything significant. I&#39;m not sure what else
might be relevant. Let me know if you&#39;d like anything else.

Cheers, Dave
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/340368/152550/env-root">Download env-root</a><br />
<span class="downloadcontenttype">text/plain 4.5k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/340368/152551/env-user">Download env-user</a><br />
<span class="downloadcontenttype">text/plain 4.4k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-341109" href="/Public/Bug/Display.html?id=27724#txn-341109">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;05&nbsp;16:38:32&nbsp;2007</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #27724] File chooser tests hang</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 05 Jul 2007 22:38:03 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Gtk2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Torsten Schoenfeld &lt;kaffeetisch [...] gmx.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/341109/152937/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/152937">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 562b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 2007-07-03 at 08:05 -0400, Dave Howorth via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Can you try to come up with a small program that exhibits this bug?
</div>&gt; 
&gt; Well GtkFileChooserButton.t is fairly small!
</div>
Oh, right. :-&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What&#39;s probably more interesting is that in writing this program I
&gt; discovered that it works for me as a normal user but not as root &#40;it
&gt; hangs&#41;.
</div>
To rule out more alternatives, can you try the attached C program and
see if it hangs as well?  If so, a&#41; it&#39;s not bindings related and b&#41; you
can try to get some more information with gdb.

-- 
Bye,
-Torsten
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/341109/152938/dialog.c">Download dialog.c</a><br />
<span class="downloadcontenttype">text/x-csrc 414b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-341393" href="/Public/Bug/Display.html?id=27724#txn-341393">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;06&nbsp;07:25:19&nbsp;2007</span>
    <span class="description">dave [...] howorth.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #27724] File chooser tests hang</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 06 Jul 2007 12:24:43 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Gtk2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Howorth &lt;dave [...] howorth.org.uk&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/341393/153102/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/153102">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, 2007-07-05 at 16:39 -0400, Torsten SchÃ¶nfeld via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=27724">http://rt.cpan.org/Ticket/Display.html?id=27724</a></span> &gt;
&gt; To rule out more alternatives, can you try the attached C program and
&gt; see if it hangs as well?  If so, a&#41; it&#39;s not bindings related and b&#41; you
&gt; can try to get some more information with gdb.
</div>
OK. It built cleanly &#40;as normal user&#41; and it runs as my normal user. It
hangs when I run it as root. I&#39;m not familiar with gdb but there&#39;s a log
below. It hung when run, I typed CTRL-C then when I did bt it said there
was an internal error in gdb. I guess that&#39;s not what you hope for?

I tried again &#40;see second log&#41; and single-stepped main but it hung
immediately. The third log is the result of single-stepping as a normal
user.

I&#39;m not sure what to try next.

Cheers, Dave

-------------------------------------------------------

# gdb dialog
GNU gdb 6.5
Copyright &#40;C&#41; 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you
are
welcome to change it and/or distribute copies of it under certain
conditions.
Type &#34;show copying&#34; to see the conditions.
There is absolutely no warranty for GDB.  Type &#34;show warranty&#34; for
details.
This GDB was configured as &#34;x86_64-suse-linux&#34;...Using host libthread_db
library &#34;/lib64/libthread_db.so.1&#34;.

&#40;gdb&#41; run
Starting program: /home/dhoworth/progs/gtk/dialog-test/dialog 
[Thread debugging using libthread_db enabled]
[New Thread 47081357781968 &#40;LWP 20704&#41;]

Program received signal SIGINT, Interrupt.
[Switching to Thread 47081357781968 &#40;LWP 20704&#41;]
0x00002ad1f9fe8a68 in __lll_mutex_lock_wait &#40;&#41;
from /lib64/libpthread.so.0
&#40;gdb&#41; bt
#0  0x00002ad1f9fe8a68 in __lll_mutex_lock_wait &#40;&#41;
from /lib64/libpthread.so.0
#1  0x00002ad1f9fe4a78 in _L_mutex_lock_106 &#40;&#41;
from /lib64/libpthread.so.0
dwarf2-frame.c:521: internal-error: Unknown CFI encountered.
A problem internal to GDB has been detected,
further debugging may prove unreliable.
Quit this debugging session? &#40;y or n&#41; 

-----------------------------------------------------------------

[as root]
&#40;gdb&#41; break main
Breakpoint 1 at 0x40081c
&#40;gdb&#41; run
Starting program: /home/dhoworth/progs/gtk/dialog-test/dialog 
[Thread debugging using libthread_db enabled]
[New Thread 47972515281872 &#40;LWP 20742&#41;]
[Switching to Thread 47972515281872 &#40;LWP 20742&#41;]

Breakpoint 1, 0x000000000040081c in main &#40;&#41;
&#40;gdb&#41; s
Single stepping until exit from function main, 
which has no line number information.


Program received signal SIGINT, Interrupt.


---------------------------------------------------------------------

[as normal user]
&#40;gdb&#41; break main
Breakpoint 1 at 0x40081c
&#40;gdb&#41; run
Starting program: /home/dhoworth/progs/gtk/dialog-test/dialog 
[Thread debugging using libthread_db enabled]
[New Thread 47618411293648 &#40;LWP 20761&#41;]
[Switching to Thread 47618411293648 &#40;LWP 20761&#41;]

Breakpoint 1, 0x000000000040081c in main &#40;&#41;
&#40;gdb&#41; s
Single stepping until exit from function main, 
which has no line number information.
[New Thread 1082132800 &#40;LWP 20762&#41;]
[New Thread 1090525504 &#40;LWP 20763&#41;]
0x00002b4f05442ae4 in __libc_start_main &#40;&#41; from /lib64/libc.so.6
&#40;gdb&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-342589" href="/Public/Bug/Display.html?id=27724#txn-342589">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;10&nbsp;12:18:21&nbsp;2007</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #27724] File chooser tests hang</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 10 Jul 2007 18:18:02 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Gtk2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Torsten Schoenfeld &lt;kaffeetisch [...] gmx.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/342589/153658/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/153658">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 701b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 2007-07-06 at 07:25 -0400, Dave Howorth via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; OK. It built cleanly &#40;as normal user&#41; and it runs as my normal user. It
&gt; hangs when I run it as root. I&#39;m not familiar with gdb but there&#39;s a log
&gt; below. It hung when run, I typed CTRL-C then when I did bt it said there
&gt; was an internal error in gdb. I guess that&#39;s not what you hope for?
</div>
Ouch.  Never seen that before.

The single stepping might work better if you compile the program with
the -g switch so it gets debugging symbols.

Also, if you can get a gtk+ installed with debugging symbols, a run with
valgrind might provide some more information:

  $ valgrind --tool=memcheck --num-callers=100 ./dialog

-- 
Bye,
-Torsten
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-343027" href="/Public/Bug/Display.html?id=27724#txn-343027">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;18:32:54&nbsp;2007</span>
    <span class="description">dave [...] howorth.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #27724] File chooser tests hang</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Jul 2007 23:32:34 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Gtk2 [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Howorth &lt;dave [...] howorth.org.uk&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/343027/153863/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/153863">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 2007-07-10 at 12:18 -0400, Torsten SchÃ¶nfeld via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=27724">http://rt.cpan.org/Ticket/Display.html?id=27724</a></span> &gt;
&gt; 
&gt; On Fri, 2007-07-06 at 07:25 -0400, Dave Howorth via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; OK. It built cleanly &#40;as normal user&#41; and it runs as my normal user. It
&gt; &gt; hangs when I run it as root. I&#39;m not familiar with gdb but there&#39;s a log
&gt; &gt; below. It hung when run, I typed CTRL-C then when I did bt it said there
&gt; &gt; was an internal error in gdb. I guess that&#39;s not what you hope for?
</div>&gt; 
&gt; Ouch.  Never seen that before.
&gt; 
&gt; The single stepping might work better if you compile the program with
&gt; the -g switch so it gets debugging symbols.
</div>
OK, it now reads:

Breakpoint 1, main &#40;argc=1, argv=0x7fff16499dd8&#41; at dialog.c:10
10        gtk_init &#40;&#38;argc, &#38;argv&#41;;
&#40;gdb&#41; s
12        dialog = gtk_file_chooser_dialog_new &#40;&#34;Test&#34;,
&#40;gdb&#41; s

Program received signal SIGINT, Interrupt.
0x00002b0097903a68 in __lll_mutex_lock_wait &#40;&#41;
from /lib64/libpthread.so.0
&#40;gdb&#41; bt
#0  0x00002b0097903a68 in __lll_mutex_lock_wait &#40;&#41;
from /lib64/libpthread.so.0
#1  0x00002b00978ffa78 in _L_mutex_lock_106 &#40;&#41;
from /lib64/libpthread.so.0

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, if you can get a gtk+ installed with debugging symbols, a run with
&gt; valgrind might provide some more information:
&gt; 
&gt;   $ valgrind --tool=memcheck --num-callers=100 ./dialog
</div>
Sadly, I&#39;m having problems installing the gtk2-debuginfo package thanks
to some version-dependency catch-22. Anders Johansson on the Suse list
suggested I run an strace, which gave this:

...
write&#40;6, &#34;\0&#34;, 1&#41;                       = 1
write&#40;6, &#34;AUTH EXTERNAL 30\r\n&#34;, 18&#41;    = 18
poll&#40;[{fd=6, events=POLLIN, revents=POLLIN}], 1, -1&#41; = 1
read&#40;6, &#34;OK edc29446c3e132dcf7020f13cb28b&#34;..., 2048&#41; = 37
poll&#40;[{fd=6, events=POLLOUT, revents=POLLOUT}], 1, -1&#41; = 1
write&#40;6, &#34;BEGIN\r\n&#34;, 7&#41;                = 7
poll&#40;[{fd=6, events=POLLIN|POLLOUT, revents=POLLIN|POLLOUT|POLLHUP}], 1,
-1&#41; = 1
read&#40;6, &#34;&#34;, 2048&#41;                       = 0
close&#40;6&#41;                                = 0
futex&#40;0x6707d0, FUTEX_WAIT, 2, NULL &lt;unfinished ...&gt;

and on that information he has deduced this:

--------------------

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;On Wednesday 11 July 2007 22:40:40 Anders Johansson wrote:
<div class="message-stanza open">&gt;&gt; It also shows that it happens immediately after failing to read
</div></div>something
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; from dbus
&gt;&gt;
&gt;&gt; This should be solvable
</div>&gt;
&gt;Well, I have the reason, but not a solution
&gt;
&gt;root contacts the user&#39;s dbus session &#40;since you did an su, instead of
&gt;su -, the environment variables are still there&#41;.
&gt;
&gt;dbus then does a getuid&#40;&#41;, sees that someone other than the owner is
&gt;trying to talk to it, and proceeds to ignore it
&gt;
&gt;This is why it&#39;s hanging. Bad design in gtk if you ask me
&gt;
&gt;But the workaround would be to go to root using su -, and then launch a
&gt;new dbus using
&gt;
&gt;eval `dbus-launch --auto-syntax`
&gt;
&gt;After that, your gtk app will work as root as well as a user
&gt;
&gt;...and all this just using strace :&#41;
</div>
------------------------

I&#39;ve confirmed that using dbus-launch does indeed cause the application
to work as root. I hope that helps solve the problem. I&#39;ll keep trying
to figure out the package problems I&#39;m having.

BTW, somebody else on the Suse list says that this problem affects all
gtk applications when the user is running a gnome session and tries to
run the application as root. As soon as the user tries to access the
file dialog, the application hangs. He used gedit as an example, which
I&#39;ve confirmed hangs.

Cheers, Dave
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-347297" href="/Public/Bug/Display.html?id=27724#txn-347297">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;22&nbsp;07:50:45&nbsp;2007</span>
    <span class="description">kaffeetisch [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/347297/155849/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/155849">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 752b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jul 11 18:32:54 2007, dave@howorth.org.uk wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ve confirmed that using dbus-launch does indeed cause the application
&gt; to work as root. I hope that helps solve the problem. I&#39;ll keep trying
&gt; to figure out the package problems I&#39;m having.
&gt; 
&gt; BTW, somebody else on the Suse list says that this problem affects all
&gt; gtk applications when the user is running a gnome session and tries to
&gt; run the application as root. As soon as the user tries to access the
&gt; file dialog, the application hangs. He used gedit as an example, which
&gt; I&#39;ve confirmed hangs.
</div>
OK, that confirms that this is not a problem in the bindings.  If you
wish, you can brings this up with the gtk+ developers:
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://bugzilla.gnome.org/enter_bug.cgi?product=gtk%2B">http://bugzilla.gnome.org/enter_bug.cgi?product=gtk%2B</a></span>&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-347300" href="/Public/Bug/Display.html?id=27724#txn-347300">#</a>      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;22&nbsp;07:50:48&nbsp;2007</span>
    <span class="description">kaffeetisch [...] gmx.de -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.844598</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
