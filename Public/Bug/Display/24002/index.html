<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #24002 for Sys-HostIP: Interface detection regular expression is flawed</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #24002 for Sys-HostIP: Interface detection regular expression is flawed</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Sys-HostIP/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Sys-HostIP/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Sys-HostIP/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Sys-HostIP/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/xsawyerx/sys-hostip/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Sys-HostIP">Sys-HostIP CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">24002</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Sys-HostIP/Active/">Sys-HostIP</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gmc [...] gmcx.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-30548-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.3.1    </td>
  </tr>
  <tr id="CF-30549-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;19&nbsp;13:05:17&nbsp;2006</span>
    <span class="description">gmc [...] gmcx.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Interface detection regular expression is flawed</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">A few systems that I&#39;ve worked on have multiple aliased interfaces
&#40;eth0:0, eth0:1, etc.&#41;  Some of these have double digit numbers after
the colons, such as eth0:13.

The regular expression &#40;line 143 in HostIP.pm&#41; will still find eth0:13,
but since it only captures the first number after the colon, it will
overwrite the entry in the hash previously stored for eth0:1.  This
happens successively for each entry that matches, so that if someone had
the following interfaces: eth0:0 to eth0:19, the only ones that will
show up are eth0:0 to eth0:9, with eth0:1 being overwritten in the end
by eth0:19.

The original regular expression is:  /&#40;^\w+&#40;?:\d&#41;?&#40;?:\:\d&#41;?&#41;/.
A simple modification:  /&#40;^\w+&#40;?:\d&#41;?&#40;?:\:\d+&#41;?&#41;/ seems to fix this problem.


Attached is a sample output before and after the change in my local copy
of the module.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Sys_HostIP Sample Output.txt</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Code used to test this:

#!/usr/bin/perl
use strict;
use Data::Dumper;

use Sys::HostIP;

my $interfaces = Sys::HostIP-&gt;interfaces;

print Dumper \$interfaces;




Output before regular expression change:

$VAR1 = \{
            &#39;bond0:2&#39; =&gt; &#39;192.168.1.224&#39;,
            &#39;lo&#39; =&gt; &#39;127.0.0.1&#39;,
            &#39;bond0:5&#39; =&gt; &#39;192.168.1.100&#39;,
            &#39;bond0:3&#39; =&gt; &#39;192.168.1.33&#39;,
            &#39;bond0&#39; =&gt; &#39;192.168.1.30&#39;,
            &#39;eth1&#39; =&gt; &#39;192.168.1.30&#39;,
            &#39;bond0:1&#39; =&gt; &#39;192.168.1.219&#39;,
            &#39;eth0&#39; =&gt; &#39;192.168.1.30&#39;
          };




Output after regular expression change:

$VAR1 = \{
            &#39;bond0:19&#39; =&gt; &#39;192.168.1.219&#39;,
            &#39;bond0:2&#39; =&gt; &#39;192.168.1.32&#39;,
            &#39;bond0&#39; =&gt; &#39;192.168.1.30&#39;,
            &#39;eth0&#39; =&gt; &#39;192.168.1.30&#39;,
            &#39;bond0:14&#39; =&gt; &#39;192.168.1.214&#39;,
            &#39;lo&#39; =&gt; &#39;127.0.0.1&#39;,
            &#39;bond0:23&#39; =&gt; &#39;192.168.1.223&#39;,
            &#39;bond0:17&#39; =&gt; &#39;192.168.1.217&#39;,
            &#39;bond0:5&#39; =&gt; &#39;192.168.1.100&#39;,
            &#39;bond0:11&#39; =&gt; &#39;192.168.1.211&#39;,
            &#39;bond0:24&#39; =&gt; &#39;192.168.1.224&#39;,
            &#39;bond0:12&#39; =&gt; &#39;192.168.1.212&#39;,
            &#39;bond0:10&#39; =&gt; &#39;192.168.1.210&#39;,
            &#39;bond0:13&#39; =&gt; &#39;192.168.1.213&#39;,
            &#39;bond0:16&#39; =&gt; &#39;192.168.1.216&#39;,
            &#39;bond0:22&#39; =&gt; &#39;192.168.1.222&#39;,
            &#39;bond0:3&#39; =&gt; &#39;192.168.1.33&#39;,
            &#39;bond0:15&#39; =&gt; &#39;192.168.1.215&#39;,
            &#39;bond0:21&#39; =&gt; &#39;192.168.1.221&#39;,
            &#39;bond0:18&#39; =&gt; &#39;192.168.1.218&#39;,
            &#39;bond0:20&#39; =&gt; &#39;192.168.1.220&#39;,
            &#39;eth1&#39; =&gt; &#39;192.168.1.30&#39;,
            &#39;bond0:1&#39; =&gt; &#39;192.168.1.31&#39;
          };


</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;21&nbsp;20:48:40&nbsp;2008</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It also looks like it doesn&#39;t let you have an interface named eth10 as
this will overwrite the hash entry for eth1.

Is this module dead?  I am just going to regexp my addresses myself.

Good reasons to use /mxs flags for regexp!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Dec&nbsp;21&nbsp;20:48:40&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;22&nbsp;14:41:16&nbsp;2008</span>
    <span class="description">jon [...] divisionbyzero.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #24002] Interface detection regular expression is flawed </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 22 Dec 2008 11:40:58 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Sys-HostIP [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jon schatz &lt;jon [...] divisionbyzero.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Dec 21, 2008, at 5:48 PM, MARKLE via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is this module dead?  I am just going to regexp my addresses myself.
</div>
module&#39;s not dead &#40;although i can&#39;t seem to login to the bug system&#41;.  
i&#39;ll add your patch and update it on cpan.

thanks,

-jon
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;16&nbsp;15:59:58&nbsp;2009</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve gotten around to needing this.  Thanks.

--- /usr/lib/perl5/site_perl/5.8.8/Sys/HostIP.pm.orig   2009-12-16
12:53:10.000000000 -0800
+++ /usr/lib/perl5/site_perl/5.8.8/Sys/HostIP.pm        2009-12-16
12:55:46.000000000 -0800
@@ -140,7 +140,7 @@
     if &#40; &#40;$line =~/^\s+/&#41; &#38;&#38; &#40;$interface&#41; &#41; {
       $if_info{$interface} .= $line;
     }
-    elsif &#40;&#40;$interface&#41; = &#40;$line =~/&#40;^\w+&#40;?:\d&#41;?&#40;?:\:\d&#41;?&#41;/&#41;&#41; {
+    elsif &#40;&#40;$interface&#41; = &#40;$line =~/&#40;^\w+&#40;?:\d+&#41;?&#40;?:\:\d+&#41;?&#41;/&#41;&#41; {
       $line =~s/\w+\d&#40;\:&#41;?\s+//;
       $if_info{$interface} = $line;
     }
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;16&nbsp;16:00:46&nbsp;2009</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- /usr/lib/perl5/site_perl/5.8.8/Sys/HostIP.pm.orig	2009-12-16 12:53:10.000000000 -0800
+++ /usr/lib/perl5/site_perl/5.8.8/Sys/HostIP.pm	2009-12-16 12:55:46.000000000 -0800
@@ -140,7 +140,7 @@
     if &#40; &#40;$line =~/^\s+/&#41; &#38;&#38; &#40;$interface&#41; &#41; {
       $if_info{$interface} .= $line;
     }
-    elsif &#40;&#40;$interface&#41; = &#40;$line =~/&#40;^\w+&#40;?:\d&#41;?&#40;?:\:\d&#41;?&#41;/&#41;&#41; {
+    elsif &#40;&#40;$interface&#41; = &#40;$line =~/&#40;^\w+&#40;?:\d+&#41;?&#40;?:\:\d+&#41;?&#41;/&#41;&#41; {
       $line =~s/\w+\d&#40;\:&#41;?\s+//;
       $if_info{$interface} = $line;
     }
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;11&nbsp;09:50:15&nbsp;2010</span>
    <span class="description">XSAWYERX [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This has been resolved with version 1.4 recently uploaded to CPAN.

However, the regular expression will probably be refactored and improved
once more in the future.

Thank you for your report and patch!

Sawyer.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;11&nbsp;09:50:19&nbsp;2010</span>
    <span class="description">XSAWYERX [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
