<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #78306 for Net-INET6Glue: Not completely compatible with IO::Socket::INET</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #78306 for Net-INET6Glue: Not completely compatible with IO::Socket::INET</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-INET6Glue/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-INET6Glue/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-INET6Glue/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-INET6Glue/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-INET6Glue">Net-INET6Glue CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">78306</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-INET6Glue/Active/">Net-INET6Glue</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MICHIELB [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
leonerd [...] leonerd.org.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-225312-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-225313-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;04:03:19&nbsp;2012</span>
    <span class="description">MICHIELB [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> leonerd [...] leonerd.org.uk</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Not completely compatible with IO::Socket::INET</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I am looking into making the Perl application I work on IPv6 capable.
The biggest problem here is IO::Socket::INET is IPv4 only, which makes
modules such as LWP, Net::IMAP and such also IPv4 only. 

I used your excellent module and it seems to make it *just work*. But to
be sure, I modified the test suite of IO to use your Glue module, then I
ran the tests, and t/io_multihomed.t fails tests 2, 3 and 4.

Test Summary Report
-------------------
t/io_multihomed.t   &#40;Wstat: 0 Tests: 5 Failed: 0&#41;
  Parse errors: Tests out of sequence.  Found &#40;5&#41; but expected &#40;2&#41;
                Tests out of sequence.  Found &#40;6&#41; but expected &#40;3&#41;
                Tests out of sequence.  Found &#40;7&#41; but expected &#40;4&#41;
                Tests out of sequence.  Found &#40;8&#41; but expected &#40;5&#41;
                Bad plan.  You planned 8 tests but ran 5.

This means at least unpack_sockaddr_in is not working after using the
glue module.

Then I changed your module to do the same trick with IO::Socket::INET6
but now with Paul Evan&#39;s &#40;cc&#41; IO::Socket::IP and then it passes. So
would you consider updating the Glue module to use IO::Socket::IP
instead? Then I hope it would work also for modules that use
unpack_sockaddr_in.
--
Mike
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;06:05:27&nbsp;2012</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jul 11 04:03:19 2012, MICHIELB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Then I changed your module to do the same trick with IO::Socket::INET6
&gt; but now with Paul Evan&#39;s &#40;cc&#41; IO::Socket::IP and then it passes. So
&gt; would you consider updating the Glue module to use IO::Socket::IP
&gt; instead? Then I hope it would work also for modules that use
&gt; unpack_sockaddr_in.
</div>
Any module that tries to use unpack_sockaddr_in&#40;&#41; is /inherently/ broken 
with regards to IPv6 anyway, because unpack_sockaddr_in is specifically 
for unpacking an AF_INET address, which represents IPv4 only.

You should not be manually unpacking addresses in this way, if you want 
to be IPv6-compatible. See instead the various -&gt;sock* and -&gt;peer* 
accessor methods on IO::Socket::IP, which work in a family-neutral way.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;06:05:28&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;07:29:57&nbsp;2012</span>
    <span class="description">michiel.beijen [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> leonerd [...] leonerd.org.uk</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #78306] Not completely compatible with IO::Socket::INET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Jul 2012 13:29:26 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-INET6Glue [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michiel Beijen &lt;michiel.beijen [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Paul, thanks for the feedback.

On Wed, Jul 11, 2012 at 12:05 PM, Paul Evans via RT
&lt;bug-Net-INET6Glue@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=78306">https://rt.cpan.org/Ticket/Display.html?id=78306</a></span> &gt;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Any module that tries to use unpack_sockaddr_in&#40;&#41; is /inherently/ broken
&gt; with regards to IPv6 anyway, because unpack_sockaddr_in is specifically
&gt; for unpacking an AF_INET address, which represents IPv4 only.
&gt;
&gt; You should not be manually unpacking addresses in this way, if you want
&gt; to be IPv6-compatible. See instead the various -&gt;sock* and -&gt;peer*
&gt; accessor methods on IO::Socket::IP, which work in a family-neutral way.
</div>
Does this mean:
1&#41; the Glue module will only work for modules that do not use
unpack_sockaddr_in,  some other sock and peer accessors,

2&#41; If we would &#39;glue&#39; the IO::Socket::IP module instead, these modules
WOULD work in IPv4 mode, but they will not get IPv4 capabilities
unless the module authors would upgrade the modules to use
&#39;familiy-neutral&#39; accessors, as you describe, in which case the &#39;glue&#39;
module has not much use left, as the module authors would need to
update their modules anyway?

--
Mike
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;08:15:21&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Does this mean:
&gt; 1&#41; the Glue module will only work for modules that do not use
&gt; unpack_sockaddr_in,  some other sock and peer accessors,
</div>
Yes.
The Glue stuff is intended for modules which just depend on
IO::Socket::INET,
instead of IO::Socket::INET6 or IO::Socket::IP and thus cannot use IPv6.
Typical examples are Net::SMTP, Net::POP...

If these modules also do IPv4 specific stuff like parsing addresses,
unpack_sockaddr_in, aton, ntoa.. they cannot be fixed simply by using
the Glue module. For instance Net::FTP only handles PORT,PASV commandos
which are IPV4 only, so there need to be a special Net::INET6Glue::FTP
module to add the missing commands.

So the glueing code works in a lot of cases because lots of cases are
simple, e.g. module just use IO::Socket::INET but don&#39;t do anything
IPv4 specific with it.

And it&#39;s only intended to make 3rd party modules run without changes, if
you own the module yourself you should better fix it, so that the glueing
is not necessary.

Regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;08:47:33&nbsp;2012</span>
    <span class="description">michiel.beijen [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> leonerd [...] leonerd.org.uk</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #78306] Not completely compatible with IO::Socket::INET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Jul 2012 14:47:03 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-INET6Glue [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michiel Beijen &lt;michiel.beijen [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The Glue stuff is intended for modules which just depend on
&gt; IO::Socket::INET,
&gt; instead of IO::Socket::INET6 or IO::Socket::IP and thus cannot use IPv6.
&gt; Typical examples are Net::SMTP, Net::POP...
&gt;
&gt; If these modules also do IPv4 specific stuff like parsing addresses,
&gt; unpack_sockaddr_in, aton, ntoa.. they cannot be fixed simply by using
&gt; the Glue module. For instance Net::FTP only handles PORT,PASV commandos
&gt; which are IPV4 only, so there need to be a special Net::INET6Glue::FTP
&gt; module to add the missing commands.
&gt;
&gt; So the glueing code works in a lot of cases because lots of cases are
&gt; simple, e.g. module just use IO::Socket::INET but don&#39;t do anything
&gt; IPv4 specific with it.
&gt;
&gt; And it&#39;s only intended to make 3rd party modules run without changes, if
&gt; you own the module yourself you should better fix it, so that the glueing
&gt; is not necessary.
</div>
&#40;Un?&#41;fortunately I am not the maintainer of Net::POP3 and such.
If your Glue module would glue with Net::Socket::IP using it would at
least not break existing modules that use unpack_sockaddr_in - they
would not be capable of doing IPv6, but at least using IPv4 they would
still be working.

Let me describe my use case; I work on OTRS; a ticket system written
in Perl. I am investigating what it takes to IPv6-enable the software.
We have a module that parses RSS feeds, and a module that loads XML
files from a remote HTTP host to install packages on the system. These
use LWP; and using your Glue module I was able to make them work with
IPv6 hosts. Obviously I do not want to break other &#40;IPv4&#41; stuff but
that will happen, if I first &#39;use&#39; your glue module and then load a
module that does some unpack* ipv4. This is the reason I raised this
RT ticket.

Of course I understand to IPv6 enable all parts of the system, there
is still more work to be done, but this would be a start.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;11:05:19&nbsp;2012</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Jul 11 08:47:33 2012, michiel.beijen@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#40;Un?&#41;fortunately I am not the maintainer of Net::POP3 and such.
&gt; If your Glue module would glue with Net::Socket::IP using it would at
&gt; least not break existing modules that use unpack_sockaddr_in - they
&gt; would not be capable of doing IPv6, but at least using IPv4 they would
&gt; still be working.
</div>
I&#39;m not the maintainer either but fortunately it&#39;s open-source so obtaining it and writing a 
patch is trivially simple.

Find attached a patch that just swaps Net::POP3 and friends to using IO::Socket::IP instead of 
::INET. It passes the libnet distribution&#39;s unit tests, but that isn&#39;t saying very much because 
Net::POP3 in particular is never unit-tested and most of the other tests are skipped. :&#40;

But, try it out anyway and see how you get on, perhaps it solves your problem?

-- 

Paul Evans
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> libnet_using_IO-Socket-IP.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">=== modified file &#39;Makefile.PL&#39;
--- Makefile.PL	2012-07-11 14:39:36 +0000
+++ Makefile.PL	2012-07-11 15:00:17 +0000
@@ -95,7 +95,8 @@
   &#39;realclean&#39; =&gt; {FILES =&gt; $config_pm},
   PREREQ_PM   =&gt; {
 		Socket     =&gt; 1.3,
-		IO::Socket =&gt; 1.05
+		IO::Socket =&gt; 1.05,
+		IO::Socket::IP =&gt; 0,
 	      },
   dist =&gt; { DIST_DEFAULT =&gt; &#39;mydist&#39;, },
   @ppd,

=== modified file &#39;Net/NNTP.pm&#39;
--- Net/NNTP.pm	2012-07-11 14:39:36 +0000
+++ Net/NNTP.pm	2012-07-11 15:00:17 +0000
@@ -8,14 +8,14 @@
 
 use strict;
 use vars qw&#40;@ISA $VERSION $debug&#41;;
-use IO::Socket;
+use IO::Socket::IP;
 use Net::Cmd;
 use Carp;
 use Time::Local;
 use Net::Config;
 
 $VERSION = &#34;2.24&#34;;
-@ISA     = qw&#40;Net::Cmd IO::Socket::INET&#41;;
+@ISA     = qw&#40;Net::Cmd IO::Socket::IP&#41;;
 
 
 sub new {
@@ -731,7 +731,7 @@
 Possible options are:
 
 B&lt;Host&gt; - NNTP host to connect to. It may be a single scalar, as defined for
-the C&lt;PeerAddr&gt; option in L&lt;IO::Socket::INET&gt;, or a reference to
+the C&lt;PeerAddr&gt; option in L&lt;IO::Socket::IP&gt;, or a reference to
 an array with hosts to try in turn. The L&lt;/host&gt; method will return the value
 which was used to connect to the host.
 

=== modified file &#39;Net/POP3.pm&#39;
--- Net/POP3.pm	2012-07-11 14:39:36 +0000
+++ Net/POP3.pm	2012-07-11 15:00:17 +0000
@@ -7,7 +7,7 @@
 package Net::POP3;
 
 use strict;
-use IO::Socket;
+use IO::Socket::IP;
 use vars qw&#40;@ISA $VERSION $debug&#41;;
 use Net::Cmd;
 use Carp;
@@ -15,7 +15,7 @@
 
 $VERSION = &#34;2.29&#34;;
 
-@ISA = qw&#40;Net::Cmd IO::Socket::INET&#41;;
+@ISA = qw&#40;Net::Cmd IO::Socket::IP&#41;;
 
 
 sub new {
@@ -578,7 +578,7 @@
 Possible options are:
 
 B&lt;Host&gt; - POP3 host to connect to. It may be a single scalar, as defined for
-the C&lt;PeerAddr&gt; option in L&lt;IO::Socket::INET&gt;, or a reference to
+the C&lt;PeerAddr&gt; option in L&lt;IO::Socket::IP&gt;, or a reference to
 an array with hosts to try in turn. The L&lt;/host&gt; method will return the value
 which was used to connect to the host.
 

=== modified file &#39;Net/SMTP.pm&#39;
--- Net/SMTP.pm	2012-07-11 14:39:36 +0000
+++ Net/SMTP.pm	2012-07-11 15:00:17 +0000
@@ -12,13 +12,13 @@
 use vars qw&#40;$VERSION @ISA&#41;;
 use Socket 1.3;
 use Carp;
-use IO::Socket;
+use IO::Socket::IP;
 use Net::Cmd;
 use Net::Config;
 
 $VERSION = &#34;2.31&#34;;
 
-@ISA = qw&#40;Net::Cmd IO::Socket::INET&#41;;
+@ISA = qw&#40;Net::Cmd IO::Socket::IP&#41;;
 
 
 sub new {
@@ -554,7 +554,7 @@
 A new Net::SMTP object must be created with the I&lt;new&gt; method. Once
 this has been done, all SMTP commands are accessed through this object.
 
-The Net::SMTP class is a subclass of Net::Cmd and IO::Socket::INET.
+The Net::SMTP class is a subclass of Net::Cmd and IO::Socket::IP.
 
 =head1 EXAMPLES
 
@@ -609,7 +609,7 @@
 will be used.
 
 B&lt;Host&gt; - SMTP host to connect to. It may be a single scalar, as defined for
-the C&lt;PeerAddr&gt; option in L&lt;IO::Socket::INET&gt;, or a reference to
+the C&lt;PeerAddr&gt; option in L&lt;IO::Socket::IP&gt;, or a reference to
 an array with hosts to try in turn. The L&lt;/host&gt; method will return the value
 which was used to connect to the host.
 
@@ -679,7 +679,7 @@
 
 =item host &#40;&#41;
 
-Returns the value used by the constructor, and passed to IO::Socket::INET,
+Returns the value used by the constructor, and passed to IO::Socket::IP,
 to connect to the host.
 
 =item etrn &#40; DOMAIN &#41;

=== modified file &#39;Net/Time.pm&#39;
--- Net/Time.pm	2012-07-11 14:39:36 +0000
+++ Net/Time.pm	2012-07-11 15:00:17 +0000
@@ -9,7 +9,7 @@
 use strict;
 use vars qw&#40;$VERSION @ISA @EXPORT_OK $TIMEOUT&#41;;
 use Carp;
-use IO::Socket;
+use IO::Socket::IP;
 require Exporter;
 use Net::Config;
 use IO::Select;
@@ -34,7 +34,7 @@
   my $me;
 
   foreach $host &#40;@$hosts&#41; {
-    $me = IO::Socket::INET-&gt;new&#40;
+    $me = IO::Socket::IP-&gt;new&#40;
       PeerAddr =&gt; $host,
       PeerPort =&gt; $port,
       Proto    =&gt; $proto

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;15:43:14&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I used your excellent module and it seems to make it *just work*. But to
&gt; be sure, I modified the test suite of IO to use your Glue module, then I
&gt; ran the tests, and t/io_multihomed.t fails tests 2, 3 and 4.
&gt; 
&gt; Test Summary Report
&gt; -------------------
&gt; t/io_multihomed.t   &#40;Wstat: 0 Tests: 5 Failed: 0&#41;
&gt;   Parse errors: Tests out of sequence.  Found &#40;5&#41; but expected &#40;2&#41;
&gt;                 Tests out of sequence.  Found &#40;6&#41; but expected &#40;3&#41;
&gt;                 Tests out of sequence.  Found &#40;7&#41; but expected &#40;4&#41;
&gt;                 Tests out of sequence.  Found &#40;8&#41; but expected &#40;5&#41;
&gt;                 Bad plan.  You planned 8 tests but ran 5.
&gt; 
&gt; This means at least unpack_sockaddr_in is not working after using the
&gt; glue module.
</div>
Like I said, you cannot expect to work INET6Glue to work in all cases, but
have a look at this special case:

- the test defines a module Multi, which is defined as subclass of
  IO::Socket::INET
- it redefines the non-public sub _get_addr. Thus it goes deeply in the
  implementation interna of IO::Socket::INET. This is ok for the test,
  because it is a test for IO::Socket::INET, but you will hopefully
  not see any module which also uses these undocumented interna of 
  IO::Socket::INET.
- and because _get_addr does not get called if you replace IO::Socket::INET
  with IO::Socket::INET6 or IO::Socket::IP &#40;it fails for me with both,
  because both have no _get_addr method&#41; the subtest 2 will not run.
  And _get_addr cannot give the faked reply which it verifies in connect,
  so that subtests 3 and 4 will not run either &#40;connect will be called
  all the time with a packed 127.0.0.1, and unpack_sockaddr_in works fine&#41;

So in this case it has nothing to do with unpack_sockaddr_in.
And you cannot expect the glue code to work on code, which access the
undocumented internals of IO::Socket::INET

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Then I changed your module to do the same trick with IO::Socket::INET6
&gt; but now with Paul Evan&#39;s &#40;cc&#41; IO::Socket::IP and then it passes. So
&gt; would you consider updating the Glue module to use IO::Socket::IP
&gt; instead? Then I hope it would work also for modules that use
&gt; unpack_sockaddr_in.
</div>
Like I said, it does not pass with IO::Socket::IP for me.

Regards,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;15:43:15&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;15:59:02&nbsp;2012</span>
    <span class="description">michiel.beijen [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> leonerd [...] leonerd.org.uk</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #78306] Not completely compatible with IO::Socket::INET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Jul 2012 21:58:32 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-INET6Glue [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michiel Beijen &lt;michiel.beijen [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, Jul 11, 2012 at 5:05 PM, Paul Evans via RT
&lt;bug-Net-INET6Glue@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not the maintainer either but fortunately it&#39;s open-source so obtaining it and writing a
&gt; patch is trivially simple.
&gt;
&gt; Find attached a patch that just swaps Net::POP3 and friends to using IO::Socket::IP instead of
&gt; ::INET. It passes the libnet distribution&#39;s unit tests, but that isn&#39;t saying very much because
&gt; Net::POP3 in particular is never unit-tested and most of the other tests are skipped. :&#40;
&gt;
&gt; But, try it out anyway and see how you get on, perhaps it solves your problem?
</div>
This would solve my problems; yes. I could add your patches to the
modules, bundle them in our product, specify IO::Socket::IP as a
dependency and it would Just Work. I was thinking about other people
wanting to IPv6 upgrade their code. I *understand* it is not nice but
would you think it would help to just put the patched versions on CPAN
under Net::POP3::IPv6Capable or so, so people can take their existing
code, s/Net::POP3/Net::POP3::IPv6Capable/  and would be up and
running?
Of course, you made a drop-in replacement for IO::Socket::INET but
many people are not directly using this module, they are using modules
which are in turn using IO::Socket::Inet and thus can not properly use
IPv6.
--
Mike
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;15:59:04&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;16:00:17&nbsp;2012</span>
    <span class="description">michiel.beijen [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #78306] Not completely compatible with IO::Socket::INET</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 11 Jul 2012 21:59:48 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-INET6Glue [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michiel Beijen &lt;michiel.beijen [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, Jul 11, 2012 at 9:43 PM, Steffen Ullrich via RT
&lt;bug-Net-INET6Glue@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Like I said, it does not pass with IO::Socket::IP for me.
</div>
OK, thanks for your help, it was not a good idea. :D
--
Mike
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;11&nbsp;16:14:09&nbsp;2012</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
