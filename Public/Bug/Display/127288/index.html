<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #127288 for RT-Client-REST: Problems downloading attachments</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #127288 for RT-Client-REST: Problems downloading attachments</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/RT-Client-REST/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/RT-Client-REST/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/RT-Client-REST/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/RT-Client-REST/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/RT-Client-REST">RT-Client-REST CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">127288</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/RT-Client-REST/Active/">RT-Client-REST</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">dean [...] fragfest.com.au
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
wardmw [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39236-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-39237-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;03&nbsp;13:08:16&nbsp;2018</span>
    <span class="description">wardmw [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Problems downloading attachments</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 3 Oct 2018 18:07:57 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-RT-Client-REST [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Martin Ward &lt;wardmw [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi all,

I am trying to write a Perl script that downloads file attachments from an old RT instance that needs to be decommissioned. The problem is that the RT modules seem to be doing something to the binary code such that the size is incorrect.

When I download the attachment via the website it transfer fine. The example I man using is a zip file and I can unzip it fine afterwards; the file size is 460,749 bytes.

If I retrieve the attachment by retrieving the ticket and iterating through the attachments then the size of the content file is 442,958 bytes, so bigger than expected. If I simply save this file then it is unreadable.

I have tried encode_base64, decode_base64, encode_utf8 and decode_utf8 functions to en-decode the string to try and get it in to a reasonable state  &#40; 460,749 bytes long and readable as a .zip file&#41; but to no avail.

I believe that it might be something to do with wide characters because if I do a hex dump of the start of the downloaded file I get:

0000000 50 4b 03 04 14 00 09 00 - 08 00 67 8d 25 46 00 00
0000010 00 00 00 00 00 00 00 00 - 00 00 1c 00 00 00 73 63
0000020 72 65 65 6e 73 68 6f 74 - 2d 31 37 32 20 32 31 20 
0000030 32 34 32 20 36 34 2e 7a - 69 70 32 9e 8a fc b5 15

but if I hex dump the first few parts of the content I retrieve from RT then I get:

00000000  50 4B 03 04 14 00 09 00 - 08 00 67 FFFD 25 46 00 00
00000010  00 00 00 00 00 00 00 00 - 00 00 1C 00 00 00 73 63
00000020  72 65 65 6E 73 68 6F 74 - 2D 31 37 32 20 32 31 20
00000030  32 34 32 20 36 34 2E 7A - 69 70 32 FFFD FFFD FFFD FFFD 15

As you can see, there are a few wide characters in the attachment and I cannot explain their being there.

I would appreciate any thoughts you have on this. The code I used to generate the hex dump is:

#!/usr/bin/env perl
#
# wctest.pl - A test to see where the wide characters come from.

use strict;
use warnings;
use RT::Client::REST;
use RT::Client::REST::Ticket;
use Data::HexDump;

my $user=&#39;user&#39;;
my $pass=&#39;pass&#39;;

my $rt = RT::Client::REST-&gt;new&#40;
    server  =&gt; &#40;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.local">https://rt.local</a></span>&#39;&#41;,
    basic_auth_cb =&gt; &#40; sub { return &#40;$user, $pass&#41;; } &#41;

&#41;;

$rt-&gt;login&#40; username=&gt; $user, password=&gt; $pass,&#41;;
my $ticket_ptr = RT::Client::REST::Ticket-&gt;new&#40;rt =&gt; $rt&#41;;

my $results = $ticket_ptr-&gt;search&#40; limits =&gt; [ { attribute =&gt; &#39;id&#39;, operator =&gt; &#39;=&#39;, value =&gt; &#39;51447&#39; }, ],&#41;;

my $iterator = $results-&gt;get_iterator;
my &#40;$ticket, $attachments&#41;;
while &#40;$ticket = &#38;$iterator&#41; {
    $attachments = $ticket-&gt;attachments;

    # Store attachments
    my $atch_ater = $attachments-&gt;get_iterator;
    while &#40;my $att = &#38;$atch_ater&#41; {
        next if &#40;$att-&gt;file_name eq &#39;&#39;&#41;;
        print HexDump substr&#40;$att-&gt;content, 0, 64&#41;;
    }
}

My environment is:
        RT instance: 4.0.23
        Perl:5.16.3
        RT Perl libraries: 0.52
        O/S: inux rt50778.a.nominum.com 2.6.32-431.el6.x86_64

. |\/|artin
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;03:29:02&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Patches gladly accepted :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;05&nbsp;03:29:04&nbsp;2018</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;07&nbsp;06:49:12&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Im fairly certain the problem is that the client isnt taking care of RT&#39;s bizare API

From
<span class="clickylink"><a target="new" rel="nofollow" href="https://rt-wiki.bestpractical.com/wiki/REST#Ticket_Attachment">https://rt-wiki.bestpractical.com/wiki/REST#Ticket_Attachment</a></span>


NOTE: RT returns the content indented with 9 spaces on each line, so that it lines up with the &#34;Content:&#34; header. Even if you strip this out with a regexp, the content is still UTF-8, which is probably not what you want. To get the original binary data back, strip out the 9 spaces with a regexp, strip off the 3 carriage returns at the end, and then convert the whole thing from UTF-8 to the native character encoding of the attachment, whatever that is. RT doesn&#39;t tell you, so you have know. If the attachments were uploaded by a U.S. Windows system, odds are that Windows-1252 is what you want. If you can&#39;t get the binary back intact, see the next method below. 

***OR***

Ticket Attachment Content

Gets the attachment data content without additional metadata or whitespace characters

Request: /REST/1.0/ticket/&lt;ticket-id&gt;/attachments/&lt;attachment-id&gt;/content

RT/3.8.0 200 Ok

...

...
...

So to get the original content you still have to strip the first 2 lines of the response. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;08&nbsp;04:47:38&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">attaching some stuff so i can poke it
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> lipsum.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas rhoncus gravida felis sed ultrices. In dui risus, interdum vel viverra et, molestie interdum risus. Praesent et molestie lectus. Nam viverra efficitur leo, non consequat velit iaculis sed. Vestibulum mattis neque a tempus hendrerit. Etiam non tincidunt nunc, id ullamcorper erat. Duis eget eros diam. Nullam sagittis justo eu dui consequat, at pharetra lacus gravida. Sed sodales urna congue suscipit maximus. Nullam quam diam, tempus vitae iaculis vitae, cursus vitae quam. Aliquam vitae enim eros. Vestibulum turpis lacus, sollicitudin ac pharetra quis, ullamcorper ac ante. In efficitur risus dui, et consequat nisi vulputate nec.

Nunc aliquam, sem vitae lacinia luctus, diam nibh consequat lorem, a finibus felis justo ut est. Nulla semper interdum felis a dapibus. Nulla facilisi. Duis ut ultricies ipsum. Phasellus ante velit, cursus sollicitudin sem aliquam, laoreet fringilla mauris. Maecenas arcu neque, fringilla nec nulla sed, pharetra dapibus turpis. Aenean ultrices, urna eu laoreet bibendum, ante nisl aliquam neque, at dignissim sapien felis eget mi. Integer eleifend risus nec neque volutpat ullamcorper. In hac habitasse platea dictumst. Duis porttitor blandit sagittis.

Phasellus gravida ultricies volutpat. Phasellus tincidunt ante eu nibh hendrerit, nec facilisis odio dignissim. Nam maximus, nisi sit amet egestas elementum, lorem sem varius urna, vel luctus augue nunc non risus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla facilisi. Ut vitae neque in augue ornare pulvinar quis at mi. Aenean rutrum arcu tellus, molestie sagittis ipsum aliquam ac. Curabitur et pretium odio, sodales interdum felis. Pellentesque bibendum orci vel fringilla bibendum. Nam eget mauris libero. Nulla fringilla, nunc non varius rutrum, nulla neque aliquet magna, vitae convallis erat turpis a quam. Cras tempus orci sem, in vestibulum diam feugiat lobortis. Proin elementum nibh a nulla malesuada, sit amet aliquet ex ullamcorper.

Fusce fringilla leo elit, quis porta ante ultrices sed. Ut et nunc ut elit egestas tincidunt. Maecenas fringilla varius lacus tincidunt mollis. Fusce lobortis luctus quam, eget mollis nulla sagittis in. Phasellus nec dignissim dolor, vitae lobortis ligula. Nam magna leo, sodales in commodo vel, feugiat sed quam. Maecenas suscipit elementum dui, sed bibendum diam gravida ut. Praesent ornare lacus non augue volutpat, vel consequat mauris ornare. Duis suscipit semper lacinia. Suspendisse egestas scelerisque sodales.

In molestie ligula ligula, ac mattis elit aliquam a. Vestibulum luctus interdum tristique. Donec dolor purus, commodo accumsan luctus in, ultricies ut felis. Suspendisse porta, elit a fermentum lobortis, libero urna tristique massa, at aliquam lacus ligula sed metus. Etiam scelerisque massa vel est feugiat auctor. Nunc ultrices congue eleifend. Duis pellentesque orci pellentesque ullamcorper ullamcorper. Curabitur auctor pulvinar dui, ut blandit metus commodo et. Sed vestibulum rutrum erat, at fringilla turpis rutrum non. Curabitur et maximus tellus. Mauris dictum sit amet turpis efficitur condimentum. Mauris diam justo, luctus id leo sit amet, vestibulum varius nulla. Mauris eget blandit lacus, ac pulvinar tortor. Sed ornare ligula ac ante dignissim faucibus. Morbi eu ligula gravida, condimentum magna at, sollicitudin metus. Vestibulum id justo odio.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> lipsum.txt.xz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;08&nbsp;04:48:03&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">another attachment
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> lipsum.txt.xz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;08&nbsp;05:14:36&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">with .txt files its chopping off the \n at the end. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;08&nbsp;10:13:42&nbsp;2018</span>
    <span class="description">wardmw [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #127288] Problems downloading attachments</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 8 Nov 2018 15:13:19 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-RT-Client-REST [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Martin Ward &lt;wardmw [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Chopping the \r is not necessarily a problem depending on whether it is
translating that in to a \n, i.e. trying to translate Windows line endings
in to unix ones.

Of course it must keep some kind of line ending in there, it shouldn&#39;t just
arbitrarily join up all th lines in a plain text file.

However, I have resolved the problem that I was having, which was as you
suggested, that &#34;the client isnt taking care of RT&#39;s bizare API&#34;.

The RT::Client::Rest Perl library that I am using has a function called
&#34;get_attachment&#34; that requires an optional argument &#34;undecoded&#34; that needed
to be set to 1 to have the script download the files successfully.

It took me longer than necessary to resolve this issue because I had that
written as uudecoded, which is not an unreasonable flag to have but which
is invalid in this instance. I have submitted an RFE to that library
developer to have it warn when an unrecognised flag is used...

Thanks very much for your time and assistance, sorry to have wasted it
trying to resolve a problem  not of your creation.

. |\/|artin

On Thu, 8 Nov 2018 at 10:14, Dean Hamstead via RT &lt;
bug-RT-Client-REST@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=127288">https://rt.cpan.org/Ticket/Display.html?id=127288</a></span> &gt;
&gt;
&gt; with .txt files its chopping off the \n at the end.
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;09&nbsp;06:17:06&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">ok good stuff
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> spaces.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">    
         
   
         
	       


      
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;09&nbsp;06:28:45&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">just adding a file here for testing
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> newspaces.txt</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">         
   
         
      
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;11&nbsp;02:49:44&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">closing
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;11&nbsp;02:49:45&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;11&nbsp;02:49:45&nbsp;2018</span>
    <span class="description">dean [...] fragfest.com.au -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
