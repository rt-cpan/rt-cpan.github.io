<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #88778 for Net-DNS: Net::DNS::Packet::unique_push does not work as advertised</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #88778 for Net-DNS: Net::DNS::Packet::unique_push does not work as advertised</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Net-DNS">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Net-DNS">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Net-DNS">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Net-DNS">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">88778</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Net-DNS">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
calle [...] init.se

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.72    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




0001-Suggested-fix-for-ticket-88778.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1264209/669423/0001-Suggested-fix-for-ticket-88778.patch">
Wed Sep 18 06:37:00 2013 (761b) by calle [...] lysator.liu.se
</a>
</font></li>
</ul>


0001-Tests-to-go-with-the-fix-for-RT88778.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1268819/671885/0001-Tests-to-go-with-the-fix-for-RT88778.patch">
Mon Sep 30 09:24:32 2013 (1.2k) by calle [...] init.se
</a>
</font></li>
</ul>


signature.asc<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1269199/672087/signature.asc">
Tue Oct 01 02:03:34 2013 (163b) by calle [...] init.se
</a>
</font></li>
</ul>


unique_push_bug.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1264192/669410/unique_push_bug.pl">
Wed Sep 18 05:42:58 2013 (264b) by calle [...] lysator.liu.se
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=88778">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1264192" href="/Public/Bug/Display.html?id=88778#txn-1264192">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;18&nbsp;05:42:58&nbsp;2013</span>
    <span class="description">calle [...] lysator.liu.se -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net::DNS::Packet::unique_push does not work as advertised</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1264192/669409/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/669409">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 146b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">When using unique_push on packets received from the net, it will add records that are already there. Script that illustrates the problem included.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> unique_push_bug.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1264192/669410/unique_push_bug.pl">Download unique_push_bug.pl</a><br />
<span class="downloadcontenttype">text/x-perl 264b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/env perl

use strict;
use warnings;

use Net::DNS;

my $res = Net::DNS::Resolver-&gt;new;
my $p   = $res-&gt;send&#40; &#39;www.net-dns.org&#39; &#41;;

my $rr = Net::DNS::RR-&gt;new&#40; &#39;www.net-dns.org.	100	IN	A	213.154.224.135&#39; &#41;;

$p-&gt;unique_push&#40; answer =&gt; $rr &#41;;

$p-&gt;print;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1264209" href="/Public/Bug/Display.html?id=88778#txn-1264209">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;18&nbsp;06:36:59&nbsp;2013</span>
    <span class="description">calle [...] lysator.liu.se -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1264209/669422/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/669422">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 101b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Suggested patch &#40;generated with &#34;git format-patch&#34;&#41;. Not tested with perl versions older than 5.10.1.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0001-Suggested-fix-for-ticket-88778.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1264209/669423/0001-Suggested-fix-for-ticket-88778.patch">Download 0001-Suggested-fix-for-ticket-88778.patch</a><br />
<span class="downloadcontenttype">text/x-diff 761b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 27c4b6071bbb79176568c72b39fd4e46dc836bf8 Mon Sep 17 00:00:00 2001
From: Calle Dybedahl &lt;calle@init.se&gt;
Date: Wed, 18 Sep 2013 12:33:11 +0200
Subject: [PATCH] Suggested fix for ticket #88778

---
 lib/Net/DNS/Packet.pm | 5 +++++
 1 file changed, 5 insertions&#40;+&#41;

diff --git a/lib/Net/DNS/Packet.pm b/lib/Net/DNS/Packet.pm
index 26c8fab..78f6a4c 100644
--- a/lib/Net/DNS/Packet.pm
+++ b/lib/Net/DNS/Packet.pm
@@ -161,6 +161,11 @@ sub decode {
 		$self-&gt;print;
 	}
 
+    foreach my $rr &#40; @{$self-&gt;{answer}}, @{$self-&gt;{authority}}, @{$self-&gt;{additional}} &#41; {
+        next if $rr-&gt;type eq &#39;OPT&#39;;
+        $self-&gt;{seen}-&gt;{lc&#40; $rr-&gt;name &#41; . $rr-&gt;class . $rr-&gt;type . $rr-&gt;rdatastr} += 1;
+    }
+
 	return wantarray ? &#40; $self, $offset &#41; : $self;
 }
 
-- 
1.8.4

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1264210" href="/Public/Bug/Display.html?id=88778#txn-1264210">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;18&nbsp;06:37:00&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1268029" href="/Public/Bug/Display.html?id=88778#txn-1268029">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;28&nbsp;07:16:28&nbsp;2013</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1268029/671485/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/671485">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 344b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Sep 18 06:36:59 2013, CDYBED wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Suggested patch &#40;generated with &#34;git format-patch&#34;&#41;. Not tested with
&gt; perl versions older than 5.10.1.
</div>
unique_push&#40;&#41;is provided for assembling dynamic update requests, and has absolutely no impact on the decoding of inbound packets.

Perhaps you should read our advertising message more carefully.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1268559" href="/Public/Bug/Display.html?id=88778#txn-1268559">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;30&nbsp;02:08:01&nbsp;2013</span>
    <span class="description">calle [...] init.se -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88778] Net::DNS::Packet::unique_push does not work as advertised</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Sep 2013 08:07:47 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Calle Dybedahl &lt;calle [...] init.se&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1268559/671752/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/671752">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 799b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 28 sep 2013, at 13:16, &#34;Dick Franks via RT&#34; &lt;bug-Net-DNS@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88778">https://rt.cpan.org/Ticket/Display.html?id=88778</a></span> &gt;
&gt; 
&gt; On Wed Sep 18 06:36:59 2013, CDYBED wrote:
<div class="message-stanza open">&gt;&gt; Suggested patch &#40;generated with &#34;git format-patch&#34;&#41;. Not tested with
&gt;&gt; perl versions older than 5.10.1.
</div>&gt; 
&gt; unique_push&#40;&#41;is provided for assembling dynamic update requests, and has absolutely no impact on the decoding of inbound packets.
&gt; 
&gt; Perhaps you should read our advertising message more carefully.
</div>

Am I to understand that you are refusing my patch on the grounds that I&#39;m using the library for something other than what you intended? This is not just a spurious patch, I&#39;m trying to fix an actual problem I&#39;m having in real-life code.

-- 
Calle Dybedahl
calle@init.se -*- +46 703 - 970 612
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1268757" href="/Public/Bug/Display.html?id=88778#txn-1268757">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;30&nbsp;08:36:19&nbsp;2013</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1268757/671859/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/671859">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 850b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Sep 30 02:08:01 2013, calle@init.se wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Am I to understand that you are refusing my patch on the grounds that
&gt; I&#39;m using the library for something other than what you intended? This
&gt; is not just a spurious patch, I&#39;m trying to fix an actual problem I&#39;m
&gt; having in real-life code.
</div>
No, you can do what you wish with Net::DNS.

But your patch modifies packet-&gt;decode&#40;&#41;, which is the wrong place to do it.

The semantic of each section is different, so uniqueness can never stretch across more than one section. The obvious failing case being:

    $update-&gt;push&#40; pre =&gt; yxrrset&#40;&#39;foo.example 600 A 192.0.2.1&#39;&#41; &#41;;
    $update-&gt;unique_push&#40; upd =&gt; rr_add&#40;&#39;foo.example 3600 A 192.0.2.1&#39;&#41; &#41;;

However, your idea that unique_push&#40;&#41; should take account of what is already there is not unreasonable.  Proper solution is already on SVN trunk.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1268819" href="/Public/Bug/Display.html?id=88778#txn-1268819">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;30&nbsp;09:24:32&nbsp;2013</span>
    <span class="description">calle [...] init.se -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88778] Net::DNS::Packet::unique_push does not work as advertised</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Sep 2013 15:24:11 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Calle Dybedahl &lt;calle [...] init.se&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1268819/671884/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/671884">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 30 sep 2013, at 14:36, Dick Franks via RT &lt;bug-Net-DNS@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But your patch modifies packet-&gt;decode&#40;&#41;, which is the wrong place to do it.
&gt; 
&gt; The semantic of each section is different, so uniqueness can never stretch across more than one section. The obvious failing case being:
&gt; 
&gt;    $update-&gt;push&#40; pre =&gt; yxrrset&#40;&#39;foo.example 600 A 192.0.2.1&#39;&#41; &#41;;
&gt;    $update-&gt;unique_push&#40; upd =&gt; rr_add&#40;&#39;foo.example 3600 A 192.0.2.1&#39;&#41; &#41;;
&gt; 
</div>
As I understood the code, that distinction wasn&#39;t made before, and I was going for the smallest necessary change. It&#39;s quite possible that I misunderstood. As for the functionality, you are of course quite right.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; However, your idea that unique_push&#40;&#41; should take account of what is already there is not unreasonable.  Proper solution is already on SVN trunk.
</div>
Yes, I see it now. Thank you. I don&#39;t see tests for it in the commit, so I&#39;m trying to attach a small patch with some to this email. Not sure what the email gateway will do to it, but I&#39;ll guess we&#39;ll see.

-- 
Calle Dybedahl
calle@init.se -*- +46 703 - 970 612
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1268819/671885/0001-Tests-to-go-with-the-fix-for-RT88778.patch">Download 0001-Tests-to-go-with-the-fix-for-RT88778.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1.2k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1268978" href="/Public/Bug/Display.html?id=88778#txn-1268978">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;30&nbsp;16:26:45&nbsp;2013</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1268978/671967/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/671967">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 244b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Sep 30 09:24:32 2013, calle@init.se wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yes, I see it now. Thank you. I don&#39;t see tests for it in the commit,
&gt; so I&#39;m trying to attach a small patch with some to this email.
</div>
Test coverage of existing test script is sufficient.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1269199" href="/Public/Bug/Display.html?id=88778#txn-1269199">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;01&nbsp;02:03:34&nbsp;2013</span>
    <span class="description">calle [...] init.se -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88778] Net::DNS::Packet::unique_push does not work as advertised</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 1 Oct 2013 08:03:12 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Calle Dybedahl &lt;calle [...] init.se&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1269199/672086/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/672086">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 299b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On 30 sep 2013, at 22:26, &#34;Dick Franks via RT&#34; &lt;bug-Net-DNS@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Test coverage of existing test script is sufficient.
</div>
They give a pass to the code &#40;0.72 release&#41; where the bug is present. But it&#39;s your code, you decide.

-- 
Calle Dybedahl
calle@init.se -*- +46 703 - 970 612
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1269199/672087/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 163b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1269254" href="/Public/Bug/Display.html?id=88778#txn-1269254">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;01&nbsp;05:54:26&nbsp;2013</span>
    <span class="description">olaf [...] NLnetLabs.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #88778] Net::DNS::Packet::unique_push does not work as advertised</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 1 Oct 2013 11:53:51 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-DNS [...] rt.cpan.org&#34; &lt;bug-Net-DNS [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Olaf Kolkman &lt;olaf [...] NLnetLabs.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1269254/672121/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/672121">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 747b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">

My â‚¬0.02 contribution: 

I believe that tests that pass when users have identified bugs do not provide sufficient coverage. I&#39;m with Calle on this. 

--Olaf

----
Composed on a mobile device: more typos guaranteed. 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 1 okt. 2013, at 08:03, &#34;calle@init.se via RT&#34; &lt;bug-Net-DNS@rt.cpan.org&gt; wrote:
&gt; 
&gt;       Queue: Net-DNS
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=88778">https://rt.cpan.org/Ticket/Display.html?id=88778</a></span> &gt;
&gt; 
&gt; 
<div class="message-stanza open">&gt;&gt; On 30 sep 2013, at 22:26, &#34;Dick Franks via RT&#34; &lt;bug-Net-DNS@rt.cpan.org&gt; wrote:
&gt;&gt; 
&gt;&gt; Test coverage of existing test script is sufficient.
</div>&gt; 
&gt; They give a pass to the code &#40;0.72 release&#41; where the bug is present. But it&#39;s your code, you decide.
&gt; 
&gt; -- 
&gt; Calle Dybedahl
&gt; calle@init.se -*- +46 703 - 970 612
&gt; 
&gt; 
&gt; 
&gt; 
&gt; &lt;signature.asc&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1269436" href="/Public/Bug/Display.html?id=88778#txn-1269436">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;01&nbsp;11:23:37&nbsp;2013</span>
    <span class="description">rwfranks [...] acm.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rwfranks [...] acm.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1269436/672222/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/672222">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 731b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 01 05:54:26 2013, olaf@NLnetLabs.nl wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 
&gt; My â‚¬0.02 contribution:
&gt; 
&gt; I believe that tests that pass when users have identified bugs do not
&gt; provide sufficient coverage. I&#39;m with Calle on this.
</div>
Calle&#39;s proposal is an extension of function, more than a bug.  Although it has to be said that the documentation was less than helpful.

The uniqueness function is adequately tested by existing test. This tests all the new code.

Extending code to include existing RRs is a trivial addition &#40;to code, but not function&#41;.
If the trivial addition did not work, all pre-existing RRs would be deleted from section.
Existing test also detects that &#40;fails 25 out of 77&#41;.

Existing test therefore has adequate coverage.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1287493" href="/Public/Bug/Display.html?id=88778#txn-1287493">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;13&nbsp;09:36:36&nbsp;2013</span>
    <span class="description">NLNETLABS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1287493/682251/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/682251">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 42b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is fixed in the upcoming 0.73 release
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1287496" href="/Public/Bug/Display.html?id=88778#txn-1287496">#</a>      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;13&nbsp;09:36:37&nbsp;2013</span>
    <span class="description">NLNETLABS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.599973</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
