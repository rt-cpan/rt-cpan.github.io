<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #111452 for Pod-Weaver-Section-Source-DefaultGitHub: [PATCH] Creates a ReplaceSource::DefaultGitHub version of the section plugin</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #111452 for Pod-Weaver-Section-Source-DefaultGitHub: [PATCH] Creates a ReplaceSource::DefaultGitHub version of the section plugin</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Pod-Weaver-Section-Source-DefaultGitHub/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Pod-Weaver-Section-Source-DefaultGitHub/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Pod-Weaver-Section-Source-DefaultGitHub/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Pod-Weaver-Section-Source-DefaultGitHub/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Pod-Weaver-Section-Source-DefaultGitHub">Pod-Weaver-Section-Source-DefaultGitHub CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">111452</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Pod-Weaver-Section-Source-DefaultGitHub/Active/">Pod-Weaver-Section-Source-DefaultGitHub</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mgrimes [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-252176-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-252177-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;18:10:33&nbsp;2016</span>
    <span class="description">mgrimes [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> Mark Grimes &lt;mgrimes [...] cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Creates a ReplaceSource::DefaultGitHub version of the section plugin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Jan 2016 18:09:30 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Pod-Weaver-Section-Source-DefaultGitHub [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Grimes &lt;mgrimes [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">- Uses the Pod::Weaver::Role::SectionReplacer role to replace the
  section if it already exists. This is useful for standalone podweaver
  usage. It has been use/proven in
  Pod::Weaver::PluginBundle::ReplaceBoilerplate,
  Pod::Weaver::Section::Replace{Name,Version,Authors,etc}.
---
 .../Weaver/Section/ReplaceSource/DefaultGitHub.pm  | 59 ++++++++++++++++++++++
 1 file changed, 59 insertions&#40;+&#41;
 create mode 100644 lib/Pod/Weaver/Section/ReplaceSource/DefaultGitHub.pm

diff --git a/lib/Pod/Weaver/Section/ReplaceSource/DefaultGitHub.pm b/lib/Pod/Weaver/Section/ReplaceSource/DefaultGitHub.pm
new file mode 100644
index 0000000..4f5fe2f
--- /dev/null
+++ b/lib/Pod/Weaver/Section/ReplaceSource/DefaultGitHub.pm
@@ -0,0 +1,59 @@
+package Pod::Weaver::Section::ReplaceSource::DefaultGitHub;
+
+# DATE
+# VERSION
+
+use 5.010001;
+use Moose;
+#use Text::Wrap &#40;&#41;;
+extends &#39;Pod::Weaver::Section::Source::DefaultGitHub&#39;;
+with &#39;Pod::Weaver::Role::SectionReplacer&#39;;
+
+sub default_section_name { &#39;SOURCE&#39; }
+
+no Moose;
+1;
+# ABSTRACT: Replaces a SOURCE section &#40;repository defaults to GitHub&#41;
+
+=for Pod::Coverage weave_section
+
+=head1 SYNOPSIS
+
+This section plugin provides the same behaviour as
+L&lt;Pod::Weaver::Section::Source::DefaultGitHub&gt; but with the
+Pod::Weaver::Role::SectionReplacer role applied.
+
+In your C&lt;weaver.ini&gt;:
+
+ [Source::DefaultGitHub]
+
+If C&lt;repository&gt; is not specified in dist.ini, will search for github user/repo
+name from git config file &#40;C&lt;.git/config&gt;&#41;.
+
+To specify a source repository other than C&lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/USER/REPO">https://github.com/USER/REPO</a></span>&gt;, in
+dist.ini:
+
+ [MetaResources]
+ repository=<span class="clickylink"><a target="new" rel="nofollow" href="http://example.com/">http://example.com/</a></span>
+
+
+=head1 DESCRIPTION
+
+This section plugin adds a SOURCE section, using C&lt;repository&gt; metadata or &#40;if
+not specified&#41; GitHub.
+
+
+=head1 ATTRIBUTES
+
+=head2 text
+
+The text that is added. C&lt;%s&gt; is replaced by the repository url.
+
+Default: C&lt;Source repository is at LE&lt;lt&gt;%sE&lt;gt&gt;.&gt;
+
+
+=head1 SEE ALSO
+
+L&lt;Pod::Weaver::Section::SourceGitHub&gt;
+
+=cut
-- 
2.7.0
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;27&nbsp;06:48:34&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think this should be in a separate dist. BTW, I tried creating such dist [1] but haven&#39;t released it. Turns out that the section adds text instead of replaces it? So if I put this in weaver.ini:

    [ReplaceSource::DefaultGitHub]
    [ReplaceSource::DefaultGitHub/2]

then the text in SOURCE section would become:

    Source repository is at
    &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-Perinci-Result-Format-Lite">https://github.com/perlancar/perl-Perinci-Result-Format-Lite</a></span>&gt;.

    Source repository is at
    &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-Perinci-Result-Format-Lite">https://github.com/perlancar/perl-Perinci-Result-Format-Lite</a></span>&gt;.

Is this the desired result? I&#39;d thought the text would only contain a single:
    
    Source repository is at
    &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-Perinci-Result-Format-Lite">https://github.com/perlancar/perl-Perinci-Result-Format-Lite</a></span>&gt;.

[1] <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/perlancar/perl-Pod-Weaver-Section-ReplaceSource-DefaultGitHub">https://github.com/perlancar/perl-Pod-Weaver-Section-ReplaceSource-DefaultGitHub</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;27&nbsp;06:48:36&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;27&nbsp;08:20:03&nbsp;2016</span>
    <span class="description">mgrimes [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the quick response. A new distribution sounds good to me. 

I tested the new GitHub repo, and it seems to work. The ::SectionReplacer role is meant to be used when an author keeps the &#34;weaved&#34; version of a module in their repo. This is in contrast to the typical dzil use case, where the version in the repo has none of the boilerplate and each podweaver run can just add boilerplate sections. 

    weaver.ini        
    [Source::DefaultGitHub]
 
    $ podweaver
    $ podweaver

Results in multiple SOURCE sections.

If we use the version with the ::SectionReplacer role, then podweaver first removes the section and then weave_section can re-add it. So, it is safe to run podweaver multiple times on the same files.

     weaver.ini
     [ReplaceSource::DefaultGitHub]

     $ podweaver
     $ podweaver

Results in just one SOURCE section.

I really prefer this setup. Any commit to my repo has the full distribution with boilerplate, but I don&#39;t have to worry about maintaining it.

Thanks,
Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;29&nbsp;22:57:04&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The dist is now released. Closing ticket now. Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;29&nbsp;22:57:15&nbsp;2016</span>
    <span class="description">PERLANCAR [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
