<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #50576 for CGI: CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39; &#40; Needs peer review &#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #50576 for CGI: CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39; &#40; Needs peer review &#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CGI/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CGI/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CGI/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CGI/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/leejo/CGI.pm/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI">CGI CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">50576</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CGI/Active/">CGI</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">MARKSTOS [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jackyf.devel [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
cpan [...] chmrr.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-230860-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-230861-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;16&nbsp;17:15:37&nbsp;2009</span>
    <span class="description">http://jackyf.livejournal.com/ -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=64308">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=64308</a></span>:

Conforming to RFC2109, the &#39;Expires&#39; field is deprecated in favour of
&#39;Max-Age&#39;. Please provide both fields to conform both &#34;old&#34;
specification and &#34;modern&#34; one.

E.g. this one should have also &#39;Max-Age&#39; &#34;field&#34;.

$ perl -MCGI::Cookie -le &#39;$a=CGI::Cookie-&gt;new&#40;q{-name} =&gt; &#39;ID&#39;,
q{-expires} =&gt; &#34;+3M&#34;&#41;; print $a-&gt;as_string&#40;&#41;&#39;
ID=; path=/; expires=Thu, 14-Jan-2010 19:51:06 GMT


Perl version: 5.10.1.
OS: Debian.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;17&nbsp;10:50:55&nbsp;2009</span>
    <span class="description">yanick [...] babyl.dyndns.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> yanick+cpan [...] babyl.dyndns.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50576] CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 17 Oct 2009 10:54:03 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI.pm [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Yanick Champoux &lt;yanick [...] babyl.dyndns.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span class="clickylink"><a target="new" rel="nofollow" href="http://jackyf.livejournal.com/">http://jackyf.livejournal.com/</a></span> via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; From <span class="clickylink"><a target="new" rel="nofollow" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=64308">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=64308</a></span>:
&gt; 
&gt; Conforming to RFC2109, the &#39;Expires&#39; field is deprecated in favour of
&gt; &#39;Max-Age&#39;. Please provide both fields to conform both &#34;old&#34;
&gt; specification and &#34;modern&#34; one.
&gt; 
&gt; E.g. this one should have also &#39;Max-Age&#39; &#34;field&#34;.
&gt; 
&gt; $ perl -MCGI::Cookie -le &#39;$a=CGI::Cookie-&gt;new&#40;q{-name} =&gt; &#39;ID&#39;,
&gt; q{-expires} =&gt; &#34;+3M&#34;&#41;; print $a-&gt;as_string&#40;&#41;&#39;
&gt; ID=; path=/; expires=Thu, 14-Jan-2010 19:51:06 GMT
</div>
        I&#39;ve peeked into CGI::Cookie, and support for max-age seems to already 
be stubbed in.  I&#39;ll try to dig a little deeper today and see in the 
history if there&#39;s a reason why it&#39;s not active yet.

Cheers,
`/anick
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;17&nbsp;10:50:56&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;01&nbsp;14:33:51&nbsp;2009</span>
    <span class="description">yanick+cpan [...] babyl.dyndns.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">A tentative patch is at <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/yanick/CGI.pm/tree/rt-50576">http://github.com/yanick/CGI.pm/tree/rt-50576</a></span>

Points of discussion/caveats:

* By default, the cookie now prints both &#39;Expires&#39; and &#39;Max-Age&#39; fields.
 Their display can be controlled via the show_expires/show_max_age
methods or the -show_expires/-show_max_age new&#40;&#41; arguments.

* The time to live can now be set using max_age&#40;&#41; or expires&#40;&#41;.  They
both modify the same underlaying value.

* If the time to live is specified as a date string, the module
Date::Parse is used to convert it into a timestamp.

* CGI.pm has not been modified to follow the same convention &#40;yet&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;18&nbsp;22:13:41&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;20&nbsp;12:53:54&nbsp;2009</span>
    <span class="description">cpan [...] chmrr.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Nov 01 14:33:51 2009, YANICK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; A tentative patch is at <span class="clickylink"><a target="new" rel="nofollow" href="http://github.com/yanick/CGI.pm/tree/rt-50576">http://github.com/yanick/CGI.pm/tree/rt-50576</a></span>
</div>
Mark asked me to peer-review this patchset in order to help get a
release of CGI.pm out the door.  It looks pretty good to me, with one
caveat, below.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * By default, the cookie now prints both &#39;Expires&#39; and &#39;Max-Age&#39; fields.
&gt;  Their display can be controlled via the show_expires/show_max_age
&gt; methods or the -show_expires/-show_max_age new&#40;&#41; arguments.
</div>
I somewhat agree with Mark on this -- I&#39;m not convinced that such
fine-grained control is necessary.  In my mind, sending both is unlikely
to ever cause problems.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * If the time to live is specified as a date string, the module
&gt; Date::Parse is used to convert it into a timestamp.
</div>
This _is_ going to possibly cause problems -- Date::Parse isn&#39;t in core,
but CGI.pm is.  The options which provide similar functions, which _are_
in core, are Time::Piece-&gt;strptime or Time::Local::timegm.  Hauling in
Time::Piece seems heavier-weight, but the implementation will be easier.
 Thoughts?
 - Alex
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;20&nbsp;13:13:13&nbsp;2009</span>
    <span class="description">yanick [...] babyl.dyndns.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50576] CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 20 Nov 2009 13:12:47 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI.pm [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Yanick Champoux &lt;yanick [...] babyl.dyndns.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On November 20, 2009 12:53:55 pm Alex Vandiver via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; * By default, the cookie now prints both &#39;Expires&#39; and &#39;Max-Age&#39; fields.
&gt; &gt;  Their display can be controlled via the show_expires/show_max_age
&gt; &gt; methods or the -show_expires/-show_max_age new&#40;&#41; arguments.
</div>&gt;
&gt; I somewhat agree with Mark on this -- I&#39;m not convinced that such
&gt; fine-grained control is necessary.  In my mind, sending both is unlikely
&gt; to ever cause problems.
</div>
        I also agree.  I couldn&#39;t think of an example where having both would cause 
harm, buuut I thought that giving peeps the control if they so desire was the 
ultimate insurance against gotchas.  But I agree, we can always take that out.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; * If the time to live is specified as a date string, the module
&gt; &gt; Date::Parse is used to convert it into a timestamp.
</div>&gt;
&gt; This _is_ going to possibly cause problems -- Date::Parse isn&#39;t in core,
&gt; but CGI.pm is.  
</div>
        Very good point.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The options which provide similar functions, which _are_
&gt; in core, are Time::Piece-&gt;strptime or Time::Local::timegm.  Hauling in
&gt; Time::Piece seems heavier-weight, but the implementation will be easier.
&gt;  Thoughts?
</div>
        Time::Piece would be good. And this will only happen in the weird cases where 
someone would enter the expiry date as an absolute date instead of a delta.  

        I&#39;ll be offline for the next 3 days, but I&#39;ll try to bring in those changes 
asap.  Or any of you can fork my github branch and play with it, if you so 
desire. :-&#41;

Thanks!
`/anick
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;24&nbsp;00:20:47&nbsp;2009</span>
    <span class="description">cpan [...] chmrr.net -  Cc ALEXMV added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;29&nbsp;20:07:22&nbsp;2009</span>
    <span class="description">yanick [...] babyl.dyndns.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50576] CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 29 Nov 2009 20:09:35 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI.pm [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Yanick Champoux &lt;yanick [...] babyl.dyndns.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Alex Vandiver via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; * By default, the cookie now prints both &#39;Expires&#39; and &#39;Max-Age&#39; fields.
&gt;&gt;  Their display can be controlled via the show_expires/show_max_age
&gt;&gt; methods or the -show_expires/-show_max_age new&#40;&#41; arguments.
</div>&gt; 
&gt; I somewhat agree with Mark on this -- I&#39;m not convinced that such
&gt; fine-grained control is necessary.  In my mind, sending both is unlikely
&gt; to ever cause problems.
</div>
        Both arguments removed.  If an expire/max-age has been specified, we 
put both fields in the header &#40;and if nothing has been specified, we 
output nothing&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; * If the time to live is specified as a date string, the module
&gt;&gt; Date::Parse is used to convert it into a timestamp.
</div>&gt; 
&gt; This _is_ going to possibly cause problems -- Date::Parse isn&#39;t in core,
&gt; but CGI.pm is.  The options which provide similar functions, which _are_
&gt; in core, are Time::Piece-&gt;strptime or Time::Local::timegm.  Hauling in
&gt; Time::Piece seems heavier-weight, but the implementation will be easier.
&gt;  Thoughts?
</div>
        I&#39;ve switched Date::Parse for Time::Piece.  The big difference is that 
Time::Piece requires its string to be in a very specific format, whereas 
D::P would do its damnedest to figure out what the user want.    Before 
we didn&#39;t have this problem because we would just output verbatim an 
recognized string -- something we can&#39;t do anymore before we have to 
compute the time delta for max-age.  That shouldn&#39;t be too much of an 
issue, hopefully.  I expect that very few people use absolute dates for 
their expire data.

`/anick
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;02&nbsp;23:13:52&nbsp;2009</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve looked at some more.  Some notes:

- The original bug report from the year 2000. CGI::Cookie got max-age 
support in September 2002, in the 2.83 release.

- When researching this, I came across an article I&#39;d written about it 
myself: <span class="clickylink"><a target="new" rel="nofollow" href="http://mark.stosberg.com/blog/2008/12/cookie-handling-in-">http://mark.stosberg.com/blog/2008/12/cookie-handling-in-</a></span>
titanium-catalyst-and-mojo.html

- The Max-Age support currently in CGI.pm can be considered incomplete 
in the sense that it has a &#34;documentation bug&#34;. Using max-age is not 
documented, and there is nothing to inform the user that max-age is the 
header used in the spec, or advise about which header to use in terms of 
practical browser compatibility. Since CGI.pm is a low-level library for 
a number of projects, I have some inclination to provide users very fine 
grained support: If use you &#39;expires&#39; you set the Expires header, and if 
you use &#34;max_age&#34;, you set the Max-Age header. If you want them both, 
you should set them both. Clearly, setting just &#34;Expires&#34; works fine for 
pratical cases. The downstream bug report is only complaining that we 
don&#39;t technically follow the spec... it&#39;s not reporting that any known 
browser actually recognizes only Max-Age and not Expires. 

This approach would be perfectly backwards compatible, and saves a bit 
processing power to generate both headers when really only one is 
desired. Any of the projects built-on CGI.pm can choose to provide a way 
to set both headers at once if they want to. 

What I&#39;m proposing has the fine-grained control of Yanick&#39;s original 
proposal, but I think is a simpler way to accomplish it. 

I think always setting both headers might introduce backwards 
compatibility issues in some cases simply by being a different behavior, 
even if it shouldn&#39;t normally cause a problem.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;25&nbsp;22:03:05&nbsp;2010</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> for final review, new &#39;Max-Age&#39; implementation</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yanick,

I have taken a second try at the Max-Age support. It is available here:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/markstos/CGI.pm/tree/max-age-cookie-take-2">https://github.com/markstos/CGI.pm/tree/max-age-cookie-take-2</a></span>

I manually incorporated some of the ideas and code from the original 
branch where it applied.

I started over because as the ticket reflects, the line of thinking 
changed. Originally, we worked on managing the two headers together. 

The current proposed approach is to manage them individually. This is 
completely backwards compatible, and gives the flexibilities to users or 
frameworks to use their own method manage the fields together if they 
prefer.

If the changes and docs look OK to use, please go ahead and pull the 
work to my &#34;master&#34; branch and let&#39;s consider this done. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction dates Told even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;23&nbsp;20:47:27&nbsp;2011</span>
    <span class="description">MARKSTOS [...] cpan.org -  Told changed from Sat Dec 25 22:03:06 2010 to Sun Jan 23 20:47:27 2011</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;23&nbsp;20:48:15&nbsp;2011</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> yanick [...] babyl.dyndns.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#40; If anyone else besides Yanick wants to provide a peer review, that&#39;s 
always welcome, too. &#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;23&nbsp;20:48:38&nbsp;2011</span>
    <span class="description">MARKSTOS [...] cpan.org -  Subject changed from &#39;CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39;&#39; to &#39;CGI::Cookie doesn&#39;t conform to RFC2109, &#39;Max-Age&#39; &#40; Needs peer review &#41;&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;22&nbsp;08:05:10&nbsp;2014</span>
    <span class="description">LEEJO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This issue has been copied to: <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/leejo/CGI.pm/issues/60">https://github.com/leejo/CGI.pm/issues/60</a></span> please take all future correspondence there.
This ticket will remain open but please do not reply here.
This ticket will be closed when the github issue is dealt with.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;23&nbsp;14:28:04&nbsp;2014</span>
    <span class="description">The RT System itself -  Queue changed from CGI.pm to CGI</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;18&nbsp;03:37:28&nbsp;2014</span>
    <span class="description">LEEJO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Resolved, will go out in next release to CPAN. Thanks.

commit 7d46fae0f0baed36488d1bd4e4e05c3505f14008
Author: Lee Johnson &lt;lee@givengain.ch&gt;
Date:   Wed Jun 18 09:30:48 2014 +0200

    resolve #60 [rt.cpan.org #50576] - cookie -max-age

    argument to CGI::Cookie is now correctly set when this is passed in
    the constructor. previously the value from the -expires argument was
    being used, meaning it was not possible to pass *only* the -max-age
    argument and have this set. this also means that the values for the
    -max-age and -expires arguments can be different, should you want to
    do something like that

    update tests to reflect above change and increase coverage for the
    -max-age constructor argument / max_age method. also update perldoc
    adding missing documentation for the max_age method
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;18&nbsp;03:37:31&nbsp;2014</span>
    <span class="description">LEEJO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
