<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #63392 for Prima: fill_ellipse&#40;&#41; 5x3 extra pixel</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #63392 for Prima: fill_ellipse&#40;&#41; 5x3 extra pixel</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Prima">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Prima">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Prima">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Prima">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Prima">Prima CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">63392</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Prima">Prima</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
user42 [...] zip.com.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-27120-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-27121-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




bar.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/860789/445509/bar.pl">
Sat Nov 27 19:58:14 2010 (330b) by user42 [...] zip.com.au
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=63392">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-860789" href="/Public/Bug/Display.html?id=63392#txn-860789">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;27&nbsp;19:58:14&nbsp;2010</span>
    <span class="description">user42 [...] zip.com.au -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> fill_ellipse&#40;&#41; 5x3 extra pixel</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 28 Nov 2010 11:57:02 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Prima [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/860789/445508/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/445508">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 595b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">In recent debian Prima 1.28 the program bar.pl draws a 5x3 filled
ellipse and gets

    &#34;q  c #000000&#34;,
    &#34;w  c #FFFFFF&#34;,
    &#34;qwwwq&#34;,
    &#34;wwwww&#34;,
    &#34;qwwww&#34;};

where I expected that the bottom right pixel would be black &#34;q&#34;

    &#34;qwwwq&#34;};

which would be symmetric.

Nosing around the code I suspect the width,height passed to XFillArc is
1 too big.  Or at least it seems to be the XFillArc which draws the
extraneous corner pixel.

I like the way an extra XDrawArc does the outermost pixels which
XFillArc doesn&#39;t, per the drawing model and specs, but just perhaps the
XFillArc is too big.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/860789/445509/bar.pl">Download bar.pl</a><br />
<span class="downloadcontenttype">text/x-perl 330b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">use strict;
use warnings;
use Prima;
use Prima::Const;

my $d = Prima::Image-&gt;create &#40;width =&gt; 5, height =&gt; 3&#41;;
$d-&gt;begin_paint;

$d-&gt;color &#40;cl::Black&#41;;
$d-&gt;bar &#40;0,0, 4,0&#41;;

$d-&gt;color &#40;cl::White&#41;;
$d-&gt;fill_ellipse &#40;2,1, 5,3&#41;;

$d-&gt;end_paint;
$d-&gt;save&#40;&#39;/tmp/foo.xpm&#39;&#41; or die &#34;Error saving:$@\n&#34;;
system &#34;cat /tmp/foo.xpm&#34;;
exit 0;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-862126" href="/Public/Bug/Display.html?id=63392#txn-862126">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;30&nbsp;15:13:54&nbsp;2010</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63392] fill_ellipse&#40;&#41; 5x3 extra pixel</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 01 Dec 2010 07:13:40 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Prima [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/862126/446269/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446269">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 739b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Incidentally, other possibility for a filled ellipse might be to set the
GC line width to half the radius and XDrawArc a correspondingly smaller
box.  If the line width is rounded up to the next odd integer then it
can cover the extra 1/2 pixel that an XFillArc doesn&#39;t do.

I wonder if that would help GCxor mode where two drawing requests would
otherwise step on each other&#39;s toes &#40;the cases the
FILL_ANTIDEFECT_REPAIRABLE doesn&#39;t cover, if I understand that&#41;.

In some of my own code I&#39;ve still got the FillArc+PolyArc combination.


-- 
The sigfile political applications of mathematics series:
&#34;The rate of increase of inflation is decreasing&#34;
   -- Nixon in 1972 appealing to a third derivative in his campaign for
      re-election
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-862162" href="/Public/Bug/Display.html?id=63392#txn-862162">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;30&nbsp;16:43:57&nbsp;2010</span>
    <span class="description">KARASIK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/862162/446290/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446290">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 924b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Втр Ноя 30 15:13:54 2010, user42@zip.com.au писал:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Incidentally, other possibility for a filled ellipse might be to set the
&gt; GC line width to half the radius and XDrawArc a correspondingly smaller
&gt; box. 
&gt; If the line width is rounded up to the next odd integer then it
&gt; can cover the extra 1/2 pixel that an XFillArc doesn&#39;t do.
&gt; 
&gt; I wonder if that would help GCxor mode where two drawing requests would
&gt; otherwise step on each other&#39;s toes &#40;the cases the
&gt; FILL_ANTIDEFECT_REPAIRABLE doesn&#39;t cover, if I understand that&#41;.
</div>
Exactly. XFillArc doesn&#39;t do a very good job, so the code tries to help
it with XDrawArc. But in xor mode we can&#39;t do much.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In some of my own code I&#39;ve still got the FillArc+PolyArc combination.
</div>
Do you have a good algorithm with this combination that can be used
generally here? Does that also include the half-width GC line, you
mentioned above? A patch would be great then.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-862164" href="/Public/Bug/Display.html?id=63392#txn-862164">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;30&nbsp;16:43:58&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-862193" href="/Public/Bug/Display.html?id=63392#txn-862193">#</a>      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;30&nbsp;17:48:59&nbsp;2010</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63392] fill_ellipse&#40;&#41; 5x3 extra pixel</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 01 Dec 2010 09:48:31 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Prima [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/862193/446307/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446307">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;KARASIK via RT&#34; &lt;bug-Prima@rt.cpan.org&gt; writes:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
<div class="message-stanza open">&gt;&gt; In some of my own code I&#39;ve still got the .
</div>&gt;
&gt; Do you have a good algorithm with this combination that can be used
&gt; generally here?
</div>
Oh, the FillArc+DrawArc I only arrived at the same as you presumably
did.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Does that also include the half-width GC line, you
&gt; mentioned above?
</div>
Concept code below for the half-width idea.  Apologies for it being gtk
based.  Gtk is bloat on top of xlib, draw_arc&#40;&#41; is XDrawArc.

To do a 20x10 ellipse it draws line width 5 with the ellipse line at
y=2.  This means the line extends up by 2.5 from the centre of the y=2
pixel, thus taking in the whole of the y=0 pixel.

Not certain if I&#39;ve got the rounding right for all different odd/even
sizes &#40;or modulo 4 or what :-&#41;.

Slightly ironically I don&#39;t think this works for 5x3, because the 3 ends
up drawing h=0, and the same missing end pixel as the other 5x1 ticket!

At any rate, this may be an idea for bigger ones.  height==3 or width==3
could be made a special case with three lines or a little polygon or
something.  The middle of the 3 rows is full width, and not too hard to
take a sqrt&#40;&#41; for how many pixels desired on the two top and bottom
rows.



use 5.008;
use strict;
use warnings;
use Gtk2 &#39;-init&#39;;
use List::Util &#39;min&#39;;

my $width = 20;
my $height = 10;

my $rootwin = Gtk2::Gdk-&gt;get_default_root_window;
my $pixmap = Gtk2::Gdk::Pixmap-&gt;new &#40;$rootwin, $width, $height, -1&#41;;
my $black = Gtk2::Gdk::Color-&gt;new&#40;0,0,0,0&#41;;
my $gc = Gtk2::Gdk::GC-&gt;new &#40;$rootwin,
                             { line_width =&gt; 1,
                               foreground =&gt; $black,
                             }&#41;;
$pixmap-&gt;draw_rectangle &#40;$gc,
                         1, # fill
                         0, 0,
                         $width,$height&#41;;

my $line_width = min &#40;$height/2, $width/2&#41;;
$line_width = int&#40;$line_width + .5&#41;;  # up to integer
$line_width += !&#40;$line_width&#38;1&#41;; # up to next odd integer
print &#34;line_width=$line_width\n&#34;;

my $white = Gtk2::Gdk::Color-&gt;new&#40;0xFFFF,0xFFFF,0xFFFF,0xFFFFFF&#41;;
$gc = Gtk2::Gdk::GC-&gt;new &#40;$rootwin,
                          { line_width =&gt; $line_width,
                            function =&gt; &#39;xor&#39;,
                            foreground =&gt; $white,
                          }&#41;;

my $shrink = int&#40;$line_width/2&#41;; # round down
print &#34;shrink=$shrink\n&#34;;

my $x = 0 + $shrink;
my $y = 0 + $shrink;
my $w = $width-1 - 2*$shrink;
my $h = $height-1 - 2*$shrink;
print &#34;x=$x, y=$y, w=$w, h=$h\n&#34;;
$pixmap-&gt;draw_arc &#40;$gc,
                   0, # unfilled
                   $x,$y, $w,$h,
                   0, 360*64&#41;;

print &#34;\n&#34;;
my $pixbuf = Gtk2::Gdk::Pixbuf-&gt;get_from_drawable
  &#40;$pixmap, undef, 0,0, 0,0, $width,$height&#41;;
$pixbuf-&gt;save &#40;&#39;/tmp/x.png&#39;, &#39;png&#39;&#41;;
system &#40;&#34;convert -monochrome /tmp/x.png /tmp/x.xpm &#38;&#38; cat /tmp/x.xpm&#34;&#41;;
exit 0;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-862455" href="/Public/Bug/Display.html?id=63392#txn-862455">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;01&nbsp;08:55:26&nbsp;2010</span>
    <span class="description">KARASIK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/862455/446475/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446475">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 264b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I see, thanks! I doubt though that I&#39;ll have time soon to experiment
with this. Too bad that it doesn&#39;t work for 5x3, but well, if it doesn&#39;t
work, then we can&#39;t use it really, sorry. Or rather, I don&#39;t see why one
flawed algorithm should be replaced with another.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-862551" href="/Public/Bug/Display.html?id=63392#txn-862551">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;01&nbsp;14:17:26&nbsp;2010</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63392] fill_ellipse&#40;&#41; 5x3 extra pixel</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 02 Dec 2010 06:17:10 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Prima [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/862551/446521/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/446521">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 318b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;KARASIK via RT&#34; &lt;bug-Prima@rt.cpan.org&gt; writes:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; one flawed algorithm should be replaced with another.
</div>
Actually I realize I got it badly wrong.  An ellipse drawn with a wide
line doesn&#39;t make an ellipse shape, the outer edge is a bit fatter than
an ellipse.  So alas no good, except for a circle &#40;width==height&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-863874" href="/Public/Bug/Display.html?id=63392#txn-863874">#</a>      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;04&nbsp;11:58:45&nbsp;2010</span>
    <span class="description">KARASIK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/863874/447302/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/447302">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 55b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">So, should we abandon all hope and close the ticket? :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-865141" href="/Public/Bug/Display.html?id=63392#txn-865141">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;06&nbsp;17:00:49&nbsp;2010</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63392] fill_ellipse&#40;&#41; 5x3 extra pixel</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 07 Dec 2010 09:00:21 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Prima [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/865141/447942/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/447942">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 618b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;KARASIK via RT&#34; &lt;bug-Prima@rt.cpan.org&gt; writes:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; So, should we abandon all hope and close the ticket? :&#41;
</div>
:-&#41;.  I would fix the XFillArc size 1 too big, stay with the XPolyArc
outer rim &#34;repair&#34; bit, send width,height &lt;= 2 to the rectangle code,
and rate that close enough for the moment.

In the future perhaps attack the non &#34;REPAIRABLE&#34; cases like xor by
drawing onto some sort of temporary bitmap or pixmap to select desired
pixels.


-- 
The sigfile finance for the layman series:
In a mining company&#39;s annual report, the more detail about
mineralization and geology, the less chance of making money from it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-865321" href="/Public/Bug/Display.html?id=63392#txn-865321">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;07&nbsp;03:42:26&nbsp;2010</span>
    <span class="description">KARASIK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/865321/448045/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/448045">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; :-&#41;.  I would fix the XFillArc size 1 too big, stay with the XPolyArc
&gt; outer rim &#34;repair&#34; bit, 
</div>
I tried to experiment adding -1 to arguments to XFillArc &#40;I&#39;d urge you
to try too&#41;, and interestingly enough 5x3 fill_ellipse _still_ has the
extra pixel, just in another location. So I&#39;m unsure if that helps, and
am reluctant to change the logic based just on that. Also, the extra
pixel, technically speaking, is not necessary an &#34;extra&#34; - it doesn&#39;t
get out of the 5x3 box, and I&#39;d personally accept it as a roundoff
error, rather than a bug. It&#39;s not symmetric, I agree, but the &#34;size 1
too big&#34; fix doesn&#39;t help that either. So I&#39;d leave thing as is unless
there exists a good algorithm that solves the problem in a more global way.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; send width,height &lt;= 2 to the rectangle code,
</div>
Yes, this one&#39;s agreed, I&#39;ll fix that.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In the future perhaps attack the non &#34;REPAIRABLE&#34; cases like xor by
&gt; drawing onto some sort of temporary bitmap or pixmap to select desired
&gt; pixels.
</div>
That&#39;s of course possible, but I&#39;m not going to do that in foreseeable
future, too much hassle, sorry :&#41; If you feel that you can to
contribute, yes, by all means, please do, I&#39;ll accept patches with
thanks. Otherwise, I&#39;ll just mark that in TODO somewhere.

But thanks for the pedantic insight, I really appreciate that, just
don&#39;t have the energy :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-866166" href="/Public/Bug/Display.html?id=63392#txn-866166">#</a>      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;08&nbsp;16:28:03&nbsp;2010</span>
    <span class="description">user42 [...] zip.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #63392] fill_ellipse&#40;&#41; 5x3 extra pixel</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 09 Dec 2010 08:27:24 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Prima [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Kevin Ryde &lt;user42 [...] zip.com.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/866166/448513/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/448513">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 954b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;KARASIK via RT&#34; &lt;bug-Prima@rt.cpan.org&gt; writes:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; I tried to experiment adding -1 to arguments to XFillArc &#40;I&#39;d urge you
&gt; to try too&#41;,
</div>
Yep, I did.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; and interestingly enough 5x3 fill_ellipse _still_ has the
&gt; extra pixel, just in another location.
</div>
Err, it worked for me.  If you mean the XFillArc alone gives a shape
like

   +-----+
   |  *  |
   |**** |
   |     |
   +-----+

then I believe that&#39;s correct.  I think it&#39;s in a sense missing pixels
rather than drawing an extra, it&#39;s like

   +-----+
   |  *  |
   |*****|
   |  *  |
   +-----+

but the rightmost and bottommost are not drawn due to the X rule about
pixel centre on the bounding line is drawn only if on the left or upper
sides of the shape.  The XDrawArc &#34;repair&#34; around the outside covers
those pixels.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; just mark that in TODO somewhere.
</div>
Yes, put it somewhere, it&#39;s the sort of added-value or smoothing out the
nasty bits I think you&#39;d look for in a cross platform toolkit.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1098283" href="/Public/Bug/Display.html?id=63392#txn-1098283">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;12&nbsp;06:05:08&nbsp;2012</span>
    <span class="description">KARASIK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1345631" href="/Public/Bug/Display.html?id=63392#txn-1345631">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;01&nbsp;13:57:16&nbsp;2014</span>
    <span class="description">KARASIK [...] cpan.org -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1345632" href="/Public/Bug/Display.html?id=63392#txn-1345632">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;01&nbsp;13:57:27&nbsp;2014</span>
    <span class="description">KARASIK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.542861</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
