<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #79010 for Server-Control: Could code auto-generate starman options?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #79010 for Server-Control: Could code auto-generate starman options?</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Server-Control/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Server-Control/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Server-Control/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Server-Control/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Server-Control">Server-Control CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">79010</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Server-Control/Active/">Server-Control</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
RSAVAGE [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-228968-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.19    </td>
  </tr>
  <tr id="CF-228969-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;16&nbsp;00:20:58&nbsp;2012</span>
    <span class="description">RSAVAGE [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Could code auto-generate starman options?</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi

I&#39;d like to see the code auto-generate the starman options:

        options     =&gt;
        {
                listen  =&gt; &#39;127.0.0.1:5002&#39;,
                pid     =&gt; &#34;$pid_file_name&#34;,
                workers =&gt; 1, # OK, Not this one!
        },
since the listen and pid values are available already, given:

my&#40;$server&#41; = Server::Control::Starman -&gt; new
&#40;
        app_psgi    =&gt; &#34;$app_path&#34;,
        binary_path =&gt; &#34;$binary_path&#34;,
        bind_addr   =&gt; &#39;127.0.0.1&#39;,
#       error_log   =&gt; &#34;$error_file_name&#34;,
        log_dir     =&gt; &#34;$log_dir_name&#34;,
        name        =&gt; &#39;Local::Application&#39;,
        options     =&gt;
        {
                listen  =&gt; &#39;127.0.0.1:5002&#39;,
                pid     =&gt; &#34;$pid_file_name&#34;,
                workers =&gt; 1,
        },
        pid_file             =&gt; &#34;$pid_file_name&#34;,
        port                 =&gt; 5002,
        server_root          =&gt; &#34;$app_dir_name&#34;,
        wait_for_status_secs =&gt; 2,
&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;16&nbsp;07:50:44&nbsp;2012</span>
    <span class="description">swartz [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79010] Could code auto-generate starman options? </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 16 Aug 2012 04:50:32 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Server-Control [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jonathan Swartz &lt;swartz [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Well, right now it auto-generates the Server::Control::Starman parameters based on the starman options. Are you saying you want it to auto-generate the other way too? That sounds complicated. Patches welcome. :&#41;

On Aug 15, 2012, at 9:20 PM, RSAVAGE via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thu Aug 16 00:20:58 2012: Request 79010 was acted upon.
&gt; Transaction: Ticket created by RSAVAGE
&gt;       Queue: Server-Control
&gt;     Subject: Could code auto-generate starman options?
&gt;   Broken in: 0.19
&gt;    Severity: Normal
&gt;       Owner: Nobody
&gt;  Requestors: RSAVAGE@cpan.org
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span> &gt;
&gt; 
&gt; 
&gt; Hi
&gt; 
&gt; I&#39;d like to see the code auto-generate the starman options:
&gt; 
&gt;       options     =&gt;
&gt;       {
&gt;               listen  =&gt; &#39;127.0.0.1:5002&#39;,
&gt;               pid     =&gt; &#34;$pid_file_name&#34;,
&gt;               workers =&gt; 1, # OK, Not this one!
&gt;       },
&gt; since the listen and pid values are available already, given:
&gt; 
&gt; my&#40;$server&#41; = Server::Control::Starman -&gt; new
&gt; &#40;
&gt;       app_psgi    =&gt; &#34;$app_path&#34;,
&gt;       binary_path =&gt; &#34;$binary_path&#34;,
&gt;       bind_addr   =&gt; &#39;127.0.0.1&#39;,
&gt; #     error_log   =&gt; &#34;$error_file_name&#34;,
&gt;       log_dir     =&gt; &#34;$log_dir_name&#34;,
&gt;       name        =&gt; &#39;Local::Application&#39;,
&gt;       options     =&gt;
&gt;       {
&gt;               listen  =&gt; &#39;127.0.0.1:5002&#39;,
&gt;               pid     =&gt; &#34;$pid_file_name&#34;,
&gt;               workers =&gt; 1,
&gt;       },
&gt;       pid_file             =&gt; &#34;$pid_file_name&#34;,
&gt;       port                 =&gt; 5002,
&gt;       server_root          =&gt; &#34;$app_dir_name&#34;,
&gt;       wait_for_status_secs =&gt; 2,
&gt; &#41;;
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;16&nbsp;07:50:45&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;16&nbsp;20:22:40&nbsp;2012</span>
    <span class="description">ron [...] savage.net.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79010] Could code auto-generate starman options?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 17 Aug 2012 10:23:15 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Server-Control [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ron Savage &lt;ron [...] savage.net.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jonathan

On 16/08/12 21:50, Jonathan Swartz via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;
&gt; Well, right now it auto-generates the Server::Control::Starman parameters based on the starman options. Are you saying you want it to auto-generate the other way too? That sounds complicated. Patches welcome. :&#41;
</div>
1&#41; OK. I can&#39;t see where in the docs it says that &#40;hint, hint&#41;.

But now there&#39;s another problem: When I comment out both bind_addr and 
port, I get an error:

cannot determine port at 
/home/ron/perl5/perlbrew/perls/perl-5.14.2/lib/site_perl/5.14.2/Server/Control/Starman.pm 
line 57.

Whereas when I only comment out bind_addr, it runs ok &#40;as expected&#41;.

But I&#39;m guessing that&#39;s because it defaults to localhost &#40;the only case 
I use, so far&#41; and not because it parses the Starman opts. Or is the 
code smarter than I&#39;m thinking :-&#41;?

2&#41; And yes, I was expecting the code to parse the Server::Control 
options and use them to fill in any necessary in the required Startman 
options.

After all, why should I code that when I can get you to do it for me :-&#41;&#41;?

But seriously, if you do it, all end-users will be relieved of that 
effort, which is just duplication.

Cheers

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Aug 15, 2012, at 9:20 PM, RSAVAGE via RT wrote:
&gt;
<div class="message-stanza open">&gt;&gt; Thu Aug 16 00:20:58 2012: Request 79010 was acted upon.
&gt;&gt; Transaction: Ticket created by RSAVAGE
&gt;&gt;        Queue: Server-Control
&gt;&gt;      Subject: Could code auto-generate starman options?
&gt;&gt;    Broken in: 0.19
&gt;&gt;     Severity: Normal
&gt;&gt;        Owner: Nobody
&gt;&gt;   Requestors: RSAVAGE@cpan.org
&gt;&gt;       Status: new
&gt;&gt; Ticket&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Hi
&gt;&gt;
&gt;&gt; I&#39;d like to see the code auto-generate the starman options:
&gt;&gt;
&gt;&gt;      options     =&gt;
&gt;&gt;      {
&gt;&gt;              listen  =&gt;  &#39;127.0.0.1:5002&#39;,
&gt;&gt;              pid     =&gt;  &#34;$pid_file_name&#34;,
&gt;&gt;              workers =&gt;  1, # OK, Not this one!
&gt;&gt;      },
&gt;&gt; since the listen and pid values are available already, given:
&gt;&gt;
&gt;&gt; my&#40;$server&#41; = Server::Control::Starman -&gt;  new
&gt;&gt; &#40;
&gt;&gt;      app_psgi    =&gt;  &#34;$app_path&#34;,
&gt;&gt;      binary_path =&gt;  &#34;$binary_path&#34;,
&gt;&gt;      bind_addr   =&gt;  &#39;127.0.0.1&#39;,
&gt;&gt; #    error_log   =&gt;  &#34;$error_file_name&#34;,
&gt;&gt;      log_dir     =&gt;  &#34;$log_dir_name&#34;,
&gt;&gt;      name        =&gt;  &#39;Local::Application&#39;,
&gt;&gt;      options     =&gt;
&gt;&gt;      {
&gt;&gt;              listen  =&gt;  &#39;127.0.0.1:5002&#39;,
&gt;&gt;              pid     =&gt;  &#34;$pid_file_name&#34;,
&gt;&gt;              workers =&gt;  1,
&gt;&gt;      },
&gt;&gt;      pid_file             =&gt;  &#34;$pid_file_name&#34;,
&gt;&gt;      port                 =&gt;  5002,
&gt;&gt;      server_root          =&gt;  &#34;$app_dir_name&#34;,
&gt;&gt;      wait_for_status_secs =&gt;  2,
&gt;&gt; &#41;;
&gt;&gt;
</div>&gt;
&gt;
&gt;
&gt;
</div>

-- 
Ron Savage
<span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/">http://savage.net.au/</a></span>
Ph: 0421 920 622
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;16&nbsp;20:31:09&nbsp;2012</span>
    <span class="description">swartz [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79010] Could code auto-generate starman options?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 16 Aug 2012 17:30:55 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Server-Control [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jonathan Swartz &lt;swartz [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
In the docs, it says:

  This module will determine &#34;error_log&#34; in Server::Control, &#34;pid_file&#34; in Server::Control, and &#34;port&#34; in Server::Control from the options hash.

and in the synopsis:

my $starman = Server::Control::Starman-&gt;new&#40;
    binary_path =&gt; &#39;/usr/local/bin/starman&#39;
    options =&gt; {
        port      =&gt; 123,
        error_log =&gt; &#39;/path/to/error.log&#39;,
        pid_file  =&gt; &#39;/path/to/starman.pid&#39;
    },
&#41;;

But obviously that needs to be made clearer.

Either you specify the starman options and those are used to populate Server::Control parameters, or you specify Server::Control parameters and those are used to popular starman options. Trying to do it in both directions would be confusing and hard to test all cases &#40;e.g. what if you passed some to starman options and some to Server::Control parameters&#41;. So I chose the former.

Maybe &#39;options&#39; is too generic and needs to be renamed, e.g. &#39;starman_options&#39;? Then I can say in the docs that &#34;error_log, pid_file, and port will be determined from the starman_options hash&#34;. Would that make it clearer?

Jon

On Aug 16, 2012, at 5:22 PM, ron@savage.net.au via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: Server-Control
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span> &gt;
&gt; 
&gt; Hi Jonathan
&gt; 
&gt; On 16/08/12 21:50, Jonathan Swartz via RT wrote:
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;&gt; 
&gt;&gt; Well, right now it auto-generates the Server::Control::Starman parameters based on the starman options. Are you saying you want it to auto-generate the other way too? That sounds complicated. Patches welcome. :&#41;
</div>&gt; 
&gt; 1&#41; OK. I can&#39;t see where in the docs it says that &#40;hint, hint&#41;.
&gt; 
&gt; But now there&#39;s another problem: When I comment out both bind_addr and 
&gt; port, I get an error:
&gt; 
&gt; cannot determine port at 
&gt; /home/ron/perl5/perlbrew/perls/perl-5.14.2/lib/site_perl/5.14.2/Server/Control/Starman.pm 
&gt; line 57.
&gt; 
&gt; Whereas when I only comment out bind_addr, it runs ok &#40;as expected&#41;.
&gt; 
&gt; But I&#39;m guessing that&#39;s because it defaults to localhost &#40;the only case 
&gt; I use, so far&#41; and not because it parses the Starman opts. Or is the 
&gt; code smarter than I&#39;m thinking :-&#41;?
&gt; 
&gt; 2&#41; And yes, I was expecting the code to parse the Server::Control 
&gt; options and use them to fill in any necessary in the required Startman 
&gt; options.
&gt; 
&gt; After all, why should I code that when I can get you to do it for me :-&#41;&#41;?
&gt; 
&gt; But seriously, if you do it, all end-users will be relieved of that 
&gt; effort, which is just duplication.
&gt; 
&gt; Cheers
&gt; 
<div class="message-stanza open">&gt;&gt; On Aug 15, 2012, at 9:20 PM, RSAVAGE via RT wrote:
&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt; Thu Aug 16 00:20:58 2012: Request 79010 was acted upon.
&gt;&gt;&gt; Transaction: Ticket created by RSAVAGE
&gt;&gt;&gt;       Queue: Server-Control
&gt;&gt;&gt;     Subject: Could code auto-generate starman options?
&gt;&gt;&gt;   Broken in: 0.19
&gt;&gt;&gt;    Severity: Normal
&gt;&gt;&gt;       Owner: Nobody
&gt;&gt;&gt;  Requestors: RSAVAGE@cpan.org
&gt;&gt;&gt;      Status: new
&gt;&gt;&gt; Ticket&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; Hi
&gt;&gt;&gt; 
&gt;&gt;&gt; I&#39;d like to see the code auto-generate the starman options:
&gt;&gt;&gt; 
&gt;&gt;&gt;     options     =&gt;
&gt;&gt;&gt;     {
&gt;&gt;&gt;             listen  =&gt;  &#39;127.0.0.1:5002&#39;,
&gt;&gt;&gt;             pid     =&gt;  &#34;$pid_file_name&#34;,
&gt;&gt;&gt;             workers =&gt;  1, # OK, Not this one!
&gt;&gt;&gt;     },
&gt;&gt;&gt; since the listen and pid values are available already, given:
&gt;&gt;&gt; 
&gt;&gt;&gt; my&#40;$server&#41; = Server::Control::Starman -&gt;  new
&gt;&gt;&gt; &#40;
&gt;&gt;&gt;     app_psgi    =&gt;  &#34;$app_path&#34;,
&gt;&gt;&gt;     binary_path =&gt;  &#34;$binary_path&#34;,
&gt;&gt;&gt;     bind_addr   =&gt;  &#39;127.0.0.1&#39;,
&gt;&gt;&gt; #   error_log   =&gt;  &#34;$error_file_name&#34;,
&gt;&gt;&gt;     log_dir     =&gt;  &#34;$log_dir_name&#34;,
&gt;&gt;&gt;     name        =&gt;  &#39;Local::Application&#39;,
&gt;&gt;&gt;     options     =&gt;
&gt;&gt;&gt;     {
&gt;&gt;&gt;             listen  =&gt;  &#39;127.0.0.1:5002&#39;,
&gt;&gt;&gt;             pid     =&gt;  &#34;$pid_file_name&#34;,
&gt;&gt;&gt;             workers =&gt;  1,
&gt;&gt;&gt;     },
&gt;&gt;&gt;     pid_file             =&gt;  &#34;$pid_file_name&#34;,
&gt;&gt;&gt;     port                 =&gt;  5002,
&gt;&gt;&gt;     server_root          =&gt;  &#34;$app_dir_name&#34;,
&gt;&gt;&gt;     wait_for_status_secs =&gt;  2,
&gt;&gt;&gt; &#41;;
&gt;&gt;&gt; 
</div>&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
&gt;&gt; 
</div>&gt; 
&gt; 
&gt; -- 
&gt; Ron Savage
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/">http://savage.net.au/</a></span>
&gt; Ph: 0421 920 622
&gt; 
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;16&nbsp;20:38:56&nbsp;2012</span>
    <span class="description">ron [...] savage.net.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79010] Could code auto-generate starman options?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 17 Aug 2012 10:39:32 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Server-Control [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ron Savage &lt;ron [...] savage.net.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jon

On 17/08/12 10:31, Jonathan Swartz via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;
&gt;
&gt; In the docs, it says:
&gt;
&gt;    This module will determine &#34;error_log&#34; in Server::Control, &#34;pid_file&#34; in Server::Control, and &#34;port&#34; in Server::Control from the options hash.
&gt;
&gt; and in the synopsis:
&gt;
&gt; my $starman = Server::Control::Starman-&gt;new&#40;
&gt;      binary_path =&gt;  &#39;/usr/local/bin/starman&#39;
&gt;      options =&gt;  {
&gt;          port      =&gt;  123,
&gt;          error_log =&gt;  &#39;/path/to/error.log&#39;,
&gt;          pid_file  =&gt;  &#39;/path/to/starman.pid&#39;
&gt;      },
&gt; &#41;;
&gt;
&gt; But obviously that needs to be made clearer.
&gt;
&gt; Either you specify the starman options and those are used to populate Server::Control parameters, or you specify Server::Control parameters and those are used to popular starman options. Trying to do it in both directions would be confusing and hard to test all cases &#40;e.g. what if you passed some to starman options and some to Server::Control parameters&#41;. So I chose the former.
&gt;
&gt; Maybe &#39;options&#39; is too generic and needs to be renamed, e.g. &#39;starman_options&#39;? Then I can say in the docs that &#34;error_log, pid_file, and port will be determined from the starman_options hash&#34;. Would that make it clearer?
</div>
An instantaneous thought is Yes, use starman options, but a moment&#39;s 
reflection says no.

The problem is that that &#40;potentially&#41; leads to each sub-class having a 
differently named option hash. I think that&#39;s too confusing. So I&#39;d 
stick with options, and somehow re-word the text, and not just in the 
sub-class docs. In the Server::Control docs precede the discussion of 
options with something like:

Certain options are auto-populated from the sub-class-specific options 
hash &#40;if any&#41;.

And for each such option &#40;yes I know its work&#41; add a comment about 
auto-population from the sub-class-specific hash.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Jon
&gt;
&gt; On Aug 16, 2012, at 5:22 PM, ron@savage.net.au via RT wrote:
&gt;
<div class="message-stanza open">&gt;&gt;        Queue: Server-Control
&gt;&gt; Ticket&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;&gt;
&gt;&gt; Hi Jonathan
&gt;&gt;
&gt;&gt; On 16/08/12 21:50, Jonathan Swartz via RT wrote:
<div class="message-stanza open">&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Well, right now it auto-generates the Server::Control::Starman parameters based on the starman options. Are you saying you want it to auto-generate the other way too? That sounds complicated. Patches welcome. :&#41;
</div>&gt;&gt;
&gt;&gt; 1&#41; OK. I can&#39;t see where in the docs it says that &#40;hint, hint&#41;.
&gt;&gt;
&gt;&gt; But now there&#39;s another problem: When I comment out both bind_addr and
&gt;&gt; port, I get an error:
&gt;&gt;
&gt;&gt; cannot determine port at
&gt;&gt; /home/ron/perl5/perlbrew/perls/perl-5.14.2/lib/site_perl/5.14.2/Server/Control/Starman.pm
&gt;&gt; line 57.
&gt;&gt;
&gt;&gt; Whereas when I only comment out bind_addr, it runs ok &#40;as expected&#41;.
&gt;&gt;
&gt;&gt; But I&#39;m guessing that&#39;s because it defaults to localhost &#40;the only case
&gt;&gt; I use, so far&#41; and not because it parses the Starman opts. Or is the
&gt;&gt; code smarter than I&#39;m thinking :-&#41;?
&gt;&gt;
&gt;&gt; 2&#41; And yes, I was expecting the code to parse the Server::Control
&gt;&gt; options and use them to fill in any necessary in the required Startman
&gt;&gt; options.
&gt;&gt;
&gt;&gt; After all, why should I code that when I can get you to do it for me :-&#41;&#41;?
&gt;&gt;
&gt;&gt; But seriously, if you do it, all end-users will be relieved of that
&gt;&gt; effort, which is just duplication.
&gt;&gt;
&gt;&gt; Cheers
&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt; On Aug 15, 2012, at 9:20 PM, RSAVAGE via RT wrote:
&gt;&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt;&gt; Thu Aug 16 00:20:58 2012: Request 79010 was acted upon.
&gt;&gt;&gt;&gt; Transaction: Ticket created by RSAVAGE
&gt;&gt;&gt;&gt;        Queue: Server-Control
&gt;&gt;&gt;&gt;      Subject: Could code auto-generate starman options?
&gt;&gt;&gt;&gt;    Broken in: 0.19
&gt;&gt;&gt;&gt;     Severity: Normal
&gt;&gt;&gt;&gt;        Owner: Nobody
&gt;&gt;&gt;&gt;   Requestors: RSAVAGE@cpan.org
&gt;&gt;&gt;&gt;       Status: new
&gt;&gt;&gt;&gt; Ticket&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I&#39;d like to see the code auto-generate the starman options:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;    options     =&gt;
&gt;&gt;&gt;&gt;    {
&gt;&gt;&gt;&gt;            listen  =&gt;   &#39;127.0.0.1:5002&#39;,
&gt;&gt;&gt;&gt;            pid     =&gt;   &#34;$pid_file_name&#34;,
&gt;&gt;&gt;&gt;            workers =&gt;   1, # OK, Not this one!
&gt;&gt;&gt;&gt;    },
&gt;&gt;&gt;&gt; since the listen and pid values are available already, given:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; my&#40;$server&#41; = Server::Control::Starman -&gt;   new
&gt;&gt;&gt;&gt; &#40;
&gt;&gt;&gt;&gt;    app_psgi    =&gt;   &#34;$app_path&#34;,
&gt;&gt;&gt;&gt;    binary_path =&gt;   &#34;$binary_path&#34;,
&gt;&gt;&gt;&gt;    bind_addr   =&gt;   &#39;127.0.0.1&#39;,
&gt;&gt;&gt;&gt; #  error_log   =&gt;   &#34;$error_file_name&#34;,
&gt;&gt;&gt;&gt;    log_dir     =&gt;   &#34;$log_dir_name&#34;,
&gt;&gt;&gt;&gt;    name        =&gt;   &#39;Local::Application&#39;,
&gt;&gt;&gt;&gt;    options     =&gt;
&gt;&gt;&gt;&gt;    {
&gt;&gt;&gt;&gt;            listen  =&gt;   &#39;127.0.0.1:5002&#39;,
&gt;&gt;&gt;&gt;            pid     =&gt;   &#34;$pid_file_name&#34;,
&gt;&gt;&gt;&gt;            workers =&gt;   1,
&gt;&gt;&gt;&gt;    },
&gt;&gt;&gt;&gt;    pid_file             =&gt;   &#34;$pid_file_name&#34;,
&gt;&gt;&gt;&gt;    port                 =&gt;   5002,
&gt;&gt;&gt;&gt;    server_root          =&gt;   &#34;$app_dir_name&#34;,
&gt;&gt;&gt;&gt;    wait_for_status_secs =&gt;   2,
&gt;&gt;&gt;&gt; &#41;;
&gt;&gt;&gt;&gt;
</div>&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
</div>&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Ron Savage
&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/">http://savage.net.au/</a></span>
&gt;&gt; Ph: 0421 920 622
&gt;&gt;
</div>&gt;
&gt;
&gt;
&gt;
</div>

-- 
Ron Savage
<span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/">http://savage.net.au/</a></span>
Ph: 0421 920 622
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;18&nbsp;02:28:40&nbsp;2012</span>
    <span class="description">swartz [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79010] Could code auto-generate starman options?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 17 Aug 2012 17:09:58 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Server-Control [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jonathan Swartz &lt;swartz [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Aug 16, 2012, at 5:38 PM, ron@savage.net.au via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: Server-Control
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span> &gt;
&gt; 
&gt; Hi Jon
&gt; 
&gt; On 17/08/12 10:31, Jonathan Swartz via RT wrote:
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79010">https://rt.cpan.org/Ticket/Display.html?id=79010</a></span>&gt;
&gt;&gt; 
&gt;&gt; 
&gt;&gt; In the docs, it says:
&gt;&gt; 
&gt;&gt;   This module will determine &#34;error_log&#34; in Server::Control, &#34;pid_file&#34; in Server::Control, and &#34;port&#34; in Server::Control from the options hash.
&gt;&gt; 
&gt;&gt; and in the synopsis:
&gt;&gt; 
&gt;&gt; my $starman = Server::Control::Starman-&gt;new&#40;
&gt;&gt;     binary_path =&gt;  &#39;/usr/local/bin/starman&#39;
&gt;&gt;     options =&gt;  {
&gt;&gt;         port      =&gt;  123,
&gt;&gt;         error_log =&gt;  &#39;/path/to/error.log&#39;,
&gt;&gt;         pid_file  =&gt;  &#39;/path/to/starman.pid&#39;
&gt;&gt;     },
&gt;&gt; &#41;;
&gt;&gt; 
&gt;&gt; But obviously that needs to be made clearer.
&gt;&gt; 
&gt;&gt; Either you specify the starman options and those are used to populate Server::Control parameters, or you specify Server::Control parameters and those are used to popular starman options. Trying to do it in both directions would be confusing and hard to test all cases &#40;e.g. what if you passed some to starman options and some to Server::Control parameters&#41;. So I chose the former.
&gt;&gt; 
&gt;&gt; Maybe &#39;options&#39; is too generic and needs to be renamed, e.g. &#39;starman_options&#39;? Then I can say in the docs that &#34;error_log, pid_file, and port will be determined from the starman_options hash&#34;. Would that make it clearer?
</div>&gt; 
&gt; An instantaneous thought is Yes, use starman options, but a moment&#39;s 
&gt; reflection says no.
&gt; 
&gt; The problem is that that &#40;potentially&#41; leads to each sub-class having a 
&gt; differently named option hash. I think that&#39;s too confusing. So I&#39;d 
&gt; stick with options, and somehow re-word the text, and not just in the 
&gt; sub-class docs. In the Server::Control docs precede the discussion of 
&gt; options with something like:
&gt; 
&gt; Certain options are auto-populated from the sub-class-specific options 
&gt; hash &#40;if any&#41;.
&gt; 
&gt; And for each such option &#40;yes I know its work&#41; add a comment about 
&gt; auto-population from the sub-class-specific hash.
&gt; 
</div>
Right now Starman is the only one of the three main subclasses that takes an options hash in this way. The others &#40;Nginx, Apache, and eventually Lighttpd&#41; use a conf file.

But I&#39;ll work on making the docs clearer.

Jon
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;18&nbsp;20:45:56&nbsp;2012</span>
    <span class="description">ron [...] savage.net.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79010] Could code auto-generate starman options?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 19 Aug 2012 10:46:48 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Server-Control [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ron Savage &lt;ron [...] savage.net.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Jon

On 18/08/12 16:28, Jonathan Swartz via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Right now Starman is the only one of the three main subclasses that takes an options hash in this way. The others &#40;Nginx, Apache, and eventually Lighttpd&#41; use a conf file.
&gt;
&gt; But I&#39;ll work on making the docs clearer.
</div>
OK. Thanx. That&#39;ll do!

-- 
Ron Savage
<span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/">http://savage.net.au/</a></span>
Ph: 0421 920 622
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;25&nbsp;19:57:26&nbsp;2012</span>
    <span class="description">JSWARTZ [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
