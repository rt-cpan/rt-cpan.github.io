<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #65127 for IO-Async: Fails test on dragonflybsd 2.9</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #65127 for IO-Async: Fails test on dragonflybsd 2.9</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=IO-Async">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=IO-Async">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=IO-Async">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=IO-Async">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Async">IO-Async CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">65127</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=IO-Async">IO-Async</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
nonsolosoft [...] diff.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-42614-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.37    </td>
  </tr>
  <tr id="CF-42615-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.40    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




rt65127-2.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/905924/469953/rt65127-2.patch">
Wed Mar 02 13:36:45 2011 (777b) by leonerd-cpan [...] leonerd.org.uk
</a>
</font></li>
</ul>


rt65127.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/898155/465696/rt65127.patch">
Wed Feb 16 17:30:42 2011 (1.1k) by leonerd-cpan [...] leonerd.org.uk
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=65127">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-887183" href="/Public/Bug/Display.html?id=65127#txn-887183">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;25&nbsp;17:16:46&nbsp;2011</span>
    <span class="description">nonsolosoft [...] diff.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fails test on dragonflybsd 2.9</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/887183/459843/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/459843">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Test Summary Report
-------------------
t/37loop-child-root.t      &#40;Wstat: 256 Tests: 5 Failed: 1&#41;
  Failed test:  5
  Non-zero exit status: 1
Files=52, Tests=1268, 83 wallclock secs &#40; 0.54 usr  0.28 sys + 12.41
cusr  3.09 csys = 16.31 CPU&#41;
Result: FAIL
Failed 1/52 test programs. 1/1268 subtests failed.
  PEVANS/IO-Async-0.37.tar.gz
  ./Build test -- NOT OK
//hint// to see the cpan-testers results for installing this module, try:
  reports PEVANS/IO-Async-0.37.tar.gz
Running Build install
  make test had returned bad status, won&#39;t install without force
Failed during this command:
 PEVANS/IO-Async-0.37.tar.gz                  : make_test NO


lap# perl -Ilib -Iblib t/37loop-child-root.t
1..5
ok 1 - am root
ok 2 - setuid
ok 3 - setgid
ok 4 - setgroups
not ok 5 - combined setuid/gid/groups
#   Failed test &#39;combined setuid/gid/groups&#39;
#   at t/37loop-child-root.t line 84.
#          got: &#39;EUID: 20
# EGID: 10
# Groups: 5 6 10 10
# &#39;
#     expected: &#39;EUID: 20
# EGID: 10
# Groups: 4 5 6 10
# &#39;
# Looks like you failed 1 test of 5.
lap# pwd
/tmp/.cpan/build/IO-Async-0.37-K5q1Ew
lap# uname -a
DragonFly lap.diff.org 2.9-DEVELOPMENT DragonFly
v2.9.1.72.g7c47e-DEVELOPMENT #0: Sat Nov 20 16:29:48 CET 2010    
ferz@lap.diff.org:/dati/obj/usr/src/sys/GENERIC  i386

lap# perl -V
Summary of my perl5 &#40;revision 5 version 12 subversion 2&#41; configuration:
   
  Platform:
    osname=dragonfly, osvers=2.9-development,
archname=i386-dragonfly-thread-multi
    uname=&#39;dragonfly avalon.theshell.com 2.9-development dragonfly
v2.9.0.19.g24872-development #21: thu oct 21 01:25:00 utc 2010
dillon@avalon.theshell.com:usrobjusrsrcsysavalon i386 &#39;
    config_args=&#39;-sde -Duseshrplib -Duseithreads -Uusemymalloc&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=define, usemultiplicity=define
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=undef, use64bitall=undef, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;cc&#39;, ccflags =&#39;-DHAS_FPSETMASK -DHAS_FLOATINGPOINT_H
-fno-strict-aliasing -pipe -fstack-protector&#39;,
    optimize=&#39;-O2  -pthread  -I/usr/include&#39;,
    cppflags=&#39;-DHAS_FPSETMASK -DHAS_FLOATINGPOINT_H -fno-strict-aliasing
-pipe -fstack-protector&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.1.2 &#40;DragonFly&#41;&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
    ivtype=&#39;long&#39;, ivsize=4, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;,
lseeksize=8
    alignbytes=4, prototype=define
  Linker and Libraries:
    ld=&#39;cc&#39;, ldflags =&#39;-Wl,-R/usr/pkg/lib -pthread -Wl,-E 
-fstack-protector&#39;
    libpth=/usr/lib
    libs=-lm -lcrypt -lpthread -lrt
    perllibs=-lm -lcrypt -lpthread -lrt
    libc=, so=so, useshrplib=true, libperl=libperl.so
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39; 
-Wl,-R/usr/pkg/lib/perl5/5.12.0/i386-dragonfly-thread-multi/CORE&#39;
    cccdlflags=&#39;-DPIC -fPIC&#39;, lddlflags=&#39;-Wl,-R/usr/pkg/lib -shared 
-fstack-protector&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: MULTIPLICITY PERL_DONT_CREATE_GVSV
                        PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP USE_ITHREADS
                        USE_LARGE_FILES USE_PERLIO USE_PERL_ATOF
                        USE_REENTRANT_API
  Built under dragonfly
  Compiled at Oct 21 2010 03:31:25
  @INC:
    /usr/pkg/lib/perl5/site_perl/5.12.0/i386-dragonfly-thread-multi
    /usr/pkg/lib/perl5/site_perl/5.12.0
    /usr/pkg/lib/perl5/vendor_perl/5.12.0/i386-dragonfly-thread-multi
    /usr/pkg/lib/perl5/vendor_perl/5.12.0
    /usr/pkg/lib/perl5/5.12.0/i386-dragonfly-thread-multi
    /usr/pkg/lib/perl5/5.12.0
    .
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895518" href="/Public/Bug/Display.html?id=65127#txn-895518">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;10&nbsp;18:04:15&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/895518/464276/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/464276">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 627b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 25 17:16:46 2011, nonsolosoft@diff.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; not ok 5 - combined setuid/gid/groups
&gt; #   Failed test &#39;combined setuid/gid/groups&#39;
&gt; #   at t/37loop-child-root.t line 84.
&gt; #          got: &#39;EUID: 20
&gt; # EGID: 10
&gt; # Groups: 5 6 10 10
&gt; # &#39;
&gt; #     expected: &#39;EUID: 20
&gt; # EGID: 10
&gt; # Groups: 4 5 6 10
&gt; # &#39;
</div>
Hmmm...

That test basically tests the ability to perform the following:

# perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
10 4 5 6 10

Could you try that directly, and see what the output gives? Perhaps it&#39;s
a difference in the way Dragonfly implements setgid/setgroups.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895520" href="/Public/Bug/Display.html?id=65127#txn-895520">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;10&nbsp;18:04:16&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895735" href="/Public/Bug/Display.html?id=65127#txn-895735">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;11&nbsp;10:01:52&nbsp;2011</span>
    <span class="description">nonsolosoft [...] diff.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65127] Fails test on dragonflybsd 2.9</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 11 Feb 2011 16:01:30 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Async [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ferruccio Zamuner &lt;nonsolosoft [...] diff.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/895735/464379/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/464379">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 888b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 02/11/11 00:04, Paul Evans via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=65127">https://rt.cpan.org/Ticket/Display.html?id=65127</a></span>&gt;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hmmm...
&gt;
&gt; That test basically tests the ability to perform the following:
&gt;
&gt; # perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
&gt; 10 4 5 6 10
&gt;
&gt; Could you try that directly, and see what the output gives? Perhaps it&#39;s
&gt; a difference in the way Dragonfly implements setgid/setgroups.
&gt;
</div>
Sure:

on DragonFlyBSD 2.9.1
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
</div>1002 1002 0 5


on FreeBSD 8.1
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
</div>1002 1002 0 65532

on Debian:
ferz@cluster:~$ uname -a
Linux cluster 2.6.26-2-686 #1 SMP Mon Jun 21 05:58:44 UTC 2010 i686 
GNU/Linux
ferz@cluster:~$ perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; 
say $&#41;&#39;
1009 1009

I&#39;m here for more investigation.


Bye,             \ferz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895744" href="/Public/Bug/Display.html?id=65127#txn-895744">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;11&nbsp;10:09:38&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/895744/464382/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/464382">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 509b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 11 10:01:52 2011, nonsolosoft@diff.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; # perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
&gt; &gt; 10 4 5 6 10
</div></div>
Perhaps this was too subtle - the # prompt means you&#39;ll have to be root.

Only root can setgid/setgroups.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; on DragonFlyBSD 2.9.1
<div class="message-stanza open">&gt;  &gt; perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
</div>&gt; 1002 1002 0 5
</div>...

These are just your normal non-root account failing to be able to 
setgroups, so returning the old value. Please retry as root.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-895746" href="/Public/Bug/Display.html?id=65127#txn-895746">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;11&nbsp;10:20:33&nbsp;2011</span>
    <span class="description">nonsolosoft [...] diff.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65127] Fails test on dragonflybsd 2.9</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 11 Feb 2011 16:20:12 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Async [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ferruccio Zamuner &lt;nonsolosoft [...] diff.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/895746/464384/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/464384">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 827b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 02/11/11 16:09, Paul Evans via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=65127">https://rt.cpan.org/Ticket/Display.html?id=65127</a></span>&gt;
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perhaps this was too subtle - the # prompt means you&#39;ll have to be root.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; These are just your normal non-root account failing to be able to
&gt; setgroups, so returning the old value. Please retry as root.
&gt;
</div>
lap# perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
10 10 5 6 10
lap# uname -a
DragonFly lap 2.9-DEVELOPMENT DragonFly v2.9.1.573.g1b505-DEVELOPMENT 
#1: Sun Jan 30 20:46:22 CET 2011 
fer@lap:/dati/obj/mnt2/usr/src/sys/GENERIC  i386

u1# perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
10 10 5 6 10
u1# uname -a
FreeBSD u1 8.1-RELEASE FreeBSD 8.1-RELEASE #3: Sun Jul 18 11:40:02 UTC 
2010     ferz@u1:/usr/obj/usr/src/sys/NONSOLOSOFT8  amd64


Thank you in advance,          \ferz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-896836" href="/Public/Bug/Display.html?id=65127#txn-896836">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;14&nbsp;12:25:59&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/896836/464959/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/464959">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 11 10:20:33 2011, nonsolosoft@diff.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; u1# perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
&gt; 10 10 5 6 10
&gt; u1# uname -a
&gt; FreeBSD u1 8.1-RELEASE FreeBSD 8.1-RELEASE #3: Sun Jul 18 11:40:02 UTC 
&gt; 2010     ferz@u1:/usr/obj/usr/src/sys/NONSOLOSOFT8  amd64
&gt; 
&gt; 
&gt; Thank you in advance,          \ferz
</div>
On further investigation, it appears that DragonflyBSD is ignoring the 
first element of the setgroups&#40;2&#41; list, presuming it to be the primary 
GID. Try instead

  # perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 10 4 5 6&#34;; say $&#41;&#39;

Presuming that to be the case, it should correctly print the entire set 
of GIDs &#40;though I can&#39;t say offhand what order they might arrive in...&#41;

I&#39;ll prepare a patch to ChildManager to shuffle the primary GID into the 
first position of the list, so this test should work.

In the meantime, if you need to install it, you can

  notest install IO::Async

presuming this is the only test that fails. The rest of the modules 
appear to be working fine, it&#39;s just that you won&#39;t be able to correctly 
use the &#39;setgroups&#39; feature of the ChildManager.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-897178" href="/Public/Bug/Display.html?id=65127#txn-897178">#</a>      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;15&nbsp;05:00:56&nbsp;2011</span>
    <span class="description">nonsolosoft [...] diff.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65127] Fails test on dragonflybsd 2.9</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 15 Feb 2011 11:00:28 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Async [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ferruccio Zamuner &lt;nonsolosoft [...] diff.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/897178/465155/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/465155">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 761b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 02/14/11 18:26, Paul Evans via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On further investigation, it appears that DragonflyBSD is ignoring the
&gt; first element of the setgroups&#40;2&#41; list, presuming it to be the primary
&gt; GID. Try instead
&gt;
&gt;    # perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 10 4 5 6&#34;; say $&#41;&#39;
&gt;
&gt; Presuming that to be the case, it should correctly print the entire set
&gt; of GIDs &#40;though I can&#39;t say offhand what order they might arrive in...&#41;
&gt;
</div>
Ok, I&#39;ve tested both on FreeBSD 8.1 and on DragonFlyBSD 2.9 with
same results.

# perl -E &#39;$&#41; = 10; my $gid = $&#41;+0; $&#41; = &#34;$gid 4 5 6 10&#34;; say $&#41;&#39;
10 10 5 6 10


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ll prepare a patch to ChildManager to shuffle the primary GID into the
&gt; first position of the list, so this test should work.
</div>
Thank you,                \ferz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898155" href="/Public/Bug/Display.html?id=65127#txn-898155">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;16&nbsp;17:30:42&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/898155/465695/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/465695">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 284b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Feb 15 05:00:56 2011, nonsolosoft@diff.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I&#39;ll prepare a patch to ChildManager to shuffle the primary GID into the
&gt; &gt; first position of the list, so this test should work.
</div>&gt; 
&gt; Thank you,                \ferz
</div>
See how you get on with the-attached.

-- 

Paul Evans
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> rt65127.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/898155/465696/rt65127.patch">Download rt65127.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">=== modified file &#39;lib/IO/Async/ChildManager.pm&#39;
--- lib/IO/Async/ChildManager.pm	2011-02-10 23:30:56 +0000
+++ lib/IO/Async/ChildManager.pm	2011-02-16 22:25:48 +0000
@@ -342,7 +342,8 @@
 this is the case.
 
 If setting both the primary GID and the supplementary groups list, it is
-suggested to set the primary GID first.
+suggested to set the primary GID first. Moreover, some operating systems may
+require that the supplementary groups list contains the primary GID.
 
 =back
 
@@ -613,8 +614,13 @@
             }
             elsif&#40; $key eq &#34;setgroups&#34; &#41; {
                my $gid = $&#41;+0;
-               my $groups = join&#40; &#34; &#34;, @$value &#41;;
-               $&#41; = &#34;$gid $groups&#34; or die &#34;Cannot setgroups&#40;&#39;$groups&#39;&#41; - $!&#34;;
+               # Put the primary GID as the first group in the supplementary
+               # list, because some operating systems ignore this position,
+               # expecting it to indeed be the primary GID.
+               # See
+               #   <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=65127">https://rt.cpan.org/Ticket/Display.html?id=65127</a></span>
+               my $groups = join&#40; &#34; &#34;, grep { $_ != $gid } @$value &#41;;
+               $&#41; = &#34;$gid $gid $groups&#34; or die &#34;Cannot setgroups&#40;&#39;$groups&#39;&#41; - $!&#34;;
             }
          }
       }

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898157" href="/Public/Bug/Display.html?id=65127#txn-898157">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;16&nbsp;17:32:26&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898181" href="/Public/Bug/Display.html?id=65127#txn-898181">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;16&nbsp;18:39:51&nbsp;2011</span>
    <span class="description">nonsolosoft [...] diff.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65127] Fails test on dragonflybsd 2.9</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 17 Feb 2011 00:39:25 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Async [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ferruccio Zamuner &lt;nonsolosoft [...] diff.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/898181/465714/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/465714">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 02/16/11 23:30, Paul Evans via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=65127">https://rt.cpan.org/Ticket/Display.html?id=65127</a></span>&gt;
&gt;
<div class="message-stanza open">&gt;&gt;&gt; I&#39;ll prepare a patch to ChildManager to shuffle the primary GID into the
&gt;&gt;&gt; first position of the list, so this test should work.
</div>&gt;
&gt; See how you get on with the-attached.
&gt;
</div>
Yes, it fix.  Thank you.

On same package:

lap# perl -Ilib t/52loop-listen.t
1..17
ok 1 - on_notifier fired synchronously
ok 2 - synchronous on_notifier given a Notifier isa IO::Async::Notifier
ok 3 - $clientsock is connected
ok 4 - $newclient peer is correct
ok 5 - $listensock has a fileno
ok 6 - $listenaddr isa IO::Socket::INET isa IO::Socket::INET
ok 7 - on_notifier fired asynchronously
ok 8 - asynchronous on_notifier given a Notifier isa IO::Async::Notifier
ok 9 - $listensock has address
ok 10 - $listenaddr is INADDR_LOOPBACK
ok 11 - $clientsock on the correct port
ok 12 - $newclient isa IO::Socket::INET isa IO::Socket::INET
ok 13 - $newclient peer is correct
Test died early - listen on port 22 actually succeeded
# Looks like you planned 17 tests but ran 13.
# Looks like your test exited with 29 just after 13.


I hope to not bore you.


Bye,                 \ferz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-898183" href="/Public/Bug/Display.html?id=65127#txn-898183">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;16&nbsp;18:39:52&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-905924" href="/Public/Bug/Display.html?id=65127#txn-905924">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;02&nbsp;13:36:45&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/905924/469952/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/469952">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 453b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Feb 16 18:39:51 2011, nonsolosoft@diff.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On same package:
&gt; 
</div>...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Test died early - listen on port 22 actually succeeded
&gt; # Looks like you planned 17 tests but ran 13.
&gt; # Looks like your test exited with 29 just after 13.
</div>
Ah yes, I had noticed that on a few of the smokers.

I wonder if it&#39;s related to some jail-like virtualisation of network 
stack, or somesuch.

In any case, see if the attached patch fixes it.

-- 

Paul Evans
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> rt65127-2.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/905924/469953/rt65127-2.patch">Download rt65127-2.patch</a><br />
<span class="downloadcontenttype">text/x-diff 777b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">=== modified file &#39;t/52loop-listen.t&#39;
--- t/52loop-listen.t   2011-03-02 18:15:32 +0000
+++ t/52loop-listen.t   2011-03-02 18:22:02 +0000
@@ -124,7 +124,12 @@
 my $badport;
 my $failure;
 foreach my $port &#40; 22, 80 &#41; {
-   IO::Socket::INET-&gt;new&#40; Type =&gt; SOCK_STREAM, LocalPort =&gt; $port, Listen =&gt; 1, ReuseAddr =&gt; 1 &#41; and next;
+   IO::Socket::INET-&gt;new&#40;
+      Type      =&gt; SOCK_STREAM,
+      LocalHost =&gt; &#34;localhost&#34;,
+      LocalPort =&gt; $port,
+      Listen    =&gt; 1,
+   &#41; and next;
       
    $badport = $port;
    $failure = $!;
@@ -142,6 +147,7 @@
    $loop-&gt;listen&#40;
       family   =&gt; &#34;inet&#34;,
       socktype =&gt; &#34;stream&#34;,
+      host     =&gt; &#34;localhost&#34;,
       service  =&gt; $badport,
 
       on_resolve_error =&gt; sub { die &#34;Test died early - resolve error $_[0]\n&#34;; },


</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-906007" href="/Public/Bug/Display.html?id=65127#txn-906007">#</a>      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;02&nbsp;18:22:03&nbsp;2011</span>
    <span class="description">nonsolosoft [...] diff.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65127] Fails test on dragonflybsd 2.9</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 03 Mar 2011 00:21:43 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Async [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ferruccio Zamuner &lt;nonsolosoft [...] diff.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/906007/469999/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/469999">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 365b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 03/02/11 19:36, Paul Evans via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=65127">https://rt.cpan.org/Ticket/Display.html?id=65127</a></span>&gt;
&gt;
<div class="message-stanza open">&gt;&gt; Test died early - listen on port 22 actually succeeded
&gt;&gt; # Looks like you planned 17 tests but ran 13.
&gt;&gt; # Looks like your test exited with 29 just after 13.
</div>&gt;
&gt; In any case, see if the attached patch fixes it.
&gt;
</div>
Yes, it works.

Thank you.          \ferz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-906341" href="/Public/Bug/Display.html?id=65127#txn-906341">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;03&nbsp;09:50:39&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/906341/470144/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/470144">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 122b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Mar 02 18:22:03 2011, nonsolosoft@diff.org wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yes, it works.
</div>
OK. This will be in 0.40 then.

-- 

Paul Evans
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-906343" href="/Public/Bug/Display.html?id=65127#txn-906343">#</a>      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;03&nbsp;09:50:41&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-910169" href="/Public/Bug/Display.html?id=65127#txn-910169">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;14&nbsp;17:37:47&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-910171" href="/Public/Bug/Display.html?id=65127#txn-910171">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;14&nbsp;17:37:47&nbsp;2011</span>
    <span class="description">leonerd-cpan [...] leonerd.org.uk -  Fixed in 0.40 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.842516</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
