<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #23391 for Net-SMTP-Multipart: TR: New version of Net-SMTP-Multipart 1.5.4</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #23391 for Net-SMTP-Multipart: TR: New version of Net-SMTP-Multipart 1.5.4</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-SMTP-Multipart/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-SMTP-Multipart/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-SMTP-Multipart/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-SMTP-Multipart/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-SMTP-Multipart">Net-SMTP-Multipart CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">23391</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-SMTP-Multipart/Active/">Net-SMTP-Multipart</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
thomas.guenneguez [...] orange-ftgroup.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23214-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23215-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;16&nbsp;12:49:40&nbsp;2006</span>
    <span class="description">thomas.guenneguez [...] orange-ftgroup.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> TR: New version of Net-SMTP-Multipart 1.5.4</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 16 Nov 2006 18:47:53 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Net-SMTP-Multipart [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;GUENNEGUEZ T ROSI/DOSI&#34; &lt;thomas.guenneguez [...] orange-ftgroup.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
I have an update to propose :
Im want replace :
-----------------------------------------------------------------------
    if &#40;ref&#40;$arg{To}&#41; eq &#39;ARRAY&#39;&#41; {
        push @to, @{$arg{To}};
        $toString = join &#34;, &#34;, @to;
    } else {
        push @to, $arg{To};
        $toString = $arg{To};
    }

    if &#40;ref&#40;$arg{Cc}&#41; eq &#39;ARRAY&#39;&#41; {
        if &#40;@{$arg{Cc}}&#41; {
            push @to, @{$arg{Cc}};
            $ccString = join &#34;, &#34;, @{$arg{Cc}};
        }
    } else {
       if &#40;$arg{Cc}&#41; {
           push @to, $arg{Cc};
           $ccString = $arg{Cc};
       }
    }
   
    if &#40;ref&#40;$arg{Bcc}&#41; eq &#39;ARRAY&#39;&#41; {
        if &#40;@{$arg{Bcc}}&#41; {
            push @to, @{$arg{Bcc}};
            # No string for Bcc, because it&#39;s hidden
        }
    } else {
        if &#40;$arg{Bcc}&#41; {
            push @to, $arg{Bcc};
        }
    }
-----------------------------------------------------------------------
bye :
-----------------------------------------------------------------------
sub EpurEmail {
if &#40; /&lt;.*&gt;/ &#41; {
return substr&#40;$_, index&#40;$_, &#39;&lt;&#39;&#41;+1, index&#40;$_, &#39;&gt;&#39;&#41;-length&#40;$_&#41;&#41;;
}
return $_;
}

    if &#40;ref&#40;$arg{To}&#41; eq &#39;ARRAY&#39;&#41; {
        $toString = join &#34;, &#34;, @{$arg{To}};
        @{$arg{To}} = map&#40;EpurEmail, @{$arg{To}}&#41;;
        push @to, @{$arg{To}};
    } else {
        $toString = $arg{To};
        @{$arg{To}} =  EpurEmail $arg{To};
        push @to, $arg{To};
    }


    if &#40;ref&#40;$arg{Cc}&#41; eq &#39;ARRAY&#39;&#41; {
        if &#40;@{$arg{Cc}}&#41; {
            $ccString = join &#34;, &#34;, @{$arg{Cc}};
            @{$arg{Cc}} = map&#40;EpurEmail, @{$arg{Cc}}&#41;;
            push @to, @{$arg{Cc}};
        }
    } else {
       if &#40;$arg{Cc}&#41; {
           $ccString = $arg{Cc};
           $arg{Cc} = EpurEmail $arg{Cc};
           push @to, $arg{Cc};
       }
    }
   
    if &#40;ref&#40;$arg{Bcc}&#41; eq &#39;ARRAY&#39;&#41; {
        if &#40;@{$arg{Bcc}}&#41; {
            @{$arg{Bcc}} = map&#40;EpurEmail , @{$arg{Bcc}}&#41;;
            push @to, @{$arg{Bcc}};
            # No string for Bcc, because it&#39;s hidden
        }
    } else {
        if &#40;$arg{Bcc}&#41; {
           $arg{Bcc} =EpurEmail $arg{Bcc};
           push @to, $arg{Bcc};
        }
    }

-----------------------------------------------------------------------

With this modification you can send an email like this :
smtp = Net::SMTP::Multipart-&gt;new&#40;&#34;mailrelay.someco.com&#34;&#41;;
$smtp-&gt;Header&#40;To   =&gt; &#39;You &lt;someone\@someco.com
&lt;mailto:thomas.guenneguez@orange-ftgroup.com&gt;&#39;&gt; &gt;&#39;,
              Subj =&gt; &#34;Multipart Mail Demo&#34;,
              From =&gt; &#39;Me &lt;me\@someco.com
&lt;mailto:peo.supervision@orange-ftgroup.com&gt;&#39;&gt; &gt;&#39;&#41;;
$smtp-&gt;Text&#40;&#34;This is the first text part of the message&#34;&#41;;
$smtp-&gt;FileAttach&#40;[&#34;myfile.xls&#34;, &#34;c:/tmp/myfile.xls&#34;]&#41;;
$smtp-&gt;End&#40;&#41;;


Thanks

Thomas GUENNEGUEZ
France Télécom - FT/ROSI/DOE/DOSI/DPROD/DPSE/PEO
4, Avenue du vieil Etang - Montigny le Bretonneux
78067 Saint Quentin en Yvelines Cedex

&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://clicvoice.si.francetelecom.fr/user/validation_clickToDial.jsp?callee">http://clicvoice.si.francetelecom.fr/user/validation_clickToDial.jsp?callee</a></span>
ID=&#38;lastName=Guenneguez&#38;firstName=Thomas&#38;calleeNumber=0675543211&gt;
06.75.54.32.11 -
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://clicvoice.si.francetelecom.fr/user/validation_clickToDial.jsp?callee">http://clicvoice.si.francetelecom.fr/user/validation_clickToDial.jsp?callee</a></span>
ID=&#38;lastName=Guenneguez&#38;firstName=Thomas&#38;calleeNumber=0155882563&gt;
01.55.88.25.63


Mail Générique :

ZZZ PEO  &lt;blocked::mailto:peo.supervision@francetelecom.com&gt; Supervision


FAQ :

<span class="clickylink"><a target="new" rel="nofollow" href="http://supnoo.si.francetelecom.fr/faq">http://supnoo.si.francetelecom.fr/faq</a></span>




*********************************
This message and any attachments &#40;the &#34;message&#34;&#41; are confidential and
intended solely for the addressees. Any unauthorised
use or dissemination is prohibited.
Messages are susceptible to alteration. France Telecom Group shall not be
liable for the message if altered, changed or
falsified.
If you are not the intended addressee of this message, please cancel it
immediately and inform the sender.
********************************



*********************************
This message and any attachments &#40;the &#34;message&#34;&#41; are confidential and intended solely for the addressees. Any unauthorised
use or dissemination is prohibited.
Messages are susceptible to alteration. France Telecom Group shall not be liable for the message if altered, changed or
falsified.
If you are not the intended addressee of this message, please cancel it immediately and inform the sender.
********************************
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;16&nbsp;13:15:00&nbsp;2006</span>
    <span class="description">thomas.guenneguez [...] orange-ftgroup.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #23391] New version of Net-SMTP-Multipart 1.5.4 </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 16 Nov 2006 19:14:04 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Net-SMTP-Multipart [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;GUENNEGUEZ T ROSI/DOSI&#34; &lt;thomas.guenneguez [...] orange-ftgroup.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
New Correction :
--------------------------------------------------------------------
sub EpurEmail {
$_ = @_[0];
if &#40; defined&#40;$_&#41; &#38;&#38; /^.*&lt;.*&gt;$/ &#41; {
return substr&#40;$_, index&#40;$_, &#39;&lt;&#39;&#41;+1, index&#40;$_, &#39;&gt;&#39;&#41;-length&#40;$_&#41;&#41;;
}
return $_;
}

    if &#40;ref&#40;$arg{To}&#41; eq &#39;ARRAY&#39;&#41; {
        $toString = join &#34;, &#34;, @{$arg{To}};
        @{$arg{To}} = map&#40;$_=EpurEmail&#40;$_&#41;, @{$arg{To}}&#41;;
        push @to, @{$arg{To}};
    } else {
        $toString = $arg{To};
        $arg{To} = EpurEmail&#40;$arg{To}&#41;;
        push @to, $arg{To};
    }


    if &#40;ref&#40;$arg{Cc}&#41; eq &#39;ARRAY&#39;&#41; {
        if &#40;@{$arg{Cc}}&#41; {
            $ccString = join &#34;, &#34;, @{$arg{Cc}};
            @{$arg{Cc}} = map&#40;$_=EpurEmail&#40;$_&#41;, @{$arg{Cc}}&#41;;
            push @to, @{$arg{Cc}};
        }
    } else {
       if &#40;$arg{Cc}&#41; {
           $ccString = $arg{Cc};
           $arg{Cc} = EpurEmail $arg{Cc};
           push @to, $arg{Cc};
       }
    }

    if &#40;ref&#40;$arg{Bcc}&#41; eq &#39;ARRAY&#39;&#41; {
        if &#40;@{$arg{Bcc}}&#41; {
            @{$arg{Bcc}} = map&#40;$_=EpurEmail&#40;$_&#41;, @{$arg{Bcc}}&#41;;
            push @to, @{$arg{Bcc}};
            # No string for Bcc, because it&#39;s hidden
        }
    } else {
        if &#40;$arg{Bcc}&#41; {
           $arg{Bcc} =EpurEmail&#40;$arg{Bcc}&#41;;
            push @to, $arg{Bcc};
        }
    }



*********************************
This message and any attachments &#40;the &#34;message&#34;&#41; are confidential and intended solely for the addressees. Any unauthorised
use or dissemination is prohibited.
Messages are susceptible to alteration. France Telecom Group shall not be liable for the message if altered, changed or
falsified.
If you are not the intended addressee of this message, please cancel it immediately and inform the sender.
********************************
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
