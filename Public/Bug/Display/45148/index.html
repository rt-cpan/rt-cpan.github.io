<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #45148 for POE-Component-Client-HTTP: HTTPS Broken</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #45148 for POE-Component-Client-HTTP: HTTPS Broken</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/POE-Component-Client-HTTP/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/POE-Component-Client-HTTP/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/POE-Component-Client-HTTP/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/POE-Component-Client-HTTP/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/POE-Component-Client-HTTP">POE-Component-Client-HTTP CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">45148</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/POE-Component-Client-HTTP/Active/">POE-Component-Client-HTTP</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
yikes2000 [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-26420-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.88    </td>
  </tr>
  <tr id="CF-26421-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Apr&nbsp;19&nbsp;15:45:54&nbsp;2009</span>
    <span class="description">yikes2000 [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> HTTPS Broken</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When requesting HTTPS URI&#39;s, only the first 4 responses are successful.
 There is a workaround though ... Protocol =&gt; &#39;HTTP/1.0&#39;
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> poe_https.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w
#
# PoCo::Client::HTTP ... broken HTTPS
#
use strict;
use Data::Dumper;
use HTTP::Request;

use POE qw&#40; Component::Client::HTTP &#41;;
use constant ME =&gt; &#40;0 .. ARG0-1&#41;;
use constant MAIN_ALIAS =&gt; &#39;main&#39;;
use constant UA_ALIAS =&gt; &#39;ua&#39;;

use constant STOCKS =&gt; 
    qw&#40; AEO AG BBL BCE BMR C CASY CBI CBRL CLP CLWR CNQR EDU EWA EWH FNF GDI 
        HIG HLTH HME IBB JCG KB LTD MFA NNN RMBS SHLD SNH SUSQ TIF TNB 
        UBS VMC YHOO AAPL IBM INTC HP CSCO NVDA BAC GS &#41;;

POE::Session-&gt;create
    &#40;  inline_states =&gt; 
       {  _start =&gt; \&#38;start,
          receive_data =&gt; \&#38;receive_data,
      }
    &#41;;

POE::Kernel-&gt;run&#40;&#41;;
exit;

#----------------------------------------

sub start {
    $_[KERNEL]-&gt;alias_set&#40; MAIN_ALIAS &#41;;

    POE::Component::Client::HTTP-&gt;spawn
        &#40;  Alias        =&gt; UA_ALIAS,
           # Protocol     =&gt; &#39;HTTP/1.0&#39;,
           Timeout      =&gt; 10,
           FollowRedirects =&gt; 1,
        &#41;;
    
    foreach my $sym &#40;STOCKS&#41; 
        { request_https_data&#40; @_[&#40;ME&#41;], $sym &#41;; }
}

sub request_https_data {
    my $sym = $_[ARG0];

    my $url = &#39;<span class="clickylink"><a target="new" rel="nofollow" href="https://moneycentral.msn.com/detail/stock_quote?&#39;">https://moneycentral.msn.com/detail/stock_quote?&#39;</a></span>.
        &#34;Symbol=$sym&#38;getquote=Get+Quote&#34;;

    my $req = HTTP::Request-&gt;new&#40; GET =&gt; $url &#41;;
    $req-&gt;header&#40; x_sym =&gt; $sym &#41;;

    $_[HEAP]{buf}{$sym} = &#39;&#39;;
    $_[KERNEL]-&gt;post&#40; UA_ALIAS, &#39;request&#39;, &#39;receive_data&#39;, $req &#41;;
}

sub receive_data {
    my &#40;$request_packet, $response_packet&#41; = @_[ARG0, ARG1];

    my $req_obj = $request_packet-&gt;[0];
    my $sym = $req_obj-&gt;header&#40; &#39;x_sym&#39; &#41;;

    my $resp_obj = $response_packet-&gt;[0];
    my $new_chunk = $resp_obj-&gt;decoded_content&#40;&#41;;
    return if ! $new_chunk;

    my $data = $new_chunk;
    my @lines = split /&lt;li /, $data;
    my $lines = @lines + 0;
    print &#34;&lt;$sym&gt; &#34;.length&#40;$data&#41;.&#34; bytes; $lines lines\n&#34;;

    print $data.&#34;\n&#34; if $sym =~ /^GS/i;
}

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;26&nbsp;13:08:48&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I modified your program to tell me how long the requests were taking. 
You are seeing timeouts because more time has elapsed than your
10-second timeout.

&lt;AG&gt; 16904 bytes; 19 lines after 5 seconds
&lt;AEO&gt; 34520 bytes; 29 lines after 5 seconds
&lt;BCE&gt; 32627 bytes; 28 lines after 5 seconds
&lt;BMR&gt; 32359 bytes; 24 lines after 6 seconds
&lt;CASY&gt; 34588 bytes; 29 lines after 7 seconds
&lt;CBI&gt; 35485 bytes; 29 lines after 9 seconds
&lt;CBRL&gt; 34765 bytes; 29 lines after 9 seconds
&lt;C&gt; 25720 bytes; 36 lines after 9 seconds
&lt;CLP&gt; 32693 bytes; 25 lines after 9 seconds
&lt;CLWR&gt; 33575 bytes; 28 lines after 11 seconds
... timeouts begin here ...
&lt;EWA&gt; 267 bytes; 1 lines after 12 seconds
&lt;EWH&gt; 267 bytes; 1 lines after 12 seconds
&lt;FNF&gt; 267 bytes; 1 lines after 12 seconds
&lt;GDI&gt; 267 bytes; 1 lines after 12 seconds
&lt;HIG&gt; 267 bytes; 1 lines after 12 seconds
... and continue for the remaining ticker symbols.

One solution is to increase your timeout.

Another is to tune POE::Component::Client::Keepalive to allow more
concurrent connections overall, and more concurrent connections per
host.  See the ConnectionManager parameter for
POE::Component::Client::HTTP and the documentation for
POE::Component::Client::Keepalive.

A third solution is to send a modest number of requests to start with,
then send more requsts as they complete.

Thank you.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;26&nbsp;13:08:49&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;26&nbsp;13:08:49&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
