<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #7741 for XML-Validator-Schema: Patch for more debugging information</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #7741 for XML-Validator-Schema: Patch for more debugging information</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/XML-Validator-Schema/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/XML-Validator-Schema/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/XML-Validator-Schema/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/XML-Validator-Schema/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-Validator-Schema">XML-Validator-Schema CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">7741</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/XML-Validator-Schema/Active/">XML-Validator-Schema</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mat_trash [...] hotmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-37690-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-37691-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;12:29:09&nbsp;2004</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Patch for more debugging information</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
 this patch adds the debug parameter to the new method so that we can follow the parsing and validation of an xml document. This provide the user with the approximate position in the XML document at which the validation has failed.
 For example with the test files test.xml &#38; test.xsd with debug set to 1, we have the following output:
   o foo
     o int
     o integer
     o name
     o string
     o bool
     o date

 If we modify the test.xml to add a new &lt;null&gt;foo&lt;/null&gt; tag, we have:
   o foo
     o int
     o integer
     o name
     o string
     o bool
     o date
     o null
File failed validation: Found unexpected &lt;null&gt; inside &lt;foo&gt;.  This is not a valid child element.
 at /usr/local/lib/perl/5.8.3/XML/LibXML/SAX.pm line 63

 The attributes are also diplayed, for the following xml file:
&lt;foo&gt;
     &lt;int myatt1=&#34;one&#34; myatt2=&#34;two&#34;&gt;1&lt;/int&gt;
     &lt;integer&gt;1&lt;/integer&gt;
     &lt;name&gt;foo&lt;/name&gt;
     &lt;string&gt;...&lt;/string&gt;
     &lt;bool&gt;true&lt;/bool&gt;
     &lt;date&gt;1977-08-02T20:02:00&lt;/date&gt;
&lt;/foo&gt;

we have:
   o foo
     o int
         - myatt2 = two
         - myatt1 = one
     o integer
     o name
     o string
     o bool
     o date


 I hope you&#39;ll find this patch useful, I&#39;ve also updated the pod.
 Thanks for your module.

Mathieu
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Schema.1.06.pm	2004-09-22 17:47:43.000000000 +0200
+++ Schema.1.07.pm	2004-09-22 17:49:57.000000000 +0200
@@ -4,7 +4,7 @@
 use strict;
 use warnings;
 
-our $VERSION = &#39;1.06&#39;;
+our $VERSION = &#39;1.07&#39;;
 
 =head1 NAME
 
@@ -68,7 +68,10 @@
   eval { $parser-&gt;parse_uri&#40;&#39;foo.xml&#39;&#41; };
   die &#34;File failed validation: $@&#34; if $@;
 
-
+Setting the optional C&lt;debug&gt; parameter to 1 causes
+XML::Validator::Schema to output elements and associated attributes
+while parsing and validating the XML document. This provides
+ useful information on the position where the validation failed.
 
 =back
 
@@ -472,12 +475,16 @@
 use XML::Validator::Schema::Util qw&#40;_err&#41;;
 our %CACHE;
 
+use constant	DEBUG	=&gt; 0;
+
 # create a new validation filter
 sub new {
     my $pkg  = shift;
     my $opt  = &#40;@_ == 1&#41;  ? { %{shift&#40;&#41;} } : {@_};
     my $self = bless $opt, $pkg;
 
+    $self-&gt;{debug}	= &#40; defined $self-&gt;{debug} &#41; ? $self-&gt;{debug} : DEBUG;
+
     # check options
     croak&#40;&#34;Missing required &#39;file&#39; option.&#34;&#41; unless $self-&gt;{file};
 
@@ -538,11 +545,21 @@
     my $element = $node_stack-&gt;[-1];
 
     # check that this alright
+    print STDERR &#34;  &#34; x scalar&#40;@{$node_stack}&#41;, &#34; o &#34;, $name, &#34;\n&#34; 
+     if &#40; $self-&gt;{debug} &#41;;
     my $daughter = $element-&gt;check_daughter&#40;$name&#41;;
 
     # check attributes
     $daughter-&gt;check_attributes&#40;$data-&gt;{Attributes}&#41;;
 
+    if &#40; $self-&gt;{debug} &#41; {
+     foreach my $att &#40; keys %{ $data-&gt;{Attributes} } &#41; {
+      print STDERR &#34;  &#34; x &#40;scalar&#40;@{$node_stack}&#41; + 2&#41;, &#34; - &#34;, 
+       $data-&gt;{Attributes}-&gt;{$att}-&gt;{Name}, &#34; = &#34;, 
+       $data-&gt;{Attributes}-&gt;{$att}-&gt;{Value}, &#34;\n&#34; 
+     }
+    }
+
     # enter daughter node
     push&#40;@$node_stack, $daughter&#41;;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;12:35:09&nbsp;2004</span>
    <span class="description">SAMTREGAR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is very neat!  I&#39;d still like to get filenames and line-numbers
into the error output, but this should help for now.  I&#39;ll put it in for
the next release which should come soon.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;12:35:12&nbsp;2004</span>
    <span class="description">SAMTREGAR [...] cpan.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
