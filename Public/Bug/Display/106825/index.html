<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #106825 for Perl-Dist-Strawberry: failure to load mysql.xs.dll because it cannot find libmysql_.dll</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #106825 for Perl-Dist-Strawberry: failure to load mysql.xs.dll because it cannot find libmysql_.dll</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Perl-Dist-Strawberry">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Perl-Dist-Strawberry">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Perl-Dist-Strawberry">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Perl-Dist-Strawberry">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Perl-Dist-Strawberry">Perl-Dist-Strawberry CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">106825</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Perl-Dist-Strawberry">Perl-Dist-Strawberry</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ArntW [...] enfocus.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40214-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40215-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=106825">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1531496" href="/Public/Bug/Display.html?id=106825#txn-1531496">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;02&nbsp;11:09:30&nbsp;2015</span>
    <span class="description">ArntW [...] enfocus.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> failure to load mysql.xs.dll because it cannot find libmysql_.dll</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 2 Sep 2015 15:09:10 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Perl-Dist-Strawberry [...] rt.cpan.org&#34; &lt;bug-Perl-Dist-Strawberry [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Witteveen, Arnt&#34; &lt;ArntW [...] enfocus.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1531496/817135/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817135">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, I&#39;m running into a problem described in a few places online, e.g. here: <span class="clickylink"><a target="new" rel="nofollow" href="http://stackoverflow.com/questions/4206439/sequenced-steps-to-install-perl-strawberry-mysql-and-dbdmysql-on-windows-xp">http://stackoverflow.com/questions/4206439/sequenced-steps-to-install-perl-strawberry-mysql-and-dbdmysql-on-windows-xp</a></span> 

The only solution found online seems to be to copy a dll from one folder of perl into another one. A similar problem seems to be described here <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=99104">https://rt.cpan.org/Public/Bug/Display.html?id=99104</a></span> &#40;and in reports linked form that&#41;.

I&#39;ve looked into this a bit more on my system, because copying files from one part of a distribution to another does not seem like a good solution. In particular, many comments suggest the problem is in the PATH variable, and as far as I can see, it isn&#39;t for me.

First, the error message, when I access any of the pages of Bugzilla &#40;which I&#39;m trying to set up&#41;:
--------
install_driver&#40;mysql&#41; failed: Can&#39;t load &#39;C:/StrawberryPerl/perl/vendor/lib/auto/DBD/mysql/mysql.xs.dll&#39; for module DBD::mysql: load_file:The specified module could not be found at C:/StrawberryPerl/perl/lib/DynaLoader.pm line 193.
 at &#40;eval 44&#41; line 3.
Compilation failed in require at &#40;eval 44&#41; line 3.
Perhaps a required shared library or dll isn&#39;t installed where expected
 at Bugzilla/DB.pm line 1284.

For help, please send mail to this site&#39;s webmaster, giving this error message and the time and date of the error. 

[Wed Sep 2 16:01:24 2015] index.cgi: install_driver&#40;mysql&#41; failed: Can&#39;t load &#39;C:/StrawberryPerl/perl/vendor/lib/auto/DBD/mysql/mysql.xs.dll&#39; for module DBD::mysql: load_file:The specified module could not be found at C:/StrawberryPerl/perl/lib/DynaLoader.pm line 193. [Wed Sep 2 16:01:24 2015] index.cgi: at &#40;eval 44&#41; line 3. [Wed Sep 2 16:01:24 2015] index.cgi: Compilation failed in require at &#40;eval 44&#41; line 3. [Wed Sep 2 16:01:24 2015] index.cgi: Perhaps a required shared library or dll isn&#39;t installed where expected [Wed Sep 2 16:01:24 2015] index.cgi: at Bugzilla/DB.pm line 1284.
--------
As you can see, I&#39;ve installed Strawberry perl &#39;C:/StrawberryPerl&#39;. Version is 5.22.0.1 64bit. The OS is a Windows Server 2008 R2 Standard.
I have installed the necessary perl modules through bugzilla&#39;s script to do so &#40;&#34;C:\StrawberryPerl\perl\bin\perl.exe install-module.pl --all&#34;&#41;, which made it get a bunch of modules from cpan.

Tracing this issue with Microsoft Sysinternals Process Monitor, I can see that mysql.xs.dll fails to load because its dependency libmysql_.dll is not found. This file is part of the distribution, found at: C:\StrawberryPerl\c\bin\libmysql_.dll . 

Process Monitor shows these locations are searched for libmysql_.dll :

C:\StrawberryPerl\perl\vendor\lib\auto\DBD\mysql\libmysql_.dll
C:\Windows\SysWOW64\libmysql_.dll
C:\Windows\system\libmysql_.dll
C:\Windows\libmysql_.dll
C:\inetpub\Bugzilla\libmysql_.dll

Looking at <span class="clickylink"><a target="new" rel="nofollow" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586%28v=vs.85%29.aspx#search_order_for_desktop_applications">https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586%28v=vs.85%29.aspx#search_order_for_desktop_applications</a></span> I can see this matches &#34; Standard Search Order for Desktop Applications&#34; with SafeDllSearchMode enabled, but without searching PATH.

To make sure perl is seeing the path I think it sees, I made a perl script in the Bugzilla folder, and accessed it via a browser just like I access the rest of Bugzilla, and let it print the path and INC:

print &#34;path : $ENV{PATH}\n&#34;;
print &#34;INC: @INC \n&#34; ;

the result is:
path : C:\ProgramData\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\System Center Operations Manager 2007\;C:\Program Files\Perforce;C:\Program Files &#40;x86&#41;\PDFtk\bin\;C:\StrawberryPerl\c\bin;C:\StrawberryPerl\perl\site\bin;C:\StrawberryPerl\perl\bin;
INC: C:/StrawberryPerl/perl/site/lib C:/StrawberryPerl/perl/vendor/lib C:/StrawberryPerl/perl/lib

I&#39;ve then updated the Handler Mapping in IIS 7 to add -IC:/StrawberryPerl/c/bin to the perl command line. This is reflected in &#39;INC&#39; as expected:

path : path : C:\ProgramData\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\System Center Operations Manager 2007\;C:\Program Files\Perforce;C:\Program Files &#40;x86&#41;\PDFtk\bin\;C:\StrawberryPerl\c\bin;C:\StrawberryPerl\perl\site\bin;C:\StrawberryPerl\perl\bin;
INC: C:/StrawberryPerl/c/bin C:/StrawberryPerl/perl/site/lib C:/StrawberryPerl/perl/vendor/lib C:/StrawberryPerl/perl/lib

However this does not change the error, nor does it change the locations that are searched for libmysql_.dll seen in Process Monitor.

So, in summary: as far as I can determine, the folders in the path are not used to load the dependent dll&#39;s . I&#39;ve also tried to run, command line:

perl -IC:/StrawberryPerl/c/bin -xC:\inetpub\Bugzilla -wT &#34;index.cgi&#34; index.cgi

this returns the same error message, so it&#39;s not caused by IIS or it&#39;s cgi implementation. This then causes issues when one dll installed by Strawberry Perl needs another one.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1531721" href="/Public/Bug/Display.html?id=106825#txn-1531721">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;04:14:42&nbsp;2015</span>
    <span class="description">ArntW [...] enfocus.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #106825] additional information</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 3 Sep 2015 08:14:27 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Perl-Dist-Strawberry [...] rt.cpan.org&#34; &lt;bug-Perl-Dist-Strawberry [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Witteveen, Arnt&#34; &lt;ArntW [...] enfocus.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1531721/817255/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817255">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 596b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Looking further for reasons why the path isn&#39;t used to search for dll&#39;s, it turns out that MS KB 2533623 &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://support.microsoft.com/en-us/kb/2533623">https://support.microsoft.com/en-us/kb/2533623</a></span> &#41; is installed. This changes the dll search path as documented on <span class="clickylink"><a target="new" rel="nofollow" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586.aspx#search_order_using_load_library_search_flags_">https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586.aspx#search_order_using_load_library_search_flags_</a></span> and <span class="clickylink"><a target="new" rel="nofollow" href="https://msdn.microsoft.com/en-us/library/windows/desktop/hh310515.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/hh310515.aspx</a></span> . 
Specifically, those pages show that the PATH will not be used at all to search for a dll. However, AddDllDirectory and  SetDllDirectory can be used to influence the search path.

</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1531731" href="/Public/Bug/Display.html?id=106825#txn-1531731">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;07:06:56&nbsp;2015</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #106825] failure to load mysql.xs.dll because it cannot find libmysql_.dll</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 3 Sep 2015 13:06:41 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1531731/817260/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817260">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 600b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for your analysis.

The problem with moving or copying &#40;duplicating&#41; libmysql_.dll to 
C:/StrawberryPerl/perl/vendor/lib/auto/DBD/mysql/ is that is fixes only 
DBD::mysql but what about DBD::Pg? or DBD::Oracle? or what if the perl app 
will use quite common Net::SSLeay? or some XML or graphics modules using 
external *._dll?

IMO we cannot duplicate all possible dlls packed with strawberry perl in 
this way.

I&#39;ll try to think about that a bit more.

What definitely would be great is having something like 
HOWTO.strawberry-perl+MS-IIS.txt &#40;describing all necessary workarounds&#41;

--
kmx
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1531732" href="/Public/Bug/Display.html?id=106825#txn-1531732">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;07:06:57&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1531740" href="/Public/Bug/Display.html?id=106825#txn-1531740">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;07:18:11&nbsp;2015</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #106825] additional information</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 3 Sep 2015 13:17:57 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1531740/817263/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817263">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 106b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I mean something like this:
<span class="clickylink"><a target="new" rel="nofollow" href="http://php.net/manual/en/install.windows.iis7.php">http://php.net/manual/en/install.windows.iis7.php</a></span>

Just for strawberry perl.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1531752" href="/Public/Bug/Display.html?id=106825#txn-1531752">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;07:50:43&nbsp;2015</span>
    <span class="description">ArntW [...] enfocus.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #106825] </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 3 Sep 2015 11:50:19 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Perl-Dist-Strawberry [...] rt.cpan.org&#34; &lt;bug-Perl-Dist-Strawberry [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Witteveen, Arnt&#34; &lt;ArntW [...] enfocus.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1531752/817275/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817275">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 696b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I agree that duplicating these files isn&#39;t a good solution &#40;although I guess you could copy all the dependencies needed by each one to their folders, but that would probably be a lot of duplicate files&#41;. 

Depending on the reasons for having mysql.xs.dll in a path like perl/vendor/lib/auto/DBD/mysql, a solution might be to do it the other way around: move mysql.xs.dll and all similar dll&#39;s into 1 folder together with their dependencies?

One other way would be to patch the loading of the module in perl to add the right dll search paths with something like AddDllDirectory, but I&#39;ve never looked at perl source so I haven&#39;t really been able to find where the module loading happens.
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1531761" href="/Public/Bug/Display.html?id=106825#txn-1531761">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;07:59:06&nbsp;2015</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #106825]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 3 Sep 2015 13:58:54 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Perl-Dist-Strawberry [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kmx &lt;kmx [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1531761/817280/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817280">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 181b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Another trouble is that when you install an upgrade of DBD::mysql yourself 
it will be installed in:

perl/_*site*_/lib/auto/DBD/mysql/mysql.xs.dll

and the problem is back again.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1532065" href="/Public/Bug/Display.html?id=106825#txn-1532065">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;21:32:39&nbsp;2015</span>
    <span class="description">csjewell [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> My quick suggestion</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1532065/817447/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817447">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 690b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">My quick suggestion is that we release-note this problem with this example code &#40;I seem to recall that we install Win32::API along with Strawberry&#41; based on what I see at <span class="clickylink"><a target="new" rel="nofollow" href="https://support.microsoft.com/en-us/kb/2533623">https://support.microsoft.com/en-us/kb/2533623</a></span> and the links under &#39;More Information&#39; there.

# Given an unchanged @INC, $INC[-2] is $Strawberry/perl/lib.

    my $SetDDFlags = Win32::API::More-&gt;new&#40;
        &#39;kernel32&#39;, &#39;SetDefaultDirectoryFlags&#39;, &#39;i&#39;, &#39;i&#39;
    &#41;;
    if &#40;$SetDDFlags&#41; {
        $SetDDFlags&#40;0x00001000&#41;;
    }

    my $AddDLLDirectory = Win32::API::More-&gt;new&#40;
        &#39;kernel32&#39;, &#39;AddDLLDirectory&#39;, &#39;P&#39;, &#39;v&#39;
    &#41;;
    if &#40;AddDLLDirectory&#41; {
        $AddDLLDirectory&#40;$INC[-2] . &#34;/../../c/lib\0&#34;&#41;;
    }
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1532068" href="/Public/Bug/Display.html?id=106825#txn-1532068">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;21:33:59&nbsp;2015</span>
    <span class="description">csjewell [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1532068/817450/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/817450">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 65b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Or, at least, something to that effect, this code is first-draft.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.488319</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
