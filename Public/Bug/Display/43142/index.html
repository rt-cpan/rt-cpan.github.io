<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #43142 for Net-DNS: Enheance Net::DNS::Nameserver to support forking nameservers</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #43142 for Net-DNS: Enheance Net::DNS::Nameserver to support forking nameservers</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Net-DNS">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Net-DNS">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Net-DNS">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Net-DNS">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-DNS">Net-DNS CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">43142</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Net-DNS">Net-DNS</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
7eggert [...] gmx.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-22454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-22455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Nameserver.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/564864/285269/Nameserver.diff">
Mon Feb 09 07:35:10 2009 (1.7k) by 7eggert [...] gmx.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=43142">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-564864" href="/Public/Bug/Display.html?id=43142#txn-564864">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;09&nbsp;07:35:10&nbsp;2009</span>
    <span class="description">7eggert [...] gmx.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/564864/285266/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/285266">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 528b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m using Net::DNS::Nameserver to create a forwarding nameserver.
Unfortunately I need to fork in the reply handler, because I don&#39;t want 
to stall the whole local DNS server while the upstream server times out 
on one query.

In order to do this, I added one optional return parameter &#40;telling it 
to exit after sending the response&#41;, and implemented a way to not reply 
at all.

I made the changes a while ago for version 0.63. Today, I forward-ported
it to 0.65 and did a compile test.

The changes are in the attached patch.
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Nameserver.diff</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/564864/285269/Nameserver.diff">Download Nameserver.diff</a><br />
<span class="downloadcontenttype">text/x-diff 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Nameserver.pm.ori	2008-09-07 21:37:02.000000000 +0200
+++ Nameserver.pm	2008-09-07 21:29:34.000000000 +0200
@@ -155,7 +155,7 @@ sub make_reply {
 	my $reply = Net::DNS::Packet-&gt;new&#40;&#41;;	# create empty reply packet
 	$reply-&gt;header-&gt;qr&#40;1&#41;;
 
-	my $headermask;
+	my &#40;$headermask, $flags&#41;;
 	
 	unless &#40;$query&#41; {
 		print &#34;ERROR: invalid packet\n&#34; if $self-&gt;{&#34;Verbose&#34;};
@@ -190,7 +190,7 @@ sub make_reply {
 			my &#40;$rcode, $ans, $auth, $add&#41;;
 			
 			if  &#40;$query-&gt;header-&gt;opcode eq &#34;QUERY&#34;&#41;{
-			  &#40;$rcode, $ans, $auth, $add, $headermask&#41; =
+			  &#40;$rcode, $ans, $auth, $add, $headermask, $flags&#41; =
 			      &#38;{$self-&gt;{&#34;ReplyHandler&#34;}}&#40;$qname, $qclass, $qtype, $peerhost, $query&#41;;
 			}else{
 			  $reply-&gt;header-&gt;rcode&#40;&#34;SERVFAIL&#34;&#41; unless 
@@ -198,8 +198,16 @@ sub make_reply {
 			  &#40;$rcode, $ans, $auth, $add, $headermask&#41; =
 			      &#38;{$self-&gt;{&#34;NotifyHandler&#34;}}&#40;$qname, $qclass, $qtype, $peerhost, $query&#41;;
 			}
-			print &#34;$rcode\n&#34; if $self-&gt;{&#34;Verbose&#34;};
-			
+
+			if &#40;!defined $rcode&#41; {
+				print &#34;remaining silent\n&#34; if $self-&gt;{&#34;Verbose&#34;};
+				return undef;
+			} elsif &#40;$rcode eq &#39;FORKED&#39;&#41; {
+				print &#34;Forked, Parent remains silent\n&#34; if $self-&gt;{&#34;Verbose&#34;};
+				return undef;
+			}
+			print &#34;rcode=$rcode\n&#34; if $self-&gt;{&#34;Verbose&#34;};
+
 			$reply-&gt;header-&gt;rcode&#40;$rcode&#41;;
 			
 			$reply-&gt;push&#40;&#34;answer&#34;,	   @$ans&#41;  if $ans;
@@ -233,6 +241,7 @@ sub make_reply {
 	$reply-&gt;header-&gt;id&#40;$query-&gt;header-&gt;id&#41;;
 	
 	$reply-&gt;header-&gt;print if $self-&gt;{&#34;Verbose&#34;} &#38;&#38; defined $headermask;
+	$reply-&gt;{flags} = $flags;
 
 	return $reply;
 }
@@ -360,6 +369,10 @@ sub udp_connection {
 	else {
 	  print &#34;failed to send reply: $!\n&#34; if $self-&gt;{&#34;Verbose&#34;};
 	}
+	if &#40;defined $reply-&gt;{flags} &#38;&#38; $reply-&gt;{flags}-&gt;{exit}&#41; {
+		print &#34;Exiting\n&#34; if $self-&gt;{&#34;Verbose&#34;};
+		exit 0;
+	}
       }
 
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-564876" href="/Public/Bug/Display.html?id=43142#txn-564876">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;09&nbsp;08:35:11&nbsp;2009</span>
    <span class="description">7eggert [...] gmx.de -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-564877" href="/Public/Bug/Display.html?id=43142#txn-564877">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;09&nbsp;08:37:39&nbsp;2009</span>
    <span class="description">7eggert [...] gmx.de -  Subject changed from &#40;no value&#41; to &#39;Enheance Net::DNS::Nameserver to support forking nameservers&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-564878" href="/Public/Bug/Display.html?id=43142#txn-564878">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;09&nbsp;08:37:39&nbsp;2009</span>
    <span class="description">7eggert [...] gmx.de -  Status changed from &#39;open&#39; to &#39;new&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-566294" href="/Public/Bug/Display.html?id=43142#txn-566294">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;13&nbsp;17:50:52&nbsp;2009</span>
    <span class="description">ABH [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/566294/285937/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/285937">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 158b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">That can&#39;t be the right way to do what you need.  Forking on each DNS request isn&#39;t going to 
work for anything but development and Very Small environments.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-566295" href="/Public/Bug/Display.html?id=43142#txn-566295">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;13&nbsp;17:50:54&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-989711" href="/Public/Bug/Display.html?id=43142#txn-989711">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;19&nbsp;18:53:09&nbsp;2011</span>
    <span class="description">willem [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/989711/515226/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/515226">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 249b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Bodo,

I can see that what you want is convenient. I have silently committed a
patch that prevents the Net::DNS::Nameserver from answering when a
ReplyHandler returns undef, but I am reluctant to put that forward as a
feature.
Regards,

-- Willem
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-989714" href="/Public/Bug/Display.html?id=43142#txn-989714">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;19&nbsp;18:53:10&nbsp;2011</span>
    <span class="description">willem [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-990506" href="/Public/Bug/Display.html?id=43142#txn-990506">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;21&nbsp;09:14:52&nbsp;2011</span>
    <span class="description">7eggert [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> 7eggert [...] gmx.de</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43142] Enheance Net::DNS::Nameserver to support forking nameservers </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 21 Oct 2011 15:14:42 +0200 &#40;CEST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Willem Toorop via RT &lt;bug-Net-DNS [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Bodo Eggert &lt;7eggert [...] gmx.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/990506/515714/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/515714">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 639b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, 19 Oct 2011, Willem Toorop via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43142">https://rt.cpan.org/Ticket/Display.html?id=43142</a></span> &gt;
&gt;
&gt; Hi Bodo,
&gt;
&gt; I can see that what you want is convenient. I have silently committed a
&gt; patch that prevents the Net::DNS::Nameserver from answering when a
&gt; ReplyHandler returns undef, but I am reluctant to put that forward as a
&gt; feature.
&gt; Regards,
</div>
Thanks. I had some other issues &#40;don´t remember&#41;, which forced me to 
abandon my own DNS server and return to bind, though.

I think I tried returning undef, but being able to find a feature in the 
documentation tends to help.-&#41; I don´t see why you would not advertize it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-990508" href="/Public/Bug/Display.html?id=43142#txn-990508">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;21&nbsp;09:14:53&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-990568" href="/Public/Bug/Display.html?id=43142#txn-990568">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;21&nbsp;12:05:08&nbsp;2011</span>
    <span class="description">bbb [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #43142] Enheance Net::DNS::Nameserver to support forking nameservers</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 21 Oct 2011 10:04:59 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-DNS [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rob Brown &lt;bbb [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/990568/515740/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/515740">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I really like this feature of ReplyHandler returning undef as a way to
just not respond to the client because &#34;not responding&#34; can be a valid
intentional response under certain conditions, such as abusive clients
or delinquent service payment for zones or even for testing purposes.
And as an added bonus, this feature could still crudely be used for
your fork&#40;&#41; design. However, it would require a double fork to avoid
zombies, and the ReplyHandler would have to be responsible for sending
the response packet directly itself. Unfortunately, I don&#39;t think this
fork&#40;&#41; hack work with TCP very easily.

So I say leave the &#34;undef means no response&#34; and document it as an
intended feature.

On Fri, Oct 21, 2011 at 7:14 AM, Bodo Eggert via RT
&lt;bug-Net-DNS@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: Net-DNS
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43142">https://rt.cpan.org/Ticket/Display.html?id=43142</a></span> &gt;
&gt;
&gt; On Wed, 19 Oct 2011, Willem Toorop via RT wrote:
&gt;
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=43142">https://rt.cpan.org/Ticket/Display.html?id=43142</a></span> &gt;
&gt;&gt;
&gt;&gt; Hi Bodo,
&gt;&gt;
&gt;&gt; I can see that what you want is convenient. I have silently committed a
&gt;&gt; patch that prevents the Net::DNS::Nameserver from answering when a
&gt;&gt; ReplyHandler returns undef, but I am reluctant to put that forward as a
&gt;&gt; feature.
&gt;&gt; Regards,
</div>&gt;
&gt; Thanks. I had some other issues &#40;don´t remember&#41;, which forced me to
&gt; abandon my own DNS server and return to bind, though.
&gt;
&gt; I think I tried returning undef, but being able to find a feature in the
&gt; documentation tends to help.-&#41; I don´t see why you would not advertize it.
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-990680" href="/Public/Bug/Display.html?id=43142#txn-990680">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;21&nbsp;17:26:55&nbsp;2011</span>
    <span class="description">willem [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> net-dns-dev [...] nlnetlabs.nl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/990680/515808/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/515808">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 720b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Oct 21 12:05:08 2011, BBB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Unfortunately, I don&#39;t think this
&gt; fork&#40;&#41; hack work with TCP very easily.
</div>
Yes, and also to determine if a query came in from TCP and which socket
was used would be quiet difficult.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; So I say leave the &#34;undef means no response&#34; and document it as an
&gt; intended feature.
</div>
Agreed. I propose to change the sentence about ReplyHanlder&#39;s return
value&#40;s&#41; from:

It must return the response code and references to the answer,
authority, and additional sections of the response.

in

It must either return the response code and references to the answer,
authority, and additional sections of the response, or C&lt;undef&gt; to leave
the query unanswered.

Better formulations are welcome.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-992337" href="/Public/Bug/Display.html?id=43142#txn-992337">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;26&nbsp;09:28:09&nbsp;2011</span>
    <span class="description">willem [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/992337/516752/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/516752">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 17b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Closing ticket...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-992340" href="/Public/Bug/Display.html?id=43142#txn-992340">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;26&nbsp;09:28:11&nbsp;2011</span>
    <span class="description">willem [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.563808</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
