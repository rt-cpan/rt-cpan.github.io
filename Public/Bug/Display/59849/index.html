<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #59849 for DBIx-Class-Schema-Loader: cannot load additional methods from files + use_namespaces discrepencies</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #59849 for DBIx-Class-Schema-Loader: cannot load additional methods from files + use_namespaces discrepencies</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBIx-Class-Schema-Loader">DBIx-Class-Schema-Loader CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">59849</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBIx-Class-Schema-Loader/Active/">DBIx-Class-Schema-Loader</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MARKLE [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-38270-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.07001    </td>
  </tr>
  <tr id="CF-38271-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;29&nbsp;23:02:04&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I am using the use_namespaces option.

It used to be that I have inflate/deflate and additional methods defined
in packages which get merged with the dynamic packages.  That is broken
by the latest version.  Now I get errors like this:

Cannot connect schema: &#39;Failed to reload class DeSpam::DC::Service:
Subroutine get_despam_service redefined at
/tmp/dbicZT5e/DeSpam/DC/Service.pm line 213.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;29&nbsp;23:09:54&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">0.7.0 is broken too, but in that version, the error is:

Cannot connect schema: &#39;Can&#39;t call method &#34;Indent&#34; without a package or
object reference at
/usr/lib/perl5/site_perl/5.8.8/DBIx/Class/Schema/Loader/Base.pm line 1747.

BTW I am using perl 5.8.8 in CentOS.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;29&nbsp;23:09:55&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;29&nbsp;23:16:12&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have to go back to 0.05003 to make it work.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jul&nbsp;29&nbsp;23:25:06&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">BTW it doesn&#39;t matter if I rename the method in the defined package
under the namespace to something else.  Any method name fails.

setting debug_1 shows everything working okay, then

# Loaded external class definition for &#39;DeSpam::DC::Service&#39;
&#40;and 3 other external class definition libs&#41;

... and then the error when my test script tries to get the schema ...

Cannot connect schema: &#39;Failed to reload class DeSpam::DC::Service:
Subroutine get_despam_service redefined at
/tmp/dbic4VsY/DeSpam/DC/Service.pm line 213.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;30&nbsp;11:15:14&nbsp;2010</span>
    <span class="description">rkitover@cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #59849]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Jul 2010 11:15:18 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Mark Hedges via RT &lt;bug-DBIx-Class-Schema-Loader [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rafael Kitover &lt;rkitover [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">By the way, are you using something that fatalizes warnings?

On Thu, Jul 29, 2010 at 11:25:09PM -0400, Mark Hedges via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: DBIx-Class-Schema-Loader
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=59849">https://rt.cpan.org/Ticket/Display.html?id=59849</a></span> &gt;
&gt; 
&gt; BTW it doesn&#39;t matter if I rename the method in the defined package
&gt; under the namespace to something else.  Any method name fails.
&gt; 
&gt; setting debug_1 shows everything working okay, then
&gt; 
&gt; # Loaded external class definition for &#39;DeSpam::DC::Service&#39;
&gt; &#40;and 3 other external class definition libs&#41;
&gt; 
&gt; ... and then the error when my test script tries to get the schema ...
&gt; 
&gt; Cannot connect schema: &#39;Failed to reload class DeSpam::DC::Service:
&gt; Subroutine get_despam_service redefined at
&gt; /tmp/dbic4VsY/DeSpam/DC/Service.pm line 213.
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;04&nbsp;22:02:25&nbsp;2010</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> rkitover [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jul 29 23:25:06 2010, MARKLE wrote:
...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Cannot connect schema: &#39;Failed to reload class DeSpam::DC::Service:
&gt; Subroutine get_despam_service redefined at
&gt; /tmp/dbic4VsY/DeSpam/DC/Service.pm line 213.
</div>
Please send me a test app that reproduces this exception.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;13&nbsp;20:08:48&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> rkitover [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Aug 04 22:02:25 2010, RKITOVER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Please send me a test app that reproduces this exception.
</div>
Here is a test script with some libs to drop into the 0.07001 source
directory.

Am I doing something totally wrong?  This used to work.

Thanks.

Mark
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> DBICTestMethods_files.tar</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;13&nbsp;20:23:04&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m not sure what&#39;s going on... this does the same thing when run in
0.04006 also... but my production code works fine under 0.04006 but
generates the same error as the test script in later versions.  Madness.
 However, the test script I supplied seems simple enough as a starting
point.  Does it work for you?  Maybe it is something else majorly
screwy.  This is CentOS with perl 5.8.8.  Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;13&nbsp;20:58:47&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> rkitover [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is suddenly a LOT better with an upgrade of DBIx::Class to the
latest version.  Looks like you need to depend on a more recent version,
which is probably what you used to develop your changes since you took over.

I&#39;m still having some confusion over which namespace the result classes
should get, but this might be my misunderstanding. 

Thanks.  --mark--
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;16&nbsp;09:41:12&nbsp;2010</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #59849]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 30 Jul 2010 09:15:38 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBIx-Class-Schema-Loader [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rafael Kitover &lt;rkitover [...] io.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Is that the full error message? The redefined message is just a warning. Please attach a test app/schema.

&#34;Mark Hedges via RT&#34; &lt;bug-DBIx-Class-Schema-Loader@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: DBIx-Class-Schema-Loader
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=59849">https://rt.cpan.org/Ticket/Display.html?id=59849</a></span> &gt;
&gt;
&gt;BTW it doesn&#39;t matter if I rename the method in the defined package
&gt;under the namespace to something else.  Any method name fails.
&gt;
&gt;setting debug_1 shows everything working okay, then
&gt;
&gt;# Loaded external class definition for &#39;DeSpam::DC::Service&#39;
&gt;&#40;and 3 other external class definition libs&#41;
&gt;
&gt;... and then the error when my test script tries to get the schema ...
&gt;
&gt;Cannot connect schema: &#39;Failed to reload class DeSpam::DC::Service:
&gt;Subroutine get_despam_service redefined at
&gt;/tmp/dbic4VsY/DeSpam/DC/Service.pm line 213.
&gt;
</div>
--
Sent from my Android phone with K-9 Mail. Please excuse my brevity.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;17&nbsp;23:09:24&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This just won&#39;t go away.

On Mon Aug 16 09:41:12 2010, RKITOVER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is that the full error message? The redefined message is just a
&gt; warning. Please attach a test app/schema.
</div>
That is the full error message, and it dies.

I have already attached a tarball of test script with files that you can
drop into the build directory for 0.07001.  

I just tried this:

1&#41; removed perl, perl yum packages and /usr/lib/perl5

2&#41; reinstalled perl yum package &#40;5.8.8-32.el5_5.1&#41;

3&#41; reinstalled all libs from CPAN

3&#41; updated every lib that came with yum that could be updated

Then I tried building from source package of 0.07001.  All of the test
worked, except the one that I wrote and uploaded to this bug report
earlier.  The result is the same.  Every time it gets the namespace
right and finds a file-defined package in t/lib with extra methods, it
issues the redefined subroutine method and then dies.

Thanks.  --mark--

hedges@vm1:~/src/DBIx-Class-Schema-Loader-0.07001$ prove -v
t/50addl_base_classes.t 
t/50addl_base_classes.t .. 
1..35
# DBIx::Class::Schema::Loader::Base says use_namespaces is the default
# In the first test run, then, Foo should be a
DBICTestMethods::Namespaces::Schema::Result::Foo
ok 1 - &#40;naming =&gt; &#39;current&#39;&#41; get schema
ok 2 - &#40;naming =&gt; &#39;current&#39;&#41; get a ResultSet for Foo
ok 3 - &#40;naming =&gt; &#39;current&#39;&#41; get the first foo
ok 4 - &#40;naming =&gt; &#39;current&#39;&#41; $foo is defined
# foo&#39;s class is DBICTestMethods::Namespaces::Schema::Foo
not ok 5 - &#40;naming =&gt; &#39;current&#39;&#41; $foo is a
DBICTestMethods::Namespaces::Schema::Result::Foo

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;&#41; $foo is a
DBICTestMethods::Namespaces::Schema::Result::Foo&#39;
#   at t/50addl_base_classes.t line 104.
not ok 6 - &#40;naming =&gt; &#39;current&#39;&#41; call the file-defined Foo-&gt;biz method

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;&#41; call the file-defined Foo-&gt;biz
method&#39;
#   at t/50addl_base_classes.t line 110.
# died: Can&#39;t locate object method &#34;biz&#34; via package
&#34;DBICTestMethods::Namespaces::Schema::Foo&#34; at t/50addl_base_classes.t
line 109.
ok 7 # skip no point in checking value if method was not found
# In the second test run with use_namespaces =&gt; 0 &#40;backcompat&#41;, Foo
should be a DBICTestMethods::Backcompat::Schema
not ok 8 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; get schema

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; get schema&#39;
#   at t/50addl_base_classes.t line 79.
# died: Failed to reload class DBICTestMethods::Backcompat::Schema::Foo:
Subroutine biz redefined at
/tmp/dbicyGEp/DBICTestMethods/Backcompat/Schema/Foo.pm line 90.
# Compilation failed in require at &#40;eval 374&#41; line 1.
ok 9 # skip no point in checking if schema could not be connected
ok 10 # skip no point in checking if schema could not be connected
ok 11 # skip no point in checking if schema could not be connected
ok 12 # skip no point in checking if schema could not be connected
ok 13 # skip no point in checking if schema could not be connected
ok 14 # skip no point in checking if schema could not be connected
# In the third test, with use_namespaces =&gt; 1, Foo gets the explicit
Result class again
not ok 15 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; get schema

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; get schema&#39;
#   at t/50addl_base_classes.t line 79.
# died: Failed to reload class
DBICTestMethods::Namespaces::Schema::Result::Foo: Subroutine biz
redefined at
/tmp/dbicugSd/DBICTestMethods/Namespaces/Schema/Result/Foo.pm line 90.
# Compilation failed in require at &#40;eval 395&#41; line 1.
ok 16 # skip no point in checking if schema could not be connected
ok 17 # skip no point in checking if schema could not be connected
ok 18 # skip no point in checking if schema could not be connected
ok 19 # skip no point in checking if schema could not be connected
ok 20 # skip no point in checking if schema could not be connected
ok 21 # skip no point in checking if schema could not be connected
# try it in full backcompat 0.04006 mode with no schema options

Dynamic schema detected, will run in 0.04006 mode.

Set the &#39;naming&#39; attribute or the SCHEMA_LOADER_BACKCOMPAT environment
variable
to disable this warning.

Also consider setting &#39;use_namespaces =&gt; 1&#39; if/when upgrading.

See perldoc DBIx::Class::Schema::Loader::Manual::UpgradingFromV4 for more
details.
not ok 22 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get schema

#   Failed test &#39;&#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get
schema&#39;
#   at t/50addl_base_classes.t line 79.
# died: Failed to reload class DBICTestMethods::Backcompat::Schema::Foo:
Subroutine biz redefined at
/tmp/dbicY8Kk/DBICTestMethods/Backcompat/Schema/Foo.pm line 90.
# Compilation failed in require at &#40;eval 421&#41; line 1.
ok 23 # skip no point in checking if schema could not be connected
ok 24 # skip no point in checking if schema could not be connected
ok 25 # skip no point in checking if schema could not be connected
ok 26 # skip no point in checking if schema could not be connected
ok 27 # skip no point in checking if schema could not be connected
ok 28 # skip no point in checking if schema could not be connected
# try it in backcompat mode &#40;no naming option&#41; but with use_namespaces =&gt; 1

Dynamic schema detected, will run in 0.04006 mode.

Set the &#39;naming&#39; attribute or the SCHEMA_LOADER_BACKCOMPAT environment
variable
to disable this warning.

Also consider setting &#39;use_namespaces =&gt; 1&#39; if/when upgrading.

See perldoc DBIx::Class::Schema::Loader::Manual::UpgradingFromV4 for more
details.
not ok 29 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get schema

#   Failed test &#39;&#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get
schema&#39;
#   at t/50addl_base_classes.t line 79.
# died: Failed to reload class
DBICTestMethods::Namespaces::Schema::Result::Foo: Subroutine biz
redefined at
/tmp/dbic2o0C/DBICTestMethods/Namespaces/Schema/Result/Foo.pm line 90.
# Compilation failed in require at &#40;eval 442&#41; line 1.
ok 30 # skip no point in checking if schema could not be connected
ok 31 # skip no point in checking if schema could not be connected
ok 32 # skip no point in checking if schema could not be connected
ok 33 # skip no point in checking if schema could not be connected
ok 34 # skip no point in checking if schema could not be connected
ok 35 # skip no point in checking if schema could not be connected
# Looks like you failed 6 tests of 35.
Dubious, test returned 6 &#40;wstat 1536, 0x600&#41;
Failed 6/35 subtests 
        &#40;less 25 skipped subtests: 4 okay&#41;

Test Summary Report
-------------------
t/50addl_base_classes.t &#40;Wstat: 1536 Tests: 35 Failed: 6&#41;
  Failed tests:  5-6, 8, 15, 22, 29
  Non-zero exit status: 6
Files=1, Tests=35,  1 wallclock secs &#40; 0.01 usr  0.04 sys +  0.62 cusr 
0.54 csys =  1.21 CPU&#41;
Result: FAIL
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;01:43:22&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> problems loading methods from file-defined classes + namespaces
 seem wrong</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Uhhhh....

The only thing I&#39;ve done between my last report and now was, I installed
Apache::Session 1.88 from source since it seems to stall out on an
uninitialized value warning when installed with CPAN.

Now I get the schema every time for each one of the test sequences in my
additional test &#40;./t/50addl_base_classes.t&#41;.  The only remaining
problems are the conflicts with the namespaces option which seems like
it is a separate issue.

Is this related to the time of day that I&#39;m running the test???  This is
silly.

prove -v ./t/50addl_base_classes.t
./t/50addl_base_classes.t .. 
1..35
# DBIx::Class::Schema::Loader::Base says use_namespaces is the default
# In the first test run, then, Foo should be a
DBICTestMethods::Namespaces::Schema::Result::Foo
ok 1 - &#40;naming =&gt; &#39;current&#39;&#41; get schema
ok 2 - &#40;naming =&gt; &#39;current&#39;&#41; get a ResultSet for Foo
ok 3 - &#40;naming =&gt; &#39;current&#39;&#41; get the first foo
ok 4 - &#40;naming =&gt; &#39;current&#39;&#41; $foo is defined
# foo&#39;s class is DBICTestMethods::Namespaces::Schema::Foo
not ok 5 - &#40;naming =&gt; &#39;current&#39;&#41; $foo is a
DBICTestMethods::Namespaces::Schema::Result::Foo

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;&#41; $foo is a
DBICTestMethods::Namespaces::Schema::Result::Foo&#39;
#   at ./t/50addl_base_classes.t line 104.
not ok 6 - &#40;naming =&gt; &#39;current&#39;&#41; call the file-defined Foo-&gt;biz method

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;&#41; call the file-defined Foo-&gt;biz
method&#39;
#   at ./t/50addl_base_classes.t line 110.
# died: Can&#39;t locate object method &#34;biz&#34; via package
&#34;DBICTestMethods::Namespaces::Schema::Foo&#34; at ./t/50addl_base_classes.t
line 109.
ok 7 # skip no point in checking value if method was not found
# In the second test run with use_namespaces =&gt; 0 &#40;backcompat&#41;, Foo
should be a DBICTestMethods::Backcompat::Schema
ok 8 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; get schema
ok 9 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; get a ResultSet for Foo
ok 10 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; get the first foo
ok 11 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; $foo is defined
# foo&#39;s class is DBICTestMethods::Backcompat::Schema::Foo
ok 12 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; $foo is a
DBICTestMethods::Backcompat::Schema::Foo
ok 13 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; call the file-defined
Foo-&gt;biz method
ok 14 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 0&#41; biz&#40;&#41; method returns
correct string
# In the third test, with use_namespaces =&gt; 1, Foo gets the explicit
Result class again
ok 15 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; get schema
ok 16 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; get a ResultSet for Foo
ok 17 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; get the first foo
ok 18 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; $foo is defined
# foo&#39;s class is DBICTestMethods::Namespaces::Schema::Foo
not ok 19 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; $foo is a
DBICTestMethods::Namespaces::Schema::Result::Foo

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; $foo is a
DBICTestMethods::Namespaces::Schema::Result::Foo&#39;
#   at ./t/50addl_base_classes.t line 104.
not ok 20 - &#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; call the
file-defined Foo-&gt;biz method

#   Failed test &#39;&#40;naming =&gt; &#39;current&#39;, use_namespaces =&gt; 1&#41; call the
file-defined Foo-&gt;biz method&#39;
#   at ./t/50addl_base_classes.t line 110.
# died: Can&#39;t locate object method &#34;biz&#34; via package
&#34;DBICTestMethods::Namespaces::Schema::Foo&#34; at ./t/50addl_base_classes.t
line 109.
ok 21 # skip no point in checking value if method was not found
# try it in full backcompat 0.04006 mode with no schema options
ok 22 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get schema
ok 23 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get a ResultSet
for Foo
ok 24 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get the first foo
ok 25 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; $foo is defined
# foo&#39;s class is DBICTestMethods::Backcompat::Schema::Foo
ok 26 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; $foo is a
DBICTestMethods::Backcompat::Schema::Foo
ok 27 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; call the
file-defined Foo-&gt;biz method
ok 28 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; biz&#40;&#41; method
returns correct string
# try it in backcompat mode &#40;no naming option&#41; but with use_namespaces =&gt; 1
ok 29 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get schema
ok 30 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get a ResultSet
for Foo
ok 31 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; get the first foo
ok 32 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; $foo is defined
# foo&#39;s class is DBICTestMethods::Namespaces::Schema::Foo
not ok 33 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; $foo is a
DBICTestMethods::Namespaces::Schema::Result::Foo

#   Failed test &#39;&#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; $foo
is a DBICTestMethods::Namespaces::Schema::Result::Foo&#39;
#   at ./t/50addl_base_classes.t line 104.
not ok 34 - &#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; call the
file-defined Foo-&gt;biz method

#   Failed test &#39;&#40;no naming or namespaces options &#40;0.04006 mode&#41;&#41; call
the file-defined Foo-&gt;biz method&#39;
#   at ./t/50addl_base_classes.t line 110.
# died: Can&#39;t locate object method &#34;biz&#34; via package
&#34;DBICTestMethods::Namespaces::Schema::Foo&#34; at ./t/50addl_base_classes.t
line 109.
ok 35 # skip no point in checking value if method was not found
# Looks like you failed 6 tests of 35.
Dubious, test returned 6 &#40;wstat 1536, 0x600&#41;
Failed 6/35 subtests 
        &#40;less 3 skipped subtests: 26 okay&#41;

Test Summary Report
-------------------
./t/50addl_base_classes.t &#40;Wstat: 1536 Tests: 35 Failed: 6&#41;
  Failed tests:  5-6, 19-20, 33-34
  Non-zero exit status: 6
Files=1, Tests=35,  1 wallclock secs &#40; 0.02 usr  0.03 sys +  0.31 cusr 
0.31 csys =  0.67 CPU&#41;
Result: FAIL
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;12:44:42&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> updated test files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> rkitover [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here&#39;s an updated tarball of test files and libs with corrected
description on one test.  

I do not understand why the error about redefined subroutines and is
gone now and I get the schema every time.  It doesn&#39;t seem like I
changed anything relevant between now and the last time it was broken.

However, there still seem to be some conflicts over whether to use the
default Result:: namespace if &#39;use_namespaces&#39; is specified or not, in
combination with different &#39;naming&#39; options.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> DBICTestMethods_files.tar</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;18&nbsp;13:06:03&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> AHA my test forgot to &#34;use blib&#34;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> rkitover [...] cpan.org</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">OH, I get it, I forgot to &#34;use blib&#34;, so the test &#40;using `prove -v`&#41; was
using the old libs that worked.  Sorry.

HERE is a tarball of files to drop into 0.07001 that demonstrate the
problem.  

Every time it gets the namespace correct and finds a file with
additional methods, getting the schema dies with an error like &#34;Failed
to reload class DBICTestMethods::Namespaces::Schema::Result::Foo:
Subroutine biz redefined at
/tmp/dbicVnFt/DBICTestMethods/Namespaces/Schema/Result/Foo.pm line 90.&#34;
 That is not just a warning.  It dies.

Mark
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> DBICTestMethods_files_usethis.tar</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;25&nbsp;22:10:39&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Subject changed from &#40;no value&#41; to &#39;cannot load additional methods from files + use_namespaces discrepencies&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;25&nbsp;22:10:40&nbsp;2010</span>
    <span class="description">MARKLE [...] cpan.org -  Severity Important added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;16&nbsp;04:14:12&nbsp;2011</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">fixed in git
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;16&nbsp;04:14:15&nbsp;2011</span>
    <span class="description">rkitover [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;01&nbsp;08:15:06&nbsp;2011</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed 0.07011
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;01&nbsp;08:15:09&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;01&nbsp;08:15:09&nbsp;2011</span>
    <span class="description">rkitover [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
