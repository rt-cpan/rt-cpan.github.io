<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #18536 for PAR: PAR, RPMs, ELF</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #18536 for PAR: PAR, RPMs, ELF</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/PAR/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/PAR/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/PAR/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/PAR/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/PAR">PAR CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">18536</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/PAR/Active/">PAR</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">smueller [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ggb [...] lanl.gov

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24530-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24531-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;04&nbsp;11:24:51&nbsp;2006</span>
    <span class="description">ggb [...] lanl.gov -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> PAR, RPMs, ELF</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 04 Apr 2006 09:24:23 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-par [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Giacomo G. Brussino&#34; &lt;ggb [...] lanl.gov&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">We have the following bug open with Red Hat:

When building rpms that contain packed perl files created with the PAR
perl module&#39;s pp command the packed perl files do not get a MD5 checksum
in the completed RPM package. This causes any attempt to install the
affected RPMs normally impossible. Included is a tarball containing the
RPM build tree for a perl program called &#34;helloworld&#34; packaged as a pp
that has no checksum in the finished RPM. This issue is reproduceable on
EL 3 and EL 4. Build tree is from EL 4, 32 bit x86. The missing checksum
on the rpm can be viewed with the &#34;rpm -qpilv --dump hw-0.1.i386.rpm&#34;
command.


The developers at Red Hat are asking the following question:

This really sounds like the root cause is poor ELF implementation within
PAR if prelink is not working correctly - can anyone confirm that the
ELF binaries are 100% spec compliant?


It would be nice if you could provide an answer.

The official PAR web site has been down for a few weeks already. The
current version of PAR is not installing correctly, and it&#39;s just hard
to get any information...

Thank you.
Giacomo G. Brussino
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;03&nbsp;08:36:25&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> smueller [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Di. 04. Apr. 2006, 11:24:51, ggb@lanl.gov wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; We have the following bug open with Red Hat:
&gt; 
&gt; When building rpms that contain packed perl files created with the PAR
&gt; perl module&#39;s pp command the packed perl files do not get a MD5 checksum
&gt; in the completed RPM package. This causes any attempt to install the
&gt; affected RPMs normally impossible. Included is a tarball containing the
&gt; RPM build tree for a perl program called &#34;helloworld&#34; packaged as a pp
&gt; that has no checksum in the finished RPM. This issue is reproduceable on
&gt; EL 3 and EL 4. Build tree is from EL 4, 32 bit x86. The missing checksum
&gt; on the rpm can be viewed with the &#34;rpm -qpilv --dump hw-0.1.i386.rpm&#34;
&gt; command.
&gt; 
&gt; 
&gt; The developers at Red Hat are asking the following question:
&gt; 
&gt; This really sounds like the root cause is poor ELF implementation within
&gt; PAR if prelink is not working correctly - can anyone confirm that the
&gt; ELF binaries are 100% spec compliant?
&gt; 
&gt; 
&gt; It would be nice if you could provide an answer.
&gt; 
&gt; The official PAR web site has been down for a few weeks already. The
&gt; current version of PAR is not installing correctly, and it&#39;s just hard
&gt; to get any information...
&gt; 
&gt; Thank you.
&gt; Giacomo G. Brussino
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;03&nbsp;08:36:25&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;03&nbsp;08:37:26&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> smueller [...] cpan.org</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">For reference: This issue was reraised at
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=19030">http://rt.cpan.org/Ticket/Display.html?id=19030</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;23&nbsp;17:45:56&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">There is a workaround that helps when building RPMs that contain
binaries created with PAR. You can find it in the FAQ on
<span class="clickylink"><a target="new" rel="nofollow" href="http://par.wikia.com">http://par.wikia.com</a></span> &#40;last entry as of this writing&#41;.

HTH,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;23&nbsp;17:45:57&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;23&nbsp;17:45:58&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Given to SMUELLER</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;19&nbsp;18:17:37&nbsp;2006</span>
    <span class="description">ggb [...] lanl.gov -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #18536] Resolved: PAR, RPMs, ELF</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 19 Jun 2006 16:16:48 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PAR [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Giacomo G. Brussino&#34; &lt;ggb [...] lanl.gov&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 2006-05-23 at 17:45 -0400, Steffen MÃ¼ller via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=18536">http://rt.cpan.org/Ticket/Display.html?id=18536</a></span> &gt;
&gt; 
&gt; According to our records, your request has been resolved. If you have any
&gt; further questions or concerns, please respond to this message.
</div>
Steffen:

        The suggested work-around works only for small test cases. It doe not
work with larger programs.

        Here&#39;s what I got from Red Hat:

We expect to be able to strip binaries for debuginfo - it looks as if
PAR does not work with that:

[pauln@enki hw-0.1]$ pp helloworld.pl
[pauln@enki hw-0.1]$ ./a.out
Hello World
[pauln@enki hw-0.1]$ strip a.out
[pauln@enki hw-0.1]$ ./a.out
Usage: ./a.out [ -Alib.par ] [ -Idir ] [ -Mmodule ] [ src.par ]
[ program.pl ]
     ./a.out [ -B|-b ] [-Ooutfile] src.par

If you do not want it stripped then do something like chmod the
executable in
the buildroot in %install, add the appropriate library requires manually
and
then use

%attr&#40;755,root,root&#41; /usr/local/bin/helloworld in %files
With regards to the prelink issue it really looks as if prelink and PAR
do not play nice together, so, you might want to add PAR binaries to be
blacklisted in /etc/prelink.conf in %post. 

This developer is also getting another developer to look at the binaries
to see if he can figure out what is happening.  A quick peek using
vimdiff makes it look like all the perl code gets stripped out.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;19&nbsp;18:17:39&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;17&nbsp;08:59:27&nbsp;2006</span>
    <span class="description">kbaxley [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kbaxley [...] redhat.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Some additional observations...

I decided to try and do some research on my own in order to try and gain
a better understanding of what&#39;s happening. In my un-educated opinion it
appears that pp doesn&#39;t really produce &#34;bogus&#34; ELF binaries, per se.  It
may be due to how pp puts together executables that causes such
headaches with RPM. 

I took a look at this report and:


<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=19030">http://rt.cpan.org/Public/Bug/Display.html?id=19030</a></span>

19030 seemed to point to some information that was similar in nature to
what our developer had said about RPM stripping executables during the
build process.  In 19030 there was mention that the pp executable file
is the combination of a genuine executable &#40;as produced by the linker&#41;
with additional items simply appended &#40;and _not_ registered as an ELF
section or something&#41;.  Those appened items apparently get dropped from
the output file when RPM runs strip during the build process.  In the
case here, it looks like a lot of the perl code gets discarded, thus
rendering the executable non-functional.  Could it be that the perl code
is simply appended to the executable?  

I also played around some with readelf...I, too, didn&#39;t see any problems
with readelf reading the file in /usr/local/bin/helloworld.

Running /usr/local/bin/helloworld after installing the rpm didn&#39;t work
whenever I tried to invoke it.

[kentb@dhcp59-156 ~]# /usr/local/bin/helloworld
Usage: /usr/local/bin/helloworld [ -Alib.par ] [ -Idir ] [ -Mmodule ] [
src.par ] [ program.pl ]
       /usr/local/bin/helloworld [ -B|-b ] [-Ooutfile] src.par



I also tried:

pp -o hw helloworld.pl

and running ./hw *did* work.

When I compared the two files &#40;/usr/local/bin/helloworld &#38; hw&#41; using
readelf, they were *exactly* the same...so my guess is that the ELF
binary itself isn&#39;t necessarily &#34;bogus&#34;.  My guess is that when we run
strip during the rpm build process whatever was attached to the pp
executable wasn&#39;t in the ELF header information and was tossed away?  I
don&#39;t really know if that constitutes bogus ELF vs. how pp packages
executables, but, again, this is a totally un-educated guess based on
what I&#39;ve been researching so far.  If I&#39;m missing anything please let
me know!  Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;17&nbsp;10:51:21&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

On Mo. 17. Jul. 2006, 08:59:27, kbaxley wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In 19030 there was mention that the pp executable file
&gt; is the combination of a genuine executable &#40;as produced by the linker&#41;
&gt; with additional items simply appended &#40;and _not_ registered as an ELF
&gt; section or something&#41;.  Those appened items apparently get dropped from
&gt; the output file when RPM runs strip during the build process.  In the
&gt; case here, it looks like a lot of the perl code gets discarded, thus
&gt; rendering the executable non-functional.  Could it be that the perl code
&gt; is simply appended to the executable?  
</div>
to my limited understanding, that is exactly what happens. It generates
a valid binary executable &#40;basically a perl&#41; and then appends a&#41; perl
code for PAR &#40;and Archive::Zip and such&#41; and b&#41; the zipped user code and
files.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Running /usr/local/bin/helloworld after installing the rpm didn&#39;t work
&gt; whenever I tried to invoke it.
&gt; 
&gt; [kentb@dhcp59-156 ~]# /usr/local/bin/helloworld
&gt; Usage: /usr/local/bin/helloworld [ -Alib.par ] [ -Idir ] [ -Mmodule ] [
&gt; src.par ] [ program.pl ]
&gt;        /usr/local/bin/helloworld [ -B|-b ] [-Ooutfile] src.par
</div>
IIRC, the pp-ed binary is a &#34;parl&#34; with a .par &#40;i.e. zip&#41; file
concatenated which uses that archive instead of a user specified one.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I also tried:
&gt; 
&gt; pp -o hw helloworld.pl
&gt; 
&gt; and running ./hw *did* work.
&gt; 
&gt; When I compared the two files &#40;/usr/local/bin/helloworld &#38; hw&#41; using
&gt; readelf, they were *exactly* the same...so my guess is that the ELF
&gt; binary itself isn&#39;t necessarily &#34;bogus&#34;.  My guess is that when we run
&gt; strip during the rpm build process whatever was attached to the pp
&gt; executable wasn&#39;t in the ELF header information and was tossed away?  I
&gt; don&#39;t really know if that constitutes bogus ELF vs. how pp packages
&gt; executables, but, again, this is a totally un-educated guess based on
&gt; what I&#39;ve been researching so far.  If I&#39;m missing anything please let
&gt; me know!  Thanks!
</div>
*Exactly* the same? As in bit-for-bit? I doubt that - or else they
should both work or both not work. I suppose they have the same
binary/executable component, but /usr/local/bin/helloworld lacks the
&#34;payload&#34; - the actual &#34;print qq&#40;Hello World\n&#41;;&#34; Perl code which was
stripped by rpm.

The solution to this problem might either be to
a&#41; teach pp to register the appended stuff as ELF whatever &#40;I have no
idea about Linux binary executable formats&#41;
b&#41; prevent rpm from stripping the executables.

I suppose b&#41; is easier and is also what Scott suggested in his reply to
#19030. Unfortunately, his suggestion does not seem to be the full solution.

I&#39;m sorry, but I can&#39;t help you any further with this. Fixing pp to
produce &#34;strip-safe&#34; binaries is way beyond my understanding of this.

If you find a solution one way or another, please, please let me know.

Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;21&nbsp;16:57:19&nbsp;2006</span>
    <span class="description">kbaxley [...] redhat.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> kbaxley [...] redhat.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Okay,

It appears that we found a solution that works.  It like the pp
executables are already stripped, so we don&#39;t want rpm stripping them
again, which, of course, renders them useless.

In this case, we added the following lines to the spec file to keep rpm
from running the strip process and not produce debuginfo packages:

%define __spec_install_post :
%define debug_package           %{nil}


Don&#39;t forget to add the &#34;:&#34; character to __spec_install_post as above or
this won&#39;t work

HTH












On Mon Jul 17 10:51:21 2006, SMUELLER wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; On Mo. 17. Jul. 2006, 08:59:27, kbaxley wrote:
<div class="message-stanza open">&gt; &gt; In 19030 there was mention that the pp executable file
&gt; &gt; is the combination of a genuine executable &#40;as produced by the linker&#41;
&gt; &gt; with additional items simply appended &#40;and _not_ registered as an ELF
&gt; &gt; section or something&#41;.  Those appened items apparently get dropped from
&gt; &gt; the output file when RPM runs strip during the build process.  In the
&gt; &gt; case here, it looks like a lot of the perl code gets discarded, thus
&gt; &gt; rendering the executable non-functional.  Could it be that the perl code
&gt; &gt; is simply appended to the executable?  
</div>&gt; 
&gt; to my limited understanding, that is exactly what happens. It generates
&gt; a valid binary executable &#40;basically a perl&#41; and then appends a&#41; perl
&gt; code for PAR &#40;and Archive::Zip and such&#41; and b&#41; the zipped user code and
&gt; files.
&gt; 
<div class="message-stanza open">&gt; &gt; Running /usr/local/bin/helloworld after installing the rpm didn&#39;t work
&gt; &gt; whenever I tried to invoke it.
&gt; &gt; 
&gt; &gt; [kentb@dhcp59-156 ~]# /usr/local/bin/helloworld
&gt; &gt; Usage: /usr/local/bin/helloworld [ -Alib.par ] [ -Idir ] [ -Mmodule ] [
&gt; &gt; src.par ] [ program.pl ]
&gt; &gt;        /usr/local/bin/helloworld [ -B|-b ] [-Ooutfile] src.par
</div>&gt; 
&gt; IIRC, the pp-ed binary is a &#34;parl&#34; with a .par &#40;i.e. zip&#41; file
&gt; concatenated which uses that archive instead of a user specified one.
&gt; 
<div class="message-stanza open">&gt; &gt; I also tried:
&gt; &gt; 
&gt; &gt; pp -o hw helloworld.pl
&gt; &gt; 
&gt; &gt; and running ./hw *did* work.
&gt; &gt; 
&gt; &gt; When I compared the two files &#40;/usr/local/bin/helloworld &#38; hw&#41; using
&gt; &gt; readelf, they were *exactly* the same...so my guess is that the ELF
&gt; &gt; binary itself isn&#39;t necessarily &#34;bogus&#34;.  My guess is that when we run
&gt; &gt; strip during the rpm build process whatever was attached to the pp
&gt; &gt; executable wasn&#39;t in the ELF header information and was tossed away?  I
&gt; &gt; don&#39;t really know if that constitutes bogus ELF vs. how pp packages
&gt; &gt; executables, but, again, this is a totally un-educated guess based on
&gt; &gt; what I&#39;ve been researching so far.  If I&#39;m missing anything please let
&gt; &gt; me know!  Thanks!
</div>&gt; 
&gt; *Exactly* the same? As in bit-for-bit? I doubt that - or else they
&gt; should both work or both not work. I suppose they have the same
&gt; binary/executable component, but /usr/local/bin/helloworld lacks the
&gt; &#34;payload&#34; - the actual &#34;print qq&#40;Hello World\n&#41;;&#34; Perl code which was
&gt; stripped by rpm.
&gt; 
&gt; The solution to this problem might either be to
&gt; a&#41; teach pp to register the appended stuff as ELF whatever &#40;I have no
&gt; idea about Linux binary executable formats&#41;
&gt; b&#41; prevent rpm from stripping the executables.
&gt; 
&gt; I suppose b&#41; is easier and is also what Scott suggested in his reply to
&gt; #19030. Unfortunately, his suggestion does not seem to be the full
</div>solution.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I&#39;m sorry, but I can&#39;t help you any further with this. Fixing pp to
&gt; produce &#34;strip-safe&#34; binaries is way beyond my understanding of this.
&gt; 
&gt; If you find a solution one way or another, please, please let me know.
&gt; 
&gt; Steffen
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;21&nbsp;18:10:04&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fr. 21. Jul. 2006, 16:57:19, kbaxley wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It appears that we found a solution that works.  It like the pp
&gt; executables are already stripped, so we don&#39;t want rpm stripping them
&gt; again, which, of course, renders them useless.
</div>[...]

Wow!

Thanks for figuring this out. As you might already know, the PAR core
developers aren&#39;t too familiar with RPMs, so it might have taken us a
long time otherwise.

I put the solution into the FAQ on the PAR homepage par.perl.org.

Thanks again,

Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;21&nbsp;18:10:06&nbsp;2006</span>
    <span class="description">smueller [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
