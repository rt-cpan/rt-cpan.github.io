<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #113726 for TimeDate: str2time parses incorrectly.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #113726 for TimeDate: str2time parses incorrectly.</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=TimeDate">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=TimeDate">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=TimeDate">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=TimeDate">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/TimeDate">TimeDate CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">113726</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=TimeDate">TimeDate</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
sebastianokur [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-33566-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-33567-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=113726">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1617060" href="/Public/Bug/Display.html?id=113726#txn-1617060">#</a>      
    </span>
    <span class="date">Tue&nbsp;Apr&nbsp;12&nbsp;20:43:54&nbsp;2016</span>
    <span class="description">sebastianokur [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> str2time parses incorrectly.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 12 Apr 2016 20:43:43 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-TimeDate [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sebastian Okur &lt;sebastianokur [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1617060/865687/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/865687">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 864b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

As much as I can see from the documentation, there is no information
regarding to inability to parse &#34;YYYY-MM-DD hh:mm:ss.SSS&#34; format. Also, I
noticed it is mentioned that the str2time function should return undef if
it doesn&#39;t support string for parsing.

Below is the code and its output:

*===*
#!/usr/bin/perl

use strict;
use warnings;
use Date::Parse;

my $date1_str = &#34;2016-01-28 23:27:13,995&#34;;
my $date1_epoch = str2time&#40;$date1_str&#41;;
print &#34;date1_epoch: [$date1_epoch]\n&#34;;

my $date2_str = &#34;2016-01-28 23:27:13,996&#34;;
my $date2_epoch = str2time&#40;$date2_str&#41;;
print &#34;date2_epoch: [$date2_epoch]\n&#34;;

# OUTPUT:
#
# date1_epoch: [1453985533]
# date2_epoch: [1453985473]
*===*

Notice that *date2_epoch* is earlier than *date1_epoch*, and â€“if anythingâ€“
epoch values should be the same.

Thanks for your time and assistance in advance,

--Sebastian Okur
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1617060/865688/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/865688">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1617145" href="/Public/Bug/Display.html?id=113726#txn-1617145">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;13&nbsp;02:45:19&nbsp;2016</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1617145/865728/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/865728">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2016-04-12 20:43:54, sebastianokur@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi,
&gt; 
&gt; As much as I can see from the documentation, there is no information
&gt; regarding to inability to parse &#34;YYYY-MM-DD hh:mm:ss.SSS&#34; format. Also, I
&gt; noticed it is mentioned that the str2time function should return undef if
&gt; it doesn&#39;t support string for parsing.
&gt; 
&gt; Below is the code and its output:
&gt; 
&gt; *===*
&gt; #!/usr/bin/perl
&gt; 
&gt; use strict;
&gt; use warnings;
&gt; use Date::Parse;
&gt; 
&gt; my $date1_str = &#34;2016-01-28 23:27:13,995&#34;;
&gt; my $date1_epoch = str2time&#40;$date1_str&#41;;
&gt; print &#34;date1_epoch: [$date1_epoch]\n&#34;;
&gt; 
&gt; my $date2_str = &#34;2016-01-28 23:27:13,996&#34;;
&gt; my $date2_epoch = str2time&#40;$date2_str&#41;;
&gt; print &#34;date2_epoch: [$date2_epoch]\n&#34;;
&gt; 
&gt; # OUTPUT:
&gt; #
&gt; # date1_epoch: [1453985533]
&gt; # date2_epoch: [1453985473]
&gt; *===*
&gt; 
&gt; Notice that *date2_epoch* is earlier than *date1_epoch*, and â€“if anythingâ€“
&gt; epoch values should be the same.
&gt; 
&gt; Thanks for your time and assistance in advance,
&gt; 
&gt; --Sebastian Okur
</div>
Actually, if the comma in the test script is replaced with a dot, then things work fine. I wouldn&#39;t expect that Date::Parse should parse the comma as a decimal dot.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1617146" href="/Public/Bug/Display.html?id=113726#txn-1617146">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;13&nbsp;02:45:20&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1617288" href="/Public/Bug/Display.html?id=113726#txn-1617288">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;13&nbsp;11:18:05&nbsp;2016</span>
    <span class="description">sebastianokur [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113726] str2time parses incorrectly.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 13 Apr 2016 11:17:49 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-TimeDate [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sebastian Okur &lt;sebastianokur [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1617288/865818/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/865818">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the heads up. I already found that out and fixed my code to
accommodate it.

I guess the point I was trying to make is that *str2time* function silently
fails by producing unpredictable results instead of failing hard by
returning *undef* for input formats that are not supported or not entirely
correct in its form.

Since epoch values are scalars that are not as easily distinguishable as
other-more readable date formats &#40;*1454023633995* VS *2016-01-28
23:27:13,995*&#41;, especially when the first couple of digits are correct, it
is not immediately obvious to the developer that the result is wrong.

It would be very helpful if functions fail hard in a conspicuous fashion
when they fail.


On Wed, Apr 13, 2016 at 2:45 AM, Slaven_Rezic via RT &lt;
bug-TimeDate@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113726">https://rt.cpan.org/Ticket/Display.html?id=113726</a></span> &gt;
&gt;
&gt; On 2016-04-12 20:43:54, sebastianokur@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; As much as I can see from the documentation, there is no information
&gt; &gt; regarding to inability to parse &#34;YYYY-MM-DD hh:mm:ss.SSS&#34; format. Also, I
&gt; &gt; noticed it is mentioned that the str2time function should return undef if
&gt; &gt; it doesn&#39;t support string for parsing.
&gt; &gt;
&gt; &gt; Below is the code and its output:
&gt; &gt;
&gt; &gt; *===*
&gt; &gt; #!/usr/bin/perl
&gt; &gt;
&gt; &gt; use strict;
&gt; &gt; use warnings;
&gt; &gt; use Date::Parse;
&gt; &gt;
&gt; &gt; my $date1_str = &#34;2016-01-28 23:27:13,995&#34;;
&gt; &gt; my $date1_epoch = str2time&#40;$date1_str&#41;;
&gt; &gt; print &#34;date1_epoch: [$date1_epoch]\n&#34;;
&gt; &gt;
&gt; &gt; my $date2_str = &#34;2016-01-28 23:27:13,996&#34;;
&gt; &gt; my $date2_epoch = str2time&#40;$date2_str&#41;;
&gt; &gt; print &#34;date2_epoch: [$date2_epoch]\n&#34;;
&gt; &gt;
&gt; &gt; # OUTPUT:
&gt; &gt; #
&gt; &gt; # date1_epoch: [1453985533]
&gt; &gt; # date2_epoch: [1453985473]
&gt; &gt; *===*
&gt; &gt;
&gt; &gt; Notice that *date2_epoch* is earlier than *date1_epoch*, and â€“if
</div>&gt; anythingâ€“
<div class="message-stanza open">&gt; &gt; epoch values should be the same.
&gt; &gt;
&gt; &gt; Thanks for your time and assistance in advance,
&gt; &gt;
&gt; &gt; --Sebastian Okur
</div>&gt;
&gt; Actually, if the comma in the test script is replaced with a dot, then
&gt; things work fine. I wouldn&#39;t expect that Date::Parse should parse the comma
&gt; as a decimal dot.
&gt;
&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1617288/865819/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/865819">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1617857" href="/Public/Bug/Display.html?id=113726#txn-1617857">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;14&nbsp;14:42:44&nbsp;2016</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1617857/866187/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/866187">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I did some debugging what&#39;s going on here. An early transformation replaces all commas into spaces, so we get something like &#34;2016-01-28 23:27:13 995&#34;. If the bit behind the seconds looks vaguely like a timezone specification, then it seems that it&#39;s used as one. In this case this means an offset of 9 hours and 95 minutes, which is causing the difference.

Probably everything &gt;= 60 minutes could generate an error here.

It would probably also be good to improve the comma replacement, maybe don&#39;t do it all over the place.

On 2016-04-13 11:18:05, sebastianokur@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for the heads up. I already found that out and fixed my code to
&gt; accommodate it.
&gt; 
&gt; I guess the point I was trying to make is that *str2time* function
&gt; silently
&gt; fails by producing unpredictable results instead of failing hard by
&gt; returning *undef* for input formats that are not supported or not
&gt; entirely
&gt; correct in its form.
&gt; 
&gt; Since epoch values are scalars that are not as easily distinguishable
&gt; as
&gt; other-more readable date formats &#40;*1454023633995* VS *2016-01-28
&gt; 23:27:13,995*&#41;, especially when the first couple of digits are
&gt; correct, it
&gt; is not immediately obvious to the developer that the result is wrong.
&gt; 
&gt; It would be very helpful if functions fail hard in a conspicuous
&gt; fashion
&gt; when they fail.
&gt; 
&gt; 
&gt; On Wed, Apr 13, 2016 at 2:45 AM, Slaven_Rezic via RT &lt;
&gt; bug-TimeDate@rt.cpan.org&gt; wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113726">https://rt.cpan.org/Ticket/Display.html?id=113726</a></span> &gt;
&gt; &gt;
&gt; &gt; On 2016-04-12 20:43:54, sebastianokur@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; Hi,
&gt; &gt; &gt;
&gt; &gt; &gt; As much as I can see from the documentation, there is no
&gt; &gt; &gt; information
&gt; &gt; &gt; regarding to inability to parse &#34;YYYY-MM-DD hh:mm:ss.SSS&#34; format.
&gt; &gt; &gt; Also, I
&gt; &gt; &gt; noticed it is mentioned that the str2time function should return
&gt; &gt; &gt; undef if
&gt; &gt; &gt; it doesn&#39;t support string for parsing.
&gt; &gt; &gt;
&gt; &gt; &gt; Below is the code and its output:
&gt; &gt; &gt;
&gt; &gt; &gt; *===*
&gt; &gt; &gt; #!/usr/bin/perl
&gt; &gt; &gt;
&gt; &gt; &gt; use strict;
&gt; &gt; &gt; use warnings;
&gt; &gt; &gt; use Date::Parse;
&gt; &gt; &gt;
&gt; &gt; &gt; my $date1_str = &#34;2016-01-28 23:27:13,995&#34;;
&gt; &gt; &gt; my $date1_epoch = str2time&#40;$date1_str&#41;;
&gt; &gt; &gt; print &#34;date1_epoch: [$date1_epoch]\n&#34;;
&gt; &gt; &gt;
&gt; &gt; &gt; my $date2_str = &#34;2016-01-28 23:27:13,996&#34;;
&gt; &gt; &gt; my $date2_epoch = str2time&#40;$date2_str&#41;;
&gt; &gt; &gt; print &#34;date2_epoch: [$date2_epoch]\n&#34;;
&gt; &gt; &gt;
&gt; &gt; &gt; # OUTPUT:
&gt; &gt; &gt; #
&gt; &gt; &gt; # date1_epoch: [1453985533]
&gt; &gt; &gt; # date2_epoch: [1453985473]
&gt; &gt; &gt; *===*
&gt; &gt; &gt;
&gt; &gt; &gt; Notice that *date2_epoch* is earlier than *date1_epoch*, and â€“if
</div>&gt; &gt; anythingâ€“
<div class="message-stanza open">&gt; &gt; &gt; epoch values should be the same.
&gt; &gt; &gt;
&gt; &gt; &gt; Thanks for your time and assistance in advance,
&gt; &gt; &gt;
&gt; &gt; &gt; --Sebastian Okur
</div>&gt; &gt;
&gt; &gt; Actually, if the comma in the test script is replaced with a dot,
&gt; &gt; then
&gt; &gt; things work fine. I wouldn&#39;t expect that Date::Parse should parse the
&gt; &gt; comma
&gt; &gt; as a decimal dot.
&gt; &gt;
&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1617901" href="/Public/Bug/Display.html?id=113726#txn-1617901">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;14&nbsp;20:48:08&nbsp;2016</span>
    <span class="description">sebastianokur [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113726] str2time parses incorrectly.</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 14 Apr 2016 20:47:57 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-TimeDate [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Sebastian Okur &lt;sebastianokur [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1617901/866201/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/866201">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">It might be better to match the regex based on supported formats and overload the missing time items &#40;milliseconds, time, etc&#41; with default values.

Main things is not making the program intelligent in order to make it try and assume what the caller is trying to do.

More importantly, making the program fail hard if an input doesn&#39;t match any of the supported formats, completely.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Apr 14, 2016, at 2:42 PM, Slaven_Rezic via RT &lt;bug-TimeDate@rt.cpan.org&gt; wrote:
&gt; 
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113726">https://rt.cpan.org/Ticket/Display.html?id=113726</a></span> &gt;
&gt; 
&gt; I did some debugging what&#39;s going on here. An early transformation replaces all commas into spaces, so we get something like &#34;2016-01-28 23:27:13 995&#34;. If the bit behind the seconds looks vaguely like a timezone specification, then it seems that it&#39;s used as one. In this case this means an offset of 9 hours and 95 minutes, which is causing the difference.
&gt; 
&gt; Probably everything &gt;= 60 minutes could generate an error here.
&gt; 
&gt; It would probably also be good to improve the comma replacement, maybe don&#39;t do it all over the place.
&gt; 
<div class="message-stanza open">&gt;&gt; On 2016-04-13 11:18:05, sebastianokur@gmail.com wrote:
&gt;&gt; Thanks for the heads up. I already found that out and fixed my code to
&gt;&gt; accommodate it.
&gt;&gt; 
&gt;&gt; I guess the point I was trying to make is that *str2time* function
&gt;&gt; silently
&gt;&gt; fails by producing unpredictable results instead of failing hard by
&gt;&gt; returning *undef* for input formats that are not supported or not
&gt;&gt; entirely
&gt;&gt; correct in its form.
&gt;&gt; 
&gt;&gt; Since epoch values are scalars that are not as easily distinguishable
&gt;&gt; as
&gt;&gt; other-more readable date formats &#40;*1454023633995* VS *2016-01-28
&gt;&gt; 23:27:13,995*&#41;, especially when the first couple of digits are
&gt;&gt; correct, it
&gt;&gt; is not immediately obvious to the developer that the result is wrong.
&gt;&gt; 
&gt;&gt; It would be very helpful if functions fail hard in a conspicuous
&gt;&gt; fashion
&gt;&gt; when they fail.
&gt;&gt; 
&gt;&gt; 
&gt;&gt; On Wed, Apr 13, 2016 at 2:45 AM, Slaven_Rezic via RT &lt;
&gt;&gt; bug-TimeDate@rt.cpan.org&gt; wrote:
&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113726">https://rt.cpan.org/Ticket/Display.html?id=113726</a></span> &gt;
&gt;&gt;&gt; 
<div class="message-stanza open">&gt;&gt;&gt;&gt; On 2016-04-12 20:43:54, sebastianokur@gmail.com wrote:
&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; As much as I can see from the documentation, there is no
&gt;&gt;&gt;&gt; information
&gt;&gt;&gt;&gt; regarding to inability to parse &#34;YYYY-MM-DD hh:mm:ss.SSS&#34; format.
&gt;&gt;&gt;&gt; Also, I
&gt;&gt;&gt;&gt; noticed it is mentioned that the str2time function should return
&gt;&gt;&gt;&gt; undef if
&gt;&gt;&gt;&gt; it doesn&#39;t support string for parsing.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Below is the code and its output:
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; *===*
&gt;&gt;&gt;&gt; #!/usr/bin/perl
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; use strict;
&gt;&gt;&gt;&gt; use warnings;
&gt;&gt;&gt;&gt; use Date::Parse;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; my $date1_str = &#34;2016-01-28 23:27:13,995&#34;;
&gt;&gt;&gt;&gt; my $date1_epoch = str2time&#40;$date1_str&#41;;
&gt;&gt;&gt;&gt; print &#34;date1_epoch: [$date1_epoch]\n&#34;;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; my $date2_str = &#34;2016-01-28 23:27:13,996&#34;;
&gt;&gt;&gt;&gt; my $date2_epoch = str2time&#40;$date2_str&#41;;
&gt;&gt;&gt;&gt; print &#34;date2_epoch: [$date2_epoch]\n&#34;;
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; # OUTPUT:
&gt;&gt;&gt;&gt; #
&gt;&gt;&gt;&gt; # date1_epoch: [1453985533]
&gt;&gt;&gt;&gt; # date2_epoch: [1453985473]
&gt;&gt;&gt;&gt; *===*
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Notice that *date2_epoch* is earlier than *date1_epoch*, and â€“if
</div>&gt;&gt;&gt; anythingâ€“
<div class="message-stanza open">&gt;&gt;&gt;&gt; epoch values should be the same.
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; Thanks for your time and assistance in advance,
&gt;&gt;&gt;&gt; 
&gt;&gt;&gt;&gt; --Sebastian Okur
</div>&gt;&gt;&gt; 
&gt;&gt;&gt; Actually, if the comma in the test script is replaced with a dot,
&gt;&gt;&gt; then
&gt;&gt;&gt; things work fine. I wouldn&#39;t expect that Date::Parse should parse the
&gt;&gt;&gt; comma
&gt;&gt;&gt; as a decimal dot.
</div></div>&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1879621" href="/Public/Bug/Display.html?id=113726#txn-1879621">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;15&nbsp;16:27:53&nbsp;2020</span>
    <span class="description">me [...] eboxr.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1879621/1008650/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/1008650">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 79b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ticket migrated to github as <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/atoomic/perl-TimeDate/issues/35">https://github.com/atoomic/perl-TimeDate/issues/35</a></span>
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.441864</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
