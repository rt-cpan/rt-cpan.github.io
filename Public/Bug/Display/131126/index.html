<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #131126 for USB-Descriptor: Bug in max_current value</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #131126 for USB-Descriptor: Bug in max_current value</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/USB-Descriptor/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/USB-Descriptor/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/USB-Descriptor/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/USB-Descriptor/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/USB-Descriptor">USB-Descriptor CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">131126</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/USB-Descriptor/Active/">USB-Descriptor</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Chris.Williams2 [...] exsel-group.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-240688-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-240689-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;02&nbsp;08:55:31&nbsp;2019</span>
    <span class="description">Chris.Williams2 [...] exsel-group.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug in max_current value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Dec 2019 13:55:22 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-USB-Descriptor [...] rt.cpan.org&#34; &lt;bug-USB-Descriptor [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chris Williams &lt;Chris.Williams2 [...] exsel-group.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I have started using the usb descriptor software, and it looks really useful.

Checking some of the values suggests that the max_current setting wraps at 128. If I set 500mA, it returns a value of 0x7A.

This is revision 4 running on a Linux system.

Regards,

Chris.



Chris Williams
Electronics Engineer
Exsel Electronics Limited | 4 Ravenscroft Court | Buttington Cross | Welshpool | Powys | SY21 8SL
T: +44 1684 579 000 Ext. *411 | E: Chris.Williams@exsel-group.com | W: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.exsel-group.com">http://www.exsel-group.com</a></span> This e-mail is UNCLASSIFIED and only for the use of its intended recipient. Its contents are confidential and may be privileged. Exsel Electronics Limited does not guarantee that this e-mail has not been intercepted and amended or that it is virus-free. This e-mail is for the intended addressee only. If you have received it in error, then you must not use, retain, disseminate or otherwise deal with it and you should notify the sender by return e-mail. This email is from Exsel Electronics Limited. Registered in Wales at 4 Ravenscroft Court, Buttington Cross, Welshpool, Powys, SY21 8SL Reg No: 11085251
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;07&nbsp;22:14:49&nbsp;2019</span>
    <span class="description">bfoz [...] bfoz.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #131126] Bug in max_current value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 7 Dec 2019 19:13:36 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-USB-Descriptor [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Brandon Fosdick &lt;bfoz [...] bfoz.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Chris,

I haven’t looked at this project in a very long time, so my memory may be fuzzy. Are you setting max_current to 500 and then seeing that attribute equals 0x7A, or are you seeing the 0x7A in the bytes&#40;&#41; output?

I’m pretty sure the relevant field in the USB descriptors is only a single byte, and is in units of 2mA. So setting max_current to 500 should yield a value of 0xFA in bytes&#40;&#41;. If you’re really getting 0x7A, then that is a problem and I’ll have to look into it. Thanks for the bug report.

-Brandon


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Dec 2, 2019, at 05:55 , Chris Williams via RT &lt;bug-USB-Descriptor@rt.cpan.org&gt; wrote:
&gt; 
&gt; Mon Dec 02 08:55:31 2019: Request 131126 was acted upon.
&gt; Transaction: Ticket created by Chris.Williams2@exsel-group.com
&gt;       Queue: USB-Descriptor
&gt;     Subject: Bug in max_current value
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: &#40;no value&#41;
&gt;       Owner: Nobody
&gt;  Requestors: Chris.Williams2@exsel-group.com
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131126">https://rt.cpan.org/Ticket/Display.html?id=131126</a></span> &gt;
&gt; 
&gt; 
&gt; Hi,
&gt; 
&gt; I have started using the usb descriptor software, and it looks really useful.
&gt; 
&gt; Checking some of the values suggests that the max_current setting wraps at 128. If I set 500mA, it returns a value of 0x7A.
&gt; 
&gt; This is revision 4 running on a Linux system.
&gt; 
&gt; Regards,
&gt; 
&gt; Chris.
&gt; 
&gt; 
&gt; 
&gt; Chris Williams
&gt; Electronics Engineer
&gt; Exsel Electronics Limited | 4 Ravenscroft Court | Buttington Cross | Welshpool | Powys | SY21 8SL
&gt; T: +44 1684 579 000 Ext. *411 | E: Chris.Williams@exsel-group.com | W: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.exsel-group.com">http://www.exsel-group.com</a></span> This e-mail is UNCLASSIFIED and only for the use of its intended recipient. Its contents are confidential and may be privileged. Exsel Electronics Limited does not guarantee that this e-mail has not been intercepted and amended or that it is virus-free. This e-mail is for the intended addressee only. If you have received it in error, then you must not use, retain, disseminate or otherwise deal with it and you should notify the sender by return e-mail. This email is from Exsel Electronics Limited. Registered in Wales at 4 Ravenscroft Court, Buttington Cross, Welshpool, Powys, SY21 8SL Reg No: 11085251
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Dec&nbsp;07&nbsp;22:14:50&nbsp;2019</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;09&nbsp;04:24:51&nbsp;2019</span>
    <span class="description">Chris.Williams2 [...] exsel-group.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #131126] Bug in max_current value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 9 Dec 2019 09:24:42 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-USB-Descriptor [...] rt.cpan.org&#34; &lt;bug-USB-Descriptor [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Chris Williams &lt;Chris.Williams2 [...] exsel-group.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Brandon,

Thanks for the reply. Very nice bit of software that I would like to use as the basis for my USB design.

I tried a few examples and found what I think is the bug described. I actually pasted the result into an online checker, and that’s when I  saw the problem. I am expecting a 500mA current draw so I changed the entry and that&#39;s when the trouble started! As you say, the result is a single byte and should give the result 0xFA not 0x7A. 

Looking at the code I can see the calculation looks correct, but I am not a perl programmer and I could not see how to correct the problem?

It could be something I am doing wrong, but any help would be gratefully received.

Regards,

Chris. 

Chris Williams 
Electronics Engineer
Exsel Electronics Limited | 4 Ravenscroft Court | Buttington Cross | Welshpool | Powys | SY21 8SL
T: +44 1684 579 000 Ext. *411 | E: Chris.Williams@exsel-group.com | W: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.exsel-group.com">http://www.exsel-group.com</a></span> This e-mail is UNCLASSIFIED and only for the use of its intended recipient. Its contents are confidential and may be privileged. Exsel Electronics Limited does not guarantee that this e-mail has not been intercepted and amended or that it is virus-free. This e-mail is for the intended addressee only. If you have received it in error, then you must not use, retain, disseminate or otherwise deal with it and you should notify the sender by return e-mail. This email is from Exsel Electronics Limited. Registered in Wales at 4 Ravenscroft Court, Buttington Cross, Welshpool, Powys, SY21 8SL Reg No: 11085251

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: bfoz@bfoz.net via RT &lt;bug-USB-Descriptor@rt.cpan.org&gt; 
Sent: 08 December 2019 03:15
To: Chris Williams &lt;Chris.Williams2@exsel-group.com&gt;
Subject: Re: [rt.cpan.org #131126] Bug in max_current value

&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131126">https://rt.cpan.org/Ticket/Display.html?id=131126</a></span> &gt;

Hi Chris,

I haven’t looked at this project in a very long time, so my memory may be fuzzy. Are you setting max_current to 500 and then seeing that attribute equals 0x7A, or are you seeing the 0x7A in the bytes&#40;&#41; output?

I’m pretty sure the relevant field in the USB descriptors is only a single byte, and is in units of 2mA. So setting max_current to 500 should yield a value of 0xFA in bytes&#40;&#41;. If you’re really getting 0x7A, then that is a problem and I’ll have to look into it. Thanks for the bug report.

-Brandon


<div class="message-stanza open">&gt; On Dec 2, 2019, at 05:55 , Chris Williams via RT &lt;bug-USB-Descriptor@rt.cpan.org&gt; wrote:
&gt; 
&gt; Mon Dec 02 08:55:31 2019: Request 131126 was acted upon.
&gt; Transaction: Ticket created by Chris.Williams2@exsel-group.com
&gt;       Queue: USB-Descriptor
&gt;     Subject: Bug in max_current value
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: &#40;no value&#41;
&gt;       Owner: Nobody
&gt;  Requestors: Chris.Williams2@exsel-group.com
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=131126">https://rt.cpan.org/Ticket/Display.html?id=131126</a></span> &gt;
&gt; 
&gt; 
&gt; Hi,
&gt; 
&gt; I have started using the usb descriptor software, and it looks really useful.
&gt; 
&gt; Checking some of the values suggests that the max_current setting wraps at 128. If I set 500mA, it returns a value of 0x7A.
&gt; 
&gt; This is revision 4 running on a Linux system.
&gt; 
&gt; Regards,
&gt; 
&gt; Chris.
&gt; 
&gt; 
&gt; 
&gt; Chris Williams
&gt; Electronics Engineer
&gt; Exsel Electronics Limited | 4 Ravenscroft Court | Buttington Cross | Welshpool | Powys | SY21 8SL
&gt; T: +44 1684 579 000 Ext. *411 | E: Chris.Williams@exsel-group.com | W: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.exsel-group.com">http://www.exsel-group.com</a></span> This e-mail is UNCLASSIFIED and only for the use of its intended recipient. Its contents are confidential and may be privileged. Exsel Electronics Limited does not guarantee that this e-mail has not been intercepted and amended or that it is virus-free. This e-mail is for the intended addressee only. If you have received it in error, then you must not use, retain, disseminate or otherwise deal with it and you should notify the sender by return e-mail. This email is from Exsel Electronics Limited. Registered in Wales at 4 Ravenscroft Court, Buttington Cross, Welshpool, Powys, SY21 8SL Reg No: 11085251
&gt; 
&gt; 
</div>
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
