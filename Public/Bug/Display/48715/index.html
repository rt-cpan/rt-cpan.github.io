<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #48715 for POE: POE::Wheel::Run/Tk/MSWin32 Problem</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #48715 for POE: POE::Wheel::Run/Tk/MSWin32 Problem</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/POE/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/POE/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/POE/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/POE/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/POE">POE CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">48715</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/POE/Active/">POE</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
craig [...] alcatel-lucent.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-26342-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.006    </td>
  </tr>
  <tr id="CF-26343-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;14&nbsp;11:16:31&nbsp;2009</span>
    <span class="description">craig [...] alcatel-lucent.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> POE::Wheel::Run/Tk/MSWin32 Problem</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This issue was discussed at <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/?node_id=787371">http://www.perlmonks.org/?node_id=787371</a></span>

The attached program works under both Unix and windows as expected.

To make it work under windows &#40;ActiveState perl&#41;, I had to run the command &#34;dir &#38; pause&#34;, 
otherwise the Tk window will go away &#40;I want it to stick around until the user deletes it&#41;.

It should have worked by just running the &#34;dir&#34; command, because I put in &#34;postback&#40;&#39;DontDie&#39;&#41;&#34; 
to prevent the Tk window from being shut down. Using POE::Wheel::Run::Win32 doesn&#39;t seem to 
help, as it burps up an &#34;ERR: Free to wrong pool&#34; message.

After some discussion, Rocco asked me to submit this bug report.

-Craig
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> tst00.pl</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
use English;
use strict;
use warnings;

use Tk;
use POE;
use POE::Wheel::Run;

# Setup program to run...
my $PGM = &#39;ls&#39;;
if &#40;$OSNAME eq &#39;MSWin32&#39;&#41; { $PGM = &#39;dir &#38; pause&#39; };
#if &#40;$OSNAME eq &#39;MSWin32&#39;&#41; { $PGM = &#39;dir&#39; };  # This doesn&#39;t work!
print STDERR &#34;$OSNAME PGM=$PGM\n&#34;;

my $TEXT;        # Global for text widget...

# Setup POE session...
my $session = _poeSetup&#40;&#41;;

# Create dummy postback so the session won&#39;t die once input is done...
my $subref = $session-&gt;postback&#40;&#39;DontDie&#39;&#41;;

# Go...
$poe_kernel-&gt;run&#40;&#41;;

#################
# POE Subroutines
#################
sub _poeSetup {
    my $session = POE::Session-&gt;create&#40;
        inline_states=&gt;{
            _start =&gt; \&#38;_startUp,
            KidOut =&gt; \&#38;_GetStdout,
            KidErr =&gt; \&#38;_GetStderr,
            KidClose =&gt; \&#38;_DoClose,
        },
    &#41;;
    return&#40;$session&#41;;
}

# POE Session Supporting Routines...
sub _startUp {
    $TEXT=$poe_main_window-&gt;Scrolled&#40;&#39;Text&#39;, -wrap=&gt;&#39;none&#39;&#41;-&gt;pack;
    $poe_main_window-&gt;update;

    my $child = POE::Wheel::Run-&gt;new&#40;
        Program =&gt; $PGM,
        StdoutEvent =&gt; &#39;KidOut&#39;,
        StderrEvent =&gt; &#39;KidErr&#39;,
        CloseEvent =&gt; &#39;KidClose&#39;,
    &#41;;
    $_[KERNEL]-&gt;sig_child&#40;$child-&gt;PID, &#39;_DoSig&#39;&#41;;
    $_[HEAP]{Kids}{WID}{$child-&gt;ID} = $child;
    $_[HEAP]{Kids}{PID}{$child-&gt;PID} = $child;
}

sub _GetStdout {
    my &#40;$line, $wid&#41; = @_[ARG0, ARG1];
    my $child = $_[HEAP]{Kids}{WID}{$wid};
    $TEXT-&gt;insert&#40;&#39;end&#39;, $child-&gt;PID . &#34; OUT: $line\n&#34;&#41;;
    $TEXT-&gt;see&#40;&#39;end&#39;&#41;;
    $poe_main_window-&gt;update;
}

sub _GetStderr {
    my &#40;$line, $wid&#41; = @_[ARG0, ARG1];
    my $child = $_[HEAP]{Kids}{WID}{$wid};
    $TEXT-&gt;insert&#40;&#39;end&#39;, $child-&gt;PID . &#34; ERR: $line\n&#34;&#41;;
    $TEXT-&gt;see&#40;&#39;end&#39;&#41;;
    $poe_main_window-&gt;update;
}

sub _DoClose {
    my $wid = $_[ARG0];
    my $child = $_[HEAP]{Kids}{WID}{$wid};

    unless &#40;defined $child&#41; {
        print STDERR &#34;wid $wid closed all pipes.\n&#34;;
        return;
    }

    print STDERR &#34;wid $wid closed all pipes.\n&#34;;
    delete $_[HEAP]{Kids}{PID}{$child-&gt;PID};
}

sub _DoSig {
    print STDERR &#34;pid $_[ARG1] exited with status $_[ARG2].\n&#34;;
    my $child = delete $_[HEAP]{Kids}{PID}{$_[ARG1]};

    return unless defined $child;

    delete $_[HEAP]{Kids}{WID}{$child-&gt;ID};
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;26&nbsp;01:17:29&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I finally had a chance to try this in Windows.  It&#39;s not just that the
window goes away---ActiveState Perl crashes entirely:

Problem signature:
  Problem Event Name:   APPCRASH
  Application Name:     perl.exe
  Application Version:  5.10.0.1005
  Application Timestamp:        4a199d7b
  Fault Module Name:    perl510.dll
  Fault Module Version: 5.10.0.1005
  Fault Module Timestamp:       4a199d7a
  Exception Code:       c0000005
  Exception Offset:     0009b108
  OS Version:   6.0.6001.2.1.0.256.1
  Locale ID:    3081
  Additional Information 1:     8fa1
  Additional Information 2:     9d2d51358673427ced829a737938897f
  Additional Information 3:     6265
  Additional Information 4:     2456740ed2fc16fef02c5739ea89bba3

Read our privacy statement:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://go.microsoft.com/fwlink/?linkid=50163&#38;clcid=0x0409">http://go.microsoft.com/fwlink/?linkid=50163&#38;clcid=0x0409</a></span>
 

It also crashes Strawberry Perl:

Problem signature:
  Problem Event Name:   APPCRASH
  Application Name:     perl.exe
  Application Version:  0.0.0.0
  Application Timestamp:        4a5dfcf6
  Fault Module Name:    perl510.dll
  Fault Module Version: 0.0.0.0
  Fault Module Timestamp:       4a5dfcf3
  Exception Code:       c0000005
  Exception Offset:     000ecb5d
  OS Version:   6.0.6001.2.1.0.256.1
  Locale ID:    3081
  Additional Information 1:     2176
  Additional Information 2:     709cf08a65a5fcb33db7eae39a257507
  Additional Information 3:     6ef1
  Additional Information 4:     a725b524d2b0ed25f426f8a9e2e9ad03

Read our privacy statement:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://go.microsoft.com/fwlink/?linkid=50163&#38;clcid=0x0409">http://go.microsoft.com/fwlink/?linkid=50163&#38;clcid=0x0409</a></span>
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;26&nbsp;01:17:30&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;26&nbsp;01:59:12&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have reduced the problem to a four-line test case that does not use
POE.  The conclusion is that Tk and fork&#40;&#41; don&#39;t work together in Windows.

use Tk;
my $mw = Tk::MainWindow-&gt;new&#40;&#41;;
sleep 1 if fork &#40;&#41;;
exit;

For this problem to be fixed, Tk must support being forked under MSWin32.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">--- Notes Follow ---

Using POE::Wheel::Run, Perl crashes on child exit.

<span class="clickylink"><a target="new" rel="nofollow" href="http://w4.lns.cornell.edu/~pvhp/ptk/ptkFAQ.html">http://w4.lns.cornell.edu/~pvhp/ptk/ptkFAQ.html</a></span> discusses fork&#40;&#41; and
exit&#40;&#41; issues:

Slaven Rezic addresses another aspect of fork&#40;&#41;ing. Suppose you want the
child to unload all the Tk stuff without attempting to destroy it, that
is, to tell it to undef every Tk var it has, everywhere. You&#39;ll want to

  POSIX::exit&#40;0&#41;;

or

  CORE::exit&#40;0&#41;;

rather than

  exit&#40;0&#41;;

in the child process. The unqualified exit&#40;&#41; is evaluated as Tk::exit.
This, of course, destroys all MainWindows, which is the effect we want
to avoid.

...

Explicitly calling POSIX::_exit&#40;0&#41; exits both the parent and child
process.  They are really separate threads in the same process, so the
C-level exit&#40;&#41; stops them both.

Explicitly calling Tk::exit&#40;0&#41; crashes Perl in a new and interesting
way: &#34;Free to wrong pool &#40;hex&#41; not &#40;hex&#41; at ....&#34;  This is most likely
because a child thread is trying to shutdown Tk, which is owned by and
still running in the parent thread.

Explicitly calling CORE::exit&#40;0&#41; allows the program to crash in the way
that was reported in this ticket.

kill -9, $$ in the child process also triggers the crash.

exec&#40;&#41; also triggers the crash.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;12:48:04&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m sorry, but I must reject this ticket.

As shown by the four-line test case, there is an underlying problem
using Tk and fork&#40;&#41; on Windows.  Tk is not thread-safe, and fork&#40;&#41; uses
threads on Windows.  Together, they crash spectacularly, whether or not
POE is involved.

Perhaps POE has a problem, but it&#39;s impossible to detect without first
resolving Tk&#39;s issue with fork&#40;&#41; on Windows.  I invite you to open a
ticket against Tk with my test case.

Please reopen this ticket if you find a work-around, or if problems
persist after Tk is fixed.  I would love to resolve this, if possible.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;12:48:05&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;13:25:37&nbsp;2009</span>
    <span class="description">craig [...] alcatel-lucent.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> craig [...] alcatel-lucent.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Rocco-

No problem rejecting the ticket. I understand the problem lies elsewhere.

There already seems to have been a fork bug written against Tk, that&#39;s been hanging around 
for 5 years now &#40;<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Public/Bug/Display.html?id=6351&#41;">http://rt.cpan.org/Public/Bug/Display.html?id=6351&#41;</a></span>. I don&#39;t expect to see 
it get fixed anytime soon.

Sorry to be a bit dense on this, but a couple of things are not clear to me:

1.&#41; I&#39;m able to avoid the problem by adding &#34;&#38; pause&#34; to the command I want to run. This 
prevents the forked child from exiting, and everything else seems to be working fine. Is 
everything else actually, really, working fine or are there some other problems lurking there 
that I have not run into yet? In other words, is the specific problem with Tk and windows fork 
only in the exiting of the child?

2.&#41; Should I continue to use the &#34;&#38; pause&#34; workaround, or is there a better one?

3.&#41; Is it POE that decided to use fork, or something that POE is using, that is using fork? I&#39;m 
wondering if we could eliminate the problem by finding some non-thread fork alternative for 
windows &#40;is there one&#41;?

Thanks

-Craig
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;13:25:37&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;21:37:36&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">1. Avoiding the problem by using pause.

You&#39;re keeping the child process around until the parent program is
ready to exit.  If you intend to run the program more than once, it will
approach the full resources of your machine to keep them around.  On
UNIX systems, this ends when the OS has no more resources to start new
programs, and someone at the console hard boots the machine.

2. Continue using pause?

You can try, but I don&#39;t recommend it.

3. Is POE deciding to fork?

POE::Wheel::Run is a module that uses fork&#40;&#41; to run some code or an
external program in the background.  Your application is choosing to
fork&#40;&#41; by using this module.

You may be able to avoid fork&#40;&#41; if whatever you want to do doesn&#39;t
really need it.  I can&#39;t answer more specifically until I know what
you&#39;re trying to do.

As far as I know, there&#39;s no non-threaded fork&#40;&#41; for Windows.  There may
be Windows-specific calls that do something like fork&#40;&#41;.  If you can
find the proper invocation, I may be able to add it to POE::Wheel::Run
for compatibility.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;21:37:37&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;04&nbsp;11:06:53&nbsp;2009</span>
    <span class="description">craig [...] alcatel-lucent.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; There may
&gt; be Windows-specific calls that do something like fork&#40;&#41;.  If you can
&gt; find the proper invocation, I may be able to add it to POE::Wheel::Run
&gt; for compatibility.
</div>
Here is what I use in a perl script when I want to run command.pl on unix, but command.exe 
on windows:

use strict;
use warnings;
use English;

# Setup command variables...
my $cmd = &#34;command&#34;;            # Command root to run
my $cmdopts = &#34;INPUT001&#34;;       # Options for command
my $cmdpath;

if&#40;$OSNAME=~/MSWin32/&#41; {
        $cmd .= &#39;.exe&#39;;
        # Find full path name &#40;using current directory and desktop&#41;...
        use Cwd;
        foreach my $p &#40;getcwd, &#34;$ENV{USERPROFILE}\\Desktop&#34;&#41; {
                if&#40;-x &#34;$p\\$cmd&#34;&#41; {$cmdpath=$p; last};
        }
        # Verify the found command is executable...
        if&#40;! $cmdpath&#41; {
                die &#34;\n\n PC ERROR: Can&#39;t find executable $cmd\n\t&#34;;
        }
        # Run command...
        print STDERR &#34;WINDOWS: $cmdpath\\$cmd&#34;;
        require Win32::Process;
        no strict;      # Doesn&#39;t like NORMAL_PRIORITY_CLASS
        my $process;
        Win32::Process::Create&#40;$process,
                &#34;$cmdpath\\$cmd&#34;,
                &#34; $cmdopts&#34;,
                1, NORMAL_PRIORITY_CLASS,
                &#34;$cmdpath&#34;&#41; || die &#34;\n\nPC ERROR: Can&#39;t run $cmd\n\t&#34;,
                        Win32::FormatMessage&#40; Win32::GetLastError&#40;&#41; &#41;;
                use strict;
}else{
        $cmdpath = &#39;.&#39;;         # Default for unix
        $cmd .= &#39;.pl&#39;;
        # Verify command is executable...
        if&#40;-x &#34;$cmdpath/$cmd&#34;&#41; {print STDERR &#34;executable found\n&#34;}
        else{ die &#34;Cannot find executable $cmdpath/$cmd&#34; }
print STDERR &#34;Running: $cmdpath/$cmd $cmdopts\n&#34;;
        system&#40;&#34;$cmdpath/$cmd $cmdopts &#38;&#34;&#41;;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;04&nbsp;11:06:54&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;02&nbsp;00:10:33&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 04 11:06:53 2009, cmv wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; There may
&gt; &gt; be Windows-specific calls that do something like fork&#40;&#41;.  If you can
&gt; &gt; find the proper invocation, I may be able to add it to
</div>&gt; POE::Wheel::Run
<div class="message-stanza open">&gt; &gt; for compatibility.
</div>&gt; 
&gt; Here is what I use in a perl script when I want to run command.pl on
&gt; unix, but command.exe
&gt; on windows:
</div>[...]

I&#39;ve just applied someone&#39;s patch to incorporate POE::Wheel::Run::Win32
in POE::Wheel::Run &#40;with the ::Win32 author&#39;s blessing&#41;.  It uses more
Win32:: calls, but not Win32::Process::Create&#40;&#41;.

Is Win32::Process::Create&#40;&#41; compatible with Tk?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;02&nbsp;09:09:28&nbsp;2009</span>
    <span class="description">craig [...] alcatel-lucent.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Oct 02 00:10:33 2009, RCAPUTO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ve just applied someone&#39;s patch to incorporate POE::Wheel::Run::Win32
&gt; in POE::Wheel::Run &#40;with the ::Win32 author&#39;s blessing&#41;.  It uses more
&gt; Win32:: calls, but not Win32::Process::Create&#40;&#41;.
&gt; 
&gt; Is Win32::Process::Create&#40;&#41; compatible with Tk?
</div>
I&#39;ve been using Win32::Process::Create in my Tk-based tools here at work for a number of 
years &#40;wow, approaching 10 now&#41;, and have never encountered a problem with it. However, 
my use is very simplistic - I usually have my perl-Tk based GUI startup process spawn the 
perl-Tk based GUI analysis process after setting up the input data stream.

I would hope that using Win32::Process::Create would avoid the problem discovered here, 
but can&#39;t be sure.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;02&nbsp;11:01:03&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Oct 02 09:09:28 2009, cmv wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Oct 02 00:10:33 2009, RCAPUTO wrote:
<div class="message-stanza open">&gt; &gt; I&#39;ve just applied someone&#39;s patch to incorporate
</div>&gt; POE::Wheel::Run::Win32
<div class="message-stanza open">&gt; &gt; in POE::Wheel::Run &#40;with the ::Win32 author&#39;s blessing&#41;.  It uses
</div>&gt; more
<div class="message-stanza open">&gt; &gt; Win32:: calls, but not Win32::Process::Create&#40;&#41;.
&gt; &gt;
&gt; &gt; Is Win32::Process::Create&#40;&#41; compatible with Tk?
</div>&gt; 
&gt; I&#39;ve been using Win32::Process::Create in my Tk-based tools here at
&gt; work for a number of
&gt; years &#40;wow, approaching 10 now&#41;, and have never encountered a problem
&gt; with it. However,
&gt; my use is very simplistic - I usually have my perl-Tk based GUI
&gt; startup process spawn the
&gt; perl-Tk based GUI analysis process after setting up the input data
&gt; stream.
&gt; 
&gt; I would hope that using Win32::Process::Create would avoid the problem
&gt; discovered here,
&gt; but can&#39;t be sure.
</div>
I&#39;m not sure either.  Looking at it closer, the code doesn&#39;t set up
STDIN/STDOUT/STDERR communications between the parent and child
processes.  That&#39;s a very important part of POE::Wheel::Run&#39;s job.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;29&nbsp;01:56:33&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Win32::Process::Create seems to be awkward for POE::Wheel::Run&#39;s
pipe/fork/exec model.  There doesn&#39;t seem to be a way to wait for child
processes without polling or blocking.  Web research indicates that it&#39;s
not easy to set up pipes to processes created this way.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;29&nbsp;01:56:34&nbsp;2009</span>
    <span class="description">RCAPUTO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
