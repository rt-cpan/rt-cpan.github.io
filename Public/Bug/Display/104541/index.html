<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #104541 for Catalyst-Runtime: Deep recursion on subroutine MyApp::setup_component</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #104541 for Catalyst-Runtime: Deep recursion on subroutine MyApp::setup_component</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Catalyst-Runtime/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Catalyst-Runtime/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Catalyst-Runtime/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Catalyst-Runtime/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Catalyst-Runtime">Catalyst-Runtime CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">104541</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Catalyst-Runtime/Active/">Catalyst-Runtime</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Support [...] RoxSoft.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40040-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
5.90091</li>
<li>
5.90089_001</li>
<li>
5.90089_002</li>
<li>
5.90089_003</li>
<li>
5.90089_004</li>
<li>
5.90090</li>
<li>
5.90092</li>
</ul>
    </td>
  </tr>
  <tr id="CF-40041-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;08:26:23&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Deep recursion on subroutine MyApp::setup_component</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Catalyst 5.90091 breaks Catalyst-Plugin-Configcomponents

Deep recursion on subroutine &#34;MyApp::setup_component&#34; at /home/pjf/Perl/lib/perl5/Catalyst.pm line 3059.
Deep recursion on anonymous subroutine at /home/pjf/Perl/lib/perl5/x86_64-linux/Class/MOP/Method/Wrapped.pm line 86.
Deep recursion on subroutine &#34;Class::MOP::Class:::around&#34; at /home/pjf/Perl/lib/perl5/x86_64-linux/Class/MOP/Method/Wrapped.pm line 157.
Deep recursion on subroutine &#34;Catalyst::setup_component&#34; at /home/pjf/Projects/Catalyst-Plugin-ConfigComponents/master/t/../lib/Catalyst/Plugin/ConfigComponents.pm line 35.

Broken for me on Perl 5.10.1 for Travis on Perl 5.14.4
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:02:18&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Broken in 5.90089_001 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:02:19&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Broken in 5.90089_002 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:02:19&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Broken in 5.90089_003 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:02:20&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Broken in 5.90089_004 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:02:20&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Broken in 5.90090 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:42:45&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The recursive call to setup_component is on line 5059
of Catalyst.pm

Anyone doing an around setup_component is shafted
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:52:23&nbsp;2015</span>
    <span class="description">ilmari [...] ilmari.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104541] Deep recursion on subroutine MyApp::setup_component</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 19 May 2015 15:51:52 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Catalyst-Runtime [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ilmari [...] ilmari.org &#40;Dagfinn Ilmari Mannsåker&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;Peter Flanigan via RT&#34; &lt;bug-Catalyst-Runtime@rt.cpan.org&gt; writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Catalyst-Runtime
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104541">https://rt.cpan.org/Ticket/Display.html?id=104541</a></span> &gt;
&gt;
&gt; The recursive call to setup_component is on line 5059
&gt; of Catalyst.pm
</div>
Catalyst.pm doesn&#39;t have that many lines, and setup_component doesn&#39;t
call itself.  Are you confusing setup_component and setup_components
&#40;which calls -&gt;setup_component for each loaded component&#41;?


-- 
&#34;A disappointingly low fraction of the human race is,
 at any given time, on fire.&#34; - Stig Sandbeck Mathisen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:52:25&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;09:58:58&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue May 19 09:42:45 2015, PJFL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The recursive call to setup_component is on line 5059
</div>
Type should be 3059
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;10:04:22&nbsp;2015</span>
    <span class="description">ilmari [...] ilmari.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients:;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104541] Deep recursion on subroutine MyApp::setup_component</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 19 May 2015 16:04:03 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Catalyst-Runtime [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ilmari [...] ilmari.org &#40;Dagfinn Ilmari Mannsåker&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#34;&#34;&#40;Dagfinn Ilmari Mannsåker&#41;&#34; via RT&#34; &lt;bug-Catalyst-Runtime@rt.cpan.org&gt;
writes:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Catalyst-Runtime
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104541">https://rt.cpan.org/Ticket/Display.html?id=104541</a></span> &gt;
&gt;
&gt; &#34;Peter Flanigan via RT&#34; &lt;bug-Catalyst-Runtime@rt.cpan.org&gt; writes:
&gt;
<div class="message-stanza open">&gt;&gt;        Queue: Catalyst-Runtime
&gt;&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104541">https://rt.cpan.org/Ticket/Display.html?id=104541</a></span> &gt;
&gt;&gt;
&gt;&gt; The recursive call to setup_component is on line 5059
&gt;&gt; of Catalyst.pm
</div>&gt;
&gt; Catalyst.pm doesn&#39;t have that many lines,
</div>
Ah, I see your original message had the correct line number: 3059.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; and setup_component doesn&#39;t call itself.  Are you confusing
&gt; setup_component and setup_components &#40;which calls -&gt;setup_component
&gt; for each loaded component&#41;?
</div>
Sorry, I was looking at an old checkout.  The only way I can see that
recursing is if your component has an expand_modules method that always
returns a new component name, or if your setup_component wrapper is
doing something weird.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Anyone doing an around setup_component is shafted
</div>
Can you please show us your setup_component wrapper, and any
expand_modules method in your components?

-- 
&#34;A disappointingly low fraction of the human race is,
 at any given time, on fire.&#34; - Stig Sandbeck Mathisen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;11:10:08&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue May 19 10:04:22 2015, ilmari@ilmari.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you please show us your setup_component wrapper, and any
&gt; expand_modules method in your components?
</div>
Sure the code is here

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm">https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;21:11:33&nbsp;2015</span>
    <span class="description">jjn1056 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104541] Deep recursion on subroutine MyApp::setup_component</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 May 2015 01:11:24 +0000 &#40;UTC&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Catalyst-Runtime [...] rt.cpan.org&#34; &lt;bug-Catalyst-Runtime [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Napiorkowski &lt;jjn1056 [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I can verify that you get deep recursion when trying to install a previously working CPAN module.  I&#39;ll look into it.
I do want to point out some of these features are now cored, although the overall approach is different.  I wonder if the efforts could be combined in some manner?  If you could look at the new component injection stuff and two plugins I did around it that I am hoping to see in core someday as well:
Catalyst-Plugin-InjectionHelpers-0.007  and Catalyst-Plugin-Ma…Dependencies-0.005

this takes a more moose role based approach rather than subclasses but I bet that could be combined.  In any case 5.9009x was labeled a &#39;shouldn&#39;t break stuff&#39; release and although your code here is definitely flogging catalyst it is hitting public APIs.  Let me think about this a bit. 



     On Tuesday, May 19, 2015 11:10 AM, Peter Flanigan via RT &lt;bug-Catalyst-Runtime@rt.cpan.org&gt; wrote:
   

       Queue: Catalyst-Runtime
 Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104541">https://rt.cpan.org/Ticket/Display.html?id=104541</a></span> &gt;

On Tue May 19 10:04:22 2015, ilmari@ilmari.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you please show us your setup_component wrapper, and any
&gt; expand_modules method in your components?
</div>
Sure the code is here

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm">https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm</a></span>






  
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;21:47:04&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Broken in 5.90092 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;22:03:59&nbsp;2015</span>
    <span class="description">jjn1056 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104541] Deep recursion on subroutine MyApp::setup_component</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 May 2015 02:03:44 +0000 &#40;UTC&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Catalyst-Runtime [...] rt.cpan.org&#34; &lt;bug-Catalyst-Runtime [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Napiorkowski &lt;jjn1056 [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I can verify that moving the bit where we expand inner packages on a component from setup_components to setup_compont is the cause if this recursion.  However the case:
 { no strict &#39;refs&#39;; @{&#34;$class\::Sub::ISA&#34;} = @{&#34;$class\::ISA&#34;} }

seems pathological. give me a day or two to work this out  



     On Tuesday, May 19, 2015 9:11 PM, John Napiorkowski &lt;jjn1056@yahoo.com&gt; wrote:
   

 I can verify that you get deep recursion when trying to install a previously working CPAN module.  I&#39;ll look into it.
I do want to point out some of these features are now cored, although the overall approach is different.  I wonder if the efforts could be combined in some manner?  If you could look at the new component injection stuff and two plugins I did around it that I am hoping to see in core someday as well:
Catalyst-Plugin-InjectionHelpers-0.007  and Catalyst-Plugin-Ma…Dependencies-0.005

this takes a more moose role based approach rather than subclasses but I bet that could be combined.  In any case 5.9009x was labeled a &#39;shouldn&#39;t break stuff&#39; release and although your code here is definitely flogging catalyst it is hitting public APIs.  Let me think about this a bit. 



     On Tuesday, May 19, 2015 11:10 AM, Peter Flanigan via RT &lt;bug-Catalyst-Runtime@rt.cpan.org&gt; wrote:
   

       Queue: Catalyst-Runtime
 Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104541">https://rt.cpan.org/Ticket/Display.html?id=104541</a></span> &gt;

On Tue May 19 10:04:22 2015, ilmari@ilmari.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you please show us your setup_component wrapper, and any
&gt; expand_modules method in your components?
</div>
Sure the code is here

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm">https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm</a></span>






   

  
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;22:05:13&nbsp;2015</span>
    <span class="description">jjn1056 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104541] Deep recursion on subroutine MyApp::setup_component</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 May 2015 02:05:03 +0000 &#40;UTC&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Catalyst-Runtime [...] rt.cpan.org&#34; &lt;bug-Catalyst-Runtime [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Napiorkowski &lt;jjn1056 [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">basically 
 { no strict &#39;refs&#39;; @{&#34;$class\::Sub::ISA&#34;} = @{&#34;$class\::ISA&#34;} }

it keeps calling setup_component and we get comp::Sub, comp::Sub::Sub, ... and so on.  



     On Tuesday, May 19, 2015 9:11 PM, John Napiorkowski &lt;jjn1056@yahoo.com&gt; wrote:
   

 I can verify that you get deep recursion when trying to install a previously working CPAN module.  I&#39;ll look into it.
I do want to point out some of these features are now cored, although the overall approach is different.  I wonder if the efforts could be combined in some manner?  If you could look at the new component injection stuff and two plugins I did around it that I am hoping to see in core someday as well:
Catalyst-Plugin-InjectionHelpers-0.007  and Catalyst-Plugin-Ma…Dependencies-0.005

this takes a more moose role based approach rather than subclasses but I bet that could be combined.  In any case 5.9009x was labeled a &#39;shouldn&#39;t break stuff&#39; release and although your code here is definitely flogging catalyst it is hitting public APIs.  Let me think about this a bit. 



     On Tuesday, May 19, 2015 11:10 AM, Peter Flanigan via RT &lt;bug-Catalyst-Runtime@rt.cpan.org&gt; wrote:
   

       Queue: Catalyst-Runtime
 Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104541">https://rt.cpan.org/Ticket/Display.html?id=104541</a></span> &gt;

On Tue May 19 10:04:22 2015, ilmari@ilmari.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you please show us your setup_component wrapper, and any
&gt; expand_modules method in your components?
</div>
Sure the code is here

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm">https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm</a></span>






   

  
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;19&nbsp;22:28:04&nbsp;2015</span>
    <span class="description">jjn1056 [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #104541] Deep recursion on subroutine MyApp::setup_component</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 20 May 2015 02:27:50 +0000 &#40;UTC&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Catalyst-Runtime [...] rt.cpan.org&#34; &lt;bug-Catalyst-Runtime [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> John Napiorkowski &lt;jjn1056 [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ok so
I thought about it and reviewed the code.  Please following and try to help me see if I got it right.
I think Catayst is now correct but was broken previous, and that your test case that is now recursive is not a good test case for a problem catalyst previously had.
So you have a model that inherited from this component:
<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/t/lib/Catalyst/Component/Implicit.pm">https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/t/lib/Catalyst/Component/Implicit.pm</a></span>

right so when that component is setup in injects a new componet &#34;$Comp::Sub&#34; AND it sets the base case for this new injected component to the component we just setup.
That means we have a second component with the same COMPONENT method that does the same thing...
So in older catalyst we only expanded inner components ONCE.   inner components could not expand.  Now we expand recursively.  Your test case recurses indefinitely now, which I think it should always have done except for this bug in Catalyst.
I think the new behavior is correct and it moves us in the direction of making Catalyst component setup more flexible and closer to the &#39;inversion of control container&#39; long term goal we have.
I think its totally safe to wrap setup_components, that is not causing this issue.
Although I think &#40;but please correct me if you see a flaw in my thinking&#41; that Catalyst is now correct and that your test case is now properly recursive I can see this could cause people trouble.  So I could add a configuration flag to Catalyst like &#39;dont_expand_inner_components&#39; that if true fails to recurse.  That would solve your test case and if you think people hit this issue in real life non pathological code I can add that.
What do you think?
jnap 



     On Tuesday, May 19, 2015 9:11 PM, John Napiorkowski &lt;jjn1056@yahoo.com&gt; wrote:
   

 I can verify that you get deep recursion when trying to install a previously working CPAN module.  I&#39;ll look into it.
I do want to point out some of these features are now cored, although the overall approach is different.  I wonder if the efforts could be combined in some manner?  If you could look at the new component injection stuff and two plugins I did around it that I am hoping to see in core someday as well:
Catalyst-Plugin-InjectionHelpers-0.007  and Catalyst-Plugin-Ma…Dependencies-0.005

this takes a more moose role based approach rather than subclasses but I bet that could be combined.  In any case 5.9009x was labeled a &#39;shouldn&#39;t break stuff&#39; release and although your code here is definitely flogging catalyst it is hitting public APIs.  Let me think about this a bit. 



     On Tuesday, May 19, 2015 11:10 AM, Peter Flanigan via RT &lt;bug-Catalyst-Runtime@rt.cpan.org&gt; wrote:
   

       Queue: Catalyst-Runtime
 Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=104541">https://rt.cpan.org/Ticket/Display.html?id=104541</a></span> &gt;

On Tue May 19 10:04:22 2015, ilmari@ilmari.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you please show us your setup_component wrapper, and any
&gt; expand_modules method in your components?
</div>
Sure the code is here

<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm">https://metacpan.org/source/PJFL/Catalyst-Plugin-ConfigComponents-0.9.1/lib/Catalyst/Plugin/ConfigComponents.pm</a></span>






   

  
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;23&nbsp;04:52:04&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve deleted the Catalyst plugin form CPAN since it&#39;s purpose has now been cored
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sat&nbsp;May&nbsp;23&nbsp;04:52:08&nbsp;2015</span>
    <span class="description">Support [...] RoxSoft.co.uk -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
