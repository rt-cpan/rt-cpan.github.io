<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #16981 for Parse-MediaWikiDump: MediaWikiDump doest not handle #redirect : [[foo]]</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #16981 for Parse-MediaWikiDump: MediaWikiDump doest not handle #redirect : [[foo]]</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Parse-MediaWikiDump/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Parse-MediaWikiDump/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Parse-MediaWikiDump/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Parse-MediaWikiDump/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Parse-MediaWikiDump">Parse-MediaWikiDump CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">16981</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Parse-MediaWikiDump/Active/">Parse-MediaWikiDump</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
leurent [...] clipper.ens.fr

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-24738-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.30    </td>
  </tr>
  <tr id="CF-24739-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;09&nbsp;19:53:07&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> MediaWikiDump doest not handle #redirect : [[foo]]</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">MediaWikiDump handles &#39;#redirect [[foo]]&#39; correctly, but does not know about &#39;#redirect : [[foo]]&#39;.  The later form is not descibed in the Wikipedia help pages, but it is used on some pages and seem to works in Wikipedia, eg:
<span class="clickylink"><a target="new" rel="nofollow" href="http://fr.wikipedia.org/w/index.php?title=Myrtac%C3%A9es&#38;action=edit">http://fr.wikipedia.org/w/index.php?title=Myrtac%C3%A9es&#38;action=edit</a></span>

I can provide a patch if you like, but I guess you&#39;d better write one yourself...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;10&nbsp;14:47:32&nbsp;2006</span>
    <span class="description">triddle [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

I&#39;ve fixed the bug and have a version ready that should solve the problem. Can you please 
test the version attached to this ticket? If it works for you I will release that version as the 
next version of Parse::MediaWikiDump. 

Thanks for the bug report!

Tyler Riddle

[guest - Mon Jan  9 19:53:07 2006]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; MediaWikiDump handles &#39;#redirect [[foo]]&#39; correctly, but does not know
&gt;    about &#39;#redirect : [[foo]]&#39;.  The later form is not descibed in the
&gt;    Wikipedia help pages, but it is used on some pages and seem to
&gt;    works in Wikipedia, eg:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://fr.wikipedia.org/w/index.php?title=Myrtac%C3%A9es&#38;action=edit">http://fr.wikipedia.org/w/index.php?title=Myrtac%C3%A9es&#38;action=edit</a></span>
&gt; 
&gt; I can provide a patch if you like, but I guess you&#39;d better write one
&gt;    yourself...
</div></div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;10&nbsp;14:47:33&nbsp;2006</span>
    <span class="description">triddle [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;11&nbsp;15:34:35&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> leurent [...] clipper.ens.fr</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[TRIDDLE - Tue Jan 10 14:47:32 2006]:  
  
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello,  
&gt;   
&gt; I&#39;ve fixed the bug and have a version ready that should solve the  
&gt; problem. Can you please  
&gt; test the version attached to this ticket?  
</div>  
Yes, it works fine for me.  
  
In the meantime, I found another bug in MediaWikiDump: the title of the 
article &lt;URL: 
<span class="clickylink"><a target="new" rel="nofollow" href="http://en.wikipedia.org/w/index.php?title=%C2%A0&#38;redirect=no">http://en.wikipedia.org/w/index.php?title=%C2%A0&#38;redirect=no</a></span> &gt; is a 
single no-break space, and it is considered to be empty by your module.  
I think you should use something like [ \t\n\r] inststead of \s in the 
regexp that matches empty nodes [attached is a patch that does this].  
&#40;The XML specification defines witespace as spaces, tabs, and blank 
lines, and I added \r in case of some strange Windows-Mac-Unix 
interaction&#41;. 
 
I don&#39;t know exactly what are valid titles for MediaWiki, and if 
whitespace should be preserved in the title tag, so maybe you need to 
do something more clever, but this seems to fix empty titles. 
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -r -u Parse-MediaWikiDump-0.31/lib/Parse/MediaWikiDump.pm Parse-MediaWikiDump-0.31.patch/lib/Parse/MediaWikiDump.pm
--- Parse-MediaWikiDump-0.31/lib/Parse/MediaWikiDump.pm	2006-01-10 20:43:18.000000000 +0100
+++ Parse-MediaWikiDump-0.31.patch/lib/Parse/MediaWikiDump.pm	2006-01-11 20:34:43.000000000 +0100
@@ -687,7 +687,7 @@
 		}
 
 		if &#40;$ignore_ws_only&#41; {
-			return 1 if $chars =~ m/^\s+$/m;
+			return 1 if $chars =~ m/^[ \t\r\n]+$/m;
 		}
 
 		push&#40;@$buffer, [T_TEXT, \$chars]&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;11&nbsp;15:50:34&nbsp;2006</span>
    <span class="description">triddle [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In the meantime, I found another bug in MediaWikiDump: the title of the 
&gt; article &lt;URL: 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://en.wikipedia.org/w/index.php?title=%C2%A0&#38;redirect=no">http://en.wikipedia.org/w/index.php?title=%C2%A0&#38;redirect=no</a></span> &gt; is a 
&gt; single no-break space, and it is considered to be empty by your module.  
&gt; I think you should use something like [ \t\n\r] inststead of \s in the 
&gt; regexp that matches empty nodes [attached is a patch that does this].  
&gt; &#40;The XML specification defines witespace as spaces, tabs, and blank 
&gt; lines, and I added \r in case of some strange Windows-Mac-Unix 
&gt; interaction&#41;. 
</div>
I&#39;m not sure that is the right fix. It seems to me that if MediaWiki is going to allow whitespace 
only to exist in a title name it should mark the title node as whitespace preserving, as the 
text node is:
      &lt;text xml:space=&#34;preserve&#34;&gt;{{AprilCalendar}}

There was a similar problem with usernames that contain only spaces in bug #16583. I 
contacted the MediaWiki developers about that and it was a known problem with the 
software. I think the proper solution here is like the other bug: a hack to force the title node 
to be whitespace preserving. This is done just like the last bug fix by adding a new if 
condition right under 
                if &#40;$$curent[1] eq &#39;username&#39;&#41; {
                        $ignore_ws_only = 0;
                }
Just add
                if &#40;$$curent[1] eq &#39;title&#39;&#41; {
                        $ignore_ws_only = 0;
                }

Can you do that and let me know if it solves your problem? I&#39;ll file a bug report with 
MediaWiki as well to verify that it is bug.

Thanks,

Tyler Riddle
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;11&nbsp;16:28:54&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> leurent [...] clipper.ens.fr</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[TRIDDLE - Wed Jan 11 15:50:34 2006]: 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not sure that is the right fix. It seems to me that if MediaWiki 
&gt; is going to allow whitespace 
&gt; only to exist in a title name it should mark the title node as 
&gt; whitespace preserving, as the 
&gt; text node is: 
&gt;       &lt;text xml:space=&#34;preserve&#34;&gt;{{AprilCalendar}} 
</div> 
As far as I understand, a no-break space is not whitespace in XML, and 
I didn&#39;t manage to create a page on Wikipedia whose title is only XML 
whitespace &#40;ie space, tab, and newline, as far as I understand&#41; 
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Just add 
&gt;                 if &#40;$$curent[1] eq &#39;title&#39;&#41; { 
&gt;                         $ignore_ws_only = 0; 
&gt;                 } 
&gt;  
&gt; Can you do that and let me know if it solves your problem? 
</div> 
Yes, this also solves the problem. 
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;15&nbsp;20:31:33&nbsp;2006</span>
    <span class="description">triddle [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry it took so long to get back to you; rt.cpan.org was down for a while then I got engrossed 
in another software project. I used your original suggestion and changed the regex in 
char_handler&#40;&#41;. Attached is the version of Parse::MediaWikiDump version .31 that I intend to 
release. 

Thanks for your help and letting me know about the right way to solve the problem. Any more 
bug reports would be appreciated. =&#41;

Tyler Riddle
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;15&nbsp;20:50:46&nbsp;2006</span>
    <span class="description">triddle [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
