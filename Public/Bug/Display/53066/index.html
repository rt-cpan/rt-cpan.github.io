<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #53066 for Path-Class: It would be useful if next&#40;&#41; skipped . and ..</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #53066 for Path-Class: It would be useful if next&#40;&#41; skipped . and ..</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Path-Class">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Path-Class">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Path-Class">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Path-Class">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/kenahoo/Path-Class/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Path-Class">Path-Class CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><p style="background-color:#ffaaaa">I prefer that bugs & patches are filed on GitHub rather than on RT: <a href="https://github.com/kenahoo/Path-Class/issues">https://github.com/kenahoo/Path-Class/issues</a>.  Thanks.</a></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">53066</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Path-Class">Path-Class</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
schwern [...] pobox.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24898-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24899-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




0001-Fix-children-to-look-for-dot-dirs-in-a-cross-platfor.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/710927/366922/0001-Fix-children-to-look-for-dot-dirs-in-a-cross-platfor.patch">
Thu Dec 24 16:59:49 2009 (1.7k) by schwern [...] pobox.com
</a>
</font></li>
</ul>


0002-Make-dir-skip-itself-and-its-parent.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/710927/366923/0002-Make-dir-skip-itself-and-its-parent.patch">
Thu Dec 24 16:59:49 2009 (2k) by schwern [...] pobox.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=53066">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-710927" href="/Public/Bug/Display.html?id=53066#txn-710927">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;24&nbsp;16:59:49&nbsp;2009</span>
    <span class="description">schwern [...] pobox.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> It would be useful if next&#40;&#41; skipped . and ..</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 24 Dec 2009 13:59:23 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Path-Class [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/710927/366921/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/366921">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">$dir-&gt;next returns itself and its parent directory.  While that&#39;s complete and 
all, is that ever useful?  It would be far more useful to have an iterator 
that strips them out.  For the odd cases you really want the complete 
directory listing you can use -&gt;open and read from the handle.

There&#39;s two patches attached.  The first implements _is_dot_dir&#40;&#41; which looks 
for . and .. in a cross-platform manner.  That should be applied regardless of 
this ticket to fix children&#40;&#41;.

The second implements and tests the above.

I thought about adding in an %opts parameter like children&#40;&#41; but I&#39;ll leave 
that for somebody else or a future itch.

I suppose this is backwards incompatible, but its so slight I can&#39;t get worked 
up about it.


-- 
I&#39;m pale as Formica, social skills stunted small. But I&#39;m accurate
like a pica, I know the capital of Nepal. I&#39;m the nemesis of error,
dreadful diction fears my skills, more inquisitive than Jim Lehrer,
snottier than Beverly Hills.
     -- I.L.O.P. Secret Rap  <span class="clickylink"><a target="new" rel="nofollow" href="http://goats.com/archive/020830.html">http://goats.com/archive/020830.html</a></span>
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/710927/366922/0001-Fix-children-to-look-for-dot-dirs-in-a-cross-platfor.patch">Download 0001-Fix-children-to-look-for-dot-dirs-in-a-cross-platfor.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 5adac76146c5192adf947091e57a8ffff0a664f7 Mon Sep 17 00:00:00 2001
From: Michael G. Schwern &lt;schwern@pobox.com&gt;
Date: Thu, 24 Dec 2009 13:51:40 -0800
Subject: [PATCH 1/2] Fix children&#40;&#41; to look for dot dirs in a cross platform manner.

---
 lib/Path/Class/Dir.pm    |   15 +++++++++++++--
 lib/Path/Class/Entity.pm |    2 +-
 2 files changed, 14 insertions&#40;+&#41;, 3 deletions&#40;-&#41;

diff --git a/lib/Path/Class/Dir.pm b/lib/Path/Class/Dir.pm
index 615b14b..4016d9e 100644
--- a/lib/Path/Class/Dir.pm
+++ b/lib/Path/Class/Dir.pm
@@ -11,6 +11,9 @@ use base qw&#40;Path::Class::Entity&#41;;
 use IO::Dir &#40;&#41;;
 use File::Path &#40;&#41;;
 
+my $Updir  = __PACKAGE__-&gt;_spec-&gt;updir;
+my $Curdir = __PACKAGE__-&gt;_spec-&gt;curdir;
+
 sub new {
   my $self = shift-&gt;SUPER::new&#40;&#41;;
 
@@ -174,8 +177,7 @@ sub children {
   
   my @out;
   while &#40;defined&#40;my $entry = $dh-&gt;read&#41;&#41; {
-    # XXX What&#39;s the right cross-platform way to do this?
-    next if &#40;!$opts{all} &#38;&#38; &#40;$entry eq &#39;.&#39; || $entry eq &#39;..&#39;&#41;&#41;;
+    next if !$opts{all} &#38;&#38; $self-&gt;_is_dot_dir&#40;$entry&#41;;
     next if &#40;$opts{no_hidden} &#38;&#38; $entry =~ /^\./&#41;;
     push @out, $self-&gt;file&#40;$entry&#41;;
     $out[-1] = $self-&gt;subdir&#40;$entry&#41; if -d $out[-1];
@@ -183,6 +185,15 @@ sub children {
   return @out;
 }
 
+sub _is_dot_dir {
+    my $self = shift;
+    my $dir  = shift;
+
+    return 1 if $dir eq $Updir;
+    return 1 if $dir eq $Curdir;
+    return 0;
+}
+
 sub next {
   my $self = shift;
   unless &#40;$self-&gt;{dh}&#41; {
diff --git a/lib/Path/Class/Entity.pm b/lib/Path/Class/Entity.pm
index b858636..c790feb 100644
--- a/lib/Path/Class/Entity.pm
+++ b/lib/Path/Class/Entity.pm
@@ -39,7 +39,7 @@ sub new_foreign {
   return $class-&gt;new&#40;@_&#41;;
 }
 
-sub _spec { $_[0]-&gt;{file_spec_class} || &#39;File::Spec&#39; }
+sub _spec { &#40;ref $_[0] &#38;&#38; $_[0]-&gt;{file_spec_class}&#41; || &#39;File::Spec&#39; }
 
 sub boolify { 1 }
   
-- 
1.6.5.3

</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/710927/366923/0002-Make-dir-skip-itself-and-its-parent.patch">Download 0002-Make-dir-skip-itself-and-its-parent.patch</a><br />
<span class="downloadcontenttype">text/x-diff 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">From cf355b17f31ad5ceb197491c5381153576dba0a5 Mon Sep 17 00:00:00 2001
From: Michael G. Schwern &lt;schwern@pobox.com&gt;
Date: Thu, 24 Dec 2009 13:55:55 -0800
Subject: [PATCH 2/2] Make dir&#40;&#41; skip itself and its parent.

---
 lib/Path/Class/Dir.pm |   13 ++++++++++---
 t/03-filesystem.t     |    6 ++++--
 2 files changed, 14 insertions&#40;+&#41;, 5 deletions&#40;-&#41;

diff --git a/lib/Path/Class/Dir.pm b/lib/Path/Class/Dir.pm
index 4016d9e..901178f 100644
--- a/lib/Path/Class/Dir.pm
+++ b/lib/Path/Class/Dir.pm
@@ -200,10 +200,14 @@ sub next {
     $self-&gt;{dh} = $self-&gt;open or Carp::croak&#40; &#34;Can&#39;t open directory $self: $!&#34; &#41;;
   }
   
-  my $next = $self-&gt;{dh}-&gt;read;
+  my $next;
+  do {
+      $next = $self-&gt;{dh}-&gt;read;
+  } while defined $next and $self-&gt;_is_dot_dir&#40;$next&#41;;
+
   unless &#40;defined $next&#41; {
-    delete $self-&gt;{dh};
-    return undef;
+      delete $self-&gt;{dh};
+      return undef;
   }
   
   # Figure out whether it&#39;s a file or directory
@@ -603,6 +607,9 @@ If an error occurs when opening the directory &#40;for instance, it
 doesn&#39;t exist or isn&#39;t readable&#41;, C&lt;next&#40;&#41;&gt; will throw an exception
 with the value of C&lt;$!&gt;.
 
+Like children&#40;&#41;, dir&#40;&#41; will not include the I&lt;self&gt; and I&lt;parent&gt;
+entries C&lt;.&gt; and C&lt;..&gt; &#40;or their equivalents on non-Unix systems&#41;.
+
 =item $dir-&gt;recurse&#40; callback =&gt; sub {...} &#41;
 
 Iterates through this directory and all of its children, and all of
diff --git a/t/03-filesystem.t b/t/03-filesystem.t
index 5138ca3..2618550 100644
--- a/t/03-filesystem.t
+++ b/t/03-filesystem.t
@@ -4,7 +4,7 @@ use Test::More;
 use File::Temp qw&#40;tmpnam tempdir&#41;;
 use File::Spec;
 
-plan tests =&gt; 72;
+plan tests =&gt; 74;
 
 use_ok &#39;Path::Class&#39;;
 
@@ -88,7 +88,9 @@ ok !-e $dir, &#34;$dir no longer exists&#34;;
   while &#40;my $file = $dir-&gt;next&#41; {
     push @contents, $file;
   }
-  is scalar @contents, 5;
+  is @contents, 3;
+  is_deeply [grep { $_ eq $dir } @contents],         [];
+  is_deeply [grep { $_ eq $dir-&gt;parent } @contents], [];
 
   my $joined = join &#39; &#39;, sort map $_-&gt;basename, grep {-f $_} @contents;
   is $joined, &#39;0 file.x&#39;;
-- 
1.6.5.3

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-711972" href="/Public/Bug/Display.html?id=53066#txn-711972">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;28&nbsp;01:03:16&nbsp;2009</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/711972/367498/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/367498">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza">Thanks. &nbsp;I added a couple of comments for $Updir and $Curdir to note that they shouldn't respect &quot;foreign&quot; syntax, and changed the method name to _is_local_dot_dir() accordingly. &nbsp;First patch applied.<br>

<br>

I agree that the backcompat risk of the second patch is relatively small, but it's still nonzero. &nbsp;I'd like to introduce it with a little more warning, e.g. adding an 'all' parameter that defaults to true, letting people set it to false - and declare that in a future release we'll change the default to false. &nbsp;I'd be more than a little peeved if my program stopped working for an obscure little reason like that, with no warning.<br>

<br>

I also think that the user options for next() ought to mirror the options for children(). &nbsp;Symmetry and all that.<br>

<br>

In the meantime, this:<br>

<br>


<div>&nbsp;&nbsp;while (my $e = $dir-&gt;next(all=&gt;0)) {</div>


<div>&nbsp;&nbsp; &nbsp; ... do something ...</div>


<div>&nbsp;&nbsp; }</div>


<div><br>
is a whole lot better than the current necessity:<br>
<br>
<div>&nbsp;&nbsp;while (my $e = $dir-&gt;next) {<br>
&nbsp;&nbsp; &nbsp; next if $e eq File::Spec-&gt;curdir || $e eq File::Spec-&gt;updir; &nbsp;# or hard-code</div>
<div>&nbsp;&nbsp; &nbsp; ... do something ...</div>
<div>&nbsp;&nbsp; }</div>
<div>&nbsp;</div>
</div>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-711974" href="/Public/Bug/Display.html?id=53066#txn-711974">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;28&nbsp;01:03:17&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1120059" href="/Public/Bug/Display.html?id=53066#txn-1120059">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;14&nbsp;14:07:40&nbsp;2012</span>
    <span class="description">dsteinbrunner [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> dsteinbrunner [...] pobox.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1120059/589219/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589219">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Dec 28 01:03:16 2009, KWILLIAMS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; I agree that the backcompat risk of the second patch is relatively small, but
&gt; it&#39;s still nonzero. I&#39;d like to introduce it with a little more warning, e.g.
&gt; adding an &#39;all&#39; parameter that defaults to true, letting people set it to false
&gt; - and declare that in a future release we&#39;ll change the default to false. I&#39;d
&gt; be more than a little peeved if my program stopped working for an obscure
&gt; little reason like that, with no warning.
&gt; 
&gt; I also think that the user options for next&#40;&#41; ought to mirror the options for
&gt; children&#40;&#41;. Symmetry and all that.
&gt; 
&gt; In the meantime, this:
&gt; 
&gt; while &#40;my $e = $dir-&gt;next&#40;all=&gt;0&#41;&#41; { ... do something ... }
&gt; is a whole lot better than the current necessity:
&gt; 
&gt; while &#40;my $e = $dir-&gt;next&#41; {
&gt; next if $e eq File::Spec-&gt;curdir || $e eq File::Spec-&gt;updir; # or
&gt; hard-code ...
&gt; do something ... }
</div>
Just thought I would chime in and say that I came across this ticket because I expected the 
same behavior as schwern described and a change to allow it, via param or not, would still be 
beneficial.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.354612</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
