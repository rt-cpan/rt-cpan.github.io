<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #79690 for Helios: &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use&#34; error</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #79690 for Helios: &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use&#34; error</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Helios">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Helios">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Helios">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Helios">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Helios">Helios CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">79690</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Helios">Helios</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">LAJANDY [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
LAJANDY [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-223222-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
2.41</li>
<li>
2.60</li>
</ul>
    </td>
  </tr>
  <tr id="CF-223223-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<ul>
<li>
2.601_3610</li>
<li>
2.601_3670</li>
<li>
2.601_3750</li>
<li>
2.61</li>
<li>
2.71_3860</li>
<li>
2.71_4051</li>
<li>
2.71_4250</li>
<li>
2.71_4350</li>
<li>
2.71_4460</li>
<li>
2.71_4770</li>
<li>
2.72_0950</li>
<li>
2.80</li>
</ul>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=79690">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1120776" href="/Public/Bug/Display.html?id=79690#txn-1120776">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;17&nbsp;09:13:21&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1120776/589620/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/589620">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 348b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sometimes when a worker process picks up a job, it fails with:

&#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use at
/usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”

in the ERROR table.  No success or failure messages are reported in job
history.

The job is picked up later by another process and completes successfully.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150954" href="/Public/Bug/Display.html?id=79690#txn-1150954">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:47:23&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150955" href="/Public/Bug/Display.html?id=79690#txn-1150955">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:47:29&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150956" href="/Public/Bug/Display.html?id=79690#txn-1150956">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:48:11&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in
 use&#34; error</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1150956/605299/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/605299">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 412b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sometimes when a worker process picks up a job, it fails with:
&gt; 
&gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use at
&gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; 
&gt; in the ERROR table.  No success or failure messages are reported in job
&gt; history.
&gt; 
&gt; The job is picked up later by another process and completes successfully.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150957" href="/Public/Bug/Display.html?id=79690#txn-1150957">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:48:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Subject changed from &#40;no value&#41; to &#39;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use&#34;&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150958" href="/Public/Bug/Display.html?id=79690#txn-1150958">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:48:55&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Subject changed from &#39;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use&#34;&#39; to &#39;&#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use&#34; error&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150959" href="/Public/Bug/Display.html?id=79690#txn-1150959">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:09&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_2850 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150960" href="/Public/Bug/Display.html?id=79690#txn-1150960">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:09&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_2860 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150961" href="/Public/Bug/Display.html?id=79690#txn-1150961">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:09&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_2910 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150962" href="/Public/Bug/Display.html?id=79690#txn-1150962">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:09&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3040 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150963" href="/Public/Bug/Display.html?id=79690#txn-1150963">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:09&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3060 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150964" href="/Public/Bug/Display.html?id=79690#txn-1150964">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3070 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150965" href="/Public/Bug/Display.html?id=79690#txn-1150965">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3160 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150966" href="/Public/Bug/Display.html?id=79690#txn-1150966">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3161 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150967" href="/Public/Bug/Display.html?id=79690#txn-1150967">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3220 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150968" href="/Public/Bug/Display.html?id=79690#txn-1150968">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3630 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150969" href="/Public/Bug/Display.html?id=79690#txn-1150969">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.52_3950 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150970" href="/Public/Bug/Display.html?id=79690#txn-1150970">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.52_4150 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150971" href="/Public/Bug/Display.html?id=79690#txn-1150971">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.52_4310 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150972" href="/Public/Bug/Display.html?id=79690#txn-1150972">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:10&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.60 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150973" href="/Public/Bug/Display.html?id=79690#txn-1150973">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:38&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_2850 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150974" href="/Public/Bug/Display.html?id=79690#txn-1150974">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:38&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_2860 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150975" href="/Public/Bug/Display.html?id=79690#txn-1150975">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:38&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_2910 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150976" href="/Public/Bug/Display.html?id=79690#txn-1150976">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:38&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3040 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150977" href="/Public/Bug/Display.html?id=79690#txn-1150977">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:38&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3060 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150978" href="/Public/Bug/Display.html?id=79690#txn-1150978">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:38&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3070 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150979" href="/Public/Bug/Display.html?id=79690#txn-1150979">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3160 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150980" href="/Public/Bug/Display.html?id=79690#txn-1150980">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3161 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150981" href="/Public/Bug/Display.html?id=79690#txn-1150981">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3220 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150982" href="/Public/Bug/Display.html?id=79690#txn-1150982">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.50_3630 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150983" href="/Public/Bug/Display.html?id=79690#txn-1150983">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.52_3950 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150984" href="/Public/Bug/Display.html?id=79690#txn-1150984">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.52_4150 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1150985" href="/Public/Bug/Display.html?id=79690#txn-1150985">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;04&nbsp;17:49:39&nbsp;2012</span>
    <span class="description">LAJANDY [...] cpan.org -  Broken in 2.52_4310 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1247669" href="/Public/Bug/Display.html?id=79690#txn-1247669">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;09&nbsp;17:13:20&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1247669/660047/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660047">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 516b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sometimes when a worker process picks up a job, it fails with:
&gt; 
&gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use at
&gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; 
&gt; in the ERROR table.  No success or failure messages are reported in job
&gt; history.
&gt; 
&gt; The job is picked up later by another process and completes successfully.
</div>
A GitHub branch has been created for this bug:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/tree/bug/rt79690">https://github.com/logicalhelion/helios/tree/bug/rt79690</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1248197" href="/Public/Bug/Display.html?id=79690#txn-1248197">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;11&nbsp;17:48:19&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1248197/660328/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/660328">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">A potential patch for this bug has been committed to GitHub:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1">https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1</a></span>

If it passes testing, it will be rolled into a forthcoming bugfix release.

It should be noted, however, that this does not actually fix the problem--it just handles the problem in a way that does not cause non-retrying jobs to disappear from the job queue.  This bug is actually being caused by TheSchwartz for some reason; TheSchwartz is passing Helios::Service a TheSchwartz::Job object with an empty string for arg&#40;&#41;, even though the job in question does indeed have job arguments.  This causes Helios::Job-&gt;new&#40;&#41; to bomb when trying to start job argument processing--it expects arg&#40;&#41; to return an arrayref, NOT a string.  Changing Helios::Job to handle the empty string is the wrong idea--the job actually has arguments, Helios just didn&#39;t get them &#40;thus, the copy of the job Helios was given is corrupted&#41;.  Trying to run a job while not having its arguments would be worse than not running it at all.  This patch catches the error, logs a Critical error to the Helios log, and the exits the worker process.  That way, TheSchwartz will not force a failure of the job &#40;which it will do if a worker doesn&#39;t mark a job as successful or failed&#41; and the job will stay in the job queue until its grabbed_until expires and another worker process picks it up.

Further future investigation will hopefully reveal the core reason for this bug, but this patch at least ensures job integrity and system reliability.

On Fri Aug 09 17:13:20 2013, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; Sometimes when a worker process picks up a job, it fails with:
&gt; &gt; 
&gt; &gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use at
&gt; &gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; &gt; 
&gt; &gt; in the ERROR table.  No success or failure messages are reported in job
&gt; &gt; history.
&gt; &gt; 
&gt; &gt; The job is picked up later by another process and completes successfully.
</div>&gt; 
&gt; A GitHub branch has been created for this bug:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/tree/bug/rt79690">https://github.com/logicalhelion/helios/tree/bug/rt79690</a></span>
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1262626" href="/Public/Bug/Display.html?id=79690#txn-1262626">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;13&nbsp;17:17:39&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1262626/668578/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/668578">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The main problem with this bug is it can cause jobs submitted to Helios to be lost without being run.  With Helios services that do not retry failed jobs &#40;using MaxRetries&#40;&#41; and RetryInterval&#40;&#41;&#41;, when this bug occurs the job will effectively disappear from the job queue without being passed to the service&#39;s run&#40;&#41; and without any job history being recorded.  &#40;BAD!&#41;

For services that retry failed jobs, it just means one of the retries will be delayed for grab_for&#40;&#41; seconds &#40;default: 3600&#41;.

The patch included in the 2.601* series prevents the &#34;lost job&#34; problem by shutting down the worker process before the corrupt TheSchwartz::Job is inflated to a Helios::Job.  Thus, no jobs will be lost, period.  The grab_for&#40;&#41; delay will still happen, but there will be NO lost jobs.

An actual fix requires a better explanation:

Apparently there is no problem with Helios, TheSchwartz, or even Data::ObjectDriver.  The problem appears to be either with the DBD:: modules in question.  At certain times some database queries appear to lose their LOB bindings, which causes LOB fields in the result set to be returned blank.  Many of these LOB-handling bugs have been fixed in the past with DBD::mysql and DBD::Oracle, but looking at the DBD::Oracle RT will reveal that several of these are still outstanding.  Given the client I worked with on this bug has a older DBD::Oracle that pre-dates some of the LOB handling fixes, and the small occurrence of these issues &#40;0.1-0.4% of jobs&#41;, we believe this bug is actually a result of LOB handling bugs in the DBD modules in question.

We will try to implement a deeper fix in Helios 2.8 by checking a job object in the TheSchwartz layer before it is passed into the Helios layers.  If a job object is received from the database with no args, it can be discarded and another one selected.  But given that any jobs could be lost, even such a small number, we did not want to wait until Helios 2.8 is ready to implement *some* sort of fix.

So for now, if you are experiencing this bug, update to the latest Helios &#40;2.601_3750 for now, 2.61 will be out soon&#41; and update your DBD module to the latest release.

On Sun Aug 11 17:48:19 2013, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; A potential patch for this bug has been committed to GitHub:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1">https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1</a></span>
&gt; 
&gt; If it passes testing, it will be rolled into a forthcoming bugfix
&gt; release.
&gt; 
&gt; It should be noted, however, that this does not actually fix the
&gt; problem--it just handles the problem in a way that does not cause non-
&gt; retrying jobs to disappear from the job queue.  This bug is actually
&gt; being caused by TheSchwartz for some reason; TheSchwartz is passing
&gt; Helios::Service a TheSchwartz::Job object with an empty string for
&gt; arg&#40;&#41;, even though the job in question does indeed have job arguments.
&gt; This causes Helios::Job-&gt;new&#40;&#41; to bomb when trying to start job
&gt; argument processing--it expects arg&#40;&#41; to return an arrayref, NOT a
&gt; string.  Changing Helios::Job to handle the empty string is the wrong
&gt; idea--the job actually has arguments, Helios just didn&#39;t get them
&gt; &#40;thus, the copy of the job Helios was given is corrupted&#41;.  Trying to
&gt; run a job while not having its arguments would be worse than not
&gt; running it at all.  This patch catches the error, logs a Critical
&gt; error to the Helios log, and the exits the worker process.  That way,
&gt; TheSchwartz will not force a failure of the job &#40;which it will do if a
&gt; worker doesn&#39;t mark a job as successful or failed&#41; and the job will
&gt; stay in the job queue until its grabbed_until expires and another
&gt; worker process picks it up.
&gt; 
&gt; Further future investigation will hopefully reveal the core reason for
&gt; this bug, but this patch at least ensures job integrity and system
&gt; reliability.
&gt; 
&gt; On Fri Aug 09 17:13:20 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; Sometimes when a worker process picks up a job, it fails with:
&gt; &gt; &gt;
&gt; &gt; &gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use
&gt; &gt; &gt; at
&gt; &gt; &gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; &gt; &gt;
&gt; &gt; &gt; in the ERROR table.  No success or failure messages are reported in
&gt; &gt; &gt; job
&gt; &gt; &gt; history.
&gt; &gt; &gt;
&gt; &gt; &gt; The job is picked up later by another process and completes
&gt; &gt; &gt; successfully.
</div>&gt; &gt;
&gt; &gt; A GitHub branch has been created for this bug:
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/tree/bug/rt79690">https://github.com/logicalhelion/helios/tree/bug/rt79690</a></span>
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1262627" href="/Public/Bug/Display.html?id=79690#txn-1262627">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;13&nbsp;17:17:39&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1262628" href="/Public/Bug/Display.html?id=79690#txn-1262628">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;13&nbsp;17:17:39&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.601_3610 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1262629" href="/Public/Bug/Display.html?id=79690#txn-1262629">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;13&nbsp;17:17:40&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.601_3670 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1263010" href="/Public/Bug/Display.html?id=79690#txn-1263010">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;14&nbsp;19:00:29&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1263010/668780/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/668780">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 13 17:17:39 2013, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The main problem with this bug is it can cause jobs submitted to
&gt; Helios to be lost without being run.  With Helios services that do not
&gt; retry failed jobs &#40;using MaxRetries&#40;&#41; and RetryInterval&#40;&#41;&#41;, when this
&gt; bug occurs the job will effectively disappear from the job queue
&gt; without being passed to the service&#39;s run&#40;&#41; and without any job
&gt; history being recorded.  &#40;BAD!&#41;
&gt; 
&gt; For services that retry failed jobs, it just means one of the retries
&gt; will be delayed for grab_for&#40;&#41; seconds &#40;default: 3600&#41;.
&gt; 
&gt; The patch included in the 2.601* series prevents the &#34;lost job&#34;
&gt; problem by shutting down the worker process before the corrupt
&gt; TheSchwartz::Job is inflated to a Helios::Job.  Thus, no jobs will be
&gt; lost, period.  The grab_for&#40;&#41; delay will still happen, but there will
&gt; be NO lost jobs.
&gt; 
&gt; An actual fix requires a better explanation:
&gt; 
&gt; Apparently there is no problem with Helios, TheSchwartz, or even
&gt; Data::ObjectDriver.  The problem appears to be either with the DBD::
&gt; modules in question.  At certain times some database queries appear to
&gt; lose their LOB bindings, which causes LOB fields in the result set to
&gt; be returned blank.  Many of these LOB-handling bugs have been fixed in
&gt; the past with DBD::mysql and DBD::Oracle, but looking at the
&gt; DBD::Oracle RT will reveal that several of these are still
&gt; outstanding.  Given the client I worked with on this bug has a older
&gt; DBD::Oracle that pre-dates some of the LOB handling fixes, and the
&gt; small occurrence of these issues &#40;0.1-0.4% of jobs&#41;, we believe this
&gt; bug is actually a result of LOB handling bugs in the DBD modules in
&gt; question.
&gt; 
&gt; We will try to implement a deeper fix in Helios 2.8 by checking a job
&gt; object in the TheSchwartz layer before it is passed into the Helios
&gt; layers.  If a job object is received from the database with no args,
&gt; it can be discarded and another one selected.  But given that any jobs
&gt; could be lost, even such a small number, we did not want to wait until
&gt; Helios 2.8 is ready to implement *some* sort of fix.
&gt; 
&gt; So for now, if you are experiencing this bug, update to the latest
&gt; Helios &#40;2.601_3750 for now, 2.61 will be out soon&#41; and update your DBD
&gt; module to the latest release.
&gt; 
&gt; On Sun Aug 11 17:48:19 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; A potential patch for this bug has been committed to GitHub:
&gt; &gt;
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1">https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1</a></span>
&gt; &gt;
&gt; &gt; If it passes testing, it will be rolled into a forthcoming bugfix
&gt; &gt; release.
&gt; &gt;
&gt; &gt; It should be noted, however, that this does not actually fix the
&gt; &gt; problem--it just handles the problem in a way that does not cause
&gt; &gt; non-
&gt; &gt; retrying jobs to disappear from the job queue.  This bug is actually
&gt; &gt; being caused by TheSchwartz for some reason; TheSchwartz is passing
&gt; &gt; Helios::Service a TheSchwartz::Job object with an empty string for
&gt; &gt; arg&#40;&#41;, even though the job in question does indeed have job
&gt; &gt; arguments.
&gt; &gt; This causes Helios::Job-&gt;new&#40;&#41; to bomb when trying to start job
&gt; &gt; argument processing--it expects arg&#40;&#41; to return an arrayref, NOT a
&gt; &gt; string.  Changing Helios::Job to handle the empty string is the wrong
&gt; &gt; idea--the job actually has arguments, Helios just didn&#39;t get them
&gt; &gt; &#40;thus, the copy of the job Helios was given is corrupted&#41;.  Trying to
&gt; &gt; run a job while not having its arguments would be worse than not
&gt; &gt; running it at all.  This patch catches the error, logs a Critical
&gt; &gt; error to the Helios log, and the exits the worker process.  That way,
&gt; &gt; TheSchwartz will not force a failure of the job &#40;which it will do if
&gt; &gt; a
&gt; &gt; worker doesn&#39;t mark a job as successful or failed&#41; and the job will
&gt; &gt; stay in the job queue until its grabbed_until expires and another
&gt; &gt; worker process picks it up.
&gt; &gt;
&gt; &gt; Further future investigation will hopefully reveal the core reason
&gt; &gt; for
&gt; &gt; this bug, but this patch at least ensures job integrity and system
&gt; &gt; reliability.
&gt; &gt;
&gt; &gt; On Fri Aug 09 17:13:20 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; Sometimes when a worker process picks up a job, it fails with:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in use
&gt; &gt; &gt; &gt; at
&gt; &gt; &gt; &gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; in the ERROR table.  No success or failure messages are reported
&gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; job
&gt; &gt; &gt; &gt; history.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; The job is picked up later by another process and completes
&gt; &gt; &gt; &gt; successfully.
</div>&gt; &gt; &gt;
&gt; &gt; &gt; A GitHub branch has been created for this bug:
&gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/tree/bug/rt79690">https://github.com/logicalhelion/helios/tree/bug/rt79690</a></span>
&gt; &gt; &gt;
</div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1263011" href="/Public/Bug/Display.html?id=79690#txn-1263011">#</a>      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;14&nbsp;19:00:29&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.601_3750 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1275932" href="/Public/Bug/Display.html?id=79690#txn-1275932">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;16&nbsp;20:08:02&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1275932/675931/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/675931">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The workaround for this bug included with Helios::TS in 2.71_4051 appears to fix this problem.  It will be included in the forthcoming Helios 2.80 production release.

Helios::TS-&gt;_grab_a_job&#40;&#41; checks a job object before it is &#34;grabbed&#34; &#40;the job is locked in the queue for processing&#41; and makes sure the arg&#40;&#41; method is reporting a reference to a data structure.  If arg&#40;&#41; does not return a reference, _grab_a_job&#40;&#41; skips that job and pulls the next one from the array of jobs retrieved from the job queue.  This way, any LOB-binding problem resulting in a blank arg&#40;&#41; value will be avoided.

On Sat Sep 14 19:00:29 2013, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Sep 13 17:17:39 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; The main problem with this bug is it can cause jobs submitted to
&gt; &gt; Helios to be lost without being run.  With Helios services that do
&gt; &gt; not
&gt; &gt; retry failed jobs &#40;using MaxRetries&#40;&#41; and RetryInterval&#40;&#41;&#41;, when this
&gt; &gt; bug occurs the job will effectively disappear from the job queue
&gt; &gt; without being passed to the service&#39;s run&#40;&#41; and without any job
&gt; &gt; history being recorded.  &#40;BAD!&#41;
&gt; &gt;
&gt; &gt; For services that retry failed jobs, it just means one of the retries
&gt; &gt; will be delayed for grab_for&#40;&#41; seconds &#40;default: 3600&#41;.
&gt; &gt;
&gt; &gt; The patch included in the 2.601* series prevents the &#34;lost job&#34;
&gt; &gt; problem by shutting down the worker process before the corrupt
&gt; &gt; TheSchwartz::Job is inflated to a Helios::Job.  Thus, no jobs will be
&gt; &gt; lost, period.  The grab_for&#40;&#41; delay will still happen, but there will
&gt; &gt; be NO lost jobs.
&gt; &gt;
&gt; &gt; An actual fix requires a better explanation:
&gt; &gt;
&gt; &gt; Apparently there is no problem with Helios, TheSchwartz, or even
&gt; &gt; Data::ObjectDriver.  The problem appears to be either with the DBD::
&gt; &gt; modules in question.  At certain times some database queries appear
&gt; &gt; to
&gt; &gt; lose their LOB bindings, which causes LOB fields in the result set to
&gt; &gt; be returned blank.  Many of these LOB-handling bugs have been fixed
&gt; &gt; in
&gt; &gt; the past with DBD::mysql and DBD::Oracle, but looking at the
&gt; &gt; DBD::Oracle RT will reveal that several of these are still
&gt; &gt; outstanding.  Given the client I worked with on this bug has a older
&gt; &gt; DBD::Oracle that pre-dates some of the LOB handling fixes, and the
&gt; &gt; small occurrence of these issues &#40;0.1-0.4% of jobs&#41;, we believe this
&gt; &gt; bug is actually a result of LOB handling bugs in the DBD modules in
&gt; &gt; question.
&gt; &gt;
&gt; &gt; We will try to implement a deeper fix in Helios 2.8 by checking a job
&gt; &gt; object in the TheSchwartz layer before it is passed into the Helios
&gt; &gt; layers.  If a job object is received from the database with no args,
&gt; &gt; it can be discarded and another one selected.  But given that any
&gt; &gt; jobs
&gt; &gt; could be lost, even such a small number, we did not want to wait
&gt; &gt; until
&gt; &gt; Helios 2.8 is ready to implement *some* sort of fix.
&gt; &gt;
&gt; &gt; So for now, if you are experiencing this bug, update to the latest
&gt; &gt; Helios &#40;2.601_3750 for now, 2.61 will be out soon&#41; and update your
&gt; &gt; DBD
&gt; &gt; module to the latest release.
&gt; &gt;
&gt; &gt; On Sun Aug 11 17:48:19 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; A potential patch for this bug has been committed to GitHub:
&gt; &gt; &gt;
&gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1">https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1</a></span>
&gt; &gt; &gt;
&gt; &gt; &gt; If it passes testing, it will be rolled into a forthcoming bugfix
&gt; &gt; &gt; release.
&gt; &gt; &gt;
&gt; &gt; &gt; It should be noted, however, that this does not actually fix the
&gt; &gt; &gt; problem--it just handles the problem in a way that does not cause
&gt; &gt; &gt; non-
&gt; &gt; &gt; retrying jobs to disappear from the job queue.  This bug is
&gt; &gt; &gt; actually
&gt; &gt; &gt; being caused by TheSchwartz for some reason; TheSchwartz is passing
&gt; &gt; &gt; Helios::Service a TheSchwartz::Job object with an empty string for
&gt; &gt; &gt; arg&#40;&#41;, even though the job in question does indeed have job
&gt; &gt; &gt; arguments.
&gt; &gt; &gt; This causes Helios::Job-&gt;new&#40;&#41; to bomb when trying to start job
&gt; &gt; &gt; argument processing--it expects arg&#40;&#41; to return an arrayref, NOT a
&gt; &gt; &gt; string.  Changing Helios::Job to handle the empty string is the
&gt; &gt; &gt; wrong
&gt; &gt; &gt; idea--the job actually has arguments, Helios just didn&#39;t get them
&gt; &gt; &gt; &#40;thus, the copy of the job Helios was given is corrupted&#41;.  Trying
&gt; &gt; &gt; to
&gt; &gt; &gt; run a job while not having its arguments would be worse than not
&gt; &gt; &gt; running it at all.  This patch catches the error, logs a Critical
&gt; &gt; &gt; error to the Helios log, and the exits the worker process.  That
&gt; &gt; &gt; way,
&gt; &gt; &gt; TheSchwartz will not force a failure of the job &#40;which it will do
&gt; &gt; &gt; if
&gt; &gt; &gt; a
&gt; &gt; &gt; worker doesn&#39;t mark a job as successful or failed&#41; and the job will
&gt; &gt; &gt; stay in the job queue until its grabbed_until expires and another
&gt; &gt; &gt; worker process picks it up.
&gt; &gt; &gt;
&gt; &gt; &gt; Further future investigation will hopefully reveal the core reason
&gt; &gt; &gt; for
&gt; &gt; &gt; this bug, but this patch at least ensures job integrity and system
&gt; &gt; &gt; reliability.
&gt; &gt; &gt;
&gt; &gt; &gt; On Fri Aug 09 17:13:20 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; Sometimes when a worker process picks up a job, it fails with:
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in
&gt; &gt; &gt; &gt; &gt; use
&gt; &gt; &gt; &gt; &gt; at
&gt; &gt; &gt; &gt; &gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; in the ERROR table.  No success or failure messages are
&gt; &gt; &gt; &gt; &gt; reported
&gt; &gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; &gt; job
&gt; &gt; &gt; &gt; &gt; history.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; The job is picked up later by another process and completes
&gt; &gt; &gt; &gt; &gt; successfully.
</div>&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; A GitHub branch has been created for this bug:
&gt; &gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/tree/bug/rt79690">https://github.com/logicalhelion/helios/tree/bug/rt79690</a></span>
&gt; &gt; &gt; &gt;
</div></div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1275933" href="/Public/Bug/Display.html?id=79690#txn-1275933">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;16&nbsp;20:08:03&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.61 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1275934" href="/Public/Bug/Display.html?id=79690#txn-1275934">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;16&nbsp;20:08:03&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.71_3860 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1275935" href="/Public/Bug/Display.html?id=79690#txn-1275935">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;16&nbsp;20:08:03&nbsp;2013</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.71_4051 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1338833" href="/Public/Bug/Display.html?id=79690#txn-1338833">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;22:12:55&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1338833/710374/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/710374">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 16 20:08:02 2013, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The workaround for this bug included with Helios::TS in 2.71_4051
&gt; appears to fix this problem.  It will be included in the forthcoming
&gt; Helios 2.80 production release.
&gt; 
&gt; Helios::TS-&gt;_grab_a_job&#40;&#41; checks a job object before it is &#34;grabbed&#34;
&gt; &#40;the job is locked in the queue for processing&#41; and makes sure the
&gt; arg&#40;&#41; method is reporting a reference to a data structure.  If arg&#40;&#41;
&gt; does not return a reference, _grab_a_job&#40;&#41; skips that job and pulls
&gt; the next one from the array of jobs retrieved from the job queue.
&gt; This way, any LOB-binding problem resulting in a blank arg&#40;&#41; value
&gt; will be avoided.
&gt; 
&gt; On Sat Sep 14 19:00:29 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; On Fri Sep 13 17:17:39 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; The main problem with this bug is it can cause jobs submitted to
&gt; &gt; &gt; Helios to be lost without being run.  With Helios services that do
&gt; &gt; &gt; not
&gt; &gt; &gt; retry failed jobs &#40;using MaxRetries&#40;&#41; and RetryInterval&#40;&#41;&#41;, when
&gt; &gt; &gt; this
&gt; &gt; &gt; bug occurs the job will effectively disappear from the job queue
&gt; &gt; &gt; without being passed to the service&#39;s run&#40;&#41; and without any job
&gt; &gt; &gt; history being recorded.  &#40;BAD!&#41;
&gt; &gt; &gt;
&gt; &gt; &gt; For services that retry failed jobs, it just means one of the
&gt; &gt; &gt; retries
&gt; &gt; &gt; will be delayed for grab_for&#40;&#41; seconds &#40;default: 3600&#41;.
&gt; &gt; &gt;
&gt; &gt; &gt; The patch included in the 2.601* series prevents the &#34;lost job&#34;
&gt; &gt; &gt; problem by shutting down the worker process before the corrupt
&gt; &gt; &gt; TheSchwartz::Job is inflated to a Helios::Job.  Thus, no jobs will
&gt; &gt; &gt; be
&gt; &gt; &gt; lost, period.  The grab_for&#40;&#41; delay will still happen, but there
&gt; &gt; &gt; will
&gt; &gt; &gt; be NO lost jobs.
&gt; &gt; &gt;
&gt; &gt; &gt; An actual fix requires a better explanation:
&gt; &gt; &gt;
&gt; &gt; &gt; Apparently there is no problem with Helios, TheSchwartz, or even
&gt; &gt; &gt; Data::ObjectDriver.  The problem appears to be either with the
&gt; &gt; &gt; DBD::
&gt; &gt; &gt; modules in question.  At certain times some database queries appear
&gt; &gt; &gt; to
&gt; &gt; &gt; lose their LOB bindings, which causes LOB fields in the result set
&gt; &gt; &gt; to
&gt; &gt; &gt; be returned blank.  Many of these LOB-handling bugs have been fixed
&gt; &gt; &gt; in
&gt; &gt; &gt; the past with DBD::mysql and DBD::Oracle, but looking at the
&gt; &gt; &gt; DBD::Oracle RT will reveal that several of these are still
&gt; &gt; &gt; outstanding.  Given the client I worked with on this bug has a
&gt; &gt; &gt; older
&gt; &gt; &gt; DBD::Oracle that pre-dates some of the LOB handling fixes, and the
&gt; &gt; &gt; small occurrence of these issues &#40;0.1-0.4% of jobs&#41;, we believe
&gt; &gt; &gt; this
&gt; &gt; &gt; bug is actually a result of LOB handling bugs in the DBD modules in
&gt; &gt; &gt; question.
&gt; &gt; &gt;
&gt; &gt; &gt; We will try to implement a deeper fix in Helios 2.8 by checking a
&gt; &gt; &gt; job
&gt; &gt; &gt; object in the TheSchwartz layer before it is passed into the Helios
&gt; &gt; &gt; layers.  If a job object is received from the database with no
&gt; &gt; &gt; args,
&gt; &gt; &gt; it can be discarded and another one selected.  But given that any
&gt; &gt; &gt; jobs
&gt; &gt; &gt; could be lost, even such a small number, we did not want to wait
&gt; &gt; &gt; until
&gt; &gt; &gt; Helios 2.8 is ready to implement *some* sort of fix.
&gt; &gt; &gt;
&gt; &gt; &gt; So for now, if you are experiencing this bug, update to the latest
&gt; &gt; &gt; Helios &#40;2.601_3750 for now, 2.61 will be out soon&#41; and update your
&gt; &gt; &gt; DBD
&gt; &gt; &gt; module to the latest release.
&gt; &gt; &gt;
&gt; &gt; &gt; On Sun Aug 11 17:48:19 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; A potential patch for this bug has been committed to GitHub:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1">https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1</a></span>
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; If it passes testing, it will be rolled into a forthcoming bugfix
&gt; &gt; &gt; &gt; release.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; It should be noted, however, that this does not actually fix the
&gt; &gt; &gt; &gt; problem--it just handles the problem in a way that does not cause
&gt; &gt; &gt; &gt; non-
&gt; &gt; &gt; &gt; retrying jobs to disappear from the job queue.  This bug is
&gt; &gt; &gt; &gt; actually
&gt; &gt; &gt; &gt; being caused by TheSchwartz for some reason; TheSchwartz is
&gt; &gt; &gt; &gt; passing
&gt; &gt; &gt; &gt; Helios::Service a TheSchwartz::Job object with an empty string
&gt; &gt; &gt; &gt; for
&gt; &gt; &gt; &gt; arg&#40;&#41;, even though the job in question does indeed have job
&gt; &gt; &gt; &gt; arguments.
&gt; &gt; &gt; &gt; This causes Helios::Job-&gt;new&#40;&#41; to bomb when trying to start job
&gt; &gt; &gt; &gt; argument processing--it expects arg&#40;&#41; to return an arrayref, NOT
&gt; &gt; &gt; &gt; a
&gt; &gt; &gt; &gt; string.  Changing Helios::Job to handle the empty string is the
&gt; &gt; &gt; &gt; wrong
&gt; &gt; &gt; &gt; idea--the job actually has arguments, Helios just didn&#39;t get them
&gt; &gt; &gt; &gt; &#40;thus, the copy of the job Helios was given is corrupted&#41;.
&gt; &gt; &gt; &gt; Trying
&gt; &gt; &gt; &gt; to
&gt; &gt; &gt; &gt; run a job while not having its arguments would be worse than not
&gt; &gt; &gt; &gt; running it at all.  This patch catches the error, logs a Critical
&gt; &gt; &gt; &gt; error to the Helios log, and the exits the worker process.  That
&gt; &gt; &gt; &gt; way,
&gt; &gt; &gt; &gt; TheSchwartz will not force a failure of the job &#40;which it will do
&gt; &gt; &gt; &gt; if
&gt; &gt; &gt; &gt; a
&gt; &gt; &gt; &gt; worker doesn&#39;t mark a job as successful or failed&#41; and the job
&gt; &gt; &gt; &gt; will
&gt; &gt; &gt; &gt; stay in the job queue until its grabbed_until expires and another
&gt; &gt; &gt; &gt; worker process picks it up.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Further future investigation will hopefully reveal the core
&gt; &gt; &gt; &gt; reason
&gt; &gt; &gt; &gt; for
&gt; &gt; &gt; &gt; this bug, but this patch at least ensures job integrity and
&gt; &gt; &gt; &gt; system
&gt; &gt; &gt; &gt; reliability.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; On Fri Aug 09 17:13:20 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; &gt; Sometimes when a worker process picks up a job, it fails
&gt; &gt; &gt; &gt; &gt; &gt; with:
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34; in
&gt; &gt; &gt; &gt; &gt; &gt; use
&gt; &gt; &gt; &gt; &gt; &gt; at
&gt; &gt; &gt; &gt; &gt; &gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; in the ERROR table.  No success or failure messages are
&gt; &gt; &gt; &gt; &gt; &gt; reported
&gt; &gt; &gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; &gt; &gt; job
&gt; &gt; &gt; &gt; &gt; &gt; history.
&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; The job is picked up later by another process and completes
&gt; &gt; &gt; &gt; &gt; &gt; successfully.
</div>&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; A GitHub branch has been created for this bug:
&gt; &gt; &gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/tree/bug/rt79690">https://github.com/logicalhelion/helios/tree/bug/rt79690</a></span>
&gt; &gt; &gt; &gt; &gt;
</div></div></div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1338834" href="/Public/Bug/Display.html?id=79690#txn-1338834">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;22:12:55&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.71_4250 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1338835" href="/Public/Bug/Display.html?id=79690#txn-1338835">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;22:12:55&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.71_4350 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1338836" href="/Public/Bug/Display.html?id=79690#txn-1338836">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;22:12:55&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.71_4460 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1338837" href="/Public/Bug/Display.html?id=79690#txn-1338837">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;22:12:56&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.71_4770 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1338838" href="/Public/Bug/Display.html?id=79690#txn-1338838">#</a>      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;22:12:56&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.72_0950 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1341701" href="/Public/Bug/Display.html?id=79690#txn-1341701">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;21&nbsp;17:17:48&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1341701/711930/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/711930">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Mar 15 22:12:55 2014, LAJANDY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Oct 16 20:08:02 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; The workaround for this bug included with Helios::TS in 2.71_4051
&gt; &gt; appears to fix this problem.  It will be included in the forthcoming
&gt; &gt; Helios 2.80 production release.
&gt; &gt;
&gt; &gt; Helios::TS-&gt;_grab_a_job&#40;&#41; checks a job object before it is &#34;grabbed&#34;
&gt; &gt; &#40;the job is locked in the queue for processing&#41; and makes sure the
&gt; &gt; arg&#40;&#41; method is reporting a reference to a data structure.  If arg&#40;&#41;
&gt; &gt; does not return a reference, _grab_a_job&#40;&#41; skips that job and pulls
&gt; &gt; the next one from the array of jobs retrieved from the job queue.
&gt; &gt; This way, any LOB-binding problem resulting in a blank arg&#40;&#41; value
&gt; &gt; will be avoided.
&gt; &gt;
&gt; &gt; On Sat Sep 14 19:00:29 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Fri Sep 13 17:17:39 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; The main problem with this bug is it can cause jobs submitted to
&gt; &gt; &gt; &gt; Helios to be lost without being run.  With Helios services that
&gt; &gt; &gt; &gt; do
&gt; &gt; &gt; &gt; not
&gt; &gt; &gt; &gt; retry failed jobs &#40;using MaxRetries&#40;&#41; and RetryInterval&#40;&#41;&#41;, when
&gt; &gt; &gt; &gt; this
&gt; &gt; &gt; &gt; bug occurs the job will effectively disappear from the job queue
&gt; &gt; &gt; &gt; without being passed to the service&#39;s run&#40;&#41; and without any job
&gt; &gt; &gt; &gt; history being recorded.  &#40;BAD!&#41;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; For services that retry failed jobs, it just means one of the
&gt; &gt; &gt; &gt; retries
&gt; &gt; &gt; &gt; will be delayed for grab_for&#40;&#41; seconds &#40;default: 3600&#41;.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; The patch included in the 2.601* series prevents the &#34;lost job&#34;
&gt; &gt; &gt; &gt; problem by shutting down the worker process before the corrupt
&gt; &gt; &gt; &gt; TheSchwartz::Job is inflated to a Helios::Job.  Thus, no jobs
&gt; &gt; &gt; &gt; will
&gt; &gt; &gt; &gt; be
&gt; &gt; &gt; &gt; lost, period.  The grab_for&#40;&#41; delay will still happen, but there
&gt; &gt; &gt; &gt; will
&gt; &gt; &gt; &gt; be NO lost jobs.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; An actual fix requires a better explanation:
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Apparently there is no problem with Helios, TheSchwartz, or even
&gt; &gt; &gt; &gt; Data::ObjectDriver.  The problem appears to be either with the
&gt; &gt; &gt; &gt; DBD::
&gt; &gt; &gt; &gt; modules in question.  At certain times some database queries
&gt; &gt; &gt; &gt; appear
&gt; &gt; &gt; &gt; to
&gt; &gt; &gt; &gt; lose their LOB bindings, which causes LOB fields in the result
&gt; &gt; &gt; &gt; set
&gt; &gt; &gt; &gt; to
&gt; &gt; &gt; &gt; be returned blank.  Many of these LOB-handling bugs have been
&gt; &gt; &gt; &gt; fixed
&gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; the past with DBD::mysql and DBD::Oracle, but looking at the
&gt; &gt; &gt; &gt; DBD::Oracle RT will reveal that several of these are still
&gt; &gt; &gt; &gt; outstanding.  Given the client I worked with on this bug has a
&gt; &gt; &gt; &gt; older
&gt; &gt; &gt; &gt; DBD::Oracle that pre-dates some of the LOB handling fixes, and
&gt; &gt; &gt; &gt; the
&gt; &gt; &gt; &gt; small occurrence of these issues &#40;0.1-0.4% of jobs&#41;, we believe
&gt; &gt; &gt; &gt; this
&gt; &gt; &gt; &gt; bug is actually a result of LOB handling bugs in the DBD modules
&gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; question.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; We will try to implement a deeper fix in Helios 2.8 by checking a
&gt; &gt; &gt; &gt; job
&gt; &gt; &gt; &gt; object in the TheSchwartz layer before it is passed into the
&gt; &gt; &gt; &gt; Helios
&gt; &gt; &gt; &gt; layers.  If a job object is received from the database with no
&gt; &gt; &gt; &gt; args,
&gt; &gt; &gt; &gt; it can be discarded and another one selected.  But given that any
&gt; &gt; &gt; &gt; jobs
&gt; &gt; &gt; &gt; could be lost, even such a small number, we did not want to wait
&gt; &gt; &gt; &gt; until
&gt; &gt; &gt; &gt; Helios 2.8 is ready to implement *some* sort of fix.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; So for now, if you are experiencing this bug, update to the
&gt; &gt; &gt; &gt; latest
&gt; &gt; &gt; &gt; Helios &#40;2.601_3750 for now, 2.61 will be out soon&#41; and update
&gt; &gt; &gt; &gt; your
&gt; &gt; &gt; &gt; DBD
&gt; &gt; &gt; &gt; module to the latest release.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; On Sun Aug 11 17:48:19 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; A potential patch for this bug has been committed to GitHub:
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1">https://github.com/logicalhelion/helios/commit/25654bbf106be0d91b4447c6e246fc16fe0026f1</a></span>
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; If it passes testing, it will be rolled into a forthcoming
&gt; &gt; &gt; &gt; &gt; bugfix
&gt; &gt; &gt; &gt; &gt; release.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; It should be noted, however, that this does not actually fix
&gt; &gt; &gt; &gt; &gt; the
&gt; &gt; &gt; &gt; &gt; problem--it just handles the problem in a way that does not
&gt; &gt; &gt; &gt; &gt; cause
&gt; &gt; &gt; &gt; &gt; non-
&gt; &gt; &gt; &gt; &gt; retrying jobs to disappear from the job queue.  This bug is
&gt; &gt; &gt; &gt; &gt; actually
&gt; &gt; &gt; &gt; &gt; being caused by TheSchwartz for some reason; TheSchwartz is
&gt; &gt; &gt; &gt; &gt; passing
&gt; &gt; &gt; &gt; &gt; Helios::Service a TheSchwartz::Job object with an empty string
&gt; &gt; &gt; &gt; &gt; for
&gt; &gt; &gt; &gt; &gt; arg&#40;&#41;, even though the job in question does indeed have job
&gt; &gt; &gt; &gt; &gt; arguments.
&gt; &gt; &gt; &gt; &gt; This causes Helios::Job-&gt;new&#40;&#41; to bomb when trying to start job
&gt; &gt; &gt; &gt; &gt; argument processing--it expects arg&#40;&#41; to return an arrayref,
&gt; &gt; &gt; &gt; &gt; NOT
&gt; &gt; &gt; &gt; &gt; a
&gt; &gt; &gt; &gt; &gt; string.  Changing Helios::Job to handle the empty string is the
&gt; &gt; &gt; &gt; &gt; wrong
&gt; &gt; &gt; &gt; &gt; idea--the job actually has arguments, Helios just didn&#39;t get
&gt; &gt; &gt; &gt; &gt; them
&gt; &gt; &gt; &gt; &gt; &#40;thus, the copy of the job Helios was given is corrupted&#41;.
&gt; &gt; &gt; &gt; &gt; Trying
&gt; &gt; &gt; &gt; &gt; to
&gt; &gt; &gt; &gt; &gt; run a job while not having its arguments would be worse than
&gt; &gt; &gt; &gt; &gt; not
&gt; &gt; &gt; &gt; &gt; running it at all.  This patch catches the error, logs a
&gt; &gt; &gt; &gt; &gt; Critical
&gt; &gt; &gt; &gt; &gt; error to the Helios log, and the exits the worker process.
&gt; &gt; &gt; &gt; &gt; That
&gt; &gt; &gt; &gt; &gt; way,
&gt; &gt; &gt; &gt; &gt; TheSchwartz will not force a failure of the job &#40;which it will
&gt; &gt; &gt; &gt; &gt; do
&gt; &gt; &gt; &gt; &gt; if
&gt; &gt; &gt; &gt; &gt; a
&gt; &gt; &gt; &gt; &gt; worker doesn&#39;t mark a job as successful or failed&#41; and the job
&gt; &gt; &gt; &gt; &gt; will
&gt; &gt; &gt; &gt; &gt; stay in the job queue until its grabbed_until expires and
&gt; &gt; &gt; &gt; &gt; another
&gt; &gt; &gt; &gt; &gt; worker process picks it up.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; Further future investigation will hopefully reveal the core
&gt; &gt; &gt; &gt; &gt; reason
&gt; &gt; &gt; &gt; &gt; for
&gt; &gt; &gt; &gt; &gt; this bug, but this patch at least ensures job integrity and
&gt; &gt; &gt; &gt; &gt; system
&gt; &gt; &gt; &gt; &gt; reliability.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; On Fri Aug 09 17:13:20 2013, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; &gt; On Mon Sep 17 09:13:21 2012, LAJANDY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; &gt; &gt; Sometimes when a worker process picks up a job, it fails
&gt; &gt; &gt; &gt; &gt; &gt; &gt; with:
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &#34;Can&#39;t use string &#40;&#34;&#34;&#41; as an ARRAY ref while &#34;strict refs&#34;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; &gt; &gt; &gt; use
&gt; &gt; &gt; &gt; &gt; &gt; &gt; at
&gt; &gt; &gt; &gt; &gt; &gt; &gt; /usr/lib/perl5/site_perl/5.8.8/Helios/Job.pm line 128.”
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; in the ERROR table.  No success or failure messages are
&gt; &gt; &gt; &gt; &gt; &gt; &gt; reported
&gt; &gt; &gt; &gt; &gt; &gt; &gt; in
&gt; &gt; &gt; &gt; &gt; &gt; &gt; job
&gt; &gt; &gt; &gt; &gt; &gt; &gt; history.
&gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; The job is picked up later by another process and completes
&gt; &gt; &gt; &gt; &gt; &gt; &gt; successfully.
</div>&gt; &gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; &gt; A GitHub branch has been created for this bug:
&gt; &gt; &gt; &gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/logicalhelion/helios/tree/bug/rt79690">https://github.com/logicalhelion/helios/tree/bug/rt79690</a></span>
&gt; &gt; &gt; &gt; &gt; &gt;
</div></div></div></div></div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1341702" href="/Public/Bug/Display.html?id=79690#txn-1341702">#</a>      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;21&nbsp;17:17:49&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1341703" href="/Public/Bug/Display.html?id=79690#txn-1341703">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;21&nbsp;17:17:49&nbsp;2014</span>
    <span class="description">LAJANDY [...] cpan.org -  Fixed in 2.80 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.37192</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
