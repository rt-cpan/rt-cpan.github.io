<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #7498 for DateTime-Format-Excel: DateTime-Format-Excel does not convert the seconds portion of an Excel Date/Time value</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #7498 for DateTime-Format-Excel: DateTime-Format-Excel does not convert the seconds portion of an Excel Date/Time value</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DateTime-Format-Excel/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DateTime-Format-Excel/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DateTime-Format-Excel/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DateTime-Format-Excel/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DateTime-Format-Excel">DateTime-Format-Excel CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">7498</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time estimated">
    <td class="label">Estimated:</td>
    <td class="value">3 hours (180 min)

</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">2 hours (120 min)

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DateTime-Format-Excel/Active/">DateTime-Format-Excel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">ABURS [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
john.lengeling [...] radisys.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
aburs [...] cpan.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-9872-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.26    </td>
  </tr>
  <tr id="CF-9873-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;27&nbsp;11:07:41&nbsp;2004</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> DateTime-Format-Excel does not convert the seconds portion of an
 Excel Date/Time value</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The DateTime-Format-Excel package will correctly convert the date portion of an Excel Date/Time format, but not the H:M:S.  The bug is in the parse_datetime function of Excel.pm

The H:M:S is stored as a fraction where 1 second = 1 / &#40;60*60*24&#41;.  I found useful information on this web page:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.mvps.org/dmcritchie/excel/datetime.htm">http://www.mvps.org/dmcritchie/excel/datetime.htm</a></span>

Here is a test script that I used:

#!/usr/local/bin/perl

use strict;
use Spreadsheet::ParseExcel::Simple;
use DateTime::Format::Excel;
my $days;
my $secs;

my $curtime = &#34;37987.0000115741&#34;;
$curtime =~ /^ &#40;\d+ &#40;?: &#40;\.\d+&#41; &#41;? &#41; $/x;
print &#34;days = $1\n&#34;;
print &#34;secs = $2\n&#34;;

my $datetime = DateTime::Format::Excel-&gt;parse_datetime&#40;$curtime&#41;;
print $datetime-&gt;strftime&#40;&#34;%F %r&#34;&#41; . &#34;\n&#34;;
print $datetime-&gt;strftime&#40;&#34;%F %T&#34;&#41; . &#34;\n&#34;;
print $datetime-&gt;strftime&#40;&#34;%F %z&#34;&#41; . &#34;\n&#34;;

Attached are the changes I made to the .2901 version of Excel.pm to fix the problem.

Environment:

Solaris 2.8, Perl v5.6.1 
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">package DateTime::Format::Excel;
# $Id: Excel.pm,v 1.6 2004/01/26 19:04:02 autarch Exp $

=head1 NAME

DateTime::Format::Excel - Convert between DateTime and Excel dates.

=cut

use strict;
use 5.005;
use Carp;
use DateTime 0.1705;
use vars qw&#40; $VERSION &#41;;

$VERSION = &#39;0.2901&#39;;

=head1 SYNOPSIS

    use DateTime::Format::Excel;

    # From Excel via class method:

    my $datetime = DateTime::Format::Excel-&gt;parse_datetime&#40; 37680 &#41;;
    print $datetime-&gt;ymd&#40;&#39;.&#39;&#41;; # &#39;2003.02.28&#39;

    #  or via an object
    
    my $excel = DateTime::Format::Excel-&gt;new&#40;&#41;;
    print $excel-&gt;parse_datetime&#40; 25569 &#41;-&gt;ymd; # &#39;1970-01-01&#39;

    # Back to Excel number:
    
    use DateTime;
    my $dt = DateTime-&gt;new&#40; year =&gt; 1979, month =&gt; 7, day =&gt; 16 &#41;;
    my $daynum = DateTime::Format::Excel-&gt;format_datetime&#40; $dt &#41;;
    print $daynum; # 29052

    # or via an object
    my $other_daynum = $excel-&gt;format_datetime&#40; $dt &#41;;
    print $other_daynum; # 29052

=head1 DESCRIPTION

Excel uses a different system for its dates than most Unix programs.
This module allows you to convert between a few of the Excel raw formats
and C&lt;DateTime&gt; objects, which can then be further converted via any
of the other C&lt;DateTime::Format::*&gt; modules, or just with C&lt;DateTime&gt;&#39;s
methods.

If you happen to be dealing with dates between S&lt;1 Jan 1900&gt; and
S&lt;1 Mar 1900&gt; please read the notes on L&lt;epochs|/EPOCHS&gt;.


If you&#39;re wanting to handle actual spreadsheet files, you may find
L&lt;Spreadsheet::WriteExcel&gt; and L&lt;Spreadsheet::ParseExcel&gt; of use.

=head1 CONSTRUCTORS

=head2 new

Creates a new C&lt;DateTime::Format::Excel&gt; instance. This is generally
not required for simple operations. If you wish to use a different
epoch, however, then you&#39;ll need to create an object.

   my $excel = DateTime::Format::Excel-&gt;new&#40;&#41;
   my $copy = $excel-&gt;new&#40;&#41;;

It takes no parameters. If called on an existing object then it
clones the object.

=cut

sub new
{
    my $class = shift;
    croak &#34;${class}-&gt;new takes no parameters.&#34; if @_;

    my $self = bless {}, ref&#40;$class&#41;||$class;
    if &#40;ref $class&#41;
    {
	# If called on an object, clone
	$self-&gt;_epoch&#40; scalar $class-&gt;epoch &#41;;
	# and that&#39;s it. we don&#39;t store that much info per object
    }

    $self;
}

=head2 clone

This method is provided For those who prefer to explicitly clone via a
method called C&lt;clone&#40;&#41;&gt;. If called as a class method it will die.

   my $clone = $original-&gt;clone&#40;&#41;;

=cut

sub clone
{
    my $self = shift;
    croak &#39;Calling object method as class method!&#39; unless ref $self;
    return $self-&gt;new&#40;&#41;;
}

=head1 CLASS/OBJECT METHODS

These methods work as both class and object methods.

=head2 parse_datetime

Given an Excel day number, return a C&lt;DateTime&gt; object representing that
date and time.

    # As a class method
    my $datetime = DateTime::format::Excel-&gt;parse_datetime&#40; 37680 &#41;;
    print $datetime-&gt;ymd&#40;&#39;.&#39;&#41;; # &#39;2003.02.28&#39;

    # Or via an object
    my $excel = DateTime::Format::Excel-&gt;new&#40;&#41;;
    my $viaobj $excel-&gt;parse_datetime&#40; 25569 &#41;;
    print $viaobj-&gt;ymd; # &#39;1970-01-01&#39;

=cut

sub parse_datetime
{
    my $self = shift;
    croak &#39;No date specified.&#39; unless @_;
    #croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?: \.\d+ &#41;? &#41; $/x;
    croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?: &#40;\.\d+&#41; &#41;? &#41; $/x;
    my $days = $1;
    my $secs = $2 * 86400;

    my $dt = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
    $dt-&gt;add&#40; days =&gt; $days, seconds =&gt; $secs &#41;;

    return $dt;
}

=head2 format_datetime

Given a C&lt;DateTime&gt; object, return the Excel daynum time.

    use DateTime;
    my $dt = DateTime-&gt;new&#40; year =&gt; 1979, month =&gt; 7, day =&gt; 16 &#41;;
    my $daynum = DateTime::Format::Excel-&gt;format_datetime&#40; $dt &#41;;
    print $daynum; # 29052

    # or via an object
    my $excel = DateTime::Format::Excel-&gt;new&#40;&#41;;
    $excel-&gt;epoch_mac&#40;&#41;; # Let&#39;s imagine we want the Mac number
    my $mac_daynum = $excel-&gt;format_datetime&#40; $dt &#41;;
    print $mac_daynum; # 27590


=cut

sub format_datetime
{
    my $self = shift;
    croak &#39;No DateTime object specified.&#39; unless @_;
    my $dt = shift;

    my $base = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
    my $excel = int&#40; $dt-&gt;jd - $base-&gt;jd &#41;;

    return $excel;
}

=begin _development

=head1 BETA METHODS

I don&#39;t really know whether durations should be handled by this module.
They&#39;re nothing interesting.

=cut

sub parse_duration
{
    my $self = shift;
    croak &#39;No duration specified.&#39; unless @_;
    croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?: \.\d+ &#41;? &#41; $/x;
    my $days = $1;

    return DateTime::Duration-&gt;new&#40; days =&gt; $days &#41;;
}

sub format_duration
{
    my $self = shift;
    croak &#39;No DateTime::Duration object specified.&#39; unless @_;

    return $_[0]-&gt;delta_days&#40;&#41;;
}

=end _development

=head1 OBJECT METHODS

=head2 epoch

In scalar context, returns a string identifying the current epoch.

   my $epoch = $excel-&gt;epoch&#40;&#41;;

Currently either `mac&#39; or `win&#39; with the default being `win&#39;.

In list context, returns appropriate parameters with which to
create a C&lt;DateTime&gt; object representing the start of the epoch.

   my $base = DateTime-&gt;new&#40; $excel-&gt;epoch &#41;;

=cut

sub epoch { $_[0]-&gt;_epoch&#40;&#41; }

=head2 epoch_mac

Set the object to use a Macintosh epoch.

   $excel-&gt;epoch_mac&#40;&#41;; # epoch is now  1 Jan 1904

Thus, 1 maps to C&lt;2 Jan 1904&gt;.

=cut

sub epoch_mac { $_[0]-&gt;_epoch&#40;&#39;mac&#39;&#41; }

=head2 epoch_win

Set the object to use a Windows Excel epoch.

   $excel-&gt;epoch_win&#40;&#41;; # epoch is now 30 Dec 1899

Thus, 2 maps to C&lt;1 Jan 1900&gt;.

=cut

sub epoch_win { $_[0]-&gt;_epoch&#40;&#39;win&#39;&#41; }

=head1 EPOCHS

Excel uses ``number of days since S&lt;31 Dec 1899&gt;&#39;&#39;. Naturally, Microsoft
messed this up because they happened to believe that 1900 was a leap
year. In this module, we assume what Psion assumed for their Abacus /
Sheet program: S&lt;1 Jan 1900&gt; maps to 2 rather than 1. Thus, 61 maps to
S&lt;1 Mar 1900&gt; in both Excel and this module &#40;and Abacus&#41;.

I&lt;Excel for Macintosh&gt; has a little option hidden away in its
calculations preferences. It can use either the Windows epoch, or it can
use the Macintosh epoch, which means that the day number is calculated
as ``number of days since S&lt; 1 Jan 1904&gt;&#39;&#39;. This module supports both
notations.

B&lt;Note&gt;: the results of this module have only been compared with
I&lt;Microsoft Excel for Macintosh 98&gt; and I&lt;Abacus&gt; on the
I&lt;Acorn Pocket Book&gt;. Where they have differed, I&#39;ve opted for I&lt;Abacus&gt;&#39;s
result rather than I&lt;Excel&gt;&#39;s.

=cut

{
    my %epochs = &#40;
	win =&gt; [ year =&gt; 1899, month =&gt; 12, day =&gt; 30 ],
	mac =&gt; [ year =&gt; 1904, month =&gt; 1, day =&gt; 1 ],
    &#41;;

    sub _epoch
    {
	my $self = shift;
	if &#40;@_&#41;
	{
	    croak &#39;Calling object method as class method!&#39; unless ref $self;
	    croak &#39;Invalid epoch&#39; unless exists $epochs{$_[0]};
	    $self-&gt;{epoch} = $_[0];
	    return $self; # more useful this way, I feel.
	}
	else
	{
	    my $epoch;
	    $epoch = $self-&gt;{epoch} if ref $self;
	    $epoch ||= &#39;win&#39;;
	    return wantarray ? @{ $epochs{$epoch} } : $epoch;
	}
    }
}

1;

__END__

=head1 THANKS

Dave Rolsky &#40;DROLSKY&#41; for kickstarting the DateTime project.

=head1 SUPPORT

Support for this module is provided via the datetime@perl.org email
list. See <span class="clickylink"><a target="new" rel="nofollow" href="http://lists.perl.org/">http://lists.perl.org/</a></span> for more details.

Alternatively, log them via the CPAN RT system via the web or email:

    <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/NoAuth/ReportBug.html?Queue=DateTime%3A%3AFormat%3A%3AExcel">http://rt.cpan.org/NoAuth/ReportBug.html?Queue=DateTime%3A%3AFormat%3A%3AExcel</a></span>
    bug-datetime-format-excel@rt.cpan.org

This makes it much easier for me to track things and thus means
your problem is less likely to be neglected.

=head1 LICENCE AND COPYRIGHT

Copyright E&lt;copy&gt; 2003 Iain Truskett. All rights reserved. This library
is free software; you can redistribute it and/or modify it under the
same terms as Perl itself.

The full text of the licences can be found in the F&lt;Artistic&gt; and
F&lt;COPYING&gt; files included with this module.

=head1 AUTHOR

Originally written by Iain Truskett &lt;spoon@cpan.org&gt;, who died on
December 29, 2003.

Maintained by Dave Rolsky &lt;autarch@urth.org&gt;.

=head1 SEE ALSO

datetime@perl.org mailing list.

<span class="clickylink"><a target="new" rel="nofollow" href="http://datetime.perl.org/">http://datetime.perl.org/</a></span>

L&lt;perl&gt;, L&lt;DateTime&gt;, L&lt;Spreadsheet::WriteExcel&gt;

=cut
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;09&nbsp;10:08:11&nbsp;2004</span>
    <span class="description">DROLSKY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">[guest - Fri Aug 27 11:07:41 2004]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The DateTime-Format-Excel package will correctly convert the date
&gt;    portion of an Excel Date/Time format, but not the H:M:S.  The bug
&gt;    is in the parse_datetime function of Excel.pm
&gt; 
&gt; The H:M:S is stored as a fraction where 1 second = 1 / &#40;60*60*24&#41;.  I
&gt;    found useful information on this web page:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.mvps.org/dmcritchie/excel/datetime.htm">http://www.mvps.org/dmcritchie/excel/datetime.htm</a></span>
&gt; 
&gt; Here is a test script that I used:
&gt; 
&gt; #!/usr/local/bin/perl
&gt; 
&gt; use strict;
&gt; use Spreadsheet::ParseExcel::Simple;
&gt; use DateTime::Format::Excel;
&gt; my $days;
&gt; my $secs;
&gt; 
&gt; my $curtime = &#34;37987.0000115741&#34;;
&gt; $curtime =~ /^ &#40;\d+ &#40;?: &#40;\.\d+&#41; &#41;? &#41; $/x;
&gt; print &#34;days = $1\n&#34;;
&gt; print &#34;secs = $2\n&#34;;
&gt; 
&gt; my $datetime = DateTime::Format::Excel-&gt;parse_datetime&#40;$curtime&#41;;
&gt; print $datetime-&gt;strftime&#40;&#34;%F %r&#34;&#41; . &#34;\n&#34;;
&gt; print $datetime-&gt;strftime&#40;&#34;%F %T&#34;&#41; . &#34;\n&#34;;
&gt; print $datetime-&gt;strftime&#40;&#34;%F %z&#34;&#41; . &#34;\n&#34;;
&gt; 
&gt; Attached are the changes I made to the .2901 version of Excel.pm to
&gt;    fix the problem.
</div>
If you could send this in the form of a patch, I&#39;d probably be
interested in applying it.  A patch that included doc and test updates
would be even better ;&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;22&nbsp;14:04:53&nbsp;2004</span>
    <span class="description">DROLSKY [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;11&nbsp;07:14:25&nbsp;2007</span>
    <span class="description">cpan [...] pjedwards.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> cpan [...] pjedwards.co.uk</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Sep 09 10:08:11 2004, DROLSKY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [guest - Fri Aug 27 11:07:41 2004]:
&gt; 
<div class="message-stanza open">&gt; &gt; The DateTime-Format-Excel package will correctly convert the date
&gt; &gt;    portion of an Excel Date/Time format, but not the H:M:S.  The bug
&gt; &gt;    is in the parse_datetime function of Excel.pm
&gt; &gt; 
&gt; &gt; The H:M:S is stored as a fraction where 1 second = 1 / &#40;60*60*24&#41;.  I
&gt; &gt;    found useful information on this web page:
&gt; &gt; 
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.mvps.org/dmcritchie/excel/datetime.htm">http://www.mvps.org/dmcritchie/excel/datetime.htm</a></span>
&gt; &gt; 
&gt; &gt; Here is a test script that I used:
&gt; &gt; 
&gt; &gt; #!/usr/local/bin/perl
&gt; &gt; 
&gt; &gt; use strict;
&gt; &gt; use Spreadsheet::ParseExcel::Simple;
&gt; &gt; use DateTime::Format::Excel;
&gt; &gt; my $days;
&gt; &gt; my $secs;
&gt; &gt; 
&gt; &gt; my $curtime = &#34;37987.0000115741&#34;;
&gt; &gt; $curtime =~ /^ &#40;\d+ &#40;?: &#40;\.\d+&#41; &#41;? &#41; $/x;
&gt; &gt; print &#34;days = $1\n&#34;;
&gt; &gt; print &#34;secs = $2\n&#34;;
&gt; &gt; 
&gt; &gt; my $datetime = DateTime::Format::Excel-&gt;parse_datetime&#40;$curtime&#41;;
&gt; &gt; print $datetime-&gt;strftime&#40;&#34;%F %r&#34;&#41; . &#34;\n&#34;;
&gt; &gt; print $datetime-&gt;strftime&#40;&#34;%F %T&#34;&#41; . &#34;\n&#34;;
&gt; &gt; print $datetime-&gt;strftime&#40;&#34;%F %z&#34;&#41; . &#34;\n&#34;;
&gt; &gt; 
&gt; &gt; Attached are the changes I made to the .2901 version of Excel.pm to
&gt; &gt;    fix the problem.
</div>&gt; 
&gt; If you could send this in the form of a patch, I&#39;d probably be
&gt; interested in applying it.  A patch that included doc and test updates
&gt; would be even better ;&#41;
</div>
Thanks for all the DateTime modules.

I also found myself adding support for H:M:S to this module.  Here is my
patch:

File DATETIME-FORMAT-EXCEL-0_29]T5440004970.TMP;1
  130       croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?:
\.\d+ &#41;? &#41; $/x;
  131       my $excel = $1;
  132
  133       my $dt = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
  134       $dt-&gt;add&#40; days =&gt; $excel &#41;;
  135
  136       return $dt;
******
File DATETIME-FORMAT-EXCEL-0_29.LIB.DATETIME.FORMAT]EXCEL.PM;21
  130       croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?:
&#40;\.\d+ &#41; &#41;? &#41; $/x;
  131       my $excel_days = $1;
  132       my $excel_secs = $2;
  133       my $dt = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
  134       if&#40;defined $excel_secs&#41;{
  135           $excel_secs = $excel_secs * 86400; # RT7498
  136           my $excel_nanoseconds = &#40;$excel_secs - int&#40;$excel_secs&#41;&#41;
* 1_000_000_000;
  137           $dt-&gt;add&#40; days        =&gt; $excel_days ,
  138                     seconds     =&gt; $excel_secs,
  139                     nanoseconds =&gt; $excel_nanoseconds&#41;;
  140       } else {
  141           $dt-&gt;add&#40; days =&gt; $excel_days &#41;;
  142       }
  143       return $dt;
************
************
File DATETIME-FORMAT-EXCEL-0_29]T5440004970.TMP;1
  164       my $excel = int&#40; $dt-&gt;jd - $base-&gt;jd &#41;;
  165
******
File DATETIME-FORMAT-EXCEL-0_29.LIB.DATETIME.FORMAT]EXCEL.PM;21
  171       my $excel = $dt-&gt;jd - $base-&gt;jd; # RT7498
  172
************

It differs from the original suggested patch in this bug as it takes
into account fractions of a second &#40;nanoseconds&#41;, without this I was
observing rounding behaviour.

Here is a test file:

type [.t]decimal.t
use strict;
use Test::More tests =&gt; 28;
use DateTime::Format::Excel;

my @test_data = &#40;
        {
        year    =&gt; 2003, month   =&gt;  2, day     =&gt; 28,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 37680,
        iso8601 =&gt; &#39;2003-02-28T00:00:00&#39;,
        },
        {
        year    =&gt; 1899, month   =&gt; 12, day     =&gt; 31,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 1,
        iso8601 =&gt; &#39;1899-12-31T00:00:00&#39;,
        },
        {
        year    =&gt; 1900, month   =&gt;  1, day     =&gt;  1,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 2,
        iso8601 =&gt; &#39;1900-01-01T00:00:00&#39;,
        },
        {
        year    =&gt; 1900, month   =&gt;  1, day     =&gt;  2,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 3,
        iso8601 =&gt; &#39;1900-01-02T00:00:00&#39;,
        },
        {
        year    =&gt; 1900, month   =&gt;  1, day     =&gt;  3,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 4,
        iso8601 =&gt; &#39;1900-01-03T00:00:00&#39;,
        },
        {
        year    =&gt; 1970, month   =&gt;  1, day     =&gt;  1,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 25569,
        iso8601 =&gt; &#39;1970-01-01T00:00:00&#39;,
        },
        {
        year    =&gt; 9999, month   =&gt; 12, day     =&gt; 31,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 2958465,
        iso8601 =&gt; &#39;9999-12-31T00:00:00&#39;,
        },
        {
        year    =&gt; 1900, month   =&gt;  2, day     =&gt; 28,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 60,
        iso8601 =&gt; &#39;1900-02-28T00:00:00&#39;,
        },
        {
        year    =&gt; 1900, month   =&gt;  3, day     =&gt;  1,
        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
        excel   =&gt; 61,
        iso8601 =&gt; &#39;1900-03-01T00:00:00&#39;,
        },
        {
        year    =&gt; 2007, month   =&gt;  9, day     =&gt;  9,
        hour    =&gt; 23,   minute  =&gt; 56, second  =&gt; 29,
        excel   =&gt; 39334.9975578706,
        iso8601 =&gt; &#39;2007-09-09T23:56:29&#39;,
        },
        {
        year    =&gt; 2007, month   =&gt;  9, day     =&gt;  9,
        hour    =&gt; 23,   minute  =&gt; 56, second  =&gt; 30,
        excel   =&gt; 39334.9975694446,
        iso8601 =&gt; &#39;2007-09-09T23:56:30&#39;,
        },
        {
        year    =&gt; 2007, month   =&gt;  9, day     =&gt;  9,
        hour    =&gt; 23,   minute  =&gt; 56, second  =&gt; 45,
        excel   =&gt; 39334.9977430557,
        iso8601 =&gt; &#39;2007-09-09T23:56:45&#39;,
        },
        {
        year    =&gt; 1985, month   =&gt; 10, day     =&gt; 26,
        hour    =&gt;  1,   minute  =&gt; 17, second  =&gt; 00,
        excel   =&gt; 31346.0534722223,
        iso8601 =&gt; &#39;1985-10-26T01:17:00&#39;,
        },
        {
        year    =&gt; 1955, month   =&gt; 11, day     =&gt; 12,
        hour    =&gt;  9,   minute  =&gt; 28, second  =&gt; 00,
        excel   =&gt; 20405.3944444442,
        iso8601 =&gt; &#39;1955-11-12T09:28:00&#39;,
        },
&#41;;

foreach my $test_data &#40;@test_data&#41;{
        my $dt = DateTime-&gt;new&#40;
                year   =&gt; $test_data-&gt;{year},
                month  =&gt; $test_data-&gt;{month},
                day    =&gt; $test_data-&gt;{day},
                hour   =&gt; $test_data-&gt;{hour},
                minute =&gt; $test_data-&gt;{minute},
                second =&gt; $test_data-&gt;{second}
        &#41;;
        my $got_excel   = DateTime::Format::Excel-&gt;format_datetime&#40; $dt &#41;;
        is &#40; $got_excel =&gt; $test_data-&gt;{excel} , &#34; \$got_excel
&#40;$got_excel&#41; ~ excel &#40;$test_data-&gt;{excel}&#41;&#34;&#41;;
        my $got_dt      = DateTime::Format::Excel-&gt;parse_datetime&#40;
$test_data-&gt;{excel} &#41;;
        my $got_iso8601 = $got_dt-&gt;iso8601&#40;&#41;;
        is &#40; $got_iso8601 =&gt; $test_data-&gt;{iso8601} , &#34; \$got_iso8601
&#40;$got_iso8601&#41; ~ iso8601 &#40;$test_data-&gt;{iso8601}&#41;&#34;&#41;;
}

Let me know if you would prefer a patch in a different format.

Anyone using this with DateTime objects that have H:M:S:N specified and
these are not 0:0:0:0, will now get a floating point number back,
previously the number was rounded to an int.
&#40;I can&#39;t see any other dists requiring this module:
<span class="clickylink"><a target="new" rel="nofollow" href="http://cpants.perl.org/dist/DateTime-Format-Excel&#41;">http://cpants.perl.org/dist/DateTime-Format-Excel&#41;</a></span>

Cheers,
Peter &#40;Stig&#41; Edwards
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;11&nbsp;07:14:30&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;11&nbsp;10:48:34&nbsp;2007</span>
    <span class="description">autarch [...] urth.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #7498] DateTime-Format-Excel does not convert the seconds portion of an Excel Date/Time value </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 11 Sep 2007 09:37:54 -0500 &#40;CDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;cpan [...] pjedwards.co.uk via RT&#34; &lt;bug-DateTime-Format-Excel [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Rolsky &lt;autarch [...] urth.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 11 Sep 2007, cpan@pjedwards.co.uk via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I also found myself adding support for H:M:S to this module.  Here is my
&gt; patch:
&gt;
&gt; File DATETIME-FORMAT-EXCEL-0_29]T5440004970.TMP;1
&gt;  130       croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?:
&gt; \.\d+ &#41;? &#41; $/x;
&gt;  131       my $excel = $1;
&gt;  132
&gt;  133       my $dt = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
&gt;  134       $dt-&gt;add&#40; days =&gt; $excel &#41;;
&gt;  135
&gt;  136       return $dt;
&gt; ******
&gt; File DATETIME-FORMAT-EXCEL-0_29.LIB.DATETIME.FORMAT]EXCEL.PM;21
&gt;  130       croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?:
&gt; &#40;\.\d+ &#41; &#41;? &#41; $/x;
&gt;  131       my $excel_days = $1;
&gt;  132       my $excel_secs = $2;
&gt;  133       my $dt = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
&gt;  134       if&#40;defined $excel_secs&#41;{
&gt;  135           $excel_secs = $excel_secs * 86400; # RT7498
&gt;  136           my $excel_nanoseconds = &#40;$excel_secs - int&#40;$excel_secs&#41;&#41;
&gt; * 1_000_000_000;
&gt;  137           $dt-&gt;add&#40; days        =&gt; $excel_days ,
&gt;  138                     seconds     =&gt; $excel_secs,
&gt;  139                     nanoseconds =&gt; $excel_nanoseconds&#41;;
&gt;  140       } else {
&gt;  141           $dt-&gt;add&#40; days =&gt; $excel_days &#41;;
&gt;  142       }
&gt;  143       return $dt;
</div>
That&#39;s a very weird &#34;patch&#34;. Did you generate it with the diff progrma? If 
not, can you use &#34;diff -Nru&#34; to make a proper patch for the whole distro 
&#40;so as to include the new test&#41;.


-dave

/*===================================================
VegGuide.Org                        www.BookIRead.com
Your guide to all that&#39;s veg.       My book blog
===================================================*/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;11&nbsp;16:59:40&nbsp;2007</span>
    <span class="description">cpan [...] pjedwards.co.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; That&#39;s a very weird &#34;patch&#34;. Did you generate it with the diff
</div>progrma? If 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; not, can you use &#34;diff -Nru&#34; to make a proper patch for the whole distro 
&gt; &#40;so as to include the new test&#41;.
&gt; 
&gt; -dave
</div>
I was on VMS.  Here is the &#34;diff -Nru&#34; done on Linux against version 0.2901

Cheers,
Peter &#40;Stig&#41; Edwards
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -Nru ../DateTime-Format-Excel-0.2901_orig/MANIFEST ./MANIFEST
--- ../DateTime-Format-Excel-0.2901_orig/MANIFEST       2004-01-26 14:06:42.000000000 -0500
+++ ./MANIFEST  2007-09-11 16:40:04.000000000 -0400
@@ -14,5 +14,6 @@
 t/00signature.t
 t/basic.t
 t/clone.t
+t/decimal.t

 SIGNATURE    Added here by Module::Build
diff -Nru ../DateTime-Format-Excel-0.2901_orig/lib/DateTime/Format/Excel.pm ./lib/DateTime/Format/Excel.pm
--- ../DateTime-Format-Excel-0.2901_orig/lib/DateTime/Format/Excel.pm   2004-01-26 14:04:02.000000000 -0500
+++ ./lib/DateTime/Format/Excel.pm      2007-09-11 16:42:14.000000000 -0400
@@ -127,12 +127,19 @@
 {
     my $self = shift;
     croak &#39;No date specified.&#39; unless @_;
-    croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?: \.\d+ &#41;? &#41; $/x;
-    my $excel = $1;
-
+    croak &#39;Invalid number of days&#39; unless $_[0] =~ /^ &#40;\d+ &#40;?: &#40;\.\d+ &#41; &#41;? &#41; $/x;
+    my $excel_days = $1;
+    my $excel_secs = $2;
     my $dt = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
-    $dt-&gt;add&#40; days =&gt; $excel &#41;;
-
+    if&#40;defined $excel_secs&#41;{
+       $excel_secs           = $excel_secs * 86400; # RT7498
+       my $excel_nanoseconds = &#40;$excel_secs - int&#40;$excel_secs&#41;&#41; * 1_000_000_000;
+       $dt-&gt;add&#40; days        =&gt; $excel_days,
+                 seconds     =&gt; $excel_secs,
+                 nanoseconds =&gt; $excel_nanoseconds&#41;;
+    } else {
+       $dt-&gt;add&#40; days =&gt; $excel_days &#41;;
+    }
     return $dt;
 }

@@ -161,7 +168,7 @@
     my $dt = shift;

     my $base = DateTime-&gt;new&#40; $self-&gt;epoch &#41;;
-    my $excel = int&#40; $dt-&gt;jd - $base-&gt;jd &#41;;
+    my $excel = $dt-&gt;jd - $base-&gt;jd; # RT7498

     return $excel;
 }
diff -Nru ../DateTime-Format-Excel-0.2901_orig/t/decimal.t ./t/decimal.t
--- ../DateTime-Format-Excel-0.2901_orig/t/decimal.t    1969-12-31 19:00:00.000000000 -0500
+++ ./t/decimal.t       2007-09-11 16:39:13.000000000 -0400
@@ -0,0 +1,106 @@
+use strict;
+use Test::More tests =&gt; 28;
+use DateTime::Format::Excel;
+
+my @test_data = &#40;
+        {
+        year    =&gt; 2003, month   =&gt;  2, day     =&gt; 28,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 37680,
+        iso8601 =&gt; &#39;2003-02-28T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 1899, month   =&gt; 12, day     =&gt; 31,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 1,
+        iso8601 =&gt; &#39;1899-12-31T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 1900, month   =&gt;  1, day     =&gt;  1,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 2,
+        iso8601 =&gt; &#39;1900-01-01T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 1900, month   =&gt;  1, day     =&gt;  2,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 3,
+        iso8601 =&gt; &#39;1900-01-02T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 1900, month   =&gt;  1, day     =&gt;  3,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 4,
+        iso8601 =&gt; &#39;1900-01-03T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 1970, month   =&gt;  1, day     =&gt;  1,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 25569,
+        iso8601 =&gt; &#39;1970-01-01T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 9999, month   =&gt; 12, day     =&gt; 31,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 2958465,
+        iso8601 =&gt; &#39;9999-12-31T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 1900, month   =&gt;  2, day     =&gt; 28,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 60,
+        iso8601 =&gt; &#39;1900-02-28T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 1900, month   =&gt;  3, day     =&gt;  1,
+        hour    =&gt;  0,   minute  =&gt;  0, second  =&gt;  0,
+        excel   =&gt; 61,
+        iso8601 =&gt; &#39;1900-03-01T00:00:00&#39;,
+        },
+        {
+        year    =&gt; 2007, month   =&gt;  9, day     =&gt;  9,
+        hour    =&gt; 23,   minute  =&gt; 56, second  =&gt; 29,
+        excel   =&gt; 39334.9975578706,
+        iso8601 =&gt; &#39;2007-09-09T23:56:29&#39;,
+        },
+        {
+        year    =&gt; 2007, month   =&gt;  9, day     =&gt;  9,
+        hour    =&gt; 23,   minute  =&gt; 56, second  =&gt; 30,
+        excel   =&gt; 39334.9975694446,
+        iso8601 =&gt; &#39;2007-09-09T23:56:30&#39;,
+        },
+        {
+        year    =&gt; 2007, month   =&gt;  9, day     =&gt;  9,
+        hour    =&gt; 23,   minute  =&gt; 56, second  =&gt; 45,
+        excel   =&gt; 39334.9977430557,
+        iso8601 =&gt; &#39;2007-09-09T23:56:45&#39;,
+        },
+        {
+        year    =&gt; 1985, month   =&gt; 10, day     =&gt; 26,
+        hour    =&gt;  1,   minute  =&gt; 17, second  =&gt; 00,
+        excel   =&gt; 31346.0534722223,
+        iso8601 =&gt; &#39;1985-10-26T01:17:00&#39;,
+        },
+        {
+        year    =&gt; 1955, month   =&gt; 11, day     =&gt; 12,
+        hour    =&gt;  9,   minute  =&gt; 28, second  =&gt; 00,
+        excel   =&gt; 20405.3944444442,
+        iso8601 =&gt; &#39;1955-11-12T09:28:00&#39;,
+        },
+&#41;;
+
+foreach my $test_data &#40;@test_data&#41;{
+        my $dt = DateTime-&gt;new&#40;
+                year   =&gt; $test_data-&gt;{year},
+                month  =&gt; $test_data-&gt;{month},
+                day    =&gt; $test_data-&gt;{day},
+                hour   =&gt; $test_data-&gt;{hour},
+                minute =&gt; $test_data-&gt;{minute},
+                second =&gt; $test_data-&gt;{second}
+        &#41;;
+        my $got_excel     = DateTime::Format::Excel-&gt;format_datetime&#40; $dt &#41;;
+        is &#40; $got_excel   =&gt; $test_data-&gt;{excel} , &#34; \$got_excel &#40;$got_excel&#41; ~ excel &#40;$test_data-&gt;{excel}&#41;&#34;&#41;;
+        my $got_dt        = DateTime::Format::Excel-&gt;parse_datetime&#40; $test_data-&gt;{excel} &#41;;
+        my $got_iso8601   = $got_dt-&gt;iso8601&#40;&#41;;
+        is &#40; $got_iso8601 =&gt; $test_data-&gt;{iso8601} , &#34; \$got_iso8601 &#40;$got_iso8601&#41; ~ iso8601 &#40;$test_data-&gt;{iso8601}&#41;&#34;&#41;;
+}</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;02:46:32&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  TimeEstimated changed from &#40;no value&#41; to &#39;180&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;02:46:32&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  TimeWorked changed from &#40;no value&#41; to &#39;120&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;02:46:33&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;02:46:33&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Broken in 0.26 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;02:46:33&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Broken in 0.2901 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;02:48:26&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Dependency by ticket #34880 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;02:48:26&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Reference by ticket #34880 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;03:04:47&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Cc aburs@cpan.com added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;03:13:56&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza">Hi, I just took over this module from Dave, and I'll release a new v0.30 soon. That will have this bug fixed.<br>

Sorry for the long delay, there simply was nobody in charge of this module who had time to do anything with it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;03:13:57&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;patched&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;11&nbsp;09:50:28&nbsp;2010</span>
    <span class="description">DROLSKY [...] cpan.org -  Given to ABURS</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;14&nbsp;05:14:32&nbsp;2010</span>
    <span class="description">ABURS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
