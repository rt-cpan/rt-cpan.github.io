<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #25156 for XML-Twig: Bug in XML-Twig handling Control Characters?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #25156 for XML-Twig: Bug in XML-Twig handling Control Characters?</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=XML-Twig">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=XML-Twig">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=XML-Twig">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=XML-Twig">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-Twig">XML-Twig CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">25156</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=XML-Twig">XML-Twig</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
P.J.B.King [...] hw.ac.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-37682-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-37683-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




input.xml<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/293798/132724/input.xml">
Mon Feb 26 10:57:51 2007 (137b) by P.J.B.King [...] hw.ac.uk
</a>
</font></li>
</ul>


my-output.xml<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/293798/132725/my-output.xml">
Mon Feb 26 10:57:51 2007 (239b) by P.J.B.King [...] hw.ac.uk
</a>
</font></li>
</ul>


perl-version<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/293798/132728/perl-version">
Mon Feb 26 10:57:51 2007 (465b) by P.J.B.King [...] hw.ac.uk
</a>
</font></li>
</ul>


uname-output<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/293798/132726/uname-output">
Mon Feb 26 10:57:51 2007 (95b) by P.J.B.King [...] hw.ac.uk
</a>
</font></li>
</ul>


xmltwig-bug.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/293798/132727/xmltwig-bug.pl">
Mon Feb 26 10:57:51 2007 (1k) by P.J.B.King [...] hw.ac.uk
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=25156">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-293798" href="/Public/Bug/Display.html?id=25156#txn-293798">#</a>      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;26&nbsp;10:57:51&nbsp;2007</span>
    <span class="description">P.J.B.King [...] hw.ac.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug in XML-Twig handling Control Characters?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 Feb 2007 15:57:20 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-Twig [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Peter King &lt;P.J.B.King [...] hw.ac.uk&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/293798/132723/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/132723">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 739b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think there may be a bug in the handling of control characters by 
XML::Twig

If the input file contains any character less than &lt;space&gt; except for 
&lt;tab&gt;, &lt;new line&gt;, &lt;return&gt;, then the input of the file is truncated there.

It is not solved by using &#39;safe&#39; output filter, because this does not 
translate the characters in question.

I have attached a perl script that demonstrates this, with its input, 
the output I get &#40;the script will write the file output.xml&#41; and the 
version information from perl and uname

I think this bug has existed for a long time - it certainly manifested 
itself in Twig3.23


All in all an excellent piece of code for fiddling with XML though - 
thanks for your hard work in developing it.

Peter King
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/293798/132724/input.xml">Download input.xml</a><br />
<span class="downloadcontenttype">text/xml 137b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;?xml version=&#34;1.0&#34;?&gt;
&lt;file&gt;
&lt;text&gt;
&lt;t1&gt;a &lt;/t1&gt;
&lt;t2&gt; bbb &lt;/t2&gt;
&lt;/text&gt;
&lt;text&gt;
&lt;t1&gt;a with CTRL-A :: &lt;/t1&gt;
&lt;t2&gt; bbb &lt;/t2&gt;
&lt;/text&gt;
&lt;/file&gt;
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/293798/132725/my-output.xml">Download my-output.xml</a><br />
<span class="downloadcontenttype">text/xml 239b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;?xml version=&#34;1.0&#34;?&gt;
&lt;file&gt;
  &lt;text&gt;
    &lt;t1&gt;ab Control-C :: Now octal 222 :&#38;#146;:&lt;/t1&gt;
    &lt;t2&gt;Second text OK&lt;/t2&gt;
  &lt;/text&gt;
  &lt;text&gt;
    &lt;t1&gt;a &lt;/t1&gt;
    &lt;t2&gt; bbb &lt;/t2&gt;
  &lt;/text&gt;
  &lt;text&gt;
    &lt;t1&gt;a with CTRL-A :&lt;/t1&gt;
  &lt;/text&gt;
&lt;/file&gt;
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/293798/132726/uname-output">Download uname-output</a><br />
<span class="downloadcontenttype">text/plain 95b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Linux lxpjbk 2.6.18-1.2200.fc5smp #1 SMP Sat Oct 14 17:15:35 EDT 2006 i686 i686 i386 GNU/Linux
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/293798/132727/xmltwig-bug.pl">Download xmltwig-bug.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w
#
# project selection and updating script
# called by CGI
# takes parameters directory
#                  type &#40;UG|PG|ASE&#41;
#                  staff &#40;true&#41;
#                  debug &#40;true&#41;


use lib &#34;/u1/staff/pjbk/perl_libs/XML-Twig-3.29/blib/lib&#34;;
# XML processing library

#use strict;

use Fcntl; # for file locking definitions

use XML::Twig;


$input_file = &#34;input.xml&#34;;
$output_file = &#34;output.xml&#34;;

 # add a new record

$t1_text = &#34;ab Control-C :\cC: Now octal 222 :\222:&#34;;
$t2_text = &#34;Second text OK&#34;;



	my $t1 = new XML::Twig::Elt&#40; &#39;t1&#39;,$t1_text&#41;;
	my $t2 = new XML::Twig::Elt&#40; &#39;t2&#39;,$t2_text&#41;;



	my $text= new XML::Twig::Elt&#40; &#39;text&#39; , &#40; $t1, $t2 &#41;&#41;;

	$twig = new XML::Twig&#40; pretty_print =&gt; &#39;indented&#39;,
			       output_filter =&gt; &#39;safe&#39;&#41;;

	$twig -&gt; safe_parsefile&#40; $input_file&#41;;
	&#38;mydie &#40; &#34;Problems with input file: $input_file&#34;&#41;
	    if $twig == 0;
$root = $twig -&gt; root;


	    $text -&gt; paste&#40; first_child =&gt; $root&#41;;


	open&#40;OUTPUTFILE, &#34;&gt;&#34; . $output_file&#41;
	    or &#38;mydie&#40;&#34;Can&#39;t open OUTPUTFILE: $output_file&#34;&#41;;
	$twig-&gt;print&#40;\*OUTPUTFILE&#41;;
	close OUTPUTFILE;


exit;
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/293798/132728/perl-version">Download perl-version</a><br />
<span class="downloadcontenttype">text/plain 465b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
This is perl, v5.8.8 built for i386-linux-thread-multi

Copyright 1987-2006, Larry Wall

Perl may be copied only under the terms of either the Artistic License or the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using &#34;man perl&#34; or &#34;perldoc perl&#34;.  If you have access to the
Internet, point your browser at <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perl.org/">http://www.perl.org/</a></span>, the Perl Home Page.

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-297224" href="/Public/Bug/Display.html?id=25156#txn-297224">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;12&nbsp;08:29:26&nbsp;2007</span>
    <span class="description">MIROD [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/297224/134521/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/134521">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 792b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Feb 26 10:57:51 2007, P.J.B.King@hw.ac.uk wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think there may be a bug in the handling of control characters by 
&gt; XML::Twig
&gt; 
&gt; If the input file contains any character less than &lt;space&gt; except for 
&gt; &lt;tab&gt;, &lt;new line&gt;, &lt;return&gt;, then the input of the file is truncated
</div>there.

I am not sure I quite understand. Characters like CTRL-A are not allowed
in XML &#40;see the spec&#41;, so the parser &#40;expat, 2 layers below XML::Twig&#41;
barfs when it finds them. xmlwf correclty reports that your file is not
well-formed XML, and XML::Twig stops processing as soon as it finds the
illegal character. All XML processors are required to do this.

Am I missing something

&#40;and sorry for the late answer, but for a while RT stopped sending
notifications when new tickets were created&#41;.

__
mirod
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-297225" href="/Public/Bug/Display.html?id=25156#txn-297225">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;12&nbsp;08:29:35&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-297228" href="/Public/Bug/Display.html?id=25156#txn-297228">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;12&nbsp;08:53:29&nbsp;2007</span>
    <span class="description">P.J.B.King [...] hw.ac.uk -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #25156] Bug in XML-Twig handling Control Characters?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 12 Mar 2007 12:52:58 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-Twig [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Peter King &lt;P.J.B.King [...] hw.ac.uk&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/297228/134523/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/134523">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">  via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=25156">http://rt.cpan.org/Ticket/Display.html?id=25156</a></span> &gt;
&gt; 
&gt; On Mon Feb 26 10:57:51 2007, P.J.B.King@hw.ac.uk wrote:
<div class="message-stanza open">&gt;&gt; I think there may be a bug in the handling of control characters by 
&gt;&gt; XML::Twig
&gt;&gt;
&gt;&gt; If the input file contains any character less than &lt;space&gt; except for 
&gt;&gt; &lt;tab&gt;, &lt;new line&gt;, &lt;return&gt;, then the input of the file is truncated
</div>&gt; there.
&gt; 
&gt; I am not sure I quite understand. Characters like CTRL-A are not allowed
&gt; in XML &#40;see the spec&#41;, so the parser &#40;expat, 2 layers below XML::Twig&#41;
&gt; barfs when it finds them. xmlwf correclty reports that your file is not
&gt; well-formed XML, and XML::Twig stops processing as soon as it finds the
&gt; illegal character. All XML processors are required to do this.
&gt; 
&gt; Am I missing something
&gt; 
&gt; &#40;and sorry for the late answer, but for a while RT stopped sending
&gt; notifications when new tickets were created&#41;.
&gt; 
&gt; __
&gt; mirod
</div>

No, I think you are right, but I&#39;m surprised that the parse of the input 
file doesn&#39;t complain, but produces a well formed tree, although it is 
not DTD compliant.  I suppose I found it surprising that XML-Twig would 
write files that it couldn&#39;t subsequently read back, so it&#39;s possible to 
write files that are not well formed.

Feel free to remove the &#34;bug&#34;

Peter
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-297274" href="/Public/Bug/Display.html?id=25156#txn-297274">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;12&nbsp;11:21:15&nbsp;2007</span>
    <span class="description">MIROD [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-297275" href="/Public/Bug/Display.html?id=25156#txn-297275">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;12&nbsp;11:21:34&nbsp;2007</span>
    <span class="description">mirod [...] xmltwig.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #25156] Bug in XML-Twig handling Control Characters?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 12 Mar 2007 16:28:41 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-Twig [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> mirod &lt;mirod [...] xmltwig.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/297275/134552/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/134552">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Peter King via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-Twig
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=25156">http://rt.cpan.org/Ticket/Display.html?id=25156</a></span> &gt;
&gt; 
&gt;   via RT wrote:
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=25156">http://rt.cpan.org/Ticket/Display.html?id=25156</a></span> &gt;
&gt;&gt;
&gt;&gt; On Mon Feb 26 10:57:51 2007, P.J.B.King@hw.ac.uk wrote:
<div class="message-stanza open">&gt;&gt;&gt; I think there may be a bug in the handling of control characters by 
&gt;&gt;&gt; XML::Twig
&gt;&gt;&gt;
&gt;&gt;&gt; If the input file contains any character less than &lt;space&gt; except for 
&gt;&gt;&gt; &lt;tab&gt;, &lt;new line&gt;, &lt;return&gt;, then the input of the file is truncated
</div>&gt;&gt; there.
&gt;&gt;
&gt;&gt; I am not sure I quite understand. Characters like CTRL-A are not allowed
&gt;&gt; in XML &#40;see the spec&#41;, so the parser &#40;expat, 2 layers below XML::Twig&#41;
&gt;&gt; barfs when it finds them. xmlwf correclty reports that your file is not
&gt;&gt; well-formed XML, and XML::Twig stops processing as soon as it finds the
&gt;&gt; illegal character. All XML processors are required to do this.
&gt;&gt;
&gt;&gt; Am I missing something
&gt;&gt;
&gt;&gt; &#40;and sorry for the late answer, but for a while RT stopped sending
&gt;&gt; notifications when new tickets were created&#41;.
&gt;&gt;
&gt;&gt; __
&gt;&gt; mirod
</div>&gt; 
&gt; 
&gt; No, I think you are right, but I&#39;m surprised that the parse of the input 
&gt; file doesn&#39;t complain, but produces a well formed tree, although it is 
&gt; not DTD compliant.  I suppose I found it surprising that XML-Twig would 
&gt; write files that it couldn&#39;t subsequently read back, so it&#39;s possible to 
&gt; write files that are not well formed.
&gt; 
&gt; Feel free to remove the &#34;bug&#34;
</div>
Expat is not a validating parser, so the whole stack, including
XML::Twig, doesn&#39;t know anything about validity, only well-formedness.
Abd there are indeed many ways to get XML::Twig to output non
well-formed XML. It is usually quite easy to get to output well-formed
XML, but indeed Perl happily lets you use the whole Unicode character
set, as it should, while XML excludes some it. You could use an output
filter to make sure that you filter out improper characters before
they&#39;re written.

-- 
mirod
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-297276" href="/Public/Bug/Display.html?id=25156#txn-297276">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;12&nbsp;11:21:35&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;rejected&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-297447" href="/Public/Bug/Display.html?id=25156#txn-297447">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;13&nbsp;05:18:02&nbsp;2007</span>
    <span class="description">MIROD [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.364307</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
