<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #105257 for Win32-Console-ANSI: cursor tests depend on user settings for CMD</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #105257 for Win32-Console-ANSI: cursor tests depend on user settings for CMD</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Win32-Console-ANSI/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Win32-Console-ANSI/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Win32-Console-ANSI/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Win32-Console-ANSI/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-Console-ANSI">Win32-Console-ANSI CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">105257</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Win32-Console-ANSI/Active/">Win32-Console-ANSI</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Ralf.Neubauer [...] wido.bv.aok.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35472-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35473-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.09    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;16&nbsp;05:12:02&nbsp;2015</span>
    <span class="description">Ralf.Neubauer [...] wido.bv.aok.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> cursor tests depend on user settings for CMD</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 16 Jun 2015 09:11:42 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Win32-Console-ANSI [...] rt.cpan.org&#34; &lt;bug-Win32-Console-ANSI [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Neubauer, Ralf&#34; &lt;ralf.neubauer [...] wido.bv.aok.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

some Subtests of t\02_CursorFunc.t and t\03_CursorMove.t failed for me &#40;Windows 7 64bit&#41;:


D:\tmp\strawberry-5.20-64\archive\Win32-Console-ANSI-1.08&gt;prove
t\00_Pod.t ............. ok
t\01_PodCoverage.t ..... skipped: Test::Pod::Coverage 1.00 required for testing
POD coverage
t\02_CursorFunc.t ...... Failed 2/39 subtests
t\03_CursorMove.t ...... Failed 6/98 subtests
t\04_DisplayEdition.t .. Failed 74/74 subtests
t\05_Colors.t .......... Failed 35/36 subtests
t\06_Func.t ............ ok
t\07_TortureMeHoney.t .. Failed 3/3 subtests
t\08_Compatibility.t ... Failed 3/3 subtests
t\09_Compatibility2.t .. skipped: Term::ANSIScreen not installed
t\99_Kwalitee.t ........ skipped: Test::Kwalitee not installed; skipping

Test Summary Report
-------------------
t\02_CursorFunc.t    &#40;Wstat: 0 Tests: 39 Failed: 2&#41;
  Failed tests:  22-23
t\03_CursorMove.t    &#40;Wstat: 0 Tests: 98 Failed: 6&#41;
  Failed tests:  69, 74, 76, 81, 86, 88
t\04_DisplayEdition.t &#40;Wstat: 0 Tests: 74 Failed: 74&#41;
  Failed tests:  1-74
t\05_Colors.t        &#40;Wstat: 0 Tests: 36 Failed: 35&#41;
  Failed tests:  1-35
t\07_TortureMeHoney.t &#40;Wstat: 0 Tests: 3 Failed: 3&#41;
  Failed tests:  1-3
t\08_Compatibility.t &#40;Wstat: 0 Tests: 3 Failed: 3&#41;
  Failed tests:  1-3
Files=11, Tests=276,  2 wallclock secs &#40; 0.11 usr +  0.06 sys =  0.17 CPU&#41;
Result: FAIL


For t\02_CursorFunc.t these are:
not ok 22
not ok 23

For t\03_CursorMove.t these are:
not ok 69
not ok 74
not ok 76
not ok 81
not ok 86
not ok 88


An example of a failed subtest is:

my &#40;$Xmax, $Ymax&#41; = XYMax&#40;&#41;;

[...]

# test 22
Cursor&#40;17, 5&#41;;
Cursor&#40;17, 1000&#41;;
&#40;$x, $y&#41; = Cursor&#40;&#41;;
ok&#40; $x==17 and $y==$Ymax &#41;;


To not lose shell history too early, my default setting for the Window Buffer Height is 3000. Obviously this is returned by XYMax&#40;&#41; and test 22 tests if 1000 is clipped to the buffer height, which is 3000 and not clipping takes place.

Just changing the buffer height of the current CMD console doesn&#39;t help, I had to change the default setting to get:


D:\tmp\strawberry-5.20-64\archive\Win32-Console-ANSI-1.08&gt;prove
t\00_Pod.t ............. ok
t\01_PodCoverage.t ..... skipped: Test::Pod::Coverage 1.00 required for testing
POD coverage
t\02_CursorFunc.t ...... ok
t\03_CursorMove.t ...... ok
t\04_DisplayEdition.t .. Failed 74/74 subtests
t\05_Colors.t .......... Failed 35/36 subtests
t\06_Func.t ............ ok
t\07_TortureMeHoney.t .. Failed 3/3 subtests
t\08_Compatibility.t ... Failed 3/3 subtests
t\09_Compatibility2.t .. skipped: Term::ANSIScreen not installed
t\99_Kwalitee.t ........ skipped: Test::Kwalitee not installed; skipping

Test Summary Report
-------------------
t\04_DisplayEdition.t &#40;Wstat: 0 Tests: 74 Failed: 74&#41;
  Failed tests:  1-74
t\05_Colors.t        &#40;Wstat: 0 Tests: 36 Failed: 35&#41;
  Failed tests:  1-35
t\07_TortureMeHoney.t &#40;Wstat: 0 Tests: 3 Failed: 3&#41;
  Failed tests:  1-3
t\08_Compatibility.t &#40;Wstat: 0 Tests: 3 Failed: 3&#41;
  Failed tests:  1-3
Files=11, Tests=276,  2 wallclock secs &#40; 0.12 usr +  0.03 sys =  0.16 CPU&#41;
Result: FAIL


There are multiple ways to fix this:
- use $Xmax+1 and $Ymax+1 instead of 1200 and 1000 for the clipping tests
- just skip the tests, if $Xmax and $Ymax are too big
- open the console the tests run on with a fixed size, overriding the user settings for the test. If possible.

Ralf
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;10:16:18&nbsp;2015</span>
    <span class="description">jl_morel [...] bribes.org -  Status changed from &#39;new&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;03&nbsp;10:16:20&nbsp;2015</span>
    <span class="description">jl_morel [...] bribes.org -  Fixed in 1.09 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
