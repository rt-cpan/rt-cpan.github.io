<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #106480 for Regexp-Assemble: disable processing on Perl &gt;= 5.10</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #106480 for Regexp-Assemble: disable processing on Perl &gt;= 5.10</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Regexp-Assemble">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Regexp-Assemble">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Regexp-Assemble">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Regexp-Assemble">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Regexp-Assemble">Regexp-Assemble CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">106480</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Regexp-Assemble">Regexp-Assemble</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
daxim [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-27694-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-27695-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=106480">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1526253" href="/Public/Bug/Display.html?id=106480#txn-1526253">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;16&nbsp;13:57:56&nbsp;2015</span>
    <span class="description">daxim [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> disable processing on Perl &gt;= 5.10</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1526253/814132/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/814132">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 532b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Quoting <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/release/RGARCIA/perl-5.10.0/pod/perl5100delta.pod#Trie-optimisation-of-literal-string-alternations">https://metacpan.org/pod/release/RGARCIA/perl-5.10.0/pod/perl5100delta.pod#Trie-optimisation-of-literal-string-alternations</a></span>

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Note: Much code exists that works around perl&#39;s historic poor performance on alternations. Often the tricks used to do so will disable the new optimisations. Hopefully the utility modules used for this purpose will be educated about these new optimisations.
</div>
Therefore on Perl 5.10 and later, R::A should just return the result of Data::Munge::list2re and let have perl optimise the regex instead.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1526298" href="/Public/Bug/Display.html?id=106480#txn-1526298">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;16&nbsp;18:21:26&nbsp;2015</span>
    <span class="description">RSAVAGE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1526298/814154/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/814154">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 464b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">There is a discussion of this in the module&#39;s Description:
<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/Regexp::Assemble">https://metacpan.org/pod/Regexp::Assemble</a></span>.

If it&#39;s failing to active that logic on recent Perls, that&#39;s a problem.

My immediate reaction is that /I/ am reluctant to disable something just depending on the version of Perl, since some users may not have any, or much, alternation in their code.

But since I know so little about the module&#39;s internals, please continue to spell out any concerns you have.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1526299" href="/Public/Bug/Display.html?id=106480#txn-1526299">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;16&nbsp;18:21:27&nbsp;2015</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1526302" href="/Public/Bug/Display.html?id=106480#txn-1526302">#</a>      
    </span>
    <span class="date">Sun&nbsp;Aug&nbsp;16&nbsp;19:00:30&nbsp;2015</span>
    <span class="description">RSAVAGE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1526302/814157/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/814157">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 247b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">In fact, it might be best if end users simply checked their version of Perl &#40;i.e. at runtime&#41; and switch to Data::Munge automatically.

Of course, that does suggest I update the Description or Limitations, to cover this case in a bit more detail.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1527105" href="/Public/Bug/Display.html?id=106480#txn-1527105">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;19&nbsp;06:29:08&nbsp;2015</span>
    <span class="description">daxim [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1527105/814651/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/814651">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 762b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If it&#39;s failing to active that logic on recent Perls, that&#39;s a problem.
</div>
I believe it does not, otherwise I wouldn&#39;t have opened this bug.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; /I/ am reluctant to disable something just depending on the version of Perl
</div>
There is already much Perl-version dependent code in R::A. That&#39;s perfectly normal.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; some users may not have any, or much, alternation in their code
</div>
That&#39;s wrong. As soon as one add&#40;&#41;s two regexes, there is an alternation, so the vast majority of users have them.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I know so little about the module&#39;s internals
</div>
It&#39;s *your* responsibility as a maintainer to understand the internals. Don&#39;t shift that burden onto someone else, e.g. bug reporters. If you need help with the trie regex optimisations from 5.10, you know where to find p5p.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1527276" href="/Public/Bug/Display.html?id=106480#txn-1527276">#</a>      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;19&nbsp;18:31:52&nbsp;2015</span>
    <span class="description">ron [...] savage.net.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #106480] disable processing on Perl &gt;= 5.10</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 20 Aug 2015 08:37:42 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Assemble [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ron Savage &lt;ron [...] savage.net.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1527276/814748/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/814748">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Lars

On 19/08/15 20:29, Lars Dɪᴇᴄᴋᴏᴡ 迪拉斯 via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         Queue: Regexp-Assemble
&gt;   Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=106480">https://rt.cpan.org/Ticket/Display.html?id=106480</a></span> &gt;
&gt;
<div class="message-stanza open">&gt;&gt; If it&#39;s failing to active that logic on recent Perls, that&#39;s a problem.
</div>&gt;
&gt; I believe it does not, otherwise I wouldn&#39;t have opened this bug.
</div>
OK.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; /I/ am reluctant to disable something just depending on the version of Perl
</div>&gt;
&gt; There is already much Perl-version dependent code in R::A. That&#39;s perfectly normal.
</div>
Probably true. I did not study the source.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; some users may not have any, or much, alternation in their code
</div>&gt;
&gt; That&#39;s wrong. As soon as one add&#40;&#41;s two regexes, there is an alternation, so the vast majority of users have them.
</div>
OK.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; I know so little about the module&#39;s internals
</div>&gt;
&gt; It&#39;s *your* responsibility as a maintainer to understand the internals. Don&#39;t shift that burden onto someone else, e.g. bug reporters. If you need help with the trie regex optimisations from 5.10, you know where to find p5p.
</div>
Ahh. But I&#39;m limited by my skill set, ability and time. And being a 
volunteer I don&#39;t actually have to fix anything :-&#41;.

But, being a volunteer means I have, err, volunteered, to fix /some/ 
things, and have done so, but that&#39;s not a promise to fix things beyond 
my understanding.

The other reason I&#39;m reluctant to dive in quickly, is that over the 
years I and other uses of Marpa [1] have pondered the writing of a 
&#40;hopefully&#41; definitive BNF [2] for Perl&#39;s regexps, and hence the release 
of a Marpa-based parser for regxps. That just might give us another, 
deep, way of understanding regexps which leads to re-writing this module 
from scratch.

Yes, short term fixes for current problems is still a reasonable 
expectation for its users, but as I&#39;ve said above, either people give me 
patches or I grind thru the issues as and when I can.

[1] <span class="clickylink"><a target="new" rel="nofollow" href="http://savage.net.au/Marpa.html">http://savage.net.au/Marpa.html</a></span>

As noted there, there are already quite a few Marpa-based packages in Perl.

And just because I host Marpa&#39;s home page does not mean I wrote Marpa. I 
didn&#39;t.

[2] Yes, it would have to be Perl-version dependent.

-- 
Ron Savage - savage.net.au
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1527381" href="/Public/Bug/Display.html?id=106480#txn-1527381">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;20&nbsp;02:42:34&nbsp;2015</span>
    <span class="description">ron [...] savage.net.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #106480] disable processing on Perl &gt;= 5.10</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 20 Aug 2015 16:48:24 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Regexp-Assemble [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ron Savage &lt;ron [...] savage.net.au&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1527381/814806/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/814806">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 150b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi

For alternatives to this module, consider one of:

o Regex::PreSuf

o OnSearch::Regex

I&#39;ll add these to the POD.

-- 
Ron Savage - savage.net.au
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1530346" href="/Public/Bug/Display.html?id=106480#txn-1530346">#</a>      
    </span>
    <span class="date">Sat&nbsp;Aug&nbsp;29&nbsp;16:28:22&nbsp;2015</span>
    <span class="description">SREZIC [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1530346/816473/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/816473">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2015-08-16 13:57:56, DAXIM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Quoting <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/release/RGARCIA/perl-">https://metacpan.org/pod/release/RGARCIA/perl-</a></span>
&gt; 5.10.0/pod/perl5100delta.pod#Trie-optimisation-of-literal-string-
&gt; alternations
&gt; 
<div class="message-stanza open">&gt; &gt; Note: Much code exists that works around perl&#39;s historic poor
&gt; &gt; performance on alternations. Often the tricks used to do so will
&gt; &gt; disable the new optimisations. Hopefully the utility modules used for
&gt; &gt; this purpose will be educated about these new optimisations.
</div>&gt; 
&gt; Therefore on Perl 5.10 and later, R::A should just return the result
&gt; of Data::Munge::list2re and let have perl optimise the regex instead.
</div>
Unfortunately this is not that easy. The trie stuff works well as long as the internally built regexp program fits into some 2^16 tokens. If it&#39;s larger, then the regexp engine switches to the old inefficient O&#40;n&#41; algorithm, which is much slower than what Regexp::Assemble would generate. The 2^16 limit may be reached easily with 10000-20000 alterations &#40;it seems to depend on length of each alteration, maybe also other factors&#41;. By using &#34;use re qw&#40;debug&#41;&#34; it is possible to output the generated regexp programs. Something with &#34;TRIE&#34; is good, but &#34;BRANCH&#34; and &#34;LONGJMP&#34; is bad. See below for examples.

And this is not just theory. At $WORK we had a *massive* performance boost by using Regexp::Assemble for more than 10000 alterations, and let the trie implementation deal with fewer than this limit.

What can Regexp::Assemble do about this all? I am not aware of an API function in perl&#39;s regexp engine to tell whether trie or non-trie regexp programs were generated &#40;using the &#34;use re qw&#40;debug&#41;&#34; output here feels hackish&#41;. If there was one, then Regexp::Assemble could theoretically check if perl&#39;s regexp engine can generate a trie and leave it at this. Maybe more documentation on this topic would be good. But the initial request &#40;&#34;disable processing on Perl &gt;= 5.10&#34;&#41; should be rejected.

Regards,
    Slaven

# 20000 alterations, non-trie regexp program
$ perl5.20.2 -MString::Random=random_string -e &#39;$words = shift || 10000; $x = &#34;&#40;&#34; . join&#40;&#34;|&#34;, map { quotemeta random_string&#40;&#34;cccccccccc&#34;&#41; } &#40;1..$words&#41;&#41; . &#34;&#41;&#34;; warn &#34;-&#34;x60, &#34;\n&#34;; use re &#34;debug&#34;; $x=qr{$x}&#39; 20000 |&#38; head -10 
------------------------------------------------------------
Compiling REx &#34;&#40;habquzbhwx|ibcogqguhs|dpstybzinz|ujwvozcokf|vtbwelkwpp|xpea&#34;...
Final program:
   1: OPEN1 &#40;3&#41;
   3:   BRANCHJ &#40;11&#41;
   5:     EXACT &lt;habquzbhwx&gt; &#40;9&#41;
   9:     LONGJMP &#40;160001&#41;
  11:   BRANCHJ &#40;19&#41;
  13:     EXACT &lt;ibcogqguhs&gt; &#40;17&#41;
  17:     LONGJMP &#40;160001&#41;

# 10000 alterations, trie regexp program
$ perl5.20.2 -MString::Random=random_string -e &#39;$words = shift || 10000; $x = &#34;&#40;&#34; . join&#40;&#34;|&#34;, map { quotemeta random_string&#40;&#34;cccccccccc&#34;&#41; } &#40;1..$words&#41;&#41; . &#34;&#41;&#34;; warn &#34;-&#34;x60, &#34;\n&#34;; use re &#34;debug&#34;; $x=qr{$x}&#39; 10000 |&#38; head -10
------------------------------------------------------------
Compiling REx &#34;&#40;caaianxnke|ylicpierfd|mahofrbbwv|xvuefbqicm|crzkdzibvo|kdcm&#34;...
Final program:
   1: OPEN1 &#40;3&#41;
   3:   TRIEC-EXACT[a-z] &#40;50003&#41;
        &lt;caaianxnke&gt; 
        &lt;ylicpierfd&gt; 
        &lt;mahofrbbwv&gt; 
        &lt;xvuefbqicm&gt; 
        &lt;crzkdzibvo&gt; 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1770199" href="/Public/Bug/Display.html?id=106480#txn-1770199">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;07&nbsp;21:46:05&nbsp;2018</span>
    <span class="description">RSAVAGE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1770199/952659/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/952659">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 78b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perhaps <span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/release/Regexp-Parsertron">https://metacpan.org/release/Regexp-Parsertron</a></span> will help in some way.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.524265</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
