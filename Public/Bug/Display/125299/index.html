<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #125299 for CAM-PDF: CAM::PDF $pdf-&gt;fillFormFields&#40;%data &#41;; Field content not visible / printed</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #125299 for CAM-PDF: CAM::PDF $pdf-&gt;fillFormFields&#40;%data &#41;; Field content not visible / printed</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CAM-PDF/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CAM-PDF/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CAM-PDF/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CAM-PDF/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CAM-PDF">CAM-PDF CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">125299</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CAM-PDF/Active/">CAM-PDF</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
kollmann [...] lab-quade.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-4996-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-4997-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




fdf.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1785911/960613/fdf.pl">
Fri May 11 05:10:07 2018 (673b) by kollmann [...] lab-quade.de
</a>
</font></li>
</ul>


Muster_10_D&#40;7_2017&#41;.pdf<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1785911/960611/Muster_10_D(7_2017).pdf">
Fri May 11 05:10:07 2018 (103.2k) by kollmann [...] lab-quade.de
</a>
</font></li>
</ul>


perlVersion.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1785911/960610/perlVersion.txt">
Fri May 11 05:10:07 2018 (11.1k) by kollmann [...] lab-quade.de
</a>
</font></li>
</ul>


test.pdf<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1785911/960612/test.pdf">
Fri May 11 05:10:07 2018 (116.1k) by kollmann [...] lab-quade.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;11&nbsp;05:10:07&nbsp;2018</span>
    <span class="description">kollmann [...] lab-quade.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> CAM::PDF $pdf-&gt;fillFormFields&#40;%data &#41;; Field content not visible / printed</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 11 May 2018 11:01:03 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CAM-PDF [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Dr. Harald Kollmann&#34; &lt;kollmann [...] lab-quade.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear CDOLAN,

maybe I am doing something wrong but the inserted content is neither 
printed nor shown &#40;except when choosing show form&#41;.

Looking in the pdf -file i can find the content inserted as &#34;form 
content&#34; and as Text-stream.

My colleagues and i were given an official form which has to be filled 
in and signed &#40;later&#41;.
We have to use the predefined fonts / sizes. So I was quite happy when i 
found CAM::PDF and some articles suggesting $pdf-&gt;fillFormFields&#40;%data &#41; 
is doing exactly what we need.

I try to develop the fill-in-tool on a

Linux kollmann-nb 4.13.0-41-generic #46~16.04.1-Ubuntu SMP Thu May 3 
10:06:43 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux

Please look attachments for detailed Perl-Version, perl-code source-pdf 
&#40;Muster-10...&#41; and generated pdf &#40;test.pdf&#41;

&#40; Sorry but i&#39;n not used to write in English&#41;

I am looking forward to hear from you.

Yours cincerely

Harald

-- 
Mit freundlichen Grüßen
Dr. phil. nat. chem. Harald Kollmann

Tel. 0221 – 940 564 19
Fax: 0221 – 940 564 330

Medizinisches Versorgungszentrum &#40;MVZ&#41; Labor Dr. Quade &#38; Kollegen GmbH
Aachener Str. 338, 50933 Köln
Geschäftsführer : Dr. med. Annegret Quade
Sitz Köln, HRB 76015, St.Nr.223/5813/6928
Akkreditiert durch die Deutsche Akkreditierungsstelle GmbH &#40;DAkkS&#41; und College of American Pathologists &#40;CAP&#41;
Registrierungsnummer D-ML-17419-01-00 &#40;DAkkS&#41;
Registrierungsnummer D-PL-17419-01-00 &#40;DAkkS&#41;
LAP Nummer 8997219 &#40;CAP&#41;
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1785911/960611/Muster_10_D%26%2340%3B7_2017%26%2341%3B.pdf">Download Muster_10_D&#40;7_2017&#41;.pdf</a><br />
<span class="downloadcontenttype">application/pdf 103.2k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1785911/960612/test.pdf">Download test.pdf</a><br />
<span class="downloadcontenttype">application/pdf 116.1k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;03&nbsp;12:19:27&nbsp;2018</span>
    <span class="description">futuramedium [...] yandex.ru -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, I have looked into the issue, CAM::PDF::fillFormFields doesn&#39;t encode &#40;compress&#41; appearance stream. Even if there already was &#34;Filter&#34; entry in dictionary of &#40;empty, as in this case&#41; stream in original PDF. Thus, &#34;Field content not visible&#34; because stream can&#39;t be decoded. Strange that neither Acrobat nor other viewers complain. Easiest fix is to always compress either newly created or already existing, but to be updated, appearance. 

2nd, attempts to fill e.g. checkboxes just won&#39;t work, because there&#39;s no code to do it -- only text fields are processed. It should be documented and/or warning issued. 

As to phone number being cropped, -- if suggested patch is applied -- see comment in 4538 line of 1.60 &#40;current&#41; version. Point is, obvious bug was easy to fix, anything else &#40;e.g. &#34;predefined fonts&#34; - ??&#41; is a bit more work and maybe beyond scope.

#!/usr/bin/perl
use strict;
use warnings;
use CAM::PDF;

my $pdf = new CAM::PDF&#40; &#39;Muster_10.pdf&#39; &#41;;

my %data = &#40;
  &#39;8118_Telefonnummer&#39; =&gt; &#34;0221 940 564 19&#34;,
  &#39;4205_Auftrag&#39; =&gt; &#34;Hubba Hopp!\n Trallala Hoppsassa!&#34;,
  &#39;4134_Kostentraegername&#39; =&gt; &#34;Test fuer Kostentraegername&#34;,
&#41;;

$pdf-&gt;fillFormFields&#40;%data &#41;;
$pdf-&gt;cleanoutput&#40;&#39;test.pdf&#39;&#41;;

__END__


--- PDF_old.pm  Thu Aug 15 05:08:26 2013
+++ PDF.pm      Sat Jun 30 12:17:03 2018
@@ -4601,6 +4601,9 @@
          $formdict-&gt;{Length} = CAM::PDF::Node-&gt;new&#40;&#39;number&#39;, $len, $formonum, $formgnum&#41;;
          $formdict-&gt;{StreamData} = CAM::PDF::Node-&gt;new&#40;&#39;stream&#39;, $text, $formonum, $formgnum&#41;;

+         delete $formdict-&gt; { Filter };
+         $self-&gt; encodeObject&#40; $formonum, &#39;FlateDecode&#39; &#41;;
+
          if &#40;@rsrcs &gt; 0&#41; {
             if &#40;!$formdict-&gt;{Resources}&#41;
             {
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;03&nbsp;12:19:28&nbsp;2018</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
