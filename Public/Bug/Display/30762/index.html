<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #30762 for WWW-Myspace: Get_inbox hang, ref bug 30351</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #30762 for WWW-Myspace: Get_inbox hang, ref bug 30351</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=WWW-Myspace">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=WWW-Myspace">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=WWW-Myspace">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=WWW-Myspace">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/WWW-Myspace">WWW-Myspace CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">30762</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=WWW-Myspace">WWW-Myspace</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
eewill40z [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38014-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38015-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=30762">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-383809" href="/Public/Bug/Display.html?id=30762#txn-383809">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;15&nbsp;16:41:00&nbsp;2007</span>
    <span class="description">eewill40z [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 15 Nov 2007 15:41:37 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-WWW-Myspace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> William Zorn &lt;eewill40z [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/383809/175968/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/175968">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 329b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m not sure what the fix is, but this module hangs because the &#39;last if...&#39;  statement around line 3581 &#40;in sub _get_messages_from_page&#41; will never be evaluated as true. The hash key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same goes with the &#39;end_page&#39; key into the %options hash located in the sub get_inbox.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-383854" href="/Public/Bug/Display.html?id=30762#txn-383854">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;15&nbsp;17:28:34&nbsp;2007</span>
    <span class="description">grantg [...] spamarrest.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351 </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 15 Nov 2007 14:28:10 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Grant Grueninger &lt;grantg [...] spamarrest.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/383854/175999/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/175999">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Please upgrade to the current version of WWW::Myspace.

The loop will exit when all the messages have been parsed - the $page  
variable is modified through each loop.  If the RE being matched  
against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the loop  
will exit anyway.  Thus, this most likely isn&#39;t the cause of the  
problem.

There is a known issue, however, that could cause an endless loop in  
get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries to go  
to the next page, but gets the same one instead&#41;.  The method works  
for me however &#40;on MacOS 10.5&#41;.

On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; Transaction: Ticket created by eewill40z@gmail.com
&gt;       Queue: WWW-Myspace
&gt;     Subject: Get_inbox hang, ref bug 30351
&gt;   Broken in: &#40;no value&#41;
&gt;    Severity: &#40;no value&#41;
&gt;       Owner: Nobody
&gt;  Requestors: eewill40z@gmail.com
&gt;      Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt;
&gt; I&#39;m not sure what the fix is, but this module hangs because the  
&gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub  
&gt; _get_messages_from_page&#41; will never be evaluated as true. The hash  
&gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same  
&gt; goes with the &#39;end_page&#39; key into the %options hash located in the  
&gt; sub get_inbox.
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-383855" href="/Public/Bug/Display.html?id=30762#txn-383855">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;15&nbsp;17:28:35&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384211" href="/Public/Bug/Display.html?id=30762#txn-384211">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;09:04:24&nbsp;2007</span>
    <span class="description">eewill40z [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 08:03:42 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;William Zorn&#34; &lt;eewill40z [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/384211/176179/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176179">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">First off, I am using the most recent version and second I made a mistake.
The failure is not on the &#39;last if...&#39; line.  The code hangs on the while
loop comparision.  It actually runs and find every occurence of the string
replace until there is none left.  It hangs on the last compair. Instead of
not finding the string and coming back to exit the loop, it just hangs and
eats up process time.

I have tried it on Mandriva and RedHat &#40;Linux&#41; with the same result.  My
only guess is that this problem is due to the differences in how the
operating systems handle characters in the file.  I think I&#39;ve debugged this
as far as I can... I will keep looking at it, but I could sure use some
help.

Thanks!
-William


On 11/15/07, grantg@spamarrest.com via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt;
wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Please upgrade to the current version of WWW::Myspace.
&gt;
&gt; The loop will exit when all the messages have been parsed - the $page
&gt; variable is modified through each loop.  If the RE being matched
&gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the loop
&gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; problem.
&gt;
&gt; There is a known issue, however, that could cause an endless loop in
&gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries to go
&gt; to the next page, but gets the same one instead&#41;.  The method works
&gt; for me however &#40;on MacOS 10.5&#41;.
&gt;
&gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt;
<div class="message-stanza open">&gt; &gt;
&gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt;       Queue: WWW-Myspace
&gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt;       Owner: Nobody
&gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt;      Status: new
&gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt; &gt; sub get_inbox.
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384211/176180/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176180">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.2k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384224" href="/Public/Bug/Display.html?id=30762#txn-384224">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;10:59:52&nbsp;2007</span>
    <span class="description">eewill40z [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 09:51:33 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;William Zorn&#34; &lt;eewill40z [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384224/176196/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176196">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Okay... this is not as eloquent as your solution, but it works for
me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
work on yours to.  Would love for you to try it out and let me know.

-William

# Updated by WZorn to fix hanging problem on Mandriva and RetHat linux.
sub _get_messages_from_page {

    my &#40; $dummy, %options &#41; = @_;
    my $page = $self-&gt;current_page-&gt;decoded_content;
    my @messages = &#40;&#41;;
    my $state = 0;                      # State Values
                                        # 0 - Beginning state, looking for beginning of message block
                                        # 1 - In message block, looking for data
                                        #     Will return to state=0 when we get the last data &#40;messageID
and subject&#41;
    my $sender;
    my $status;
    my $msg_id;
    my $subject;

    open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
    while &#40; &lt;$fh&gt; &#41; {
        chomp;
        last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} == $3 &#41; &#41;;
        if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
/&#41;{
                # Found beginning of Message block
                $state = 1;
        } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
                $sender = $1;
        } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
                $status = $1;
        } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
                $msg_id = $1;
                $subject = $2;
                $state = 0;    #return to state=0 because we need to start looking
for the beginning of the next message block
                
                push @messages, { sender =&gt; $sender, status =&gt; $status, message_id
=&gt; $msg_id, subject =&gt; $subject };
                if &#40;$DEBUG&#41; { print $sender,&#34;|&#34;,$status,&#34;|&#34;,$msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
        }
    }
    return @messages;
}

On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Please upgrade to the current version of WWW::Myspace.
&gt;
&gt; The loop will exit when all the messages have been parsed - the $page
&gt; variable is modified through each loop.  If the RE being matched
&gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the loop
&gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; problem.
&gt;
&gt; There is a known issue, however, that could cause an endless loop in
&gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries to go
&gt; to the next page, but gets the same one instead&#41;.  The method works
&gt; for me however &#40;on MacOS 10.5&#41;.
&gt;
&gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt;
<div class="message-stanza open">&gt; &gt;
&gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt;       Queue: WWW-Myspace
&gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt;       Owner: Nobody
&gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt;      Status: new
&gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt;
<div class="message-stanza open">&gt; &gt;
&gt; &gt;
&gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt; &gt; sub get_inbox.
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384226" href="/Public/Bug/Display.html?id=30762#txn-384226">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;11:13:15&nbsp;2007</span>
    <span class="description">GRANTG [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> GRANTG [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384226/176198/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176198">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi William,

Thanks for the patch.  Does get_comments work for you?  The same sort of processing is 
done there.  Unfortunately, this patch is subject to break if myspace makes a minute change 
in the way they format lines &#40;which they do on a regular basis&#41;.  I&#39;d like to figure out why the 
regex is hanging certain systems.

Thanks,

Grant

On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Okay... this is not as eloquent as your solution, but it works for
&gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt; work on yours to.  Would love for you to try it out and let me know.
&gt; 
&gt; -William
&gt; 
&gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat linux.
&gt; sub _get_messages_from_page {
&gt; 
&gt;     my &#40; $dummy, %options &#41; = @_;
&gt;     my $page = $self-&gt;current_page-&gt;decoded_content;
&gt;     my @messages = &#40;&#41;;
&gt;     my $state = 0;                    # State Values
&gt;                                       # 0 - Beginning state, looking for beginning of message block
&gt;                                       # 1 - In message block, looking for data
&gt;                                       #     Will return to state=0 when we get the last data &#40;messageID
&gt; and subject&#41;
&gt;     my $sender;
&gt;     my $status;
&gt;     my $msg_id;
&gt;     my $subject;
&gt; 
&gt;     open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt;     while &#40; &lt;$fh&gt; &#41; {
&gt;       chomp;
&gt;         last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} == $3 &#41; &#41;;
&gt;       if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt; /&#41;{
&gt;               # Found beginning of Message block
&gt;               $state = 1;
&gt;       } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt;               $sender = $1;
&gt;       } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt;               $status = $1;
&gt;       } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt;               $msg_id = $1;
&gt;               $subject = $2;
&gt;               $state = 0;    #return to state=0 because we need to start looking
&gt; for the beginning of the next message block
&gt;               
&gt;               push @messages, { sender =&gt; $sender, status =&gt; $status, message_id
&gt; =&gt; $msg_id, subject =&gt; $subject };
&gt;               if &#40;$DEBUG&#41; { print $sender,&#34;|&#34;,$status,&#34;|&#34;,$msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
&gt;       }
&gt;     }
&gt;     return @messages;
&gt; }
&gt; 
&gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt; &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt;
&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt;
&gt; &gt; Please upgrade to the current version of WWW::Myspace.
&gt; &gt;
&gt; &gt; The loop will exit when all the messages have been parsed - the $page
&gt; &gt; variable is modified through each loop.  If the RE being matched
&gt; &gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the loop
&gt; &gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; &gt; problem.
&gt; &gt;
&gt; &gt; There is a known issue, however, that could cause an endless loop in
&gt; &gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries to go
&gt; &gt; to the next page, but gets the same one instead&#41;.  The method works
&gt; &gt; for me however &#40;on MacOS 10.5&#41;.
&gt; &gt;
&gt; &gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt; &gt;       Queue: WWW-Myspace
&gt; &gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt; &gt;       Owner: Nobody
&gt; &gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt; &gt;      Status: new
&gt; &gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt; &gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt; &gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt; &gt; &gt; sub get_inbox.
&gt; &gt; &gt;
&gt; &gt; &gt;
</div>&gt; &gt;
&gt; &gt;
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384231" href="/Public/Bug/Display.html?id=30762#txn-384231">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;11:38:50&nbsp;2007</span>
    <span class="description">eewill40z [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 10:31:40 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;William Zorn&#34; &lt;eewill40z [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/384231/176204/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176204">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m moving on to that one next.

I think it is breaking because of some strange character that shows up in
the string.  I&#39;ve seen something like this happen when you try to use a DOS
file on UNIX with perl.  I also get an &#34;Extremely long character&#34;
message when I&#39;m sending the output to a file via the &#34;&gt;&#34; on the command
line.  Can&#39;t tell you what it&#39;s complaining about, but my guess is that
might be the problem.  I just don&#39;t know how to fix it.  Maybe, if you have
some UNIX development contacts you could get them to look at it.  I&#39;m
basically an amature, but I love to mess around with perl.

-William


On 11/16/07, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Hi William,
&gt;
&gt; Thanks for the patch.  Does get_comments work for you?  The same sort of
&gt; processing is
&gt; done there.  Unfortunately, this patch is subject to break if myspace
&gt; makes a minute change
&gt; in the way they format lines &#40;which they do on a regular basis&#41;.  I&#39;d like
&gt; to figure out why the
&gt; regex is hanging certain systems.
&gt;
&gt; Thanks,
&gt;
&gt; Grant
&gt;
&gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; Okay... this is not as eloquent as your solution, but it works for
&gt; &gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt; &gt; work on yours to.  Would love for you to try it out and let me know.
&gt; &gt;
&gt; &gt; -William
&gt; &gt;
&gt; &gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat linux.
&gt; &gt; sub _get_messages_from_page {
&gt; &gt;
&gt; &gt;     my &#40; $dummy, %options &#41; = @_;
&gt; &gt;     my $page = $self-&gt;current_page-&gt;decoded_content;
&gt; &gt;     my @messages = &#40;&#41;;
&gt; &gt;     my $state = 0;                    # State Values
&gt; &gt;                                       # 0 - Beginning state, looking for
</div>&gt; beginning of message block
<div class="message-stanza open">&gt; &gt;                                       # 1 - In message block, looking
</div>&gt; for data
<div class="message-stanza open">&gt; &gt;                                       #     Will return to state=0 when
</div>&gt; we get the last data &#40;messageID
<div class="message-stanza open">&gt; &gt; and subject&#41;
&gt; &gt;     my $sender;
&gt; &gt;     my $status;
&gt; &gt;     my $msg_id;
&gt; &gt;     my $subject;
&gt; &gt;
&gt; &gt;     open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt; &gt;     while &#40; &lt;$fh&gt; &#41; {
&gt; &gt;       chomp;
&gt; &gt;         last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} == $3 &#41;
</div>&gt; &#41;;
<div class="message-stanza open">&gt; &gt;       if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt; &gt; /&#41;{
&gt; &gt;               # Found beginning of Message block
&gt; &gt;               $state = 1;
&gt; &gt;       } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $sender = $1;
&gt; &gt;       } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $status = $1;
&gt; &gt;       } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $msg_id = $1;
&gt; &gt;               $subject = $2;
&gt; &gt;               $state = 0;    #return to state=0 because we need to start
</div>&gt; looking
<div class="message-stanza open">&gt; &gt; for the beginning of the next message block
&gt; &gt;
&gt; &gt;               push @messages, { sender =&gt; $sender, status =&gt; $status,
</div>&gt; message_id
<div class="message-stanza open">&gt; &gt; =&gt; $msg_id, subject =&gt; $subject };
&gt; &gt;               if &#40;$DEBUG&#41; { print
</div>&gt; $sender,&#34;|&#34;,$status,&#34;|&#34;,$msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
<div class="message-stanza open">&gt; &gt;       }
&gt; &gt;     }
&gt; &gt;     return @messages;
&gt; &gt; }
&gt; &gt;
&gt; &gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt; &gt; &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Please upgrade to the current version of WWW::Myspace.
&gt; &gt; &gt;
&gt; &gt; &gt; The loop will exit when all the messages have been parsed - the $page
&gt; &gt; &gt; variable is modified through each loop.  If the RE being matched
&gt; &gt; &gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the loop
&gt; &gt; &gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; &gt; &gt; problem.
&gt; &gt; &gt;
&gt; &gt; &gt; There is a known issue, however, that could cause an endless loop in
&gt; &gt; &gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries to go
&gt; &gt; &gt; to the next page, but gets the same one instead&#41;.  The method works
&gt; &gt; &gt; for me however &#40;on MacOS 10.5&#41;.
&gt; &gt; &gt;
&gt; &gt; &gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; &gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt; &gt; &gt;       Queue: WWW-Myspace
&gt; &gt; &gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt; &gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt; &gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt; &gt; &gt;       Owner: Nobody
&gt; &gt; &gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt; &gt; &gt;      Status: new
&gt; &gt; &gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; &gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt; &gt; &gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt; &gt; &gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt; &gt; &gt; &gt; sub get_inbox.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
</div>&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
</div></div>&gt;
&gt;
&gt;
&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384231/176205/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176205">with headers</a>
<br />
<span class="downloadcontenttype">text/html 8.4k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384328" href="/Public/Bug/Display.html?id=30762#txn-384328">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;15:28:53&nbsp;2007</span>
    <span class="description">eewill40z [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 14:27:56 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;William Zorn&#34; &lt;eewill40z [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384328/176278/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176278">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Of course I&#39;d get it wrong... USE THIS ONE.... IT IS VERIFIED ON MY
SYSTEM... CHECK ON YOURS.

sub get_comments {
    shift;
    my &#40; $friend_id &#41; = @_;
    my @comments = &#40;&#41;;
    my $url=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comment.myspace.com/index.cfm?fuseaction=user.viewComments&#38;friendID=">http://comment.myspace.com/index.cfm?fuseaction=user.viewComments&#38;friendID=</a></span>&#34;.
            $friend_id;
    #my $eventtarget=&#39;ctl00$Main$PagedComments$pagingNavigation1$NextLinkButton&#39;;
    my $eventtarget=&#39;ctl00$cpMain$PagedComments$pagerTop&#39;;      # WZ
11162007 - Changed from the above comment
    my $eventvalidation;
    my $viewstate;
    my $page=&#34;&#34;;
    my $commentcount;

    $self-&gt;_die_unless_logged_in&#40; &#39;get_comments&#39; &#41;;

    # only get a maximum of 50 comment pages
    # this should translate to 2500 comments
    # and also serves as a safety measure in case
    # the method breaks again

    &#40; $DEBUG &#41; &#38;&#38; print &#34;Getting $url\n&#34;;
    $page = $self-&gt;get_page&#40; $url &#41;;

    #raise an error if its private
    #if&#40;$self-&gt;is_private&#40;page =&gt; $page&#41;&#41; {
      #$self-&gt;error&#40;&#34;cannot get comments from private profile&#34;&#41;;
      #return undef;
    #}

    # find out how many comments in total
    if &#40;$page-&gt;decoded_content =~ /.*Listing [\d-]+ of &#40;\d+&#41;.*/smo&#41;{
        $commentcount=$1;
    } else {
        $self-&gt;error&#40;&#34;Could not find how many comments are on profile&#34;&#41;;
        return undef;
    }

    for &#40;my $i=1;$i&lt;=50;$i++&#41; {
        $page=$self-&gt;{current_page};
        

        push @comments, $self-&gt;_get_comments_from_page&#40;
$page-&gt;decoded_content &#41;;

        #make sure we did not get an error
        return undef if &#40;$self-&gt;error&#41;;

        last unless &#40; $self-&gt;_next_button&#40; $page-&gt;decoded_content &#41; &#41;;

        # WZ 11162007 - Comment out, __EVENTVALIDATION does not exist in the page.
        #get value of form field eventvalidation        
#        if &#40;$page-&gt;decoded_content =~ /id=\&#34;__EVENTVALIDATION\&#34;
value=\&#34;&#40;.*?&#41;\&#34;/o&#41;{
#            $eventvalidation=$1;
#        }
#        else {
#            $self-&gt;error&#40;&#34;get_comments could not determine
eventvalidation in form&#34;&#41;;
#            return undef;
#        }
#        #get value of form field viewstate
        if &#40;$page-&gt;decoded_content =~ /id=\&#34;__VIEWSTATE\&#34; value=\&#34;&#40;.*?&#41;\&#34;/o&#41;{
          $viewstate=$1;
        }
        else{
            $self-&gt;error&#40;&#34;get_comments could not determine viewstate in form&#34;&#41;;

            return undef;
        }

        #create a form using these values
        my $htmlform=qq{&lt;form name=&#34;aspnetForm&#34; method=&#34;post&#34;
action=&#34;/index.cfm?fuseaction=user.viewComments&#38;amp;friendID=$friend_id&#34;
id=&#34;aspnetForm&#34;&gt;}.
                qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTTARGET&#34;
id=&#34;__EVENTTARGET&#34; value=&#34;$eventtarget&#34; /&gt;}.
                qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTARGUMENT&#34;
id=&#34;__EVENTARGUMENT&#34; value=&#34;$i&#34; /&gt;}.    #WZ 11162007 - Changed to include
$i as the value for __EVENTARGUMENT
                qq{&lt;input type=&#34;hidden&#34; name=&#34;__VIEWSTATE&#34;
id=&#34;__VIEWSTATE&#34; value=&#34;$viewstate&#34; /&gt;}.
                #qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTVALIDATION&#34;
id=&#34;__EVENTVALIDATION&#34; value=&#34;$eventvalidation&#34; /&gt;}.
                qq{&lt;/form&gt;};
        my $form=HTML::Form-&gt;parse&#40;$htmlform,&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comment.myspace.com/index.cfm">http://comment.myspace.com/index.cfm</a></span>&#34;&#41;;

        &#40; $DEBUG &#41; &#38;&#38; print &#34;try to submit form to access comments
page #&#34;,$i,&#34;\n&#34;;

        #submit it and hope for the best
        $self-&gt;submit_form&#40;{form =&gt; $form,no_click=&gt; 1,follow=&gt;0}&#41;;

        #submit the form to get to next page
        #$self-&gt;submit_form&#40;{
        #        follow =&gt; 0,
        #        form_name =&gt; &#34;aspnetForm&#34;,
        #        no_click =&gt; 1,
        #        fields_ref =&gt; { __EVENTTARGET =&gt; $eventtarget,
__EVENTARGUMENT =&gt; &#39;&#39; }
        #        #re1 =&gt; &#39;something unique.?about this[ \t\n]+page&#39;,
        #    }&#41;;

        # sleep &#40; int&#40; rand&#40; 2 &#41; &#41; + 1 &#41;;
    }

#    unless&#40;scalar &#40;@comments&#41; == $commentcount&#41;{
#            $self-&gt;error&#40;&#34;Could not collect all comments. Have &#34; .
@comments .&#34;, should have $commentcount&#34;&#41;;
#        return undef;
#    }

    return \@comments;
}

On Nov 16, 2007 10:13 AM, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Hi William,
&gt;
&gt; Thanks for the patch.  Does get_comments work for you?  The same sort of processing is
&gt; done there.  Unfortunately, this patch is subject to break if myspace makes a minute change
&gt; in the way they format lines &#40;which they do on a regular basis&#41;.  I&#39;d like to figure out why the
&gt; regex is hanging certain systems.
&gt;
&gt; Thanks,
&gt;
&gt; Grant
&gt;
&gt;
&gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; Okay... this is not as eloquent as your solution, but it works for
&gt; &gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt; &gt; work on yours to.  Would love for you to try it out and let me know.
&gt; &gt;
&gt; &gt; -William
&gt; &gt;
&gt; &gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat linux.
&gt; &gt; sub _get_messages_from_page {
&gt; &gt;
&gt; &gt;     my &#40; $dummy, %options &#41; = @_;
&gt; &gt;     my $page = $self-&gt;current_page-&gt;decoded_content;
&gt; &gt;     my @messages = &#40;&#41;;
&gt; &gt;     my $state = 0;                    # State Values
&gt; &gt;                                       # 0 - Beginning state, looking for beginning of message block
&gt; &gt;                                       # 1 - In message block, looking for data
&gt; &gt;                                       #     Will return to state=0 when we get the last data &#40;messageID
&gt; &gt; and subject&#41;
&gt; &gt;     my $sender;
&gt; &gt;     my $status;
&gt; &gt;     my $msg_id;
&gt; &gt;     my $subject;
&gt; &gt;
&gt; &gt;     open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt; &gt;     while &#40; &lt;$fh&gt; &#41; {
&gt; &gt;       chomp;
&gt; &gt;         last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} == $3 &#41; &#41;;
&gt; &gt;       if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt; &gt; /&#41;{
&gt; &gt;               # Found beginning of Message block
&gt; &gt;               $state = 1;
&gt; &gt;       } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $sender = $1;
&gt; &gt;       } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $status = $1;
&gt; &gt;       } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $msg_id = $1;
&gt; &gt;               $subject = $2;
&gt; &gt;               $state = 0;    #return to state=0 because we need to start looking
&gt; &gt; for the beginning of the next message block
&gt; &gt;
&gt; &gt;               push @messages, { sender =&gt; $sender, status =&gt; $status, message_id
&gt; &gt; =&gt; $msg_id, subject =&gt; $subject };
&gt; &gt;               if &#40;$DEBUG&#41; { print $sender,&#34;|&#34;,$status,&#34;|&#34;,$msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
&gt; &gt;       }
&gt; &gt;     }
&gt; &gt;     return @messages;
&gt; &gt; }
&gt; &gt;
&gt; &gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt; &gt; &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Please upgrade to the current version of WWW::Myspace.
&gt; &gt; &gt;
&gt; &gt; &gt; The loop will exit when all the messages have been parsed - the $page
&gt; &gt; &gt; variable is modified through each loop.  If the RE being matched
&gt; &gt; &gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the loop
&gt; &gt; &gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; &gt; &gt; problem.
&gt; &gt; &gt;
&gt; &gt; &gt; There is a known issue, however, that could cause an endless loop in
&gt; &gt; &gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries to go
&gt; &gt; &gt; to the next page, but gets the same one instead&#41;.  The method works
&gt; &gt; &gt; for me however &#40;on MacOS 10.5&#41;.
&gt; &gt; &gt;
&gt; &gt; &gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; &gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt; &gt; &gt;       Queue: WWW-Myspace
&gt; &gt; &gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt; &gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt; &gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt; &gt; &gt;       Owner: Nobody
&gt; &gt; &gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt; &gt; &gt;      Status: new
&gt; &gt; &gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; &gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt; &gt; &gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt; &gt; &gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt; &gt; &gt; &gt; sub get_inbox.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
</div>&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
</div></div>&gt;
&gt;
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384330" href="/Public/Bug/Display.html?id=30762#txn-384330">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;15:35:59&nbsp;2007</span>
    <span class="description">eewill40z [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 14:09:13 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;William Zorn&#34; &lt;eewill40z [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384330/176280/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176280">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 8.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Get comments did not work for me, but for a different reason.  Does
this mean that myspace changed some stuff?  The eventtarget was
differnet and the __EVENTVALIDATION no longer existed in the page.
Did not have the same problem with the _get_comments... sub as the
_get_messages... sub.  So that was okay.

sub get_comments {
    shift;
    my &#40; $friend_id &#41; = @_;
    my @comments = &#40;&#41;;
    my $url=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comment.myspace.com/index.cfm?fuseaction=user.viewComments&#38;friendID=">http://comment.myspace.com/index.cfm?fuseaction=user.viewComments&#38;friendID=</a></span>&#34;.
            $friend_id;
    #my $eventtarget=&#39;ctl00$Main$PagedComments$pagingNavigation1$NextLinkButton&#39;;
    my $eventtarget=&#39;ctl00$cpMain$PagedComments$pagerTop&#39;;      # WZ
11162007 - Changed from the above comment
    my $eventvalidation;
    my $viewstate;
    my $page=&#34;&#34;;
    my $next_i=0;       #WZ 11162007 - Added and initialized to zero &#40;next
page number&#41;
    my $commentcount;

    $self-&gt;_die_unless_logged_in&#40; &#39;get_comments&#39; &#41;;

    # only get a maximum of 50 comment pages
    # this should translate to 2500 comments
    # and also serves as a safety measure in case
    # the method breaks again

    &#40; $DEBUG &#41; &#38;&#38; print &#34;Getting $url\n&#34;;
    $page = $self-&gt;get_page&#40; $url &#41;;

    #raise an error if its private
    #if&#40;$self-&gt;is_private&#40;page =&gt; $page&#41;&#41; {
      #$self-&gt;error&#40;&#34;cannot get comments from private profile&#34;&#41;;
      #return undef;
    #}

    # find out how many comments in total
    if &#40;$page-&gt;decoded_content =~ /.*Listing [\d-]+ of &#40;\d+&#41;.*/smo&#41;{
        $commentcount=$1;
    } else {
        $self-&gt;error&#40;&#34;Could not find how many comments are on profile&#34;&#41;;
        return undef;
    }

    for &#40;my $i=1;$i&lt;=50;$i++&#41; {
        $page=$self-&gt;{current_page};
        $next_i = $i++;         #WZ 11162007 - increment i to get next page number
        

        push @comments, $self-&gt;_get_comments_from_page&#40;
$page-&gt;decoded_content &#41;;

        #make sure we did not get an error
        return undef if &#40;$self-&gt;error&#41;;

        last unless &#40; $self-&gt;_next_button&#40; $page-&gt;decoded_content &#41; &#41;;

        # WZ 11162007 - Comment out, __EVENTVALIDATION does not exist in the page.
        #get value of form field eventvalidation        
#        if &#40;$page-&gt;decoded_content =~ /id=\&#34;__EVENTVALIDATION\&#34;
value=\&#34;&#40;.*?&#41;\&#34;/o&#41;{
#            $eventvalidation=$1;
#        }
#        else {
#            $self-&gt;error&#40;&#34;get_comments could not determine
eventvalidation in form&#34;&#41;;
#            return undef;
#        }
#        #get value of form field viewstate
        if &#40;$page-&gt;decoded_content =~ /id=\&#34;__VIEWSTATE\&#34; value=\&#34;&#40;.*?&#41;\&#34;/o&#41;{
          $viewstate=$1;
        }
        else{
            $self-&gt;error&#40;&#34;get_comments could not determine viewstate in form&#34;&#41;;

            return undef;
        }

        #create a form using these values
        my $htmlform=qq{&lt;form name=&#34;aspnetForm&#34; method=&#34;post&#34;
action=&#34;/index.cfm?fuseaction=user.viewComments&#38;amp;friendID=$friend_id&#34;
id=&#34;aspnetForm&#34;&gt;}.
                qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTTARGET&#34;
id=&#34;__EVENTTARGET&#34; value=&#34;$eventtarget&#34; /&gt;}.
                qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTARGUMENT&#34;
id=&#34;__EVENTARGUMENT&#34; value=&#34;$next_i&#34; /&gt;}.       #WZ 11162007 - Changed to
include $next_i as the value for __EVENTARGUMENT
                qq{&lt;input type=&#34;hidden&#34; name=&#34;__VIEWSTATE&#34;
id=&#34;__VIEWSTATE&#34; value=&#34;$viewstate&#34; /&gt;}.
                #qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTVALIDATION&#34;
id=&#34;__EVENTVALIDATION&#34; value=&#34;$eventvalidation&#34; /&gt;}.
                qq{&lt;/form&gt;};
        my $form=HTML::Form-&gt;parse&#40;$htmlform,&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comment.myspace.com/index.cfm">http://comment.myspace.com/index.cfm</a></span>&#34;&#41;;

        &#40; $DEBUG &#41; &#38;&#38; print &#34;try to submit form to access comments
page #&#34;,$i+1,&#34;\n&#34;;

        #submit it and hope for the best
        $self-&gt;submit_form&#40;{form =&gt; $form,no_click=&gt; 1,follow=&gt;0}&#41;;

        #submit the form to get to next page
        #$self-&gt;submit_form&#40;{
        #        follow =&gt; 0,
        #        form_name =&gt; &#34;aspnetForm&#34;,
        #        no_click =&gt; 1,
        #        fields_ref =&gt; { __EVENTTARGET =&gt; $eventtarget,
__EVENTARGUMENT =&gt; &#39;&#39; }
        #        #re1 =&gt; &#39;something unique.?about this[ \t\n]+page&#39;,
        #    }&#41;;

        # sleep &#40; int&#40; rand&#40; 2 &#41; &#41; + 1 &#41;;
    }

#    unless&#40;scalar &#40;@comments&#41; == $commentcount&#41;{
#            $self-&gt;error&#40;&#34;Could not collect all comments. Have &#34; .
@comments .&#34;, should have $commentcount&#34;&#41;;
#        return undef;
#    }

    return \@comments;
}

On Nov 16, 2007 10:13 AM, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Hi William,
&gt;
&gt; Thanks for the patch.  Does get_comments work for you?  The same sort of processing is
&gt; done there.  Unfortunately, this patch is subject to break if myspace makes a minute change
&gt; in the way they format lines &#40;which they do on a regular basis&#41;.  I&#39;d like to figure out why the
&gt; regex is hanging certain systems.
&gt;
&gt; Thanks,
&gt;
&gt; Grant
&gt;
&gt;
&gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; Okay... this is not as eloquent as your solution, but it works for
&gt; &gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt; &gt; work on yours to.  Would love for you to try it out and let me know.
&gt; &gt;
&gt; &gt; -William
&gt; &gt;
&gt; &gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat linux.
&gt; &gt; sub _get_messages_from_page {
&gt; &gt;
&gt; &gt;     my &#40; $dummy, %options &#41; = @_;
&gt; &gt;     my $page = $self-&gt;current_page-&gt;decoded_content;
&gt; &gt;     my @messages = &#40;&#41;;
&gt; &gt;     my $state = 0;                    # State Values
&gt; &gt;                                       # 0 - Beginning state, looking for beginning of message block
&gt; &gt;                                       # 1 - In message block, looking for data
&gt; &gt;                                       #     Will return to state=0 when we get the last data &#40;messageID
&gt; &gt; and subject&#41;
&gt; &gt;     my $sender;
&gt; &gt;     my $status;
&gt; &gt;     my $msg_id;
&gt; &gt;     my $subject;
&gt; &gt;
&gt; &gt;     open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt; &gt;     while &#40; &lt;$fh&gt; &#41; {
&gt; &gt;       chomp;
&gt; &gt;         last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} == $3 &#41; &#41;;
&gt; &gt;       if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt; &gt; /&#41;{
&gt; &gt;               # Found beginning of Message block
&gt; &gt;               $state = 1;
&gt; &gt;       } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $sender = $1;
&gt; &gt;       } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $status = $1;
&gt; &gt;       } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $msg_id = $1;
&gt; &gt;               $subject = $2;
&gt; &gt;               $state = 0;    #return to state=0 because we need to start looking
&gt; &gt; for the beginning of the next message block
&gt; &gt;
&gt; &gt;               push @messages, { sender =&gt; $sender, status =&gt; $status, message_id
&gt; &gt; =&gt; $msg_id, subject =&gt; $subject };
&gt; &gt;               if &#40;$DEBUG&#41; { print $sender,&#34;|&#34;,$status,&#34;|&#34;,$msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
&gt; &gt;       }
&gt; &gt;     }
&gt; &gt;     return @messages;
&gt; &gt; }
&gt; &gt;
&gt; &gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt; &gt; &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Please upgrade to the current version of WWW::Myspace.
&gt; &gt; &gt;
&gt; &gt; &gt; The loop will exit when all the messages have been parsed - the $page
&gt; &gt; &gt; variable is modified through each loop.  If the RE being matched
&gt; &gt; &gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the loop
&gt; &gt; &gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; &gt; &gt; problem.
&gt; &gt; &gt;
&gt; &gt; &gt; There is a known issue, however, that could cause an endless loop in
&gt; &gt; &gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries to go
&gt; &gt; &gt; to the next page, but gets the same one instead&#41;.  The method works
&gt; &gt; &gt; for me however &#40;on MacOS 10.5&#41;.
&gt; &gt; &gt;
&gt; &gt; &gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; &gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt; &gt; &gt;       Queue: WWW-Myspace
&gt; &gt; &gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt; &gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt; &gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt; &gt; &gt;       Owner: Nobody
&gt; &gt; &gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt; &gt; &gt;      Status: new
&gt; &gt; &gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; &gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt; &gt; &gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt; &gt; &gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt; &gt; &gt; &gt; sub get_inbox.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
</div>&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
</div></div>&gt;
&gt;
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384357" href="/Public/Bug/Display.html?id=30762#txn-384357">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;16:24:39&nbsp;2007</span>
    <span class="description">grantg [...] spamarrest.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 13:23:56 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Grant Grueninger &lt;grantg [...] spamarrest.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384357/176297/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176297">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 10.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi William,

I mentioned this in the duplicate bug report also - try updating to  
the most recent WWW::Mechanize and HTML::Parser &#40;if you&#39;re not already  
running them&#41;.  Steve &#40;bug#30351&#41; thinks the regex parser might be  
hanging on malformed UTF-8 characters &#40;which is probably what you&#39;re  
seeing with the &#34;extremely long character&#34; error.  I want to see if  
HTML::Parser and/or WWW::Mechanize may have updated something that  
fixes that.

On Nov 16, 2007, at 8:38 AM, William Zorn via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;       Queue: WWW-Myspace
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; I&#39;m moving on to that one next.
&gt;
&gt; I think it is breaking because of some strange character that shows  
&gt; up in
&gt; the string.  I&#39;ve seen something like this happen when you try to  
&gt; use a DOS
&gt; file on UNIX with perl.  I also get an &#34;Extremely long character&#34;
&gt; message when I&#39;m sending the output to a file via the &#34;&gt;&#34; on the  
&gt; command
&gt; line.  Can&#39;t tell you what it&#39;s complaining about, but my guess is  
&gt; that
&gt; might be the problem.  I just don&#39;t know how to fix it.  Maybe, if  
&gt; you have
&gt; some UNIX development contacts you could get them to look at it.  I&#39;m
&gt; basically an amature, but I love to mess around with perl.
&gt;
&gt; -William
&gt;
&gt;
&gt; On 11/16/07, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;&gt;
&gt;&gt;
&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;&gt;
&gt;&gt; Hi William,
&gt;&gt;
&gt;&gt; Thanks for the patch.  Does get_comments work for you?  The same  
&gt;&gt; sort of
&gt;&gt; processing is
&gt;&gt; done there.  Unfortunately, this patch is subject to break if myspace
&gt;&gt; makes a minute change
&gt;&gt; in the way they format lines &#40;which they do on a regular basis&#41;.   
&gt;&gt; I&#39;d like
&gt;&gt; to figure out why the
&gt;&gt; regex is hanging certain systems.
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; Grant
&gt;&gt;
&gt;&gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt;&gt;&gt; Okay... this is not as eloquent as your solution, but it works for
&gt;&gt;&gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt;&gt;&gt; work on yours to.  Would love for you to try it out and let me know.
&gt;&gt;&gt;
&gt;&gt;&gt; -William
&gt;&gt;&gt;
&gt;&gt;&gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat  
&gt;&gt;&gt; linux.
&gt;&gt;&gt; sub _get_messages_from_page {
&gt;&gt;&gt;
&gt;&gt;&gt;    my &#40; $dummy, %options &#41; = @_;
&gt;&gt;&gt;    my $page = $self-&gt;current_page-&gt;decoded_content;
&gt;&gt;&gt;    my @messages = &#40;&#41;;
&gt;&gt;&gt;    my $state = 0;                    # State Values
&gt;&gt;&gt;                                      # 0 - Beginning state,  
&gt;&gt;&gt; looking for
</div>&gt;&gt; beginning of message block
<div class="message-stanza open">&gt;&gt;&gt;                                      # 1 - In message block, looking
</div>&gt;&gt; for data
<div class="message-stanza open">&gt;&gt;&gt;                                      #     Will return to state=0  
&gt;&gt;&gt; when
</div>&gt;&gt; we get the last data &#40;messageID
<div class="message-stanza open">&gt;&gt;&gt; and subject&#41;
&gt;&gt;&gt;    my $sender;
&gt;&gt;&gt;    my $status;
&gt;&gt;&gt;    my $msg_id;
&gt;&gt;&gt;    my $subject;
&gt;&gt;&gt;
&gt;&gt;&gt;    open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt;&gt;&gt;    while &#40; &lt;$fh&gt; &#41; {
&gt;&gt;&gt;      chomp;
&gt;&gt;&gt;        last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} ==  
&gt;&gt;&gt; $3 &#41;
</div>&gt;&gt; &#41;;
<div class="message-stanza open">&gt;&gt;&gt;      if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt;&gt;&gt; /&#41;{
&gt;&gt;&gt;              # Found beginning of Message block
&gt;&gt;&gt;              $state = 1;
&gt;&gt;&gt;      } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt;&gt;&gt;              $sender = $1;
&gt;&gt;&gt;      } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt;&gt;&gt;              $status = $1;
&gt;&gt;&gt;      } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt;&gt;&gt;              $msg_id = $1;
&gt;&gt;&gt;              $subject = $2;
&gt;&gt;&gt;              $state = 0;    #return to state=0 because we need to  
&gt;&gt;&gt; start
</div>&gt;&gt; looking
<div class="message-stanza open">&gt;&gt;&gt; for the beginning of the next message block
&gt;&gt;&gt;
&gt;&gt;&gt;              push @messages, { sender =&gt; $sender, status =&gt; $status,
</div>&gt;&gt; message_id
<div class="message-stanza open">&gt;&gt;&gt; =&gt; $msg_id, subject =&gt; $subject };
&gt;&gt;&gt;              if &#40;$DEBUG&#41; { print
</div>&gt;&gt; $sender,&#34;|&#34;,$status,&#34;|&#34;,$msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
<div class="message-stanza open">&gt;&gt;&gt;      }
&gt;&gt;&gt;    }
&gt;&gt;&gt;    return @messages;
&gt;&gt;&gt; }
&gt;&gt;&gt;
&gt;&gt;&gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt;&gt;&gt; &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Please upgrade to the current version of WWW::Myspace.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; The loop will exit when all the messages have been parsed - the  
&gt;&gt;&gt;&gt; $page
&gt;&gt;&gt;&gt; variable is modified through each loop.  If the RE being matched
&gt;&gt;&gt;&gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the  
&gt;&gt;&gt;&gt; loop
&gt;&gt;&gt;&gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt;&gt;&gt;&gt; problem.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; There is a known issue, however, that could cause an endless loop  
&gt;&gt;&gt;&gt; in
&gt;&gt;&gt;&gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries  
&gt;&gt;&gt;&gt; to go
&gt;&gt;&gt;&gt; to the next page, but gets the same one instead&#41;.  The method works
&gt;&gt;&gt;&gt; for me however &#40;on MacOS 10.5&#41;.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt;&gt;&gt;&gt;&gt; Transaction: Ticket created by eewill40z@gmail.com
&gt;&gt;&gt;&gt;&gt;      Queue: WWW-Myspace
&gt;&gt;&gt;&gt;&gt;    Subject: Get_inbox hang, ref bug 30351
&gt;&gt;&gt;&gt;&gt;  Broken in: &#40;no value&#41;
&gt;&gt;&gt;&gt;&gt;   Severity: &#40;no value&#41;
&gt;&gt;&gt;&gt;&gt;      Owner: Nobody
&gt;&gt;&gt;&gt;&gt; Requestors: eewill40z@gmail.com
&gt;&gt;&gt;&gt;&gt;     Status: new
&gt;&gt;&gt;&gt;&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt;&gt;&gt;&gt;&gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt;&gt;&gt;&gt;&gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt;&gt;&gt;&gt;&gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt;&gt;&gt;&gt;&gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt;&gt;&gt;&gt;&gt; sub get_inbox.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
</div>&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
</div></div>&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
</div>&gt;
&gt; I&#39;m moving on to that one next.
&gt;
&gt; I think it is breaking because of some strange character that shows  
&gt; up in the string.  I&#39;ve seen something like this happen when you try  
&gt; to use a DOS file on UNIX with perl.  I also get an &#34;Extremely long  
&gt; character&#34; message when I&#39;m sending the output to a file via the &#34;&gt;&#34;  
&gt; on the command line.  Can&#39;t tell you what it&#39;s complaining about,  
&gt; but my guess is that might be the problem.  I just don&#39;t know how to  
&gt; fix it.  Maybe, if you have some UNIX development contacts you could  
&gt; get them to look at it.  I&#39;m basically an amature, but I love to  
&gt; mess around with perl.
&gt;
&gt; -William
&gt;
&gt;
&gt; On 11/16/07, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Hi William,
&gt;
&gt; Thanks for the patch.  Does get_comments work for you?  The same  
&gt; sort of processing is
&gt; done there.  Unfortunately, this patch is subject to break if  
&gt; myspace makes a minute change
&gt; in the way they format lines &#40;which they do on a regular basis&#41;.   
&gt; I&#39;d like to figure out why the
&gt; regex is hanging certain systems.
&gt;
&gt; Thanks,
&gt;
&gt; Grant
&gt;
&gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; Okay... this is not as eloquent as your solution, but it works for
&gt; &gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt; &gt; work on yours to.  Would love for you to try it out and let me know.
&gt; &gt;
&gt; &gt; -William
&gt; &gt;
&gt; &gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat  
</div>&gt; linux.
<div class="message-stanza open">&gt; &gt; sub _get_messages_from_page {
&gt; &gt;
&gt; &gt;     my &#40; $dummy, %options &#41; = @_;
&gt; &gt;     my $page = $self-&gt;current_page-&gt;decoded_content;
&gt; &gt;     my @messages = &#40;&#41;;
&gt; &gt;     my $state = 0;                    # State Values
&gt; &gt;                                       # 0 - Beginning state,  
</div>&gt; looking for beginning of message block
<div class="message-stanza open">&gt; &gt;                                       # 1 - In message block,  
</div>&gt; looking for data
<div class="message-stanza open">&gt; &gt;                                       #     Will return to state=0  
</div>&gt; when we get the last data &#40;messageID
<div class="message-stanza open">&gt; &gt; and subject&#41;
&gt; &gt;     my $sender;
&gt; &gt;     my $status;
&gt; &gt;     my $msg_id;
&gt; &gt;     my $subject;
&gt; &gt;
&gt; &gt;     open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt; &gt;     while &#40; &lt;$fh&gt; &#41; {
&gt; &gt;       chomp;
&gt; &gt;         last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} ==  
</div>&gt; $3 &#41; &#41;;
<div class="message-stanza open">&gt; &gt;       if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt; &gt; /&#41;{
&gt; &gt;               # Found beginning of Message block
&gt; &gt;               $state = 1;
&gt; &gt;       } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $sender = $1;
&gt; &gt;       } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $status = $1;
&gt; &gt;       } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;               $msg_id = $1;
&gt; &gt;               $subject = $2;
&gt; &gt;               $state = 0;    #return to state=0 because we need to  
</div>&gt; start looking
<div class="message-stanza open">&gt; &gt; for the beginning of the next message block
&gt; &gt;
&gt; &gt;               push @messages, { sender =&gt; $sender, status =&gt;  
</div>&gt; $status, message_id
<div class="message-stanza open">&gt; &gt; =&gt; $msg_id, subject =&gt; $subject };
&gt; &gt;               if &#40;$DEBUG&#41; { print $sender,&#34;|&#34;,$status,&#34;|&#34;, 
</div>&gt; $msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
<div class="message-stanza open">&gt; &gt;       }
&gt; &gt;     }
&gt; &gt;     return @messages;
&gt; &gt; }
&gt; &gt;
&gt; &gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt; &gt; &lt; bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; &gt;
&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Please upgrade to the current version of WWW::Myspace.
&gt; &gt; &gt;
&gt; &gt; &gt; The loop will exit when all the messages have been parsed - the  
</div></div>&gt; $page
<div class="message-stanza open">&gt; &gt; &gt; variable is modified through each loop.  If the RE being matched
&gt; &gt; &gt; against $page doesn&#39;t match &#40; i.e. due to a myspace change&#41;, the  
</div>&gt; loop
<div class="message-stanza open">&gt; &gt; &gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; &gt; &gt; problem.
&gt; &gt; &gt;
&gt; &gt; &gt; There is a known issue, however, that could cause an endless  
</div>&gt; loop in
<div class="message-stanza open">&gt; &gt; &gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries  
</div>&gt; to go
<div class="message-stanza open">&gt; &gt; &gt; to the next page, but gets the same one instead&#41;.  The method  
</div>&gt; works
<div class="message-stanza open">&gt; &gt; &gt; for me however &#40;on MacOS 10.5&#41;.
&gt; &gt; &gt;
&gt; &gt; &gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; &gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt; &gt; &gt;       Queue: WWW-Myspace
&gt; &gt; &gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt; &gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt; &gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt; &gt; &gt;       Owner: Nobody
&gt; &gt; &gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt; &gt; &gt;      Status: new
&gt; &gt; &gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; &gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The  
</div></div>&gt; hash
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.   
</div></div>&gt; Same
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in  
</div></div>&gt; the
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; sub get_inbox.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
</div>&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
</div>&gt;
&gt;
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384360" href="/Public/Bug/Display.html?id=30762#txn-384360">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;16:30:39&nbsp;2007</span>
    <span class="description">eewill40z [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 15:29:51 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;William Zorn&#34; &lt;eewill40z [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/384360/176301/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176301">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 11k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Nope... I downloaded the latest ones last night and saw the problem.

On 11/16/07, grantg@spamarrest.com via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt;
wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Hi William,
&gt;
&gt; I mentioned this in the duplicate bug report also - try updating to
&gt; the most recent WWW::Mechanize and HTML::Parser &#40;if you&#39;re not already
&gt; running them&#41;.  Steve &#40;bug#30351&#41; thinks the regex parser might be
&gt; hanging on malformed UTF-8 characters &#40;which is probably what you&#39;re
&gt; seeing with the &#34;extremely long character&#34; error.  I want to see if
&gt; HTML::Parser and/or WWW::Mechanize may have updated something that
&gt; fixes that.
&gt;
&gt; On Nov 16, 2007, at 8:38 AM, William Zorn via RT wrote:
&gt;
<div class="message-stanza open">&gt; &gt;
&gt; &gt;       Queue: WWW-Myspace
&gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt;
&gt; &gt; I&#39;m moving on to that one next.
&gt; &gt;
&gt; &gt; I think it is breaking because of some strange character that shows
&gt; &gt; up in
&gt; &gt; the string.  I&#39;ve seen something like this happen when you try to
&gt; &gt; use a DOS
&gt; &gt; file on UNIX with perl.  I also get an &#34;Extremely long character&#34;
&gt; &gt; message when I&#39;m sending the output to a file via the &#34;&gt;&#34; on the
&gt; &gt; command
&gt; &gt; line.  Can&#39;t tell you what it&#39;s complaining about, but my guess is
&gt; &gt; that
&gt; &gt; might be the problem.  I just don&#39;t know how to fix it.  Maybe, if
&gt; &gt; you have
&gt; &gt; some UNIX development contacts you could get them to look at it.  I&#39;m
&gt; &gt; basically an amature, but I love to mess around with perl.
&gt; &gt;
&gt; &gt; -William
&gt; &gt;
&gt; &gt;
&gt; &gt; On 11/16/07, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt;&gt;
&gt; &gt;&gt; Hi William,
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks for the patch.  Does get_comments work for you?  The same
&gt; &gt;&gt; sort of
&gt; &gt;&gt; processing is
&gt; &gt;&gt; done there.  Unfortunately, this patch is subject to break if myspace
&gt; &gt;&gt; makes a minute change
&gt; &gt;&gt; in the way they format lines &#40;which they do on a regular basis&#41;.
&gt; &gt;&gt; I&#39;d like
&gt; &gt;&gt; to figure out why the
&gt; &gt;&gt; regex is hanging certain systems.
&gt; &gt;&gt;
&gt; &gt;&gt; Thanks,
&gt; &gt;&gt;
&gt; &gt;&gt; Grant
&gt; &gt;&gt;
&gt; &gt;&gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt; Okay... this is not as eloquent as your solution, but it works for
&gt; &gt;&gt;&gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt; &gt;&gt;&gt; work on yours to.  Would love for you to try it out and let me know.
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; -William
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat
&gt; &gt;&gt;&gt; linux.
&gt; &gt;&gt;&gt; sub _get_messages_from_page {
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;    my &#40; $dummy, %options &#41; = @_;
&gt; &gt;&gt;&gt;    my $page = $self-&gt;current_page-&gt;decoded_content;
&gt; &gt;&gt;&gt;    my @messages = &#40;&#41;;
&gt; &gt;&gt;&gt;    my $state = 0;                    # State Values
&gt; &gt;&gt;&gt;                                      # 0 - Beginning state,
&gt; &gt;&gt;&gt; looking for
</div>&gt; &gt;&gt; beginning of message block
<div class="message-stanza open">&gt; &gt;&gt;&gt;                                      # 1 - In message block, looking
</div>&gt; &gt;&gt; for data
<div class="message-stanza open">&gt; &gt;&gt;&gt;                                      #     Will return to state=0
&gt; &gt;&gt;&gt; when
</div>&gt; &gt;&gt; we get the last data &#40;messageID
<div class="message-stanza open">&gt; &gt;&gt;&gt; and subject&#41;
&gt; &gt;&gt;&gt;    my $sender;
&gt; &gt;&gt;&gt;    my $status;
&gt; &gt;&gt;&gt;    my $msg_id;
&gt; &gt;&gt;&gt;    my $subject;
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;    open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt; &gt;&gt;&gt;    while &#40; &lt;$fh&gt; &#41; {
&gt; &gt;&gt;&gt;      chomp;
&gt; &gt;&gt;&gt;        last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} ==
&gt; &gt;&gt;&gt; $3 &#41;
</div>&gt; &gt;&gt; &#41;;
<div class="message-stanza open">&gt; &gt;&gt;&gt;      if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt; &gt;&gt;&gt; /&#41;{
&gt; &gt;&gt;&gt;              # Found beginning of Message block
&gt; &gt;&gt;&gt;              $state = 1;
&gt; &gt;&gt;&gt;      } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;&gt;&gt;              $sender = $1;
&gt; &gt;&gt;&gt;      } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;&gt;&gt;              $status = $1;
&gt; &gt;&gt;&gt;      } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt; &gt;&gt;&gt;              $msg_id = $1;
&gt; &gt;&gt;&gt;              $subject = $2;
&gt; &gt;&gt;&gt;              $state = 0;    #return to state=0 because we need to
&gt; &gt;&gt;&gt; start
</div>&gt; &gt;&gt; looking
<div class="message-stanza open">&gt; &gt;&gt;&gt; for the beginning of the next message block
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt;              push @messages, { sender =&gt; $sender, status =&gt; $status,
</div>&gt; &gt;&gt; message_id
<div class="message-stanza open">&gt; &gt;&gt;&gt; =&gt; $msg_id, subject =&gt; $subject };
&gt; &gt;&gt;&gt;              if &#40;$DEBUG&#41; { print
</div>&gt; &gt;&gt; $sender,&#34;|&#34;,$status,&#34;|&#34;,$msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
<div class="message-stanza open">&gt; &gt;&gt;&gt;      }
&gt; &gt;&gt;&gt;    }
&gt; &gt;&gt;&gt;    return @messages;
&gt; &gt;&gt;&gt; }
&gt; &gt;&gt;&gt;
&gt; &gt;&gt;&gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt; &gt;&gt;&gt; &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; Please upgrade to the current version of WWW::Myspace.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; The loop will exit when all the messages have been parsed - the
&gt; &gt;&gt;&gt;&gt; $page
&gt; &gt;&gt;&gt;&gt; variable is modified through each loop.  If the RE being matched
&gt; &gt;&gt;&gt;&gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the
&gt; &gt;&gt;&gt;&gt; loop
&gt; &gt;&gt;&gt;&gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; &gt;&gt;&gt;&gt; problem.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; There is a known issue, however, that could cause an endless loop
&gt; &gt;&gt;&gt;&gt; in
&gt; &gt;&gt;&gt;&gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries
&gt; &gt;&gt;&gt;&gt; to go
&gt; &gt;&gt;&gt;&gt; to the next page, but gets the same one instead&#41;.  The method works
&gt; &gt;&gt;&gt;&gt; for me however &#40;on MacOS 10.5&#41;.
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt; &gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt;&gt;&gt;&gt;&gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt;&gt;&gt;&gt;&gt;      Queue: WWW-Myspace
&gt; &gt;&gt;&gt;&gt;&gt;    Subject: Get_inbox hang, ref bug 30351
&gt; &gt;&gt;&gt;&gt;&gt;  Broken in: &#40;no value&#41;
&gt; &gt;&gt;&gt;&gt;&gt;   Severity: &#40;no value&#41;
&gt; &gt;&gt;&gt;&gt;&gt;      Owner: Nobody
&gt; &gt;&gt;&gt;&gt;&gt; Requestors: eewill40z@gmail.com
&gt; &gt;&gt;&gt;&gt;&gt;     Status: new
&gt; &gt;&gt;&gt;&gt;&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt; &gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt;&gt;&gt;&gt;&gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt;&gt;&gt;&gt;&gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt; &gt;&gt;&gt;&gt;&gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt; &gt;&gt;&gt;&gt;&gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt; &gt;&gt;&gt;&gt;&gt; sub get_inbox.
&gt; &gt;&gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;&gt;
</div>&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;
&gt; &gt;&gt;&gt;&gt;
</div></div>&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
&gt; &gt;&gt;
</div>&gt; &gt;
&gt; &gt; I&#39;m moving on to that one next.
&gt; &gt;
&gt; &gt; I think it is breaking because of some strange character that shows
&gt; &gt; up in the string.  I&#39;ve seen something like this happen when you try
&gt; &gt; to use a DOS file on UNIX with perl.  I also get an &#34;Extremely long
&gt; &gt; character&#34; message when I&#39;m sending the output to a file via the &#34;&gt;&#34;
&gt; &gt; on the command line.  Can&#39;t tell you what it&#39;s complaining about,
&gt; &gt; but my guess is that might be the problem.  I just don&#39;t know how to
&gt; &gt; fix it.  Maybe, if you have some UNIX development contacts you could
&gt; &gt; get them to look at it.  I&#39;m basically an amature, but I love to
&gt; &gt; mess around with perl.
&gt; &gt;
&gt; &gt; -William
&gt; &gt;
&gt; &gt;
&gt; &gt; On 11/16/07, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt;
&gt; &gt; Hi William,
&gt; &gt;
&gt; &gt; Thanks for the patch.  Does get_comments work for you?  The same
&gt; &gt; sort of processing is
&gt; &gt; done there.  Unfortunately, this patch is subject to break if
&gt; &gt; myspace makes a minute change
&gt; &gt; in the way they format lines &#40;which they do on a regular basis&#41;.
&gt; &gt; I&#39;d like to figure out why the
&gt; &gt; regex is hanging certain systems.
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt;
&gt; &gt; Grant
&gt; &gt;
&gt; &gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt; &gt; &gt; Okay... this is not as eloquent as your solution, but it works for
&gt; &gt; &gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt; &gt; &gt; work on yours to.  Would love for you to try it out and let me know.
&gt; &gt; &gt;
&gt; &gt; &gt; -William
&gt; &gt; &gt;
&gt; &gt; &gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat
</div>&gt; &gt; linux.
<div class="message-stanza open">&gt; &gt; &gt; sub _get_messages_from_page {
&gt; &gt; &gt;
&gt; &gt; &gt;     my &#40; $dummy, %options &#41; = @_;
&gt; &gt; &gt;     my $page = $self-&gt;current_page-&gt;decoded_content;
&gt; &gt; &gt;     my @messages = &#40;&#41;;
&gt; &gt; &gt;     my $state = 0;                    # State Values
&gt; &gt; &gt;                                       # 0 - Beginning state,
</div>&gt; &gt; looking for beginning of message block
<div class="message-stanza open">&gt; &gt; &gt;                                       # 1 - In message block,
</div>&gt; &gt; looking for data
<div class="message-stanza open">&gt; &gt; &gt;                                       #     Will return to state=0
</div>&gt; &gt; when we get the last data &#40;messageID
<div class="message-stanza open">&gt; &gt; &gt; and subject&#41;
&gt; &gt; &gt;     my $sender;
&gt; &gt; &gt;     my $status;
&gt; &gt; &gt;     my $msg_id;
&gt; &gt; &gt;     my $subject;
&gt; &gt; &gt;
&gt; &gt; &gt;     open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt; &gt; &gt;     while &#40; &lt;$fh&gt; &#41; {
&gt; &gt; &gt;       chomp;
&gt; &gt; &gt;         last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} ==
</div>&gt; &gt; $3 &#41; &#41;;
<div class="message-stanza open">&gt; &gt; &gt;       if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt; &gt; &gt; /&#41;{
&gt; &gt; &gt;               # Found beginning of Message block
&gt; &gt; &gt;               $state = 1;
&gt; &gt; &gt;       } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt; &gt;               $sender = $1;
&gt; &gt; &gt;       } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt; &gt; &gt;               $status = $1;
&gt; &gt; &gt;       } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt; &gt; &gt;               $msg_id = $1;
&gt; &gt; &gt;               $subject = $2;
&gt; &gt; &gt;               $state = 0;    #return to state=0 because we need to
</div>&gt; &gt; start looking
<div class="message-stanza open">&gt; &gt; &gt; for the beginning of the next message block
&gt; &gt; &gt;
&gt; &gt; &gt;               push @messages, { sender =&gt; $sender, status =&gt;
</div>&gt; &gt; $status, message_id
<div class="message-stanza open">&gt; &gt; &gt; =&gt; $msg_id, subject =&gt; $subject };
&gt; &gt; &gt;               if &#40;$DEBUG&#41; { print $sender,&#34;|&#34;,$status,&#34;|&#34;,
</div>&gt; &gt; $msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
<div class="message-stanza open">&gt; &gt; &gt;       }
&gt; &gt; &gt;     }
&gt; &gt; &gt;     return @messages;
&gt; &gt; &gt; }
&gt; &gt; &gt;
&gt; &gt; &gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt; &gt; &gt; &lt; bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; Please upgrade to the current version of WWW::Myspace.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; The loop will exit when all the messages have been parsed - the
</div></div>&gt; &gt; $page
<div class="message-stanza open">&gt; &gt; &gt; &gt; variable is modified through each loop.  If the RE being matched
&gt; &gt; &gt; &gt; against $page doesn&#39;t match &#40; i.e. due to a myspace change&#41;, the
</div>&gt; &gt; loop
<div class="message-stanza open">&gt; &gt; &gt; &gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt; &gt; &gt; &gt; problem.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; There is a known issue, however, that could cause an endless
</div>&gt; &gt; loop in
<div class="message-stanza open">&gt; &gt; &gt; &gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries
</div>&gt; &gt; to go
<div class="message-stanza open">&gt; &gt; &gt; &gt; to the next page, but gets the same one instead&#41;.  The method
</div>&gt; &gt; works
<div class="message-stanza open">&gt; &gt; &gt; &gt; for me however &#40;on MacOS 10.5&#41;.
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt; &gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt; &gt; &gt; &gt; &gt; Transaction: Ticket created by eewill40z@gmail.com
&gt; &gt; &gt; &gt; &gt;       Queue: WWW-Myspace
&gt; &gt; &gt; &gt; &gt;     Subject: Get_inbox hang, ref bug 30351
&gt; &gt; &gt; &gt; &gt;   Broken in: &#40;no value&#41;
&gt; &gt; &gt; &gt; &gt;    Severity: &#40;no value&#41;
&gt; &gt; &gt; &gt; &gt;       Owner: Nobody
&gt; &gt; &gt; &gt; &gt;  Requestors: eewill40z@gmail.com
&gt; &gt; &gt; &gt; &gt;      Status: new
&gt; &gt; &gt; &gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt; &gt; &gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt; &gt; &gt; &gt; &gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt; &gt; &gt; &gt; &gt; _get_messages_from_page&#41; will never be evaluated as true. The
</div></div>&gt; &gt; hash
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.
</div></div>&gt; &gt; Same
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; goes with the &#39;end_page&#39; key into the %options hash located in
</div></div>&gt; &gt; the
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; &gt; sub get_inbox.
&gt; &gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; &gt;
</div>&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt;
</div>&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt;
&gt;
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384360/176302/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176302">with headers</a>
<br />
<span class="downloadcontenttype">text/html 19.7k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384366" href="/Public/Bug/Display.html?id=30762#txn-384366">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;16:44:06&nbsp;2007</span>
    <span class="description">grantg [...] spamarrest.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 13:43:21 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Grant Grueninger &lt;grantg [...] spamarrest.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384366/176307/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176307">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 435b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Nov 16, 2007, at 12:36 PM, William Zorn via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;       Queue: WWW-Myspace
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Get comments did not work for me, but for a different reason.  Does
&gt; this mean that myspace changed some stuff?  The eventtarget was
&gt; differnet and the __EVENTVALIDATION no longer existed in the page.
</div>
It&#39;s quite possible they changed that again.  I&#39;ll have to look into it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384369" href="/Public/Bug/Display.html?id=30762#txn-384369">#</a>      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;16&nbsp;16:52:15&nbsp;2007</span>
    <span class="description">grantg [...] spamarrest.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Nov 2007 13:51:14 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Grant Grueninger &lt;grantg [...] spamarrest.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384369/176310/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176310">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 8.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks William,

You&#39;re submitting some useful fixes here - if you have SVN installed  
&#40;or can install an svn client&#41;, read the &#34;HOW TO SUBMIT A PATCH&#34;  
section of the WWW::Myspace docs.  That&#39;ll help us implement these  
faster, and will make sure you have the most recent build to test  
against &#40;for example I&#39;ve already fixed a minor bug in get_inbox since  
your patch :&#41;.

Grant

On Nov 16, 2007, at 12:28 PM, William Zorn via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt;       Queue: WWW-Myspace
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;
&gt; Of course I&#39;d get it wrong... USE THIS ONE.... IT IS VERIFIED ON MY
&gt; SYSTEM... CHECK ON YOURS.
&gt;
&gt; sub get_comments {
&gt;    shift;
&gt;    my &#40; $friend_id &#41; = @_;
&gt;    my @comments = &#40;&#41;;
&gt;    my $url=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comment.myspace.com/index.cfm?fuseaction=user.viewComments&#38;friendID=">http://comment.myspace.com/index.cfm?fuseaction=user.viewComments&#38;friendID=</a></span> 
&gt; &#34;.
&gt;            $friend_id;
&gt;    #my $eventtarget=&#39;ctl00$Main$PagedComments 
&gt; $pagingNavigation1$NextLinkButton&#39;;
&gt;    my $eventtarget=&#39;ctl00$cpMain$PagedComments$pagerTop&#39;;     # WZ
&gt; 11162007 - Changed from the above comment
&gt;    my $eventvalidation;
&gt;    my $viewstate;
&gt;    my $page=&#34;&#34;;
&gt;    my $commentcount;
&gt;
&gt;    $self-&gt;_die_unless_logged_in&#40; &#39;get_comments&#39; &#41;;
&gt;
&gt;    # only get a maximum of 50 comment pages
&gt;    # this should translate to 2500 comments
&gt;    # and also serves as a safety measure in case
&gt;    # the method breaks again
&gt;
&gt;    &#40; $DEBUG &#41; &#38;&#38; print &#34;Getting $url\n&#34;;
&gt;    $page = $self-&gt;get_page&#40; $url &#41;;
&gt;
&gt;    #raise an error if its private
&gt;    #if&#40;$self-&gt;is_private&#40;page =&gt; $page&#41;&#41; {
&gt;      #$self-&gt;error&#40;&#34;cannot get comments from private profile&#34;&#41;;
&gt;      #return undef;
&gt;    #}
&gt;
&gt;    # find out how many comments in total
&gt;    if &#40;$page-&gt;decoded_content =~ /.*Listing [\d-]+ of &#40;\d+&#41;.*/smo&#41;{
&gt;        $commentcount=$1;
&gt;    } else {
&gt;        $self-&gt;error&#40;&#34;Could not find how many comments are on  
&gt; profile&#34;&#41;;
&gt;        return undef;
&gt;    }
&gt;
&gt;    for &#40;my $i=1;$i&lt;=50;$i++&#41; {
&gt;        $page=$self-&gt;{current_page};
&gt;       
&gt;
&gt;        push @comments, $self-&gt;_get_comments_from_page&#40;
&gt; $page-&gt;decoded_content &#41;;
&gt;
&gt;        #make sure we did not get an error
&gt;        return undef if &#40;$self-&gt;error&#41;;
&gt;
&gt;        last unless &#40; $self-&gt;_next_button&#40; $page-&gt;decoded_content &#41; &#41;;
&gt;
&gt;       # WZ 11162007 - Comment out, __EVENTVALIDATION does not exist in  
&gt; the page.
&gt;        #get value of form field eventvalidation       
&gt; #        if &#40;$page-&gt;decoded_content =~ /id=\&#34;__EVENTVALIDATION\&#34;
&gt; value=\&#34;&#40;.*?&#41;\&#34;/o&#41;{
&gt; #            $eventvalidation=$1;
&gt; #        }
&gt; #        else {
&gt; #            $self-&gt;error&#40;&#34;get_comments could not determine
&gt; eventvalidation in form&#34;&#41;;
&gt; #            return undef;
&gt; #        }
&gt; #        #get value of form field viewstate
&gt;        if &#40;$page-&gt;decoded_content =~ /id=\&#34;__VIEWSTATE\&#34; value= 
&gt; \&#34;&#40;.*?&#41;\&#34;/o&#41;{
&gt;          $viewstate=$1;
&gt;        }
&gt;        else{
&gt;            $self-&gt;error&#40;&#34;get_comments could not determine viewstate  
&gt; in form&#34;&#41;;
&gt;
&gt;            return undef;
&gt;        }
&gt;
&gt;        #create a form using these values
&gt;        my $htmlform=qq{&lt;form name=&#34;aspnetForm&#34; method=&#34;post&#34;
&gt; action=&#34;/index.cfm?fuseaction=user.viewComments&#38;amp;friendID= 
&gt; $friend_id&#34;
&gt; id=&#34;aspnetForm&#34;&gt;}.
&gt;                qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTTARGET&#34;
&gt; id=&#34;__EVENTTARGET&#34; value=&#34;$eventtarget&#34; /&gt;}.
&gt;                qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTARGUMENT&#34;
&gt; id=&#34;__EVENTARGUMENT&#34; value=&#34;$i&#34; /&gt;}.  #WZ 11162007 - Changed to include
&gt; $i as the value for __EVENTARGUMENT
&gt;                qq{&lt;input type=&#34;hidden&#34; name=&#34;__VIEWSTATE&#34;
&gt; id=&#34;__VIEWSTATE&#34; value=&#34;$viewstate&#34; /&gt;}.
&gt;                #qq{&lt;input type=&#34;hidden&#34; name=&#34;__EVENTVALIDATION&#34;
&gt; id=&#34;__EVENTVALIDATION&#34; value=&#34;$eventvalidation&#34; /&gt;}.
&gt;                qq{&lt;/form&gt;};
&gt;        my $form=HTML::Form-&gt;parse&#40;$htmlform,&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comment.myspace.com/index.cfm">http://comment.myspace.com/index.cfm</a></span> 
&gt; &#34;&#41;;
&gt;
&gt;        &#40; $DEBUG &#41; &#38;&#38; print &#34;try to submit form to access comments
&gt; page #&#34;,$i,&#34;\n&#34;;
&gt;
&gt;        #submit it and hope for the best
&gt;        $self-&gt;submit_form&#40;{form =&gt; $form,no_click=&gt; 1,follow=&gt;0}&#41;;
&gt;
&gt;        #submit the form to get to next page
&gt;        #$self-&gt;submit_form&#40;{
&gt;        #        follow =&gt; 0,
&gt;        #        form_name =&gt; &#34;aspnetForm&#34;,
&gt;        #        no_click =&gt; 1,
&gt;        #        fields_ref =&gt; { __EVENTTARGET =&gt; $eventtarget,
&gt; __EVENTARGUMENT =&gt; &#39;&#39; }
&gt;        #        #re1 =&gt; &#39;something unique.?about this[ \t\n]+page&#39;,
&gt;        #    }&#41;;
&gt;
&gt;        # sleep &#40; int&#40; rand&#40; 2 &#41; &#41; + 1 &#41;;
&gt;    }
&gt;
&gt; #    unless&#40;scalar &#40;@comments&#41; == $commentcount&#41;{
&gt; #            $self-&gt;error&#40;&#34;Could not collect all comments. Have &#34; .
&gt; @comments .&#34;, should have $commentcount&#34;&#41;;
&gt; #        return undef;
&gt; #    }
&gt;
&gt;    return \@comments;
&gt; }
&gt;
&gt; On Nov 16, 2007 10:13 AM, via RT &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;&gt;
&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;&gt;
&gt;&gt; Hi William,
&gt;&gt;
&gt;&gt; Thanks for the patch.  Does get_comments work for you?  The same  
&gt;&gt; sort of processing is
&gt;&gt; done there.  Unfortunately, this patch is subject to break if  
&gt;&gt; myspace makes a minute change
&gt;&gt; in the way they format lines &#40;which they do on a regular basis&#41;.   
&gt;&gt; I&#39;d like to figure out why the
&gt;&gt; regex is hanging certain systems.
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt;
&gt;&gt; Grant
&gt;&gt;
&gt;&gt;
&gt;&gt; On Fri Nov 16 10:59:52 2007, eewill40z@gmail.com wrote:
<div class="message-stanza open">&gt;&gt;&gt; Okay... this is not as eloquent as your solution, but it works for
&gt;&gt;&gt; me.... Here&#39;s the new _get_messages_from_page.  I&#39;m assuming it will
&gt;&gt;&gt; work on yours to.  Would love for you to try it out and let me know.
&gt;&gt;&gt;
&gt;&gt;&gt; -William
&gt;&gt;&gt;
&gt;&gt;&gt; # Updated by WZorn to fix hanging problem on Mandriva and RetHat  
&gt;&gt;&gt; linux.
&gt;&gt;&gt; sub _get_messages_from_page {
&gt;&gt;&gt;
&gt;&gt;&gt;    my &#40; $dummy, %options &#41; = @_;
&gt;&gt;&gt;    my $page = $self-&gt;current_page-&gt;decoded_content;
&gt;&gt;&gt;    my @messages = &#40;&#41;;
&gt;&gt;&gt;    my $state = 0;                    # State Values
&gt;&gt;&gt;                                      # 0 - Beginning state,  
&gt;&gt;&gt; looking for beginning of message block
&gt;&gt;&gt;                                      # 1 - In message block,  
&gt;&gt;&gt; looking for data
&gt;&gt;&gt;                                      #     Will return to state=0  
&gt;&gt;&gt; when we get the last data &#40;messageID
&gt;&gt;&gt; and subject&#41;
&gt;&gt;&gt;    my $sender;
&gt;&gt;&gt;    my $status;
&gt;&gt;&gt;    my $msg_id;
&gt;&gt;&gt;    my $subject;
&gt;&gt;&gt;
&gt;&gt;&gt;    open&#40;my $fh, &#34;&lt;&#34;, \$page&#41;;
&gt;&gt;&gt;    while &#40; &lt;$fh&gt; &#41; {
&gt;&gt;&gt;      chomp;
&gt;&gt;&gt;        last if &#40; $options{&#39;stop_at&#39;} &#38;&#38; &#40; $options{&#39;stop_at&#39;} ==  
&gt;&gt;&gt; $3 &#41; &#41;;
&gt;&gt;&gt;      if&#40;/&lt;td class=&#34;messageListCell&#34; align=&#34;center&#34;&gt;
&gt;&gt;&gt; /&#41;{
&gt;&gt;&gt;              # Found beginning of Message block
&gt;&gt;&gt;              $state = 1;
&gt;&gt;&gt;      } elsif &#40;/viewprofile&#38;friendid=&#40;[0-9]+&#41;/ &#38;&#38; $state == 1&#41;{
&gt;&gt;&gt;              $sender = $1;
&gt;&gt;&gt;      } elsif &#40;/&#40;Unread|Read|Sent|Replied&#41;/ &#38;&#38; $state == 1&#41;{
&gt;&gt;&gt;              $status = $1;
&gt;&gt;&gt;      } elsif &#40;/messageID=&#40;[^&#38;]+&#41;&#38;.*?&gt;&#40;[^&lt;]+&#41;&lt;/ &#38;&#38; $state == 1&#41;{
&gt;&gt;&gt;              $msg_id = $1;
&gt;&gt;&gt;              $subject = $2;
&gt;&gt;&gt;              $state = 0;    #return to state=0 because we need to  
&gt;&gt;&gt; start looking
&gt;&gt;&gt; for the beginning of the next message block
&gt;&gt;&gt;
&gt;&gt;&gt;              push @messages, { sender =&gt; $sender, status =&gt;  
&gt;&gt;&gt; $status, message_id
&gt;&gt;&gt; =&gt; $msg_id, subject =&gt; $subject };
&gt;&gt;&gt;              if &#40;$DEBUG&#41; { print $sender,&#34;|&#34;,$status,&#34;|&#34;, 
&gt;&gt;&gt; $msg_id,&#34;|&#34;,$subject,&#34;\n&#34;; }
&gt;&gt;&gt;      }
&gt;&gt;&gt;    }
&gt;&gt;&gt;    return @messages;
&gt;&gt;&gt; }
&gt;&gt;&gt;
&gt;&gt;&gt; On Nov 15, 2007 4:28 PM, grantg@spamarrest.com via RT
&gt;&gt;&gt; &lt;bug-WWW-Myspace@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Please upgrade to the current version of WWW::Myspace.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; The loop will exit when all the messages have been parsed - the  
&gt;&gt;&gt;&gt; $page
&gt;&gt;&gt;&gt; variable is modified through each loop.  If the RE being matched
&gt;&gt;&gt;&gt; against $page doesn&#39;t match &#40;i.e. due to a myspace change&#41;, the  
&gt;&gt;&gt;&gt; loop
&gt;&gt;&gt;&gt; will exit anyway.  Thus, this most likely isn&#39;t the cause of the
&gt;&gt;&gt;&gt; problem.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; There is a known issue, however, that could cause an endless loop  
&gt;&gt;&gt;&gt; in
&gt;&gt;&gt;&gt; get_inbox if the paging isn&#39;t working properly &#40;i.e. if it tries  
&gt;&gt;&gt;&gt; to go
&gt;&gt;&gt;&gt; to the next page, but gets the same one instead&#41;.  The method works
&gt;&gt;&gt;&gt; for me however &#40;on MacOS 10.5&#41;.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Nov 15, 2007, at 1:41 PM, William Zorn via RT wrote:
&gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; Thu Nov 15 16:41:00 2007: Request 30762 was acted upon.
&gt;&gt;&gt;&gt;&gt; Transaction: Ticket created by eewill40z@gmail.com
&gt;&gt;&gt;&gt;&gt;      Queue: WWW-Myspace
&gt;&gt;&gt;&gt;&gt;    Subject: Get_inbox hang, ref bug 30351
&gt;&gt;&gt;&gt;&gt;  Broken in: &#40;no value&#41;
&gt;&gt;&gt;&gt;&gt;   Severity: &#40;no value&#41;
&gt;&gt;&gt;&gt;&gt;      Owner: Nobody
&gt;&gt;&gt;&gt;&gt; Requestors: eewill40z@gmail.com
&gt;&gt;&gt;&gt;&gt;     Status: new
&gt;&gt;&gt;&gt;&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=30762">http://rt.cpan.org/Ticket/Display.html?id=30762</a></span> &gt;
</div>&gt;&gt;&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt; I&#39;m not sure what the fix is, but this module hangs because the
&gt;&gt;&gt;&gt;&gt; &#39;last if...&#39;  statement around line 3581 &#40;in sub
&gt;&gt;&gt;&gt;&gt; _get_messages_from_page&#41; will never be evaluated as true. The hash
&gt;&gt;&gt;&gt;&gt; key &#39;stop_at&#39; does not appear to exist in the %options hash.  Same
&gt;&gt;&gt;&gt;&gt; goes with the &#39;end_page&#39; key into the %options hash located in the
&gt;&gt;&gt;&gt;&gt; sub get_inbox.
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;
</div>&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
</div></div>&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
</div>&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-384706" href="/Public/Bug/Display.html?id=30762#txn-384706">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;17&nbsp;10:47:54&nbsp;2007</span>
    <span class="description">steven [...] pyro.eu.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #30762] Get_inbox hang, ref bug 30351</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 17 Nov 2007 15:48:22 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Steven Chamberlain &lt;steven [...] pyro.eu.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/384706/176498/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/176498">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 310b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

The latest SVN of WWW::Myspace with William&#39;s fix does indeed solve the
problem I reported &#40;bug #30351&#41;.  I&#39;m not sure exactly what the problem
was with the old code, but the new inbox parsing looks like a more
efficient algorithm anyway.

Good work!

Thank you,
-- 
Steven Chamberlain
steven@pyro.eu.org
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-456327" href="/Public/Bug/Display.html?id=30762#txn-456327">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;30&nbsp;22:55:28&nbsp;2008</span>
    <span class="description">GRANTG [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/456327/224362/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/224362">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 42b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Old ticket, resolved in November. Closing.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-456330" href="/Public/Bug/Display.html?id=30762#txn-456330">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;30&nbsp;22:55:29&nbsp;2008</span>
    <span class="description">GRANTG [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.804551</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
