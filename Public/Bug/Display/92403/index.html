<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #92403 for IO-Socket-SSL: 2 non blocking tests fail &#40;not sure why&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #92403 for IO-Socket-SSL: 2 non blocking tests fail &#40;not sure why&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/IO-Socket-SSL/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/IO-Socket-SSL">IO-Socket-SSL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">92403</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/IO-Socket-SSL/Active/">IO-Socket-SSL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Steffen_Ullrich [...] genua.de
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
pause [...] tlinx.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-17228-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.967    </td>
  </tr>
  <tr id="CF-17229-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;23&nbsp;01:08:40&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 2 non blocking tests fail &#40;not sure why&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">output of t/nonblock.t:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; perl t/nonblock.t 
</div>1..27
ok # [server] Server Initialization
# connect in progress
ok # [server] tcp accept
ok # [client] client tcp connect
# wrote 9 bytes
ok # [client] write plain text
ok # [server] received plain text
ok # [client] upgrade client to IO::Socket::SSL
# SSL wants a read first
ok # [server] upgrade to_client to IO::Socket::SSL
# SSL wants a read first
ok # [server] ssl accept handshake done
ok # [client] connected
ok # [client] nonblocking connect with 2 attempts
# sndbuf=16384
ok # [server] received client message
ok # [client] syswrite
not ok # [client] multiple write attempts
ok # [client] 30000 bytes send
# connect in progress
ok # [client] client tcp connect
# wrote 9 bytes
ok # [client] write plain text
# read 30000 &#40;1 r/w attempts&#41;
ok # [server] tcp accept
ok # [server] received plain text
ok # [server] upgrade to_client to IO::Socket::SSL
ok # [client] upgrade client to IO::Socket::SSL
# SSL wants a read first
# SSL wants a read first
ok # [server] ssl accept handshake done
ok # [server] nonblocking accept_SSL with 2 attempts
ok # [client] connected
# sndbuf=16384
ok # [server] received client message
ok # [client] syswrite
not ok # [client] multiple write attempts
ok # [client] 30000 bytes send
# read 30000 &#40;2 r/w attempts&#41;

---------------------
Both &#34;multiple write attempts&#34; tests failed.


 perl -V
Summary of my perl5 &#40;revision 5 version 16 subversion 3&#41; configuration:
   
  Platform:
    osname=linux, osvers=3.12.0-isht-van, archname=x86_64-linux-thread-multi-ld
    uname=&#39;linux ishtar 3.12.0-isht-van #1 smp preempt wed nov 13 16:50:51 pst 2013 x86_64 x86_64 x86_64 gnulinux &#39;
    config_args=&#39;&#39;
    hint=previous, useposix=true, d_sigaction=define
    useithreads=undef, usemultiplicity=undef
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=define, use64bitall=define, uselongdouble=define
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;gcc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-g -O2&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.8.1 20130909 [gcc-4_8-branch revision 202388]&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;long double&#39;, nvsize=16, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=16, prototype=define
  Linker and Libraries:
    ld=&#39;gcc&#39;, ldflags =&#39;-g -fstack-protector -fPIC&#39;
    libpth=/usr/lib64 /lib64
    libs=-lnsl -lndbm -lgdbm -ldb -ldl -lm -lcrypt -lutil -lpthread -lc -lgdbm_compat
    perllibs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
    libc=/lib/libc-2.18.so, so=so, useshrplib=true, libperl=libperl-5.16.3.so
    gnulibc_version=&#39;2.18&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E -Wl,-rpath,/home/perl/perl-5.16.3/lib/x86_64-linux-thread-multi-ld/CORE&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -g -O2 -fstack-protector -fPIC&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: HAS_TIMES PERLIO_LAYERS PERL_DONT_CREATE_GVSV
                        PERL_MALLOC_WRAP PERL_PRESERVE_IVUV USE_64_BIT_ALL
                        USE_64_BIT_INT USE_LARGE_FILES USE_LOCALE
                        USE_LOCALE_COLLATE USE_LOCALE_CTYPE
                        USE_LOCALE_NUMERIC USE_LONG_DOUBLE USE_PERLIO
                        USE_PERL_ATOF
  Built under linux
  Compiled at Jan 22 2014 13:31:33
  %ENV:
    PERL5OPT=&#34;-Mutf8 -CSA -I/home/law/bin/lib&#34;
  @INC:
    /home/law/bin/lib
    /home/perl/perl-5.16.3/lib/site/x86_64-linux-thread-multi-ld
    /home/perl/perl-5.16.3/lib/site
    /home/perl/perl-5.16.3/lib/x86_64-linux-thread-multi-ld
    /home/perl/perl-5.16.3/lib
    .
Ishtar:law&gt; unset PERL5OPT
Ishtar:law&gt; perl -V       
Summary of my perl5 &#40;revision 5 version 16 subversion 3&#41; configuration:
   
  Platform:
    osname=linux, osvers=3.12.0-isht-van, archname=x86_64-linux-thread-multi-ld
    uname=&#39;linux ishtar 3.12.0-isht-van #1 smp preempt wed nov 13 16:50:51 pst 2013 x86_64 x86_64 x86_64 gnulinux &#39;
    config_args=&#39;&#39;
    hint=previous, useposix=true, d_sigaction=define
    useithreads=undef, usemultiplicity=undef
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=define, use64bitall=define, uselongdouble=define
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;gcc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-g -O2&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.8.1 20130909 [gcc-4_8-branch revision 202388]&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;long double&#39;, nvsize=16, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=16, prototype=define
  Linker and Libraries:
    ld=&#39;gcc&#39;, ldflags =&#39;-g -fstack-protector -fPIC&#39;
    libpth=/usr/lib64 /lib64
    libs=-lnsl -lndbm -lgdbm -ldb -ldl -lm -lcrypt -lutil -lpthread -lc -lgdbm_compat
    perllibs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
    libc=/lib/libc-2.18.so, so=so, useshrplib=true, libperl=libperl-5.16.3.so
    gnulibc_version=&#39;2.18&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E -Wl,-rpath,/home/perl/perl-5.16.3/lib/x86_64-linux-thread-multi-ld/CORE&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -g -O2 -fstack-protector -fPIC&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: HAS_TIMES PERLIO_LAYERS PERL_DONT_CREATE_GVSV
                        PERL_MALLOC_WRAP PERL_PRESERVE_IVUV USE_64_BIT_ALL
                        USE_64_BIT_INT USE_LARGE_FILES USE_LOCALE
                        USE_LOCALE_COLLATE USE_LOCALE_CTYPE
                        USE_LOCALE_NUMERIC USE_LONG_DOUBLE USE_PERLIO
                        USE_PERL_ATOF
  Built under linux
  Compiled at Jan 22 2014 13:31:33
  @INC:
    /home/perl/perl-5.16.3/lib/site/x86_64-linux-thread-multi-ld
    /home/perl/perl-5.16.3/lib/site
    /home/perl/perl-5.16.3/lib/x86_64-linux-thread-multi-ld
    /home/perl/perl-5.16.3/lib
    .

---------------------
&#40;FYI...:
Running make test
PERL_DL_NONLAZY=1 /home/perl/perl-5.16.3/bin/perl &#34;-MExtUtils::Command::MM&#34; &#34;-MTest::Harness&#34; &#34;-e&#34; &#34;undef *Test::Harness::Switches; test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/01loadmodule.t ........... ok
t/acceptSSL-timeout.t ...... ok
t/auto_verify_hostname.t ... ok
t/cert_no_file.t ........... ok
t/compatibility.t .......... ok
t/connectSSL-timeout.t ..... ok
t/core.t ................... ok
t/dhe.t .................... ok
t/ecdhe.t .................. ok
t/io-socket-inet6.t ........ skipped: no IO::Socket::INET6 available
t/io-socket-ip.t ........... skipped: &#40;no reason given&#41;
t/memleak_bad_handshake.t .. ok
t/mitm.t ................... ok
t/nonblock.t ............... 
Failed 2/27 subtests 
t/npn.t .................... ok
t/readline.t ............... ok
t/sessions.t ............... ok
t/signal-readline.t ........ ok
t/sni.t .................... ok
t/start-stopssl.t .......... ok
t/startssl-failed.t ........ ok
t/startssl.t ............... ok
t/sysread_write.t .......... ok
t/verify_hostname.t ........ ok

Test Summary Report
-------------------
t/nonblock.t             &#40;Wstat: 0 Tests: 27 Failed: 2&#41;
  Failed tests:  13, 26
Files=24, Tests=345, 35 wallclock secs &#40; 0.13 usr  0.05 sys +  3.37 cusr  0.89 csys =  4.44 CPU&#41;
Result: FAIL
Failed 1/24 test programs. 2/345 subtests failed.
make: *** [test_dynamic] Error 255
&#40;/usr/bin/make test exited with 512&#41;
----

Blocks build/install of LWP-Protocol-https-6.04.tar.gz
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;04:13:45&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">According to cpantesters the problem does not happen any longer, so whatever the cause was, it probably vanished. Case closed :&#41;

Nevertheless, thanks for reporting.
Steffen

On Thu Jan 23 01:08:40 2014, LAWALSH wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; output of t/nonblock.t:
&gt; 
<div class="message-stanza open">&gt; &gt; perl t/nonblock.t
</div>&gt; 1..27
&gt; ok # [server] Server Initialization
&gt; # connect in progress
&gt; ok # [server] tcp accept
&gt; ok # [client] client tcp connect
&gt; # wrote 9 bytes
&gt; ok # [client] write plain text
&gt; ok # [server] received plain text
&gt; ok # [client] upgrade client to IO::Socket::SSL
&gt; # SSL wants a read first
&gt; ok # [server] upgrade to_client to IO::Socket::SSL
&gt; # SSL wants a read first
&gt; ok # [server] ssl accept handshake done
&gt; ok # [client] connected
&gt; ok # [client] nonblocking connect with 2 attempts
&gt; # sndbuf=16384
&gt; ok # [server] received client message
&gt; ok # [client] syswrite
&gt; not ok # [client] multiple write attempts
&gt; ok # [client] 30000 bytes send
&gt; # connect in progress
&gt; ok # [client] client tcp connect
&gt; # wrote 9 bytes
&gt; ok # [client] write plain text
&gt; # read 30000 &#40;1 r/w attempts&#41;
&gt; ok # [server] tcp accept
&gt; ok # [server] received plain text
&gt; ok # [server] upgrade to_client to IO::Socket::SSL
&gt; ok # [client] upgrade client to IO::Socket::SSL
&gt; # SSL wants a read first
&gt; # SSL wants a read first
&gt; ok # [server] ssl accept handshake done
&gt; ok # [server] nonblocking accept_SSL with 2 attempts
&gt; ok # [client] connected
&gt; # sndbuf=16384
&gt; ok # [server] received client message
&gt; ok # [client] syswrite
&gt; not ok # [client] multiple write attempts
&gt; ok # [client] 30000 bytes send
&gt; # read 30000 &#40;2 r/w attempts&#41;
&gt; ...
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;04:13:46&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;04:13:47&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;22:18:28&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Mar 09 04:13:45 2014, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; According to cpantesters the problem does not happen any longer, so
&gt; whatever the cause was, it probably vanished. Case closed :&#41;
&gt; 
&gt; Nevertheless, thanks for reporting.
&gt; Steffen
</div>-------
You might want to check cpan testers again.

I just tried to build it with failure in the 
non-blocking area.

V1.967
Running make test
PERL_DL_NONLAZY=1 /usr/bin/perl &#34;-MExtUtils::Command::MM&#34; &#34;-MTest::Harness&#34; &#34;-e&#34; &#34;undef *Test::Harness::Switches; test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/01loadmodule.t ........... ok
t/acceptSSL-timeout.t ...... ok
t/auto_verify_hostname.t ... ok
t/cert_no_file.t ........... ok
t/compatibility.t .......... ok
t/connectSSL-timeout.t ..... ok
t/core.t ................... ok
t/dhe.t .................... ok
t/ecdhe.t .................. ok
t/io-socket-inet6.t ........ skipped: no IO::Socket::INET6 available
t/io-socket-ip.t ........... skipped: &#40;no reason given&#41;
t/memleak_bad_handshake.t .. ok
t/mitm.t ................... ok
t/nonblock.t ............... 
Failed 2/27 subtests 
t/npn.t .................... ok
t/readline.t ............... ok
t/sessions.t ............... ok
t/signal-readline.t ........ ok
t/sni.t .................... ok
t/start-stopssl.t .......... ok
t/startssl-failed.t ........ ok
t/startssl.t ............... ok
t/sysread_write.t .......... ok
t/verify_fingerprint.t ..... ok
t/verify_hostname.t ........ ok

Test Summary Report
-------------------
t/nonblock.t             &#40;Wstat: 0 Tests: 27 Failed: 2&#41;
  Failed tests:  13, 26
Files=25, Tests=351, 35 wallclock secs &#40; 0.14 usr  0.05 sys +  3.63 cusr  0.93 csys =  4.75 CPU&#41;
Result: FAIL
Failed 1/25 test programs. 2/351 subtests failed.
make: *** [test_dynamic] Error 255
&#40;/usr/bin/make test exited with 512&#41;
CPAN::Reporter: Test result is &#39;fail&#39;, One or more tests failed.
CPAN::Reporter: preparing a CPAN Testers report for IO-Socket-SSL-1.967
Do you want to review or edit the test report? &#40;yes/no&#41; [no] 
Do you want to send the report? &#40;yes/no&#41; [yes] 
CPAN::Reporter: sending test report with &#39;fail&#39; via Metabase

  SULLR/IO-Socket-SSL-1.967.tar.gz
  /usr/bin/make test -- NOT OK
//hint// to see the cpan-testers results for installing this module, try:
  reports SULLR/IO-Socket-SSL-1.967.tar.gz
Running make install
  make test had returned bad status, won&#39;t install without force
-------------

CPAN testers are a self-selected group of people who can use and install the SW w/no problems.  

If there are problems, I don&#39;t usually attempt retries so cpan testers wouldn&#39;t show any faults...   
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;22:18:29&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Status changed from &#39;rejected&#39; to &#39;new&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;22:21:59&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">My perconfig is slightly different &#40;not that it likely make a difference, but thought I&#39;d include it for completeness sake.

Same perl version, different compile options:

Summary of my perl5 &#40;revision 5 version 16 subversion 3&#41; configuration:
   
  Platform:
    osname=linux, osvers=3.12.0-isht-van, archname=x86_64-linux-thread-multi-ld
    uname=&#39;linux ishtar 3.12.0-isht-van #1 smp preempt wed nov 13 16:50:51 pst 2013 x86_64 x86_64 x86_64 gnulinux &#39;
    config_args=&#39;&#39;
    hint=previous, useposix=true, d_sigaction=define
    useithreads=define, usemultiplicity=define
    useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
    use64bitint=define, use64bitall=define, uselongdouble=define
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;gcc&#39;, ccflags =&#39;-D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;,
    optimize=&#39;-g -O2&#39;,
    cppflags=&#39;-D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing -pipe -fstack-protector -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&#39;
    ccversion=&#39;&#39;, gccversion=&#39;4.8.1 20130909 [gcc-4_8-branch revision 202388]&#39;, gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;long double&#39;, nvsize=16, Off_t=&#39;off_t&#39;, lseeksize=8
    alignbytes=16, prototype=define
  Linker and Libraries:
    ld=&#39;gcc&#39;, ldflags =&#39;-g -fstack-protector -fPIC&#39;
    libpth=/usr/lib64 /lib64
    libs=-lnsl -lndbm -lgdbm -ldb -ldl -lm -lcrypt -lutil -lpthread -lc -lgdbm_compat
    perllibs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
    libc=/lib/libc-2.18.so, so=so, useshrplib=true, libperl=libperl-5.16.3.so
    gnulibc_version=&#39;2.18&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags=&#39;-Wl,-E -Wl,-rpath,/home/perl/perl-5.16.3/lib/x86_64-linux-thread-multi-ld/CORE&#39;
    cccdlflags=&#39;-fPIC&#39;, lddlflags=&#39;-shared -g -O2 -fstack-protector -fPIC&#39;


Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: HAS_TIMES MULTIPLICITY PERLIO_LAYERS
                        PERL_DONT_CREATE_GVSV PERL_IMPLICIT_CONTEXT
                        PERL_MALLOC_WRAP PERL_PRESERVE_IVUV USE_64_BIT_ALL
                        USE_64_BIT_INT USE_ITHREADS USE_LARGE_FILES
                        USE_LOCALE USE_LOCALE_COLLATE USE_LOCALE_CTYPE
                        USE_LOCALE_NUMERIC USE_LONG_DOUBLE USE_PERLIO
                        USE_PERL_ATOF USE_REENTRANT_API
  Built under linux
  Compiled at Jan 23 2014 00:35:49
  @INC:
    /home/perl/perl-5.16.3/lib/site/x86_64-linux-thread-multi-ld
    /home/perl/perl-5.16.3/lib/site
    /home/perl/perl-5.16.3/lib/x86_64-linux-thread-multi-ld
    /home/perl/perl-5.16.3/lib
    .
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;22:23:49&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Broken in 1.967 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;22:23:49&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Fixed in 1.966 deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;22:29:09&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">p.s. sorry to be barer of bad news &#38; re-open this, but given that it was cpantester reports that were giving it a clean bill of health, and I know that&#39;s not the case now...I thought it was appropriate?  Please don&#39;t take offense...

If you want me to try a version, would be more than happy, or provide any other info...

Cheers!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;09&nbsp;22:29:10&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Given to SULLR</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;02:16:02&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am So 09. MÃ¤r 2014, 22:29:09, LAWALSH schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; p.s. sorry to be barer of bad news &#38; re-open this, but given that it
&gt; was cpantester reports that were giving it a clean bill of health, and
&gt; I know that&#39;s not the case now...I thought it was appropriate?  Please
&gt; don&#39;t take offense...
&gt; 
&gt; If you want me to try a version, would be more than happy, or provide
&gt; any other info...
</div>
could you please provide me with more information about you build, especially
- version of Net::SSLeay used &#40;newest?&#41;
- platform &#40;I see linux, but which distribution, might be important because of libc or libssl used&#41;
- build options - perlbrew at least does not build with -thread-ld for me
- is this a especially slow or fast machine &#40;e.g. might there be race conditions I don&#39;t see on my machine&#41;?

Thanks,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;02:16:02&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;04:18:35&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Um, I marked the &#34;broken in&#34; field &#40;newest version&#41;, and it was at the end of the test output.  But to answer your question, it is the newest.

I&#39;m running from a OpenSuse13.1 base.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; rpm -qi glibc
</div>Name        : glibc
Version     : 2.18
Release     : 4.4.1
Architecture: x86_64
----
2 versions of openssl are installed for different programs that need them:
- Name        : libopenssl0_9_8
Version     : 0.9.8x
Release     : 5.1.3
----
Other is 
Name        : libopenssl1_0_0
Version     : 1.0.1e
Release     : 11.2.1

---
Has tickless clock of 1000Hz  and is running Preemptable.

2x6 cores:
model name  : Intel Xeon X5660  @ 2.80G
cpu MHz   : 1596.000
cache size  : 12288 KB

middle speed was slowest.  I don&#39;t use
perlbrew, I built using configure &#40;attaching config.sh&#41;.  or is it config_h.SH you would want?

--- 
Did i miss anything?

;-&#41;
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> config.sh</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;11&nbsp;13:59:03&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
I could not reproduce the problem with your config and an OpenSuse13.1 inside a virtual machine. But I&#39;ve seen strange effects on other systems, where interactions with socket buffers made everything really slow. Could you please run the attached version of nonblock.t which does timings and send me the output or paste it here?

Steffen
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> nonblock.t</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!perl
# Before `make install&#39; is performed this script should be runnable with
# `make test&#39;. After `make install&#39; it should work as `perl t/nonblock.t&#39;


use strict;
use warnings;
use Net::SSLeay;
use Socket;
use IO::Socket::SSL;
use IO::Select;
use Time::HiRes &#39;gettimeofday&#39;;
use Errno qw&#40; EAGAIN EINPROGRESS EPIPE ECONNRESET &#41;;

if &#40; ! eval &#34;use 5.006; use IO::Select; return 1&#34; &#41; {
    print &#34;1..0 # Skipped: no support for nonblocking sockets\n&#34;;
    exit;
}
if &#40; grep { $^O =~m{$_} } qw&#40; MacOS VOS vmesa riscos amigaos &#41; &#41; {
    print &#34;1..0 # Skipped: fork not implemented on this platform\n&#34;;
    exit
}

if &#40; $^O =~m{mswin32}i &#41; {
	print &#34;1..0 # Skipped: nonblocking does not work on Win32\n&#34;;
	exit
}

$SIG{PIPE} = &#39;IGNORE&#39;; # use EPIPE not signal handler

$|=1;
print &#34;1..27\n&#34;;

# first create simple non-blocking tcp-server
my $ID = &#39;server&#39;;
my $server = IO::Socket::INET-&gt;new&#40;
    Blocking =&gt; 0,
    LocalAddr =&gt; &#39;127.0.0.1&#39;,
    LocalPort =&gt; 0,
    Listen =&gt; 2,
&#41;;

my $start = gettimeofday&#40;&#41;;

print &#34;not ok: $!\n&#34;, exit if !$server; # Address in use?
ok&#40;&#34;Server Initialization&#34;&#41;;

my $saddr = $server-&gt;sockhost.&#39;:&#39;.$server-&gt;sockport;
my $ssock = $server-&gt;sockname;

defined&#40; my $pid = fork&#40;&#41; &#41; || die $!;
if &#40; $pid == 0 &#41; {

    ############################################################
    # CLIENT == child process
    ############################################################

    close&#40;$server&#41;;
    $ID = &#39;client&#39;;

    # fast: try connect_SSL immediately after sending plain text
    #	connect_SSL should fail on the first attempt because server
    #	is not ready yet
    # slow: wait before calling connect_SSL
    #	connect_SSL should succeed, because server was already waiting

    for my $test &#40; &#39;fast&#39;,&#39;slow&#39; &#41; {

	# initial socket is unconnected, tcp, nonblocking
	my $to_server = IO::Socket::INET-&gt;new&#40; Proto =&gt; &#39;tcp&#39;, Blocking =&gt; 0 &#41;;

	# nonblocking connect of tcp socket
	while &#40;1&#41; {
	    connect&#40;$to_server,$ssock &#41; &#38;&#38; last;
	    if &#40; $!{EINPROGRESS} &#41; {
		diag&#40; &#39;connect in progress&#39; &#41;;
		IO::Select-&gt;new&#40; $to_server &#41;-&gt;can_write&#40;30&#41; &#38;&#38; next;
		print &#34;not &#34;;
		last;
	    } elsif &#40; $!{EALREADY} &#41; {
		diag&#40; &#39;connect not yet completed&#39;&#41;;
		# just wait
		select&#40;undef,undef,undef,0.1&#41;;
		next;
	    } elsif &#40; $!{EISCONN} &#41; {
		diag&#40;&#39;claims that socket is already connected&#39;&#41;;
		# found on Mac OS X, dunno why it does not tell me that
		# the connect succeeded before
		last;
	    }
	    diag&#40; &#39;connect failed: &#39;.$! &#41;;
	    print &#34;not &#34;;
	    last;
	}
	ok&#40; &#34;client tcp connect&#34; &#41;;

	# work around &#40;older?&#41; systems where IO::Socket::INET
	# cannot do non-blocking connect by forcing non-blocking
	# again &#40;we want to test non-blocking behavior of IO::Socket::SSL,
	# not IO::Socket::INET&#41;
	$to_server-&gt;blocking&#40;0&#41;;

	# send some plain text on non-ssl socket
	my $pmsg = &#39;plaintext&#39;;
	while &#40; $pmsg ne &#39;&#39; &#41; {
	    my $w = syswrite&#40; $to_server,$pmsg &#41;;
	    if &#40; ! defined $w &#41; {
		if &#40; ! $!{EAGAIN} &#41; {
		    diag&#40;&#34;syswrite failed with $!&#34;&#41;;
		    print &#34;not &#34;;
		    last;
		}
		IO::Select-&gt;new&#40;$to_server&#41;-&gt;can_write&#40;30&#41; or do {
		    diag&#40;&#34;failed to get write ready&#34;&#41;;
		    print &#34;not &#34;;
		    last;
		};
	    } elsif &#40; $w&gt;0 &#41; {
		diag&#40;&#34;wrote $w bytes&#34;&#41;;
		substr&#40;$pmsg,0,$w,&#39;&#39;&#41;;
	    } else {
		die &#34;syswrite returned 0&#34;;
	    }
	}
	ok&#40; &#34;write plain text&#34; &#41;;

	# let server catch up, so that it awaits my connection
	# so that connect_SSL does not have to wait
	sleep&#40;5&#41; if &#40; $test eq &#39;slow&#39; &#41;;

	# upgrade to SSL socket w/o connection yet
	if &#40; ! IO::Socket::SSL-&gt;start_SSL&#40; $to_server,
	    SSL_startHandshake =&gt; 0,
	    SSL_verify_mode =&gt; 0,
	    SSL_key_file =&gt; &#34;certs/server-key.enc&#34;,
	    SSL_passwd_cb =&gt; sub { return &#34;bluebell&#34; },
	&#41;&#41; {
	    diag&#40; &#39;start_SSL return undef&#39; &#41;;
	    print &#34;not &#34;;
	} elsif &#40; !UNIVERSAL::isa&#40; $to_server,&#39;IO::Socket::SSL&#39; &#41; &#41; {
	    diag&#40; &#39;failed to upgrade socket&#39; &#41;;
	    print &#34;not &#34;;
	}
	ok&#40; &#34;upgrade client to IO::Socket::SSL&#34; &#41;;

	# SSL handshake thru connect_SSL
	# if $test eq &#39;fast&#39; we expect one failed attempt because server
	# did not call accept_SSL yet
	my $attempts = 0;
	while &#40; 1 &#41; {
	    $to_server-&gt;connect_SSL &#38;&#38; last;
	    diag&#40; $SSL_ERROR &#41;;
	    if &#40; $SSL_ERROR == SSL_WANT_READ &#41; {
		$attempts++;
		IO::Select-&gt;new&#40;$to_server&#41;-&gt;can_read&#40;30&#41; &#38;&#38; next; # retry if can read
	    } elsif &#40; $SSL_ERROR == SSL_WANT_WRITE &#41; {
		IO::Select-&gt;new&#40;$to_server&#41;-&gt;can_write&#40;30&#41; &#38;&#38; next; # retry if can write
	    }
	    diag&#40; &#34;failed to connect: $@&#34; &#41;;
	    print &#34;not &#34;;
	    last;
	}
	ok&#40; &#34;connected&#34; &#41;;

	if &#40; $test ne &#39;slow&#39; &#41; {
	    print &#34;not &#34; if !$attempts;
	    ok&#40; &#34;nonblocking connect with $attempts attempts&#34; &#41;;
	}

	# send some data
	# we send up to 500000 bytes, server reads first 10 bytes and then sleeps
	# before reading more. In total server only reads 30000 bytes
	# the sleep will cause the internal buffers to fill up so that the syswrite
	# should return with EAGAIN+SSL_WANT_WRITE.
	# the socket close should cause EPIPE or ECONNRESET

	my $msg = &#34;1234567890&#34;;
	$attempts = 0;
	my $bytes_send = 0;

	# set send buffer to 8192 so it will definitely fail writing all 500000 bytes in it
	# beware that linux allocates twice as much &#40;see tcp&#40;7&#41;&#41;
	# AIX seems to get very slow if you set the sndbuf on localhost, so don&#39;t to it
	# <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=72305">https://rt.cpan.org/Public/Bug/Display.html?id=72305</a></span>
	if &#40; $^O !~m/aix/i &#41; {
	    eval q{
		setsockopt&#40; $to_server, SOL_SOCKET, SO_SNDBUF, pack&#40; &#34;I&#34;,8192 &#41;&#41;;
		diag&#40; &#34;sndbuf=&#34;.unpack&#40; &#34;I&#34;,getsockopt&#40; $to_server, SOL_SOCKET, SO_SNDBUF &#41;&#41;&#41;;
	    };
	}

	my $test_might_fail;
	if &#40; $@ &#41; {
	    # the next test might fail because setsockopt&#40;... SO_SNDBUF...&#41; failed
	    $test_might_fail = 1;
	}

	my $can;
	WRITE:
	for&#40; my $i=0;$i&lt;50000;$i++ &#41; {
	    my $offset = 0;
	    while &#40;1&#41; {
		if &#40; $can &#38;&#38; ! IO::Select-&gt;new&#40;$to_server&#41;-&gt;$can&#40;30&#41;&#41; {
		    diag&#40;&#34;fail $can&#34;&#41;;
		    print &#34;not &#34;;
		    last WRITE;
		};
		my $n = syswrite&#40; $to_server,$msg,length&#40;$msg&#41;-$offset,$offset &#41;;
		if &#40; !defined&#40;$n&#41; &#41; {
		    diag&#40; &#34;\$!=$! \$SSL_ERROR=$SSL_ERROR send=$bytes_send&#34; &#41;;
		    if &#40; $! == EAGAIN &#41; {
			if &#40; $SSL_ERROR == SSL_WANT_WRITE &#41; {
			    diag&#40; &#39;wait for write&#39; &#41;;
			    $can = &#39;can_write&#39;;
			    $attempts++;
			} elsif &#40; $SSL_ERROR == SSL_WANT_READ &#41; {
			    diag&#40; &#39;wait for read&#39; &#41;;
			    $can = &#39;can_read&#39;;
			} else {
			    $can = &#39;can_write&#39;;
			}
		    } elsif &#40; &#40; $! == EPIPE || $! == ECONNRESET &#41; &#38;&#38; $bytes_send &gt; 30000 &#41; {
			diag&#40; &#34;connection closed hard&#34; &#41;;
			last WRITE;
		    } else {
			print &#34;not &#34;;
			last WRITE;
		    }
		    next;
		} elsif &#40; $n == 0 &#41; {
		    diag&#40; &#34;connection closed&#34; &#41;;
		    last WRITE;
		} elsif &#40; $n&lt;0 &#41; {
		    diag&#40; &#34;syswrite returned $n!&#34; &#41;;
		    print &#34;not &#34;;
		    last WRITE;
		}

		$bytes_send += $n;
		if &#40; $n + $offset == 10 &#41; {
		    diag&#40; &#34;write&#40;$i&#41; done&#40;$n+$offset&#41;&#34; &#41;;
		    last
		} else {
		    $offset += $n;
		    diag&#40; &#34;partial write of $n new offset=$offset&#34; &#41;;
		}
	    }
	}
	ok&#40; &#34;syswrite&#34; &#41;;

	if &#40; ! $attempts &#38;&#38; $test_might_fail &#41; {
	    ok&#40; &#34; write attempts failed, but OK nevertheless because setsockopt failed&#34; &#41;;
	} else {
	    print &#34;not &#34; if !$attempts;
	    ok&#40; &#34;multiple write attempts&#34; &#41;;
	}

	print &#34;not &#34; if $bytes_send &lt; 30000;
	ok&#40; &#34;30000 bytes send&#34; &#41;;
    }

} else {

    ############################################################
    # SERVER == parent process
    ############################################################

    # pendant to tests in client. Where client is slow &#40;sleep
    # between plain text sending and connect_SSL&#41; I need to
    # be fast and where client is fast I need to be slow &#40;sleep
    # between receiving plain text and accept_SSL&#41;

    foreach my $test &#40; &#39;slow&#39;,&#39;fast&#39; &#41; {

	# accept a connection
	IO::Select-&gt;new&#40; $server &#41;-&gt;can_read&#40;30&#41;;
	my $from_client = $server-&gt;accept or print &#34;not &#34;;
	ok&#40; &#34;tcp accept&#34; &#41;;
	$from_client || do {
	    diag&#40; &#34;failed to tcp accept: $!&#34; &#41;;
	    next;
	};

	# make client non-blocking!
	$from_client-&gt;blocking&#40;0&#41;;

	# read plain text data
	my $buf = &#39;&#39;;
	while &#40; length&#40;$buf&#41; &lt;9 &#41; {
	    sysread&#40; $from_client, $buf,9-length&#40;$buf&#41;,length&#40;$buf&#41; &#41; &#38;&#38; next;
	    die &#34;sysread failed: $!&#34; if $! != EAGAIN;
	    IO::Select-&gt;new&#40; $from_client &#41;-&gt;can_read&#40;30&#41;;
	}
	$buf eq &#39;plaintext&#39; || print &#34;not &#34;;
	ok&#40; &#34;received plain text&#34; &#41;;

	# upgrade socket to IO::Socket::SSL
	# no handshake yet
	if &#40; ! IO::Socket::SSL-&gt;start_SSL&#40; $from_client,
	    SSL_startHandshake =&gt; 0,
	    SSL_server =&gt; 1,
	    SSL_verify_mode =&gt; 0x00,
	    SSL_ca_file =&gt; &#34;certs/test-ca.pem&#34;,
	    SSL_use_cert =&gt; 1,
	    SSL_cert_file =&gt; &#34;certs/client-cert.pem&#34;,
	    SSL_key_file =&gt; &#34;certs/client-key.enc&#34;,
	    SSL_passwd_cb =&gt; sub { return &#34;opossum&#34; },
	&#41;&#41; {
	    diag&#40; &#39;start_SSL return undef&#39; &#41;;
	    print &#34;not &#34;;
	} elsif &#40; !UNIVERSAL::isa&#40; $from_client,&#39;IO::Socket::SSL&#39; &#41; &#41; {
	    diag&#40; &#39;failed to upgrade socket&#39; &#41;;
	    print &#34;not &#34;;
	}
	ok&#40; &#34;upgrade to_client to IO::Socket::SSL&#34; &#41;;

	sleep&#40;5&#41; if $test eq &#39;slow&#39;; # wait until client calls connect_SSL

	# SSL handshake  thru accept_SSL
	# if test is &#39;fast&#39; &#40;e.g. client is &#39;slow&#39;&#41; we excpect the first
	# accept_SSL attempt to fail because client did not call connect_SSL yet
	my $attempts = 0;
	while &#40; 1 &#41; {
	    $from_client-&gt;accept_SSL &#38;&#38; last;
	    if &#40; $SSL_ERROR == SSL_WANT_READ &#41; {
		$attempts++;
		IO::Select-&gt;new&#40;$from_client&#41;-&gt;can_read&#40;30&#41; &#38;&#38; next; # retry if can read
	    } elsif &#40; $SSL_ERROR == SSL_WANT_WRITE &#41; {
		$attempts++;
		IO::Select-&gt;new&#40;$from_client&#41;-&gt;can_write&#40;30&#41; &#38;&#38; next; # retry if can write
	    } else {
		diag&#40; &#34;failed to ssl accept &#40;$test&#41;: $@&#34; &#41;;
		print &#34;not &#34;;
		last;
	    }
	}
	ok&#40; &#34;ssl accept handshake done&#34; &#41;;

	if &#40; $test eq &#39;fast&#39; &#41; {
	    print &#34;not &#34; if !$attempts;
	    ok&#40; &#34;nonblocking accept_SSL with $attempts attempts&#34; &#41;;
	}

	# reading 10 bytes
	# then sleeping so that buffers from client to server gets
	# filled up and clients receives EAGAIN+SSL_WANT_WRITE

	IO::Select-&gt;new&#40; $from_client &#41;-&gt;can_read&#40;30&#41;;
	&#40; sysread&#40; $from_client, $buf,10 &#41; == 10 &#41; || print &#34;not &#34;;
	#diag&#40;$buf&#41;;
	ok&#40; &#34;received client message&#34; &#41;;

	sleep&#40;5&#41;;
	my $bytes_received = 10;

	# read up to 30000 bytes from client, then close the socket
	my $can;
	READ:
	while &#40; &#40; my $diff = 30000 - $bytes_received &#41; &gt; 0 &#41; {
	    if &#40; $can &#38;&#38; ! IO::Select-&gt;new&#40;$from_client&#41;-&gt;$can&#40;30&#41;&#41; {
		diag&#40;&#34;failed $can&#34;&#41;;
		print &#34;not &#34;;
		last READ;
	    }
	    my $n = sysread&#40; $from_client,my $buf,$diff &#41;;
	    if &#40; !defined&#40;$n&#41; &#41; {
		diag&#40; &#34;\$!=$! \$SSL_ERROR=$SSL_ERROR&#34; &#41;;
		if &#40; $! == EAGAIN &#41; {
		    if &#40; $SSL_ERROR == SSL_WANT_READ &#41; {
			$attempts++;
			$can = &#39;can_read&#39;;
		    } elsif &#40; $SSL_ERROR == SSL_WANT_WRITE &#41; {
			$attempts++;
			$can = &#39;can_write&#39;;
		    } else {
			$can = &#39;can_read&#39;;
		    }
		} else {
		    print &#34;not &#34;;
		    last READ;
		}
		next;
	    } elsif &#40; $n == 0 &#41; {
		diag&#40; &#34;connection closed&#34; &#41;;
		last READ;
	    } elsif &#40; $n&lt;0 &#41; {
		diag&#40; &#34;sysread returned $n!&#34; &#41;;
		print &#34;not &#34;;
		last READ;
	    }

	    $bytes_received += $n;
	    #diag&#40; &#34;read of $n bytes total $bytes_received&#34; &#41;;
	}

	diag&#40; &#34;read $bytes_received &#40;$attempts r/w attempts&#41;&#34; &#41;;
	close&#40;$from_client&#41;;
    }

    # wait until client exits
    wait;
}

exit;



sub ok { print &#34;ok # [$ID] @_\n&#34;; }
sub diag { 
    printf &#34;# %7.4f %s\n&#34;,gettimeofday&#40;&#41;-$start,&#34;@_&#34; ;
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;11&nbsp;17:22:21&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Attaching output compressed, &#40;891K uncompressed -&gt; ~28K w/&#39;xz&#39;&#41;.  
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> output.txt.xz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;05:46:00&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Di 11. MÃ¤r 2014, 17:22:21, LAWALSH schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Attaching output compressed, &#40;891K uncompressed -&gt; ~28K w/&#39;xz&#39;&#41;.  
</div>
The test passed in your output.
Does it pass everytime with the modified nonblock.t &#40;which just added debug information&#41; and never with the original nonblock.t ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;15&nbsp;06:06:41&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92403] 2 non blocking tests fail &#40;not sure why&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 15 Mar 2014 03:06:28 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Socket-SSL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

Steffen Ullrich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=92403">https://rt.cpan.org/Ticket/Display.html?id=92403</a></span> &gt;
&gt;
&gt; Am Di 11. MÃ¤r 2014, 17:22:21, LAWALSH schrieb:
&gt;   
<div class="message-stanza open">&gt;&gt; Attaching output compressed, &#40;891K uncompressed -&gt; ~28K w/&#39;xz&#39;&#41;.  
&gt;&gt;     
</div>&gt;
&gt; The test passed in your output.
&gt; Does it pass everytime with the modified nonblock.t &#40;which just added debug information&#41; and never with the original nonblock.t ?
&gt;   
</div>---
And made the test run about 10x longer -- the output slowed the 
execution speed down from about 3 seconds to over 30.  I.e. it sounds 
like w/o the output there the output to the terminal takes far longer 
than any output over the net, so the non-blocking test becomes moot.

At least, that would be my theory.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;16&nbsp;03:05:28&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; ---
&gt; And made the test run about 10x longer -- the output slowed the
&gt; execution speed down from about 3 seconds to over 30.  I.e. it sounds
&gt; like w/o the output there the output to the terminal takes far longer
&gt; than any output over the net, so the non-blocking test becomes moot.
&gt; 
&gt; At least, that would be my theory.
</div>
This looks for me like a bug in your OS. The test has several sleep&#40;5&#41; inside and due to this it should at least take 15 seconds to execute. Running in only 3 seconds cannot be done, unless these essential sleep statements are ignored. Might it have something to do with your tickless kernel?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;16&nbsp;05:10:32&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92403] 2 non blocking tests fail &#40;not sure why&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 16 Mar 2014 02:10:17 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Socket-SSL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

Steffen Ullrich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=92403">https://rt.cpan.org/Ticket/Display.html?id=92403</a></span> &gt;
&gt;
&gt;
&gt;   
<div class="message-stanza open">&gt;&gt; ---
&gt;&gt; And made the test run about 10x longer -- the output slowed the
&gt;&gt; execution speed down from about 3 seconds to over 30.  I.e. it sounds
&gt;&gt; like w/o the output there the output to the terminal takes far longer
&gt;&gt; than any output over the net, so the non-blocking test becomes moot.
&gt;&gt;
&gt;&gt; At least, that would be my theory.
&gt;&gt;     
</div>&gt;
&gt; This looks for me like a bug in your OS. The test has several sleep&#40;5&#41; inside and due to this it should at least take 15 seconds to execute. Running in only 3 seconds cannot be done, unless these essential sleep statements are ignored. Might it have something to do with your tickless kernel?
&gt;   
</div>I doubt it -- the 3 seconds was a guess from what I remember... I just 
the tail
end of the fails, so didn&#39;t time them.  The tickless kernel is the 
recommended default
on linux, and has been for a few-to- maybe 5 years now.  It just means 
it doesn&#39;t use
a clock tick to keep time, but uses one of the several internal timer 
devices that
are more accurate and go off at programmed times so the kernel can sleep 
more
rather than executing ticks every ms.

I use non-block file system i/o in a perl program to scan directory 
tree&#39;s.  Goes 2-3
times faster than the blocking variety.

Still, the output slowing it down --  the principle is the same. 
15-&gt;30.  If the non-blocking writes were supposed
to take ~ 15 seconds total, before being responded to, but the writer is 
now taking 30 seconds
before seeing if it is responded to, it gives a 2x margin on waiting for 
the, what would
have been 15 seconds... whether the writer does 3 or 5 second waits -- 
now it won&#39;t
get to those waits for 6 or 10 seconds.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;16&nbsp;23:35:31&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #92403] 2 non blocking tests fail &#40;not sure why&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 16 Mar 2014 20:35:16 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-IO-Socket-SSL [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;L. A. Walsh&#34; &lt;pause [...] tlinx.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

Steffen Ullrich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This looks for me like a bug in your OS. The test has several sleep&#40;5&#41; 
&gt; inside and due to this it should at least take 15 seconds to execute. 
&gt; Running in only 3 seconds cannot be done, unless these essential sleep 
&gt; statements are ignored. Might it have something to do with your 
&gt; tickless kernel?
</div>Here&#39;s a more accurate run with the timing on the original:


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;  time perl t/nonblock.t
</div>1..27
ok # [server] Server Initialization
# connect in progress
ok # [server] tcp accept
ok # [client] client tcp connect
# wrote 9 bytes
ok # [server] received plain text
ok # [client] write plain text
ok # [client] upgrade client to IO::Socket::SSL
# SSL wants a read first
ok # [server] upgrade to_client to IO::Socket::SSL
# SSL wants a read first
ok # [server] ssl accept handshake done
ok # [client] connected
ok # [client] nonblocking connect with 2 attempts
# sndbuf=16384
ok # [server] received client message
ok # [client] syswrite
not ok # [client] multiple write attempts
ok # [client] 30000 bytes send
# connect in progress
ok # [client] client tcp connect
# wrote 9 bytes
ok # [client] write plain text
# read 30000 &#40;1 r/w attempts&#41;
ok # [server] tcp accept
ok # [server] received plain text
ok # [server] upgrade to_client to IO::Socket::SSL
ok # [client] upgrade client to IO::Socket::SSL
# SSL wants a read first
# SSL wants a read first
ok # [server] ssl accept handshake done
ok # [server] nonblocking accept_SSL with 2 attempts
ok # [client] connected
# sndbuf=16384
ok # [server] received client message
ok # [client] syswrite
not ok # [client] multiple write attempts
ok # [client] 30000 bytes send
# read 30000 &#40;2 r/w attempts&#41;
15.96sec 1.54usr 0.31sys &#40;11.64% cpu&#41;

-----------------------
It looks like it fails because SSL claims to want a read while the server is
trying to write?

&#40;Don&#39;t know anything about the proto... &#41;.

Would the client have more data to send?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;15&nbsp;02:42:25&nbsp;2014</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Just an update to let you know that the bug is not forgotten.
I&#39;m unable to reproduce it, so I&#39;m guessing it has something to do with the interaction with socket buffers on your system. Could you please add the relevant configuration on your system, e.g. output of 
  
  sysctl net.ipv4.tcp_mem net.ipv4.tcp_rmem net.ipv4.tcp_wmem
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;15&nbsp;16:15:58&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu May 15 02:42:25 2014, SULLR wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Just an update to let you know that the bug is not forgotten.
&gt;  I&#39;m unable to reproduce it, so I&#39;m guessing it has something to do
&gt; with the interaction with socket buffers on your system. Could you
&gt; please add the relevant configuration on your system, e.g. output of
</div>---
It&#39;s ok , I don&#39;t have anything critical waiting on this... I just found it in installing various deps for other stuff and manually hacked the installer for this so work could continue -- but it will fail again next time I install an update...so that&#39;s the rough timeframe ... but nothing critical...

The numbers you asked for:
net.ipv4.tcp_mem = 16777216 33554432  67108864
net.ipv4.tcp_rmem = 16777216  16777216  33554432
net.ipv4.tcp_wmem = 16777216  16777216  33554432

--- just to be &#34;safe&#34;, I&#39;m adding in the other tcp settings here just in case any of them make a difference:

    tcp_abort_on_overflow  0
        tcp_adv_win_scale  4
tcp_allowed_congestion_control  highspeed htcp reno scalable lp
              tcp_app_win  31
          tcp_autocorking  1
tcp_available_congestion_control  highspeed htcp reno scalable lp
             tcp_base_mss  1400
  tcp_challenge_ack_limit  100
   tcp_congestion_control  highspeed
                tcp_dsack  0
        tcp_early_retrans  3
                  tcp_ecn  2
                 tcp_fack  0
             tcp_fastopen  1
          tcp_fin_timeout  60
                 tcp_frto  2
      tcp_keepalive_intvl  75
     tcp_keepalive_probes  9
       tcp_keepalive_time  7200
   tcp_limit_output_bytes  262144
          tcp_low_latency  1
          tcp_max_orphans  262144
      tcp_max_syn_backlog  2048
       tcp_max_tw_buckets  262144
                  tcp_mem  16777216     33554432        67108864
         tcp_min_tso_segs  2
      tcp_moderate_rcvbuf  0
          tcp_mtu_probing  0
      tcp_no_metrics_save  0
        tcp_notsent_lowat  -1
       tcp_orphan_retries  0
           tcp_reordering  512
     tcp_retrans_collapse  1
             tcp_retries1  3
             tcp_retries2  15
              tcp_rfc1337  0
                 tcp_rmem  16777216     16777216        33554432
                 tcp_sack  1
tcp_slow_start_after_idle  0
               tcp_stdurg  0
          tcp_syn_retries  6
       tcp_synack_retries  5
           tcp_syncookies  1
          tcp_thin_dupack  0
 tcp_thin_linear_timeouts  0
           tcp_timestamps  0
      tcp_tso_win_divisor  3
           tcp_tw_recycle  0
             tcp_tw_reuse  0
       tcp_window_scaling  1
                 tcp_wmem  16777216     16777216        33554432
tcp_workaround_signed_windows  0
                  udp_mem  2097152      8388608 16777216
             udp_rmem_min  262144
             udp_wmem_min  262144




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; sysctl net.ipv4.tcp_mem net.ipv4.tcp_rmem net.ipv4.tcp_wmem
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;19&nbsp;20:50:14&nbsp;2015</span>
    <span class="description">https://me.yahoo.com/a/Br14wqwpvY7arFlTQ80.WY5yJQ0-#b0d6e -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Carson Gaspar</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">FYI I have the exact same problem on Solaris 11.2.

Net-SSLeay 1.70
perl 5.22.0

Characteristics of this binary &#40;from libperl&#41;: 
  Compile-time options: HAS_TIMES MULTIPLICITY PERLIO_LAYERS
                        PERL_DONT_CREATE_GVSV
                        PERL_HASH_FUNC_ONE_AT_A_TIME_HARD
                        PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP
                        PERL_NEW_COPY_ON_WRITE PERL_PRESERVE_IVUV
                        PERL_USE_SAFE_PUTENV USE_64_BIT_ALL USE_64_BIT_INT
                        USE_ITHREADS USE_LARGE_FILES USE_LOCALE
                        USE_LOCALE_COLLATE USE_LOCALE_CTYPE
                        USE_LOCALE_NUMERIC USE_LOCALE_TIME USE_LONG_DOUBLE
                        USE_PERLIO USE_PERL_ATOF USE_REENTRANT_API
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;20&nbsp;21:24:18&nbsp;2015</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, can you try my patch and see if it fixes your problem? I ran into the problem on HP-UX but believe it will happen on a few other ancient platforms such as Solaris and AIX.

<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=106573">https://rt.cpan.org/Ticket/Display.html?id=106573</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;08&nbsp;03:09:51&nbsp;2015</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Do 20. Aug 2015, 21:24:18, AGRUNDMA schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi, can you try my patch and see if it fixes your problem? I ran into
&gt; the problem on HP-UX but believe it will happen on a few other ancient
&gt; platforms such as Solaris and AIX.
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=106573">https://rt.cpan.org/Ticket/Display.html?id=106573</a></span>
</div>

The request is closed in the hope that the referred patch &#40;which was included in IO::Socket::SSL 2 month ago&#41; fixed the problem &#40;there was no feedback&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;08&nbsp;03:09:57&nbsp;2015</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;28&nbsp;01:23:48&nbsp;2017</span>
    <span class="description">holmanb0214 [...] my.uwstout.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #92403]</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Nov 2017 06:23:28 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-IO-Socket-SSL [...] rt.cpan.org&#34; &lt;bug-IO-Socket-SSL [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Holman, Brett&#34; &lt;holmanb0214 [...] my.uwstout.edu&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jan&nbsp;05&nbsp;05:58:23&nbsp;2018</span>
    <span class="description">Steffen_Ullrich [...] genua.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Di 28. Nov 2017, 01:23:48, holmanb0214@my.uwstout.edu schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I am getting this issue using raspberry pi zero and Raspbian Stretch.
&gt; I am attempting to install using cpanm.  I originally was only getting
&gt; test 26 failing, but after doing a apt-get update and apt-get upgrade,
&gt; I&#39;m now seeing both tests 13 and 26 as failed.  I&#39;d be happy to
&gt; provide any more information to get this resolved.
</div>
Sorry for the late response. But your information were added to a bug which was already closed
a few years ago. If the problem persists please open a new bug and provide more detailled information:
not only the version of Perl and the OS but also the version of the IO::Socket::SSL module and the
verbose output of all tests, not only the failing ones &#40;make test TEST_VERBOSE=1&#41;.
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
