<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #50852 for DBD-ODBC: [SQL Server Native Client 10.0]Invalid character value for cast  specification &#40;SQL-22018&#41; for datetime/smalldatetime</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #50852 for DBD-ODBC: [SQL Server Native Client 10.0]Invalid character value for cast  specification &#40;SQL-22018&#41; for datetime/smalldatetime</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-ODBC">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-ODBC">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-ODBC">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-ODBC">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-ODBC">DBD-ODBC CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">50852</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-ODBC">DBD-ODBC</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mockodin [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10188-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10189-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




MSSQL_TEST.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/683102/351829/MSSQL_TEST.pl">
Tue Oct 27 17:27:39 2009 (5.4k) by mockodin [...] gmail.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=50852">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-682599" href="/Public/Bug/Display.html?id=50852#txn-682599">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;26&nbsp;19:27:24&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [SQL Server Native Client 10.0]Invalid character value for cast  specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 Oct 2009 16:27:02 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-dbd-odbc &lt;bug-dbd-odbc [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/682599/351514/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351514">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 634b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">[error] DBD::ODBC::db do failed: [Microsoft]
          [SQL Server Native Client 10.0]Invalid character value for cast
specification &#40;SQL-22018&#41; [for Statement &#34;UPDATE bugs SET cf_window_end = ?
WHERE bug_id = ?&#34;]
          at D:/WebRoot/Bugzilla/Bugzilla/DB/Mssql.pm line 570
              Bugzilla::DB::Mssql::do&#40;undef, &#39;UPDATE bugs SET cf_window_end
= ? WHERE bug_id = ?&#39;, undef, &#39;2009-10-28 0:03&#39;, 132572&#41;

The following link might be useful:
<span class="clickylink"><a target="new" rel="nofollow" href="http://technet.microsoft.com/en-us/library/bb677170.aspx">http://technet.microsoft.com/en-us/library/bb677170.aspx</a></span>

--My Build--:
Windows: 2008 Std
ActivePerl: 5.10.1006 32Bit
Apache: 2.22.14
DBD-ODBC: 1.23
Driver: SQL Server Native Client 10.0
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/682599/351515/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351515">with headers</a>
<br />
<span class="downloadcontenttype">text/html 920b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-682975" href="/Public/Bug/Display.html?id=50852#txn-682975">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;12:46:06&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/682975/351748/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351748">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 835b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 26 19:27:24 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [error] DBD::ODBC::db do failed: [Microsoft]
&gt;           [SQL Server Native Client 10.0]Invalid character value for cast
&gt; specification &#40;SQL-22018&#41; [for Statement &#34;UPDATE bugs SET
</div>cf_window_end = ?
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; WHERE bug_id = ?&#34;]
&gt;           at D:/WebRoot/Bugzilla/Bugzilla/DB/Mssql.pm line 570
&gt;               Bugzilla::DB::Mssql::do&#40;undef, &#39;UPDATE bugs SET
</div>cf_window_end
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; = ? WHERE bug_id = ?&#39;, undef, &#39;2009-10-28 0:03&#39;, 132572&#41;
&gt; 
&gt; The following link might be useful:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://technet.microsoft.com/en-us/library/bb677170.aspx">http://technet.microsoft.com/en-us/library/bb677170.aspx</a></span>
&gt; 
&gt; --My Build--:
&gt; Windows: 2008 Std
&gt; ActivePerl: 5.10.1006 32Bit
&gt; Apache: 2.22.14
&gt; DBD-ODBC: 1.23
&gt; Driver: SQL Server Native Client 10.0
</div>
Was this working in a previous DBD::ODBC with the same SQL Server native
client?

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-682976" href="/Public/Bug/Display.html?id=50852#txn-682976">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;12:46:07&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683040" href="/Public/Bug/Display.html?id=50852#txn-683040">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;15:13:48&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/683040/351784/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351784">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 26 19:27:24 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [error] DBD::ODBC::db do failed: [Microsoft]
&gt;           [SQL Server Native Client 10.0]Invalid character value for cast
&gt; specification &#40;SQL-22018&#41; [for Statement &#34;UPDATE bugs SET
</div>cf_window_end = ?
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; WHERE bug_id = ?&#34;]
&gt;           at D:/WebRoot/Bugzilla/Bugzilla/DB/Mssql.pm line 570
&gt;               Bugzilla::DB::Mssql::do&#40;undef, &#39;UPDATE bugs SET
</div>cf_window_end
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; = ? WHERE bug_id = ?&#39;, undef, &#39;2009-10-28 0:03&#39;, 132572&#41;
&gt; 
</div>
Could you tell me what the column type is for cf_window_end.

Obviously this is bugzilla - why is this code not using ODBC syntax for
timestamps or datetimes? e.g., {d &#39;1980-01-01&#39;} or {ts &#39;2009-10-29
00:03:00&#39;} and why does this appear to not be a valid timestamp &#40;missing
leading 0 on hours for instance and also missing seconds&#41; - although
this would not be a problem with a datetime column. I think a&#41; the
column needs to be a &#34;datetime&#34; column and not a timestamp &#40;assuming it
is a timestamp&#41; and also the datetime needs to be in a valid format
&#39;yyyy-mm-dd hh:mm:ss[.fff]&#39; - see
<span class="clickylink"><a target="new" rel="nofollow" href="http://msdn.microsoft.com/en-us/library/ms190234&#40;SQL.90&#41;.aspx">http://msdn.microsoft.com/en-us/library/ms190234&#40;SQL.90&#41;.aspx</a></span>. You could
omit the ODBC syntax {ts&#39;x&#39;} but it needs to be a valid datetime format
then.

e.g.,

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">SQL&gt; create table mje &#40;a timestamp&#41;;
</div>SQLRowCount returns -1
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">SQL&gt; insert into mje values &#40;&#39;1998-05-02 01:23:00&#39;&#41;;
</div>[37000][unixODBC][Easysoft][SQL Server Driver][SQL Server]Statement&#40;s&#41;
could not be prepared.
[23000][unixODBC][Easysoft][SQL Server Driver][SQL Server]Cannot insert
an explicit value into a timestamp column. Use INSERT with a column list
to exclude the timestamp column, or insert a DEFAULT into the timestamp
column.
[ISQL]ERROR: Could not SQLExecute
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">SQL&gt; drop table mje;
</div>SQLRowCount returns -1
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">SQL&gt; create table mje &#40;a datetime&#41;;
</div>SQLRowCount returns -1
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">SQL&gt; insert into mje values &#40;&#39;2009-10-28 0:03&#39;&#41;;
</div>SQLRowCount returns 1

I&#39;ll happily look at this further if you can supply the column type for
the cf_window_end.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683047" href="/Public/Bug/Display.html?id=50852#txn-683047">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;15:22:07&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 Oct 2009 12:21:37 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/683047/351792/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351792">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 893b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">datetime or smalldatetime for the column type tried both

&#40;mssql&#39;s timestamp is a non insertable type, used for incrementing , not a
true timestamp&#41;

MSSQL should accept 2009-10-28 12:03 formatting perfectly fine, seconds
being optional as is AM/PM


Further info not previously included, should have been though &#40;sorry&#41;:

Fails:
do&#40;undef, &#39;UPDATE bugs SET cf_window_end = ? WHERE bug_id = ?&#39;, undef,
&#39;2009-10-28 12:03&#39;, 132572&#41;

Succeeds:
do&#40;undef, &#39;UPDATE bugs SET cf_window_end = ? WHERE bug_id = ?&#39;, undef,
&#39;2009-10-28&#39;, 132572&#41;

However, executing the same action in query screen &#40;Microsoft SQL Ser but
without placeholders works:

UPDATE bugs SET cf_window_end = &#39;2009-10-28 12:01&#39; WHERE bug_id = 132572

It would appear to the untrained eye that implicit conversion from a string
or &#40;n&#41;varchar is working but when ? is used it fails, perhaps expects a more
rigorously formatted string?
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/683047/351793/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351793">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1002b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683062" href="/Public/Bug/Display.html?id=50852#txn-683062">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;16:00:38&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/683062/351800/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351800">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 27 15:22:07 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; datetime or smalldatetime for the column type tried both
</div>
that&#39;s good.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#40;mssql&#39;s timestamp is a non insertable type, used for incrementing , not a
&gt; true timestamp&#41;
</div>
Yes, I know - that is why I highlighted it.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; MSSQL should accept 2009-10-28 12:03 formatting perfectly fine, seconds
&gt; being optional as is AM/PM
</div>
as I think my example showed but as I didn&#39;t have access to the native
client odbc driver at the moment I could not prove it - I am unix based.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Further info not previously included, should have been though &#40;sorry&#41;:
&gt; 
&gt; Fails:
&gt; do&#40;undef, &#39;UPDATE bugs SET cf_window_end = ? WHERE bug_id = ?&#39;, undef,
&gt; &#39;2009-10-28 12:03&#39;, 132572&#41;
&gt; 
&gt; Succeeds:
&gt; do&#40;undef, &#39;UPDATE bugs SET cf_window_end = ? WHERE bug_id = ?&#39;, undef,
&gt; &#39;2009-10-28&#39;, 132572&#41;
&gt; 
&gt; However, executing the same action in query screen &#40;Microsoft SQL Ser but
&gt; without placeholders works:
&gt; 
&gt; UPDATE bugs SET cf_window_end = &#39;2009-10-28 12:01&#39; WHERE bug_id = 132572
&gt; 
&gt; It would appear to the untrained eye that implicit conversion from a
</div>string
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; or &#40;n&#41;varchar is working but when ? is used it fails, perhaps expects
</div>a more
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; rigorously formatted string?
</div>
There are workarounds in DBD::ODBC for datetimes. In the past we have
had them working but you needed to specify the seconds:

         case SQL_TYPE_TIMESTAMP:
            d_digits = 0;               /* tbd: millisecondS?&#41; */
            if &#40;SvOK&#40;phs-&gt;sv&#41;&#41; {
               char *cp;
               if &#40;phs-&gt;sv_buf &#38;&#38; *phs-&gt;sv_buf&#41; {
                  cp = strchr&#40;phs-&gt;sv_buf, &#39;.&#39;&#41;;
                  if &#40;cp&#41; {
                     ++cp;
                     while &#40;*cp != &#39;\0&#39; &#38;&#38; isdigit&#40;*cp&#41;&#41; {
                        cp++;
                        d_digits++;
                     }
                  }
               } else {
                   /* hard code for SQL Server when passing Undef to
                      bound parameters */
                  column_size = 23;
               }

and the problem &#40;if there is any&#41; is probably in this. I&#39;ll try and look
in to it more tomorrow. In the meantime if you can come up with a single
perl script &#40;rather than the bugzilla example&#41; which illustrates the
problem as succinctly as possible it would expedite a solution.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683074" href="/Public/Bug/Display.html?id=50852#txn-683074">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;16:43:12&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/683074/351806/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351806">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think it will work with the current DBD::ODBC if you do:

create table mje &#40;a datetime&#41;;

use DBI;
use strict;
use warnings;

my $h = DBI-&gt;connect&#40;&#39;dbi:ODBC:xxx&#39;, &#39;xxx&#39;, &#39;xxx&#39;,
                     {RaiseError =&gt; 1, PrintError =&gt; 0}&#41;;

my $s = $h-&gt;prepare&#40;q{insert into mje values&#40;?&#41;}&#41;;
eval {
    $s-&gt;execute&#40;q/{ts &#39;2009-10-28 00:03:00&#39;}/&#41;;
};
print &#34;Died $@\n&#34; if $@;

outputs nothing in error.

i.e., put leading 0 in hours and add seconds. The problem is that
DateTime fields are reported as SQL_TYPE_TIMESTAMP columns so it ends up
in the code I provided before. As soon as you miss the leading hours 0
or seconds it fails.

Actually, even if I omit, the ODBC syntax with:

use DBI;
use strict;
use warnings;

my $h = DBI-&gt;connect&#40;&#39;dbi:ODBC:baugi&#39;, &#39;sa&#39;, &#39;easysoft&#39;,
                     {RaiseError =&gt; 1, PrintError =&gt; 0}&#41;;

my $s = $h-&gt;prepare&#40;q{insert into mje values&#40;?&#41;}&#41;;
eval {
    $s-&gt;execute&#40;q/2009-10-28 00:03:00/&#41;;
};
print &#34;Died $@\n&#34; if $@;

it works fine.

The document you refer to is not for ODBC and you have to bare in mind
that the ODBC driver sits between sql server and the database. I suspect
you will need to include the leading 0 hours and seconds.

This is only confirmed from unix via a SQL Server driver for unix and
not via native client driver.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683102" href="/Public/Bug/Display.html?id=50852#txn-683102">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;17:27:39&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 Oct 2009 14:27:18 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/683102/351828/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351828">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 5.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">﻿Connecting to [sqldev].[bugs] as bugs ...Connected㸀㸀㸀㸀㸀 圀椀琀栀漀甀琀 倀氀愀挀攀栀漀氀搀攀爀猀 㰀㰀㰀㰀㰀ഀ਀吀攀猀琀 ㄀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　✀ഀ਀吀攀猀琀 ㈀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　㨀　　✀ഀ਀吀攀猀琀 ㌀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　 䄀䴀✀ഀ਀吀攀猀琀 㐀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　㨀　　 䄀䴀✀ഀ਀吀攀猀琀 㔀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　✀ഀ਀吀攀猀琀 㘀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　㨀　　✀ഀ਀吀攀猀琀 㜀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　 䄀䴀✀ഀ਀吀攀猀琀 㠀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　㨀　　 䄀䴀✀ഀ਀㸀㸀㸀㸀㸀 圀䤀吀䠀 倀氀愀挀攀栀漀氀搀攀爀猀 㰀㰀㰀㰀㰀ഀ਀吀攀猀琀 㤀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　✀ഀ਀䘀愀椀氀攀搀 椀渀猀攀爀琀 漀昀 漀昀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　✀ഀ਀ 嬀䴀椀挀爀漀猀漀昀琀崀嬀匀儀䰀 匀攀爀瘀攀爀 一愀琀椀瘀攀 䌀氀椀攀渀琀 ㄀　⸀　崀䤀渀瘀愀氀椀搀 挀栀愀爀愀挀琀攀爀 瘀愀氀甀攀 昀漀爀 挀愀猀琀 猀瀀攀挀椀昀椀挀愀琀椀漀渀 ⠀匀儀䰀ⴀ㈀㈀　㄀㠀⤀ഀ਀ഀ਀吀攀猀琀 ㄀　㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　㨀　　✀ഀ਀䘀愀椀氀攀搀 椀渀猀攀爀琀 漀昀 漀昀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　㨀　　✀ഀ਀ 嬀䴀椀挀爀漀猀漀昀琀崀嬀匀儀䰀 匀攀爀瘀攀爀 一愀琀椀瘀攀 䌀氀椀攀渀琀 ㄀　⸀　崀䤀渀瘀愀氀椀搀 挀栀愀爀愀挀琀攀爀 瘀愀氀甀攀 昀漀爀 挀愀猀琀 猀瀀攀挀椀昀椀挀愀琀椀漀渀 ⠀匀儀䰀ⴀ㈀㈀　㄀㠀⤀ഀ਀ഀ਀吀攀猀琀 ㄀㄀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　 䄀䴀✀ഀ਀䘀愀椀氀攀搀 椀渀猀攀爀琀 漀昀 漀昀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　 䄀䴀✀ഀ਀ 嬀䴀椀挀爀漀猀漀昀琀崀嬀匀儀䰀 匀攀爀瘀攀爀 一愀琀椀瘀攀 䌀氀椀攀渀琀 ㄀　⸀　崀䤀渀瘀愀氀椀搀 挀栀愀爀愀挀琀攀爀 瘀愀氀甀攀 昀漀爀 挀愀猀琀 猀瀀攀挀椀昀椀挀愀琀椀漀渀 ⠀匀儀䰀ⴀ㈀㈀　㄀㠀⤀ഀ਀ഀ਀吀攀猀琀 ㄀㈀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　㨀　　 䄀䴀✀ഀ਀䘀愀椀氀攀搀 椀渀猀攀爀琀 漀昀 漀昀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　㨀　　㨀　　 䄀䴀✀ഀ਀ 嬀䴀椀挀爀漀猀漀昀琀崀嬀匀儀䰀 匀攀爀瘀攀爀 一愀琀椀瘀攀 䌀氀椀攀渀琀 ㄀　⸀　崀䤀渀瘀愀氀椀搀 挀栀愀爀愀挀琀攀爀 瘀愀氀甀攀 昀漀爀 挀愀猀琀 猀瀀攀挀椀昀椀挀愀琀椀漀渀 ⠀匀儀䰀ⴀ㈀㈀　㄀㠀⤀ഀ਀ഀ਀吀攀猀琀 ㄀㌀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　✀ഀ਀䘀愀椀氀攀搀 椀渀猀攀爀琀 漀昀 漀昀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　✀ഀ਀ 嬀䴀椀挀爀漀猀漀昀琀崀嬀匀儀䰀 匀攀爀瘀攀爀 一愀琀椀瘀攀 䌀氀椀攀渀琀 ㄀　⸀　崀䤀渀瘀愀氀椀搀 挀栀愀爀愀挀琀攀爀 瘀愀氀甀攀 昀漀爀 挀愀猀琀 猀瀀攀挀椀昀椀挀愀琀椀漀渀 ⠀匀儀䰀ⴀ㈀㈀　㄀㠀⤀ഀ਀ഀ਀吀攀猀琀 ㄀㐀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　㨀　　✀ഀ਀吀攀猀琀 ㄀㔀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　 䄀䴀✀ഀ਀䘀愀椀氀攀搀 椀渀猀攀爀琀 漀昀 漀昀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　 䄀䴀✀ഀ਀ 嬀䴀椀挀爀漀猀漀昀琀崀嬀匀儀䰀 匀攀爀瘀攀爀 一愀琀椀瘀攀 䌀氀椀攀渀琀 ㄀　⸀　崀䤀渀瘀愀氀椀搀 挀栀愀爀愀挀琀攀爀 瘀愀氀甀攀 昀漀爀 挀愀猀琀 猀瀀攀挀椀昀椀挀愀琀椀漀渀 ⠀匀儀䰀ⴀ㈀㈀　㄀㠀⤀ഀ਀ഀ਀吀攀猀琀 ㄀㘀㨀 䄀琀琀攀洀瀀琀椀渀最 琀漀 椀渀猀攀爀琀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　㨀　　 䄀䴀✀ഀ਀䘀愀椀氀攀搀 椀渀猀攀爀琀 漀昀 漀昀 ✀㈀　　㤀ⴀ　㄀ⴀ　㄀ 　　㨀　　㨀　　 䄀䴀✀ഀ਀ 嬀䴀椀挀爀漀猀漀昀琀崀嬀匀儀䰀 匀攀爀瘀攀爀 一愀琀椀瘀攀 䌀氀椀攀渀琀 ㄀　⸀　崀䤀渀瘀愀氀椀搀 挀栀愀爀愀挀琀攀爀 瘀愀氀甀攀 昀漀爀 挀愀猀琀 猀瀀攀挀椀昀椀挀愀琀椀漀渀 ⠀匀儀䰀ⴀ㈀㈀　㄀㠀⤀ഀ਀ഀ਀
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/683102/351829/MSSQL_TEST.pl">Download MSSQL_TEST.pl</a><br />
<span class="downloadcontenttype">text/x-perl 5.4k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/683102/351826/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351826">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 297b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">See Attached Files &#40;included is the test script&#41;
The test scripts makes 16 passes

8 without Placeholders
 -- All Passed

8 with Placeholders
-- 1/8 passed

The only test that passed for placeholders confirmed your statement that
&#39;2009-01-01 00:00:00&#39; works, test output is attached as result.txt
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/683102/351827/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351827">with headers</a>
<br />
<span class="downloadcontenttype">text/html 338b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683104" href="/Public/Bug/Display.html?id=50852#txn-683104">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;27&nbsp;17:40:57&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 Oct 2009 14:40:40 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/683104/351832/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351832">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Look like the result.txt file was mangled &#40;displaying in Asian characters to
me&#41;:

Connecting to [sqldev].[bugs] as bugs ...Connected
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;&gt;&gt;&gt;&gt; Without Placeholders &lt;&lt;&lt;&lt;&lt;
</div>Test 1: Attempting to insert &#39;2009-01-01 0:00&#39;
Test 2: Attempting to insert &#39;2009-01-01 0:00:00&#39;
Test 3: Attempting to insert &#39;2009-01-01 0:00 AM&#39;
Test 4: Attempting to insert &#39;2009-01-01 0:00:00 AM&#39;
Test 5: Attempting to insert &#39;2009-01-01 00:00&#39;
Test 6: Attempting to insert &#39;2009-01-01 00:00:00&#39;
Test 7: Attempting to insert &#39;2009-01-01 00:00 AM&#39;
Test 8: Attempting to insert &#39;2009-01-01 00:00:00 AM&#39;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;&gt;&gt;&gt;&gt; WITH Placeholders &lt;&lt;&lt;&lt;&lt;
</div>Test 9: Attempting to insert &#39;2009-01-01 0:00&#39;
Failed insert of of &#39;2009-01-01 0:00&#39;
 [Microsoft][SQL Server Native Client 10.0]Invalid character value for
cast specification &#40;SQL-22018&#41;

Test 10: Attempting to insert &#39;2009-01-01 0:00:00&#39;
Failed insert of of &#39;2009-01-01 0:00:00&#39;
 [Microsoft][SQL Server Native Client 10.0]Invalid character value for
cast specification &#40;SQL-22018&#41;

Test 11: Attempting to insert &#39;2009-01-01 0:00 AM&#39;
Failed insert of of &#39;2009-01-01 0:00 AM&#39;
 [Microsoft][SQL Server Native Client 10.0]Invalid character value for
cast specification &#40;SQL-22018&#41;

Test 12: Attempting to insert &#39;2009-01-01 0:00:00 AM&#39;
Failed insert of of &#39;2009-01-01 0:00:00 AM&#39;
 [Microsoft][SQL Server Native Client 10.0]Invalid character value for
cast specification &#40;SQL-22018&#41;

Test 13: Attempting to insert &#39;2009-01-01 00:00&#39;
Failed insert of of &#39;2009-01-01 00:00&#39;
 [Microsoft][SQL Server Native Client 10.0]Invalid character value for
cast specification &#40;SQL-22018&#41;

Test 14: Attempting to insert &#39;2009-01-01 00:00:00&#39;
Test 15: Attempting to insert &#39;2009-01-01 00:00 AM&#39;
Failed insert of of &#39;2009-01-01 00:00 AM&#39;
 [Microsoft][SQL Server Native Client 10.0]Invalid character value for
cast specification &#40;SQL-22018&#41;

Test 16: Attempting to insert &#39;2009-01-01 00:00:00 AM&#39;
Failed insert of of &#39;2009-01-01 00:00:00 AM&#39;
 [Microsoft][SQL Server Native Client 10.0]Invalid character value for
cast specification &#40;SQL-22018&#41;
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/683104/351833/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/351833">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2.3k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683715" href="/Public/Bug/Display.html?id=50852#txn-683715">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;28&nbsp;14:37:50&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/683715/352158/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352158">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 973b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 27 17:40:57 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Look like the result.txt file was mangled &#40;displaying in Asian
</div>characters to
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; me&#41;:
&gt; 
&gt; Connecting to [sqldev].[bugs] as bugs ...Connected
<div class="message-stanza open">&gt; &gt;&gt;&gt;&gt;&gt; Without Placeholders &lt;&lt;&lt;&lt;&lt;
</div></div>&lt;snipped&gt;

I&#39;ve taken another look at this today and I cannot make it work unless
the datetimes have the documented ODBC syntax for a datetime &#40;with or
without the ts{}&#41;. I imagine this is deliberate by microsoft. I realise
it works without the ODBC driver, direct to sql server from the
enterprise manager or via SQL and ODBC but in both cases the sql is
passed through untouched whereas in the case of parameters they take a
different route through the ODBC driver.

I&#39;m open to any suggestion but I don&#39;t currently see a way around this -
it appears to be this way and you will need to format your datetimes
before passing them to SQL Server. I would have thought this is
something bugzilla could easily do.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683771" href="/Public/Bug/Display.html?id=50852#txn-683771">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;28&nbsp;17:14:51&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 28 Oct 2009 14:14:35 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/683771/352186/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352186">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 320b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">As with most things yes the adjustment can be made in bugzilla. But seems
somewhat unfortunate that the change should be made there. Not that I blame
DBD::ODBC, if MS is indeed handling it in two distinct manners then it is a
fault on their side. It should be consistent imo.

I&#39;m ok with closing this ticket as invalid
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/683771/352187/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352187">with headers</a>
<br />
<span class="downloadcontenttype">text/html 388b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-683963" href="/Public/Bug/Display.html?id=50852#txn-683963">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;29&nbsp;05:56:36&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/683963/352290/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352290">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Oct 28 17:14:51 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; As with most things yes the adjustment can be made in bugzilla. But seems
&gt; somewhat unfortunate that the change should be made there. Not that I
</div>blame
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; DBD::ODBC, if MS is indeed handling it in two distinct manners then it
</div>is a
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; fault on their side. It should be consistent imo.
&gt; 
&gt; I&#39;m ok with closing this ticket as invalid
</div>
I sympathize and mostly agree with you. I spoke to one of my colleagues
and he thinks it has been this was forever.

I&#39;ll not close this right now as a&#41; I might think some more about it and
b&#41; I want to faq it anyway.

What I am still not sure about is how this has not been spotted before -
surely someone has used bugzilla with ms sql server. Was this a change
in bugzilla and DBD::ODBC has worked with it before or was it a change
in DBD::ODBC &#40;which I doubt&#41;. I&#39;d really like to know this for certain.

I do not know what your association with bugzilla is but if anyone on
the bugzilla team wants to talk to me about it I&#39;d be happy with that.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-684050" href="/Public/Bug/Display.html?id=50852#txn-684050">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;29&nbsp;11:53:21&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 29 Oct 2009 08:53:00 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/684050/352349/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352349">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 767b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Actually I&#39;m working on the first official port of Bugzilla onto MSSQL. So
its unlikely anyone has ran across it previously.
There was a ancient attempt to port to mssql I recall, but I don&#39;t know what
if any issues they ran into. Bugzilla was much less mature at that time.

I&#39;d actually wager that others may have run across this issue but either
found the same thing we did and made the application level adjustment or
wrote it off as perl incompatibility with mssql and went another route. Its
also possible that the older mssql drivers did the conversion that the newer
drivers do not. Parameters and mssql under perl have been long stand issues
according to some FreeTDS articles. Though that was more geared toward
interaction from non-Microsoft environments.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/684050/352350/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352350">with headers</a>
<br />
<span class="downloadcontenttype">text/html 794b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-700496" href="/Public/Bug/Display.html?id=50852#txn-700496">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;01&nbsp;16:50:21&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 1 Dec 2009 13:49:54 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/700496/361213/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/361213">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 766b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Martin I have not tested this fully yet, but I did run across an oddity
earlier today.

I was receiving &#34;Invalid character value for cast specification&#34; dealing
with INT values when using parameters.
Since this seemed odd since it worked sometimes but not others, from
different locations in the code, I went searching my perl install on a
hunch. Here is what I found.

My perl installation referenced DBD::ODBC 1.22 and DBD::ODBC 1.23

\usr\lib\DBD\ODBC.pm  &lt;- 1.22
\usr\site\lib\DBD\ODBC.pm  &lt;- 1.23

I overwrote the &#39;\usr\lib\DBD\ODBC.pm&#39; file with the one from
&#39;\usr\site\lib\DBD\ODBC.pm&#39; and the errors went away.

Is this something in the base CPAN module or brokenness on Active Perl&#39;s
side? Or something expected somehow?
Active Perl 5.10.1 Build 1006 32bit
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/700496/361214/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/361214">with headers</a>
<br />
<span class="downloadcontenttype">text/html 857b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-700511" href="/Public/Bug/Display.html?id=50852#txn-700511">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;01&nbsp;17:03:05&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 1 Dec 2009 14:02:47 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/700511/361225/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/361225">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 88b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hmm I take it back, not corrected, but still interesting that both file
versions exist?
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/700511/361226/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/361226">with headers</a>
<br />
<span class="downloadcontenttype">text/html 96b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-707996" href="/Public/Bug/Display.html?id=50852#txn-707996">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;17&nbsp;15:25:34&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] AutoReply: [SQL Server Native Client  10.0]Invalid character value for cast specification &#40;SQL-22018&#41; for  datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 17 Dec 2009 12:25:11 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/707996/365285/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365285">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 541b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Further Issues same error:

[Microsoft][SQL Server Native Client 10.0]Invalid character value for cast
specification &#40;SQL-22018&#41;

SELECT DISTINCT top 1001  userid FROM profiles   WHERE  &#40;CHARINDEX&#40;?,
login_name&#41; &gt; 0 OR CHARINDEX&#40;?, realname&#41; &gt; 0&#41;  AND disabledtext = &#39;&#39;

the value of both parameters is  &#39;superman&#39;

login_name and realname are nvarchar

same issue occured in some instance of int. Seems related to being processed
by a function of any type, eg

SELECT DATEADD&#40;minute,?,GETDATE&#40;&#41;&#41;

parameter value &#39;1&#39; throws the same error.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/707996/365286/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365286">with headers</a>
<br />
<span class="downloadcontenttype">text/html 629b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-708285" href="/Public/Bug/Display.html?id=50852#txn-708285">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;03:53:26&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/708285/365450/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365450">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 780b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Dec 17 15:25:34 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Further Issues same error:
&gt; 
&gt; [Microsoft][SQL Server Native Client 10.0]Invalid character value for cast
&gt; specification &#40;SQL-22018&#41;
&gt; 
&gt; SELECT DISTINCT top 1001  userid FROM profiles   WHERE  &#40;CHARINDEX&#40;?,
&gt; login_name&#41; &gt; 0 OR CHARINDEX&#40;?, realname&#41; &gt; 0&#41;  AND disabledtext = &#39;&#39;
&gt; 
&gt; the value of both parameters is  &#39;superman&#39;
&gt; 
&gt; login_name and realname are nvarchar
&gt; 
&gt; same issue occured in some instance of int. Seems related to being
</div>processed
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; by a function of any type, eg
&gt; 
&gt; SELECT DATEADD&#40;minute,?,GETDATE&#40;&#41;&#41;
&gt; 
&gt; parameter value &#39;1&#39; throws the same error.
</div>
Can you provide a small example of these failures - something which
creates the schema and demonstrates the problem?

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-708451" href="/Public/Bug/Display.html?id=50852#txn-708451">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;12:06:35&nbsp;2009</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 18 Dec 2009 09:06:13 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/708451/365542/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365542">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl -w
# vim:ts=4:sw=4:ht=4:expandtab
use strict;
use DBI;
use Data::Dumper;

my $dbname = &#34;bugs&#34;;
my $user = &#34;bugs&#34;;
my $pass = &#34;bugs&#34;;
my $host = &#34;&#34;;

_run_test&#40;&#34;dbi:ODBC:Driver={SQL Server Native Client
10.0};Server=$host;UID=$user;PWD=$pass;Database=$dbname;APP=Bugzilla;&#34;,&#39;bugs&#39;,&#39;bugs&#39;&#41;;

sub _run_test {
    my &#40;$DSN, $user, $pass&#41; = @_;
    print &#34;Connecting...&#34;;

    my $dbh = DBI-&gt;connect&#40;&#34;dbi:ODBC:Bugzilla&#34;,$user,$pass&#41;;
    print &#34;Connected\n&#34; if $dbh;
    exit unless $dbh;


    print &#34;\n\ncreating table &#39;test_me_i_am_broken&#39;...&#34;;
    $dbh-&gt;do&#40;&#34;CREATE TABLE test_me_i_am_broken &#40; userid int identity&#40;1,1&#41;,
login_name NVARCHAR&#40;255&#41;, realname NVARCHAR&#40;255&#41;, disabledtext NVARCHAR&#40;MAX&#41;
&#41;&#34;&#41;;
    print &#34;done\n&#34;;
    print &#34;creating values...&#34;;
    $dbh-&gt;do&#40;&#34;INSERT INTO test_me_i_am_broken &#40;login_name,realname,
disabledtext&#41; VALUES &#40;&#39;mockodin\@gmail.com&#39;, &#39;Michael Thomas&#39;, &#39;&#39;&#41;&#34;&#41;;\
    print &#34;done\n&#34;;

    print &#34;------------------------\n\n\n&#34;;
    print &#34;testing...\n\n&#34;;

    my $findme = &#34;m.t&#34;;
    print Dumper $dbh-&gt;selectall_arrayref&#40;&#34;SELECT TOP 1001 userid FROM
test_me_i_am_broken WHERE  &#40;CHARINDEX&#40;?, login_name&#41; &gt; 0 OR CHARINDEX&#40;?,
realname&#41; &gt; 0&#41;  AND disabledtext = &#39;&#39;&#34;,undef,$findme, $findme&#41;;
    print &#34;\n\n------------------------\n\n\n&#34;;
    print &#34;dropping test table &#39;test_me_i_am_broken&#39;...&#34;;
    $dbh-&gt;do&#40;&#34;DROP TABLE test_me_i_am_broken&#34;&#41;;
    print &#34;done\n&#34;;
    $dbh-&gt;disconnect if &#40;$dbh&#41;;

}
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/708451/365543/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365543">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.9k</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-708453" href="/Public/Bug/Display.html?id=50852#txn-708453">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;18&nbsp;12:11:05&nbsp;2009</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/708453/365545/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/365545">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Dec 18 12:06:35 2009, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; #!/usr/bin/perl -w
&gt; # vim:ts=4:sw=4:ht=4:expandtab
&gt; use strict;
&gt; use DBI;
&gt; use Data::Dumper;
&gt; 
&gt; my $dbname = &#34;bugs&#34;;
&gt; my $user = &#34;bugs&#34;;
&gt; my $pass = &#34;bugs&#34;;
&gt; my $host = &#34;&#34;;
&gt; 
&gt; _run_test&#40;&#34;dbi:ODBC:Driver={SQL Server Native Client
&gt;
</div>10.0};Server=$host;UID=$user;PWD=$pass;Database=$dbname;APP=Bugzilla;&#34;,&#39;bugs&#39;,&#39;bugs&#39;&#41;;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; sub _run_test {
&gt;     my &#40;$DSN, $user, $pass&#41; = @_;
&gt;     print &#34;Connecting...&#34;;
&gt; 
&gt;     my $dbh = DBI-&gt;connect&#40;&#34;dbi:ODBC:Bugzilla&#34;,$user,$pass&#41;;
&gt;     print &#34;Connected\n&#34; if $dbh;
&gt;     exit unless $dbh;
&gt; 
&gt; 
&gt;     print &#34;\n\ncreating table &#39;test_me_i_am_broken&#39;...&#34;;
&gt;     $dbh-&gt;do&#40;&#34;CREATE TABLE test_me_i_am_broken &#40; userid int
&gt; identity&#40;1,1&#41;,
&gt; login_name NVARCHAR&#40;255&#41;, realname NVARCHAR&#40;255&#41;, disabledtext
&gt; NVARCHAR&#40;MAX&#41;
&gt; &#41;&#34;&#41;;
&gt;     print &#34;done\n&#34;;
&gt;     print &#34;creating values...&#34;;
&gt;     $dbh-&gt;do&#40;&#34;INSERT INTO test_me_i_am_broken &#40;login_name,realname,
&gt; disabledtext&#41; VALUES &#40;&#39;mockodin\@gmail.com&#39;, &#39;Michael Thomas&#39;, &#39;&#39;&#41;&#34;&#41;;\
&gt;     print &#34;done\n&#34;;
&gt; 
&gt;     print &#34;------------------------\n\n\n&#34;;
&gt;     print &#34;testing...\n\n&#34;;
&gt; 
&gt;     my $findme = &#34;m.t&#34;;
&gt;     print Dumper $dbh-&gt;selectall_arrayref&#40;&#34;SELECT TOP 1001 userid FROM
&gt; test_me_i_am_broken WHERE  &#40;CHARINDEX&#40;?, login_name&#41; &gt; 0 OR
&gt; CHARINDEX&#40;?,
&gt; realname&#41; &gt; 0&#41;  AND disabledtext = &#39;&#39;&#34;,undef,$findme, $findme&#41;;
&gt;     print &#34;\n\n------------------------\n\n\n&#34;;
&gt;     print &#34;dropping test table &#39;test_me_i_am_broken&#39;...&#34;;
&gt;     $dbh-&gt;do&#40;&#34;DROP TABLE test_me_i_am_broken&#34;&#41;;
&gt;     print &#34;done\n&#34;;
&gt;     $dbh-&gt;disconnect if &#40;$dbh&#41;;
&gt; 
&gt; }
</div>
Thanks. I am on holiday now but I&#39;ll try and find time to look into this.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-716832" href="/Public/Bug/Display.html?id=50852#txn-716832">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;12:50:28&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/716832/370003/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/370003">with headers</a>
<br />
<span class="downloadcontenttype">text/html 2.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza">On Fri Dec 18 12:11:05 2009, MJEVANS wrote: <br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri Dec 18 12:06:35 2009, mockodin wrote: <br>
<div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; #!/usr/bin/perl -w <br>
</div>&gt; &gt; # vim:ts=4:sw=4:ht=4:expandtab <br>
</div>&gt; &gt; use strict; <br>

&gt; &gt; use DBI; <br>

&gt; &gt; use Data::Dumper; <br>

&gt; &gt; <br>

&gt; &gt; my $dbname = &quot;bugs&quot;; <br>

&gt; &gt; my $user = &quot;bugs&quot;; <br>

&gt; &gt; my $pass = &quot;bugs&quot;; <br>

&gt; &gt; my $host = &quot;&quot;; <br>

&gt; &gt; <br>

&gt; &gt; _run_test(&quot;dbi:ODBC:Driver={SQL Server Native Client <br>

&gt; &gt; <br>
</div>&gt; 10.0};Server=$host;UID=$user;PWD=$pass;Database=$dbname;APP=Bugzilla;&quot;,'bugs','bugs'); <br>
<div class="message-stanza open">&gt; &gt; <br>

&gt; &gt; sub _run_test { <br>

&gt; &gt;     my ($DSN, $user, $pass) = @_; <br>

&gt; &gt;     print &quot;Connecting...&quot;; <br>

&gt; &gt; <br>

&gt; &gt;     my $dbh = DBI-&gt;connect(&quot;dbi:ODBC:Bugzilla&quot;,$user,$pass); <br>

&gt; &gt;     print &quot;Connected\n&quot; if $dbh; <br>

&gt; &gt;     exit unless $dbh; <br>

&gt; &gt; <br>

&gt; &gt; <br>

&gt; &gt;     print &quot;\n\ncreating table 'test_me_i_am_broken'...&quot;; <br>

&gt; &gt;     $dbh-&gt;do(&quot;CREATE TABLE test_me_i_am_broken ( userid int <br>

&gt; &gt; identity(1,1), <br>

&gt; &gt; login_name NVARCHAR(255), realname NVARCHAR(255), disabledtext <br>

&gt; &gt; NVARCHAR(MAX) <br>

&gt; &gt; )&quot;); <br>

&gt; &gt;     print &quot;done\n&quot;; <br>

&gt; &gt;     print &quot;creating values...&quot;; <br>

&gt; &gt;     $dbh-&gt;do(&quot;INSERT INTO test_me_i_am_broken (login_name,realname, <br>

&gt; &gt; disabledtext) VALUES ('mockodin\@gmail.com', 'Michael Thomas', <br>
</div>&gt; '')&quot;);\ <br>
<div class="message-stanza open">&gt; &gt;     print &quot;done\n&quot;; <br>

&gt; &gt; <br>

&gt; &gt;     print &quot;------------------------\n\n\n&quot;; <br>

&gt; &gt;     print &quot;testing...\n\n&quot;; <br>

&gt; &gt; <br>

&gt; &gt;     my $findme = &quot;m.t&quot;; <br>

&gt; &gt;     print Dumper $dbh-&gt;selectall_arrayref(&quot;SELECT TOP 1001 userid <br>
</div>&gt; FROM <br>
<div class="message-stanza open">&gt; &gt; test_me_i_am_broken WHERE  (CHARINDEX(?, login_name) &gt; 0 OR <br>

&gt; &gt; CHARINDEX(?, <br>

&gt; &gt; realname) &gt; 0)  AND disabledtext = ''&quot;,undef,$findme, $findme); <br>

&gt; &gt;     print &quot;\n\n------------------------\n\n\n&quot;; <br>

&gt; &gt;     print &quot;dropping test table 'test_me_i_am_broken'...&quot;; <br>

&gt; &gt;     $dbh-&gt;do(&quot;DROP TABLE test_me_i_am_broken&quot;); <br>

&gt; &gt;     print &quot;done\n&quot;; <br>

&gt; &gt;     $dbh-&gt;disconnect if ($dbh); <br>

&gt; &gt; <br>

&gt; &gt; } <br>
</div>&gt;  <br>

&gt; Thanks. I am on holiday now but I'll try and find time to look into <br>

&gt; this. <br>

&gt;  <br>

&gt; Martin <br>
</div><br>

Sorry, I am back from holiday and forgot about this. It is now top of my list for non work issues so please feel free to nag me if you do not hear back in a few days.<br>

<br>

Martin<br>

--  <br>

Martin J. Evans <br>

Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-716962" href="/Public/Bug/Display.html?id=50852#txn-716962">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:26:15&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/716962/370068/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/370068">with headers</a>
<br />
<span class="downloadcontenttype">text/html 410b</span>
</div>
<div class="messagebody">
<div class="message-stanza">Really annoyinging, your example works fine with our SQL&nbsp;Server driver which confirms what I thought which is that this is a driver issue and not a DBD::ODBC&nbsp;issue. Looks like I am going to have to resort to finding what is broken in the MS native client driver which means Windows which means it is going to take a bit longer.<br>

<br>

Martin<br>

--  <br>

Martin J. Evans <br>

Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-717022" href="/Public/Bug/Display.html?id=50852#txn-717022">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;18:07:09&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/717022/370106/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/370106">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza">Hi. The problem with this latest issue you reported (which confused me earlier because I looked at the start of the rt report and reminded myself it was a datetime issue but then it changed to an error 22018 error nothing to do with datetimes) is that the ODBC driver you are using reports the two parameters (via the ODBC&nbsp;API SQLDescribeParam) as SQL_INTEGERs but they are in fact strings:<br>

<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLDescribeParam 1: SqlType=INTEGER(4) param_size=10 Scale=0 Nullable=0<br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLDescribeParam 2: SqlType=INTEGER(4) param_size=10 Scale=0 Nullable=0<br>

<br>

DBD::ODBC&nbsp;cannot know they are strings when the driver says they are integers so it believes what the driver tells it. This does not happen with some other SQL&nbsp;Server ODBC&nbsp;Drivers (e.g., ours i.e., Easysoft's) as they describe the parameters as SQL_NVARCHARs. In this case you need to force the parameter types to be SQL_VARCHAR like this:<br>

<br>

if (0) {<br>

&nbsp;&nbsp;&nbsp; # your original code<br>

&nbsp;&nbsp;&nbsp; print Dumper $dbh-&gt;selectall_arrayref(&quot;SELECT TOP 1001 userid FROM test_me_i_am_broken WHERE (CHARINDEX(?, login_name) &gt; 0 OR CHARINDEX(?, realname) &gt; 0) AND disabledtext = ''&quot;,undef,$findme, $findme);<br>

} else {<br>

&nbsp;&nbsp;&nbsp; # replacement<br>

&nbsp;&nbsp;&nbsp; my $s = $dbh-&gt;prepare(&quot;SELECT TOP 1001 userid FROM test_me_i_am_broken WHERE (CHARINDEX(?, login_name) &gt; 0 OR CHARINDEX(?, realname) &gt; 0) AND disabledtext = ''&quot;);<br>

&nbsp;&nbsp;&nbsp; $s-&gt;bind_param(1, $findme, {TYPE =&gt; SQL_VARCHAR});<br>

&nbsp;&nbsp;&nbsp; $s-&gt;bind_param(2, $findme, {TYPE =&gt; SQL_VARCHAR});<br>

&nbsp;&nbsp;&nbsp; $s-&gt;execute;<br>

&nbsp;&nbsp;&nbsp; print Dumper $s-&gt;fetchall_arrayref;<br>

}<br>

<br>

NOTE, you need to add:<br>

<br>

use DBI qw(:sql_types);<br>

<br>

to get the SQL_VARCHAR definition. Also note, that DBI does not define SQL_NVARCHAR, I am not sure whether you are using the unicode build of DBD::ODBC and I don't know whether any of the strings you pass are likely to be unicode so this may make a difference. Also note that your original example did not work for me until I changed $findme to &quot;m&quot; (and not &quot;m.t&quot;) but I didn't look into that since your strings do not contain&nbsp;&quot;m.t&quot; and I didn't know if CHARINDEX supports wildcards.<br>

<br>

So it is basically another bug in the ODBC driver - your second - hmmm. There may be a way to reorganise your SQL to persuade the driver to return the correct SQL types for the parameter but I don't know what that is (although I'll ask a colleague here tomorrow). You are not the only one to hit this problem although in most cases the SQL required to confuse the sql server driver is a little more complex (unless it is something daft like &quot;select func(?) where 1 = 1&quot;. Basically, the sql server driver attempts to reoganise your SQL statement to end up with a &quot;select parameter_1, parameter_2 from your_table&quot; so it can then find the column types - in your SQL it is failing to come up with the correct select.<br>

<br>

As this has caused a few people problems I am considering making a change to DBD::ODBC to allow you to say just bind everything as strings and don't bother asking the driver what the column is. It is a pain and I've resisted doing this in the vain hope MS would fix their drivers but it seems that is not going to happen. In the mean time your only option is to force SQL_VARCHAR as I describe above.<br>

<br>

Martin<br>

--  <br>

Martin J. Evans <br>

Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-717025" href="/Public/Bug/Display.html?id=50852#txn-717025">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;18:42:46&nbsp;2010</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 7 Jan 2010 15:42:30 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/717025/370110/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/370110">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 498b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">That &#34;bind_param&#34; indeed is the workaround I&#39;m using for this project,
though is obviously less than spectacular to have to do.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;&gt; unless it is something daft like &#34;select func&#40;?&#41; where 1 = 1&#34;
</div>
Ah well since you mentioned it I decided to check:

This is what is detected when I run profiler and then execute the test
script I sent you.
   set fmtonly on select 0,0 from test_me_i_am_broken where 1=2 set fmtonly
off

I&#39;m guessing it is basing the field type on the function instead of the
params.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/717025/370111/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/370111">with headers</a>
<br />
<span class="downloadcontenttype">text/html 566b</span>
</div>
<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-724800" href="/Public/Bug/Display.html?id=50852#txn-724800">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;01:36:16&nbsp;2010</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 25 Jan 2010 22:36:01 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/724800/374347/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/374347">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 13b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Any updates?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-724845" href="/Public/Bug/Display.html?id=50852#txn-724845">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;04:41:15&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/724845/374373/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/374373">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 314b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 26 01:36:16 2010, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Any updates?
</div>
Yes, I coded odbc_force_bind_type but then got distracted. Give me an
hour or two to test it and package it up then if you send me &#40;mjevans at
cpan dot org&#41; your email address I&#39;ll send a distribution to try out.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-724897" href="/Public/Bug/Display.html?id=50852#txn-724897">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;09:03:47&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/724897/374408/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/374408">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 713b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 26 04:41:15 2010, MJEVANS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Jan 26 01:36:16 2010, mockodin wrote:
<div class="message-stanza open">&gt; &gt; Any updates?
</div>&gt; 
&gt; Yes, I coded odbc_force_bind_type but then got distracted. Give me an
&gt; hour or two to test it and package it up then if you send me &#40;mjevans at
&gt; cpan dot org&#41; your email address I&#39;ll send a distribution to try out.
&gt; 
&gt; Martin
</div>
1.23_2 has been uploaded to CPAN. It adds odbc_force_bind_type - see POD
and t/rt_50852.t.

I&#39;m still a little uncertain about the benefit of this over simple
adding {TYPE =&gt; SQL_VARCHAR} etc to the end of the bind_param call as
the underlying problem is a buggy MS SQL Server ODBC Driver and hence
this is a development release.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-724973" href="/Public/Bug/Display.html?id=50852#txn-724973">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;12:06:48&nbsp;2010</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Jan 2010 09:06:19 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/724973/374441/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/374441">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 493b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m still a little uncertain about the benefit of this over simple
&gt; adding {TYPE =&gt; SQL_VARCHAR}
</div>
the benefit being that you can use a single line of code to accomplish
that otherwise takes three.

$dbh-&gt;do&#40;&#34;select * from table1 WHERE fielda = ?&#34;, undef, $blah&#41;;

vs

$dbh-&gt;prepare&#40;
$dbh-&gt;bind_param&#40;$blah, SQL_VARCHAR&#41;;
$dbh-&gt;execute

Not to say defaulting a particular datatype is a great way to go, but
if it works the option being open is good. Optimally mssql gets their
act together.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-724983" href="/Public/Bug/Display.html?id=50852#txn-724983">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;26&nbsp;12:12:27&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/724983/374448/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/374448">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 26 12:06:48 2010, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I&#39;m still a little uncertain about the benefit of this over simple
&gt; &gt; adding {TYPE =&gt; SQL_VARCHAR}
</div>&gt; 
&gt; the benefit being that you can use a single line of code to accomplish
&gt; that otherwise takes three.
&gt; 
&gt; $dbh-&gt;do&#40;&#34;select * from table1 WHERE fielda = ?&#34;, undef, $blah&#41;;
&gt; 
&gt; vs
&gt; 
&gt; $dbh-&gt;prepare&#40;
&gt; $dbh-&gt;bind_param&#40;$blah, SQL_VARCHAR&#41;;
&gt; $dbh-&gt;execute
&gt; 
&gt; Not to say defaulting a particular datatype is a great way to go, but
&gt; if it works the option being open is good. Optimally mssql gets their
&gt; act together.
</div>
The problem is you will lose track of the SQL which exhibits the bug
whereas if you put TYPE=&gt;SQL_VARCHAR you know this is a dodgy one.

DBI and DBDs try very hard to do the right thing and make it so that
code written for one db works with another. As soon as you have to start
adding special attributes this falls down. No way out of it at present
but TYPE=&gt;SQL_VARCHAR is more portable than odbc_force_bind_type.

Anyway, it is a small change and I don&#39;t think it hurts.

Let me know how you get on.

Martin
-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-729682" href="/Public/Bug/Display.html?id=50852#txn-729682">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;05&nbsp;14:48:02&nbsp;2010</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 5 Feb 2010 11:47:05 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/729682/376934/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/376934">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 480b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m thinking this introduces more uncertainty than benefit the follow
worked fine under 1.23 but threw the Specification error for 1.23_2
&#34;UPDATE whine_schedules SET run_next = ? WHERE id = ?&#34;

Opened a Bug with Microsoft:
<span class="clickylink"><a target="new" rel="nofollow" href="https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-datatype-lookup-returns-incorrectly">https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-datatype-lookup-returns-incorrectly</a></span>

I noted they have already marked to &#34;Closed as Fixed&#34; but have
provided no detail on a hotfix or forth coming release version that
fix the issue.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-763160" href="/Public/Bug/Display.html?id=50852#txn-763160">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;14&nbsp;14:02:54&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/763160/394834/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/394834">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi again,

I am about to do a new development release of DBD::ODBC 1.23_4 which
includes changes which speed up prepared statements considerably in
certain circumstances. I&#39;m afraid it does nothing more than the last
release I sent you to fix the problem you reported as the problem is in
MS&#39;s ODBC driver. However, would you be interested in checking it out
before I do a final release of 1.24? If so get back to me and I&#39;ll let
you know when it is uploaded to CPAN. I&#39;m struggling to find people to
test development releases before final releases and then when the final
release is done I get a bunch of rt reports so I&#39;d appreciate it.

If on the other hand you are no longer using DBD::ODBC, that would be
useful to know too. I currently have no way to further your rt beyond
the suggestions I originally made and the addition of the new attribute
to force binding type globally. I&#39;d like to close this rt with reference
to the issue in the DBD::ODBC FAQ as there is no way for me to progress
it - I&#39;d be interested in your opinion on this.

Martin

On Fri Feb 05 14:48:02 2010, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m thinking this introduces more uncertainty than benefit the follow
&gt; worked fine under 1.23 but threw the Specification error for 1.23_2
&gt; &#34;UPDATE whine_schedules SET run_next = ? WHERE id = ?&#34;
&gt; 
&gt; Opened a Bug with Microsoft:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-">https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-</a></span>
&gt; datatype-lookup-returns-incorrectly
&gt; 
&gt; I noted they have already marked to &#34;Closed as Fixed&#34; but have
&gt; provided no detail on a hotfix or forth coming release version that
&gt; fix the issue.
</div>

-- 
Martin J. Evans
Wetherby, UK
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-763504" href="/Public/Bug/Display.html?id=50852#txn-763504">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;14&nbsp;23:30:23&nbsp;2010</span>
    <span class="description">mockodin [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #50852] [SQL Server Native Client 10.0]Invalid  character value for cast specification &#40;SQL-22018&#41; for datetime/smalldatetime</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 14 Apr 2010 20:30:07 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-ODBC [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Thomas &lt;mockodin [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/763504/395029/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/395029">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sure I can test the patch. At present I have a app using DBD::ODBC
with FreeTDS and the bugzilla project, which will likely end up
supporting Windows and Linux with mssql.

Code review just started on the bugzilla project, on bugzilla.org, so
it should end up getting a fairly good work out in the coming months.
As far as this ticket, since it appears to be a bug on Microsoft&#39;s
part, admitted by them essentially here
<span class="clickylink"><a target="new" rel="nofollow" href="https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-datatype-lookup-returns-incorrectly">https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-datatype-lookup-returns-incorrectly</a></span>
, we can probably close and note it.

On Wed, Apr 14, 2010 at 11:02 AM, Martin J Evans via RT
&lt;bug-DBD-ODBC@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=50852">https://rt.cpan.org/Ticket/Display.html?id=50852</a></span> &gt;
&gt;
&gt; Hi again,
&gt;
&gt; I am about to do a new development release of DBD::ODBC 1.23_4 which
&gt; includes changes which speed up prepared statements considerably in
&gt; certain circumstances. I&#39;m afraid it does nothing more than the last
&gt; release I sent you to fix the problem you reported as the problem is in
&gt; MS&#39;s ODBC driver. However, would you be interested in checking it out
&gt; before I do a final release of 1.24? If so get back to me and I&#39;ll let
&gt; you know when it is uploaded to CPAN. I&#39;m struggling to find people to
&gt; test development releases before final releases and then when the final
&gt; release is done I get a bunch of rt reports so I&#39;d appreciate it.
&gt;
&gt; If on the other hand you are no longer using DBD::ODBC, that would be
&gt; useful to know too. I currently have no way to further your rt beyond
&gt; the suggestions I originally made and the addition of the new attribute
&gt; to force binding type globally. I&#39;d like to close this rt with reference
&gt; to the issue in the DBD::ODBC FAQ as there is no way for me to progress
&gt; it - I&#39;d be interested in your opinion on this.
&gt;
&gt; Martin
&gt;
&gt; On Fri Feb 05 14:48:02 2010, mockodin wrote:
<div class="message-stanza open">&gt;&gt; I&#39;m thinking this introduces more uncertainty than benefit the follow
&gt;&gt; worked fine under 1.23 but threw the Specification error for 1.23_2
&gt;&gt; &#34;UPDATE whine_schedules SET run_next = ? WHERE id = ?&#34;
&gt;&gt;
&gt;&gt; Opened a Bug with Microsoft:
&gt;&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-">https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-</a></span>
&gt;&gt; datatype-lookup-returns-incorrectly
&gt;&gt;
&gt;&gt; I noted they have already marked to &#34;Closed as Fixed&#34; but have
&gt;&gt; provided no detail on a hotfix or forth coming release version that
&gt;&gt; fix the issue.
</div>&gt;
&gt;
&gt; --
&gt; Martin J. Evans
&gt; Wetherby, UK
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-763542" href="/Public/Bug/Display.html?id=50852#txn-763542">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;15&nbsp;03:26:38&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/763542/395043/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/395043">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Apr 14 23:30:23 2010, mockodin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sure I can test the patch. At present I have a app using DBD::ODBC
&gt; with FreeTDS and the bugzilla project, which will likely end up
&gt; supporting Windows and Linux with mssql.
&gt; 
&gt; Code review just started on the bugzilla project, on bugzilla.org, so
&gt; it should end up getting a fairly good work out in the coming months.
&gt; As far as this ticket, since it appears to be a bug on Microsoft&#39;s
&gt; part, admitted by them essentially here
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-">https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-</a></span>
&gt; datatype-lookup-returns-incorrectly
&gt; , we can probably close and note it.
</div>
Thanks for the response. DBD::ODBC 1.23_4 is on CPAN. I will add the URL
and some notes to the DBD::ODBC FAQ and close this rt.

Martin
-- 
Martin J. Evans
Wetherby, UK

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed, Apr 14, 2010 at 11:02 AM, Martin J Evans via RT
&gt; &lt;bug-DBD-ODBC@rt.cpan.org&gt; wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=50852">https://rt.cpan.org/Ticket/Display.html?id=50852</a></span> &gt;
&gt; &gt;
&gt; &gt; Hi again,
&gt; &gt;
&gt; &gt; I am about to do a new development release of DBD::ODBC 1.23_4 which
&gt; &gt; includes changes which speed up prepared statements considerably in
&gt; &gt; certain circumstances. I&#39;m afraid it does nothing more than the last
&gt; &gt; release I sent you to fix the problem you reported as the problem is
</div>&gt; in
<div class="message-stanza open">&gt; &gt; MS&#39;s ODBC driver. However, would you be interested in checking it
</div>&gt; out
<div class="message-stanza open">&gt; &gt; before I do a final release of 1.24? If so get back to me and I&#39;ll
</div>&gt; let
<div class="message-stanza open">&gt; &gt; you know when it is uploaded to CPAN. I&#39;m struggling to find people
</div>&gt; to
<div class="message-stanza open">&gt; &gt; test development releases before final releases and then when the
</div>&gt; final
<div class="message-stanza open">&gt; &gt; release is done I get a bunch of rt reports so I&#39;d appreciate it.
&gt; &gt;
&gt; &gt; If on the other hand you are no longer using DBD::ODBC, that would
</div>&gt; be
<div class="message-stanza open">&gt; &gt; useful to know too. I currently have no way to further your rt
</div>&gt; beyond
<div class="message-stanza open">&gt; &gt; the suggestions I originally made and the addition of the new
</div>&gt; attribute
<div class="message-stanza open">&gt; &gt; to force binding type globally. I&#39;d like to close this rt with
</div>&gt; reference
<div class="message-stanza open">&gt; &gt; to the issue in the DBD::ODBC FAQ as there is no way for me to
</div>&gt; progress
<div class="message-stanza open">&gt; &gt; it - I&#39;d be interested in your opinion on this.
&gt; &gt;
&gt; &gt; Martin
&gt; &gt;
&gt; &gt; On Fri Feb 05 14:48:02 2010, mockodin wrote:
<div class="message-stanza open">&gt; &gt;&gt; I&#39;m thinking this introduces more uncertainty than benefit the
</div></div>&gt; follow
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; worked fine under 1.23 but threw the Specification error for 1.23_2
&gt; &gt;&gt; &#34;UPDATE whine_schedules SET run_next = ? WHERE id = ?&#34;
&gt; &gt;&gt;
&gt; &gt;&gt; Opened a Bug with Microsoft:
&gt; &gt;&gt;
</div></div>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-">https://connect.microsoft.com/SQLServer/feedback/details/527188/paramater-</a></span>
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt;&gt; datatype-lookup-returns-incorrectly
&gt; &gt;&gt;
&gt; &gt;&gt; I noted they have already marked to &#34;Closed as Fixed&#34; but have
&gt; &gt;&gt; provided no detail on a hotfix or forth coming release version that
&gt; &gt;&gt; fix the issue.
</div>&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Martin J. Evans
&gt; &gt; Wetherby, UK
&gt; &gt;
</div></div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-763545" href="/Public/Bug/Display.html?id=50852#txn-763545">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;15&nbsp;03:53:52&nbsp;2010</span>
    <span class="description">bohica [...] ntlworld.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 1.488954</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
