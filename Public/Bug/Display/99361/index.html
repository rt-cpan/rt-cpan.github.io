<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #99361 for Log-Log4perl: reinitializing Log4perl does not reset additivity. Bug?</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #99361 for Log-Log4perl: reinitializing Log4perl does not reset additivity. Bug?</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Log-Log4perl/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Log-Log4perl/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Log-Log4perl/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Log-Log4perl/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Log-Log4perl">Log-Log4perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">99361</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Log-Log4perl/Active/">Log-Log4perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gurub_n [...] yahoo.co.in

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19484-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19485-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;07&nbsp;16:47:14&nbsp;2014</span>
    <span class="description">gurub_n [...] yahoo.co.in -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> reinitializing Log4perl does not reset additivity. Bug?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 7 Oct 2014 16:47:05 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Log-Log4perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> G &lt;gurub_n [...] yahoo.co.in&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I have a perl test harness and couple of supporting modules. I use Log4perl
for logging. I initialize the logger at init of my harness. Everything
related to logging works fine with this configuration. There are few users
who reinitialize the logger. But it looks like after every time you
initialize the logger, everything gets reset except the additivity. Because
of which all log statements related to that category won&#39;t get logged.

Sample scenario:  say my config has this line

...

log4perl.logger.some.module = INFO, someAp
log4perl.additivity.some.module = 0
...

After reinitialization, the log4perl.logger.some.module = INFO, someAp gets
reset, but additivity still persists.
Any log statements from some.module won&#39;t be logged at all.

As a workaround, I am keeping track of additivity and i am explicitly
unsetting it at the reinitialization time.

-- 
regards,
​gurub_n​
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;08&nbsp;02:47:49&nbsp;2014</span>
    <span class="description">MSCHILLI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Oct 07 16:47:14 2014, gurub_n@yahoo.co.in wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sample scenario:  say my config has this line
&gt; log4perl.logger.some.module = INFO, someAp
&gt; log4perl.additivity.some.module = 0
</div>
I&#39;ve tried to reproduce the problem you&#39;ve reported, but found that it works as expected:

use strict;

use Log::Log4perl qw&#40;:easy&#41;;

my $conf = &lt;&lt;EOT;
log4perl.logger.some.module = INFO, someAp                                      
log4perl.additivity.some.module = 0                                             
log4perl.appender.someAp = Log::Log4perl::Appender::Screen
log4perl.appender.someAp.layout = Log::Log4perl::Layout::SimpleLayout
EOT

Log::Log4perl-&gt;init&#40;\$conf&#41;;

my $logger = get_logger&#40; &#34;some::module&#34; &#41;;
$logger-&gt;info&#40; &#34;Hooray!&#34; &#41;;
print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;

$logger-&gt;additivity&#40;1&#41;;
print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;

Log::Log4perl-&gt;init&#40;\$conf&#41;;
print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;

Can you post code that reproduces the problem?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;08&nbsp;02:47:49&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;09&nbsp;00:56:38&nbsp;2014</span>
    <span class="description">gurub_n [...] yahoo.co.in -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #99361] reinitializing Log4perl does not reset additivity. Bug?</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 9 Oct 2014 00:56:28 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Log-Log4perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> G &lt;gurub_n [...] yahoo.co.in&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Micheal,

Thanks for the quick reply!
Below is the script which reproduces the scenario:

use strict;


use Log::Log4perl qw&#40;:easy&#41;;


my $conf = &lt;&lt;EOT;

log4perl.logger.some.module = INFO, someAp

log4perl.additivity.some.module = 0

log4perl.appender.someAp = Log::Log4perl::Appender::Screen

log4perl.appender.someAp.layout = Log::Log4perl::Layout::SimpleLayout

EOT


my $conf2 = &lt;&lt;EOT;

log4perl.rootLogger = INFO, someAp2

log4perl.appender.someAp2 = Log::Log4perl::Appender::Screen

log4perl.appender.someAp2.layout = Log::Log4perl::Layout::SimpleLayout

EOT


Log::Log4perl-&gt;init&#40;\$conf&#41;;


my $logger = get_logger&#40; &#34;some::module&#34; &#41;;

$logger-&gt;info&#40; &#34;Hooray!&#34; &#41;;

print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;


Log::Log4perl-&gt;init&#40;\$conf2&#41;;

print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;

some::module-&gt;test&#40;&#41;;


#any log lines from some.module wont be logged.

#comment out line 24 and you will see the log line from some::module::test

package some::module;


use Log::Log4perl qw&#40;:easy&#41;;


sub test {

    $logger-&gt;info&#40; &#34;This wont be logged&#34; &#41;;

}


Thanks,

On Wed, Oct 8, 2014 at 2:47 AM, Michael_Schilli via RT &lt;
bug-Log-Log4perl@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=99361">https://rt.cpan.org/Ticket/Display.html?id=99361</a></span> &gt;
&gt;
&gt; On Tue Oct 07 16:47:14 2014, gurub_n@yahoo.co.in wrote:
<div class="message-stanza open">&gt; &gt; Sample scenario:  say my config has this line
&gt; &gt; log4perl.logger.some.module = INFO, someAp
&gt; &gt; log4perl.additivity.some.module = 0
</div>&gt;
&gt; I&#39;ve tried to reproduce the problem you&#39;ve reported, but found that it
&gt; works as expected:
&gt;
&gt; use strict;
&gt;
&gt; use Log::Log4perl qw&#40;:easy&#41;;
&gt;
&gt; my $conf = &lt;&lt;EOT;
&gt; log4perl.logger.some.module = INFO, someAp
&gt; log4perl.additivity.some.module = 0
&gt; log4perl.appender.someAp = Log::Log4perl::Appender::Screen
&gt; log4perl.appender.someAp.layout = Log::Log4perl::Layout::SimpleLayout
&gt; EOT
&gt;
&gt; Log::Log4perl-&gt;init&#40;\$conf&#41;;
&gt;
&gt; my $logger = get_logger&#40; &#34;some::module&#34; &#41;;
&gt; $logger-&gt;info&#40; &#34;Hooray!&#34; &#41;;
&gt; print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;
&gt;
&gt; $logger-&gt;additivity&#40;1&#41;;
&gt; print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;
&gt;
&gt; Log::Log4perl-&gt;init&#40;\$conf&#41;;
&gt; print &#34;Additivity: &#34;, $logger-&gt;additivity&#40;&#41;, &#34;\n&#34;;
&gt;
&gt; Can you post code that reproduces the problem?
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;09&nbsp;02:06:53&nbsp;2014</span>
    <span class="description">MSCHILLI [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Oct 09 00:56:38 2014, gurub_n@yahoo.co.in wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Below is the script which reproduces the scenario:
</div>
Oh, OK, I see now, you&#39;re using the same $logger reference. Unless you obtain a new logger via                                                                
                                                                                
    my $logger = get_logger&#40; &#34;some::module&#34; &#41;;                                  
                                                                                
the logger is still the old one and has the old additivity.                     
                                                                                
Log4perl can&#39;t take away your old loggers if you&#39;re holding on to them, but if you get a new one, you&#39;ll get the new behavior.                          
                                                                                
Hope that helps!                                                                
                                                                                
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;18&nbsp;20:37:01&nbsp;2014</span>
    <span class="description">MSCHILLI [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
