<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #60892 for FindBin: $FindBin::RealBin is tainted </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #60892 for FindBin: $FindBin::RealBin is tainted </h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=FindBin">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=FindBin">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=FindBin">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=FindBin">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/FindBin">FindBin CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">60892</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=FindBin">FindBin</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
JNW [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-13642-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-13643-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=60892">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824616" href="/Public/Bug/Display.html?id=60892#txn-824616">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;14:45:01&nbsp;2010</span>
    <span class="description">JNW [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> $FindBin::RealBin is tainted</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824616/427188/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427188">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 262b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">FindBin-1.50 as included in perl-5.12.1 fails under -T if I use it as
suggested in the POD:

 use FindBin qw&#40;$RealBin&#41;;
 use lib &#34;$RealBin/../lib&#34;;

This ugly workaround helps: 

 use FindBin;
 BEGIN { unshift @INC, &#34;$1/../lib&#34; if $FindBin::RealBin =~ m{&#40;.*&#41;} };
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824657" href="/Public/Bug/Display.html?id=60892#txn-824657">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;16:43:43&nbsp;2010</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/824657/427215/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427215">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 637b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Aug 30 14:45:01 2010, JNW wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; FindBin-1.50 as included in perl-5.12.1 fails under -T if I use it as
&gt; suggested in the POD:
&gt; 
&gt;  use FindBin qw&#40;$RealBin&#41;;
&gt;  use lib &#34;$RealBin/../lib&#34;;
&gt; 
&gt; This ugly workaround helps: 
&gt; 
&gt;  use FindBin;
&gt;  BEGIN { unshift @INC, &#34;$1/../lib&#34; if $FindBin::RealBin =~ m{&#40;.*&#41;} };
</div>
I can&#39;t reproduce this with 5.12.1 or any other version of Perl.  Are
you sure that you&#39;ve shown everything necessary to reproduce the problem?

Since the information from FindBin is coming from outside the program&#39;s
control, it would be fitting if it were tainted.  It is essentially
parsing $0 which is tainted.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824660" href="/Public/Bug/Display.html?id=60892#txn-824660">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;16:43:44&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824665" href="/Public/Bug/Display.html?id=60892#txn-824665">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;16:57:41&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Aug 2010 13:57:32 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael G Schwern via RT &lt;bug-FindBin [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824665/427221/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427221">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Aug 30, 2010 at 04:43:44PM -0400, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: FindBin
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60892">https://rt.cpan.org/Ticket/Display.html?id=60892</a></span> &gt;
&gt; 
&gt; On Mon Aug 30 14:45:01 2010, JNW wrote:
<div class="message-stanza open">&gt; &gt; FindBin-1.50 as included in perl-5.12.1 fails under -T if I use it as
&gt; &gt; suggested in the POD:
&gt; &gt; 
&gt; &gt;  use FindBin qw&#40;$RealBin&#41;;
&gt; &gt;  use lib &#34;$RealBin/../lib&#34;;
&gt; &gt; 
&gt; &gt; This ugly workaround helps: 
&gt; &gt; 
&gt; &gt;  use FindBin;
&gt; &gt;  BEGIN { unshift @INC, &#34;$1/../lib&#34; if $FindBin::RealBin =~ m{&#40;.*&#41;} };
</div>&gt; 
&gt; I can&#39;t reproduce this with 5.12.1 or any other version of Perl.  Are
&gt; you sure that you&#39;ve shown everything necessary to reproduce the problem?
&gt; 
&gt; Since the information from FindBin is coming from outside the program&#39;s
&gt; control, it would be fitting if it were tainted.  It is essentially
&gt; parsing $0 which is tainted.
</div>
I do not see why it should be tainted on systems where the supplied
path is reliable.  On such systems, the information would be &#34;outside
of program&#39;s control&#34; only if the caller is able to rename perl...

Hope this helps,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824674" href="/Public/Bug/Display.html?id=60892#txn-824674">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;17:05:01&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Aug 2010 14:04:53 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Ilya Zakharevich via RT &lt;bug-FindBin [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824674/427226/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427226">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 612b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Aug 30, 2010 at 04:57:41PM -0400, Ilya Zakharevich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Since the information from FindBin is coming from outside the program&#39;s
&gt; &gt; control, it would be fitting if it were tainted.  It is essentially
&gt; &gt; parsing $0 which is tainted.
</div>&gt; 
&gt; I do not see why it should be tainted on systems where the supplied
&gt; path is reliable.  On such systems, the information would be &#34;outside
&gt; of program&#39;s control&#34; only if the caller is able to rename perl...
</div>
Silly me, I was confusing $^X with $0...  But the analysis remains: if
the caller is able to change $0, all bets are off anyway.

Sorry,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824677" href="/Public/Bug/Display.html?id=60892#txn-824677">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;17:08:22&nbsp;2010</span>
    <span class="description">gbarr [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Aug 2010 16:08:10 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-FindBin [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Graham Barr &lt;gbarr [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824677/427229/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427229">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Aug 30, 2010, at 15:57 , Ilya Zakharevich via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: FindBin
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=60892">http://rt.cpan.org/Ticket/Display.html?id=60892</a></span> &gt;
&gt; 
&gt; On Mon, Aug 30, 2010 at 04:43:44PM -0400, Michael G Schwern via RT wrote:
<div class="message-stanza open">&gt;&gt;       Queue: FindBin
&gt;&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60892">https://rt.cpan.org/Ticket/Display.html?id=60892</a></span> &gt;
&gt;&gt; 
&gt;&gt; On Mon Aug 30 14:45:01 2010, JNW wrote:
<div class="message-stanza open">&gt;&gt;&gt; FindBin-1.50 as included in perl-5.12.1 fails under -T if I use it as
&gt;&gt;&gt; suggested in the POD:
&gt;&gt;&gt; 
&gt;&gt;&gt; use FindBin qw&#40;$RealBin&#41;;
&gt;&gt;&gt; use lib &#34;$RealBin/../lib&#34;;
&gt;&gt;&gt; 
&gt;&gt;&gt; This ugly workaround helps: 
&gt;&gt;&gt; 
&gt;&gt;&gt; use FindBin;
&gt;&gt;&gt; BEGIN { unshift @INC, &#34;$1/../lib&#34; if $FindBin::RealBin =~ m{&#40;.*&#41;} };
</div>&gt;&gt; 
&gt;&gt; I can&#39;t reproduce this with 5.12.1 or any other version of Perl.  Are
&gt;&gt; you sure that you&#39;ve shown everything necessary to reproduce the problem?
&gt;&gt; 
&gt;&gt; Since the information from FindBin is coming from outside the program&#39;s
&gt;&gt; control, it would be fitting if it were tainted.  It is essentially
&gt;&gt; parsing $0 which is tainted.
</div>&gt; 
&gt; I do not see why it should be tainted on systems where the supplied
&gt; path is reliable.  On such systems, the information would be &#34;outside
&gt; of program&#39;s control&#34; only if the caller is able to rename perl...
</div>
Not true. FindBin::RealBin is the bin directory of the script, not the perl executable

$FindBin::Bin almost certainly should be tainted on any system which provides symlinks
or similar. Also if $0 is not the full path, the $ENV{PATH} will be used, so again it
should be tainted.

Graham.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824715" href="/Public/Bug/Display.html?id=60892#txn-824715">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;19:55:37&nbsp;2010</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Aug 2010 16:55:20 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-FindBin [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824715/427248/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427248">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2010.8.30 2:05 PM, Ilya Zakharevich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: FindBin
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60892">https://rt.cpan.org/Ticket/Display.html?id=60892</a></span> &gt;
&gt; 
&gt; On Mon, Aug 30, 2010 at 04:57:41PM -0400, Ilya Zakharevich via RT wrote:
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt;&gt; Since the information from FindBin is coming from outside the program&#39;s
&gt;&gt;&gt; control, it would be fitting if it were tainted.  It is essentially
&gt;&gt;&gt; parsing $0 which is tainted.
</div>&gt;&gt;
&gt;&gt; I do not see why it should be tainted on systems where the supplied
&gt;&gt; path is reliable.  On such systems, the information would be &#34;outside
&gt;&gt; of program&#39;s control&#34; only if the caller is able to rename perl...
</div>&gt; 
&gt; Silly me, I was confusing $^X with $0...  But the analysis remains: if
&gt; the caller is able to change $0, all bets are off anyway.
</div>
Tainting does not make value judgments like that.  Going down that road, what
if the data is coming from a file that the process owner owns and its set only
owner writable?  Certainly sounds safe, why taint it?  What if an attacker
tricked the process &#40;or another process&#41; into writing that file?

All bets are not off if $0 can be changed.  Initial breeches are usually very
narrow and specific and rely on bootstrapping from that small hole into more
and more privileges.  As Graham pointed out, maybe you tricked a program into
running a linked file with a poisoned name.  Tainting would stop the attacker
from bootstrapping further, if detainting is doing its job. [2]

If it comes from outside the program, it is tainted. [1]  This is a bit
tautological, but it keeps things simple and it avoids making probably invalid
assumptions about how the data and program are going to be used.

There is the narrower issue.  FindBin *could* detaint for the user.  It
probably sometimes already does accidentally, which is why I can&#39;t reproduce
this issue.  This too makes assumptions about how the data is going to be
used.  One could make this safer by encoding those assumptions and safety
checks.  That is, make a FindBin function which is all about setting up @INC.

    use FindBin qw&#40;bin_to_lib&#41;;
    bin_to_lib&#40;&#34;..&#34;, &#34;lib&#34;&#41;;

That would be the equivalent of:

    use FindBin;
    use lib &#34;$FindBin::Bin/../lib&#34;;

but with everything detainted and done in a cross platform manner and making
its assumptions about how the detainted data will be used explicit.


[1] With mostly unfortunate exceptions due to implementation.
[2] That is, forcing the programmer to consider and handle security
    implications of untrusted data.

-- 
ROCKS FALL! EVERYONE DIES!
        <span class="clickylink"><a target="new" rel="nofollow" href="http://www.somethingpositive.net/sp05032002.shtml">http://www.somethingpositive.net/sp05032002.shtml</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824718" href="/Public/Bug/Display.html?id=60892#txn-824718">#</a>      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;30&nbsp;20:21:58&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 30 Aug 2010 17:21:49 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael G Schwern via RT &lt;bug-FindBin [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824718/427251/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427251">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Aug 30, 2010 at 07:55:41PM -0400, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Silly me, I was confusing $^X with $0...  But the analysis remains: if
&gt; &gt; the caller is able to change $0, all bets are off anyway.
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tainting does not make value judgments like that.  Going down that road, what
&gt; if the data is coming from a file that the process owner owns and its set only
&gt; owner writable?  Certainly sounds safe, why taint it?  What if an attacker
&gt; tricked the process &#40;or another process&#41; into writing that file?
</div>
Of course tainting DOES value judgements.  Does it check whether CRTL is
one which is expected?  Does it check that there are not hot-fixes to
Perl&#39;s DLL?  &#40;Possible on Solaris.&#41;  Does it check that things are not
maliciously chroot&#40;&#41;ed?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; All bets are not off if $0 can be changed.  Initial breeches are usually very
&gt; narrow and specific and rely on bootstrapping from that small hole into more
&gt; and more privileges.  As Graham pointed out, maybe you tricked a program into
&gt; running a linked file with a poisoned name.
</div>
It is still not clear to me how this would be possible, but replacing
the script by a different one is not.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tainting would stop the attacker from bootstrapping further, if
&gt; detainting is doing its job. [2]
</div>
Seeing the code you propose below, I do not see how it would stop anyone...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     use FindBin qw&#40;bin_to_lib&#41;;
&gt;     bin_to_lib&#40;&#34;..&#34;, &#34;lib&#34;&#41;;
</div>
  [OT: not clear why you think it is better than
       use FindBin;
       FindBin::bin_to_lib&#40;&#34;..&#34;, &#34;lib&#34;&#41;;
   ...]

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; That would be the equivalent of:
&gt; 
&gt;     use FindBin;
&gt;     use lib &#34;$FindBin::Bin/../lib&#34;;
&gt; 
&gt; but with everything detainted and done in a cross platform manner and making
&gt; its assumptions about how the detainted data will be used explicit.
</div>
And making as great a security hole as one had when $0 was untainted...

I do not see any solutin except for having
   use FindBin;
   FindBin::untainted_bin_to_lib &#39;../lib&#39;;
&#40;as you see, I see no point in manually breaking into components when
untainted_bin_to_lib&#40;&#41; can split on &#39;/&#39; anyway&#41;.

Yours,
Ilya
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-824849" href="/Public/Bug/Display.html?id=60892#txn-824849">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;31&nbsp;05:53:26&nbsp;2010</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 31 Aug 2010 02:53:13 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-FindBin [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/824849/427311/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427311">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2010.8.30 5:21 PM, Ilya Zakharevich via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: FindBin
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60892">https://rt.cpan.org/Ticket/Display.html?id=60892</a></span> &gt;
&gt; 
&gt; On Mon, Aug 30, 2010 at 07:55:41PM -0400, Michael G Schwern via RT wrote:
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt;&gt; Silly me, I was confusing $^X with $0...  But the analysis remains: if
&gt;&gt;&gt; the caller is able to change $0, all bets are off anyway.
</div></div>&gt; 
<div class="message-stanza open">&gt;&gt; Tainting does not make value judgments like that.  Going down that road, what
&gt;&gt; if the data is coming from a file that the process owner owns and its set only
&gt;&gt; owner writable?  Certainly sounds safe, why taint it?  What if an attacker
&gt;&gt; tricked the process &#40;or another process&#41; into writing that file?
</div>&gt; 
&gt; Of course tainting DOES value judgements.  Does it check whether CRTL is
&gt; one which is expected?  Does it check that there are not hot-fixes to
&gt; Perl&#39;s DLL?  &#40;Possible on Solaris.&#41;  Does it check that things are not
&gt; maliciously chroot&#40;&#41;ed?
</div>
While those are security concerns, those are not &#34;data coming from outside the
program&#34; which is all tainting is really about.  Tainting has nothing to say
about any of that.

If you want to talk about expanding the scope of tainting, or adding
additional security checks to Perl, or the value of taint in general, that&#39;s a
whole other issue.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; All bets are not off if $0 can be changed.  Initial breeches are usually very
&gt;&gt; narrow and specific and rely on bootstrapping from that small hole into more
&gt;&gt; and more privileges.  As Graham pointed out, maybe you tricked a program into
&gt;&gt; running a linked file with a poisoned name.
</div>&gt; 
&gt; It is still not clear to me how this would be possible, but replacing
&gt; the script by a different one is not.
</div>
When it comes to security, I find I&#39;m usually not smart enough to see the
holes either.  So I&#39;m perfectly happy with leaving everything sealed up tight.

$0 need not have been attacked and changed.  You could be generating programs
with filenames based on user input &#40;I&#39;ve seen sillier things&#41; and someone
slipped in some input that causes your filename to be &#34;rm -rf /;&#34; in the hopes
you&#39;ll use the filename in a system call.

Its a stretch, but I&#39;ve seen crazier things.  The temp file attacks that
cropped up a while back, all relying on very well timed file replacements and
very subtle slips in temp file handling.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; Tainting would stop the attacker from bootstrapping further, if
&gt;&gt; detainting is doing its job. [2]
</div>&gt; 
&gt; Seeing the code you propose below, I do not see how it would stop anyone...
</div>
Sorry, I was misleading about what it does.

bin_to_lib&#40;&#41; would leave everything outside tainted.  $0 remains tainted.
$FindBin::Bin remains tainted.  It *only* detaints for the specific purpose of
pushing $FindBin::Bin/../lib onto @INC so that @INC does not catch $0&#39;s taint.
 I don&#39;t think that&#39;s any more exploitable than the whole idea of FindBin is
to begin with.  I could be wrong, but its better than people blindly
untainting $FindBin::Bin as the original reporter was.

The important bit is that because we don&#39;t know how they&#39;ll be used, it leaves
$FindBin::Bin and friends tainted for the rest of the program.

Here&#39;s what it might look like:

    sub bin_to_lib {
        my @lib = @_;

        # Is there any checks we can do here?
        # Can anything malicious be put into @INC?
        my&#40;$bin&#41; = $FindBin::Bin =~ /&#40;.*&#41;/;

        require lib;
        lib-&gt;import&#40;File::Spec-&gt;catdir&#40;$bin, $lib&#41;&#41;;

        return 1;
    }

Does that clear things up?


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; That would be the equivalent of:
&gt;&gt;
&gt;&gt;     use FindBin;
&gt;&gt;     use lib &#34;$FindBin::Bin/../lib&#34;;
&gt;&gt;
&gt;&gt; but with everything detainted and done in a cross platform manner and making
&gt;&gt; its assumptions about how the detainted data will be used explicit.
</div>&gt; 
&gt; And making as great a security hole as one had when $0 was untainted...
&gt;
&gt; I do not see any solutin except for having
&gt;    use FindBin;
&gt;    FindBin::untainted_bin_to_lib &#39;../lib&#39;;
&gt; &#40;as you see, I see no point in manually breaking into components when
&gt; untainted_bin_to_lib&#40;&#41; can split on &#39;/&#39; anyway&#41;.
</div>
How the file path is handled can go either way.  Its not really important.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt;     use FindBin qw&#40;bin_to_lib&#41;;
&gt;&gt;     bin_to_lib&#40;&#34;..&#34;, &#34;lib&#34;&#41;;
</div>&gt;
&gt;   [OT: not clear why you think it is better than
&gt;        use FindBin;
&gt;        FindBin::bin_to_lib&#40;&#34;..&#34;, &#34;lib&#34;&#41;;
&gt;    ...]
</div>
In this specific case, with a very short module name, it really doesn&#39;t matter
much one way or the other.


-- 
52. Not allowed to yell &#34;Take that Cobra&#34; at the rifle range.
    -- The 213 Things Skippy Is No Longer Allowed To Do In The U.S. Army
           <span class="clickylink"><a target="new" rel="nofollow" href="http://skippyslist.com/list/">http://skippyslist.com/list/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-825055" href="/Public/Bug/Display.html?id=60892#txn-825055">#</a>      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;31&nbsp;17:47:59&nbsp;2010</span>
    <span class="description">nospam-abuse [...] ilyaz.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 31 Aug 2010 14:47:42 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael G Schwern via RT &lt;bug-FindBin [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ilya Zakharevich &lt;nospam-abuse [...] ilyaz.org&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/825055/427409/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427409">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Aug 31, 2010 at 05:53:27AM -0400, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Seeing the code you propose below, I do not see how it would stop anyone...
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sorry, I was misleading about what it does.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; bin_to_lib&#40;&#41; would leave everything outside tainted.  $0 remains tainted.
&gt; $FindBin::Bin remains tainted.  It *only* detaints for the specific purpose of
&gt; pushing $FindBin::Bin/../lib onto @INC so that @INC does not catch $0&#39;s taint.
&gt;  I don&#39;t think that&#39;s any more exploitable than the whole idea of FindBin is
&gt; to begin with.
</div>
The key thing is &#34;any more exploitable than the whole idea of modules
sitting near executables&#34;.  My point is that you target an
insignificant crack &#40;tainting $0&#41; while one has the whole abyss
sitting next to it.

Some first questions coming to mind: should FindBin follow all the
symlinks?  Should bin_to_lib have a &#40;required&#41; option limiting modules
which may be loaded from the found directory?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; I do not see any solutin except for having
&gt; &gt;    use FindBin;
&gt; &gt;    FindBin::untainted_bin_to_lib &#39;../lib&#39;;
&gt; &gt; &#40;as you see, I see no point in manually breaking into components when
&gt; &gt; untainted_bin_to_lib&#40;&#41; can split on &#39;/&#39; anyway&#41;.
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; How the file path is handled can go either way.  Its not really important.
</div>
The accent was on having &#34;untaint&#34; inside the name, so the composer of
the script has a chance to stop to think.  Or better,
&#34;unsecure_bin_to_lib&#34;.

Yours,
Ilya

P.S.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;&gt;     use FindBin qw&#40;bin_to_lib&#41;;
&gt; &gt;&gt;     bin_to_lib&#40;&#34;..&#34;, &#34;lib&#34;&#41;;
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;   [OT: not clear why you think it is better than
&gt; &gt;        use FindBin;
&gt; &gt;        FindBin::bin_to_lib&#40;&#34;..&#34;, &#34;lib&#34;&#41;;
&gt; &gt;    ...]
</div></div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In this specific case, with a very short module name, it really doesn&#39;t matter
&gt; much one way or the other.
</div>
I&#39;m just curious: myself, I find full names more pleasant for
call-once situation notwithstanding the module name...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-826038" href="/Public/Bug/Display.html?id=60892#txn-826038">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;02&nbsp;17:02:56&nbsp;2010</span>
    <span class="description">jw [...] suse.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> JNW [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #60892] $FindBin::RealBin is tainted</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 2 Sep 2010 23:02:46 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael G Schwern via RT &lt;bug-FindBin [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Juergen Weigert &lt;jw [...] suse.de&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/826038/427933/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/427933">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Aug 30, 10 16:43:44 -0400, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=60892">https://rt.cpan.org/Ticket/Display.html?id=60892</a></span> &gt;
&gt; 
&gt; On Mon Aug 30 14:45:01 2010, JNW wrote:
<div class="message-stanza open">&gt; &gt; FindBin-1.50 as included in perl-5.12.1 fails under -T if I use it as
&gt; &gt; suggested in the POD:
&gt; &gt; 
&gt; &gt;  use FindBin qw&#40;$RealBin&#41;;
&gt; &gt;  use lib &#34;$RealBin/../lib&#34;;
&gt; &gt; 
&gt; &gt; This ugly workaround helps: 
&gt; &gt; 
&gt; &gt;  use FindBin;
&gt; &gt;  BEGIN { unshift @INC, &#34;$1/../lib&#34; if $FindBin::RealBin =~ m{&#40;.*&#41;} };
</div>&gt; 
&gt; I can&#39;t reproduce this with 5.12.1 or any other version of Perl.  Are
&gt; you sure that you&#39;ve shown everything necessary to reproduce the problem?
</div>
one more step is missing in the above. There needs to be a line
        use Something;
that pulls Something.pm in from the newly added lib directory.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Since the information from FindBin is coming from outside the program&#39;s
&gt; control, it would be fitting if it were tainted.  It is essentially
&gt; parsing $0 which is tainted.
</div>
Hmm. I agree that this is a sane default. I seek a way to
express, &#34;I want to consider my &#39;../lib&#39; as okay.&#34;

Compare with FindBin::libs - which always silently untaints its results. 
There seems to be a need :-&#41;

        cheers,
                JW-

-- 
 o \  Juergen Weigert  paint it green!    __/ _=======.=======_
&lt;V&gt; | jw@suse.de       back to ascii!  __/        _---|____________\/
 \  | 0911 74053-508                __/          &#40;____/            /\
&#40;/&#41; | _____________________________/              _/ \_ vim:set sw=2 wm=8
SUSE LINUX Products GmbH, GF: Markus Rex, HRB 16746 &#40;AG Nuernberg&#41;
&#34;You are trying to use packages from project &#39;openSUSE:11.3&#39;.
 Note that malicious packages can compromise your system.&#34;
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.638865</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
